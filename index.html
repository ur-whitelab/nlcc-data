<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>nlcc report</title>
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
  <style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
</head>
<body>
<header id="title-block-header">
<h1 class="title">nlcc report</h1>
</header>
<nav id="TOC">
<ul class="incremental">
<li><a href="#code-results">Code Results</a></li>
<li><a href="#details">Details</a></li>
<li><a href="#human-evaluations">Human Evaluations</a><ul class="incremental">
<li><a href="#gaussian_input_emin">gaussian_input_emin</a></li>
<li><a href="#mc_harmonic">mc_harmonic</a></li>
<li><a href="#mc_ising">mc_ising</a></li>
<li><a href="#plot_3d_sin">plot_3d_sin</a></li>
<li><a href="#plot_bar">plot_bar</a></li>
<li><a href="#plot_contour">plot_contour</a></li>
<li><a href="#plot_dual_axis">plot_dual_axis</a></li>
<li><a href="#plot_sin_polar">plot_sin_polar</a></li>
<li><a href="#protein-render">protein-render</a></li>
</ul></li>
</ul>
</nav>
<p>‘NoneType’ object has no attribute ‘text’ Error message from NCBI: Message ID#24 Error: Failed to read the Blast query: Protein FASTA provided for nucleotide sequence Error message from NCBI: Message ID#24 Error: Failed to read the Blast query: Protein FASTA provided for nucleotide sequence cannot import name ‘NcbimakeblastdbCommandline’ from ‘Bio.Blast.Applications’ (/opt/hostedtoolcache/Python/3.8.12/x64/lib/python3.8/site-packages/Bio/Blast/Applications.py) list index out of range argument of type ‘function’ is not iterable ‘&gt;’ not supported between instances of ‘method’ and ‘method’ ‘&gt;’ not supported between instances of ‘method’ and ‘method’ ‘&gt;’ not supported between instances of ‘method’ and ‘method’ ‘Element’ object has no attribute ‘pauling_electronegativity’ Missing parentheses in call to ‘print’. Did you mean print(“Error: element mass not found for element”, element_symbol)? (<string>, line 12) Missing parentheses in call to ‘print’. Did you mean print(“Error: element mass not found for” + element_symbol)? (<string>, line 12) Missing parentheses in call to ‘print’. Did you mean print(“Error: element mass not found for element %s” % element_symbol)? (<string>, line 12) ‘Constant’ object has no attribute ‘kind’ ‘Constant’ object has no attribute ‘kind’ ‘Constant’ object has no attribute ‘kind’ ‘Constant’ object has no attribute ‘kind’ ‘Constant’ object has no attribute ‘kind’ invalid syntax (<string>, line 14) list index out of range list index out of range ufunc ‘isfinite’ not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ‘’safe’’ ufunc ‘isfinite’ not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ‘’safe’’ ufunc ‘isfinite’ not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ‘’safe’’ ‘Residue’ object has no attribute ‘is_hydrophobic’ ‘Residue’ object has no attribute ‘is_hydrophobic’ The truth value of an array with more than one element is ambiguous. Use a.any() or a.all() The truth value of an array with more than one element is ambiguous. Use a.any() or a.all() The truth value of an array with more than one element is ambiguous. Use a.any() or a.all() The truth value of an array with more than one element is ambiguous. Use a.any() or a.all() Python argument types in rdkit.Chem.rdmolfiles.MolToSmiles(NoneType) did not match C++ signature: MolToSmiles(RDKit::ROMol mol, bool isomericSmiles=True, bool kekuleSmiles=False, int rootedAtAtom=-1, bool canonical=True, bool allBondsExplicit=False, bool allHsExplicit=False, bool doRandom=False) Python argument types in rdkit.Chem.rdmolfiles.MolToSmiles(NoneType) did not match C++ signature: MolToSmiles(RDKit::ROMol mol, bool isomericSmiles=True, bool kekuleSmiles=False, int rootedAtAtom=-1, bool canonical=True, bool allBondsExplicit=False, bool allHsExplicit=False, bool doRandom=False) Python argument types in rdkit.Chem.rdmolfiles.MolToSmiles(NoneType) did not match C++ signature: MolToSmiles(RDKit::ROMol mol, bool isomericSmiles=True, bool kekuleSmiles=False, int rootedAtAtom=-1, bool canonical=True, bool allBondsExplicit=False, bool allHsExplicit=False, bool doRandom=False) Python argument types in rdkit.Chem.rdmolfiles.MolToSmiles(NoneType) did not match C++ signature: MolToSmiles(RDKit::ROMol mol, bool isomericSmiles=True, bool kekuleSmiles=False, int rootedAtAtom=-1, bool canonical=True, bool allBondsExplicit=False, bool allHsExplicit=False, bool doRandom=False)</p>
<p>EOF while scanning triple-quoted string literal (<string>, line 22) EOF while scanning triple-quoted string literal (<string>, line 25) EOF while scanning triple-quoted string literal (<string>, line 25) EOF while scanning triple-quoted string literal (<string>, line 25) ‘list’ object has no attribute ‘masses’ ‘list’ object has no attribute ‘masses’ ‘list’ object has no attribute ‘masses’ ‘list’ object has no attribute ‘masses’ ‘list’ object has no attribute ‘indices’ ufunc ‘isfinite’ not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ‘’safe’’ ufunc ‘isfinite’ not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ‘’safe’’ ufunc ‘isfinite’ not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ‘’safe’’ ufunc ‘isfinite’ not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ‘’safe’’ ufunc ‘isfinite’ not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ‘’safe’’ only integers, slices (<code>:</code>), ellipsis (<code>...</code>), numpy.newaxis (<code>None</code>) and integer or boolean arrays are valid indices only integers, slices (<code>:</code>), ellipsis (<code>...</code>), numpy.newaxis (<code>None</code>) and integer or boolean arrays are valid indices only integers, slices (<code>:</code>), ellipsis (<code>...</code>), numpy.newaxis (<code>None</code>) and integer or boolean arrays are valid indices operands could not be broadcast together with shapes (10,10) (10,5) operands could not be broadcast together with shapes (10,10) (10,5) ‘Constant’ object has no attribute ‘kind’ ‘Constant’ object has no attribute ‘kind’ ‘Constant’ object has no attribute ‘kind’ ‘Constant’ object has no attribute ‘kind’ ‘Constant’ object has no attribute ‘kind’ (‘Connection aborted.’, TimeoutError(‘Timeout’)) (‘Connection aborted.’, TimeoutError(‘Timeout’)) ‘NoneType’ object has no attribute ‘write’ ‘NoneType’ object has no attribute ‘write’ ‘NoneType’ object has no attribute ‘write’ ‘NoneType’ object has no attribute ‘write’ ‘NoneType’ object has no attribute ‘write’ operands could not be broadcast together with shapes (300,) (3,) operands could not be broadcast together with shapes (300,) (3,) expected an indented block (<string>, line 27) Timeout xyz must be shape (Any, 9362, 3). You supplied (200, 6316, 3) too many indices for array: array is 1-dimensional, but 3 were indexed module ‘rdkit.Chem.Scaffolds’ has no attribute ‘MurckoScaffoldSmiles’ module ‘rdkit.Chem.Scaffolds’ has no attribute ‘MurckoScaffoldSmiles’ module ‘rdkit.Chem.Scaffolds’ has no attribute ‘MurckoScaffoldSmiles’ module ‘rdkit.Chem.Scaffolds’ has no attribute ‘MurckoScaffoldSmiles’ module ‘rdkit.Chem.Scaffolds’ has no attribute ‘MurckoScaffoldSmiles’ Sympify of expression ‘could not parse ’4x + 3y = 20’’ failed, because of exception being raised: SyntaxError: invalid syntax (<string>, line 1) Sympify of expression ‘could not parse ’4x + 3y = 20’’ failed, because of exception being raised: SyntaxError: invalid syntax (<string>, line 1) Sympify of expression ‘could not parse ’4x + 3y = 20’’ failed, because of exception being raised: SyntaxError: invalid syntax (<string>, line 1) Sympify of expression ‘could not parse ’4x + 3y = 20’’ failed, because of exception being raised: SyntaxError: invalid syntax (<string>, line 1) Sympify of expression ‘could not parse ’4x + 3y = 20’’ failed, because of exception being raised: SyntaxError: invalid syntax (<string>, line 1) File error: Bad input file /tmp/pip-req-build-p3aa6g65/build/temp.linux-x86_64-3.8/rdkit_install/share/RDKit/Data/NCI/first_200.props.sdf File error: Bad input file /tmp/pip-req-build-p3aa6g65/build/temp.linux-x86_64-3.8/rdkit_install/share/RDKit/Data/NCI/first_200.props.sdf File error: Bad input file /tmp/pip-req-build-p3aa6g65/build/temp.linux-x86_64-3.8/rdkit_install/share/RDKit/Data/NCI/first_200.props.sdf File error: Bad input file /tmp/pip-req-build-p3aa6g65/build/temp.linux-x86_64-3.8/rdkit_install/share/RDKit/Data/NCI/first_200.props.sdf File error: Bad input file /tmp/pip-req-build-p3aa6g65/build/temp.linux-x86_64-3.8/rdkit_install/share/RDKit/Data/NCI/first_200.props.sdf ‘Constant’ object has no attribute ‘kind’ ‘Constant’ object has no attribute ‘kind’ ‘Constant’ object has no attribute ‘kind’ ‘Constant’ object has no attribute ‘kind’ ‘Constant’ object has no attribute ‘kind’ ## Test Report ### Global Parameters * Engine = openai * n = 5</p>
<h3 id="code-results">Code Results</h3>
<table>
<thead>
<tr class="header">
<th>Test</th>
<th>Run 0</th>
<th>Run 1</th>
<th>Run 2</th>
<th>Run 3</th>
<th>Run 4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>aa_polarity</td>
<td>Fail</td>
<td>Fail</td>
<td>Pass</td>
<td>Fail</td>
<td>Fail</td>
</tr>
<tr class="even">
<td>alignment</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
</tr>
<tr class="odd">
<td>angle</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Fail</td>
</tr>
<tr class="even">
<td>aromatic_aa</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
</tr>
<tr class="odd">
<td>arrhenius</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
</tr>
<tr class="even">
<td>bimolecular</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
</tr>
<tr class="odd">
<td>blast</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
</tr>
<tr class="even">
<td>bravais</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
</tr>
<tr class="odd">
<td>canonicalize</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
</tr>
<tr class="even">
<td>compare_electronegativity</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
</tr>
<tr class="odd">
<td>condiff_1d</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
</tr>
<tr class="even">
<td>cubes</td>
<td>Pass</td>
<td>Fail</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
</tr>
<tr class="odd">
<td>de_broglie</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
</tr>
<tr class="even">
<td>derivative1d-ch</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
</tr>
<tr class="odd">
<td>derivative_2deg</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
</tr>
<tr class="even">
<td>descriptors</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
</tr>
<tr class="odd">
<td>dipole</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
</tr>
<tr class="even">
<td>dou</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
</tr>
<tr class="odd">
<td>eigen-ch</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
</tr>
<tr class="even">
<td>eigen</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Fail</td>
<td>Pass</td>
</tr>
<tr class="odd">
<td>element_mass</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Pass</td>
<td>Pass</td>
</tr>
<tr class="even">
<td>element_name</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
</tr>
<tr class="odd">
<td>energy_of_e</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
</tr>
<tr class="even">
<td>find_indices</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
</tr>
<tr class="odd">
<td>force_constant</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
</tr>
<tr class="even">
<td>fourier_1d</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
</tr>
<tr class="odd">
<td>freezing_depression</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
</tr>
<tr class="even">
<td>genpos</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
</tr>
<tr class="odd">
<td>hydrophobic_res</td>
<td>Pass</td>
<td>Fail</td>
<td>Pass</td>
<td>Fail</td>
<td>Pass</td>
</tr>
<tr class="even">
<td>ideal_gas</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
</tr>
<tr class="odd">
<td>integral</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
</tr>
<tr class="even">
<td>trap</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
</tr>
<tr class="odd">
<td>invert_matrix</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
</tr>
<tr class="even">
<td>iupac2smiles</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
</tr>
<tr class="odd">
<td>kld</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Pass</td>
<td>Fail</td>
</tr>
<tr class="even">
<td>langevin_dynamics</td>
<td>Pass</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
</tr>
<tr class="odd">
<td>lipinski_rule_of_five</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
</tr>
<tr class="even">
<td>mape</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
</tr>
<tr class="odd">
<td>mapping_operator</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
</tr>
<tr class="even">
<td>matpow</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
</tr>
<tr class="odd">
<td>matrix_factorial</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
</tr>
<tr class="even">
<td>max-boltz</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
</tr>
<tr class="odd">
<td>mol_charge</td>
<td>Fail</td>
<td>Fail</td>
<td>Pass</td>
<td>Fail</td>
<td>Pass</td>
</tr>
<tr class="even">
<td>net_charge</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
</tr>
<tr class="odd">
<td>solve_ode</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
</tr>
<tr class="even">
<td>ohe</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
</tr>
<tr class="odd">
<td>osmotic_pressure</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
</tr>
<tr class="even">
<td>pair_wise</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
</tr>
<tr class="odd">
<td>pi</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
</tr>
<tr class="even">
<td>pib_1d</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
</tr>
<tr class="odd">
<td>pred_interval</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
</tr>
<tr class="even">
<td>pubchem</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
</tr>
<tr class="odd">
<td>pyscf_energy</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
</tr>
<tr class="even">
<td>qed</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
</tr>
<tr class="odd">
<td>quantile</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Pass</td>
<td>Pass</td>
</tr>
<tr class="even">
<td>random_walk</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Fail</td>
<td>Pass</td>
</tr>
<tr class="odd">
<td>rank</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
</tr>
<tr class="even">
<td>rank</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
</tr>
<tr class="odd">
<td>remove-water-ch</td>
<td>Pass</td>
<td>Fail</td>
<td>Pass</td>
<td>Pass</td>
<td>Fail</td>
</tr>
<tr class="even">
<td>remove-water</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
</tr>
<tr class="odd">
<td>rmse-ch</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
</tr>
<tr class="even">
<td>rmse</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
</tr>
<tr class="odd">
<td>rog</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
</tr>
<tr class="even">
<td>sasa</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
</tr>
<tr class="odd">
<td>scaffold</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
</tr>
<tr class="even">
<td>seq-align</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
</tr>
<tr class="odd">
<td>seq-trans</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
</tr>
<tr class="even">
<td>sequence</td>
<td>Pass</td>
<td>Fail</td>
<td>Pass</td>
<td>Fail</td>
<td>Pass</td>
</tr>
<tr class="odd">
<td>sle</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
</tr>
<tr class="even">
<td>spectral_r</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
</tr>
<tr class="odd">
<td>substructure</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
</tr>
<tr class="even">
<td>tanimoto</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Fail</td>
</tr>
<tr class="odd">
<td>unbdistance</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
</tr>
</tbody>
</table>
<h3 id="details">Details</h3>
<details>
<p><summary>aa_polarity</summary></p>
<h4 id="query">Query</h4>
<div class="sourceCode" id="cb1"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb1-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb1-3" title="3"></a>
<a class="sourceLine" id="cb1-4" title="4"><span class="kw">def</span> polar_count(sequence):</a>
<a class="sourceLine" id="cb1-5" title="5">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1-6" title="6"><span class="co">    This function counts the number of polar, non-charged amino acids in the given sequence</span></a>
<a class="sourceLine" id="cb1-7" title="7"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1-8" title="8">    [insert]</a>
<a class="sourceLine" id="cb1-9" title="9">    <span class="cf">return</span> count</a></code></pre></div>
<h4 id="run-0">Run 0</h4>
<div class="sourceCode" id="cb2"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb2-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb2-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb2-3" title="3"></a>
<a class="sourceLine" id="cb2-4" title="4"><span class="kw">def</span> polar_count(sequence):</a>
<a class="sourceLine" id="cb2-5" title="5">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb2-6" title="6"><span class="co">    This function counts the number of polar, non-charged amino acids in the given sequence</span></a>
<a class="sourceLine" id="cb2-7" title="7"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb2-8" title="8">    count <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb2-9" title="9">    <span class="cf">for</span> aa <span class="kw">in</span> sequence:</a>
<a class="sourceLine" id="cb2-10" title="10">        <span class="cf">if</span> aa <span class="kw">in</span> [<span class="st">&#39;S&#39;</span>, <span class="st">&#39;T&#39;</span>, <span class="st">&#39;N&#39;</span>, <span class="st">&#39;Q&#39;</span>, <span class="st">&#39;H&#39;</span>, <span class="st">&#39;K&#39;</span>, <span class="st">&#39;R&#39;</span>, <span class="st">&#39;D&#39;</span>, <span class="st">&#39;E&#39;</span>]:</a>
<a class="sourceLine" id="cb2-11" title="11">            count <span class="op">+=</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb2-12" title="12">    <span class="cf">return</span> count</a>
<a class="sourceLine" id="cb2-13" title="13"></a>
<a class="sourceLine" id="cb2-14" title="14">sample_sequence <span class="op">=</span> <span class="st">&quot;ACRZSSDP&quot;</span></a>
<a class="sourceLine" id="cb2-15" title="15"></a>
<a class="sourceLine" id="cb2-16" title="16">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> polar_count(sample_sequence) <span class="op">==</span> <span class="dv">3</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1">Run 1</h4>
<div class="sourceCode" id="cb4"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb4-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb4-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb4-3" title="3"></a>
<a class="sourceLine" id="cb4-4" title="4"><span class="kw">def</span> polar_count(sequence):</a>
<a class="sourceLine" id="cb4-5" title="5">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb4-6" title="6"><span class="co">    This function counts the number of polar, non-charged amino acids in the given sequence</span></a>
<a class="sourceLine" id="cb4-7" title="7"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb4-8" title="8">    count <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb4-9" title="9">    <span class="cf">for</span> aa <span class="kw">in</span> sequence:</a>
<a class="sourceLine" id="cb4-10" title="10">        <span class="cf">if</span> aa <span class="kw">in</span> [<span class="st">&#39;S&#39;</span>, <span class="st">&#39;T&#39;</span>, <span class="st">&#39;N&#39;</span>, <span class="st">&#39;Q&#39;</span>, <span class="st">&#39;H&#39;</span>, <span class="st">&#39;K&#39;</span>, <span class="st">&#39;R&#39;</span>, <span class="st">&#39;D&#39;</span>, <span class="st">&#39;E&#39;</span>]:</a>
<a class="sourceLine" id="cb4-11" title="11">            count <span class="op">+=</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb4-12" title="12">    <span class="cf">return</span> count</a>
<a class="sourceLine" id="cb4-13" title="13"></a>
<a class="sourceLine" id="cb4-14" title="14">sample_sequence <span class="op">=</span> <span class="st">&quot;ACRZSSDP&quot;</span></a>
<a class="sourceLine" id="cb4-15" title="15"></a>
<a class="sourceLine" id="cb4-16" title="16">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> polar_count(sample_sequence) <span class="op">==</span> <span class="dv">3</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2">Run 2</h4>
<div class="sourceCode" id="cb6"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb6-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb6-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb6-3" title="3"></a>
<a class="sourceLine" id="cb6-4" title="4"><span class="kw">def</span> polar_count(sequence):</a>
<a class="sourceLine" id="cb6-5" title="5">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb6-6" title="6"><span class="co">    This function counts the number of polar, non-charged amino acids in the given sequence</span></a>
<a class="sourceLine" id="cb6-7" title="7"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb6-8" title="8">    count <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb6-9" title="9">    <span class="cf">for</span> aa <span class="kw">in</span> sequence:</a>
<a class="sourceLine" id="cb6-10" title="10">        <span class="cf">if</span> aa <span class="kw">in</span> [<span class="st">&#39;N&#39;</span>, <span class="st">&#39;Q&#39;</span>, <span class="st">&#39;S&#39;</span>, <span class="st">&#39;T&#39;</span>, <span class="st">&#39;Y&#39;</span>, <span class="st">&#39;C&#39;</span>, <span class="st">&#39;M&#39;</span>, <span class="st">&#39;W&#39;</span>]:</a>
<a class="sourceLine" id="cb6-11" title="11">            count <span class="op">+=</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb6-12" title="12">    <span class="cf">return</span> count</a>
<a class="sourceLine" id="cb6-13" title="13"></a>
<a class="sourceLine" id="cb6-14" title="14">sample_sequence <span class="op">=</span> <span class="st">&quot;ACRZSSDP&quot;</span></a>
<a class="sourceLine" id="cb6-15" title="15"></a>
<a class="sourceLine" id="cb6-16" title="16">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> polar_count(sample_sequence) <span class="op">==</span> <span class="dv">3</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3">Run 3</h4>
<div class="sourceCode" id="cb8"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb8-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb8-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb8-3" title="3"></a>
<a class="sourceLine" id="cb8-4" title="4"><span class="kw">def</span> polar_count(sequence):</a>
<a class="sourceLine" id="cb8-5" title="5">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb8-6" title="6"><span class="co">    This function counts the number of polar, non-charged amino acids in the given sequence</span></a>
<a class="sourceLine" id="cb8-7" title="7"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb8-8" title="8">    count <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb8-9" title="9">    <span class="cf">for</span> amino_acid <span class="kw">in</span> sequence:</a>
<a class="sourceLine" id="cb8-10" title="10">        <span class="cf">if</span> amino_acid <span class="kw">in</span> [<span class="st">&#39;S&#39;</span>, <span class="st">&#39;T&#39;</span>, <span class="st">&#39;N&#39;</span>, <span class="st">&#39;Q&#39;</span>, <span class="st">&#39;D&#39;</span>, <span class="st">&#39;E&#39;</span>, <span class="st">&#39;K&#39;</span>, <span class="st">&#39;R&#39;</span>, <span class="st">&#39;H&#39;</span>]:</a>
<a class="sourceLine" id="cb8-11" title="11">            count <span class="op">+=</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb8-12" title="12">    <span class="cf">return</span> count</a>
<a class="sourceLine" id="cb8-13" title="13"></a>
<a class="sourceLine" id="cb8-14" title="14">sample_sequence <span class="op">=</span> <span class="st">&quot;ACRZSSDP&quot;</span></a>
<a class="sourceLine" id="cb8-15" title="15"></a>
<a class="sourceLine" id="cb8-16" title="16">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> polar_count(sample_sequence) <span class="op">==</span> <span class="dv">3</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4">Run 4</h4>
<div class="sourceCode" id="cb10"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb10-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb10-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb10-3" title="3"></a>
<a class="sourceLine" id="cb10-4" title="4"><span class="kw">def</span> polar_count(sequence):</a>
<a class="sourceLine" id="cb10-5" title="5">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb10-6" title="6"><span class="co">    This function counts the number of polar, non-charged amino acids in the given sequence</span></a>
<a class="sourceLine" id="cb10-7" title="7"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb10-8" title="8">    count <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb10-9" title="9">    <span class="cf">for</span> amino_acid <span class="kw">in</span> sequence:</a>
<a class="sourceLine" id="cb10-10" title="10">        <span class="cf">if</span> amino_acid <span class="kw">in</span> [<span class="st">&quot;S&quot;</span>, <span class="st">&quot;T&quot;</span>, <span class="st">&quot;N&quot;</span>, <span class="st">&quot;Q&quot;</span>, <span class="st">&quot;D&quot;</span>, <span class="st">&quot;E&quot;</span>, <span class="st">&quot;K&quot;</span>, <span class="st">&quot;R&quot;</span>, <span class="st">&quot;H&quot;</span>, <span class="st">&quot;Y&quot;</span>]:</a>
<a class="sourceLine" id="cb10-11" title="11">            count <span class="op">+=</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb10-12" title="12">    <span class="cf">return</span> count</a>
<a class="sourceLine" id="cb10-13" title="13"></a>
<a class="sourceLine" id="cb10-14" title="14">sample_sequence <span class="op">=</span> <span class="st">&quot;ACRZSSDP&quot;</span></a>
<a class="sourceLine" id="cb10-15" title="15"></a>
<a class="sourceLine" id="cb10-16" title="16">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> polar_count(sample_sequence) <span class="op">==</span> <span class="dv">3</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>alignment</summary></p>
<h4 id="query-1">Query</h4>
<div class="sourceCode" id="cb12"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb12-1" title="1"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb12-2" title="2"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb12-3" title="3"></a>
<a class="sourceLine" id="cb12-4" title="4"><span class="kw">def</span> align_traj(traj, frame_index):</a>
<a class="sourceLine" id="cb12-5" title="5">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb12-6" title="6"><span class="co">  This function aligns the given mdtraj trajectory to a specific frame</span></a>
<a class="sourceLine" id="cb12-7" title="7"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb12-8" title="8">  [insert]</a>
<a class="sourceLine" id="cb12-9" title="9">  <span class="cf">return</span> traj</a></code></pre></div>
<h4 id="run-0-1">Run 0</h4>
<div class="sourceCode" id="cb13"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb13-1" title="1"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb13-2" title="2"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb13-3" title="3"></a>
<a class="sourceLine" id="cb13-4" title="4"><span class="kw">def</span> align_traj(traj, frame_index):</a>
<a class="sourceLine" id="cb13-5" title="5">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb13-6" title="6"><span class="co">  This function aligns the given mdtraj trajectory to a specific frame</span></a>
<a class="sourceLine" id="cb13-7" title="7"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb13-8" title="8">  traj.superpose(traj, frame<span class="op">=</span>frame_index)</a>
<a class="sourceLine" id="cb13-9" title="9">  <span class="cf">return</span> traj</a>
<a class="sourceLine" id="cb13-10" title="10"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb13-11" title="11"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb13-12" title="12"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb13-13" title="13"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb13-14" title="14"></a>
<a class="sourceLine" id="cb13-15" title="15">pdb_file <span class="op">=</span> os.path.join(_FILE_DIR_, <span class="st">&quot;1VII_twoframe_shifted.pdb&quot;</span>)</a>
<a class="sourceLine" id="cb13-16" title="16">trj <span class="op">=</span> md.load(pdb_file)</a>
<a class="sourceLine" id="cb13-17" title="17"></a>
<a class="sourceLine" id="cb13-18" title="18"></a>
<a class="sourceLine" id="cb13-19" title="19"><span class="kw">def</span> myrmsd(trj, frame):</a>
<a class="sourceLine" id="cb13-20" title="20">    xyz <span class="op">=</span> trj.xyz</a>
<a class="sourceLine" id="cb13-21" title="21">    xyz0 <span class="op">=</span> trj.xyz[frame]</a>
<a class="sourceLine" id="cb13-22" title="22">    dx <span class="op">=</span> xyz<span class="op">-</span>xyz0</a>
<a class="sourceLine" id="cb13-23" title="23">    dx2 <span class="op">=</span> (dx<span class="op">*</span>dx).<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb13-24" title="24">    rmsd <span class="op">=</span> np.sqrt(dx2.mean(axis<span class="op">=</span><span class="dv">1</span>))</a>
<a class="sourceLine" id="cb13-25" title="25">    <span class="cf">return</span> rmsd</a>
<a class="sourceLine" id="cb13-26" title="26"></a>
<a class="sourceLine" id="cb13-27" title="27"></a>
<a class="sourceLine" id="cb13-28" title="28"><span class="co">#print(&quot;Starting rmsd:&quot;, myrmsd(trj, 0))</span></a>
<a class="sourceLine" id="cb13-29" title="29">aligned_trj <span class="op">=</span> trj.superpose(trj, <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb13-30" title="30"></a>
<a class="sourceLine" id="cb13-31" title="31">my_rmsd <span class="op">=</span> myrmsd(aligned_trj, <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb13-32" title="32"><span class="co">#print(&quot;Aligned rmsd:&quot;, my_rmsd)</span></a>
<a class="sourceLine" id="cb13-33" title="33"></a>
<a class="sourceLine" id="cb13-34" title="34">nlcc_trj <span class="op">=</span> align_traj(trj, <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb13-35" title="35">nlcc_rmsd <span class="op">=</span> myrmsd(nlcc_trj, <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb13-36" title="36"></a>
<a class="sourceLine" id="cb13-37" title="37"><span class="co">#print(&quot;nlcc rmsd&quot;, nlcc_rmsd)</span></a>
<a class="sourceLine" id="cb13-38" title="38"></a>
<a class="sourceLine" id="cb13-39" title="39">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">all</span>(np.<span class="bu">abs</span>(my_rmsd <span class="op">-</span> nlcc_rmsd)) <span class="op">&lt;</span> <span class="fl">0.01</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-1">Run 1</h4>
<div class="sourceCode" id="cb15"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb15-1" title="1"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb15-2" title="2"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb15-3" title="3"></a>
<a class="sourceLine" id="cb15-4" title="4"><span class="kw">def</span> align_traj(traj, frame_index):</a>
<a class="sourceLine" id="cb15-5" title="5">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb15-6" title="6"><span class="co">  This function aligns the given mdtraj trajectory to a specific frame</span></a>
<a class="sourceLine" id="cb15-7" title="7"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb15-8" title="8">  traj.superpose(traj, frame<span class="op">=</span>frame_index)</a>
<a class="sourceLine" id="cb15-9" title="9">  <span class="cf">return</span> traj</a>
<a class="sourceLine" id="cb15-10" title="10"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb15-11" title="11"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb15-12" title="12"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb15-13" title="13"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb15-14" title="14"></a>
<a class="sourceLine" id="cb15-15" title="15">pdb_file <span class="op">=</span> os.path.join(_FILE_DIR_, <span class="st">&quot;1VII_twoframe_shifted.pdb&quot;</span>)</a>
<a class="sourceLine" id="cb15-16" title="16">trj <span class="op">=</span> md.load(pdb_file)</a>
<a class="sourceLine" id="cb15-17" title="17"></a>
<a class="sourceLine" id="cb15-18" title="18"></a>
<a class="sourceLine" id="cb15-19" title="19"><span class="kw">def</span> myrmsd(trj, frame):</a>
<a class="sourceLine" id="cb15-20" title="20">    xyz <span class="op">=</span> trj.xyz</a>
<a class="sourceLine" id="cb15-21" title="21">    xyz0 <span class="op">=</span> trj.xyz[frame]</a>
<a class="sourceLine" id="cb15-22" title="22">    dx <span class="op">=</span> xyz<span class="op">-</span>xyz0</a>
<a class="sourceLine" id="cb15-23" title="23">    dx2 <span class="op">=</span> (dx<span class="op">*</span>dx).<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb15-24" title="24">    rmsd <span class="op">=</span> np.sqrt(dx2.mean(axis<span class="op">=</span><span class="dv">1</span>))</a>
<a class="sourceLine" id="cb15-25" title="25">    <span class="cf">return</span> rmsd</a>
<a class="sourceLine" id="cb15-26" title="26"></a>
<a class="sourceLine" id="cb15-27" title="27"></a>
<a class="sourceLine" id="cb15-28" title="28"><span class="co">#print(&quot;Starting rmsd:&quot;, myrmsd(trj, 0))</span></a>
<a class="sourceLine" id="cb15-29" title="29">aligned_trj <span class="op">=</span> trj.superpose(trj, <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb15-30" title="30"></a>
<a class="sourceLine" id="cb15-31" title="31">my_rmsd <span class="op">=</span> myrmsd(aligned_trj, <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb15-32" title="32"><span class="co">#print(&quot;Aligned rmsd:&quot;, my_rmsd)</span></a>
<a class="sourceLine" id="cb15-33" title="33"></a>
<a class="sourceLine" id="cb15-34" title="34">nlcc_trj <span class="op">=</span> align_traj(trj, <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb15-35" title="35">nlcc_rmsd <span class="op">=</span> myrmsd(nlcc_trj, <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb15-36" title="36"></a>
<a class="sourceLine" id="cb15-37" title="37"><span class="co">#print(&quot;nlcc rmsd&quot;, nlcc_rmsd)</span></a>
<a class="sourceLine" id="cb15-38" title="38"></a>
<a class="sourceLine" id="cb15-39" title="39">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">all</span>(np.<span class="bu">abs</span>(my_rmsd <span class="op">-</span> nlcc_rmsd)) <span class="op">&lt;</span> <span class="fl">0.01</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-1">Run 2</h4>
<div class="sourceCode" id="cb17"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb17-1" title="1"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb17-2" title="2"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb17-3" title="3"></a>
<a class="sourceLine" id="cb17-4" title="4"><span class="kw">def</span> align_traj(traj, frame_index):</a>
<a class="sourceLine" id="cb17-5" title="5">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb17-6" title="6"><span class="co">  This function aligns the given mdtraj trajectory to a specific frame</span></a>
<a class="sourceLine" id="cb17-7" title="7"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb17-8" title="8">  traj.superpose(traj, frame<span class="op">=</span>frame_index)</a>
<a class="sourceLine" id="cb17-9" title="9">  <span class="cf">return</span> traj</a>
<a class="sourceLine" id="cb17-10" title="10"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb17-11" title="11"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb17-12" title="12"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb17-13" title="13"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb17-14" title="14"></a>
<a class="sourceLine" id="cb17-15" title="15">pdb_file <span class="op">=</span> os.path.join(_FILE_DIR_, <span class="st">&quot;1VII_twoframe_shifted.pdb&quot;</span>)</a>
<a class="sourceLine" id="cb17-16" title="16">trj <span class="op">=</span> md.load(pdb_file)</a>
<a class="sourceLine" id="cb17-17" title="17"></a>
<a class="sourceLine" id="cb17-18" title="18"></a>
<a class="sourceLine" id="cb17-19" title="19"><span class="kw">def</span> myrmsd(trj, frame):</a>
<a class="sourceLine" id="cb17-20" title="20">    xyz <span class="op">=</span> trj.xyz</a>
<a class="sourceLine" id="cb17-21" title="21">    xyz0 <span class="op">=</span> trj.xyz[frame]</a>
<a class="sourceLine" id="cb17-22" title="22">    dx <span class="op">=</span> xyz<span class="op">-</span>xyz0</a>
<a class="sourceLine" id="cb17-23" title="23">    dx2 <span class="op">=</span> (dx<span class="op">*</span>dx).<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb17-24" title="24">    rmsd <span class="op">=</span> np.sqrt(dx2.mean(axis<span class="op">=</span><span class="dv">1</span>))</a>
<a class="sourceLine" id="cb17-25" title="25">    <span class="cf">return</span> rmsd</a>
<a class="sourceLine" id="cb17-26" title="26"></a>
<a class="sourceLine" id="cb17-27" title="27"></a>
<a class="sourceLine" id="cb17-28" title="28"><span class="co">#print(&quot;Starting rmsd:&quot;, myrmsd(trj, 0))</span></a>
<a class="sourceLine" id="cb17-29" title="29">aligned_trj <span class="op">=</span> trj.superpose(trj, <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb17-30" title="30"></a>
<a class="sourceLine" id="cb17-31" title="31">my_rmsd <span class="op">=</span> myrmsd(aligned_trj, <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb17-32" title="32"><span class="co">#print(&quot;Aligned rmsd:&quot;, my_rmsd)</span></a>
<a class="sourceLine" id="cb17-33" title="33"></a>
<a class="sourceLine" id="cb17-34" title="34">nlcc_trj <span class="op">=</span> align_traj(trj, <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb17-35" title="35">nlcc_rmsd <span class="op">=</span> myrmsd(nlcc_trj, <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb17-36" title="36"></a>
<a class="sourceLine" id="cb17-37" title="37"><span class="co">#print(&quot;nlcc rmsd&quot;, nlcc_rmsd)</span></a>
<a class="sourceLine" id="cb17-38" title="38"></a>
<a class="sourceLine" id="cb17-39" title="39">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">all</span>(np.<span class="bu">abs</span>(my_rmsd <span class="op">-</span> nlcc_rmsd)) <span class="op">&lt;</span> <span class="fl">0.01</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-1">Run 3</h4>
<div class="sourceCode" id="cb19"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb19-1" title="1"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb19-2" title="2"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb19-3" title="3"></a>
<a class="sourceLine" id="cb19-4" title="4"><span class="kw">def</span> align_traj(traj, frame_index):</a>
<a class="sourceLine" id="cb19-5" title="5">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb19-6" title="6"><span class="co">  This function aligns the given mdtraj trajectory to a specific frame</span></a>
<a class="sourceLine" id="cb19-7" title="7"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb19-8" title="8">  traj.superpose(traj, frame<span class="op">=</span>frame_index)</a>
<a class="sourceLine" id="cb19-9" title="9">  <span class="cf">return</span> traj</a>
<a class="sourceLine" id="cb19-10" title="10"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb19-11" title="11"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb19-12" title="12"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb19-13" title="13"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb19-14" title="14"></a>
<a class="sourceLine" id="cb19-15" title="15">pdb_file <span class="op">=</span> os.path.join(_FILE_DIR_, <span class="st">&quot;1VII_twoframe_shifted.pdb&quot;</span>)</a>
<a class="sourceLine" id="cb19-16" title="16">trj <span class="op">=</span> md.load(pdb_file)</a>
<a class="sourceLine" id="cb19-17" title="17"></a>
<a class="sourceLine" id="cb19-18" title="18"></a>
<a class="sourceLine" id="cb19-19" title="19"><span class="kw">def</span> myrmsd(trj, frame):</a>
<a class="sourceLine" id="cb19-20" title="20">    xyz <span class="op">=</span> trj.xyz</a>
<a class="sourceLine" id="cb19-21" title="21">    xyz0 <span class="op">=</span> trj.xyz[frame]</a>
<a class="sourceLine" id="cb19-22" title="22">    dx <span class="op">=</span> xyz<span class="op">-</span>xyz0</a>
<a class="sourceLine" id="cb19-23" title="23">    dx2 <span class="op">=</span> (dx<span class="op">*</span>dx).<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb19-24" title="24">    rmsd <span class="op">=</span> np.sqrt(dx2.mean(axis<span class="op">=</span><span class="dv">1</span>))</a>
<a class="sourceLine" id="cb19-25" title="25">    <span class="cf">return</span> rmsd</a>
<a class="sourceLine" id="cb19-26" title="26"></a>
<a class="sourceLine" id="cb19-27" title="27"></a>
<a class="sourceLine" id="cb19-28" title="28"><span class="co">#print(&quot;Starting rmsd:&quot;, myrmsd(trj, 0))</span></a>
<a class="sourceLine" id="cb19-29" title="29">aligned_trj <span class="op">=</span> trj.superpose(trj, <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb19-30" title="30"></a>
<a class="sourceLine" id="cb19-31" title="31">my_rmsd <span class="op">=</span> myrmsd(aligned_trj, <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb19-32" title="32"><span class="co">#print(&quot;Aligned rmsd:&quot;, my_rmsd)</span></a>
<a class="sourceLine" id="cb19-33" title="33"></a>
<a class="sourceLine" id="cb19-34" title="34">nlcc_trj <span class="op">=</span> align_traj(trj, <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb19-35" title="35">nlcc_rmsd <span class="op">=</span> myrmsd(nlcc_trj, <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb19-36" title="36"></a>
<a class="sourceLine" id="cb19-37" title="37"><span class="co">#print(&quot;nlcc rmsd&quot;, nlcc_rmsd)</span></a>
<a class="sourceLine" id="cb19-38" title="38"></a>
<a class="sourceLine" id="cb19-39" title="39">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">all</span>(np.<span class="bu">abs</span>(my_rmsd <span class="op">-</span> nlcc_rmsd)) <span class="op">&lt;</span> <span class="fl">0.01</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-1">Run 4</h4>
<div class="sourceCode" id="cb21"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb21-1" title="1"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb21-2" title="2"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb21-3" title="3"></a>
<a class="sourceLine" id="cb21-4" title="4"><span class="kw">def</span> align_traj(traj, frame_index):</a>
<a class="sourceLine" id="cb21-5" title="5">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb21-6" title="6"><span class="co">  This function aligns the given mdtraj trajectory to a specific frame</span></a>
<a class="sourceLine" id="cb21-7" title="7"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb21-8" title="8">  traj.superpose(traj, frame<span class="op">=</span>frame_index)</a>
<a class="sourceLine" id="cb21-9" title="9">  <span class="cf">return</span> traj</a>
<a class="sourceLine" id="cb21-10" title="10"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb21-11" title="11"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb21-12" title="12"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb21-13" title="13"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb21-14" title="14"></a>
<a class="sourceLine" id="cb21-15" title="15">pdb_file <span class="op">=</span> os.path.join(_FILE_DIR_, <span class="st">&quot;1VII_twoframe_shifted.pdb&quot;</span>)</a>
<a class="sourceLine" id="cb21-16" title="16">trj <span class="op">=</span> md.load(pdb_file)</a>
<a class="sourceLine" id="cb21-17" title="17"></a>
<a class="sourceLine" id="cb21-18" title="18"></a>
<a class="sourceLine" id="cb21-19" title="19"><span class="kw">def</span> myrmsd(trj, frame):</a>
<a class="sourceLine" id="cb21-20" title="20">    xyz <span class="op">=</span> trj.xyz</a>
<a class="sourceLine" id="cb21-21" title="21">    xyz0 <span class="op">=</span> trj.xyz[frame]</a>
<a class="sourceLine" id="cb21-22" title="22">    dx <span class="op">=</span> xyz<span class="op">-</span>xyz0</a>
<a class="sourceLine" id="cb21-23" title="23">    dx2 <span class="op">=</span> (dx<span class="op">*</span>dx).<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb21-24" title="24">    rmsd <span class="op">=</span> np.sqrt(dx2.mean(axis<span class="op">=</span><span class="dv">1</span>))</a>
<a class="sourceLine" id="cb21-25" title="25">    <span class="cf">return</span> rmsd</a>
<a class="sourceLine" id="cb21-26" title="26"></a>
<a class="sourceLine" id="cb21-27" title="27"></a>
<a class="sourceLine" id="cb21-28" title="28"><span class="co">#print(&quot;Starting rmsd:&quot;, myrmsd(trj, 0))</span></a>
<a class="sourceLine" id="cb21-29" title="29">aligned_trj <span class="op">=</span> trj.superpose(trj, <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb21-30" title="30"></a>
<a class="sourceLine" id="cb21-31" title="31">my_rmsd <span class="op">=</span> myrmsd(aligned_trj, <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb21-32" title="32"><span class="co">#print(&quot;Aligned rmsd:&quot;, my_rmsd)</span></a>
<a class="sourceLine" id="cb21-33" title="33"></a>
<a class="sourceLine" id="cb21-34" title="34">nlcc_trj <span class="op">=</span> align_traj(trj, <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb21-35" title="35">nlcc_rmsd <span class="op">=</span> myrmsd(nlcc_trj, <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb21-36" title="36"></a>
<a class="sourceLine" id="cb21-37" title="37"><span class="co">#print(&quot;nlcc rmsd&quot;, nlcc_rmsd)</span></a>
<a class="sourceLine" id="cb21-38" title="38"></a>
<a class="sourceLine" id="cb21-39" title="39">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">all</span>(np.<span class="bu">abs</span>(my_rmsd <span class="op">-</span> nlcc_rmsd)) <span class="op">&lt;</span> <span class="fl">0.01</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>angle</summary></p>
<h4 id="query-2">Query</h4>
<div class="sourceCode" id="cb23"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb23-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb23-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb23-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb23-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb23-5" title="5"></a>
<a class="sourceLine" id="cb23-6" title="6"><span class="kw">def</span> vector_angle(v1,v2):</a>
<a class="sourceLine" id="cb23-7" title="7">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb23-8" title="8"><span class="co">    This function returns the angle between vector v1 and vector v2.</span></a>
<a class="sourceLine" id="cb23-9" title="9"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb23-10" title="10">    [insert]</a>
<a class="sourceLine" id="cb23-11" title="11">    <span class="cf">return</span> angle</a></code></pre></div>
<h4 id="run-0-2">Run 0</h4>
<div class="sourceCode" id="cb24"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb24-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb24-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb24-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb24-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb24-5" title="5"></a>
<a class="sourceLine" id="cb24-6" title="6"><span class="kw">def</span> vector_angle(v1,v2):</a>
<a class="sourceLine" id="cb24-7" title="7">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb24-8" title="8"><span class="co">    This function returns the angle between vector v1 and vector v2.</span></a>
<a class="sourceLine" id="cb24-9" title="9"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb24-10" title="10">    cosang <span class="op">=</span> np.dot(v1,v2)</a>
<a class="sourceLine" id="cb24-11" title="11">    sinang <span class="op">=</span> np.linalg.norm(np.cross(v1,v2))</a>
<a class="sourceLine" id="cb24-12" title="12">    angle <span class="op">=</span> np.arctan2(sinang,cosang)</a>
<a class="sourceLine" id="cb24-13" title="13">    <span class="cf">return</span> angle</a>
<a class="sourceLine" id="cb24-14" title="14"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb24-15" title="15"></a>
<a class="sourceLine" id="cb24-16" title="16"><span class="kw">def</span> unit_vec(vector):</a>
<a class="sourceLine" id="cb24-17" title="17">    <span class="cf">return</span> vector <span class="op">/</span> np.linalg.norm(vector)</a>
<a class="sourceLine" id="cb24-18" title="18"></a>
<a class="sourceLine" id="cb24-19" title="19">v1 <span class="op">=</span>  [<span class="fl">1.2</span>,<span class="fl">0.5</span>,<span class="fl">0.5</span>]</a>
<a class="sourceLine" id="cb24-20" title="20">v2 <span class="op">=</span>  [<span class="op">-</span><span class="fl">1.5</span>,<span class="fl">2.0</span>,<span class="fl">0.0</span>]</a>
<a class="sourceLine" id="cb24-21" title="21"></a>
<a class="sourceLine" id="cb24-22" title="22">v1_u <span class="op">=</span> unit_vec(v1)</a>
<a class="sourceLine" id="cb24-23" title="23">v2_u <span class="op">=</span> unit_vec(v2)</a>
<a class="sourceLine" id="cb24-24" title="24"></a>
<a class="sourceLine" id="cb24-25" title="25">angle <span class="op">=</span> np.arccos(np.clip(np.dot(v1_u, v2_u), <span class="fl">-1.0</span>, <span class="fl">1.0</span>))</a>
<a class="sourceLine" id="cb24-26" title="26"></a>
<a class="sourceLine" id="cb24-27" title="27">angle_codex <span class="op">=</span>  vector_angle(v1,v2)</a>
<a class="sourceLine" id="cb24-28" title="28"></a>
<a class="sourceLine" id="cb24-29" title="29"><span class="cf">if</span> np.isclose(angle, angle_codex) <span class="op">==</span> <span class="va">True</span>:</a>
<a class="sourceLine" id="cb24-30" title="30">    result <span class="op">=</span> <span class="va">True</span></a>
<a class="sourceLine" id="cb24-31" title="31"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb24-32" title="32">    result <span class="op">=</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-2">Run 1</h4>
<div class="sourceCode" id="cb26"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb26-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb26-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb26-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb26-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb26-5" title="5"></a>
<a class="sourceLine" id="cb26-6" title="6"><span class="kw">def</span> vector_angle(v1,v2):</a>
<a class="sourceLine" id="cb26-7" title="7">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb26-8" title="8"><span class="co">    This function returns the angle between vector v1 and vector v2.</span></a>
<a class="sourceLine" id="cb26-9" title="9"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb26-10" title="10">    v1_u <span class="op">=</span> v1 <span class="op">/</span> np.linalg.norm(v1)</a>
<a class="sourceLine" id="cb26-11" title="11">    v2_u <span class="op">=</span> v2 <span class="op">/</span> np.linalg.norm(v2)</a>
<a class="sourceLine" id="cb26-12" title="12">    angle <span class="op">=</span> np.arccos(np.clip(np.dot(v1_u, v2_u), <span class="fl">-1.0</span>, <span class="fl">1.0</span>))</a>
<a class="sourceLine" id="cb26-13" title="13">    <span class="cf">return</span> angle</a>
<a class="sourceLine" id="cb26-14" title="14"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb26-15" title="15"></a>
<a class="sourceLine" id="cb26-16" title="16"><span class="kw">def</span> unit_vec(vector):</a>
<a class="sourceLine" id="cb26-17" title="17">    <span class="cf">return</span> vector <span class="op">/</span> np.linalg.norm(vector)</a>
<a class="sourceLine" id="cb26-18" title="18"></a>
<a class="sourceLine" id="cb26-19" title="19">v1 <span class="op">=</span>  [<span class="fl">1.2</span>,<span class="fl">0.5</span>,<span class="fl">0.5</span>]</a>
<a class="sourceLine" id="cb26-20" title="20">v2 <span class="op">=</span>  [<span class="op">-</span><span class="fl">1.5</span>,<span class="fl">2.0</span>,<span class="fl">0.0</span>]</a>
<a class="sourceLine" id="cb26-21" title="21"></a>
<a class="sourceLine" id="cb26-22" title="22">v1_u <span class="op">=</span> unit_vec(v1)</a>
<a class="sourceLine" id="cb26-23" title="23">v2_u <span class="op">=</span> unit_vec(v2)</a>
<a class="sourceLine" id="cb26-24" title="24"></a>
<a class="sourceLine" id="cb26-25" title="25">angle <span class="op">=</span> np.arccos(np.clip(np.dot(v1_u, v2_u), <span class="fl">-1.0</span>, <span class="fl">1.0</span>))</a>
<a class="sourceLine" id="cb26-26" title="26"></a>
<a class="sourceLine" id="cb26-27" title="27">angle_codex <span class="op">=</span>  vector_angle(v1,v2)</a>
<a class="sourceLine" id="cb26-28" title="28"></a>
<a class="sourceLine" id="cb26-29" title="29"><span class="cf">if</span> np.isclose(angle, angle_codex) <span class="op">==</span> <span class="va">True</span>:</a>
<a class="sourceLine" id="cb26-30" title="30">    result <span class="op">=</span> <span class="va">True</span></a>
<a class="sourceLine" id="cb26-31" title="31"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb26-32" title="32">    result <span class="op">=</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-2">Run 2</h4>
<div class="sourceCode" id="cb28"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb28-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb28-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb28-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb28-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb28-5" title="5"></a>
<a class="sourceLine" id="cb28-6" title="6"><span class="kw">def</span> vector_angle(v1,v2):</a>
<a class="sourceLine" id="cb28-7" title="7">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb28-8" title="8"><span class="co">    This function returns the angle between vector v1 and vector v2.</span></a>
<a class="sourceLine" id="cb28-9" title="9"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb28-10" title="10">    cosang <span class="op">=</span> np.dot(v1,v2)</a>
<a class="sourceLine" id="cb28-11" title="11">    sinang <span class="op">=</span> np.linalg.norm(np.cross(v1,v2))</a>
<a class="sourceLine" id="cb28-12" title="12">    angle <span class="op">=</span> np.arctan2(sinang,cosang)</a>
<a class="sourceLine" id="cb28-13" title="13">    <span class="cf">return</span> angle</a>
<a class="sourceLine" id="cb28-14" title="14"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb28-15" title="15"></a>
<a class="sourceLine" id="cb28-16" title="16"><span class="kw">def</span> unit_vec(vector):</a>
<a class="sourceLine" id="cb28-17" title="17">    <span class="cf">return</span> vector <span class="op">/</span> np.linalg.norm(vector)</a>
<a class="sourceLine" id="cb28-18" title="18"></a>
<a class="sourceLine" id="cb28-19" title="19">v1 <span class="op">=</span>  [<span class="fl">1.2</span>,<span class="fl">0.5</span>,<span class="fl">0.5</span>]</a>
<a class="sourceLine" id="cb28-20" title="20">v2 <span class="op">=</span>  [<span class="op">-</span><span class="fl">1.5</span>,<span class="fl">2.0</span>,<span class="fl">0.0</span>]</a>
<a class="sourceLine" id="cb28-21" title="21"></a>
<a class="sourceLine" id="cb28-22" title="22">v1_u <span class="op">=</span> unit_vec(v1)</a>
<a class="sourceLine" id="cb28-23" title="23">v2_u <span class="op">=</span> unit_vec(v2)</a>
<a class="sourceLine" id="cb28-24" title="24"></a>
<a class="sourceLine" id="cb28-25" title="25">angle <span class="op">=</span> np.arccos(np.clip(np.dot(v1_u, v2_u), <span class="fl">-1.0</span>, <span class="fl">1.0</span>))</a>
<a class="sourceLine" id="cb28-26" title="26"></a>
<a class="sourceLine" id="cb28-27" title="27">angle_codex <span class="op">=</span>  vector_angle(v1,v2)</a>
<a class="sourceLine" id="cb28-28" title="28"></a>
<a class="sourceLine" id="cb28-29" title="29"><span class="cf">if</span> np.isclose(angle, angle_codex) <span class="op">==</span> <span class="va">True</span>:</a>
<a class="sourceLine" id="cb28-30" title="30">    result <span class="op">=</span> <span class="va">True</span></a>
<a class="sourceLine" id="cb28-31" title="31"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb28-32" title="32">    result <span class="op">=</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-2">Run 3</h4>
<div class="sourceCode" id="cb30"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb30-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb30-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb30-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb30-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb30-5" title="5"></a>
<a class="sourceLine" id="cb30-6" title="6"><span class="kw">def</span> vector_angle(v1,v2):</a>
<a class="sourceLine" id="cb30-7" title="7">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb30-8" title="8"><span class="co">    This function returns the angle between vector v1 and vector v2.</span></a>
<a class="sourceLine" id="cb30-9" title="9"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb30-10" title="10">    v1_u <span class="op">=</span> v1 <span class="op">/</span> np.linalg.norm(v1)</a>
<a class="sourceLine" id="cb30-11" title="11">    v2_u <span class="op">=</span> v2 <span class="op">/</span> np.linalg.norm(v2)</a>
<a class="sourceLine" id="cb30-12" title="12">    angle <span class="op">=</span> np.arccos(np.clip(np.dot(v1_u, v2_u), <span class="fl">-1.0</span>, <span class="fl">1.0</span>))</a>
<a class="sourceLine" id="cb30-13" title="13">    <span class="cf">if</span> np.isnan(angle):</a>
<a class="sourceLine" id="cb30-14" title="14">        <span class="cf">if</span> (v1_u <span class="op">==</span> v2_u).<span class="bu">all</span>():</a>
<a class="sourceLine" id="cb30-15" title="15">            <span class="cf">return</span> <span class="fl">0.0</span></a>
<a class="sourceLine" id="cb30-16" title="16">        <span class="cf">else</span>:</a>
<a class="sourceLine" id="cb30-17" title="17">            <span class="cf">return</span> np.pi</a>
<a class="sourceLine" id="cb30-18" title="18">    <span class="cf">return</span> angle</a>
<a class="sourceLine" id="cb30-19" title="19"></a>
<a class="sourceLine" id="cb30-20" title="20"></a>
<a class="sourceLine" id="cb30-21" title="21">    <span class="cf">return</span> angle</a>
<a class="sourceLine" id="cb30-22" title="22"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb30-23" title="23"></a>
<a class="sourceLine" id="cb30-24" title="24"><span class="kw">def</span> unit_vec(vector):</a>
<a class="sourceLine" id="cb30-25" title="25">    <span class="cf">return</span> vector <span class="op">/</span> np.linalg.norm(vector)</a>
<a class="sourceLine" id="cb30-26" title="26"></a>
<a class="sourceLine" id="cb30-27" title="27">v1 <span class="op">=</span>  [<span class="fl">1.2</span>,<span class="fl">0.5</span>,<span class="fl">0.5</span>]</a>
<a class="sourceLine" id="cb30-28" title="28">v2 <span class="op">=</span>  [<span class="op">-</span><span class="fl">1.5</span>,<span class="fl">2.0</span>,<span class="fl">0.0</span>]</a>
<a class="sourceLine" id="cb30-29" title="29"></a>
<a class="sourceLine" id="cb30-30" title="30">v1_u <span class="op">=</span> unit_vec(v1)</a>
<a class="sourceLine" id="cb30-31" title="31">v2_u <span class="op">=</span> unit_vec(v2)</a>
<a class="sourceLine" id="cb30-32" title="32"></a>
<a class="sourceLine" id="cb30-33" title="33">angle <span class="op">=</span> np.arccos(np.clip(np.dot(v1_u, v2_u), <span class="fl">-1.0</span>, <span class="fl">1.0</span>))</a>
<a class="sourceLine" id="cb30-34" title="34"></a>
<a class="sourceLine" id="cb30-35" title="35">angle_codex <span class="op">=</span>  vector_angle(v1,v2)</a>
<a class="sourceLine" id="cb30-36" title="36"></a>
<a class="sourceLine" id="cb30-37" title="37"><span class="cf">if</span> np.isclose(angle, angle_codex) <span class="op">==</span> <span class="va">True</span>:</a>
<a class="sourceLine" id="cb30-38" title="38">    result <span class="op">=</span> <span class="va">True</span></a>
<a class="sourceLine" id="cb30-39" title="39"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb30-40" title="40">    result <span class="op">=</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-2">Run 4</h4>
<div class="sourceCode" id="cb32"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb32-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb32-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb32-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb32-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb32-5" title="5"></a>
<a class="sourceLine" id="cb32-6" title="6"><span class="kw">def</span> vector_angle(v1,v2):</a>
<a class="sourceLine" id="cb32-7" title="7">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb32-8" title="8"><span class="co">    This function returns the angle between vector v1 and vector v2.</span></a>
<a class="sourceLine" id="cb32-9" title="9"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb32-10" title="10">    cosang <span class="op">=</span> np.dot(v1, v2)</a>
<a class="sourceLine" id="cb32-11" title="11">    sinang <span class="op">=</span> np.linalg.norm(np.cross(v1, v2))</a>
<a class="sourceLine" id="cb32-12" title="12">    angle <span class="op">=</span> np.arctan2(sinang, cosang)</a>
<a class="sourceLine" id="cb32-13" title="13">    angle <span class="op">=</span> np.degrees(angle)</a>
<a class="sourceLine" id="cb32-14" title="14">    <span class="cf">if</span> angle <span class="op">&lt;</span> <span class="dv">0</span>:</a>
<a class="sourceLine" id="cb32-15" title="15">        angle <span class="op">=</span> angle <span class="op">+</span> <span class="dv">360</span></a>
<a class="sourceLine" id="cb32-16" title="16">    <span class="cf">return</span> angle</a>
<a class="sourceLine" id="cb32-17" title="17"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb32-18" title="18"></a>
<a class="sourceLine" id="cb32-19" title="19"><span class="kw">def</span> unit_vec(vector):</a>
<a class="sourceLine" id="cb32-20" title="20">    <span class="cf">return</span> vector <span class="op">/</span> np.linalg.norm(vector)</a>
<a class="sourceLine" id="cb32-21" title="21"></a>
<a class="sourceLine" id="cb32-22" title="22">v1 <span class="op">=</span>  [<span class="fl">1.2</span>,<span class="fl">0.5</span>,<span class="fl">0.5</span>]</a>
<a class="sourceLine" id="cb32-23" title="23">v2 <span class="op">=</span>  [<span class="op">-</span><span class="fl">1.5</span>,<span class="fl">2.0</span>,<span class="fl">0.0</span>]</a>
<a class="sourceLine" id="cb32-24" title="24"></a>
<a class="sourceLine" id="cb32-25" title="25">v1_u <span class="op">=</span> unit_vec(v1)</a>
<a class="sourceLine" id="cb32-26" title="26">v2_u <span class="op">=</span> unit_vec(v2)</a>
<a class="sourceLine" id="cb32-27" title="27"></a>
<a class="sourceLine" id="cb32-28" title="28">angle <span class="op">=</span> np.arccos(np.clip(np.dot(v1_u, v2_u), <span class="fl">-1.0</span>, <span class="fl">1.0</span>))</a>
<a class="sourceLine" id="cb32-29" title="29"></a>
<a class="sourceLine" id="cb32-30" title="30">angle_codex <span class="op">=</span>  vector_angle(v1,v2)</a>
<a class="sourceLine" id="cb32-31" title="31"></a>
<a class="sourceLine" id="cb32-32" title="32"><span class="cf">if</span> np.isclose(angle, angle_codex) <span class="op">==</span> <span class="va">True</span>:</a>
<a class="sourceLine" id="cb32-33" title="33">    result <span class="op">=</span> <span class="va">True</span></a>
<a class="sourceLine" id="cb32-34" title="34"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb32-35" title="35">    result <span class="op">=</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>aromatic_aa</summary></p>
<h4 id="query-3">Query</h4>
<div class="sourceCode" id="cb34"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb34-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb34-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb34-3" title="3"></a>
<a class="sourceLine" id="cb34-4" title="4"><span class="kw">def</span> aromatic_aa(sequence):</a>
<a class="sourceLine" id="cb34-5" title="5">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb34-6" title="6"><span class="co">    This function takes in an amino acid sequence and returns the number of aromatic residues there are</span></a>
<a class="sourceLine" id="cb34-7" title="7"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb34-8" title="8">    [insert]</a>
<a class="sourceLine" id="cb34-9" title="9">    <span class="cf">return</span> count</a></code></pre></div>
<h4 id="run-0-3">Run 0</h4>
<div class="sourceCode" id="cb35"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb35-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb35-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb35-3" title="3"></a>
<a class="sourceLine" id="cb35-4" title="4"><span class="kw">def</span> aromatic_aa(sequence):</a>
<a class="sourceLine" id="cb35-5" title="5">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb35-6" title="6"><span class="co">    This function takes in an amino acid sequence and returns the number of aromatic residues there are</span></a>
<a class="sourceLine" id="cb35-7" title="7"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb35-8" title="8">    count <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb35-9" title="9">    <span class="cf">for</span> i <span class="kw">in</span> sequence:</a>
<a class="sourceLine" id="cb35-10" title="10">        <span class="cf">if</span> i <span class="op">==</span> <span class="st">&#39;F&#39;</span> <span class="kw">or</span> i <span class="op">==</span> <span class="st">&#39;Y&#39;</span> <span class="kw">or</span> i <span class="op">==</span> <span class="st">&#39;W&#39;</span>:</a>
<a class="sourceLine" id="cb35-11" title="11">            count <span class="op">+=</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb35-12" title="12">    <span class="cf">return</span> count</a>
<a class="sourceLine" id="cb35-13" title="13"></a>
<a class="sourceLine" id="cb35-14" title="14">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> aromatic_aa(<span class="st">&quot;FLRYSCV&quot;</span>)<span class="op">==</span><span class="dv">2</span> <span class="cf">else</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb35-15" title="15"></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-3">Run 1</h4>
<div class="sourceCode" id="cb37"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb37-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb37-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb37-3" title="3"></a>
<a class="sourceLine" id="cb37-4" title="4"><span class="kw">def</span> aromatic_aa(sequence):</a>
<a class="sourceLine" id="cb37-5" title="5">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb37-6" title="6"><span class="co">    This function takes in an amino acid sequence and returns the number of aromatic residues there are</span></a>
<a class="sourceLine" id="cb37-7" title="7"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb37-8" title="8">    count <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb37-9" title="9">    <span class="cf">for</span> i <span class="kw">in</span> sequence:</a>
<a class="sourceLine" id="cb37-10" title="10">        <span class="cf">if</span> i <span class="op">==</span> <span class="st">&#39;F&#39;</span> <span class="kw">or</span> i <span class="op">==</span> <span class="st">&#39;Y&#39;</span> <span class="kw">or</span> i <span class="op">==</span> <span class="st">&#39;W&#39;</span>:</a>
<a class="sourceLine" id="cb37-11" title="11">            count <span class="op">+=</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb37-12" title="12">    <span class="cf">return</span> count</a>
<a class="sourceLine" id="cb37-13" title="13"></a>
<a class="sourceLine" id="cb37-14" title="14">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> aromatic_aa(<span class="st">&quot;FLRYSCV&quot;</span>)<span class="op">==</span><span class="dv">2</span> <span class="cf">else</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb37-15" title="15"></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-3">Run 2</h4>
<div class="sourceCode" id="cb39"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb39-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb39-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb39-3" title="3"></a>
<a class="sourceLine" id="cb39-4" title="4"><span class="kw">def</span> aromatic_aa(sequence):</a>
<a class="sourceLine" id="cb39-5" title="5">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb39-6" title="6"><span class="co">    This function takes in an amino acid sequence and returns the number of aromatic residues there are</span></a>
<a class="sourceLine" id="cb39-7" title="7"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb39-8" title="8">    count <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb39-9" title="9">    <span class="cf">for</span> aa <span class="kw">in</span> sequence:</a>
<a class="sourceLine" id="cb39-10" title="10">        <span class="cf">if</span> aa <span class="op">==</span> <span class="st">&#39;F&#39;</span> <span class="kw">or</span> aa <span class="op">==</span> <span class="st">&#39;Y&#39;</span> <span class="kw">or</span> aa <span class="op">==</span> <span class="st">&#39;W&#39;</span>:</a>
<a class="sourceLine" id="cb39-11" title="11">            count <span class="op">+=</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb39-12" title="12">    <span class="cf">return</span> count</a>
<a class="sourceLine" id="cb39-13" title="13"></a>
<a class="sourceLine" id="cb39-14" title="14">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> aromatic_aa(<span class="st">&quot;FLRYSCV&quot;</span>)<span class="op">==</span><span class="dv">2</span> <span class="cf">else</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb39-15" title="15"></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-3">Run 3</h4>
<div class="sourceCode" id="cb41"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb41-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb41-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb41-3" title="3"></a>
<a class="sourceLine" id="cb41-4" title="4"><span class="kw">def</span> aromatic_aa(sequence):</a>
<a class="sourceLine" id="cb41-5" title="5">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb41-6" title="6"><span class="co">    This function takes in an amino acid sequence and returns the number of aromatic residues there are</span></a>
<a class="sourceLine" id="cb41-7" title="7"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb41-8" title="8">    count <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb41-9" title="9">    <span class="cf">for</span> i <span class="kw">in</span> sequence:</a>
<a class="sourceLine" id="cb41-10" title="10">        <span class="cf">if</span> i <span class="op">==</span> <span class="st">&#39;F&#39;</span> <span class="kw">or</span> i <span class="op">==</span> <span class="st">&#39;Y&#39;</span> <span class="kw">or</span> i <span class="op">==</span> <span class="st">&#39;W&#39;</span>:</a>
<a class="sourceLine" id="cb41-11" title="11">            count <span class="op">+=</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb41-12" title="12">    <span class="cf">return</span> count</a>
<a class="sourceLine" id="cb41-13" title="13"></a>
<a class="sourceLine" id="cb41-14" title="14">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> aromatic_aa(<span class="st">&quot;FLRYSCV&quot;</span>)<span class="op">==</span><span class="dv">2</span> <span class="cf">else</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb41-15" title="15"></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-3">Run 4</h4>
<div class="sourceCode" id="cb43"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb43-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb43-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb43-3" title="3"></a>
<a class="sourceLine" id="cb43-4" title="4"><span class="kw">def</span> aromatic_aa(sequence):</a>
<a class="sourceLine" id="cb43-5" title="5">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb43-6" title="6"><span class="co">    This function takes in an amino acid sequence and returns the number of aromatic residues there are</span></a>
<a class="sourceLine" id="cb43-7" title="7"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb43-8" title="8">    count <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb43-9" title="9">    <span class="cf">for</span> aa <span class="kw">in</span> sequence:</a>
<a class="sourceLine" id="cb43-10" title="10">        <span class="cf">if</span> aa <span class="op">==</span> <span class="st">&quot;F&quot;</span> <span class="kw">or</span> aa <span class="op">==</span> <span class="st">&quot;Y&quot;</span> <span class="kw">or</span> aa <span class="op">==</span> <span class="st">&quot;W&quot;</span>:</a>
<a class="sourceLine" id="cb43-11" title="11">            count <span class="op">+=</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb43-12" title="12">    <span class="cf">return</span> count</a>
<a class="sourceLine" id="cb43-13" title="13"></a>
<a class="sourceLine" id="cb43-14" title="14">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> aromatic_aa(<span class="st">&quot;FLRYSCV&quot;</span>)<span class="op">==</span><span class="dv">2</span> <span class="cf">else</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb43-15" title="15"></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>arrhenius</summary></p>
<h4 id="query-4">Query</h4>
<div class="sourceCode" id="cb45"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb45-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb45-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb45-3" title="3"></a>
<a class="sourceLine" id="cb45-4" title="4"><span class="kw">def</span> arrhenius(k2,T2,T1,Ea):</a>
<a class="sourceLine" id="cb45-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb45-6" title="6"><span class="co">   This function returns the value of the rate constant at temperature T1 using the Arrhenius equation</span></a>
<a class="sourceLine" id="cb45-7" title="7"><span class="co">   k2 is the rate constant at temperature T2.</span></a>
<a class="sourceLine" id="cb45-8" title="8"><span class="co">   Ea is the activation energy in J/mol.</span></a>
<a class="sourceLine" id="cb45-9" title="9"><span class="co">   Temperatures are given in Kelvin</span></a>
<a class="sourceLine" id="cb45-10" title="10"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb45-11" title="11">   [insert]</a>
<a class="sourceLine" id="cb45-12" title="12">   <span class="cf">return</span> k1</a></code></pre></div>
<h4 id="run-0-4">Run 0</h4>
<div class="sourceCode" id="cb46"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb46-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb46-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb46-3" title="3"></a>
<a class="sourceLine" id="cb46-4" title="4"><span class="kw">def</span> arrhenius(k2,T2,T1,Ea):</a>
<a class="sourceLine" id="cb46-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb46-6" title="6"><span class="co">   This function returns the value of the rate constant at temperature T1 using the Arrhenius equation</span></a>
<a class="sourceLine" id="cb46-7" title="7"><span class="co">   k2 is the rate constant at temperature T2.</span></a>
<a class="sourceLine" id="cb46-8" title="8"><span class="co">   Ea is the activation energy in J/mol.</span></a>
<a class="sourceLine" id="cb46-9" title="9"><span class="co">   Temperatures are given in Kelvin</span></a>
<a class="sourceLine" id="cb46-10" title="10"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb46-11" title="11">   k1 <span class="op">=</span> k2<span class="op">*</span>math.exp((<span class="op">-</span>Ea<span class="op">/</span><span class="fl">8.314</span>)<span class="op">*</span>((<span class="dv">1</span><span class="op">/</span>T1)<span class="op">-</span>(<span class="dv">1</span><span class="op">/</span>T2)))</a>
<a class="sourceLine" id="cb46-12" title="12">   <span class="cf">return</span> k1</a>
<a class="sourceLine" id="cb46-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb46-14" title="14"></a>
<a class="sourceLine" id="cb46-15" title="15"><span class="co"># inputs</span></a>
<a class="sourceLine" id="cb46-16" title="16">T1 <span class="op">=</span> <span class="fl">308.18</span>   <span class="co"># in K</span></a>
<a class="sourceLine" id="cb46-17" title="17">T2 <span class="op">=</span> <span class="fl">333.18</span>   <span class="co"># in K</span></a>
<a class="sourceLine" id="cb46-18" title="18">R <span class="op">=</span> <span class="fl">8.314</span>     <span class="co"># J/mol.K</span></a>
<a class="sourceLine" id="cb46-19" title="19">Ea <span class="op">=</span> <span class="dv">108000</span>   <span class="co"># J/mol</span></a>
<a class="sourceLine" id="cb46-20" title="20">k2 <span class="op">=</span> <span class="fl">1e-3</span>     <span class="co"># M-1 s-1 </span></a>
<a class="sourceLine" id="cb46-21" title="21"></a>
<a class="sourceLine" id="cb46-22" title="22">k1 <span class="op">=</span> k2<span class="op">*</span>np.exp((<span class="op">-</span>Ea<span class="op">/</span>R) <span class="op">*</span> (<span class="dv">1</span><span class="op">/</span>T1 <span class="op">-</span> <span class="dv">1</span><span class="op">/</span>T2))</a>
<a class="sourceLine" id="cb46-23" title="23">k1_codex <span class="op">=</span> arrhenius(k2,T2,T1,Ea)</a>
<a class="sourceLine" id="cb46-24" title="24"><span class="co">#print(k1,k1_codex)</span></a>
<a class="sourceLine" id="cb46-25" title="25"></a>
<a class="sourceLine" id="cb46-26" title="26"><span class="cf">if</span> np.isclose(k1,k1_codex) <span class="op">==</span> <span class="va">True</span>:</a>
<a class="sourceLine" id="cb46-27" title="27">    result <span class="op">=</span> <span class="va">True</span></a>
<a class="sourceLine" id="cb46-28" title="28"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb46-29" title="29">    result <span class="op">=</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb46-30" title="30"></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-4">Run 1</h4>
<div class="sourceCode" id="cb48"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb48-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb48-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb48-3" title="3"></a>
<a class="sourceLine" id="cb48-4" title="4"><span class="kw">def</span> arrhenius(k2,T2,T1,Ea):</a>
<a class="sourceLine" id="cb48-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb48-6" title="6"><span class="co">   This function returns the value of the rate constant at temperature T1 using the Arrhenius equation</span></a>
<a class="sourceLine" id="cb48-7" title="7"><span class="co">   k2 is the rate constant at temperature T2.</span></a>
<a class="sourceLine" id="cb48-8" title="8"><span class="co">   Ea is the activation energy in J/mol.</span></a>
<a class="sourceLine" id="cb48-9" title="9"><span class="co">   Temperatures are given in Kelvin</span></a>
<a class="sourceLine" id="cb48-10" title="10"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb48-11" title="11">   k1 <span class="op">=</span> k2 <span class="op">*</span> math.exp((Ea<span class="op">/</span><span class="fl">8.314</span>)<span class="op">*</span>((<span class="dv">1</span><span class="op">/</span>T2)<span class="op">-</span>(<span class="dv">1</span><span class="op">/</span>T1)))</a>
<a class="sourceLine" id="cb48-12" title="12">   <span class="cf">return</span> k1</a>
<a class="sourceLine" id="cb48-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb48-14" title="14"></a>
<a class="sourceLine" id="cb48-15" title="15"><span class="co"># inputs</span></a>
<a class="sourceLine" id="cb48-16" title="16">T1 <span class="op">=</span> <span class="fl">308.18</span>   <span class="co"># in K</span></a>
<a class="sourceLine" id="cb48-17" title="17">T2 <span class="op">=</span> <span class="fl">333.18</span>   <span class="co"># in K</span></a>
<a class="sourceLine" id="cb48-18" title="18">R <span class="op">=</span> <span class="fl">8.314</span>     <span class="co"># J/mol.K</span></a>
<a class="sourceLine" id="cb48-19" title="19">Ea <span class="op">=</span> <span class="dv">108000</span>   <span class="co"># J/mol</span></a>
<a class="sourceLine" id="cb48-20" title="20">k2 <span class="op">=</span> <span class="fl">1e-3</span>     <span class="co"># M-1 s-1 </span></a>
<a class="sourceLine" id="cb48-21" title="21"></a>
<a class="sourceLine" id="cb48-22" title="22">k1 <span class="op">=</span> k2<span class="op">*</span>np.exp((<span class="op">-</span>Ea<span class="op">/</span>R) <span class="op">*</span> (<span class="dv">1</span><span class="op">/</span>T1 <span class="op">-</span> <span class="dv">1</span><span class="op">/</span>T2))</a>
<a class="sourceLine" id="cb48-23" title="23">k1_codex <span class="op">=</span> arrhenius(k2,T2,T1,Ea)</a>
<a class="sourceLine" id="cb48-24" title="24"><span class="co">#print(k1,k1_codex)</span></a>
<a class="sourceLine" id="cb48-25" title="25"></a>
<a class="sourceLine" id="cb48-26" title="26"><span class="cf">if</span> np.isclose(k1,k1_codex) <span class="op">==</span> <span class="va">True</span>:</a>
<a class="sourceLine" id="cb48-27" title="27">    result <span class="op">=</span> <span class="va">True</span></a>
<a class="sourceLine" id="cb48-28" title="28"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb48-29" title="29">    result <span class="op">=</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb48-30" title="30"></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-4">Run 2</h4>
<div class="sourceCode" id="cb50"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb50-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb50-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb50-3" title="3"></a>
<a class="sourceLine" id="cb50-4" title="4"><span class="kw">def</span> arrhenius(k2,T2,T1,Ea):</a>
<a class="sourceLine" id="cb50-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb50-6" title="6"><span class="co">   This function returns the value of the rate constant at temperature T1 using the Arrhenius equation</span></a>
<a class="sourceLine" id="cb50-7" title="7"><span class="co">   k2 is the rate constant at temperature T2.</span></a>
<a class="sourceLine" id="cb50-8" title="8"><span class="co">   Ea is the activation energy in J/mol.</span></a>
<a class="sourceLine" id="cb50-9" title="9"><span class="co">   Temperatures are given in Kelvin</span></a>
<a class="sourceLine" id="cb50-10" title="10"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb50-11" title="11">   k1 <span class="op">=</span> k2<span class="op">*</span>math.exp((Ea<span class="op">/</span><span class="fl">8.314</span>)<span class="op">*</span>((<span class="dv">1</span><span class="op">/</span>T2)<span class="op">-</span>(<span class="dv">1</span><span class="op">/</span>T1)))</a>
<a class="sourceLine" id="cb50-12" title="12">   <span class="cf">return</span> k1</a>
<a class="sourceLine" id="cb50-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb50-14" title="14"></a>
<a class="sourceLine" id="cb50-15" title="15"><span class="co"># inputs</span></a>
<a class="sourceLine" id="cb50-16" title="16">T1 <span class="op">=</span> <span class="fl">308.18</span>   <span class="co"># in K</span></a>
<a class="sourceLine" id="cb50-17" title="17">T2 <span class="op">=</span> <span class="fl">333.18</span>   <span class="co"># in K</span></a>
<a class="sourceLine" id="cb50-18" title="18">R <span class="op">=</span> <span class="fl">8.314</span>     <span class="co"># J/mol.K</span></a>
<a class="sourceLine" id="cb50-19" title="19">Ea <span class="op">=</span> <span class="dv">108000</span>   <span class="co"># J/mol</span></a>
<a class="sourceLine" id="cb50-20" title="20">k2 <span class="op">=</span> <span class="fl">1e-3</span>     <span class="co"># M-1 s-1 </span></a>
<a class="sourceLine" id="cb50-21" title="21"></a>
<a class="sourceLine" id="cb50-22" title="22">k1 <span class="op">=</span> k2<span class="op">*</span>np.exp((<span class="op">-</span>Ea<span class="op">/</span>R) <span class="op">*</span> (<span class="dv">1</span><span class="op">/</span>T1 <span class="op">-</span> <span class="dv">1</span><span class="op">/</span>T2))</a>
<a class="sourceLine" id="cb50-23" title="23">k1_codex <span class="op">=</span> arrhenius(k2,T2,T1,Ea)</a>
<a class="sourceLine" id="cb50-24" title="24"><span class="co">#print(k1,k1_codex)</span></a>
<a class="sourceLine" id="cb50-25" title="25"></a>
<a class="sourceLine" id="cb50-26" title="26"><span class="cf">if</span> np.isclose(k1,k1_codex) <span class="op">==</span> <span class="va">True</span>:</a>
<a class="sourceLine" id="cb50-27" title="27">    result <span class="op">=</span> <span class="va">True</span></a>
<a class="sourceLine" id="cb50-28" title="28"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb50-29" title="29">    result <span class="op">=</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb50-30" title="30"></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-4">Run 3</h4>
<div class="sourceCode" id="cb52"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb52-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb52-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb52-3" title="3"></a>
<a class="sourceLine" id="cb52-4" title="4"><span class="kw">def</span> arrhenius(k2,T2,T1,Ea):</a>
<a class="sourceLine" id="cb52-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb52-6" title="6"><span class="co">   This function returns the value of the rate constant at temperature T1 using the Arrhenius equation</span></a>
<a class="sourceLine" id="cb52-7" title="7"><span class="co">   k2 is the rate constant at temperature T2.</span></a>
<a class="sourceLine" id="cb52-8" title="8"><span class="co">   Ea is the activation energy in J/mol.</span></a>
<a class="sourceLine" id="cb52-9" title="9"><span class="co">   Temperatures are given in Kelvin</span></a>
<a class="sourceLine" id="cb52-10" title="10"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb52-11" title="11">   k1 <span class="op">=</span> k2<span class="op">*</span>math.exp((Ea<span class="op">/</span><span class="fl">8.314</span>)<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>T2<span class="dv">-1</span><span class="op">/</span>T1))</a>
<a class="sourceLine" id="cb52-12" title="12">   <span class="cf">return</span> k1</a>
<a class="sourceLine" id="cb52-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb52-14" title="14"></a>
<a class="sourceLine" id="cb52-15" title="15"><span class="co"># inputs</span></a>
<a class="sourceLine" id="cb52-16" title="16">T1 <span class="op">=</span> <span class="fl">308.18</span>   <span class="co"># in K</span></a>
<a class="sourceLine" id="cb52-17" title="17">T2 <span class="op">=</span> <span class="fl">333.18</span>   <span class="co"># in K</span></a>
<a class="sourceLine" id="cb52-18" title="18">R <span class="op">=</span> <span class="fl">8.314</span>     <span class="co"># J/mol.K</span></a>
<a class="sourceLine" id="cb52-19" title="19">Ea <span class="op">=</span> <span class="dv">108000</span>   <span class="co"># J/mol</span></a>
<a class="sourceLine" id="cb52-20" title="20">k2 <span class="op">=</span> <span class="fl">1e-3</span>     <span class="co"># M-1 s-1 </span></a>
<a class="sourceLine" id="cb52-21" title="21"></a>
<a class="sourceLine" id="cb52-22" title="22">k1 <span class="op">=</span> k2<span class="op">*</span>np.exp((<span class="op">-</span>Ea<span class="op">/</span>R) <span class="op">*</span> (<span class="dv">1</span><span class="op">/</span>T1 <span class="op">-</span> <span class="dv">1</span><span class="op">/</span>T2))</a>
<a class="sourceLine" id="cb52-23" title="23">k1_codex <span class="op">=</span> arrhenius(k2,T2,T1,Ea)</a>
<a class="sourceLine" id="cb52-24" title="24"><span class="co">#print(k1,k1_codex)</span></a>
<a class="sourceLine" id="cb52-25" title="25"></a>
<a class="sourceLine" id="cb52-26" title="26"><span class="cf">if</span> np.isclose(k1,k1_codex) <span class="op">==</span> <span class="va">True</span>:</a>
<a class="sourceLine" id="cb52-27" title="27">    result <span class="op">=</span> <span class="va">True</span></a>
<a class="sourceLine" id="cb52-28" title="28"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb52-29" title="29">    result <span class="op">=</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb52-30" title="30"></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-4">Run 4</h4>
<div class="sourceCode" id="cb54"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb54-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb54-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb54-3" title="3"></a>
<a class="sourceLine" id="cb54-4" title="4"><span class="kw">def</span> arrhenius(k2,T2,T1,Ea):</a>
<a class="sourceLine" id="cb54-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb54-6" title="6"><span class="co">   This function returns the value of the rate constant at temperature T1 using the Arrhenius equation</span></a>
<a class="sourceLine" id="cb54-7" title="7"><span class="co">   k2 is the rate constant at temperature T2.</span></a>
<a class="sourceLine" id="cb54-8" title="8"><span class="co">   Ea is the activation energy in J/mol.</span></a>
<a class="sourceLine" id="cb54-9" title="9"><span class="co">   Temperatures are given in Kelvin</span></a>
<a class="sourceLine" id="cb54-10" title="10"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb54-11" title="11">   k1 <span class="op">=</span> k2<span class="op">*</span>math.exp((Ea<span class="op">/</span><span class="fl">8.314</span>)<span class="op">*</span>((<span class="dv">1</span><span class="op">/</span>T2)<span class="op">-</span>(<span class="dv">1</span><span class="op">/</span>T1)))</a>
<a class="sourceLine" id="cb54-12" title="12">   <span class="cf">return</span> k1</a>
<a class="sourceLine" id="cb54-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb54-14" title="14"></a>
<a class="sourceLine" id="cb54-15" title="15"><span class="co"># inputs</span></a>
<a class="sourceLine" id="cb54-16" title="16">T1 <span class="op">=</span> <span class="fl">308.18</span>   <span class="co"># in K</span></a>
<a class="sourceLine" id="cb54-17" title="17">T2 <span class="op">=</span> <span class="fl">333.18</span>   <span class="co"># in K</span></a>
<a class="sourceLine" id="cb54-18" title="18">R <span class="op">=</span> <span class="fl">8.314</span>     <span class="co"># J/mol.K</span></a>
<a class="sourceLine" id="cb54-19" title="19">Ea <span class="op">=</span> <span class="dv">108000</span>   <span class="co"># J/mol</span></a>
<a class="sourceLine" id="cb54-20" title="20">k2 <span class="op">=</span> <span class="fl">1e-3</span>     <span class="co"># M-1 s-1 </span></a>
<a class="sourceLine" id="cb54-21" title="21"></a>
<a class="sourceLine" id="cb54-22" title="22">k1 <span class="op">=</span> k2<span class="op">*</span>np.exp((<span class="op">-</span>Ea<span class="op">/</span>R) <span class="op">*</span> (<span class="dv">1</span><span class="op">/</span>T1 <span class="op">-</span> <span class="dv">1</span><span class="op">/</span>T2))</a>
<a class="sourceLine" id="cb54-23" title="23">k1_codex <span class="op">=</span> arrhenius(k2,T2,T1,Ea)</a>
<a class="sourceLine" id="cb54-24" title="24"><span class="co">#print(k1,k1_codex)</span></a>
<a class="sourceLine" id="cb54-25" title="25"></a>
<a class="sourceLine" id="cb54-26" title="26"><span class="cf">if</span> np.isclose(k1,k1_codex) <span class="op">==</span> <span class="va">True</span>:</a>
<a class="sourceLine" id="cb54-27" title="27">    result <span class="op">=</span> <span class="va">True</span></a>
<a class="sourceLine" id="cb54-28" title="28"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb54-29" title="29">    result <span class="op">=</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb54-30" title="30"></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>bimolecular</summary></p>
<h4 id="query-5">Query</h4>
<div class="sourceCode" id="cb56"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb56-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb56-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb56-3" title="3"></a>
<a class="sourceLine" id="cb56-4" title="4"><span class="kw">def</span> bimolecular_rate(k,A,B):</a>
<a class="sourceLine" id="cb56-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb56-6" title="6"><span class="co">   This function returns the rate of reaction given the rate constant k and concentrations of species A and B</span></a>
<a class="sourceLine" id="cb56-7" title="7"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb56-8" title="8">   [insert]</a>
<a class="sourceLine" id="cb56-9" title="9">   <span class="cf">return</span> rate</a></code></pre></div>
<h4 id="run-0-5">Run 0</h4>
<div class="sourceCode" id="cb57"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb57-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb57-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb57-3" title="3"></a>
<a class="sourceLine" id="cb57-4" title="4"><span class="kw">def</span> bimolecular_rate(k,A,B):</a>
<a class="sourceLine" id="cb57-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb57-6" title="6"><span class="co">   This function returns the rate of reaction given the rate constant k and concentrations of species A and B</span></a>
<a class="sourceLine" id="cb57-7" title="7"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb57-8" title="8">   rate <span class="op">=</span> k<span class="op">*</span>A<span class="op">*</span>B</a>
<a class="sourceLine" id="cb57-9" title="9">   <span class="cf">return</span> rate</a>
<a class="sourceLine" id="cb57-10" title="10"></a>
<a class="sourceLine" id="cb57-11" title="11"></a>
<a class="sourceLine" id="cb57-12" title="12">   <span class="cf">return</span> rate</a>
<a class="sourceLine" id="cb57-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb57-14" title="14"></a>
<a class="sourceLine" id="cb57-15" title="15">k <span class="op">=</span> <span class="dv">2</span></a>
<a class="sourceLine" id="cb57-16" title="16">A <span class="op">=</span> <span class="fl">0.1</span></a>
<a class="sourceLine" id="cb57-17" title="17">B <span class="op">=</span> <span class="fl">0.2</span></a>
<a class="sourceLine" id="cb57-18" title="18">rate <span class="op">=</span> k<span class="op">*</span>A<span class="op">*</span>B</a>
<a class="sourceLine" id="cb57-19" title="19"></a>
<a class="sourceLine" id="cb57-20" title="20">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(rate,bimolecular_rate(k,A,B)) <span class="cf">else</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb57-21" title="21"></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-5">Run 1</h4>
<div class="sourceCode" id="cb59"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb59-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb59-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb59-3" title="3"></a>
<a class="sourceLine" id="cb59-4" title="4"><span class="kw">def</span> bimolecular_rate(k,A,B):</a>
<a class="sourceLine" id="cb59-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb59-6" title="6"><span class="co">   This function returns the rate of reaction given the rate constant k and concentrations of species A and B</span></a>
<a class="sourceLine" id="cb59-7" title="7"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb59-8" title="8">   rate <span class="op">=</span> k<span class="op">*</span>A<span class="op">*</span>B</a>
<a class="sourceLine" id="cb59-9" title="9"></a>
<a class="sourceLine" id="cb59-10" title="10">   <span class="cf">return</span> rate</a>
<a class="sourceLine" id="cb59-11" title="11"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb59-12" title="12"></a>
<a class="sourceLine" id="cb59-13" title="13">k <span class="op">=</span> <span class="dv">2</span></a>
<a class="sourceLine" id="cb59-14" title="14">A <span class="op">=</span> <span class="fl">0.1</span></a>
<a class="sourceLine" id="cb59-15" title="15">B <span class="op">=</span> <span class="fl">0.2</span></a>
<a class="sourceLine" id="cb59-16" title="16">rate <span class="op">=</span> k<span class="op">*</span>A<span class="op">*</span>B</a>
<a class="sourceLine" id="cb59-17" title="17"></a>
<a class="sourceLine" id="cb59-18" title="18">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(rate,bimolecular_rate(k,A,B)) <span class="cf">else</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb59-19" title="19"></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-5">Run 2</h4>
<div class="sourceCode" id="cb61"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb61-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb61-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb61-3" title="3"></a>
<a class="sourceLine" id="cb61-4" title="4"><span class="kw">def</span> bimolecular_rate(k,A,B):</a>
<a class="sourceLine" id="cb61-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb61-6" title="6"><span class="co">   This function returns the rate of reaction given the rate constant k and concentrations of species A and B</span></a>
<a class="sourceLine" id="cb61-7" title="7"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb61-8" title="8">   rate <span class="op">=</span> k<span class="op">*</span>A<span class="op">*</span>B</a>
<a class="sourceLine" id="cb61-9" title="9"></a>
<a class="sourceLine" id="cb61-10" title="10">   <span class="cf">return</span> rate</a>
<a class="sourceLine" id="cb61-11" title="11"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb61-12" title="12"></a>
<a class="sourceLine" id="cb61-13" title="13">k <span class="op">=</span> <span class="dv">2</span></a>
<a class="sourceLine" id="cb61-14" title="14">A <span class="op">=</span> <span class="fl">0.1</span></a>
<a class="sourceLine" id="cb61-15" title="15">B <span class="op">=</span> <span class="fl">0.2</span></a>
<a class="sourceLine" id="cb61-16" title="16">rate <span class="op">=</span> k<span class="op">*</span>A<span class="op">*</span>B</a>
<a class="sourceLine" id="cb61-17" title="17"></a>
<a class="sourceLine" id="cb61-18" title="18">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(rate,bimolecular_rate(k,A,B)) <span class="cf">else</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb61-19" title="19"></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-5">Run 3</h4>
<div class="sourceCode" id="cb63"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb63-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb63-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb63-3" title="3"></a>
<a class="sourceLine" id="cb63-4" title="4"><span class="kw">def</span> bimolecular_rate(k,A,B):</a>
<a class="sourceLine" id="cb63-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb63-6" title="6"><span class="co">   This function returns the rate of reaction given the rate constant k and concentrations of species A and B</span></a>
<a class="sourceLine" id="cb63-7" title="7"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb63-8" title="8">   rate <span class="op">=</span> k<span class="op">*</span>A<span class="op">*</span>B</a>
<a class="sourceLine" id="cb63-9" title="9">   <span class="cf">return</span> rate</a>
<a class="sourceLine" id="cb63-10" title="10"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb63-11" title="11"></a>
<a class="sourceLine" id="cb63-12" title="12">k <span class="op">=</span> <span class="dv">2</span></a>
<a class="sourceLine" id="cb63-13" title="13">A <span class="op">=</span> <span class="fl">0.1</span></a>
<a class="sourceLine" id="cb63-14" title="14">B <span class="op">=</span> <span class="fl">0.2</span></a>
<a class="sourceLine" id="cb63-15" title="15">rate <span class="op">=</span> k<span class="op">*</span>A<span class="op">*</span>B</a>
<a class="sourceLine" id="cb63-16" title="16"></a>
<a class="sourceLine" id="cb63-17" title="17">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(rate,bimolecular_rate(k,A,B)) <span class="cf">else</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb63-18" title="18"></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-5">Run 4</h4>
<div class="sourceCode" id="cb65"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb65-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb65-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb65-3" title="3"></a>
<a class="sourceLine" id="cb65-4" title="4"><span class="kw">def</span> bimolecular_rate(k,A,B):</a>
<a class="sourceLine" id="cb65-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb65-6" title="6"><span class="co">   This function returns the rate of reaction given the rate constant k and concentrations of species A and B</span></a>
<a class="sourceLine" id="cb65-7" title="7"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb65-8" title="8">   rate <span class="op">=</span> k<span class="op">*</span>A<span class="op">*</span>B</a>
<a class="sourceLine" id="cb65-9" title="9"></a>
<a class="sourceLine" id="cb65-10" title="10">   <span class="cf">return</span> rate</a>
<a class="sourceLine" id="cb65-11" title="11"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb65-12" title="12"></a>
<a class="sourceLine" id="cb65-13" title="13">k <span class="op">=</span> <span class="dv">2</span></a>
<a class="sourceLine" id="cb65-14" title="14">A <span class="op">=</span> <span class="fl">0.1</span></a>
<a class="sourceLine" id="cb65-15" title="15">B <span class="op">=</span> <span class="fl">0.2</span></a>
<a class="sourceLine" id="cb65-16" title="16">rate <span class="op">=</span> k<span class="op">*</span>A<span class="op">*</span>B</a>
<a class="sourceLine" id="cb65-17" title="17"></a>
<a class="sourceLine" id="cb65-18" title="18">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(rate,bimolecular_rate(k,A,B)) <span class="cf">else</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb65-19" title="19"></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>blast</summary></p>
<h4 id="query-6">Query</h4>
<div class="sourceCode" id="cb67"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb67-1" title="1"><span class="im">import</span> requests</a>
<a class="sourceLine" id="cb67-2" title="2"></a>
<a class="sourceLine" id="cb67-3" title="3"><span class="kw">def</span> blast(seq):</a>
<a class="sourceLine" id="cb67-4" title="4">    <span class="co">&#39;&#39;&#39;</span></a>
<a class="sourceLine" id="cb67-5" title="5"><span class="co">    Returns MSA with a BLAST search. Uses beautiful soup</span></a>
<a class="sourceLine" id="cb67-6" title="6"><span class="co">    to parse result.</span></a>
<a class="sourceLine" id="cb67-7" title="7"></a>
<a class="sourceLine" id="cb67-8" title="8"><span class="co">    1. import packages</span></a>
<a class="sourceLine" id="cb67-9" title="9"><span class="co">    2. Submit BLAST search with sequences</span></a>
<a class="sourceLine" id="cb67-10" title="10"><span class="co">    3. Get result</span></a>
<a class="sourceLine" id="cb67-11" title="11"><span class="co">    4. Parse MSA</span></a>
<a class="sourceLine" id="cb67-12" title="12"><span class="co">    5. Return a tuple of e score, id of top match</span></a>
<a class="sourceLine" id="cb67-13" title="13"><span class="co">    &#39;&#39;&#39;</span></a>
<a class="sourceLine" id="cb67-14" title="14">    [insert]</a>
<a class="sourceLine" id="cb67-15" title="15">    <span class="cf">return</span> e, <span class="bu">id</span></a></code></pre></div>
<h4 id="run-0-6">Run 0</h4>
<div class="sourceCode" id="cb68"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb68-1" title="1"><span class="im">import</span> requests</a>
<a class="sourceLine" id="cb68-2" title="2"></a>
<a class="sourceLine" id="cb68-3" title="3"><span class="kw">def</span> blast(seq):</a>
<a class="sourceLine" id="cb68-4" title="4">    <span class="co">&#39;&#39;&#39;</span></a>
<a class="sourceLine" id="cb68-5" title="5"><span class="co">    Returns MSA with a BLAST search. Uses beautiful soup</span></a>
<a class="sourceLine" id="cb68-6" title="6"><span class="co">    to parse result.</span></a>
<a class="sourceLine" id="cb68-7" title="7"></a>
<a class="sourceLine" id="cb68-8" title="8"><span class="co">    1. import packages</span></a>
<a class="sourceLine" id="cb68-9" title="9"><span class="co">    2. Submit BLAST search with sequences</span></a>
<a class="sourceLine" id="cb68-10" title="10"><span class="co">    3. Get result</span></a>
<a class="sourceLine" id="cb68-11" title="11"><span class="co">    4. Parse MSA</span></a>
<a class="sourceLine" id="cb68-12" title="12"><span class="co">    5. Return a tuple of e score, id of top match</span></a>
<a class="sourceLine" id="cb68-13" title="13"><span class="co">    &#39;&#39;&#39;</span></a>
<a class="sourceLine" id="cb68-14" title="14">    <span class="im">from</span> bs4 <span class="im">import</span> BeautifulSoup</a>
<a class="sourceLine" id="cb68-15" title="15">    <span class="im">import</span> re</a>
<a class="sourceLine" id="cb68-16" title="16"></a>
<a class="sourceLine" id="cb68-17" title="17">    <span class="co"># Submit BLAST search with sequences</span></a>
<a class="sourceLine" id="cb68-18" title="18">    r <span class="op">=</span> requests.post(<span class="st">&#39;http://blast.ncbi.nlm.nih.gov/Blast.cgi&#39;</span>,</a>
<a class="sourceLine" id="cb68-19" title="19">                      data<span class="op">=</span>{<span class="st">&#39;QUERY&#39;</span>: seq,</a>
<a class="sourceLine" id="cb68-20" title="20">                            <span class="st">&#39;PROGRAM&#39;</span>: <span class="st">&#39;blastn&#39;</span>,</a>
<a class="sourceLine" id="cb68-21" title="21">                            <span class="st">&#39;DATABASE&#39;</span>: <span class="st">&#39;nr&#39;</span>,</a>
<a class="sourceLine" id="cb68-22" title="22">                            <span class="st">&#39;CMD&#39;</span>: <span class="st">&#39;Put&#39;</span>})</a>
<a class="sourceLine" id="cb68-23" title="23"></a>
<a class="sourceLine" id="cb68-24" title="24">    <span class="co"># Get result</span></a>
<a class="sourceLine" id="cb68-25" title="25">    soup <span class="op">=</span> BeautifulSoup(r.text, <span class="st">&#39;html.parser&#39;</span>)</a>
<a class="sourceLine" id="cb68-26" title="26">    msa <span class="op">=</span> soup.find(<span class="st">&#39;pre&#39;</span>).text</a>
<a class="sourceLine" id="cb68-27" title="27"></a>
<a class="sourceLine" id="cb68-28" title="28">    <span class="co"># Parse MSA</span></a>
<a class="sourceLine" id="cb68-29" title="29">    msa <span class="op">=</span> re.sub(<span class="st">&#39;[^A-Za-z</span><span class="ch">\n</span><span class="st">]&#39;</span>, <span class="st">&#39;&#39;</span>, msa)</a>
<a class="sourceLine" id="cb68-30" title="30">    msa <span class="op">=</span> msa.split(<span class="st">&#39;</span><span class="ch">\n</span><span class="st">&#39;</span>)</a>
<a class="sourceLine" id="cb68-31" title="31">    msa <span class="op">=</span> [x <span class="cf">for</span> x <span class="kw">in</span> msa <span class="cf">if</span> x <span class="op">!=</span> <span class="st">&#39;&#39;</span>]</a>
<a class="sourceLine" id="cb68-32" title="32"></a>
<a class="sourceLine" id="cb68-33" title="33">    <span class="co"># Return a tuple of e score, id of top match</span></a>
<a class="sourceLine" id="cb68-34" title="34">    e <span class="op">=</span> soup.find(<span class="st">&#39;td&#39;</span>, text<span class="op">=</span><span class="st">&#39;Expect =&#39;</span>).find_next_sibling().text</a>
<a class="sourceLine" id="cb68-35" title="35">    <span class="bu">id</span> <span class="op">=</span> soup.find(<span class="st">&#39;td&#39;</span>, text<span class="op">=</span><span class="st">&#39;&gt;&#39;</span>).find_next_sibling().text</a>
<a class="sourceLine" id="cb68-36" title="36"></a>
<a class="sourceLine" id="cb68-37" title="37">    <span class="cf">return</span> e, <span class="bu">id</span></a>
<a class="sourceLine" id="cb68-38" title="38">e, <span class="bu">id</span> <span class="op">=</span> blast(<span class="st">&#39;&gt;seq1</span><span class="ch">\n</span><span class="st">&#39;</span></a>
<a class="sourceLine" id="cb68-39" title="39">              <span class="st">&#39;PNFYVPFSNATGVVRSPFEYPQYYLAEPWQFSMLAAYMFLLIVLGFPINFLTLYVTVQ&#39;</span>)</a>
<a class="sourceLine" id="cb68-40" title="40">result <span class="op">=</span> <span class="bu">float</span>(e) <span class="op">&lt;</span> <span class="fl">1e-30</span></a></code></pre></div>
<p>Output:</p>
<pre><code>&#39;NoneType&#39; object has no attribute &#39;text&#39;</code></pre>
<h4 id="run-1-6">Run 1</h4>
<div class="sourceCode" id="cb70"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb70-1" title="1"><span class="im">import</span> requests</a>
<a class="sourceLine" id="cb70-2" title="2"></a>
<a class="sourceLine" id="cb70-3" title="3"><span class="kw">def</span> blast(seq):</a>
<a class="sourceLine" id="cb70-4" title="4">    <span class="co">&#39;&#39;&#39;</span></a>
<a class="sourceLine" id="cb70-5" title="5"><span class="co">    Returns MSA with a BLAST search. Uses beautiful soup</span></a>
<a class="sourceLine" id="cb70-6" title="6"><span class="co">    to parse result.</span></a>
<a class="sourceLine" id="cb70-7" title="7"></a>
<a class="sourceLine" id="cb70-8" title="8"><span class="co">    1. import packages</span></a>
<a class="sourceLine" id="cb70-9" title="9"><span class="co">    2. Submit BLAST search with sequences</span></a>
<a class="sourceLine" id="cb70-10" title="10"><span class="co">    3. Get result</span></a>
<a class="sourceLine" id="cb70-11" title="11"><span class="co">    4. Parse MSA</span></a>
<a class="sourceLine" id="cb70-12" title="12"><span class="co">    5. Return a tuple of e score, id of top match</span></a>
<a class="sourceLine" id="cb70-13" title="13"><span class="co">    &#39;&#39;&#39;</span></a>
<a class="sourceLine" id="cb70-14" title="14">    <span class="im">from</span> bs4 <span class="im">import</span> BeautifulSoup</a>
<a class="sourceLine" id="cb70-15" title="15">    <span class="im">from</span> Bio.Blast <span class="im">import</span> NCBIWWW</a>
<a class="sourceLine" id="cb70-16" title="16">    <span class="im">from</span> Bio.Blast <span class="im">import</span> NCBIXML</a>
<a class="sourceLine" id="cb70-17" title="17">    <span class="im">from</span> Bio <span class="im">import</span> SeqIO</a>
<a class="sourceLine" id="cb70-18" title="18">    <span class="im">from</span> Bio.Seq <span class="im">import</span> Seq</a>
<a class="sourceLine" id="cb70-19" title="19">    <span class="im">from</span> Bio.SeqRecord <span class="im">import</span> SeqRecord</a>
<a class="sourceLine" id="cb70-20" title="20">    <span class="im">from</span> Bio.Alphabet <span class="im">import</span> IUPAC</a>
<a class="sourceLine" id="cb70-21" title="21"></a>
<a class="sourceLine" id="cb70-22" title="22">    <span class="co"># 1. import packages</span></a>
<a class="sourceLine" id="cb70-23" title="23">    <span class="co"># 2. Submit BLAST search with sequences</span></a>
<a class="sourceLine" id="cb70-24" title="24">    result_handle <span class="op">=</span> NCBIWWW.qblast(<span class="st">&quot;blastn&quot;</span>, <span class="st">&quot;nt&quot;</span>, seq)</a>
<a class="sourceLine" id="cb70-25" title="25">    <span class="co"># 3. Get result</span></a>
<a class="sourceLine" id="cb70-26" title="26">    blast_records <span class="op">=</span> NCBIXML.parse(result_handle)</a>
<a class="sourceLine" id="cb70-27" title="27">    <span class="co"># 4. Parse MSA</span></a>
<a class="sourceLine" id="cb70-28" title="28">    <span class="cf">for</span> blast_record <span class="kw">in</span> blast_records:</a>
<a class="sourceLine" id="cb70-29" title="29">        <span class="cf">for</span> alignment <span class="kw">in</span> blast_record.alignments:</a>
<a class="sourceLine" id="cb70-30" title="30">            <span class="cf">for</span> hsp <span class="kw">in</span> alignment.hsps:</a>
<a class="sourceLine" id="cb70-31" title="31">                e <span class="op">=</span> hsp.expect</a>
<a class="sourceLine" id="cb70-32" title="32">                <span class="bu">id</span> <span class="op">=</span> alignment.title</a>
<a class="sourceLine" id="cb70-33" title="33">    <span class="co"># 5. Return a tuple of e score, id of top match</span></a>
<a class="sourceLine" id="cb70-34" title="34">    <span class="cf">return</span> e, <span class="bu">id</span></a>
<a class="sourceLine" id="cb70-35" title="35">e, <span class="bu">id</span> <span class="op">=</span> blast(<span class="st">&#39;&gt;seq1</span><span class="ch">\n</span><span class="st">&#39;</span></a>
<a class="sourceLine" id="cb70-36" title="36">              <span class="st">&#39;PNFYVPFSNATGVVRSPFEYPQYYLAEPWQFSMLAAYMFLLIVLGFPINFLTLYVTVQ&#39;</span>)</a>
<a class="sourceLine" id="cb70-37" title="37">result <span class="op">=</span> <span class="bu">float</span>(e) <span class="op">&lt;</span> <span class="fl">1e-30</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Error message from NCBI: Message ID#24 Error: Failed to read the Blast query: Protein FASTA provided for nucleotide sequence</code></pre>
<h4 id="run-2-6">Run 2</h4>
<div class="sourceCode" id="cb72"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb72-1" title="1"><span class="im">import</span> requests</a>
<a class="sourceLine" id="cb72-2" title="2"></a>
<a class="sourceLine" id="cb72-3" title="3"><span class="kw">def</span> blast(seq):</a>
<a class="sourceLine" id="cb72-4" title="4">    <span class="co">&#39;&#39;&#39;</span></a>
<a class="sourceLine" id="cb72-5" title="5"><span class="co">    Returns MSA with a BLAST search. Uses beautiful soup</span></a>
<a class="sourceLine" id="cb72-6" title="6"><span class="co">    to parse result.</span></a>
<a class="sourceLine" id="cb72-7" title="7"></a>
<a class="sourceLine" id="cb72-8" title="8"><span class="co">    1. import packages</span></a>
<a class="sourceLine" id="cb72-9" title="9"><span class="co">    2. Submit BLAST search with sequences</span></a>
<a class="sourceLine" id="cb72-10" title="10"><span class="co">    3. Get result</span></a>
<a class="sourceLine" id="cb72-11" title="11"><span class="co">    4. Parse MSA</span></a>
<a class="sourceLine" id="cb72-12" title="12"><span class="co">    5. Return a tuple of e score, id of top match</span></a>
<a class="sourceLine" id="cb72-13" title="13"><span class="co">    &#39;&#39;&#39;</span></a>
<a class="sourceLine" id="cb72-14" title="14">    <span class="im">from</span> bs4 <span class="im">import</span> BeautifulSoup</a>
<a class="sourceLine" id="cb72-15" title="15">    <span class="im">from</span> Bio.Blast <span class="im">import</span> NCBIWWW</a>
<a class="sourceLine" id="cb72-16" title="16">    <span class="im">from</span> Bio <span class="im">import</span> SeqIO</a>
<a class="sourceLine" id="cb72-17" title="17">    <span class="im">from</span> Bio.Seq <span class="im">import</span> Seq</a>
<a class="sourceLine" id="cb72-18" title="18">    <span class="im">from</span> Bio.SeqRecord <span class="im">import</span> SeqRecord</a>
<a class="sourceLine" id="cb72-19" title="19">    <span class="im">from</span> Bio.Alphabet <span class="im">import</span> generic_dna</a>
<a class="sourceLine" id="cb72-20" title="20"></a>
<a class="sourceLine" id="cb72-21" title="21">    <span class="co"># Submit BLAST search with sequences</span></a>
<a class="sourceLine" id="cb72-22" title="22">    result_handle <span class="op">=</span> NCBIWWW.qblast(<span class="st">&quot;blastn&quot;</span>, <span class="st">&quot;nt&quot;</span>, seq)</a>
<a class="sourceLine" id="cb72-23" title="23"></a>
<a class="sourceLine" id="cb72-24" title="24">    <span class="co"># Get result</span></a>
<a class="sourceLine" id="cb72-25" title="25">    blast_record <span class="op">=</span> NCBIWWW.read(result_handle)</a>
<a class="sourceLine" id="cb72-26" title="26"></a>
<a class="sourceLine" id="cb72-27" title="27">    <span class="co"># Parse MSA</span></a>
<a class="sourceLine" id="cb72-28" title="28">    e <span class="op">=</span> blast_record.alignments[<span class="dv">0</span>].hsps[<span class="dv">0</span>].expect</a>
<a class="sourceLine" id="cb72-29" title="29">    <span class="bu">id</span> <span class="op">=</span> blast_record.alignments[<span class="dv">0</span>].hit_id</a>
<a class="sourceLine" id="cb72-30" title="30"></a>
<a class="sourceLine" id="cb72-31" title="31">    <span class="cf">return</span> e, <span class="bu">id</span></a>
<a class="sourceLine" id="cb72-32" title="32">e, <span class="bu">id</span> <span class="op">=</span> blast(<span class="st">&#39;&gt;seq1</span><span class="ch">\n</span><span class="st">&#39;</span></a>
<a class="sourceLine" id="cb72-33" title="33">              <span class="st">&#39;PNFYVPFSNATGVVRSPFEYPQYYLAEPWQFSMLAAYMFLLIVLGFPINFLTLYVTVQ&#39;</span>)</a>
<a class="sourceLine" id="cb72-34" title="34">result <span class="op">=</span> <span class="bu">float</span>(e) <span class="op">&lt;</span> <span class="fl">1e-30</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Error message from NCBI: Message ID#24 Error: Failed to read the Blast query: Protein FASTA provided for nucleotide sequence</code></pre>
<h4 id="run-3-6">Run 3</h4>
<div class="sourceCode" id="cb74"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb74-1" title="1"><span class="im">import</span> requests</a>
<a class="sourceLine" id="cb74-2" title="2"></a>
<a class="sourceLine" id="cb74-3" title="3"><span class="kw">def</span> blast(seq):</a>
<a class="sourceLine" id="cb74-4" title="4">    <span class="co">&#39;&#39;&#39;</span></a>
<a class="sourceLine" id="cb74-5" title="5"><span class="co">    Returns MSA with a BLAST search. Uses beautiful soup</span></a>
<a class="sourceLine" id="cb74-6" title="6"><span class="co">    to parse result.</span></a>
<a class="sourceLine" id="cb74-7" title="7"></a>
<a class="sourceLine" id="cb74-8" title="8"><span class="co">    1. import packages</span></a>
<a class="sourceLine" id="cb74-9" title="9"><span class="co">    2. Submit BLAST search with sequences</span></a>
<a class="sourceLine" id="cb74-10" title="10"><span class="co">    3. Get result</span></a>
<a class="sourceLine" id="cb74-11" title="11"><span class="co">    4. Parse MSA</span></a>
<a class="sourceLine" id="cb74-12" title="12"><span class="co">    5. Return a tuple of e score, id of top match</span></a>
<a class="sourceLine" id="cb74-13" title="13"><span class="co">    &#39;&#39;&#39;</span></a>
<a class="sourceLine" id="cb74-14" title="14">    <span class="im">from</span> bs4 <span class="im">import</span> BeautifulSoup</a>
<a class="sourceLine" id="cb74-15" title="15">    <span class="im">from</span> Bio.Blast <span class="im">import</span> NCBIWWW</a>
<a class="sourceLine" id="cb74-16" title="16">    <span class="im">from</span> Bio.Blast <span class="im">import</span> NCBIXML</a>
<a class="sourceLine" id="cb74-17" title="17">    <span class="im">from</span> Bio.Blast.Applications <span class="im">import</span> NcbiblastpCommandline</a>
<a class="sourceLine" id="cb74-18" title="18">    <span class="im">from</span> Bio.Blast.Applications <span class="im">import</span> NcbiblastnCommandline</a>
<a class="sourceLine" id="cb74-19" title="19">    <span class="im">from</span> Bio.Blast.Applications <span class="im">import</span> NcbiblastxCommandline</a>
<a class="sourceLine" id="cb74-20" title="20">    <span class="im">from</span> Bio.Blast.Applications <span class="im">import</span> NcbimakeblastdbCommandline</a>
<a class="sourceLine" id="cb74-21" title="21">    <span class="im">from</span> Bio.Blast.Applications <span class="im">import</span> NcbirpsblastCommandline</a>
<a class="sourceLine" id="cb74-22" title="22">    <span class="im">from</span> Bio.Blast.Applications <span class="im">import</span> NcbirpstblastnCommandline</a>
<a class="sourceLine" id="cb74-23" title="23">    <span class="im">from</span> Bio.Blast.Applications <span class="im">import</span> NcbirpsblastCommandline</a>
<a class="sourceLine" id="cb74-24" title="24">    <span class="im">from</span> Bio.Blast.Applications <span class="im">import</span> NcbirpstblastnCommandline</a>
<a class="sourceLine" id="cb74-25" title="25">    <span class="im">from</span> Bio.Blast.Applications <span class="im">import</span> NcbirpstblastnCommandline</a>
<a class="sourceLine" id="cb74-26" title="26">    <span class="im">from</span> Bio.Blast.Applications <span class="im">import</span> NcbirpstblastnCommandline</a>
<a class="sourceLine" id="cb74-27" title="27">    <span class="im">from</span> Bio.Blast.Applications <span class="im">import</span> NcbirpstblastnCommandline</a>
<a class="sourceLine" id="cb74-28" title="28">    <span class="im">from</span> Bio.Blast.Applications <span class="im">import</span> NcbirpstblastnCommandline</a>
<a class="sourceLine" id="cb74-29" title="29">    <span class="im">from</span> Bio.Blast.Applications <span class="im">import</span> NcbirpstblastnCommandline</a>
<a class="sourceLine" id="cb74-30" title="30">    <span class="im">from</span> Bio.Blast.Applications <span class="im">import</span> NcbirpstblastnCommandline</a>
<a class="sourceLine" id="cb74-31" title="31">    <span class="im">from</span> Bio.Blast.Applications <span class="im">import</span> NcbirpstblastnCommandline</a>
<a class="sourceLine" id="cb74-32" title="32">    <span class="im">from</span> Bio.Blast.Applications <span class="im">import</span> NcbirpstblastnCommandline</a>
<a class="sourceLine" id="cb74-33" title="33">    <span class="im">from</span> Bio.Blast.Applications <span class="im">import</span> NcbirpstblastnCommandline</a>
<a class="sourceLine" id="cb74-34" title="34">    <span class="im">from</span> Bio.Blast.Applications <span class="im">import</span> NcbirpstblastnCommandline</a>
<a class="sourceLine" id="cb74-35" title="35">    <span class="im">from</span> Bio.Blast.Applications <span class="im">import</span> NcbirpstblastnCommandline</a>
<a class="sourceLine" id="cb74-36" title="36">    <span class="im">from</span> Bio.Blast.Applications <span class="im">import</span> NcbirpstblastnCommandline</a>
<a class="sourceLine" id="cb74-37" title="37">    <span class="im">from</span> Bio.Blast.Applications <span class="im">import</span> NcbirpstblastnCommandline</a>
<a class="sourceLine" id="cb74-38" title="38">    <span class="im">from</span> Bio.Blast.Applications <span class="im">import</span> NcbirpstblastnCommandline</a>
<a class="sourceLine" id="cb74-39" title="39">    <span class="im">from</span> Bio.Blast.Applications <span class="im">import</span> NcbirpstblastnCommandline</a>
<a class="sourceLine" id="cb74-40" title="40">    <span class="im">from</span> Bio.Blast.Applications <span class="im">import</span> NcbirpstblastnCommandline</a>
<a class="sourceLine" id="cb74-41" title="41">    <span class="im">from</span> Bio.Blast.Applications <span class="im">import</span> NcbirpstblastnCommandline</a>
<a class="sourceLine" id="cb74-42" title="42">    <span class="im">from</span> Bio.Blast.Applications <span class="im">import</span> NcbirpstblastnCommandline</a>
<a class="sourceLine" id="cb74-43" title="43">    <span class="im">from</span> Bio.Blast.Applications <span class="im">import</span> NcbirpstblastnCommandline</a>
<a class="sourceLine" id="cb74-44" title="44">    <span class="im">from</span> Bio.Blast.Applications <span class="im">import</span> NcbirpstblastnCommandline</a>
<a class="sourceLine" id="cb74-45" title="45">    <span class="im">from</span> Bio.Blast.Applications <span class="im">import</span> NcbirpstblastnCommandline</a>
<a class="sourceLine" id="cb74-46" title="46">    <span class="im">from</span> Bio.Blast.Applications <span class="im">import</span> NcbirpstblastnCommandline</a>
<a class="sourceLine" id="cb74-47" title="47">    <span class="im">from</span> Bio.Blast.Applications <span class="im">import</span> NcbirpstblastnCommandline</a>
<a class="sourceLine" id="cb74-48" title="48">    <span class="im">from</span> Bio.Blast.Applications <span class="im">import</span> NcbirpstblastnCommandline</a>
<a class="sourceLine" id="cb74-49" title="49">    <span class="im">from</span> Bio.Blast.Applications <span class="im">import</span> NcbirpstblastnCommandline</a>
<a class="sourceLine" id="cb74-50" title="50">    <span class="im">from</span> Bio.Blast.Applications <span class="im">import</span> NcbirpstblastnCommandline</a>
<a class="sourceLine" id="cb74-51" title="51">    <span class="im">from</span> Bio.Blast.Applications <span class="im">import</span> NcbirpstblastnCommandline</a>
<a class="sourceLine" id="cb74-52" title="52">    <span class="im">from</span> Bio.Blast.Applications <span class="im">import</span> NcbirpstblastnCommandline</a>
<a class="sourceLine" id="cb74-53" title="53">    <span class="im">from</span> Bio.Blast.Applications <span class="im">import</span> NcbirpstblastnCommandline</a>
<a class="sourceLine" id="cb74-54" title="54">    <span class="im">from</span> Bio.Blast.Applications <span class="im">import</span> NcbirpstblastnCommandline</a>
<a class="sourceLine" id="cb74-55" title="55">    <span class="im">from</span> Bio.Blast.Applications <span class="im">import</span> NcbirpstblastnCommandline</a>
<a class="sourceLine" id="cb74-56" title="56">    <span class="im">from</span> Bio.Blast.Applications <span class="im">import</span> NcbirpstblastnCommandline</a>
<a class="sourceLine" id="cb74-57" title="57">    <span class="im">from</span> Bio.Blast.Applications <span class="im">import</span> NcbirpstblastnCommandline</a>
<a class="sourceLine" id="cb74-58" title="58">    <span class="im">from</span> Bio.Blast.Applications <span class="im">import</span> NcbirpstblastnCommandline</a>
<a class="sourceLine" id="cb74-59" title="59">    <span class="im">from</span> Bio.Blast.Applications <span class="im">import</span> NcbirpstblastnCommandline</a>
<a class="sourceLine" id="cb74-60" title="60">    <span class="im">from</span> Bio.Blast.Applications <span class="im">import</span> NcbirpstblastnCommandline</a>
<a class="sourceLine" id="cb74-61" title="61">    <span class="im">from</span> Bio.Blast.Applications <span class="im">import</span> NcbirpstblastnCommandline</a>
<a class="sourceLine" id="cb74-62" title="62">    <span class="im">from</span> Bio.Blast.Applications <span class="im">import</span> NcbirpstblastnCommandline</a>
<a class="sourceLine" id="cb74-63" title="63">    <span class="cf">return</span> e, <span class="bu">id</span></a>
<a class="sourceLine" id="cb74-64" title="64">e, <span class="bu">id</span> <span class="op">=</span> blast(<span class="st">&#39;&gt;seq1</span><span class="ch">\n</span><span class="st">&#39;</span></a>
<a class="sourceLine" id="cb74-65" title="65">              <span class="st">&#39;PNFYVPFSNATGVVRSPFEYPQYYLAEPWQFSMLAAYMFLLIVLGFPINFLTLYVTVQ&#39;</span>)</a>
<a class="sourceLine" id="cb74-66" title="66">result <span class="op">=</span> <span class="bu">float</span>(e) <span class="op">&lt;</span> <span class="fl">1e-30</span></a></code></pre></div>
<p>Output:</p>
<pre><code>cannot import name &#39;NcbimakeblastdbCommandline&#39; from &#39;Bio.Blast.Applications&#39; (/opt/hostedtoolcache/Python/3.8.12/x64/lib/python3.8/site-packages/Bio/Blast/Applications.py)</code></pre>
<h4 id="run-4-6">Run 4</h4>
<div class="sourceCode" id="cb76"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb76-1" title="1"><span class="im">import</span> requests</a>
<a class="sourceLine" id="cb76-2" title="2"></a>
<a class="sourceLine" id="cb76-3" title="3"><span class="kw">def</span> blast(seq):</a>
<a class="sourceLine" id="cb76-4" title="4">    <span class="co">&#39;&#39;&#39;</span></a>
<a class="sourceLine" id="cb76-5" title="5"><span class="co">    Returns MSA with a BLAST search. Uses beautiful soup</span></a>
<a class="sourceLine" id="cb76-6" title="6"><span class="co">    to parse result.</span></a>
<a class="sourceLine" id="cb76-7" title="7"></a>
<a class="sourceLine" id="cb76-8" title="8"><span class="co">    1. import packages</span></a>
<a class="sourceLine" id="cb76-9" title="9"><span class="co">    2. Submit BLAST search with sequences</span></a>
<a class="sourceLine" id="cb76-10" title="10"><span class="co">    3. Get result</span></a>
<a class="sourceLine" id="cb76-11" title="11"><span class="co">    4. Parse MSA</span></a>
<a class="sourceLine" id="cb76-12" title="12"><span class="co">    5. Return a tuple of e score, id of top match</span></a>
<a class="sourceLine" id="cb76-13" title="13"><span class="co">    &#39;&#39;&#39;</span></a>
<a class="sourceLine" id="cb76-14" title="14">    <span class="im">from</span> bs4 <span class="im">import</span> BeautifulSoup</a>
<a class="sourceLine" id="cb76-15" title="15"></a>
<a class="sourceLine" id="cb76-16" title="16">    <span class="co"># Submit BLAST search</span></a>
<a class="sourceLine" id="cb76-17" title="17">    url <span class="op">=</span> <span class="st">&#39;https://blast.ncbi.nlm.nih.gov/Blast.cgi&#39;</span></a>
<a class="sourceLine" id="cb76-18" title="18">    params <span class="op">=</span> {<span class="st">&#39;QUERY&#39;</span>: seq, <span class="st">&#39;PROGRAM&#39;</span>: <span class="st">&#39;blastp&#39;</span>, <span class="st">&#39;DATABASE&#39;</span>: <span class="st">&#39;nr&#39;</span>, <span class="st">&#39;CMD&#39;</span>: <span class="st">&#39;Put&#39;</span>}</a>
<a class="sourceLine" id="cb76-19" title="19">    r <span class="op">=</span> requests.get(url, params<span class="op">=</span>params)</a>
<a class="sourceLine" id="cb76-20" title="20"></a>
<a class="sourceLine" id="cb76-21" title="21">    <span class="co"># Parse result</span></a>
<a class="sourceLine" id="cb76-22" title="22">    soup <span class="op">=</span> BeautifulSoup(r.text, <span class="st">&#39;html.parser&#39;</span>)</a>
<a class="sourceLine" id="cb76-23" title="23">    msa <span class="op">=</span> soup.find_all(<span class="st">&#39;pre&#39;</span>)[<span class="dv">1</span>].text</a>
<a class="sourceLine" id="cb76-24" title="24"></a>
<a class="sourceLine" id="cb76-25" title="25">    <span class="co"># Get top match</span></a>
<a class="sourceLine" id="cb76-26" title="26">    top_match <span class="op">=</span> msa.split(<span class="st">&#39;</span><span class="ch">\n</span><span class="st">&#39;</span>)[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb76-27" title="27">    e <span class="op">=</span> <span class="bu">float</span>(top_match.split(<span class="st">&#39;</span><span class="ch">\t</span><span class="st">&#39;</span>)[<span class="dv">10</span>])</a>
<a class="sourceLine" id="cb76-28" title="28">    <span class="bu">id</span> <span class="op">=</span> top_match.split(<span class="st">&#39;</span><span class="ch">\t</span><span class="st">&#39;</span>)[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb76-29" title="29"></a>
<a class="sourceLine" id="cb76-30" title="30">    <span class="cf">return</span> e, <span class="bu">id</span></a>
<a class="sourceLine" id="cb76-31" title="31">e, <span class="bu">id</span> <span class="op">=</span> blast(<span class="st">&#39;&gt;seq1</span><span class="ch">\n</span><span class="st">&#39;</span></a>
<a class="sourceLine" id="cb76-32" title="32">              <span class="st">&#39;PNFYVPFSNATGVVRSPFEYPQYYLAEPWQFSMLAAYMFLLIVLGFPINFLTLYVTVQ&#39;</span>)</a>
<a class="sourceLine" id="cb76-33" title="33">result <span class="op">=</span> <span class="bu">float</span>(e) <span class="op">&lt;</span> <span class="fl">1e-30</span></a></code></pre></div>
<p>Output:</p>
<pre><code>list index out of range</code></pre>
</details>
<details>
<p><summary>bravais</summary></p>
<h4 id="query-7">Query</h4>
<div class="sourceCode" id="cb78"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb78-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb78-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb78-3" title="3"></a>
<a class="sourceLine" id="cb78-4" title="4"></a>
<a class="sourceLine" id="cb78-5" title="5"><span class="kw">def</span> bravais_lattice(group_number):</a>
<a class="sourceLine" id="cb78-6" title="6">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb78-7" title="7"><span class="co">    Return bravais lattice name given space group number</span></a>
<a class="sourceLine" id="cb78-8" title="8"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb78-9" title="9">    [insert]</a>
<a class="sourceLine" id="cb78-10" title="10">    <span class="cf">return</span> name</a></code></pre></div>
<h4 id="run-0-7">Run 0</h4>
<div class="sourceCode" id="cb79"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb79-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb79-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb79-3" title="3"></a>
<a class="sourceLine" id="cb79-4" title="4"></a>
<a class="sourceLine" id="cb79-5" title="5"><span class="kw">def</span> bravais_lattice(group_number):</a>
<a class="sourceLine" id="cb79-6" title="6">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb79-7" title="7"><span class="co">    Return bravais lattice name given space group number</span></a>
<a class="sourceLine" id="cb79-8" title="8"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb79-9" title="9">    name <span class="op">=</span> <span class="va">None</span></a>
<a class="sourceLine" id="cb79-10" title="10">    <span class="cf">if</span> group_number <span class="op">&lt;</span> <span class="dv">3</span>:</a>
<a class="sourceLine" id="cb79-11" title="11">        name <span class="op">=</span> <span class="st">&quot;triclinic&quot;</span></a>
<a class="sourceLine" id="cb79-12" title="12">    <span class="cf">elif</span> group_number <span class="op">&lt;</span> <span class="dv">16</span>:</a>
<a class="sourceLine" id="cb79-13" title="13">        name <span class="op">=</span> <span class="st">&quot;monoclinic&quot;</span></a>
<a class="sourceLine" id="cb79-14" title="14">    <span class="cf">elif</span> group_number <span class="op">&lt;</span> <span class="dv">75</span>:</a>
<a class="sourceLine" id="cb79-15" title="15">        name <span class="op">=</span> <span class="st">&quot;orthorhombic&quot;</span></a>
<a class="sourceLine" id="cb79-16" title="16">    <span class="cf">elif</span> group_number <span class="op">&lt;</span> <span class="dv">143</span>:</a>
<a class="sourceLine" id="cb79-17" title="17">        name <span class="op">=</span> <span class="st">&quot;tetragonal&quot;</span></a>
<a class="sourceLine" id="cb79-18" title="18">    <span class="cf">elif</span> group_number <span class="op">&lt;</span> <span class="dv">168</span>:</a>
<a class="sourceLine" id="cb79-19" title="19">        name <span class="op">=</span> <span class="st">&quot;trigonal&quot;</span></a>
<a class="sourceLine" id="cb79-20" title="20">    <span class="cf">elif</span> group_number <span class="op">&lt;</span> <span class="dv">195</span>:</a>
<a class="sourceLine" id="cb79-21" title="21">        name <span class="op">=</span> <span class="st">&quot;hexagonal&quot;</span></a>
<a class="sourceLine" id="cb79-22" title="22">    <span class="cf">elif</span> group_number <span class="op">&lt;</span> <span class="dv">231</span>:</a>
<a class="sourceLine" id="cb79-23" title="23">        name <span class="op">=</span> <span class="st">&quot;cubic&quot;</span></a>
<a class="sourceLine" id="cb79-24" title="24">    <span class="cf">else</span>:</a>
<a class="sourceLine" id="cb79-25" title="25">        <span class="cf">raise</span> <span class="pp">ValueError</span>(<span class="st">&quot;Invalid space group number&quot;</span>)</a>
<a class="sourceLine" id="cb79-26" title="26">    <span class="cf">return</span> name</a>
<a class="sourceLine" id="cb79-27" title="27">m <span class="op">=</span> bravais_lattice(<span class="dv">47</span>)</a>
<a class="sourceLine" id="cb79-28" title="28">result <span class="op">=</span> m.lower() <span class="op">==</span> <span class="st">&#39;orthorhombic&#39;</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-7">Run 1</h4>
<div class="sourceCode" id="cb81"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb81-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb81-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb81-3" title="3"></a>
<a class="sourceLine" id="cb81-4" title="4"></a>
<a class="sourceLine" id="cb81-5" title="5"><span class="kw">def</span> bravais_lattice(group_number):</a>
<a class="sourceLine" id="cb81-6" title="6">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb81-7" title="7"><span class="co">    Return bravais lattice name given space group number</span></a>
<a class="sourceLine" id="cb81-8" title="8"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb81-9" title="9">    <span class="cf">if</span> group_number <span class="op">&lt;</span> <span class="dv">3</span>:</a>
<a class="sourceLine" id="cb81-10" title="10">        name <span class="op">=</span> <span class="st">&quot;triclinic&quot;</span></a>
<a class="sourceLine" id="cb81-11" title="11">    <span class="cf">elif</span> group_number <span class="op">&lt;</span> <span class="dv">16</span>:</a>
<a class="sourceLine" id="cb81-12" title="12">        name <span class="op">=</span> <span class="st">&quot;monoclinic&quot;</span></a>
<a class="sourceLine" id="cb81-13" title="13">    <span class="cf">elif</span> group_number <span class="op">&lt;</span> <span class="dv">75</span>:</a>
<a class="sourceLine" id="cb81-14" title="14">        name <span class="op">=</span> <span class="st">&quot;orthorhombic&quot;</span></a>
<a class="sourceLine" id="cb81-15" title="15">    <span class="cf">elif</span> group_number <span class="op">&lt;</span> <span class="dv">143</span>:</a>
<a class="sourceLine" id="cb81-16" title="16">        name <span class="op">=</span> <span class="st">&quot;tetragonal&quot;</span></a>
<a class="sourceLine" id="cb81-17" title="17">    <span class="cf">elif</span> group_number <span class="op">&lt;</span> <span class="dv">168</span>:</a>
<a class="sourceLine" id="cb81-18" title="18">        name <span class="op">=</span> <span class="st">&quot;trigonal&quot;</span></a>
<a class="sourceLine" id="cb81-19" title="19">    <span class="cf">elif</span> group_number <span class="op">&lt;</span> <span class="dv">195</span>:</a>
<a class="sourceLine" id="cb81-20" title="20">        name <span class="op">=</span> <span class="st">&quot;hexagonal&quot;</span></a>
<a class="sourceLine" id="cb81-21" title="21">    <span class="cf">elif</span> group_number <span class="op">&lt;</span> <span class="dv">231</span>:</a>
<a class="sourceLine" id="cb81-22" title="22">        name <span class="op">=</span> <span class="st">&quot;cubic&quot;</span></a>
<a class="sourceLine" id="cb81-23" title="23">    <span class="cf">else</span>:</a>
<a class="sourceLine" id="cb81-24" title="24">        name <span class="op">=</span> <span class="st">&quot;unknown&quot;</span></a>
<a class="sourceLine" id="cb81-25" title="25"></a>
<a class="sourceLine" id="cb81-26" title="26">    <span class="cf">return</span> name</a>
<a class="sourceLine" id="cb81-27" title="27">m <span class="op">=</span> bravais_lattice(<span class="dv">47</span>)</a>
<a class="sourceLine" id="cb81-28" title="28">result <span class="op">=</span> m.lower() <span class="op">==</span> <span class="st">&#39;orthorhombic&#39;</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-7">Run 2</h4>
<div class="sourceCode" id="cb83"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb83-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb83-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb83-3" title="3"></a>
<a class="sourceLine" id="cb83-4" title="4"></a>
<a class="sourceLine" id="cb83-5" title="5"><span class="kw">def</span> bravais_lattice(group_number):</a>
<a class="sourceLine" id="cb83-6" title="6">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb83-7" title="7"><span class="co">    Return bravais lattice name given space group number</span></a>
<a class="sourceLine" id="cb83-8" title="8"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb83-9" title="9">    <span class="cf">if</span> group_number <span class="op">&lt;</span> <span class="dv">1</span> <span class="kw">or</span> group_number <span class="op">&gt;</span> <span class="dv">230</span>:</a>
<a class="sourceLine" id="cb83-10" title="10">        <span class="cf">raise</span> <span class="pp">ValueError</span>(<span class="st">&#39;Space group number must be between 1 and 230&#39;</span>)</a>
<a class="sourceLine" id="cb83-11" title="11">    name <span class="op">=</span> [<span class="st">&#39;triclinic&#39;</span>, <span class="st">&#39;monoclinic&#39;</span>, <span class="st">&#39;orthorhombic&#39;</span>, <span class="st">&#39;tetragonal&#39;</span>, <span class="st">&#39;trigonal&#39;</span>, <span class="st">&#39;hexagonal&#39;</span>, <span class="st">&#39;cubic&#39;</span>]</a>
<a class="sourceLine" id="cb83-12" title="12">    <span class="cf">if</span> group_number <span class="op">&lt;=</span> <span class="dv">2</span>:</a>
<a class="sourceLine" id="cb83-13" title="13">        <span class="cf">return</span> name[<span class="dv">0</span>]</a>
<a class="sourceLine" id="cb83-14" title="14">    <span class="cf">elif</span> group_number <span class="op">&lt;=</span> <span class="dv">15</span>:</a>
<a class="sourceLine" id="cb83-15" title="15">        <span class="cf">return</span> name[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb83-16" title="16">    <span class="cf">elif</span> group_number <span class="op">&lt;=</span> <span class="dv">74</span>:</a>
<a class="sourceLine" id="cb83-17" title="17">        <span class="cf">return</span> name[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb83-18" title="18">    <span class="cf">elif</span> group_number <span class="op">&lt;=</span> <span class="dv">88</span>:</a>
<a class="sourceLine" id="cb83-19" title="19">        <span class="cf">return</span> name[<span class="dv">3</span>]</a>
<a class="sourceLine" id="cb83-20" title="20">    <span class="cf">elif</span> group_number <span class="op">&lt;=</span> <span class="dv">142</span>:</a>
<a class="sourceLine" id="cb83-21" title="21">        <span class="cf">return</span> name[<span class="dv">4</span>]</a>
<a class="sourceLine" id="cb83-22" title="22">    <span class="cf">elif</span> group_number <span class="op">&lt;=</span> <span class="dv">167</span>:</a>
<a class="sourceLine" id="cb83-23" title="23">        <span class="cf">return</span> name[<span class="dv">5</span>]</a>
<a class="sourceLine" id="cb83-24" title="24">    <span class="cf">else</span>:</a>
<a class="sourceLine" id="cb83-25" title="25">        <span class="cf">return</span> name[<span class="dv">6</span>]</a>
<a class="sourceLine" id="cb83-26" title="26"></a>
<a class="sourceLine" id="cb83-27" title="27"></a>
<a class="sourceLine" id="cb83-28" title="28"></a>
<a class="sourceLine" id="cb83-29" title="29">    <span class="cf">return</span> name</a>
<a class="sourceLine" id="cb83-30" title="30">m <span class="op">=</span> bravais_lattice(<span class="dv">47</span>)</a>
<a class="sourceLine" id="cb83-31" title="31">result <span class="op">=</span> m.lower() <span class="op">==</span> <span class="st">&#39;orthorhombic&#39;</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-7">Run 3</h4>
<div class="sourceCode" id="cb85"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb85-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb85-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb85-3" title="3"></a>
<a class="sourceLine" id="cb85-4" title="4"></a>
<a class="sourceLine" id="cb85-5" title="5"><span class="kw">def</span> bravais_lattice(group_number):</a>
<a class="sourceLine" id="cb85-6" title="6">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb85-7" title="7"><span class="co">    Return bravais lattice name given space group number</span></a>
<a class="sourceLine" id="cb85-8" title="8"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb85-9" title="9">    name <span class="op">=</span> <span class="st">&quot;Unknown&quot;</span></a>
<a class="sourceLine" id="cb85-10" title="10">    <span class="cf">if</span> group_number <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="dv">3</span>):</a>
<a class="sourceLine" id="cb85-11" title="11">        name <span class="op">=</span> <span class="st">&quot;Triclinic&quot;</span></a>
<a class="sourceLine" id="cb85-12" title="12">    <span class="cf">elif</span> group_number <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">3</span>, <span class="dv">16</span>):</a>
<a class="sourceLine" id="cb85-13" title="13">        name <span class="op">=</span> <span class="st">&quot;Monoclinic&quot;</span></a>
<a class="sourceLine" id="cb85-14" title="14">    <span class="cf">elif</span> group_number <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">16</span>, <span class="dv">75</span>):</a>
<a class="sourceLine" id="cb85-15" title="15">        name <span class="op">=</span> <span class="st">&quot;Orthorhombic&quot;</span></a>
<a class="sourceLine" id="cb85-16" title="16">    <span class="cf">elif</span> group_number <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">75</span>, <span class="dv">143</span>):</a>
<a class="sourceLine" id="cb85-17" title="17">        name <span class="op">=</span> <span class="st">&quot;Tetragonal&quot;</span></a>
<a class="sourceLine" id="cb85-18" title="18">    <span class="cf">elif</span> group_number <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">143</span>, <span class="dv">168</span>):</a>
<a class="sourceLine" id="cb85-19" title="19">        name <span class="op">=</span> <span class="st">&quot;Trigonal&quot;</span></a>
<a class="sourceLine" id="cb85-20" title="20">    <span class="cf">elif</span> group_number <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">168</span>, <span class="dv">195</span>):</a>
<a class="sourceLine" id="cb85-21" title="21">        name <span class="op">=</span> <span class="st">&quot;Hexagonal&quot;</span></a>
<a class="sourceLine" id="cb85-22" title="22">    <span class="cf">elif</span> group_number <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">195</span>, <span class="dv">231</span>):</a>
<a class="sourceLine" id="cb85-23" title="23">        name <span class="op">=</span> <span class="st">&quot;Cubic&quot;</span></a>
<a class="sourceLine" id="cb85-24" title="24">    <span class="cf">else</span>:</a>
<a class="sourceLine" id="cb85-25" title="25">        <span class="bu">print</span>(<span class="st">&quot;Unknown space group number: </span><span class="sc">{}</span><span class="st">&quot;</span>.<span class="bu">format</span>(group_number))</a>
<a class="sourceLine" id="cb85-26" title="26">        sys.exit(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb85-27" title="27">    <span class="cf">return</span> name</a>
<a class="sourceLine" id="cb85-28" title="28">m <span class="op">=</span> bravais_lattice(<span class="dv">47</span>)</a>
<a class="sourceLine" id="cb85-29" title="29">result <span class="op">=</span> m.lower() <span class="op">==</span> <span class="st">&#39;orthorhombic&#39;</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-7">Run 4</h4>
<div class="sourceCode" id="cb87"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb87-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb87-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb87-3" title="3"></a>
<a class="sourceLine" id="cb87-4" title="4"></a>
<a class="sourceLine" id="cb87-5" title="5"><span class="kw">def</span> bravais_lattice(group_number):</a>
<a class="sourceLine" id="cb87-6" title="6">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb87-7" title="7"><span class="co">    Return bravais lattice name given space group number</span></a>
<a class="sourceLine" id="cb87-8" title="8"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb87-9" title="9">    name <span class="op">=</span> <span class="st">&quot;&quot;</span></a>
<a class="sourceLine" id="cb87-10" title="10">    <span class="cf">if</span> group_number <span class="op">&gt;=</span> <span class="dv">1</span> <span class="kw">and</span> group_number <span class="op">&lt;=</span> <span class="dv">2</span>:</a>
<a class="sourceLine" id="cb87-11" title="11">        name <span class="op">=</span> <span class="st">&quot;triclinic&quot;</span></a>
<a class="sourceLine" id="cb87-12" title="12">    <span class="cf">elif</span> group_number <span class="op">&gt;=</span> <span class="dv">3</span> <span class="kw">and</span> group_number <span class="op">&lt;=</span> <span class="dv">15</span>:</a>
<a class="sourceLine" id="cb87-13" title="13">        name <span class="op">=</span> <span class="st">&quot;monoclinic&quot;</span></a>
<a class="sourceLine" id="cb87-14" title="14">    <span class="cf">elif</span> group_number <span class="op">&gt;=</span> <span class="dv">16</span> <span class="kw">and</span> group_number <span class="op">&lt;=</span> <span class="dv">74</span>:</a>
<a class="sourceLine" id="cb87-15" title="15">        name <span class="op">=</span> <span class="st">&quot;orthorhombic&quot;</span></a>
<a class="sourceLine" id="cb87-16" title="16">    <span class="cf">elif</span> group_number <span class="op">&gt;=</span> <span class="dv">75</span> <span class="kw">and</span> group_number <span class="op">&lt;=</span> <span class="dv">142</span>:</a>
<a class="sourceLine" id="cb87-17" title="17">        name <span class="op">=</span> <span class="st">&quot;tetragonal&quot;</span></a>
<a class="sourceLine" id="cb87-18" title="18">    <span class="cf">elif</span> group_number <span class="op">&gt;=</span> <span class="dv">143</span> <span class="kw">and</span> group_number <span class="op">&lt;=</span> <span class="dv">167</span>:</a>
<a class="sourceLine" id="cb87-19" title="19">        name <span class="op">=</span> <span class="st">&quot;trigonal&quot;</span></a>
<a class="sourceLine" id="cb87-20" title="20">    <span class="cf">elif</span> group_number <span class="op">&gt;=</span> <span class="dv">168</span> <span class="kw">and</span> group_number <span class="op">&lt;=</span> <span class="dv">194</span>:</a>
<a class="sourceLine" id="cb87-21" title="21">        name <span class="op">=</span> <span class="st">&quot;hexagonal&quot;</span></a>
<a class="sourceLine" id="cb87-22" title="22">    <span class="cf">elif</span> group_number <span class="op">&gt;=</span> <span class="dv">195</span> <span class="kw">and</span> group_number <span class="op">&lt;=</span> <span class="dv">230</span>:</a>
<a class="sourceLine" id="cb87-23" title="23">        name <span class="op">=</span> <span class="st">&quot;cubic&quot;</span></a>
<a class="sourceLine" id="cb87-24" title="24">    <span class="cf">else</span>:</a>
<a class="sourceLine" id="cb87-25" title="25">        <span class="bu">print</span>(<span class="st">&quot;Invalid space group number&quot;</span>)</a>
<a class="sourceLine" id="cb87-26" title="26">        sys.exit()</a>
<a class="sourceLine" id="cb87-27" title="27"></a>
<a class="sourceLine" id="cb87-28" title="28">    <span class="cf">return</span> name</a>
<a class="sourceLine" id="cb87-29" title="29">m <span class="op">=</span> bravais_lattice(<span class="dv">47</span>)</a>
<a class="sourceLine" id="cb87-30" title="30">result <span class="op">=</span> m.lower() <span class="op">==</span> <span class="st">&#39;orthorhombic&#39;</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>canonicalize</summary></p>
<h4 id="query-8">Query</h4>
<div class="sourceCode" id="cb89"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb89-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb89-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb89-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb89-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb89-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb89-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb89-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb89-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb89-9" title="9"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb89-10" title="10"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb89-11" title="11"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb89-12" title="12"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb89-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb89-14" title="14"></a>
<a class="sourceLine" id="cb89-15" title="15"><span class="kw">def</span> canonical(smiles_list):</a>
<a class="sourceLine" id="cb89-16" title="16">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb89-17" title="17"><span class="co">    Returns list of canonical forms of given molecules</span></a>
<a class="sourceLine" id="cb89-18" title="18"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb89-19" title="19">    [insert]</a>
<a class="sourceLine" id="cb89-20" title="20">    <span class="cf">return</span> canon_list</a></code></pre></div>
<h4 id="run-0-8">Run 0</h4>
<div class="sourceCode" id="cb90"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb90-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb90-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb90-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb90-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb90-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb90-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb90-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb90-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb90-9" title="9"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb90-10" title="10"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb90-11" title="11"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb90-12" title="12"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb90-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb90-14" title="14"></a>
<a class="sourceLine" id="cb90-15" title="15"><span class="kw">def</span> canonical(smiles_list):</a>
<a class="sourceLine" id="cb90-16" title="16">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb90-17" title="17"><span class="co">    Returns list of canonical forms of given molecules</span></a>
<a class="sourceLine" id="cb90-18" title="18"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb90-19" title="19">    canon_list <span class="op">=</span> []</a>
<a class="sourceLine" id="cb90-20" title="20">    <span class="cf">for</span> smiles <span class="kw">in</span> smiles_list:</a>
<a class="sourceLine" id="cb90-21" title="21">        mol <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb90-22" title="22">        canon_list.append(Chem.MolToSmiles(mol, isomericSmiles<span class="op">=</span><span class="va">True</span>))</a>
<a class="sourceLine" id="cb90-23" title="23">    <span class="cf">return</span> canon_list</a>
<a class="sourceLine" id="cb90-24" title="24">smiles <span class="op">=</span> [</a>
<a class="sourceLine" id="cb90-25" title="25">    <span class="st">&#39;C1=CC=CN=C1&#39;</span>,</a>
<a class="sourceLine" id="cb90-26" title="26">    <span class="st">&#39;c1cccnc1&#39;</span>,</a>
<a class="sourceLine" id="cb90-27" title="27">    <span class="st">&#39;C([H])C&#39;</span></a>
<a class="sourceLine" id="cb90-28" title="28">]</a>
<a class="sourceLine" id="cb90-29" title="29"></a>
<a class="sourceLine" id="cb90-30" title="30">ref_csmiles <span class="op">=</span> [</a>
<a class="sourceLine" id="cb90-31" title="31">    <span class="st">&#39;c1ccncc1&#39;</span>,</a>
<a class="sourceLine" id="cb90-32" title="32">    <span class="st">&#39;c1ccncc1&#39;</span>,</a>
<a class="sourceLine" id="cb90-33" title="33">    <span class="st">&#39;CC&#39;</span></a>
<a class="sourceLine" id="cb90-34" title="34">]</a>
<a class="sourceLine" id="cb90-35" title="35"></a>
<a class="sourceLine" id="cb90-36" title="36">csmiles <span class="op">=</span> canonical(smiles)</a>
<a class="sourceLine" id="cb90-37" title="37"></a>
<a class="sourceLine" id="cb90-38" title="38"><span class="bu">print</span>(csmiles)</a>
<a class="sourceLine" id="cb90-39" title="39"><span class="bu">print</span>(ref_csmiles)</a>
<a class="sourceLine" id="cb90-40" title="40"></a>
<a class="sourceLine" id="cb90-41" title="41">result <span class="op">=</span> <span class="va">True</span></a>
<a class="sourceLine" id="cb90-42" title="42"><span class="cf">for</span> r, c <span class="kw">in</span> <span class="bu">zip</span>(ref_csmiles, csmiles):</a>
<a class="sourceLine" id="cb90-43" title="43">    result <span class="op">=</span> result <span class="kw">and</span> r <span class="op">==</span> c</a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-8">Run 1</h4>
<div class="sourceCode" id="cb92"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb92-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb92-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb92-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb92-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb92-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb92-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb92-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb92-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb92-9" title="9"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb92-10" title="10"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb92-11" title="11"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb92-12" title="12"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb92-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb92-14" title="14"></a>
<a class="sourceLine" id="cb92-15" title="15"><span class="kw">def</span> canonical(smiles_list):</a>
<a class="sourceLine" id="cb92-16" title="16">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb92-17" title="17"><span class="co">    Returns list of canonical forms of given molecules</span></a>
<a class="sourceLine" id="cb92-18" title="18"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb92-19" title="19">    canon_list <span class="op">=</span> []</a>
<a class="sourceLine" id="cb92-20" title="20">    <span class="cf">for</span> smiles <span class="kw">in</span> smiles_list:</a>
<a class="sourceLine" id="cb92-21" title="21">        mol <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb92-22" title="22">        canon_list.append(Chem.MolToSmiles(mol, isomericSmiles<span class="op">=</span><span class="va">True</span>))</a>
<a class="sourceLine" id="cb92-23" title="23">    <span class="cf">return</span> canon_list</a>
<a class="sourceLine" id="cb92-24" title="24">smiles <span class="op">=</span> [</a>
<a class="sourceLine" id="cb92-25" title="25">    <span class="st">&#39;C1=CC=CN=C1&#39;</span>,</a>
<a class="sourceLine" id="cb92-26" title="26">    <span class="st">&#39;c1cccnc1&#39;</span>,</a>
<a class="sourceLine" id="cb92-27" title="27">    <span class="st">&#39;C([H])C&#39;</span></a>
<a class="sourceLine" id="cb92-28" title="28">]</a>
<a class="sourceLine" id="cb92-29" title="29"></a>
<a class="sourceLine" id="cb92-30" title="30">ref_csmiles <span class="op">=</span> [</a>
<a class="sourceLine" id="cb92-31" title="31">    <span class="st">&#39;c1ccncc1&#39;</span>,</a>
<a class="sourceLine" id="cb92-32" title="32">    <span class="st">&#39;c1ccncc1&#39;</span>,</a>
<a class="sourceLine" id="cb92-33" title="33">    <span class="st">&#39;CC&#39;</span></a>
<a class="sourceLine" id="cb92-34" title="34">]</a>
<a class="sourceLine" id="cb92-35" title="35"></a>
<a class="sourceLine" id="cb92-36" title="36">csmiles <span class="op">=</span> canonical(smiles)</a>
<a class="sourceLine" id="cb92-37" title="37"></a>
<a class="sourceLine" id="cb92-38" title="38"><span class="bu">print</span>(csmiles)</a>
<a class="sourceLine" id="cb92-39" title="39"><span class="bu">print</span>(ref_csmiles)</a>
<a class="sourceLine" id="cb92-40" title="40"></a>
<a class="sourceLine" id="cb92-41" title="41">result <span class="op">=</span> <span class="va">True</span></a>
<a class="sourceLine" id="cb92-42" title="42"><span class="cf">for</span> r, c <span class="kw">in</span> <span class="bu">zip</span>(ref_csmiles, csmiles):</a>
<a class="sourceLine" id="cb92-43" title="43">    result <span class="op">=</span> result <span class="kw">and</span> r <span class="op">==</span> c</a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-8">Run 2</h4>
<div class="sourceCode" id="cb94"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb94-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb94-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb94-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb94-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb94-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb94-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb94-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb94-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb94-9" title="9"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb94-10" title="10"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb94-11" title="11"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb94-12" title="12"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb94-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb94-14" title="14"></a>
<a class="sourceLine" id="cb94-15" title="15"><span class="kw">def</span> canonical(smiles_list):</a>
<a class="sourceLine" id="cb94-16" title="16">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb94-17" title="17"><span class="co">    Returns list of canonical forms of given molecules</span></a>
<a class="sourceLine" id="cb94-18" title="18"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb94-19" title="19">    canon_list <span class="op">=</span> []</a>
<a class="sourceLine" id="cb94-20" title="20">    <span class="cf">for</span> smiles <span class="kw">in</span> smiles_list:</a>
<a class="sourceLine" id="cb94-21" title="21">        mol <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb94-22" title="22">        canon_list.append(Chem.MolToSmiles(mol))</a>
<a class="sourceLine" id="cb94-23" title="23">    <span class="cf">return</span> canon_list</a>
<a class="sourceLine" id="cb94-24" title="24">smiles <span class="op">=</span> [</a>
<a class="sourceLine" id="cb94-25" title="25">    <span class="st">&#39;C1=CC=CN=C1&#39;</span>,</a>
<a class="sourceLine" id="cb94-26" title="26">    <span class="st">&#39;c1cccnc1&#39;</span>,</a>
<a class="sourceLine" id="cb94-27" title="27">    <span class="st">&#39;C([H])C&#39;</span></a>
<a class="sourceLine" id="cb94-28" title="28">]</a>
<a class="sourceLine" id="cb94-29" title="29"></a>
<a class="sourceLine" id="cb94-30" title="30">ref_csmiles <span class="op">=</span> [</a>
<a class="sourceLine" id="cb94-31" title="31">    <span class="st">&#39;c1ccncc1&#39;</span>,</a>
<a class="sourceLine" id="cb94-32" title="32">    <span class="st">&#39;c1ccncc1&#39;</span>,</a>
<a class="sourceLine" id="cb94-33" title="33">    <span class="st">&#39;CC&#39;</span></a>
<a class="sourceLine" id="cb94-34" title="34">]</a>
<a class="sourceLine" id="cb94-35" title="35"></a>
<a class="sourceLine" id="cb94-36" title="36">csmiles <span class="op">=</span> canonical(smiles)</a>
<a class="sourceLine" id="cb94-37" title="37"></a>
<a class="sourceLine" id="cb94-38" title="38"><span class="bu">print</span>(csmiles)</a>
<a class="sourceLine" id="cb94-39" title="39"><span class="bu">print</span>(ref_csmiles)</a>
<a class="sourceLine" id="cb94-40" title="40"></a>
<a class="sourceLine" id="cb94-41" title="41">result <span class="op">=</span> <span class="va">True</span></a>
<a class="sourceLine" id="cb94-42" title="42"><span class="cf">for</span> r, c <span class="kw">in</span> <span class="bu">zip</span>(ref_csmiles, csmiles):</a>
<a class="sourceLine" id="cb94-43" title="43">    result <span class="op">=</span> result <span class="kw">and</span> r <span class="op">==</span> c</a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-8">Run 3</h4>
<div class="sourceCode" id="cb96"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb96-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb96-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb96-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb96-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb96-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb96-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb96-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb96-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb96-9" title="9"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb96-10" title="10"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb96-11" title="11"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb96-12" title="12"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb96-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb96-14" title="14"></a>
<a class="sourceLine" id="cb96-15" title="15"><span class="kw">def</span> canonical(smiles_list):</a>
<a class="sourceLine" id="cb96-16" title="16">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb96-17" title="17"><span class="co">    Returns list of canonical forms of given molecules</span></a>
<a class="sourceLine" id="cb96-18" title="18"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb96-19" title="19">    canon_list <span class="op">=</span> []</a>
<a class="sourceLine" id="cb96-20" title="20">    <span class="cf">for</span> smiles <span class="kw">in</span> smiles_list:</a>
<a class="sourceLine" id="cb96-21" title="21">        mol <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb96-22" title="22">        canon_list.append(Chem.MolToSmiles(mol))</a>
<a class="sourceLine" id="cb96-23" title="23">    <span class="cf">return</span> canon_list</a>
<a class="sourceLine" id="cb96-24" title="24">smiles <span class="op">=</span> [</a>
<a class="sourceLine" id="cb96-25" title="25">    <span class="st">&#39;C1=CC=CN=C1&#39;</span>,</a>
<a class="sourceLine" id="cb96-26" title="26">    <span class="st">&#39;c1cccnc1&#39;</span>,</a>
<a class="sourceLine" id="cb96-27" title="27">    <span class="st">&#39;C([H])C&#39;</span></a>
<a class="sourceLine" id="cb96-28" title="28">]</a>
<a class="sourceLine" id="cb96-29" title="29"></a>
<a class="sourceLine" id="cb96-30" title="30">ref_csmiles <span class="op">=</span> [</a>
<a class="sourceLine" id="cb96-31" title="31">    <span class="st">&#39;c1ccncc1&#39;</span>,</a>
<a class="sourceLine" id="cb96-32" title="32">    <span class="st">&#39;c1ccncc1&#39;</span>,</a>
<a class="sourceLine" id="cb96-33" title="33">    <span class="st">&#39;CC&#39;</span></a>
<a class="sourceLine" id="cb96-34" title="34">]</a>
<a class="sourceLine" id="cb96-35" title="35"></a>
<a class="sourceLine" id="cb96-36" title="36">csmiles <span class="op">=</span> canonical(smiles)</a>
<a class="sourceLine" id="cb96-37" title="37"></a>
<a class="sourceLine" id="cb96-38" title="38"><span class="bu">print</span>(csmiles)</a>
<a class="sourceLine" id="cb96-39" title="39"><span class="bu">print</span>(ref_csmiles)</a>
<a class="sourceLine" id="cb96-40" title="40"></a>
<a class="sourceLine" id="cb96-41" title="41">result <span class="op">=</span> <span class="va">True</span></a>
<a class="sourceLine" id="cb96-42" title="42"><span class="cf">for</span> r, c <span class="kw">in</span> <span class="bu">zip</span>(ref_csmiles, csmiles):</a>
<a class="sourceLine" id="cb96-43" title="43">    result <span class="op">=</span> result <span class="kw">and</span> r <span class="op">==</span> c</a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-8">Run 4</h4>
<div class="sourceCode" id="cb98"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb98-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb98-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb98-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb98-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb98-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb98-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb98-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb98-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb98-9" title="9"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb98-10" title="10"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb98-11" title="11"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb98-12" title="12"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb98-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb98-14" title="14"></a>
<a class="sourceLine" id="cb98-15" title="15"><span class="kw">def</span> canonical(smiles_list):</a>
<a class="sourceLine" id="cb98-16" title="16">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb98-17" title="17"><span class="co">    Returns list of canonical forms of given molecules</span></a>
<a class="sourceLine" id="cb98-18" title="18"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb98-19" title="19">    canon_list <span class="op">=</span> []</a>
<a class="sourceLine" id="cb98-20" title="20">    <span class="cf">for</span> smiles <span class="kw">in</span> smiles_list:</a>
<a class="sourceLine" id="cb98-21" title="21">        mol <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb98-22" title="22">        canon_list.append(Chem.MolToSmiles(mol, isomericSmiles<span class="op">=</span><span class="va">True</span>))</a>
<a class="sourceLine" id="cb98-23" title="23">    <span class="cf">return</span> canon_list</a>
<a class="sourceLine" id="cb98-24" title="24">smiles <span class="op">=</span> [</a>
<a class="sourceLine" id="cb98-25" title="25">    <span class="st">&#39;C1=CC=CN=C1&#39;</span>,</a>
<a class="sourceLine" id="cb98-26" title="26">    <span class="st">&#39;c1cccnc1&#39;</span>,</a>
<a class="sourceLine" id="cb98-27" title="27">    <span class="st">&#39;C([H])C&#39;</span></a>
<a class="sourceLine" id="cb98-28" title="28">]</a>
<a class="sourceLine" id="cb98-29" title="29"></a>
<a class="sourceLine" id="cb98-30" title="30">ref_csmiles <span class="op">=</span> [</a>
<a class="sourceLine" id="cb98-31" title="31">    <span class="st">&#39;c1ccncc1&#39;</span>,</a>
<a class="sourceLine" id="cb98-32" title="32">    <span class="st">&#39;c1ccncc1&#39;</span>,</a>
<a class="sourceLine" id="cb98-33" title="33">    <span class="st">&#39;CC&#39;</span></a>
<a class="sourceLine" id="cb98-34" title="34">]</a>
<a class="sourceLine" id="cb98-35" title="35"></a>
<a class="sourceLine" id="cb98-36" title="36">csmiles <span class="op">=</span> canonical(smiles)</a>
<a class="sourceLine" id="cb98-37" title="37"></a>
<a class="sourceLine" id="cb98-38" title="38"><span class="bu">print</span>(csmiles)</a>
<a class="sourceLine" id="cb98-39" title="39"><span class="bu">print</span>(ref_csmiles)</a>
<a class="sourceLine" id="cb98-40" title="40"></a>
<a class="sourceLine" id="cb98-41" title="41">result <span class="op">=</span> <span class="va">True</span></a>
<a class="sourceLine" id="cb98-42" title="42"><span class="cf">for</span> r, c <span class="kw">in</span> <span class="bu">zip</span>(ref_csmiles, csmiles):</a>
<a class="sourceLine" id="cb98-43" title="43">    result <span class="op">=</span> result <span class="kw">and</span> r <span class="op">==</span> c</a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>compare_electronegativity</summary></p>
<h4 id="query-9">Query</h4>
<div class="sourceCode" id="cb100"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb100-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb100-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb100-3" title="3"></a>
<a class="sourceLine" id="cb100-4" title="4"><span class="kw">def</span> compare_electronegativity(element1,element2):</a>
<a class="sourceLine" id="cb100-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb100-6" title="6"><span class="co">   This function returns True if element1 has a larger Pauling electronegativity than element2</span></a>
<a class="sourceLine" id="cb100-7" title="7"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb100-8" title="8">   <span class="im">import</span> mendeleev</a>
<a class="sourceLine" id="cb100-9" title="9">   [insert]</a>
<a class="sourceLine" id="cb100-10" title="10">   <span class="cf">return</span> result</a></code></pre></div>
<h4 id="run-0-9">Run 0</h4>
<div class="sourceCode" id="cb101"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb101-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb101-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb101-3" title="3"></a>
<a class="sourceLine" id="cb101-4" title="4"><span class="kw">def</span> compare_electronegativity(element1,element2):</a>
<a class="sourceLine" id="cb101-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb101-6" title="6"><span class="co">   This function returns True if element1 has a larger Pauling electronegativity than element2</span></a>
<a class="sourceLine" id="cb101-7" title="7"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb101-8" title="8">   <span class="im">import</span> mendeleev</a>
<a class="sourceLine" id="cb101-9" title="9">   <span class="cf">if</span> element1 <span class="kw">not</span> <span class="kw">in</span> mendeleev.element <span class="kw">or</span> element2 <span class="kw">not</span> <span class="kw">in</span> mendeleev.element:</a>
<a class="sourceLine" id="cb101-10" title="10">      <span class="bu">print</span>(<span class="st">&quot;Error: one of the elements is not in the mendeleev table&quot;</span>)</a>
<a class="sourceLine" id="cb101-11" title="11">      sys.exit()</a>
<a class="sourceLine" id="cb101-12" title="12">   <span class="cf">if</span> mendeleev.element[element1].electronegativity <span class="op">&gt;</span> mendeleev.element[element2].electronegativity:</a>
<a class="sourceLine" id="cb101-13" title="13">      result <span class="op">=</span> <span class="va">True</span></a>
<a class="sourceLine" id="cb101-14" title="14">   <span class="cf">else</span>:</a>
<a class="sourceLine" id="cb101-15" title="15">      result <span class="op">=</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb101-16" title="16">   <span class="cf">return</span> result</a>
<a class="sourceLine" id="cb101-17" title="17">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> compare_electronegativity(<span class="st">&quot;O&quot;</span>,<span class="st">&quot;C&quot;</span>) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>argument of type &#39;function&#39; is not iterable</code></pre>
<h4 id="run-1-9">Run 1</h4>
<div class="sourceCode" id="cb103"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb103-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb103-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb103-3" title="3"></a>
<a class="sourceLine" id="cb103-4" title="4"><span class="kw">def</span> compare_electronegativity(element1,element2):</a>
<a class="sourceLine" id="cb103-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb103-6" title="6"><span class="co">   This function returns True if element1 has a larger Pauling electronegativity than element2</span></a>
<a class="sourceLine" id="cb103-7" title="7"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb103-8" title="8">   <span class="im">import</span> mendeleev</a>
<a class="sourceLine" id="cb103-9" title="9">   result <span class="op">=</span> mendeleev.element(element1).electronegativity <span class="op">&gt;</span> mendeleev.element(element2).electronegativity</a>
<a class="sourceLine" id="cb103-10" title="10">   <span class="cf">return</span> result</a>
<a class="sourceLine" id="cb103-11" title="11">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> compare_electronegativity(<span class="st">&quot;O&quot;</span>,<span class="st">&quot;C&quot;</span>) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>&#39;&gt;&#39; not supported between instances of &#39;method&#39; and &#39;method&#39;</code></pre>
<h4 id="run-2-9">Run 2</h4>
<div class="sourceCode" id="cb105"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb105-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb105-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb105-3" title="3"></a>
<a class="sourceLine" id="cb105-4" title="4"><span class="kw">def</span> compare_electronegativity(element1,element2):</a>
<a class="sourceLine" id="cb105-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb105-6" title="6"><span class="co">   This function returns True if element1 has a larger Pauling electronegativity than element2</span></a>
<a class="sourceLine" id="cb105-7" title="7"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb105-8" title="8">   <span class="im">import</span> mendeleev</a>
<a class="sourceLine" id="cb105-9" title="9">   result <span class="op">=</span> mendeleev.element(element1).electronegativity <span class="op">&gt;</span> mendeleev.element(element2).electronegativity</a>
<a class="sourceLine" id="cb105-10" title="10">   <span class="cf">return</span> result</a>
<a class="sourceLine" id="cb105-11" title="11">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> compare_electronegativity(<span class="st">&quot;O&quot;</span>,<span class="st">&quot;C&quot;</span>) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>&#39;&gt;&#39; not supported between instances of &#39;method&#39; and &#39;method&#39;</code></pre>
<h4 id="run-3-9">Run 3</h4>
<div class="sourceCode" id="cb107"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb107-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb107-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb107-3" title="3"></a>
<a class="sourceLine" id="cb107-4" title="4"><span class="kw">def</span> compare_electronegativity(element1,element2):</a>
<a class="sourceLine" id="cb107-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb107-6" title="6"><span class="co">   This function returns True if element1 has a larger Pauling electronegativity than element2</span></a>
<a class="sourceLine" id="cb107-7" title="7"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb107-8" title="8">   <span class="im">import</span> mendeleev</a>
<a class="sourceLine" id="cb107-9" title="9">   result <span class="op">=</span> mendeleev.element(element1).electronegativity <span class="op">&gt;</span> mendeleev.element(element2).electronegativity</a>
<a class="sourceLine" id="cb107-10" title="10">   <span class="cf">return</span> result</a>
<a class="sourceLine" id="cb107-11" title="11">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> compare_electronegativity(<span class="st">&quot;O&quot;</span>,<span class="st">&quot;C&quot;</span>) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>&#39;&gt;&#39; not supported between instances of &#39;method&#39; and &#39;method&#39;</code></pre>
<h4 id="run-4-9">Run 4</h4>
<div class="sourceCode" id="cb109"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb109-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb109-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb109-3" title="3"></a>
<a class="sourceLine" id="cb109-4" title="4"><span class="kw">def</span> compare_electronegativity(element1,element2):</a>
<a class="sourceLine" id="cb109-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb109-6" title="6"><span class="co">   This function returns True if element1 has a larger Pauling electronegativity than element2</span></a>
<a class="sourceLine" id="cb109-7" title="7"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb109-8" title="8">   <span class="im">import</span> mendeleev</a>
<a class="sourceLine" id="cb109-9" title="9">   result <span class="op">=</span> mendeleev.element(element1).pauling_electronegativity <span class="op">&gt;</span> mendeleev.element(element2).pauling_electronegativity</a>
<a class="sourceLine" id="cb109-10" title="10">   <span class="cf">return</span> result</a>
<a class="sourceLine" id="cb109-11" title="11">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> compare_electronegativity(<span class="st">&quot;O&quot;</span>,<span class="st">&quot;C&quot;</span>) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>&#39;Element&#39; object has no attribute &#39;pauling_electronegativity&#39;</code></pre>
</details>
<details>
<p><summary>condiff_1d</summary></p>
<h4 id="query-10">Query</h4>
<div class="sourceCode" id="cb111"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb111-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb111-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb111-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb111-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb111-5" title="5"></a>
<a class="sourceLine" id="cb111-6" title="6"><span class="kw">def</span> condiff_1d(x):</a>
<a class="sourceLine" id="cb111-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb111-8" title="8"><span class="co">  This function computes the difference between consecutive elements in array x.</span></a>
<a class="sourceLine" id="cb111-9" title="9"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb111-10" title="10">  [insert]</a>
<a class="sourceLine" id="cb111-11" title="11">  <span class="cf">return</span> diff</a></code></pre></div>
<h4 id="run-0-10">Run 0</h4>
<div class="sourceCode" id="cb112"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb112-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb112-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb112-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb112-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb112-5" title="5"></a>
<a class="sourceLine" id="cb112-6" title="6"><span class="kw">def</span> condiff_1d(x):</a>
<a class="sourceLine" id="cb112-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb112-8" title="8"><span class="co">  This function computes the difference between consecutive elements in array x.</span></a>
<a class="sourceLine" id="cb112-9" title="9"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb112-10" title="10">  diff <span class="op">=</span> np.zeros(<span class="bu">len</span>(x)<span class="op">-</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb112-11" title="11">  <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(x)<span class="op">-</span><span class="dv">1</span>):</a>
<a class="sourceLine" id="cb112-12" title="12">    diff[i] <span class="op">=</span> x[i<span class="op">+</span><span class="dv">1</span>] <span class="op">-</span> x[i]</a>
<a class="sourceLine" id="cb112-13" title="13">  <span class="cf">return</span> diff</a>
<a class="sourceLine" id="cb112-14" title="14"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb112-15" title="15"></a>
<a class="sourceLine" id="cb112-16" title="16">x <span class="op">=</span> np.array([<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">7</span>, <span class="dv">0</span>])</a>
<a class="sourceLine" id="cb112-17" title="17"></a>
<a class="sourceLine" id="cb112-18" title="18">true_y <span class="op">=</span> np.ediff1d(x)</a>
<a class="sourceLine" id="cb112-19" title="19"></a>
<a class="sourceLine" id="cb112-20" title="20">pred_y <span class="op">=</span> condiff_1d(x)</a>
<a class="sourceLine" id="cb112-21" title="21"></a>
<a class="sourceLine" id="cb112-22" title="22">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.allclose(true_y,pred_y) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-10">Run 1</h4>
<div class="sourceCode" id="cb114"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb114-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb114-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb114-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb114-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb114-5" title="5"></a>
<a class="sourceLine" id="cb114-6" title="6"><span class="kw">def</span> condiff_1d(x):</a>
<a class="sourceLine" id="cb114-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb114-8" title="8"><span class="co">  This function computes the difference between consecutive elements in array x.</span></a>
<a class="sourceLine" id="cb114-9" title="9"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb114-10" title="10">  diff <span class="op">=</span> np.zeros(<span class="bu">len</span>(x)<span class="op">-</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb114-11" title="11">  <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(x)<span class="op">-</span><span class="dv">1</span>):</a>
<a class="sourceLine" id="cb114-12" title="12">    diff[i] <span class="op">=</span> x[i<span class="op">+</span><span class="dv">1</span>] <span class="op">-</span> x[i]</a>
<a class="sourceLine" id="cb114-13" title="13">  <span class="cf">return</span> diff</a>
<a class="sourceLine" id="cb114-14" title="14"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb114-15" title="15"></a>
<a class="sourceLine" id="cb114-16" title="16">x <span class="op">=</span> np.array([<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">7</span>, <span class="dv">0</span>])</a>
<a class="sourceLine" id="cb114-17" title="17"></a>
<a class="sourceLine" id="cb114-18" title="18">true_y <span class="op">=</span> np.ediff1d(x)</a>
<a class="sourceLine" id="cb114-19" title="19"></a>
<a class="sourceLine" id="cb114-20" title="20">pred_y <span class="op">=</span> condiff_1d(x)</a>
<a class="sourceLine" id="cb114-21" title="21"></a>
<a class="sourceLine" id="cb114-22" title="22">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.allclose(true_y,pred_y) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-10">Run 2</h4>
<div class="sourceCode" id="cb116"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb116-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb116-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb116-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb116-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb116-5" title="5"></a>
<a class="sourceLine" id="cb116-6" title="6"><span class="kw">def</span> condiff_1d(x):</a>
<a class="sourceLine" id="cb116-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb116-8" title="8"><span class="co">  This function computes the difference between consecutive elements in array x.</span></a>
<a class="sourceLine" id="cb116-9" title="9"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb116-10" title="10">  diff <span class="op">=</span> np.zeros(<span class="bu">len</span>(x)<span class="op">-</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb116-11" title="11">  <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(x)<span class="op">-</span><span class="dv">1</span>):</a>
<a class="sourceLine" id="cb116-12" title="12">    diff[i] <span class="op">=</span> x[i<span class="op">+</span><span class="dv">1</span>] <span class="op">-</span> x[i]</a>
<a class="sourceLine" id="cb116-13" title="13">  <span class="cf">return</span> diff</a>
<a class="sourceLine" id="cb116-14" title="14"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb116-15" title="15"></a>
<a class="sourceLine" id="cb116-16" title="16">x <span class="op">=</span> np.array([<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">7</span>, <span class="dv">0</span>])</a>
<a class="sourceLine" id="cb116-17" title="17"></a>
<a class="sourceLine" id="cb116-18" title="18">true_y <span class="op">=</span> np.ediff1d(x)</a>
<a class="sourceLine" id="cb116-19" title="19"></a>
<a class="sourceLine" id="cb116-20" title="20">pred_y <span class="op">=</span> condiff_1d(x)</a>
<a class="sourceLine" id="cb116-21" title="21"></a>
<a class="sourceLine" id="cb116-22" title="22">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.allclose(true_y,pred_y) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-10">Run 3</h4>
<div class="sourceCode" id="cb118"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb118-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb118-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb118-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb118-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb118-5" title="5"></a>
<a class="sourceLine" id="cb118-6" title="6"><span class="kw">def</span> condiff_1d(x):</a>
<a class="sourceLine" id="cb118-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb118-8" title="8"><span class="co">  This function computes the difference between consecutive elements in array x.</span></a>
<a class="sourceLine" id="cb118-9" title="9"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb118-10" title="10">  diff <span class="op">=</span> np.zeros(<span class="bu">len</span>(x)<span class="op">-</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb118-11" title="11">  <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(x)<span class="op">-</span><span class="dv">1</span>):</a>
<a class="sourceLine" id="cb118-12" title="12">    diff[i] <span class="op">=</span> x[i<span class="op">+</span><span class="dv">1</span>] <span class="op">-</span> x[i]</a>
<a class="sourceLine" id="cb118-13" title="13">  <span class="cf">return</span> diff</a>
<a class="sourceLine" id="cb118-14" title="14"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb118-15" title="15"></a>
<a class="sourceLine" id="cb118-16" title="16">x <span class="op">=</span> np.array([<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">7</span>, <span class="dv">0</span>])</a>
<a class="sourceLine" id="cb118-17" title="17"></a>
<a class="sourceLine" id="cb118-18" title="18">true_y <span class="op">=</span> np.ediff1d(x)</a>
<a class="sourceLine" id="cb118-19" title="19"></a>
<a class="sourceLine" id="cb118-20" title="20">pred_y <span class="op">=</span> condiff_1d(x)</a>
<a class="sourceLine" id="cb118-21" title="21"></a>
<a class="sourceLine" id="cb118-22" title="22">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.allclose(true_y,pred_y) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-10">Run 4</h4>
<div class="sourceCode" id="cb120"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb120-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb120-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb120-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb120-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb120-5" title="5"></a>
<a class="sourceLine" id="cb120-6" title="6"><span class="kw">def</span> condiff_1d(x):</a>
<a class="sourceLine" id="cb120-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb120-8" title="8"><span class="co">  This function computes the difference between consecutive elements in array x.</span></a>
<a class="sourceLine" id="cb120-9" title="9"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb120-10" title="10">  diff <span class="op">=</span> np.zeros(<span class="bu">len</span>(x)<span class="op">-</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb120-11" title="11">  <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(x)<span class="op">-</span><span class="dv">1</span>):</a>
<a class="sourceLine" id="cb120-12" title="12">    diff[i] <span class="op">=</span> x[i<span class="op">+</span><span class="dv">1</span>] <span class="op">-</span> x[i]</a>
<a class="sourceLine" id="cb120-13" title="13">  <span class="cf">return</span> diff</a>
<a class="sourceLine" id="cb120-14" title="14"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb120-15" title="15"></a>
<a class="sourceLine" id="cb120-16" title="16">x <span class="op">=</span> np.array([<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">7</span>, <span class="dv">0</span>])</a>
<a class="sourceLine" id="cb120-17" title="17"></a>
<a class="sourceLine" id="cb120-18" title="18">true_y <span class="op">=</span> np.ediff1d(x)</a>
<a class="sourceLine" id="cb120-19" title="19"></a>
<a class="sourceLine" id="cb120-20" title="20">pred_y <span class="op">=</span> condiff_1d(x)</a>
<a class="sourceLine" id="cb120-21" title="21"></a>
<a class="sourceLine" id="cb120-22" title="22">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.allclose(true_y,pred_y) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>cubes</summary></p>
<h4 id="query-11">Query</h4>
<div class="sourceCode" id="cb122"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb122-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb122-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb122-3" title="3"></a>
<a class="sourceLine" id="cb122-4" title="4"><span class="kw">def</span> sum_of_cubes(n):</a>
<a class="sourceLine" id="cb122-5" title="5">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb122-6" title="6"><span class="co">  This function returns the sum of the first n cubes</span></a>
<a class="sourceLine" id="cb122-7" title="7"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb122-8" title="8">  [insert]</a>
<a class="sourceLine" id="cb122-9" title="9">  <span class="cf">return</span> s</a></code></pre></div>
<h4 id="run-0-11">Run 0</h4>
<div class="sourceCode" id="cb123"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb123-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb123-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb123-3" title="3"></a>
<a class="sourceLine" id="cb123-4" title="4"><span class="kw">def</span> sum_of_cubes(n):</a>
<a class="sourceLine" id="cb123-5" title="5">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb123-6" title="6"><span class="co">  This function returns the sum of the first n cubes</span></a>
<a class="sourceLine" id="cb123-7" title="7"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb123-8" title="8">  s <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb123-9" title="9">  <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>,n<span class="op">+</span><span class="dv">1</span>):</a>
<a class="sourceLine" id="cb123-10" title="10">    s <span class="op">+=</span> i<span class="op">**</span><span class="dv">3</span></a>
<a class="sourceLine" id="cb123-11" title="11">  <span class="cf">return</span> s</a>
<a class="sourceLine" id="cb123-12" title="12">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> sum_of_cubes(<span class="dv">5</span>) <span class="op">==</span> <span class="dv">225</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-11">Run 1</h4>
<div class="sourceCode" id="cb125"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb125-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb125-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb125-3" title="3"></a>
<a class="sourceLine" id="cb125-4" title="4"><span class="kw">def</span> sum_of_cubes(n):</a>
<a class="sourceLine" id="cb125-5" title="5">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb125-6" title="6"><span class="co">  This function returns the sum of the first n cubes</span></a>
<a class="sourceLine" id="cb125-7" title="7"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb125-8" title="8">  s <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb125-9" title="9">  <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n):</a>
<a class="sourceLine" id="cb125-10" title="10">    s <span class="op">+=</span> i<span class="op">**</span><span class="dv">3</span></a>
<a class="sourceLine" id="cb125-11" title="11">  <span class="cf">return</span> s</a>
<a class="sourceLine" id="cb125-12" title="12">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> sum_of_cubes(<span class="dv">5</span>) <span class="op">==</span> <span class="dv">225</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-11">Run 2</h4>
<div class="sourceCode" id="cb127"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb127-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb127-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb127-3" title="3"></a>
<a class="sourceLine" id="cb127-4" title="4"><span class="kw">def</span> sum_of_cubes(n):</a>
<a class="sourceLine" id="cb127-5" title="5">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb127-6" title="6"><span class="co">  This function returns the sum of the first n cubes</span></a>
<a class="sourceLine" id="cb127-7" title="7"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb127-8" title="8">  s <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb127-9" title="9">  <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>,n<span class="op">+</span><span class="dv">1</span>):</a>
<a class="sourceLine" id="cb127-10" title="10">    s <span class="op">+=</span> i<span class="op">**</span><span class="dv">3</span></a>
<a class="sourceLine" id="cb127-11" title="11">  <span class="cf">return</span> s</a>
<a class="sourceLine" id="cb127-12" title="12">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> sum_of_cubes(<span class="dv">5</span>) <span class="op">==</span> <span class="dv">225</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-11">Run 3</h4>
<div class="sourceCode" id="cb129"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb129-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb129-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb129-3" title="3"></a>
<a class="sourceLine" id="cb129-4" title="4"><span class="kw">def</span> sum_of_cubes(n):</a>
<a class="sourceLine" id="cb129-5" title="5">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb129-6" title="6"><span class="co">  This function returns the sum of the first n cubes</span></a>
<a class="sourceLine" id="cb129-7" title="7"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb129-8" title="8">  s <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb129-9" title="9">  <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, n<span class="op">+</span><span class="dv">1</span>):</a>
<a class="sourceLine" id="cb129-10" title="10">    s <span class="op">+=</span> i<span class="op">**</span><span class="dv">3</span></a>
<a class="sourceLine" id="cb129-11" title="11">  <span class="cf">return</span> s</a>
<a class="sourceLine" id="cb129-12" title="12">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> sum_of_cubes(<span class="dv">5</span>) <span class="op">==</span> <span class="dv">225</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-11">Run 4</h4>
<div class="sourceCode" id="cb131"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb131-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb131-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb131-3" title="3"></a>
<a class="sourceLine" id="cb131-4" title="4"><span class="kw">def</span> sum_of_cubes(n):</a>
<a class="sourceLine" id="cb131-5" title="5">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb131-6" title="6"><span class="co">  This function returns the sum of the first n cubes</span></a>
<a class="sourceLine" id="cb131-7" title="7"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb131-8" title="8">  s <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb131-9" title="9">  <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, n <span class="op">+</span> <span class="dv">1</span>):</a>
<a class="sourceLine" id="cb131-10" title="10">    s <span class="op">+=</span> i <span class="op">**</span> <span class="dv">3</span></a>
<a class="sourceLine" id="cb131-11" title="11">  <span class="cf">return</span> s</a>
<a class="sourceLine" id="cb131-12" title="12">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> sum_of_cubes(<span class="dv">5</span>) <span class="op">==</span> <span class="dv">225</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>de_broglie</summary></p>
<h4 id="query-12">Query</h4>
<div class="sourceCode" id="cb133"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb133-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb133-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb133-3" title="3"></a>
<a class="sourceLine" id="cb133-4" title="4"><span class="kw">def</span> de_broglie(m,v):</a>
<a class="sourceLine" id="cb133-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb133-6" title="6"><span class="co">   This function returns the de Broglie wavelength for a particle of mass m with speed v.</span></a>
<a class="sourceLine" id="cb133-7" title="7"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb133-8" title="8">   [insert]</a>
<a class="sourceLine" id="cb133-9" title="9">   <span class="cf">return</span> l</a></code></pre></div>
<h4 id="run-0-12">Run 0</h4>
<div class="sourceCode" id="cb134"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb134-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb134-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb134-3" title="3"></a>
<a class="sourceLine" id="cb134-4" title="4"><span class="kw">def</span> de_broglie(m,v):</a>
<a class="sourceLine" id="cb134-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb134-6" title="6"><span class="co">   This function returns the de Broglie wavelength for a particle of mass m with speed v.</span></a>
<a class="sourceLine" id="cb134-7" title="7"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb134-8" title="8">   h <span class="op">=</span> <span class="fl">6.626e-34</span></a>
<a class="sourceLine" id="cb134-9" title="9">   l <span class="op">=</span> h<span class="op">/</span>(m<span class="op">*</span>v)</a>
<a class="sourceLine" id="cb134-10" title="10">   <span class="cf">return</span> l</a>
<a class="sourceLine" id="cb134-11" title="11"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb134-12" title="12"></a>
<a class="sourceLine" id="cb134-13" title="13"><span class="co"># input params</span></a>
<a class="sourceLine" id="cb134-14" title="14">h <span class="op">=</span> <span class="fl">6.626e-34</span> </a>
<a class="sourceLine" id="cb134-15" title="15">v <span class="op">=</span> <span class="fl">1.00e6</span></a>
<a class="sourceLine" id="cb134-16" title="16">m <span class="op">=</span> <span class="fl">9.11e-31</span></a>
<a class="sourceLine" id="cb134-17" title="17"></a>
<a class="sourceLine" id="cb134-18" title="18">lam  <span class="op">=</span> h<span class="op">/</span>(m<span class="op">*</span>v)</a>
<a class="sourceLine" id="cb134-19" title="19"><span class="bu">print</span>(<span class="st">&quot;lam =&quot;</span>, lam)</a>
<a class="sourceLine" id="cb134-20" title="20"></a>
<a class="sourceLine" id="cb134-21" title="21">lam_codex <span class="op">=</span> de_broglie(m,v)</a>
<a class="sourceLine" id="cb134-22" title="22"></a>
<a class="sourceLine" id="cb134-23" title="23"><span class="co"># check </span></a>
<a class="sourceLine" id="cb134-24" title="24"><span class="cf">if</span> np.isclose(lam, lam_codex) <span class="op">==</span>  <span class="va">True</span>:</a>
<a class="sourceLine" id="cb134-25" title="25">    result <span class="op">=</span> <span class="va">True</span></a>
<a class="sourceLine" id="cb134-26" title="26"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb134-27" title="27">    result <span class="op">=</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb134-28" title="28"></a>
<a class="sourceLine" id="cb134-29" title="29"></a>
<a class="sourceLine" id="cb134-30" title="30"></a>
<a class="sourceLine" id="cb134-31" title="31"></a>
<a class="sourceLine" id="cb134-32" title="32"></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-12">Run 1</h4>
<div class="sourceCode" id="cb136"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb136-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb136-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb136-3" title="3"></a>
<a class="sourceLine" id="cb136-4" title="4"><span class="kw">def</span> de_broglie(m,v):</a>
<a class="sourceLine" id="cb136-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb136-6" title="6"><span class="co">   This function returns the de Broglie wavelength for a particle of mass m with speed v.</span></a>
<a class="sourceLine" id="cb136-7" title="7"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb136-8" title="8">   h <span class="op">=</span> <span class="fl">6.626e-34</span></a>
<a class="sourceLine" id="cb136-9" title="9">   l <span class="op">=</span> (h<span class="op">/</span>(m<span class="op">*</span>v))</a>
<a class="sourceLine" id="cb136-10" title="10">   <span class="cf">return</span> l</a>
<a class="sourceLine" id="cb136-11" title="11"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb136-12" title="12"></a>
<a class="sourceLine" id="cb136-13" title="13"><span class="co"># input params</span></a>
<a class="sourceLine" id="cb136-14" title="14">h <span class="op">=</span> <span class="fl">6.626e-34</span> </a>
<a class="sourceLine" id="cb136-15" title="15">v <span class="op">=</span> <span class="fl">1.00e6</span></a>
<a class="sourceLine" id="cb136-16" title="16">m <span class="op">=</span> <span class="fl">9.11e-31</span></a>
<a class="sourceLine" id="cb136-17" title="17"></a>
<a class="sourceLine" id="cb136-18" title="18">lam  <span class="op">=</span> h<span class="op">/</span>(m<span class="op">*</span>v)</a>
<a class="sourceLine" id="cb136-19" title="19"><span class="bu">print</span>(<span class="st">&quot;lam =&quot;</span>, lam)</a>
<a class="sourceLine" id="cb136-20" title="20"></a>
<a class="sourceLine" id="cb136-21" title="21">lam_codex <span class="op">=</span> de_broglie(m,v)</a>
<a class="sourceLine" id="cb136-22" title="22"></a>
<a class="sourceLine" id="cb136-23" title="23"><span class="co"># check </span></a>
<a class="sourceLine" id="cb136-24" title="24"><span class="cf">if</span> np.isclose(lam, lam_codex) <span class="op">==</span>  <span class="va">True</span>:</a>
<a class="sourceLine" id="cb136-25" title="25">    result <span class="op">=</span> <span class="va">True</span></a>
<a class="sourceLine" id="cb136-26" title="26"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb136-27" title="27">    result <span class="op">=</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb136-28" title="28"></a>
<a class="sourceLine" id="cb136-29" title="29"></a>
<a class="sourceLine" id="cb136-30" title="30"></a>
<a class="sourceLine" id="cb136-31" title="31"></a>
<a class="sourceLine" id="cb136-32" title="32"></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-12">Run 2</h4>
<div class="sourceCode" id="cb138"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb138-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb138-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb138-3" title="3"></a>
<a class="sourceLine" id="cb138-4" title="4"><span class="kw">def</span> de_broglie(m,v):</a>
<a class="sourceLine" id="cb138-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb138-6" title="6"><span class="co">   This function returns the de Broglie wavelength for a particle of mass m with speed v.</span></a>
<a class="sourceLine" id="cb138-7" title="7"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb138-8" title="8">   l <span class="op">=</span> (h<span class="op">*</span>v)<span class="op">/</span>(m<span class="op">*</span>v<span class="op">**</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb138-9" title="9">   <span class="cf">return</span> l</a>
<a class="sourceLine" id="cb138-10" title="10"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb138-11" title="11"></a>
<a class="sourceLine" id="cb138-12" title="12"><span class="co"># input params</span></a>
<a class="sourceLine" id="cb138-13" title="13">h <span class="op">=</span> <span class="fl">6.626e-34</span> </a>
<a class="sourceLine" id="cb138-14" title="14">v <span class="op">=</span> <span class="fl">1.00e6</span></a>
<a class="sourceLine" id="cb138-15" title="15">m <span class="op">=</span> <span class="fl">9.11e-31</span></a>
<a class="sourceLine" id="cb138-16" title="16"></a>
<a class="sourceLine" id="cb138-17" title="17">lam  <span class="op">=</span> h<span class="op">/</span>(m<span class="op">*</span>v)</a>
<a class="sourceLine" id="cb138-18" title="18"><span class="bu">print</span>(<span class="st">&quot;lam =&quot;</span>, lam)</a>
<a class="sourceLine" id="cb138-19" title="19"></a>
<a class="sourceLine" id="cb138-20" title="20">lam_codex <span class="op">=</span> de_broglie(m,v)</a>
<a class="sourceLine" id="cb138-21" title="21"></a>
<a class="sourceLine" id="cb138-22" title="22"><span class="co"># check </span></a>
<a class="sourceLine" id="cb138-23" title="23"><span class="cf">if</span> np.isclose(lam, lam_codex) <span class="op">==</span>  <span class="va">True</span>:</a>
<a class="sourceLine" id="cb138-24" title="24">    result <span class="op">=</span> <span class="va">True</span></a>
<a class="sourceLine" id="cb138-25" title="25"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb138-26" title="26">    result <span class="op">=</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb138-27" title="27"></a>
<a class="sourceLine" id="cb138-28" title="28"></a>
<a class="sourceLine" id="cb138-29" title="29"></a>
<a class="sourceLine" id="cb138-30" title="30"></a>
<a class="sourceLine" id="cb138-31" title="31"></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-12">Run 3</h4>
<div class="sourceCode" id="cb140"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb140-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb140-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb140-3" title="3"></a>
<a class="sourceLine" id="cb140-4" title="4"><span class="kw">def</span> de_broglie(m,v):</a>
<a class="sourceLine" id="cb140-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb140-6" title="6"><span class="co">   This function returns the de Broglie wavelength for a particle of mass m with speed v.</span></a>
<a class="sourceLine" id="cb140-7" title="7"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb140-8" title="8">   h <span class="op">=</span> <span class="fl">6.626e-34</span></a>
<a class="sourceLine" id="cb140-9" title="9">   l <span class="op">=</span> h<span class="op">/</span>(m<span class="op">*</span>v)</a>
<a class="sourceLine" id="cb140-10" title="10">   <span class="cf">return</span> l</a>
<a class="sourceLine" id="cb140-11" title="11"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb140-12" title="12"></a>
<a class="sourceLine" id="cb140-13" title="13"><span class="co"># input params</span></a>
<a class="sourceLine" id="cb140-14" title="14">h <span class="op">=</span> <span class="fl">6.626e-34</span> </a>
<a class="sourceLine" id="cb140-15" title="15">v <span class="op">=</span> <span class="fl">1.00e6</span></a>
<a class="sourceLine" id="cb140-16" title="16">m <span class="op">=</span> <span class="fl">9.11e-31</span></a>
<a class="sourceLine" id="cb140-17" title="17"></a>
<a class="sourceLine" id="cb140-18" title="18">lam  <span class="op">=</span> h<span class="op">/</span>(m<span class="op">*</span>v)</a>
<a class="sourceLine" id="cb140-19" title="19"><span class="bu">print</span>(<span class="st">&quot;lam =&quot;</span>, lam)</a>
<a class="sourceLine" id="cb140-20" title="20"></a>
<a class="sourceLine" id="cb140-21" title="21">lam_codex <span class="op">=</span> de_broglie(m,v)</a>
<a class="sourceLine" id="cb140-22" title="22"></a>
<a class="sourceLine" id="cb140-23" title="23"><span class="co"># check </span></a>
<a class="sourceLine" id="cb140-24" title="24"><span class="cf">if</span> np.isclose(lam, lam_codex) <span class="op">==</span>  <span class="va">True</span>:</a>
<a class="sourceLine" id="cb140-25" title="25">    result <span class="op">=</span> <span class="va">True</span></a>
<a class="sourceLine" id="cb140-26" title="26"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb140-27" title="27">    result <span class="op">=</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb140-28" title="28"></a>
<a class="sourceLine" id="cb140-29" title="29"></a>
<a class="sourceLine" id="cb140-30" title="30"></a>
<a class="sourceLine" id="cb140-31" title="31"></a>
<a class="sourceLine" id="cb140-32" title="32"></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-12">Run 4</h4>
<div class="sourceCode" id="cb142"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb142-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb142-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb142-3" title="3"></a>
<a class="sourceLine" id="cb142-4" title="4"><span class="kw">def</span> de_broglie(m,v):</a>
<a class="sourceLine" id="cb142-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb142-6" title="6"><span class="co">   This function returns the de Broglie wavelength for a particle of mass m with speed v.</span></a>
<a class="sourceLine" id="cb142-7" title="7"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb142-8" title="8">   h <span class="op">=</span> <span class="fl">6.626e-34</span></a>
<a class="sourceLine" id="cb142-9" title="9">   l <span class="op">=</span> h <span class="op">/</span> (m <span class="op">*</span> v)</a>
<a class="sourceLine" id="cb142-10" title="10">   <span class="cf">return</span> l</a>
<a class="sourceLine" id="cb142-11" title="11"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb142-12" title="12"></a>
<a class="sourceLine" id="cb142-13" title="13"><span class="co"># input params</span></a>
<a class="sourceLine" id="cb142-14" title="14">h <span class="op">=</span> <span class="fl">6.626e-34</span> </a>
<a class="sourceLine" id="cb142-15" title="15">v <span class="op">=</span> <span class="fl">1.00e6</span></a>
<a class="sourceLine" id="cb142-16" title="16">m <span class="op">=</span> <span class="fl">9.11e-31</span></a>
<a class="sourceLine" id="cb142-17" title="17"></a>
<a class="sourceLine" id="cb142-18" title="18">lam  <span class="op">=</span> h<span class="op">/</span>(m<span class="op">*</span>v)</a>
<a class="sourceLine" id="cb142-19" title="19"><span class="bu">print</span>(<span class="st">&quot;lam =&quot;</span>, lam)</a>
<a class="sourceLine" id="cb142-20" title="20"></a>
<a class="sourceLine" id="cb142-21" title="21">lam_codex <span class="op">=</span> de_broglie(m,v)</a>
<a class="sourceLine" id="cb142-22" title="22"></a>
<a class="sourceLine" id="cb142-23" title="23"><span class="co"># check </span></a>
<a class="sourceLine" id="cb142-24" title="24"><span class="cf">if</span> np.isclose(lam, lam_codex) <span class="op">==</span>  <span class="va">True</span>:</a>
<a class="sourceLine" id="cb142-25" title="25">    result <span class="op">=</span> <span class="va">True</span></a>
<a class="sourceLine" id="cb142-26" title="26"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb142-27" title="27">    result <span class="op">=</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb142-28" title="28"></a>
<a class="sourceLine" id="cb142-29" title="29"></a>
<a class="sourceLine" id="cb142-30" title="30"></a>
<a class="sourceLine" id="cb142-31" title="31"></a>
<a class="sourceLine" id="cb142-32" title="32"></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>derivative1d-ch</summary></p>
<h4 id="query-13">Query</h4>
<div class="sourceCode" id="cb144"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb144-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb144-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb144-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb144-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb144-5" title="5"></a>
<a class="sourceLine" id="cb144-6" title="6"><span class="kw">def</span> find_derivative(a,b,c,x):</a>
<a class="sourceLine" id="cb144-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb144-8" title="8"><span class="co">  这个函数通过生成含有参数a，b，c的二阶多項式来计算x处的一阶导数。</span></a>
<a class="sourceLine" id="cb144-9" title="9"></a>
<a class="sourceLine" id="cb144-10" title="10"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb144-11" title="11">  [insert]</a>
<a class="sourceLine" id="cb144-12" title="12">  <span class="cf">return</span> d</a></code></pre></div>
<h4 id="run-0-13">Run 0</h4>
<div class="sourceCode" id="cb145"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb145-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb145-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb145-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb145-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb145-5" title="5"></a>
<a class="sourceLine" id="cb145-6" title="6"><span class="kw">def</span> find_derivative(a,b,c,x):</a>
<a class="sourceLine" id="cb145-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb145-8" title="8"><span class="co">  这个函数通过生成含有参数a，b，c的二阶多項式来计算x处的一阶导数。</span></a>
<a class="sourceLine" id="cb145-9" title="9"></a>
<a class="sourceLine" id="cb145-10" title="10"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb145-11" title="11">  d <span class="op">=</span> <span class="dv">2</span><span class="op">*</span>a<span class="op">*</span>x <span class="op">+</span> b</a>
<a class="sourceLine" id="cb145-12" title="12">  <span class="cf">return</span> d</a>
<a class="sourceLine" id="cb145-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb145-14" title="14"></a>
<a class="sourceLine" id="cb145-15" title="15">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> find_derivative(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">2</span>) <span class="op">==</span> <span class="dv">6</span> <span class="cf">else</span> <span class="va">False</span> </a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-13">Run 1</h4>
<div class="sourceCode" id="cb147"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb147-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb147-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb147-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb147-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb147-5" title="5"></a>
<a class="sourceLine" id="cb147-6" title="6"><span class="kw">def</span> find_derivative(a,b,c,x):</a>
<a class="sourceLine" id="cb147-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb147-8" title="8"><span class="co">  这个函数通过生成含有参数a，b，c的二阶多項式来计算x处的一阶导数。</span></a>
<a class="sourceLine" id="cb147-9" title="9"></a>
<a class="sourceLine" id="cb147-10" title="10"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb147-11" title="11">  d <span class="op">=</span> <span class="dv">2</span><span class="op">*</span>a<span class="op">*</span>x <span class="op">+</span> b</a>
<a class="sourceLine" id="cb147-12" title="12">  <span class="cf">return</span> d</a>
<a class="sourceLine" id="cb147-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb147-14" title="14"></a>
<a class="sourceLine" id="cb147-15" title="15">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> find_derivative(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">2</span>) <span class="op">==</span> <span class="dv">6</span> <span class="cf">else</span> <span class="va">False</span> </a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-13">Run 2</h4>
<div class="sourceCode" id="cb149"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb149-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb149-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb149-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb149-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb149-5" title="5"></a>
<a class="sourceLine" id="cb149-6" title="6"><span class="kw">def</span> find_derivative(a,b,c,x):</a>
<a class="sourceLine" id="cb149-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb149-8" title="8"><span class="co">  这个函数通过生成含有参数a，b，c的二阶多項式来计算x处的一阶导数。</span></a>
<a class="sourceLine" id="cb149-9" title="9"></a>
<a class="sourceLine" id="cb149-10" title="10"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb149-11" title="11">  d <span class="op">=</span> <span class="dv">2</span><span class="op">*</span>a<span class="op">*</span>x <span class="op">+</span> b</a>
<a class="sourceLine" id="cb149-12" title="12">  <span class="cf">return</span> d</a>
<a class="sourceLine" id="cb149-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb149-14" title="14"></a>
<a class="sourceLine" id="cb149-15" title="15">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> find_derivative(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">2</span>) <span class="op">==</span> <span class="dv">6</span> <span class="cf">else</span> <span class="va">False</span> </a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-13">Run 3</h4>
<div class="sourceCode" id="cb151"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb151-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb151-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb151-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb151-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb151-5" title="5"></a>
<a class="sourceLine" id="cb151-6" title="6"><span class="kw">def</span> find_derivative(a,b,c,x):</a>
<a class="sourceLine" id="cb151-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb151-8" title="8"><span class="co">  这个函数通过生成含有参数a，b，c的二阶多項式来计算x处的一阶导数。</span></a>
<a class="sourceLine" id="cb151-9" title="9"></a>
<a class="sourceLine" id="cb151-10" title="10"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb151-11" title="11">  d <span class="op">=</span> <span class="dv">2</span><span class="op">*</span>a<span class="op">*</span>x <span class="op">+</span> b</a>
<a class="sourceLine" id="cb151-12" title="12">  <span class="cf">return</span> d</a>
<a class="sourceLine" id="cb151-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb151-14" title="14"></a>
<a class="sourceLine" id="cb151-15" title="15">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> find_derivative(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">2</span>) <span class="op">==</span> <span class="dv">6</span> <span class="cf">else</span> <span class="va">False</span> </a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-13">Run 4</h4>
<div class="sourceCode" id="cb153"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb153-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb153-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb153-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb153-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb153-5" title="5"></a>
<a class="sourceLine" id="cb153-6" title="6"><span class="kw">def</span> find_derivative(a,b,c,x):</a>
<a class="sourceLine" id="cb153-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb153-8" title="8"><span class="co">  这个函数通过生成含有参数a，b，c的二阶多項式来计算x处的一阶导数。</span></a>
<a class="sourceLine" id="cb153-9" title="9"></a>
<a class="sourceLine" id="cb153-10" title="10"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb153-11" title="11">  d <span class="op">=</span> <span class="dv">2</span><span class="op">*</span>a<span class="op">*</span>x <span class="op">+</span> b</a>
<a class="sourceLine" id="cb153-12" title="12">  <span class="cf">return</span> d</a>
<a class="sourceLine" id="cb153-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb153-14" title="14"></a>
<a class="sourceLine" id="cb153-15" title="15">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> find_derivative(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">2</span>) <span class="op">==</span> <span class="dv">6</span> <span class="cf">else</span> <span class="va">False</span> </a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>derivative_2deg</summary></p>
<h4 id="query-14">Query</h4>
<div class="sourceCode" id="cb155"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb155-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb155-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb155-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb155-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb155-5" title="5"></a>
<a class="sourceLine" id="cb155-6" title="6"><span class="kw">def</span> find_derivative(a,b,c,x):</a>
<a class="sourceLine" id="cb155-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb155-8" title="8"><span class="co">  This function generates a 2nd degree polynomial with coefficients a,b,c and return derivative at x</span></a>
<a class="sourceLine" id="cb155-9" title="9"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb155-10" title="10">  [insert]</a>
<a class="sourceLine" id="cb155-11" title="11">  <span class="cf">return</span> deriv</a></code></pre></div>
<h4 id="run-0-14">Run 0</h4>
<div class="sourceCode" id="cb156"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb156-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb156-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb156-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb156-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb156-5" title="5"></a>
<a class="sourceLine" id="cb156-6" title="6"><span class="kw">def</span> find_derivative(a,b,c,x):</a>
<a class="sourceLine" id="cb156-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb156-8" title="8"><span class="co">  This function generates a 2nd degree polynomial with coefficients a,b,c and return derivative at x</span></a>
<a class="sourceLine" id="cb156-9" title="9"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb156-10" title="10">  deriv <span class="op">=</span> <span class="dv">2</span><span class="op">*</span>a<span class="op">*</span>x <span class="op">+</span> b</a>
<a class="sourceLine" id="cb156-11" title="11">  <span class="cf">return</span> deriv</a>
<a class="sourceLine" id="cb156-12" title="12"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb156-13" title="13"></a>
<a class="sourceLine" id="cb156-14" title="14">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> find_derivative(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">2</span>) <span class="op">==</span> <span class="dv">6</span> <span class="cf">else</span> <span class="va">False</span> </a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-14">Run 1</h4>
<div class="sourceCode" id="cb158"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb158-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb158-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb158-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb158-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb158-5" title="5"></a>
<a class="sourceLine" id="cb158-6" title="6"><span class="kw">def</span> find_derivative(a,b,c,x):</a>
<a class="sourceLine" id="cb158-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb158-8" title="8"><span class="co">  This function generates a 2nd degree polynomial with coefficients a,b,c and return derivative at x</span></a>
<a class="sourceLine" id="cb158-9" title="9"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb158-10" title="10">  deriv <span class="op">=</span> <span class="dv">2</span><span class="op">*</span>a<span class="op">*</span>x <span class="op">+</span> b</a>
<a class="sourceLine" id="cb158-11" title="11">  <span class="cf">return</span> deriv</a>
<a class="sourceLine" id="cb158-12" title="12"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb158-13" title="13"></a>
<a class="sourceLine" id="cb158-14" title="14">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> find_derivative(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">2</span>) <span class="op">==</span> <span class="dv">6</span> <span class="cf">else</span> <span class="va">False</span> </a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-14">Run 2</h4>
<div class="sourceCode" id="cb160"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb160-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb160-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb160-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb160-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb160-5" title="5"></a>
<a class="sourceLine" id="cb160-6" title="6"><span class="kw">def</span> find_derivative(a,b,c,x):</a>
<a class="sourceLine" id="cb160-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb160-8" title="8"><span class="co">  This function generates a 2nd degree polynomial with coefficients a,b,c and return derivative at x</span></a>
<a class="sourceLine" id="cb160-9" title="9"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb160-10" title="10">  deriv <span class="op">=</span> <span class="dv">2</span><span class="op">*</span>a<span class="op">*</span>x <span class="op">+</span> b</a>
<a class="sourceLine" id="cb160-11" title="11">  <span class="cf">return</span> deriv</a>
<a class="sourceLine" id="cb160-12" title="12"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb160-13" title="13"></a>
<a class="sourceLine" id="cb160-14" title="14">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> find_derivative(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">2</span>) <span class="op">==</span> <span class="dv">6</span> <span class="cf">else</span> <span class="va">False</span> </a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-14">Run 3</h4>
<div class="sourceCode" id="cb162"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb162-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb162-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb162-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb162-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb162-5" title="5"></a>
<a class="sourceLine" id="cb162-6" title="6"><span class="kw">def</span> find_derivative(a,b,c,x):</a>
<a class="sourceLine" id="cb162-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb162-8" title="8"><span class="co">  This function generates a 2nd degree polynomial with coefficients a,b,c and return derivative at x</span></a>
<a class="sourceLine" id="cb162-9" title="9"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb162-10" title="10">  deriv <span class="op">=</span> <span class="dv">2</span><span class="op">*</span>a<span class="op">*</span>x <span class="op">+</span> b</a>
<a class="sourceLine" id="cb162-11" title="11">  <span class="cf">return</span> deriv</a>
<a class="sourceLine" id="cb162-12" title="12"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb162-13" title="13"></a>
<a class="sourceLine" id="cb162-14" title="14">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> find_derivative(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">2</span>) <span class="op">==</span> <span class="dv">6</span> <span class="cf">else</span> <span class="va">False</span> </a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-14">Run 4</h4>
<div class="sourceCode" id="cb164"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb164-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb164-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb164-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb164-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb164-5" title="5"></a>
<a class="sourceLine" id="cb164-6" title="6"><span class="kw">def</span> find_derivative(a,b,c,x):</a>
<a class="sourceLine" id="cb164-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb164-8" title="8"><span class="co">  This function generates a 2nd degree polynomial with coefficients a,b,c and return derivative at x</span></a>
<a class="sourceLine" id="cb164-9" title="9"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb164-10" title="10">  deriv <span class="op">=</span> <span class="dv">2</span><span class="op">*</span>a<span class="op">*</span>x <span class="op">+</span> b</a>
<a class="sourceLine" id="cb164-11" title="11">  <span class="cf">return</span> deriv</a>
<a class="sourceLine" id="cb164-12" title="12"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb164-13" title="13"></a>
<a class="sourceLine" id="cb164-14" title="14">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> find_derivative(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">2</span>) <span class="op">==</span> <span class="dv">6</span> <span class="cf">else</span> <span class="va">False</span> </a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>descriptors</summary></p>
<h4 id="query-15">Query</h4>
<div class="sourceCode" id="cb166"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb166-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb166-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb166-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb166-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb166-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb166-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb166-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb166-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb166-9" title="9"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb166-10" title="10"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb166-11" title="11"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb166-12" title="12"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb166-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb166-14" title="14"></a>
<a class="sourceLine" id="cb166-15" title="15"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb166-16" title="16"></a>
<a class="sourceLine" id="cb166-17" title="17"><span class="kw">def</span> get_descriptors(smiles_list):</a>
<a class="sourceLine" id="cb166-18" title="18">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb166-19" title="19"><span class="co">    Returns an N x 8 matrix of descriptors for given SMILEs</span></a>
<a class="sourceLine" id="cb166-20" title="20"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb166-21" title="21">    [insert]</a>
<a class="sourceLine" id="cb166-22" title="22">    <span class="cf">return</span> descriptors</a></code></pre></div>
<h4 id="run-0-15">Run 0</h4>
<div class="sourceCode" id="cb167"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb167-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb167-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb167-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb167-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb167-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb167-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb167-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb167-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb167-9" title="9"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb167-10" title="10"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb167-11" title="11"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb167-12" title="12"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb167-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb167-14" title="14"></a>
<a class="sourceLine" id="cb167-15" title="15"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb167-16" title="16"></a>
<a class="sourceLine" id="cb167-17" title="17"><span class="kw">def</span> get_descriptors(smiles_list):</a>
<a class="sourceLine" id="cb167-18" title="18">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb167-19" title="19"><span class="co">    Returns an N x 8 matrix of descriptors for given SMILEs</span></a>
<a class="sourceLine" id="cb167-20" title="20"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb167-21" title="21">    descriptors <span class="op">=</span> []</a>
<a class="sourceLine" id="cb167-22" title="22">    <span class="cf">for</span> smiles <span class="kw">in</span> smiles_list:</a>
<a class="sourceLine" id="cb167-23" title="23">        mol <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb167-24" title="24">        descriptors.append(np.array(MoleculeDescriptors.MolecularDescriptorCalculator([x[<span class="dv">0</span>] <span class="cf">for</span> x <span class="kw">in</span> Descriptors._descList]).CalcDescriptors(mol)))</a>
<a class="sourceLine" id="cb167-25" title="25">    descriptors <span class="op">=</span> np.array(descriptors)</a>
<a class="sourceLine" id="cb167-26" title="26">    <span class="cf">return</span> descriptors</a>
<a class="sourceLine" id="cb167-27" title="27">s <span class="op">=</span> [<span class="st">&#39;CC=O&#39;</span>, <span class="st">&#39;CC=C=C(C(=O)N)&#39;</span>]</a>
<a class="sourceLine" id="cb167-28" title="28">v <span class="op">=</span> get_descriptors(s)</a>
<a class="sourceLine" id="cb167-29" title="29">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.shape(v) <span class="op">==</span> (<span class="dv">2</span>, <span class="dv">8</span>) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-15">Run 1</h4>
<div class="sourceCode" id="cb169"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb169-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb169-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb169-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb169-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb169-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb169-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb169-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb169-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb169-9" title="9"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb169-10" title="10"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb169-11" title="11"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb169-12" title="12"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb169-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb169-14" title="14"></a>
<a class="sourceLine" id="cb169-15" title="15"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb169-16" title="16"></a>
<a class="sourceLine" id="cb169-17" title="17"><span class="kw">def</span> get_descriptors(smiles_list):</a>
<a class="sourceLine" id="cb169-18" title="18">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb169-19" title="19"><span class="co">    Returns an N x 8 matrix of descriptors for given SMILEs</span></a>
<a class="sourceLine" id="cb169-20" title="20"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb169-21" title="21">    descriptors <span class="op">=</span> []</a>
<a class="sourceLine" id="cb169-22" title="22">    <span class="cf">for</span> smiles <span class="kw">in</span> smiles_list:</a>
<a class="sourceLine" id="cb169-23" title="23">        mol <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb169-24" title="24">        descriptors.append(MoleculeDescriptors.MolecularDescriptorCalculator([x[<span class="dv">0</span>] <span class="cf">for</span> x <span class="kw">in</span> Descriptors._descList]).CalcDescriptors(mol))</a>
<a class="sourceLine" id="cb169-25" title="25">    descriptors <span class="op">=</span> np.array(descriptors)</a>
<a class="sourceLine" id="cb169-26" title="26">    <span class="cf">return</span> descriptors</a>
<a class="sourceLine" id="cb169-27" title="27">s <span class="op">=</span> [<span class="st">&#39;CC=O&#39;</span>, <span class="st">&#39;CC=C=C(C(=O)N)&#39;</span>]</a>
<a class="sourceLine" id="cb169-28" title="28">v <span class="op">=</span> get_descriptors(s)</a>
<a class="sourceLine" id="cb169-29" title="29">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.shape(v) <span class="op">==</span> (<span class="dv">2</span>, <span class="dv">8</span>) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-15">Run 2</h4>
<div class="sourceCode" id="cb171"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb171-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb171-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb171-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb171-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb171-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb171-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb171-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb171-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb171-9" title="9"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb171-10" title="10"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb171-11" title="11"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb171-12" title="12"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb171-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb171-14" title="14"></a>
<a class="sourceLine" id="cb171-15" title="15"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb171-16" title="16"></a>
<a class="sourceLine" id="cb171-17" title="17"><span class="kw">def</span> get_descriptors(smiles_list):</a>
<a class="sourceLine" id="cb171-18" title="18">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb171-19" title="19"><span class="co">    Returns an N x 8 matrix of descriptors for given SMILEs</span></a>
<a class="sourceLine" id="cb171-20" title="20"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb171-21" title="21">    descriptors <span class="op">=</span> []</a>
<a class="sourceLine" id="cb171-22" title="22">    <span class="cf">for</span> smiles <span class="kw">in</span> smiles_list:</a>
<a class="sourceLine" id="cb171-23" title="23">        mol <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb171-24" title="24">        descriptors.append(np.array(MoleculeDescriptors.MolecularDescriptorCalculator([x[<span class="dv">0</span>] <span class="cf">for</span> x <span class="kw">in</span> Descriptors._descList]).CalcDescriptors(mol)))</a>
<a class="sourceLine" id="cb171-25" title="25"></a>
<a class="sourceLine" id="cb171-26" title="26">    <span class="cf">return</span> descriptors</a>
<a class="sourceLine" id="cb171-27" title="27">s <span class="op">=</span> [<span class="st">&#39;CC=O&#39;</span>, <span class="st">&#39;CC=C=C(C(=O)N)&#39;</span>]</a>
<a class="sourceLine" id="cb171-28" title="28">v <span class="op">=</span> get_descriptors(s)</a>
<a class="sourceLine" id="cb171-29" title="29">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.shape(v) <span class="op">==</span> (<span class="dv">2</span>, <span class="dv">8</span>) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-15">Run 3</h4>
<div class="sourceCode" id="cb173"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb173-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb173-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb173-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb173-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb173-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb173-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb173-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb173-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb173-9" title="9"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb173-10" title="10"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb173-11" title="11"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb173-12" title="12"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb173-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb173-14" title="14"></a>
<a class="sourceLine" id="cb173-15" title="15"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb173-16" title="16"></a>
<a class="sourceLine" id="cb173-17" title="17"><span class="kw">def</span> get_descriptors(smiles_list):</a>
<a class="sourceLine" id="cb173-18" title="18">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb173-19" title="19"><span class="co">    Returns an N x 8 matrix of descriptors for given SMILEs</span></a>
<a class="sourceLine" id="cb173-20" title="20"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb173-21" title="21">    descriptors <span class="op">=</span> []</a>
<a class="sourceLine" id="cb173-22" title="22">    <span class="cf">for</span> smile <span class="kw">in</span> smiles_list:</a>
<a class="sourceLine" id="cb173-23" title="23">        mol <span class="op">=</span> Chem.MolFromSmiles(smile)</a>
<a class="sourceLine" id="cb173-24" title="24">        descriptors.append(np.array(MoleculeDescriptors.MolecularDescriptorCalculator([x[<span class="dv">0</span>] <span class="cf">for</span> x <span class="kw">in</span> Descriptors._descList]).CalcDescriptors(mol)))</a>
<a class="sourceLine" id="cb173-25" title="25">    descriptors <span class="op">=</span> np.array(descriptors)</a>
<a class="sourceLine" id="cb173-26" title="26">    <span class="bu">print</span>(descriptors.shape)</a>
<a class="sourceLine" id="cb173-27" title="27">    <span class="cf">return</span> descriptors</a>
<a class="sourceLine" id="cb173-28" title="28">s <span class="op">=</span> [<span class="st">&#39;CC=O&#39;</span>, <span class="st">&#39;CC=C=C(C(=O)N)&#39;</span>]</a>
<a class="sourceLine" id="cb173-29" title="29">v <span class="op">=</span> get_descriptors(s)</a>
<a class="sourceLine" id="cb173-30" title="30">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.shape(v) <span class="op">==</span> (<span class="dv">2</span>, <span class="dv">8</span>) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-15">Run 4</h4>
<div class="sourceCode" id="cb175"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb175-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb175-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb175-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb175-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb175-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb175-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb175-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb175-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb175-9" title="9"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb175-10" title="10"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb175-11" title="11"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb175-12" title="12"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb175-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb175-14" title="14"></a>
<a class="sourceLine" id="cb175-15" title="15"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb175-16" title="16"></a>
<a class="sourceLine" id="cb175-17" title="17"><span class="kw">def</span> get_descriptors(smiles_list):</a>
<a class="sourceLine" id="cb175-18" title="18">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb175-19" title="19"><span class="co">    Returns an N x 8 matrix of descriptors for given SMILEs</span></a>
<a class="sourceLine" id="cb175-20" title="20"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb175-21" title="21">    descriptors <span class="op">=</span> []</a>
<a class="sourceLine" id="cb175-22" title="22">    <span class="cf">for</span> smiles <span class="kw">in</span> smiles_list:</a>
<a class="sourceLine" id="cb175-23" title="23">        mol <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb175-24" title="24">        descriptors.append(np.array(MoleculeDescriptors.MolecularDescriptorCalculator([x[<span class="dv">0</span>] <span class="cf">for</span> x <span class="kw">in</span> Descriptors._descList]).CalcDescriptors(mol)))</a>
<a class="sourceLine" id="cb175-25" title="25">    descriptors <span class="op">=</span> np.array(descriptors)</a>
<a class="sourceLine" id="cb175-26" title="26">    <span class="cf">return</span> descriptors</a>
<a class="sourceLine" id="cb175-27" title="27">s <span class="op">=</span> [<span class="st">&#39;CC=O&#39;</span>, <span class="st">&#39;CC=C=C(C(=O)N)&#39;</span>]</a>
<a class="sourceLine" id="cb175-28" title="28">v <span class="op">=</span> get_descriptors(s)</a>
<a class="sourceLine" id="cb175-29" title="29">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.shape(v) <span class="op">==</span> (<span class="dv">2</span>, <span class="dv">8</span>) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>dipole</summary></p>
<h4 id="query-16">Query</h4>
<div class="sourceCode" id="cb177"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb177-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb177-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb177-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb177-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb177-5" title="5"></a>
<a class="sourceLine" id="cb177-6" title="6"><span class="kw">def</span> dipole_moment(coordinates, charges):</a>
<a class="sourceLine" id="cb177-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb177-8" title="8"><span class="co">  This function returns the dipole moment of a molecule</span></a>
<a class="sourceLine" id="cb177-9" title="9"></a>
<a class="sourceLine" id="cb177-10" title="10"><span class="co">  Coordinates is a numpy array of size Nx3</span></a>
<a class="sourceLine" id="cb177-11" title="11"><span class="co">  Charges is a numpy array of size N</span></a>
<a class="sourceLine" id="cb177-12" title="12"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb177-13" title="13">  [insert]</a>
<a class="sourceLine" id="cb177-14" title="14">  <span class="cf">return</span> dipole_moment</a></code></pre></div>
<h4 id="run-0-16">Run 0</h4>
<div class="sourceCode" id="cb178"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb178-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb178-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb178-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb178-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb178-5" title="5"></a>
<a class="sourceLine" id="cb178-6" title="6"><span class="kw">def</span> dipole_moment(coordinates, charges):</a>
<a class="sourceLine" id="cb178-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb178-8" title="8"><span class="co">  This function returns the dipole moment of a molecule</span></a>
<a class="sourceLine" id="cb178-9" title="9"></a>
<a class="sourceLine" id="cb178-10" title="10"><span class="co">  Coordinates is a numpy array of size Nx3</span></a>
<a class="sourceLine" id="cb178-11" title="11"><span class="co">  Charges is a numpy array of size N</span></a>
<a class="sourceLine" id="cb178-12" title="12"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb178-13" title="13">  dipole_moment <span class="op">=</span> np.zeros(<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb178-14" title="14">  <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(charges)):</a>
<a class="sourceLine" id="cb178-15" title="15">    dipole_moment <span class="op">+=</span> charges[i] <span class="op">*</span> coordinates[i]</a>
<a class="sourceLine" id="cb178-16" title="16"></a>
<a class="sourceLine" id="cb178-17" title="17">  <span class="cf">return</span> dipole_moment</a>
<a class="sourceLine" id="cb178-18" title="18"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb178-19" title="19"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb178-20" title="20">coordinates <span class="op">=</span> np.loadtxt(os.path.join(_FILE_DIR_,<span class="st">&quot;water.xyz&quot;</span>),usecols<span class="op">=</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>))</a>
<a class="sourceLine" id="cb178-21" title="21"><span class="co">#note, these are fake</span></a>
<a class="sourceLine" id="cb178-22" title="22">charges <span class="op">=</span> np.loadtxt(os.path.join(_FILE_DIR_,<span class="st">&quot;charges.txt&quot;</span>))</a>
<a class="sourceLine" id="cb178-23" title="23">my_dipole <span class="op">=</span> (coordinates.T<span class="op">*</span>charges).<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb178-24" title="24">nl_dipole <span class="op">=</span> dipole_moment(coordinates,charges) </a>
<a class="sourceLine" id="cb178-25" title="25"></a>
<a class="sourceLine" id="cb178-26" title="26"><span class="co">#print(&quot;My result:&quot;,my_dipole)</span></a>
<a class="sourceLine" id="cb178-27" title="27"><span class="co">#print(&quot;NL result:&quot;,nl_dipole)</span></a>
<a class="sourceLine" id="cb178-28" title="28">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">all</span>(np.<span class="bu">abs</span>( my_dipole <span class="op">-</span> nl_dipole )<span class="op">&lt;</span><span class="fl">0.01</span>) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-16">Run 1</h4>
<div class="sourceCode" id="cb180"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb180-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb180-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb180-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb180-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb180-5" title="5"></a>
<a class="sourceLine" id="cb180-6" title="6"><span class="kw">def</span> dipole_moment(coordinates, charges):</a>
<a class="sourceLine" id="cb180-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb180-8" title="8"><span class="co">  This function returns the dipole moment of a molecule</span></a>
<a class="sourceLine" id="cb180-9" title="9"></a>
<a class="sourceLine" id="cb180-10" title="10"><span class="co">  Coordinates is a numpy array of size Nx3</span></a>
<a class="sourceLine" id="cb180-11" title="11"><span class="co">  Charges is a numpy array of size N</span></a>
<a class="sourceLine" id="cb180-12" title="12"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb180-13" title="13">  dipole_moment <span class="op">=</span> np.zeros(<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb180-14" title="14">  <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(charges)):</a>
<a class="sourceLine" id="cb180-15" title="15">    dipole_moment <span class="op">+=</span> coordinates[i] <span class="op">*</span> charges[i]</a>
<a class="sourceLine" id="cb180-16" title="16"></a>
<a class="sourceLine" id="cb180-17" title="17">  <span class="cf">return</span> dipole_moment</a>
<a class="sourceLine" id="cb180-18" title="18"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb180-19" title="19"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb180-20" title="20">coordinates <span class="op">=</span> np.loadtxt(os.path.join(_FILE_DIR_,<span class="st">&quot;water.xyz&quot;</span>),usecols<span class="op">=</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>))</a>
<a class="sourceLine" id="cb180-21" title="21"><span class="co">#note, these are fake</span></a>
<a class="sourceLine" id="cb180-22" title="22">charges <span class="op">=</span> np.loadtxt(os.path.join(_FILE_DIR_,<span class="st">&quot;charges.txt&quot;</span>))</a>
<a class="sourceLine" id="cb180-23" title="23">my_dipole <span class="op">=</span> (coordinates.T<span class="op">*</span>charges).<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb180-24" title="24">nl_dipole <span class="op">=</span> dipole_moment(coordinates,charges) </a>
<a class="sourceLine" id="cb180-25" title="25"></a>
<a class="sourceLine" id="cb180-26" title="26"><span class="co">#print(&quot;My result:&quot;,my_dipole)</span></a>
<a class="sourceLine" id="cb180-27" title="27"><span class="co">#print(&quot;NL result:&quot;,nl_dipole)</span></a>
<a class="sourceLine" id="cb180-28" title="28">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">all</span>(np.<span class="bu">abs</span>( my_dipole <span class="op">-</span> nl_dipole )<span class="op">&lt;</span><span class="fl">0.01</span>) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-16">Run 2</h4>
<div class="sourceCode" id="cb182"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb182-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb182-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb182-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb182-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb182-5" title="5"></a>
<a class="sourceLine" id="cb182-6" title="6"><span class="kw">def</span> dipole_moment(coordinates, charges):</a>
<a class="sourceLine" id="cb182-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb182-8" title="8"><span class="co">  This function returns the dipole moment of a molecule</span></a>
<a class="sourceLine" id="cb182-9" title="9"></a>
<a class="sourceLine" id="cb182-10" title="10"><span class="co">  Coordinates is a numpy array of size Nx3</span></a>
<a class="sourceLine" id="cb182-11" title="11"><span class="co">  Charges is a numpy array of size N</span></a>
<a class="sourceLine" id="cb182-12" title="12"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb182-13" title="13">  dipole_moment <span class="op">=</span> np.zeros([<span class="dv">1</span>,<span class="dv">3</span>])</a>
<a class="sourceLine" id="cb182-14" title="14">  <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(charges)):</a>
<a class="sourceLine" id="cb182-15" title="15">    dipole_moment <span class="op">+=</span> charges[i]<span class="op">*</span>coordinates[i]</a>
<a class="sourceLine" id="cb182-16" title="16"></a>
<a class="sourceLine" id="cb182-17" title="17">  <span class="cf">return</span> dipole_moment</a>
<a class="sourceLine" id="cb182-18" title="18"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb182-19" title="19"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb182-20" title="20">coordinates <span class="op">=</span> np.loadtxt(os.path.join(_FILE_DIR_,<span class="st">&quot;water.xyz&quot;</span>),usecols<span class="op">=</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>))</a>
<a class="sourceLine" id="cb182-21" title="21"><span class="co">#note, these are fake</span></a>
<a class="sourceLine" id="cb182-22" title="22">charges <span class="op">=</span> np.loadtxt(os.path.join(_FILE_DIR_,<span class="st">&quot;charges.txt&quot;</span>))</a>
<a class="sourceLine" id="cb182-23" title="23">my_dipole <span class="op">=</span> (coordinates.T<span class="op">*</span>charges).<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb182-24" title="24">nl_dipole <span class="op">=</span> dipole_moment(coordinates,charges) </a>
<a class="sourceLine" id="cb182-25" title="25"></a>
<a class="sourceLine" id="cb182-26" title="26"><span class="co">#print(&quot;My result:&quot;,my_dipole)</span></a>
<a class="sourceLine" id="cb182-27" title="27"><span class="co">#print(&quot;NL result:&quot;,nl_dipole)</span></a>
<a class="sourceLine" id="cb182-28" title="28">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">all</span>(np.<span class="bu">abs</span>( my_dipole <span class="op">-</span> nl_dipole )<span class="op">&lt;</span><span class="fl">0.01</span>) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-16">Run 3</h4>
<div class="sourceCode" id="cb184"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb184-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb184-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb184-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb184-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb184-5" title="5"></a>
<a class="sourceLine" id="cb184-6" title="6"><span class="kw">def</span> dipole_moment(coordinates, charges):</a>
<a class="sourceLine" id="cb184-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb184-8" title="8"><span class="co">  This function returns the dipole moment of a molecule</span></a>
<a class="sourceLine" id="cb184-9" title="9"></a>
<a class="sourceLine" id="cb184-10" title="10"><span class="co">  Coordinates is a numpy array of size Nx3</span></a>
<a class="sourceLine" id="cb184-11" title="11"><span class="co">  Charges is a numpy array of size N</span></a>
<a class="sourceLine" id="cb184-12" title="12"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb184-13" title="13">  dipole_moment <span class="op">=</span> np.zeros(<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb184-14" title="14">  <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(charges)):</a>
<a class="sourceLine" id="cb184-15" title="15">    dipole_moment <span class="op">+=</span> charges[i]<span class="op">*</span>coordinates[i]</a>
<a class="sourceLine" id="cb184-16" title="16">  <span class="cf">return</span> dipole_moment</a>
<a class="sourceLine" id="cb184-17" title="17"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb184-18" title="18"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb184-19" title="19">coordinates <span class="op">=</span> np.loadtxt(os.path.join(_FILE_DIR_,<span class="st">&quot;water.xyz&quot;</span>),usecols<span class="op">=</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>))</a>
<a class="sourceLine" id="cb184-20" title="20"><span class="co">#note, these are fake</span></a>
<a class="sourceLine" id="cb184-21" title="21">charges <span class="op">=</span> np.loadtxt(os.path.join(_FILE_DIR_,<span class="st">&quot;charges.txt&quot;</span>))</a>
<a class="sourceLine" id="cb184-22" title="22">my_dipole <span class="op">=</span> (coordinates.T<span class="op">*</span>charges).<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb184-23" title="23">nl_dipole <span class="op">=</span> dipole_moment(coordinates,charges) </a>
<a class="sourceLine" id="cb184-24" title="24"></a>
<a class="sourceLine" id="cb184-25" title="25"><span class="co">#print(&quot;My result:&quot;,my_dipole)</span></a>
<a class="sourceLine" id="cb184-26" title="26"><span class="co">#print(&quot;NL result:&quot;,nl_dipole)</span></a>
<a class="sourceLine" id="cb184-27" title="27">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">all</span>(np.<span class="bu">abs</span>( my_dipole <span class="op">-</span> nl_dipole )<span class="op">&lt;</span><span class="fl">0.01</span>) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-16">Run 4</h4>
<div class="sourceCode" id="cb186"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb186-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb186-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb186-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb186-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb186-5" title="5"></a>
<a class="sourceLine" id="cb186-6" title="6"><span class="kw">def</span> dipole_moment(coordinates, charges):</a>
<a class="sourceLine" id="cb186-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb186-8" title="8"><span class="co">  This function returns the dipole moment of a molecule</span></a>
<a class="sourceLine" id="cb186-9" title="9"></a>
<a class="sourceLine" id="cb186-10" title="10"><span class="co">  Coordinates is a numpy array of size Nx3</span></a>
<a class="sourceLine" id="cb186-11" title="11"><span class="co">  Charges is a numpy array of size N</span></a>
<a class="sourceLine" id="cb186-12" title="12"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb186-13" title="13">  dipole_moment <span class="op">=</span> np.<span class="bu">sum</span>(coordinates <span class="op">*</span> charges[:, np.newaxis], axis<span class="op">=</span><span class="dv">0</span>)</a>
<a class="sourceLine" id="cb186-14" title="14">  <span class="cf">return</span> dipole_moment</a>
<a class="sourceLine" id="cb186-15" title="15"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb186-16" title="16"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb186-17" title="17">coordinates <span class="op">=</span> np.loadtxt(os.path.join(_FILE_DIR_,<span class="st">&quot;water.xyz&quot;</span>),usecols<span class="op">=</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>))</a>
<a class="sourceLine" id="cb186-18" title="18"><span class="co">#note, these are fake</span></a>
<a class="sourceLine" id="cb186-19" title="19">charges <span class="op">=</span> np.loadtxt(os.path.join(_FILE_DIR_,<span class="st">&quot;charges.txt&quot;</span>))</a>
<a class="sourceLine" id="cb186-20" title="20">my_dipole <span class="op">=</span> (coordinates.T<span class="op">*</span>charges).<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb186-21" title="21">nl_dipole <span class="op">=</span> dipole_moment(coordinates,charges) </a>
<a class="sourceLine" id="cb186-22" title="22"></a>
<a class="sourceLine" id="cb186-23" title="23"><span class="co">#print(&quot;My result:&quot;,my_dipole)</span></a>
<a class="sourceLine" id="cb186-24" title="24"><span class="co">#print(&quot;NL result:&quot;,nl_dipole)</span></a>
<a class="sourceLine" id="cb186-25" title="25">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">all</span>(np.<span class="bu">abs</span>( my_dipole <span class="op">-</span> nl_dipole )<span class="op">&lt;</span><span class="fl">0.01</span>) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>dou</summary></p>
<h4 id="query-17">Query</h4>
<div class="sourceCode" id="cb188"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb188-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb188-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb188-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb188-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb188-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb188-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb188-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb188-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb188-9" title="9"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb188-10" title="10"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb188-11" title="11"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb188-12" title="12"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb188-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb188-14" title="14"></a>
<a class="sourceLine" id="cb188-15" title="15"><span class="kw">def</span> calc_rdbs(smiles):</a>
<a class="sourceLine" id="cb188-16" title="16">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb188-17" title="17"><span class="co">    Return degrees of unsaturation</span></a>
<a class="sourceLine" id="cb188-18" title="18"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb188-19" title="19">    [insert]</a>
<a class="sourceLine" id="cb188-20" title="20">    <span class="cf">return</span> d</a></code></pre></div>
<h4 id="run-0-17">Run 0</h4>
<div class="sourceCode" id="cb189"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb189-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb189-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb189-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb189-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb189-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb189-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb189-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb189-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb189-9" title="9"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb189-10" title="10"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb189-11" title="11"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb189-12" title="12"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb189-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb189-14" title="14"></a>
<a class="sourceLine" id="cb189-15" title="15"><span class="kw">def</span> calc_rdbs(smiles):</a>
<a class="sourceLine" id="cb189-16" title="16">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb189-17" title="17"><span class="co">    Return degrees of unsaturation</span></a>
<a class="sourceLine" id="cb189-18" title="18"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb189-19" title="19">    m <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb189-20" title="20">    d <span class="op">=</span> Descriptors.NumRadicalElectrons(m)</a>
<a class="sourceLine" id="cb189-21" title="21">    <span class="cf">return</span> d</a>
<a class="sourceLine" id="cb189-22" title="22">d <span class="op">=</span> calc_rdbs(<span class="st">&#39;c1ccccc1&#39;</span>)</a>
<a class="sourceLine" id="cb189-23" title="23"><span class="bu">print</span>(<span class="st">&#39;d = &#39;</span>, d)</a>
<a class="sourceLine" id="cb189-24" title="24">result <span class="op">=</span> d <span class="op">==</span> <span class="dv">4</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-17">Run 1</h4>
<div class="sourceCode" id="cb191"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb191-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb191-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb191-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb191-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb191-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb191-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb191-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb191-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb191-9" title="9"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb191-10" title="10"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb191-11" title="11"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb191-12" title="12"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb191-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb191-14" title="14"></a>
<a class="sourceLine" id="cb191-15" title="15"><span class="kw">def</span> calc_rdbs(smiles):</a>
<a class="sourceLine" id="cb191-16" title="16">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb191-17" title="17"><span class="co">    Return degrees of unsaturation</span></a>
<a class="sourceLine" id="cb191-18" title="18"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb191-19" title="19">    m <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb191-20" title="20">    d <span class="op">=</span> Descriptors.NumRotatableBonds(m)</a>
<a class="sourceLine" id="cb191-21" title="21">    <span class="cf">return</span> d</a>
<a class="sourceLine" id="cb191-22" title="22">d <span class="op">=</span> calc_rdbs(<span class="st">&#39;c1ccccc1&#39;</span>)</a>
<a class="sourceLine" id="cb191-23" title="23"><span class="bu">print</span>(<span class="st">&#39;d = &#39;</span>, d)</a>
<a class="sourceLine" id="cb191-24" title="24">result <span class="op">=</span> d <span class="op">==</span> <span class="dv">4</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-17">Run 2</h4>
<div class="sourceCode" id="cb193"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb193-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb193-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb193-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb193-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb193-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb193-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb193-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb193-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb193-9" title="9"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb193-10" title="10"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb193-11" title="11"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb193-12" title="12"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb193-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb193-14" title="14"></a>
<a class="sourceLine" id="cb193-15" title="15"><span class="kw">def</span> calc_rdbs(smiles):</a>
<a class="sourceLine" id="cb193-16" title="16">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb193-17" title="17"><span class="co">    Return degrees of unsaturation</span></a>
<a class="sourceLine" id="cb193-18" title="18"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb193-19" title="19">    m <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb193-20" title="20">    d <span class="op">=</span> Descriptors.NumRotatableBonds(m)</a>
<a class="sourceLine" id="cb193-21" title="21">    <span class="cf">return</span> d</a>
<a class="sourceLine" id="cb193-22" title="22">d <span class="op">=</span> calc_rdbs(<span class="st">&#39;c1ccccc1&#39;</span>)</a>
<a class="sourceLine" id="cb193-23" title="23"><span class="bu">print</span>(<span class="st">&#39;d = &#39;</span>, d)</a>
<a class="sourceLine" id="cb193-24" title="24">result <span class="op">=</span> d <span class="op">==</span> <span class="dv">4</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-17">Run 3</h4>
<div class="sourceCode" id="cb195"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb195-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb195-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb195-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb195-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb195-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb195-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb195-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb195-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb195-9" title="9"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb195-10" title="10"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb195-11" title="11"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb195-12" title="12"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb195-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb195-14" title="14"></a>
<a class="sourceLine" id="cb195-15" title="15"><span class="kw">def</span> calc_rdbs(smiles):</a>
<a class="sourceLine" id="cb195-16" title="16">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb195-17" title="17"><span class="co">    Return degrees of unsaturation</span></a>
<a class="sourceLine" id="cb195-18" title="18"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb195-19" title="19">    m <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb195-20" title="20">    d <span class="op">=</span> Descriptors.NumRotatableBonds(m)</a>
<a class="sourceLine" id="cb195-21" title="21">    <span class="cf">return</span> d</a>
<a class="sourceLine" id="cb195-22" title="22">d <span class="op">=</span> calc_rdbs(<span class="st">&#39;c1ccccc1&#39;</span>)</a>
<a class="sourceLine" id="cb195-23" title="23"><span class="bu">print</span>(<span class="st">&#39;d = &#39;</span>, d)</a>
<a class="sourceLine" id="cb195-24" title="24">result <span class="op">=</span> d <span class="op">==</span> <span class="dv">4</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-17">Run 4</h4>
<div class="sourceCode" id="cb197"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb197-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb197-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb197-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb197-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb197-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb197-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb197-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb197-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb197-9" title="9"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb197-10" title="10"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb197-11" title="11"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb197-12" title="12"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb197-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb197-14" title="14"></a>
<a class="sourceLine" id="cb197-15" title="15"><span class="kw">def</span> calc_rdbs(smiles):</a>
<a class="sourceLine" id="cb197-16" title="16">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb197-17" title="17"><span class="co">    Return degrees of unsaturation</span></a>
<a class="sourceLine" id="cb197-18" title="18"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb197-19" title="19">    m <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb197-20" title="20">    d <span class="op">=</span> Descriptors.NumRotatableBonds(m)</a>
<a class="sourceLine" id="cb197-21" title="21">    <span class="cf">return</span> d</a>
<a class="sourceLine" id="cb197-22" title="22">d <span class="op">=</span> calc_rdbs(<span class="st">&#39;c1ccccc1&#39;</span>)</a>
<a class="sourceLine" id="cb197-23" title="23"><span class="bu">print</span>(<span class="st">&#39;d = &#39;</span>, d)</a>
<a class="sourceLine" id="cb197-24" title="24">result <span class="op">=</span> d <span class="op">==</span> <span class="dv">4</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>eigen-ch</summary></p>
<h4 id="query-18">Query</h4>
<div class="sourceCode" id="cb199"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb199-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb199-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb199-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb199-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb199-5" title="5"></a>
<a class="sourceLine" id="cb199-6" title="6"><span class="kw">def</span> eigen(M):</a>
<a class="sourceLine" id="cb199-7" title="7">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb199-8" title="8"><span class="co">    该函数返回矩阵M的特征值和特征向量。</span></a>
<a class="sourceLine" id="cb199-9" title="9"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb199-10" title="10">    [insert]</a>
<a class="sourceLine" id="cb199-11" title="11">    <span class="cf">return</span> w,v</a></code></pre></div>
<h4 id="run-0-18">Run 0</h4>
<div class="sourceCode" id="cb200"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb200-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb200-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb200-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb200-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb200-5" title="5"></a>
<a class="sourceLine" id="cb200-6" title="6"><span class="kw">def</span> eigen(M):</a>
<a class="sourceLine" id="cb200-7" title="7">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb200-8" title="8"><span class="co">    该函数返回矩阵M的特征值和特征向量。</span></a>
<a class="sourceLine" id="cb200-9" title="9"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb200-10" title="10">    w,v <span class="op">=</span> np.linalg.eig(M)</a>
<a class="sourceLine" id="cb200-11" title="11">    <span class="cf">return</span> w,v</a>
<a class="sourceLine" id="cb200-12" title="12"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb200-13" title="13"></a>
<a class="sourceLine" id="cb200-14" title="14">np.random.seed(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb200-15" title="15">M <span class="op">=</span> np.random.random((<span class="dv">5</span>,<span class="dv">5</span>))</a>
<a class="sourceLine" id="cb200-16" title="16">w, v <span class="op">=</span> np.linalg.eig(M)</a>
<a class="sourceLine" id="cb200-17" title="17">w1, v1 <span class="op">=</span> eigen(M)</a>
<a class="sourceLine" id="cb200-18" title="18">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.allclose(w, w1) <span class="kw">and</span> np.allclose(v,v1) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-18">Run 1</h4>
<div class="sourceCode" id="cb202"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb202-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb202-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb202-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb202-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb202-5" title="5"></a>
<a class="sourceLine" id="cb202-6" title="6"><span class="kw">def</span> eigen(M):</a>
<a class="sourceLine" id="cb202-7" title="7">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb202-8" title="8"><span class="co">    该函数返回矩阵M的特征值和特征向量。</span></a>
<a class="sourceLine" id="cb202-9" title="9"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb202-10" title="10">    w,v <span class="op">=</span> np.linalg.eig(M)</a>
<a class="sourceLine" id="cb202-11" title="11">    <span class="cf">return</span> w,v</a>
<a class="sourceLine" id="cb202-12" title="12"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb202-13" title="13"></a>
<a class="sourceLine" id="cb202-14" title="14">np.random.seed(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb202-15" title="15">M <span class="op">=</span> np.random.random((<span class="dv">5</span>,<span class="dv">5</span>))</a>
<a class="sourceLine" id="cb202-16" title="16">w, v <span class="op">=</span> np.linalg.eig(M)</a>
<a class="sourceLine" id="cb202-17" title="17">w1, v1 <span class="op">=</span> eigen(M)</a>
<a class="sourceLine" id="cb202-18" title="18">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.allclose(w, w1) <span class="kw">and</span> np.allclose(v,v1) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-18">Run 2</h4>
<div class="sourceCode" id="cb204"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb204-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb204-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb204-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb204-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb204-5" title="5"></a>
<a class="sourceLine" id="cb204-6" title="6"><span class="kw">def</span> eigen(M):</a>
<a class="sourceLine" id="cb204-7" title="7">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb204-8" title="8"><span class="co">    该函数返回矩阵M的特征值和特征向量。</span></a>
<a class="sourceLine" id="cb204-9" title="9"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb204-10" title="10">    w,v <span class="op">=</span> np.linalg.eig(M)</a>
<a class="sourceLine" id="cb204-11" title="11">    <span class="cf">return</span> w,v</a>
<a class="sourceLine" id="cb204-12" title="12"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb204-13" title="13"></a>
<a class="sourceLine" id="cb204-14" title="14">np.random.seed(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb204-15" title="15">M <span class="op">=</span> np.random.random((<span class="dv">5</span>,<span class="dv">5</span>))</a>
<a class="sourceLine" id="cb204-16" title="16">w, v <span class="op">=</span> np.linalg.eig(M)</a>
<a class="sourceLine" id="cb204-17" title="17">w1, v1 <span class="op">=</span> eigen(M)</a>
<a class="sourceLine" id="cb204-18" title="18">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.allclose(w, w1) <span class="kw">and</span> np.allclose(v,v1) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-18">Run 3</h4>
<div class="sourceCode" id="cb206"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb206-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb206-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb206-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb206-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb206-5" title="5"></a>
<a class="sourceLine" id="cb206-6" title="6"><span class="kw">def</span> eigen(M):</a>
<a class="sourceLine" id="cb206-7" title="7">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb206-8" title="8"><span class="co">    该函数返回矩阵M的特征值和特征向量。</span></a>
<a class="sourceLine" id="cb206-9" title="9"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb206-10" title="10">    w,v <span class="op">=</span> np.linalg.eig(M)</a>
<a class="sourceLine" id="cb206-11" title="11">    <span class="cf">return</span> w,v</a>
<a class="sourceLine" id="cb206-12" title="12"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb206-13" title="13"></a>
<a class="sourceLine" id="cb206-14" title="14">np.random.seed(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb206-15" title="15">M <span class="op">=</span> np.random.random((<span class="dv">5</span>,<span class="dv">5</span>))</a>
<a class="sourceLine" id="cb206-16" title="16">w, v <span class="op">=</span> np.linalg.eig(M)</a>
<a class="sourceLine" id="cb206-17" title="17">w1, v1 <span class="op">=</span> eigen(M)</a>
<a class="sourceLine" id="cb206-18" title="18">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.allclose(w, w1) <span class="kw">and</span> np.allclose(v,v1) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-18">Run 4</h4>
<div class="sourceCode" id="cb208"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb208-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb208-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb208-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb208-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb208-5" title="5"></a>
<a class="sourceLine" id="cb208-6" title="6"><span class="kw">def</span> eigen(M):</a>
<a class="sourceLine" id="cb208-7" title="7">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb208-8" title="8"><span class="co">    该函数返回矩阵M的特征值和特征向量。</span></a>
<a class="sourceLine" id="cb208-9" title="9"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb208-10" title="10">    w,v <span class="op">=</span> np.linalg.eig(M)</a>
<a class="sourceLine" id="cb208-11" title="11">    <span class="cf">return</span> w,v</a>
<a class="sourceLine" id="cb208-12" title="12"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb208-13" title="13"></a>
<a class="sourceLine" id="cb208-14" title="14">np.random.seed(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb208-15" title="15">M <span class="op">=</span> np.random.random((<span class="dv">5</span>,<span class="dv">5</span>))</a>
<a class="sourceLine" id="cb208-16" title="16">w, v <span class="op">=</span> np.linalg.eig(M)</a>
<a class="sourceLine" id="cb208-17" title="17">w1, v1 <span class="op">=</span> eigen(M)</a>
<a class="sourceLine" id="cb208-18" title="18">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.allclose(w, w1) <span class="kw">and</span> np.allclose(v,v1) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>eigen</summary></p>
<h4 id="query-19">Query</h4>
<div class="sourceCode" id="cb210"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb210-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb210-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb210-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb210-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb210-5" title="5"></a>
<a class="sourceLine" id="cb210-6" title="6"><span class="kw">def</span> eigen(M):</a>
<a class="sourceLine" id="cb210-7" title="7">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb210-8" title="8"><span class="co">    Return eigenvalues and eigenvectors for a square matrix M</span></a>
<a class="sourceLine" id="cb210-9" title="9"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb210-10" title="10">    [insert]</a>
<a class="sourceLine" id="cb210-11" title="11">    <span class="cf">return</span> w,v</a></code></pre></div>
<h4 id="run-0-19">Run 0</h4>
<div class="sourceCode" id="cb211"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb211-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb211-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb211-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb211-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb211-5" title="5"></a>
<a class="sourceLine" id="cb211-6" title="6"><span class="kw">def</span> eigen(M):</a>
<a class="sourceLine" id="cb211-7" title="7">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb211-8" title="8"><span class="co">    Return eigenvalues and eigenvectors for a square matrix M</span></a>
<a class="sourceLine" id="cb211-9" title="9"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb211-10" title="10">    w,v <span class="op">=</span> np.linalg.eig(M)</a>
<a class="sourceLine" id="cb211-11" title="11">    <span class="cf">return</span> w,v</a>
<a class="sourceLine" id="cb211-12" title="12"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb211-13" title="13"></a>
<a class="sourceLine" id="cb211-14" title="14">np.random.seed(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb211-15" title="15">M <span class="op">=</span> np.random.random((<span class="dv">5</span>,<span class="dv">5</span>))</a>
<a class="sourceLine" id="cb211-16" title="16">w, v <span class="op">=</span> np.linalg.eig(M)</a>
<a class="sourceLine" id="cb211-17" title="17">w1, v1 <span class="op">=</span> eigen(M)</a>
<a class="sourceLine" id="cb211-18" title="18">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.allclose(w, w1) <span class="kw">and</span> np.allclose(v,v1) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-19">Run 1</h4>
<div class="sourceCode" id="cb213"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb213-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb213-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb213-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb213-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb213-5" title="5"></a>
<a class="sourceLine" id="cb213-6" title="6"><span class="kw">def</span> eigen(M):</a>
<a class="sourceLine" id="cb213-7" title="7">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb213-8" title="8"><span class="co">    Return eigenvalues and eigenvectors for a square matrix M</span></a>
<a class="sourceLine" id="cb213-9" title="9"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb213-10" title="10">    w,v <span class="op">=</span> np.linalg.eig(M)</a>
<a class="sourceLine" id="cb213-11" title="11">    <span class="cf">return</span> w,v</a>
<a class="sourceLine" id="cb213-12" title="12"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb213-13" title="13"></a>
<a class="sourceLine" id="cb213-14" title="14">np.random.seed(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb213-15" title="15">M <span class="op">=</span> np.random.random((<span class="dv">5</span>,<span class="dv">5</span>))</a>
<a class="sourceLine" id="cb213-16" title="16">w, v <span class="op">=</span> np.linalg.eig(M)</a>
<a class="sourceLine" id="cb213-17" title="17">w1, v1 <span class="op">=</span> eigen(M)</a>
<a class="sourceLine" id="cb213-18" title="18">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.allclose(w, w1) <span class="kw">and</span> np.allclose(v,v1) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-19">Run 2</h4>
<div class="sourceCode" id="cb215"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb215-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb215-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb215-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb215-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb215-5" title="5"></a>
<a class="sourceLine" id="cb215-6" title="6"><span class="kw">def</span> eigen(M):</a>
<a class="sourceLine" id="cb215-7" title="7">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb215-8" title="8"><span class="co">    Return eigenvalues and eigenvectors for a square matrix M</span></a>
<a class="sourceLine" id="cb215-9" title="9"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb215-10" title="10">    w,v <span class="op">=</span> np.linalg.eig(M)</a>
<a class="sourceLine" id="cb215-11" title="11">    <span class="cf">return</span> w,v</a>
<a class="sourceLine" id="cb215-12" title="12"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb215-13" title="13"></a>
<a class="sourceLine" id="cb215-14" title="14">np.random.seed(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb215-15" title="15">M <span class="op">=</span> np.random.random((<span class="dv">5</span>,<span class="dv">5</span>))</a>
<a class="sourceLine" id="cb215-16" title="16">w, v <span class="op">=</span> np.linalg.eig(M)</a>
<a class="sourceLine" id="cb215-17" title="17">w1, v1 <span class="op">=</span> eigen(M)</a>
<a class="sourceLine" id="cb215-18" title="18">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.allclose(w, w1) <span class="kw">and</span> np.allclose(v,v1) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-19">Run 3</h4>
<div class="sourceCode" id="cb217"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb217-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb217-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb217-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb217-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb217-5" title="5"></a>
<a class="sourceLine" id="cb217-6" title="6"><span class="kw">def</span> eigen(M):</a>
<a class="sourceLine" id="cb217-7" title="7">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb217-8" title="8"><span class="co">    Return eigenvalues and eigenvectors for a square matrix M</span></a>
<a class="sourceLine" id="cb217-9" title="9"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb217-10" title="10">    w,v <span class="op">=</span> np.linalg.eig(M)</a>
<a class="sourceLine" id="cb217-11" title="11">    w <span class="op">=</span> np.real(w)</a>
<a class="sourceLine" id="cb217-12" title="12">    v <span class="op">=</span> np.real(v)</a>
<a class="sourceLine" id="cb217-13" title="13">    <span class="cf">return</span> w,v</a>
<a class="sourceLine" id="cb217-14" title="14"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb217-15" title="15"></a>
<a class="sourceLine" id="cb217-16" title="16">np.random.seed(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb217-17" title="17">M <span class="op">=</span> np.random.random((<span class="dv">5</span>,<span class="dv">5</span>))</a>
<a class="sourceLine" id="cb217-18" title="18">w, v <span class="op">=</span> np.linalg.eig(M)</a>
<a class="sourceLine" id="cb217-19" title="19">w1, v1 <span class="op">=</span> eigen(M)</a>
<a class="sourceLine" id="cb217-20" title="20">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.allclose(w, w1) <span class="kw">and</span> np.allclose(v,v1) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-19">Run 4</h4>
<div class="sourceCode" id="cb219"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb219-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb219-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb219-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb219-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb219-5" title="5"></a>
<a class="sourceLine" id="cb219-6" title="6"><span class="kw">def</span> eigen(M):</a>
<a class="sourceLine" id="cb219-7" title="7">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb219-8" title="8"><span class="co">    Return eigenvalues and eigenvectors for a square matrix M</span></a>
<a class="sourceLine" id="cb219-9" title="9"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb219-10" title="10">    w,v <span class="op">=</span> np.linalg.eig(M)</a>
<a class="sourceLine" id="cb219-11" title="11">    <span class="cf">return</span> w,v</a>
<a class="sourceLine" id="cb219-12" title="12"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb219-13" title="13"></a>
<a class="sourceLine" id="cb219-14" title="14">np.random.seed(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb219-15" title="15">M <span class="op">=</span> np.random.random((<span class="dv">5</span>,<span class="dv">5</span>))</a>
<a class="sourceLine" id="cb219-16" title="16">w, v <span class="op">=</span> np.linalg.eig(M)</a>
<a class="sourceLine" id="cb219-17" title="17">w1, v1 <span class="op">=</span> eigen(M)</a>
<a class="sourceLine" id="cb219-18" title="18">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.allclose(w, w1) <span class="kw">and</span> np.allclose(v,v1) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>element_mass</summary></p>
<h4 id="query-20">Query</h4>
<div class="sourceCode" id="cb221"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb221-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb221-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb221-3" title="3"></a>
<a class="sourceLine" id="cb221-4" title="4"><span class="kw">def</span> element_mass(element_symbol):</a>
<a class="sourceLine" id="cb221-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb221-6" title="6"><span class="co">   This function returns the mass of the chemical element given by its symbol</span></a>
<a class="sourceLine" id="cb221-7" title="7"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb221-8" title="8">   <span class="im">import</span> mendeleev</a>
<a class="sourceLine" id="cb221-9" title="9">   [insert]</a>
<a class="sourceLine" id="cb221-10" title="10">   <span class="cf">return</span> mass</a></code></pre></div>
<h4 id="run-0-20">Run 0</h4>
<div class="sourceCode" id="cb222"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb222-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb222-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb222-3" title="3"></a>
<a class="sourceLine" id="cb222-4" title="4"><span class="kw">def</span> element_mass(element_symbol):</a>
<a class="sourceLine" id="cb222-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb222-6" title="6"><span class="co">   This function returns the mass of the chemical element given by its symbol</span></a>
<a class="sourceLine" id="cb222-7" title="7"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb222-8" title="8">   <span class="im">import</span> mendeleev</a>
<a class="sourceLine" id="cb222-9" title="9">   mass <span class="op">=</span> mendeleev.element(element_symbol).mass</a>
<a class="sourceLine" id="cb222-10" title="10">   <span class="cf">if</span> mass <span class="op">==</span> <span class="va">None</span>:</a>
<a class="sourceLine" id="cb222-11" title="11">      <span class="bu">print</span> <span class="st">&quot;Error: element mass not found for element&quot;</span>, element_symbol</a>
<a class="sourceLine" id="cb222-12" title="12">      sys.exit()</a>
<a class="sourceLine" id="cb222-13" title="13">   <span class="cf">return</span> mass</a>
<a class="sourceLine" id="cb222-14" title="14"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb222-15" title="15">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">abs</span>(element_mass(<span class="st">&quot;U&quot;</span>)<span class="op">-</span><span class="fl">238.03</span>)<span class="op">&lt;</span><span class="fl">0.01</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Missing parentheses in call to &#39;print&#39;. Did you mean print(&quot;Error: element mass not found for element&quot;, element_symbol)? (&lt;string&gt;, line 12)</code></pre>
<h4 id="run-1-20">Run 1</h4>
<div class="sourceCode" id="cb224"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb224-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb224-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb224-3" title="3"></a>
<a class="sourceLine" id="cb224-4" title="4"><span class="kw">def</span> element_mass(element_symbol):</a>
<a class="sourceLine" id="cb224-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb224-6" title="6"><span class="co">   This function returns the mass of the chemical element given by its symbol</span></a>
<a class="sourceLine" id="cb224-7" title="7"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb224-8" title="8">   <span class="im">import</span> mendeleev</a>
<a class="sourceLine" id="cb224-9" title="9">   mass <span class="op">=</span> mendeleev.element(element_symbol).mass</a>
<a class="sourceLine" id="cb224-10" title="10">   <span class="cf">if</span> mass <span class="op">==</span> <span class="va">None</span>:</a>
<a class="sourceLine" id="cb224-11" title="11">      <span class="bu">print</span> <span class="st">&quot;Error: element mass not found for &quot;</span> <span class="op">+</span> element_symbol</a>
<a class="sourceLine" id="cb224-12" title="12">      sys.exit(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb224-13" title="13">   <span class="cf">return</span> mass</a>
<a class="sourceLine" id="cb224-14" title="14"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb224-15" title="15">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">abs</span>(element_mass(<span class="st">&quot;U&quot;</span>)<span class="op">-</span><span class="fl">238.03</span>)<span class="op">&lt;</span><span class="fl">0.01</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Missing parentheses in call to &#39;print&#39;. Did you mean print(&quot;Error: element mass not found for &quot; + element_symbol)? (&lt;string&gt;, line 12)</code></pre>
<h4 id="run-2-20">Run 2</h4>
<div class="sourceCode" id="cb226"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb226-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb226-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb226-3" title="3"></a>
<a class="sourceLine" id="cb226-4" title="4"><span class="kw">def</span> element_mass(element_symbol):</a>
<a class="sourceLine" id="cb226-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb226-6" title="6"><span class="co">   This function returns the mass of the chemical element given by its symbol</span></a>
<a class="sourceLine" id="cb226-7" title="7"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb226-8" title="8">   <span class="im">import</span> mendeleev</a>
<a class="sourceLine" id="cb226-9" title="9">   mass <span class="op">=</span> mendeleev.element(element_symbol).mass</a>
<a class="sourceLine" id="cb226-10" title="10">   <span class="cf">if</span> mass <span class="op">==</span> <span class="va">None</span>:</a>
<a class="sourceLine" id="cb226-11" title="11">      <span class="bu">print</span> <span class="st">&quot;Error: element mass not found for element </span><span class="sc">%s</span><span class="st">&quot;</span> <span class="op">%</span> element_symbol</a>
<a class="sourceLine" id="cb226-12" title="12">      sys.exit(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb226-13" title="13">   <span class="cf">return</span> mass</a>
<a class="sourceLine" id="cb226-14" title="14"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb226-15" title="15">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">abs</span>(element_mass(<span class="st">&quot;U&quot;</span>)<span class="op">-</span><span class="fl">238.03</span>)<span class="op">&lt;</span><span class="fl">0.01</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Missing parentheses in call to &#39;print&#39;. Did you mean print(&quot;Error: element mass not found for element %s&quot; % element_symbol)? (&lt;string&gt;, line 12)</code></pre>
<h4 id="run-3-20">Run 3</h4>
<div class="sourceCode" id="cb228"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb228-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb228-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb228-3" title="3"></a>
<a class="sourceLine" id="cb228-4" title="4"><span class="kw">def</span> element_mass(element_symbol):</a>
<a class="sourceLine" id="cb228-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb228-6" title="6"><span class="co">   This function returns the mass of the chemical element given by its symbol</span></a>
<a class="sourceLine" id="cb228-7" title="7"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb228-8" title="8">   <span class="im">import</span> mendeleev</a>
<a class="sourceLine" id="cb228-9" title="9">   mass <span class="op">=</span> mendeleev.element(element_symbol).mass</a>
<a class="sourceLine" id="cb228-10" title="10">   <span class="cf">if</span> mass <span class="op">==</span> <span class="va">None</span>:</a>
<a class="sourceLine" id="cb228-11" title="11">      <span class="bu">print</span>(<span class="st">&quot;Error: element symbol not found&quot;</span>)</a>
<a class="sourceLine" id="cb228-12" title="12">      sys.exit(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb228-13" title="13">   <span class="cf">return</span> mass</a>
<a class="sourceLine" id="cb228-14" title="14"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb228-15" title="15">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">abs</span>(element_mass(<span class="st">&quot;U&quot;</span>)<span class="op">-</span><span class="fl">238.03</span>)<span class="op">&lt;</span><span class="fl">0.01</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-20">Run 4</h4>
<div class="sourceCode" id="cb230"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb230-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb230-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb230-3" title="3"></a>
<a class="sourceLine" id="cb230-4" title="4"><span class="kw">def</span> element_mass(element_symbol):</a>
<a class="sourceLine" id="cb230-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb230-6" title="6"><span class="co">   This function returns the mass of the chemical element given by its symbol</span></a>
<a class="sourceLine" id="cb230-7" title="7"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb230-8" title="8">   <span class="im">import</span> mendeleev</a>
<a class="sourceLine" id="cb230-9" title="9">   mass <span class="op">=</span> mendeleev.element(element_symbol).mass</a>
<a class="sourceLine" id="cb230-10" title="10"></a>
<a class="sourceLine" id="cb230-11" title="11">   <span class="cf">return</span> mass</a>
<a class="sourceLine" id="cb230-12" title="12"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb230-13" title="13">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">abs</span>(element_mass(<span class="st">&quot;U&quot;</span>)<span class="op">-</span><span class="fl">238.03</span>)<span class="op">&lt;</span><span class="fl">0.01</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>element_name</summary></p>
<h4 id="query-21">Query</h4>
<div class="sourceCode" id="cb232"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb232-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb232-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb232-3" title="3"></a>
<a class="sourceLine" id="cb232-4" title="4"><span class="kw">def</span> symbol(element_number):</a>
<a class="sourceLine" id="cb232-5" title="5">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb232-6" title="6"><span class="co">  This function returns the two letter symbol for the chemical element given by element_number</span></a>
<a class="sourceLine" id="cb232-7" title="7"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb232-8" title="8">  <span class="im">import</span> mendeleev</a>
<a class="sourceLine" id="cb232-9" title="9">  [insert]</a>
<a class="sourceLine" id="cb232-10" title="10">  <span class="cf">return</span> s</a></code></pre></div>
<h4 id="run-0-21">Run 0</h4>
<div class="sourceCode" id="cb233"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb233-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb233-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb233-3" title="3"></a>
<a class="sourceLine" id="cb233-4" title="4"><span class="kw">def</span> symbol(element_number):</a>
<a class="sourceLine" id="cb233-5" title="5">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb233-6" title="6"><span class="co">  This function returns the two letter symbol for the chemical element given by element_number</span></a>
<a class="sourceLine" id="cb233-7" title="7"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb233-8" title="8">  <span class="im">import</span> mendeleev</a>
<a class="sourceLine" id="cb233-9" title="9">  s <span class="op">=</span> mendeleev.element(element_number).symbol</a>
<a class="sourceLine" id="cb233-10" title="10">  <span class="cf">return</span> s</a>
<a class="sourceLine" id="cb233-11" title="11">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> symbol(<span class="dv">26</span>).lower()<span class="op">==</span><span class="st">&quot;fe&quot;</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-21">Run 1</h4>
<div class="sourceCode" id="cb235"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb235-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb235-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb235-3" title="3"></a>
<a class="sourceLine" id="cb235-4" title="4"><span class="kw">def</span> symbol(element_number):</a>
<a class="sourceLine" id="cb235-5" title="5">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb235-6" title="6"><span class="co">  This function returns the two letter symbol for the chemical element given by element_number</span></a>
<a class="sourceLine" id="cb235-7" title="7"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb235-8" title="8">  <span class="im">import</span> mendeleev</a>
<a class="sourceLine" id="cb235-9" title="9">  s <span class="op">=</span> mendeleev.element(element_number).symbol</a>
<a class="sourceLine" id="cb235-10" title="10">  <span class="cf">return</span> s</a>
<a class="sourceLine" id="cb235-11" title="11">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> symbol(<span class="dv">26</span>).lower()<span class="op">==</span><span class="st">&quot;fe&quot;</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-21">Run 2</h4>
<div class="sourceCode" id="cb237"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb237-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb237-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb237-3" title="3"></a>
<a class="sourceLine" id="cb237-4" title="4"><span class="kw">def</span> symbol(element_number):</a>
<a class="sourceLine" id="cb237-5" title="5">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb237-6" title="6"><span class="co">  This function returns the two letter symbol for the chemical element given by element_number</span></a>
<a class="sourceLine" id="cb237-7" title="7"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb237-8" title="8">  <span class="im">import</span> mendeleev</a>
<a class="sourceLine" id="cb237-9" title="9">  s <span class="op">=</span> mendeleev.element(element_number).symbol</a>
<a class="sourceLine" id="cb237-10" title="10">  <span class="cf">return</span> s</a>
<a class="sourceLine" id="cb237-11" title="11">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> symbol(<span class="dv">26</span>).lower()<span class="op">==</span><span class="st">&quot;fe&quot;</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-21">Run 3</h4>
<div class="sourceCode" id="cb239"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb239-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb239-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb239-3" title="3"></a>
<a class="sourceLine" id="cb239-4" title="4"><span class="kw">def</span> symbol(element_number):</a>
<a class="sourceLine" id="cb239-5" title="5">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb239-6" title="6"><span class="co">  This function returns the two letter symbol for the chemical element given by element_number</span></a>
<a class="sourceLine" id="cb239-7" title="7"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb239-8" title="8">  <span class="im">import</span> mendeleev</a>
<a class="sourceLine" id="cb239-9" title="9">  s <span class="op">=</span> mendeleev.element(element_number).symbol</a>
<a class="sourceLine" id="cb239-10" title="10">  <span class="cf">return</span> s</a>
<a class="sourceLine" id="cb239-11" title="11">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> symbol(<span class="dv">26</span>).lower()<span class="op">==</span><span class="st">&quot;fe&quot;</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-21">Run 4</h4>
<div class="sourceCode" id="cb241"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb241-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb241-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb241-3" title="3"></a>
<a class="sourceLine" id="cb241-4" title="4"><span class="kw">def</span> symbol(element_number):</a>
<a class="sourceLine" id="cb241-5" title="5">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb241-6" title="6"><span class="co">  This function returns the two letter symbol for the chemical element given by element_number</span></a>
<a class="sourceLine" id="cb241-7" title="7"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb241-8" title="8">  <span class="im">import</span> mendeleev</a>
<a class="sourceLine" id="cb241-9" title="9">  s <span class="op">=</span> mendeleev.element(element_number).symbol</a>
<a class="sourceLine" id="cb241-10" title="10">  <span class="cf">return</span> s</a>
<a class="sourceLine" id="cb241-11" title="11">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> symbol(<span class="dv">26</span>).lower()<span class="op">==</span><span class="st">&quot;fe&quot;</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>energy_of_e</summary></p>
<h4 id="query-22">Query</h4>
<div class="sourceCode" id="cb243"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb243-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb243-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb243-3" title="3"></a>
<a class="sourceLine" id="cb243-4" title="4"><span class="kw">def</span> energy_of_e(n):</a>
<a class="sourceLine" id="cb243-5" title="5">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb243-6" title="6"><span class="co">    This function calculates the energy in electron Volts of an electron in state n in a hydrogen atom</span></a>
<a class="sourceLine" id="cb243-7" title="7"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb243-8" title="8">    [insert]</a>
<a class="sourceLine" id="cb243-9" title="9">    <span class="cf">return</span> energy</a></code></pre></div>
<h4 id="run-0-22">Run 0</h4>
<div class="sourceCode" id="cb244"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb244-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb244-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb244-3" title="3"></a>
<a class="sourceLine" id="cb244-4" title="4"><span class="kw">def</span> energy_of_e(n):</a>
<a class="sourceLine" id="cb244-5" title="5">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb244-6" title="6"><span class="co">    This function calculates the energy in electron Volts of an electron in state n in a hydrogen atom</span></a>
<a class="sourceLine" id="cb244-7" title="7"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb244-8" title="8">    energy <span class="op">=</span> <span class="fl">-13.6</span><span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>n<span class="op">**</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb244-9" title="9">    <span class="cf">return</span> energy</a>
<a class="sourceLine" id="cb244-10" title="10"></a>
<a class="sourceLine" id="cb244-11" title="11"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb244-12" title="12">Rh <span class="op">=</span> <span class="fl">13.60648962</span></a>
<a class="sourceLine" id="cb244-13" title="13">n <span class="op">=</span> <span class="dv">3</span></a>
<a class="sourceLine" id="cb244-14" title="14">energy_true <span class="op">=</span> (<span class="op">-</span>Rh<span class="op">/</span>(n<span class="op">**</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb244-15" title="15">energy_nlcc <span class="op">=</span> energy_of_e(n)</a>
<a class="sourceLine" id="cb244-16" title="16"></a>
<a class="sourceLine" id="cb244-17" title="17">result <span class="op">=</span> math.isclose(energy_true, energy_nlcc, rel_tol <span class="op">=</span><span class="fl">1e-3</span>)</a>
<a class="sourceLine" id="cb244-18" title="18"></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-22">Run 1</h4>
<div class="sourceCode" id="cb246"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb246-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb246-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb246-3" title="3"></a>
<a class="sourceLine" id="cb246-4" title="4"><span class="kw">def</span> energy_of_e(n):</a>
<a class="sourceLine" id="cb246-5" title="5">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb246-6" title="6"><span class="co">    This function calculates the energy in electron Volts of an electron in state n in a hydrogen atom</span></a>
<a class="sourceLine" id="cb246-7" title="7"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb246-8" title="8">    energy <span class="op">=</span> <span class="fl">-13.6</span><span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>n<span class="op">**</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb246-9" title="9">    <span class="cf">return</span> energy</a>
<a class="sourceLine" id="cb246-10" title="10"></a>
<a class="sourceLine" id="cb246-11" title="11"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb246-12" title="12">Rh <span class="op">=</span> <span class="fl">13.60648962</span></a>
<a class="sourceLine" id="cb246-13" title="13">n <span class="op">=</span> <span class="dv">3</span></a>
<a class="sourceLine" id="cb246-14" title="14">energy_true <span class="op">=</span> (<span class="op">-</span>Rh<span class="op">/</span>(n<span class="op">**</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb246-15" title="15">energy_nlcc <span class="op">=</span> energy_of_e(n)</a>
<a class="sourceLine" id="cb246-16" title="16"></a>
<a class="sourceLine" id="cb246-17" title="17">result <span class="op">=</span> math.isclose(energy_true, energy_nlcc, rel_tol <span class="op">=</span><span class="fl">1e-3</span>)</a>
<a class="sourceLine" id="cb246-18" title="18"></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-22">Run 2</h4>
<div class="sourceCode" id="cb248"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb248-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb248-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb248-3" title="3"></a>
<a class="sourceLine" id="cb248-4" title="4"><span class="kw">def</span> energy_of_e(n):</a>
<a class="sourceLine" id="cb248-5" title="5">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb248-6" title="6"><span class="co">    This function calculates the energy in electron Volts of an electron in state n in a hydrogen atom</span></a>
<a class="sourceLine" id="cb248-7" title="7"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb248-8" title="8">    energy <span class="op">=</span> <span class="fl">-13.6</span><span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>n<span class="op">**</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb248-9" title="9">    <span class="cf">return</span> energy</a>
<a class="sourceLine" id="cb248-10" title="10"></a>
<a class="sourceLine" id="cb248-11" title="11"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb248-12" title="12">Rh <span class="op">=</span> <span class="fl">13.60648962</span></a>
<a class="sourceLine" id="cb248-13" title="13">n <span class="op">=</span> <span class="dv">3</span></a>
<a class="sourceLine" id="cb248-14" title="14">energy_true <span class="op">=</span> (<span class="op">-</span>Rh<span class="op">/</span>(n<span class="op">**</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb248-15" title="15">energy_nlcc <span class="op">=</span> energy_of_e(n)</a>
<a class="sourceLine" id="cb248-16" title="16"></a>
<a class="sourceLine" id="cb248-17" title="17">result <span class="op">=</span> math.isclose(energy_true, energy_nlcc, rel_tol <span class="op">=</span><span class="fl">1e-3</span>)</a>
<a class="sourceLine" id="cb248-18" title="18"></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-22">Run 3</h4>
<div class="sourceCode" id="cb250"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb250-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb250-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb250-3" title="3"></a>
<a class="sourceLine" id="cb250-4" title="4"><span class="kw">def</span> energy_of_e(n):</a>
<a class="sourceLine" id="cb250-5" title="5">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb250-6" title="6"><span class="co">    This function calculates the energy in electron Volts of an electron in state n in a hydrogen atom</span></a>
<a class="sourceLine" id="cb250-7" title="7"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb250-8" title="8">    energy <span class="op">=</span> <span class="fl">-13.6</span><span class="op">/</span>n<span class="op">**</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb250-9" title="9">    <span class="cf">return</span> energy</a>
<a class="sourceLine" id="cb250-10" title="10"></a>
<a class="sourceLine" id="cb250-11" title="11"></a>
<a class="sourceLine" id="cb250-12" title="12">    <span class="cf">return</span> energy</a>
<a class="sourceLine" id="cb250-13" title="13"></a>
<a class="sourceLine" id="cb250-14" title="14"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb250-15" title="15">Rh <span class="op">=</span> <span class="fl">13.60648962</span></a>
<a class="sourceLine" id="cb250-16" title="16">n <span class="op">=</span> <span class="dv">3</span></a>
<a class="sourceLine" id="cb250-17" title="17">energy_true <span class="op">=</span> (<span class="op">-</span>Rh<span class="op">/</span>(n<span class="op">**</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb250-18" title="18">energy_nlcc <span class="op">=</span> energy_of_e(n)</a>
<a class="sourceLine" id="cb250-19" title="19"></a>
<a class="sourceLine" id="cb250-20" title="20">result <span class="op">=</span> math.isclose(energy_true, energy_nlcc, rel_tol <span class="op">=</span><span class="fl">1e-3</span>)</a>
<a class="sourceLine" id="cb250-21" title="21"></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-22">Run 4</h4>
<div class="sourceCode" id="cb252"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb252-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb252-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb252-3" title="3"></a>
<a class="sourceLine" id="cb252-4" title="4"><span class="kw">def</span> energy_of_e(n):</a>
<a class="sourceLine" id="cb252-5" title="5">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb252-6" title="6"><span class="co">    This function calculates the energy in electron Volts of an electron in state n in a hydrogen atom</span></a>
<a class="sourceLine" id="cb252-7" title="7"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb252-8" title="8">    energy <span class="op">=</span> <span class="fl">-13.6</span><span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>n<span class="op">**</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb252-9" title="9">    <span class="cf">return</span> energy</a>
<a class="sourceLine" id="cb252-10" title="10"></a>
<a class="sourceLine" id="cb252-11" title="11"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb252-12" title="12">Rh <span class="op">=</span> <span class="fl">13.60648962</span></a>
<a class="sourceLine" id="cb252-13" title="13">n <span class="op">=</span> <span class="dv">3</span></a>
<a class="sourceLine" id="cb252-14" title="14">energy_true <span class="op">=</span> (<span class="op">-</span>Rh<span class="op">/</span>(n<span class="op">**</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb252-15" title="15">energy_nlcc <span class="op">=</span> energy_of_e(n)</a>
<a class="sourceLine" id="cb252-16" title="16"></a>
<a class="sourceLine" id="cb252-17" title="17">result <span class="op">=</span> math.isclose(energy_true, energy_nlcc, rel_tol <span class="op">=</span><span class="fl">1e-3</span>)</a>
<a class="sourceLine" id="cb252-18" title="18"></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>find_indices</summary></p>
<h4 id="query-23">Query</h4>
<div class="sourceCode" id="cb254"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb254-1" title="1"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb254-2" title="2"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb254-3" title="3"></a>
<a class="sourceLine" id="cb254-4" title="4"><span class="kw">def</span> get_ca_indices(pdb_file):</a>
<a class="sourceLine" id="cb254-5" title="5">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb254-6" title="6"><span class="co">  This function uploads a pdb file and find out the indices of first two alpha carbon atoms.</span></a>
<a class="sourceLine" id="cb254-7" title="7"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb254-8" title="8">  [insert]</a>
<a class="sourceLine" id="cb254-9" title="9">  <span class="cf">return</span> idx</a></code></pre></div>
<h4 id="run-0-23">Run 0</h4>
<div class="sourceCode" id="cb255"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb255-1" title="1"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb255-2" title="2"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb255-3" title="3"></a>
<a class="sourceLine" id="cb255-4" title="4"><span class="kw">def</span> get_ca_indices(pdb_file):</a>
<a class="sourceLine" id="cb255-5" title="5">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb255-6" title="6"><span class="co">  This function uploads a pdb file and find out the indices of first two alpha carbon atoms.</span></a>
<a class="sourceLine" id="cb255-7" title="7"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb255-8" title="8">  traj <span class="op">=</span> md.load(pdb_file)</a>
<a class="sourceLine" id="cb255-9" title="9">  topology <span class="op">=</span> traj.topology</a>
<a class="sourceLine" id="cb255-10" title="10">  idx <span class="op">=</span> topology.select(<span class="st">&#39;name CA&#39;</span>)[:<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb255-11" title="11">  <span class="cf">return</span> idx</a>
<a class="sourceLine" id="cb255-12" title="12"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb255-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb255-14" title="14"></a>
<a class="sourceLine" id="cb255-15" title="15">pdb_file <span class="op">=</span> os.path.join(_FILE_DIR_,<span class="st">&quot;1l2y.pdb&quot;</span>)</a>
<a class="sourceLine" id="cb255-16" title="16"></a>
<a class="sourceLine" id="cb255-17" title="17"><span class="kw">def</span> get_pair_indices(pdb_file):</a>
<a class="sourceLine" id="cb255-18" title="18">    <span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb255-19" title="19">    pdb <span class="op">=</span> md.load(pdb_file)</a>
<a class="sourceLine" id="cb255-20" title="20">    top <span class="op">=</span> pdb.topology</a>
<a class="sourceLine" id="cb255-21" title="21">    CAs <span class="op">=</span> [atom.index <span class="cf">for</span> atom <span class="kw">in</span> top.atoms <span class="cf">if</span> atom.name <span class="op">==</span> <span class="st">&#39;CA&#39;</span>]</a>
<a class="sourceLine" id="cb255-22" title="22">    indices_pair <span class="op">=</span> np.array([CAs[<span class="dv">0</span>], CAs[<span class="dv">1</span>]])</a>
<a class="sourceLine" id="cb255-23" title="23">    <span class="cf">return</span> indices_pair</a>
<a class="sourceLine" id="cb255-24" title="24"></a>
<a class="sourceLine" id="cb255-25" title="25">my_indices_pair <span class="op">=</span> get_pair_indices(pdb_file)</a>
<a class="sourceLine" id="cb255-26" title="26">prompt_indices_pair <span class="op">=</span> get_ca_indices(pdb_file)</a>
<a class="sourceLine" id="cb255-27" title="27"></a>
<a class="sourceLine" id="cb255-28" title="28">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">all</span>(my_indices_pair <span class="op">==</span> prompt_indices_pair) <span class="cf">else</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb255-29" title="29"></a>
<a class="sourceLine" id="cb255-30" title="30"></a></code></pre></div>
<p>Output:</p>
<pre><code>&#39;Constant&#39; object has no attribute &#39;kind&#39;</code></pre>
<h4 id="run-1-23">Run 1</h4>
<div class="sourceCode" id="cb257"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb257-1" title="1"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb257-2" title="2"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb257-3" title="3"></a>
<a class="sourceLine" id="cb257-4" title="4"><span class="kw">def</span> get_ca_indices(pdb_file):</a>
<a class="sourceLine" id="cb257-5" title="5">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb257-6" title="6"><span class="co">  This function uploads a pdb file and find out the indices of first two alpha carbon atoms.</span></a>
<a class="sourceLine" id="cb257-7" title="7"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb257-8" title="8">  traj <span class="op">=</span> md.load(pdb_file)</a>
<a class="sourceLine" id="cb257-9" title="9">  topology <span class="op">=</span> traj.topology</a>
<a class="sourceLine" id="cb257-10" title="10">  idx <span class="op">=</span> topology.select(<span class="st">&quot;name CA&quot;</span>)[:<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb257-11" title="11">  <span class="cf">return</span> idx</a>
<a class="sourceLine" id="cb257-12" title="12"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb257-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb257-14" title="14"></a>
<a class="sourceLine" id="cb257-15" title="15">pdb_file <span class="op">=</span> os.path.join(_FILE_DIR_,<span class="st">&quot;1l2y.pdb&quot;</span>)</a>
<a class="sourceLine" id="cb257-16" title="16"></a>
<a class="sourceLine" id="cb257-17" title="17"><span class="kw">def</span> get_pair_indices(pdb_file):</a>
<a class="sourceLine" id="cb257-18" title="18">    <span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb257-19" title="19">    pdb <span class="op">=</span> md.load(pdb_file)</a>
<a class="sourceLine" id="cb257-20" title="20">    top <span class="op">=</span> pdb.topology</a>
<a class="sourceLine" id="cb257-21" title="21">    CAs <span class="op">=</span> [atom.index <span class="cf">for</span> atom <span class="kw">in</span> top.atoms <span class="cf">if</span> atom.name <span class="op">==</span> <span class="st">&#39;CA&#39;</span>]</a>
<a class="sourceLine" id="cb257-22" title="22">    indices_pair <span class="op">=</span> np.array([CAs[<span class="dv">0</span>], CAs[<span class="dv">1</span>]])</a>
<a class="sourceLine" id="cb257-23" title="23">    <span class="cf">return</span> indices_pair</a>
<a class="sourceLine" id="cb257-24" title="24"></a>
<a class="sourceLine" id="cb257-25" title="25">my_indices_pair <span class="op">=</span> get_pair_indices(pdb_file)</a>
<a class="sourceLine" id="cb257-26" title="26">prompt_indices_pair <span class="op">=</span> get_ca_indices(pdb_file)</a>
<a class="sourceLine" id="cb257-27" title="27"></a>
<a class="sourceLine" id="cb257-28" title="28">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">all</span>(my_indices_pair <span class="op">==</span> prompt_indices_pair) <span class="cf">else</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb257-29" title="29"></a>
<a class="sourceLine" id="cb257-30" title="30"></a></code></pre></div>
<p>Output:</p>
<pre><code>&#39;Constant&#39; object has no attribute &#39;kind&#39;</code></pre>
<h4 id="run-2-23">Run 2</h4>
<div class="sourceCode" id="cb259"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb259-1" title="1"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb259-2" title="2"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb259-3" title="3"></a>
<a class="sourceLine" id="cb259-4" title="4"><span class="kw">def</span> get_ca_indices(pdb_file):</a>
<a class="sourceLine" id="cb259-5" title="5">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb259-6" title="6"><span class="co">  This function uploads a pdb file and find out the indices of first two alpha carbon atoms.</span></a>
<a class="sourceLine" id="cb259-7" title="7"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb259-8" title="8">  traj <span class="op">=</span> md.load(pdb_file)</a>
<a class="sourceLine" id="cb259-9" title="9">  topology <span class="op">=</span> traj.topology</a>
<a class="sourceLine" id="cb259-10" title="10">  idx <span class="op">=</span> topology.select(<span class="st">&#39;name CA&#39;</span>)</a>
<a class="sourceLine" id="cb259-11" title="11">  idx <span class="op">=</span> idx[<span class="dv">0</span>:<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb259-12" title="12">  <span class="cf">return</span> idx</a>
<a class="sourceLine" id="cb259-13" title="13"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb259-14" title="14"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb259-15" title="15"></a>
<a class="sourceLine" id="cb259-16" title="16">pdb_file <span class="op">=</span> os.path.join(_FILE_DIR_,<span class="st">&quot;1l2y.pdb&quot;</span>)</a>
<a class="sourceLine" id="cb259-17" title="17"></a>
<a class="sourceLine" id="cb259-18" title="18"><span class="kw">def</span> get_pair_indices(pdb_file):</a>
<a class="sourceLine" id="cb259-19" title="19">    <span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb259-20" title="20">    pdb <span class="op">=</span> md.load(pdb_file)</a>
<a class="sourceLine" id="cb259-21" title="21">    top <span class="op">=</span> pdb.topology</a>
<a class="sourceLine" id="cb259-22" title="22">    CAs <span class="op">=</span> [atom.index <span class="cf">for</span> atom <span class="kw">in</span> top.atoms <span class="cf">if</span> atom.name <span class="op">==</span> <span class="st">&#39;CA&#39;</span>]</a>
<a class="sourceLine" id="cb259-23" title="23">    indices_pair <span class="op">=</span> np.array([CAs[<span class="dv">0</span>], CAs[<span class="dv">1</span>]])</a>
<a class="sourceLine" id="cb259-24" title="24">    <span class="cf">return</span> indices_pair</a>
<a class="sourceLine" id="cb259-25" title="25"></a>
<a class="sourceLine" id="cb259-26" title="26">my_indices_pair <span class="op">=</span> get_pair_indices(pdb_file)</a>
<a class="sourceLine" id="cb259-27" title="27">prompt_indices_pair <span class="op">=</span> get_ca_indices(pdb_file)</a>
<a class="sourceLine" id="cb259-28" title="28"></a>
<a class="sourceLine" id="cb259-29" title="29">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">all</span>(my_indices_pair <span class="op">==</span> prompt_indices_pair) <span class="cf">else</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb259-30" title="30"></a>
<a class="sourceLine" id="cb259-31" title="31"></a></code></pre></div>
<p>Output:</p>
<pre><code>&#39;Constant&#39; object has no attribute &#39;kind&#39;</code></pre>
<h4 id="run-3-23">Run 3</h4>
<div class="sourceCode" id="cb261"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb261-1" title="1"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb261-2" title="2"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb261-3" title="3"></a>
<a class="sourceLine" id="cb261-4" title="4"><span class="kw">def</span> get_ca_indices(pdb_file):</a>
<a class="sourceLine" id="cb261-5" title="5">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb261-6" title="6"><span class="co">  This function uploads a pdb file and find out the indices of first two alpha carbon atoms.</span></a>
<a class="sourceLine" id="cb261-7" title="7"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb261-8" title="8">  traj <span class="op">=</span> md.load(pdb_file)</a>
<a class="sourceLine" id="cb261-9" title="9">  idx <span class="op">=</span> np.where(traj.top.select(<span class="st">&#39;name CA&#39;</span>))[<span class="dv">0</span>][:<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb261-10" title="10">  <span class="cf">return</span> idx</a>
<a class="sourceLine" id="cb261-11" title="11"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb261-12" title="12"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb261-13" title="13"></a>
<a class="sourceLine" id="cb261-14" title="14">pdb_file <span class="op">=</span> os.path.join(_FILE_DIR_,<span class="st">&quot;1l2y.pdb&quot;</span>)</a>
<a class="sourceLine" id="cb261-15" title="15"></a>
<a class="sourceLine" id="cb261-16" title="16"><span class="kw">def</span> get_pair_indices(pdb_file):</a>
<a class="sourceLine" id="cb261-17" title="17">    <span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb261-18" title="18">    pdb <span class="op">=</span> md.load(pdb_file)</a>
<a class="sourceLine" id="cb261-19" title="19">    top <span class="op">=</span> pdb.topology</a>
<a class="sourceLine" id="cb261-20" title="20">    CAs <span class="op">=</span> [atom.index <span class="cf">for</span> atom <span class="kw">in</span> top.atoms <span class="cf">if</span> atom.name <span class="op">==</span> <span class="st">&#39;CA&#39;</span>]</a>
<a class="sourceLine" id="cb261-21" title="21">    indices_pair <span class="op">=</span> np.array([CAs[<span class="dv">0</span>], CAs[<span class="dv">1</span>]])</a>
<a class="sourceLine" id="cb261-22" title="22">    <span class="cf">return</span> indices_pair</a>
<a class="sourceLine" id="cb261-23" title="23"></a>
<a class="sourceLine" id="cb261-24" title="24">my_indices_pair <span class="op">=</span> get_pair_indices(pdb_file)</a>
<a class="sourceLine" id="cb261-25" title="25">prompt_indices_pair <span class="op">=</span> get_ca_indices(pdb_file)</a>
<a class="sourceLine" id="cb261-26" title="26"></a>
<a class="sourceLine" id="cb261-27" title="27">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">all</span>(my_indices_pair <span class="op">==</span> prompt_indices_pair) <span class="cf">else</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb261-28" title="28"></a>
<a class="sourceLine" id="cb261-29" title="29"></a></code></pre></div>
<p>Output:</p>
<pre><code>&#39;Constant&#39; object has no attribute &#39;kind&#39;</code></pre>
<h4 id="run-4-23">Run 4</h4>
<div class="sourceCode" id="cb263"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb263-1" title="1"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb263-2" title="2"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb263-3" title="3"></a>
<a class="sourceLine" id="cb263-4" title="4"><span class="kw">def</span> get_ca_indices(pdb_file):</a>
<a class="sourceLine" id="cb263-5" title="5">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb263-6" title="6"><span class="co">  This function uploads a pdb file and find out the indices of first two alpha carbon atoms.</span></a>
<a class="sourceLine" id="cb263-7" title="7"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb263-8" title="8">  traj <span class="op">=</span> md.load(pdb_file)</a>
<a class="sourceLine" id="cb263-9" title="9">  idx <span class="op">=</span> np.where(traj.topology.select(<span class="st">&#39;name CA&#39;</span>))[<span class="dv">0</span>][:<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb263-10" title="10">  <span class="cf">return</span> idx</a>
<a class="sourceLine" id="cb263-11" title="11"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb263-12" title="12"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb263-13" title="13"></a>
<a class="sourceLine" id="cb263-14" title="14">pdb_file <span class="op">=</span> os.path.join(_FILE_DIR_,<span class="st">&quot;1l2y.pdb&quot;</span>)</a>
<a class="sourceLine" id="cb263-15" title="15"></a>
<a class="sourceLine" id="cb263-16" title="16"><span class="kw">def</span> get_pair_indices(pdb_file):</a>
<a class="sourceLine" id="cb263-17" title="17">    <span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb263-18" title="18">    pdb <span class="op">=</span> md.load(pdb_file)</a>
<a class="sourceLine" id="cb263-19" title="19">    top <span class="op">=</span> pdb.topology</a>
<a class="sourceLine" id="cb263-20" title="20">    CAs <span class="op">=</span> [atom.index <span class="cf">for</span> atom <span class="kw">in</span> top.atoms <span class="cf">if</span> atom.name <span class="op">==</span> <span class="st">&#39;CA&#39;</span>]</a>
<a class="sourceLine" id="cb263-21" title="21">    indices_pair <span class="op">=</span> np.array([CAs[<span class="dv">0</span>], CAs[<span class="dv">1</span>]])</a>
<a class="sourceLine" id="cb263-22" title="22">    <span class="cf">return</span> indices_pair</a>
<a class="sourceLine" id="cb263-23" title="23"></a>
<a class="sourceLine" id="cb263-24" title="24">my_indices_pair <span class="op">=</span> get_pair_indices(pdb_file)</a>
<a class="sourceLine" id="cb263-25" title="25">prompt_indices_pair <span class="op">=</span> get_ca_indices(pdb_file)</a>
<a class="sourceLine" id="cb263-26" title="26"></a>
<a class="sourceLine" id="cb263-27" title="27">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">all</span>(my_indices_pair <span class="op">==</span> prompt_indices_pair) <span class="cf">else</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb263-28" title="28"></a>
<a class="sourceLine" id="cb263-29" title="29"></a></code></pre></div>
<p>Output:</p>
<pre><code>&#39;Constant&#39; object has no attribute &#39;kind&#39;</code></pre>
</details>
<details>
<p><summary>force_constant</summary></p>
<h4 id="query-24">Query</h4>
<div class="sourceCode" id="cb265"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb265-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb265-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb265-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb265-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb265-5" title="5"></a>
<a class="sourceLine" id="cb265-6" title="6"><span class="kw">def</span> compute_k(m1,m2,wave_len):</a>
<a class="sourceLine" id="cb265-7" title="7">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb265-8" title="8"><span class="co">    Two atom harmonic oscillator.</span></a>
<a class="sourceLine" id="cb265-9" title="9"><span class="co">    Returns force constant in kg/s**2 units given masses m1,m2 and wave length</span></a>
<a class="sourceLine" id="cb265-10" title="10"><span class="co">    wave_len. Masses are in kg units and wave length in cm^-1 units. Use reduced mass.</span></a>
<a class="sourceLine" id="cb265-11" title="11"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb265-12" title="12">    [insert]</a>
<a class="sourceLine" id="cb265-13" title="13">    <span class="cf">return</span> k</a></code></pre></div>
<h4 id="run-0-24">Run 0</h4>
<div class="sourceCode" id="cb266"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb266-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb266-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb266-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb266-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb266-5" title="5"></a>
<a class="sourceLine" id="cb266-6" title="6"><span class="kw">def</span> compute_k(m1,m2,wave_len):</a>
<a class="sourceLine" id="cb266-7" title="7">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb266-8" title="8"><span class="co">    Two atom harmonic oscillator.</span></a>
<a class="sourceLine" id="cb266-9" title="9"><span class="co">    Returns force constant in kg/s**2 units given masses m1,m2 and wave length</span></a>
<a class="sourceLine" id="cb266-10" title="10"><span class="co">    wave_len. Masses are in kg units and wave length in cm^-1 units. Use reduced mass.</span></a>
<a class="sourceLine" id="cb266-11" title="11"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb266-12" title="12">    k <span class="op">=</span> (<span class="dv">2</span><span class="op">*</span>np.pi<span class="op">*</span><span class="fl">1.98644568e-23</span><span class="op">*</span><span class="dv">299792458</span><span class="op">**</span><span class="dv">2</span>)<span class="op">/</span>(wave_len<span class="op">*</span><span class="fl">1e-2</span>)<span class="op">**</span><span class="dv">2</span><span class="op">*</span>(m1<span class="op">*</span>m2)<span class="op">/</span>(m1<span class="op">+</span>m2)</a>
<a class="sourceLine" id="cb266-13" title="13">    <span class="cf">return</span> k</a>
<a class="sourceLine" id="cb266-14" title="14"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb266-15" title="15"></a>
<a class="sourceLine" id="cb266-16" title="16">m1 <span class="op">=</span> <span class="fl">12.0</span> <span class="co">#amu</span></a>
<a class="sourceLine" id="cb266-17" title="17">m2 <span class="op">=</span> <span class="fl">16.0</span> <span class="co">#amu</span></a>
<a class="sourceLine" id="cb266-18" title="18">wave_len <span class="op">=</span> <span class="dv">2100</span> <span class="co">#1/cm</span></a>
<a class="sourceLine" id="cb266-19" title="19">mass_fac <span class="op">=</span> <span class="fl">1.677e-27</span> <span class="co">#kg/amu</span></a>
<a class="sourceLine" id="cb266-20" title="20">velocity <span class="op">=</span> <span class="fl">2.99e10</span> <span class="co">#cm/s</span></a>
<a class="sourceLine" id="cb266-21" title="21">pi <span class="op">=</span> np.pi</a>
<a class="sourceLine" id="cb266-22" title="22"></a>
<a class="sourceLine" id="cb266-23" title="23">mu <span class="op">=</span> (m1<span class="op">*</span>m2)<span class="op">/</span>(m1<span class="op">+</span>m2)<span class="op">*</span>mass_fac </a>
<a class="sourceLine" id="cb266-24" title="24">omega <span class="op">=</span> <span class="dv">2</span><span class="op">*</span>pi<span class="op">*</span>wave_len<span class="op">*</span>velocity </a>
<a class="sourceLine" id="cb266-25" title="25">force_const <span class="op">=</span> mu<span class="op">*</span>omega<span class="op">**</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb266-26" title="26"></a>
<a class="sourceLine" id="cb266-27" title="27">force_const_codex <span class="op">=</span> compute_k(m1,m2,wave_len)</a>
<a class="sourceLine" id="cb266-28" title="28"></a>
<a class="sourceLine" id="cb266-29" title="29"><span class="cf">if</span> np.isclose(force_const, force_const_codex) <span class="op">==</span>  <span class="va">True</span>:</a>
<a class="sourceLine" id="cb266-30" title="30">    result <span class="op">=</span> <span class="va">True</span></a>
<a class="sourceLine" id="cb266-31" title="31"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb266-32" title="32">    result <span class="op">=</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-24">Run 1</h4>
<div class="sourceCode" id="cb268"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb268-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb268-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb268-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb268-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb268-5" title="5"></a>
<a class="sourceLine" id="cb268-6" title="6"><span class="kw">def</span> compute_k(m1,m2,wave_len):</a>
<a class="sourceLine" id="cb268-7" title="7">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb268-8" title="8"><span class="co">    Two atom harmonic oscillator.</span></a>
<a class="sourceLine" id="cb268-9" title="9"><span class="co">    Returns force constant in kg/s**2 units given masses m1,m2 and wave length</span></a>
<a class="sourceLine" id="cb268-10" title="10"><span class="co">    wave_len. Masses are in kg units and wave length in cm^-1 units. Use reduced mass.</span></a>
<a class="sourceLine" id="cb268-11" title="11"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb268-12" title="12">    k <span class="op">=</span> (<span class="fl">1.99e-23</span><span class="op">*</span>(<span class="fl">1e2</span>)<span class="op">**</span><span class="dv">2</span>)<span class="op">/</span>(wave_len<span class="op">*</span>(<span class="fl">1e-2</span>)<span class="op">*</span>(m1<span class="op">*</span>m2)<span class="op">/</span>(m1<span class="op">+</span>m2))</a>
<a class="sourceLine" id="cb268-13" title="13">    <span class="cf">return</span> k</a>
<a class="sourceLine" id="cb268-14" title="14"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb268-15" title="15"></a>
<a class="sourceLine" id="cb268-16" title="16">m1 <span class="op">=</span> <span class="fl">12.0</span> <span class="co">#amu</span></a>
<a class="sourceLine" id="cb268-17" title="17">m2 <span class="op">=</span> <span class="fl">16.0</span> <span class="co">#amu</span></a>
<a class="sourceLine" id="cb268-18" title="18">wave_len <span class="op">=</span> <span class="dv">2100</span> <span class="co">#1/cm</span></a>
<a class="sourceLine" id="cb268-19" title="19">mass_fac <span class="op">=</span> <span class="fl">1.677e-27</span> <span class="co">#kg/amu</span></a>
<a class="sourceLine" id="cb268-20" title="20">velocity <span class="op">=</span> <span class="fl">2.99e10</span> <span class="co">#cm/s</span></a>
<a class="sourceLine" id="cb268-21" title="21">pi <span class="op">=</span> np.pi</a>
<a class="sourceLine" id="cb268-22" title="22"></a>
<a class="sourceLine" id="cb268-23" title="23">mu <span class="op">=</span> (m1<span class="op">*</span>m2)<span class="op">/</span>(m1<span class="op">+</span>m2)<span class="op">*</span>mass_fac </a>
<a class="sourceLine" id="cb268-24" title="24">omega <span class="op">=</span> <span class="dv">2</span><span class="op">*</span>pi<span class="op">*</span>wave_len<span class="op">*</span>velocity </a>
<a class="sourceLine" id="cb268-25" title="25">force_const <span class="op">=</span> mu<span class="op">*</span>omega<span class="op">**</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb268-26" title="26"></a>
<a class="sourceLine" id="cb268-27" title="27">force_const_codex <span class="op">=</span> compute_k(m1,m2,wave_len)</a>
<a class="sourceLine" id="cb268-28" title="28"></a>
<a class="sourceLine" id="cb268-29" title="29"><span class="cf">if</span> np.isclose(force_const, force_const_codex) <span class="op">==</span>  <span class="va">True</span>:</a>
<a class="sourceLine" id="cb268-30" title="30">    result <span class="op">=</span> <span class="va">True</span></a>
<a class="sourceLine" id="cb268-31" title="31"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb268-32" title="32">    result <span class="op">=</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-24">Run 2</h4>
<div class="sourceCode" id="cb270"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb270-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb270-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb270-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb270-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb270-5" title="5"></a>
<a class="sourceLine" id="cb270-6" title="6"><span class="kw">def</span> compute_k(m1,m2,wave_len):</a>
<a class="sourceLine" id="cb270-7" title="7">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb270-8" title="8"><span class="co">    Two atom harmonic oscillator.</span></a>
<a class="sourceLine" id="cb270-9" title="9"><span class="co">    Returns force constant in kg/s**2 units given masses m1,m2 and wave length</span></a>
<a class="sourceLine" id="cb270-10" title="10"><span class="co">    wave_len. Masses are in kg units and wave length in cm^-1 units. Use reduced mass.</span></a>
<a class="sourceLine" id="cb270-11" title="11"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb270-12" title="12">    k <span class="op">=</span> (<span class="dv">1</span><span class="op">/</span>wave_len)<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>wave_len)<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>wave_len)<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>wave_len)<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>wave_len)<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>wave_len)<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>wave_len)<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>wave_len)<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>wave_len)<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>wave_len)<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>wave_len)<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>wave_len)<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>wave_len)<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>wave_len)<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>wave_len)<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>wave_len)<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>wave_len)<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>wave_len)<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>wave_len)<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>wave_len)<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>wave_len)<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>wave_len)<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>wave_len)<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>wave_len)<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>wave_len)<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>wave_len)<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>wave_len)<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>wave_len)<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>wave_len)<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>wave_len)<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>wave_len)<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>wave_len)<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>wave_len)<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>wave_len)<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>wave_len)<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>wave_len)<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>wave_len)<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>wave_len)<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>wave_len)<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>wave_len)<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>wave_len)<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>wave_len)<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>wave_len)<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>wave_len)<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>wave_len)<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>wave_len)<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>wave_len)<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>wave_len)<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>wave_len)<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>wave_len)<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>wave_len)<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>wave_len)<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>wave_len)<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>wave_len)<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>wave_len)<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>wave_len)<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>wave_len)<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>wave_len)<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>wave_len)<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>wave_len)<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>wave_len)<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>wave_len)<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>wave_len)<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>wave_len)<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>wave_len)<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>wave_len)<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>wave_len)<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>wave_len)<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>wave_len)<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>wave_len)<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>wave_len)<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>wave_len)<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>wave_len)<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>wave_len)<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>wave_len)<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>wave_len)<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>wave_len)<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>wave_len)<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>wave_len)<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>wave_len)<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>wave_len)<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>wave_len)<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>wave_len)<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>wave_len)<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>wave_len)<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>wave_len)<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>wave_len)<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>wave_len)<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>wave_len)<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>wave_len)<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>wave_len)<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>wave_len)<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>wave_len)<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>wave_len)<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>wave_len)<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>wave_len)<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>wave_len)<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>wave_len)<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>wave_len)<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>wave_len)<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>wave_len)<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>wave_len)<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>wave_len)<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>wave_len)<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>wave_len)<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>wave_len)<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>wave_len)<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>wave_len)<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>wave_len)<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>wave_len)<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>wave_len)<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>wave_len)<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>wave_len)<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>wave_len)<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>wave_len)<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>wave_len)<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>wave_len)<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>wave_len)<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>wave_len)<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>wave_len)<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>wave_len)<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>wave_len)<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>wave_len)<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>wave_len)<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>wave_len)<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>wave_len)<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>wave_len)<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>wave</a>
<a class="sourceLine" id="cb270-13" title="13">    <span class="cf">return</span> k</a>
<a class="sourceLine" id="cb270-14" title="14"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb270-15" title="15"></a>
<a class="sourceLine" id="cb270-16" title="16">m1 <span class="op">=</span> <span class="fl">12.0</span> <span class="co">#amu</span></a>
<a class="sourceLine" id="cb270-17" title="17">m2 <span class="op">=</span> <span class="fl">16.0</span> <span class="co">#amu</span></a>
<a class="sourceLine" id="cb270-18" title="18">wave_len <span class="op">=</span> <span class="dv">2100</span> <span class="co">#1/cm</span></a>
<a class="sourceLine" id="cb270-19" title="19">mass_fac <span class="op">=</span> <span class="fl">1.677e-27</span> <span class="co">#kg/amu</span></a>
<a class="sourceLine" id="cb270-20" title="20">velocity <span class="op">=</span> <span class="fl">2.99e10</span> <span class="co">#cm/s</span></a>
<a class="sourceLine" id="cb270-21" title="21">pi <span class="op">=</span> np.pi</a>
<a class="sourceLine" id="cb270-22" title="22"></a>
<a class="sourceLine" id="cb270-23" title="23">mu <span class="op">=</span> (m1<span class="op">*</span>m2)<span class="op">/</span>(m1<span class="op">+</span>m2)<span class="op">*</span>mass_fac </a>
<a class="sourceLine" id="cb270-24" title="24">omega <span class="op">=</span> <span class="dv">2</span><span class="op">*</span>pi<span class="op">*</span>wave_len<span class="op">*</span>velocity </a>
<a class="sourceLine" id="cb270-25" title="25">force_const <span class="op">=</span> mu<span class="op">*</span>omega<span class="op">**</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb270-26" title="26"></a>
<a class="sourceLine" id="cb270-27" title="27">force_const_codex <span class="op">=</span> compute_k(m1,m2,wave_len)</a>
<a class="sourceLine" id="cb270-28" title="28"></a>
<a class="sourceLine" id="cb270-29" title="29"><span class="cf">if</span> np.isclose(force_const, force_const_codex) <span class="op">==</span>  <span class="va">True</span>:</a>
<a class="sourceLine" id="cb270-30" title="30">    result <span class="op">=</span> <span class="va">True</span></a>
<a class="sourceLine" id="cb270-31" title="31"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb270-32" title="32">    result <span class="op">=</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>invalid syntax (&lt;string&gt;, line 14)</code></pre>
<h4 id="run-3-24">Run 3</h4>
<div class="sourceCode" id="cb272"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb272-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb272-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb272-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb272-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb272-5" title="5"></a>
<a class="sourceLine" id="cb272-6" title="6"><span class="kw">def</span> compute_k(m1,m2,wave_len):</a>
<a class="sourceLine" id="cb272-7" title="7">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb272-8" title="8"><span class="co">    Two atom harmonic oscillator.</span></a>
<a class="sourceLine" id="cb272-9" title="9"><span class="co">    Returns force constant in kg/s**2 units given masses m1,m2 and wave length</span></a>
<a class="sourceLine" id="cb272-10" title="10"><span class="co">    wave_len. Masses are in kg units and wave length in cm^-1 units. Use reduced mass.</span></a>
<a class="sourceLine" id="cb272-11" title="11"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb272-12" title="12">    k <span class="op">=</span> (<span class="fl">1.98644568e-23</span><span class="op">*</span><span class="fl">1e-2</span><span class="op">*</span>wave_len<span class="op">**</span><span class="dv">2</span>)<span class="op">/</span>(m1<span class="op">*</span>m2)</a>
<a class="sourceLine" id="cb272-13" title="13">    <span class="cf">return</span> k</a>
<a class="sourceLine" id="cb272-14" title="14"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb272-15" title="15"></a>
<a class="sourceLine" id="cb272-16" title="16">m1 <span class="op">=</span> <span class="fl">12.0</span> <span class="co">#amu</span></a>
<a class="sourceLine" id="cb272-17" title="17">m2 <span class="op">=</span> <span class="fl">16.0</span> <span class="co">#amu</span></a>
<a class="sourceLine" id="cb272-18" title="18">wave_len <span class="op">=</span> <span class="dv">2100</span> <span class="co">#1/cm</span></a>
<a class="sourceLine" id="cb272-19" title="19">mass_fac <span class="op">=</span> <span class="fl">1.677e-27</span> <span class="co">#kg/amu</span></a>
<a class="sourceLine" id="cb272-20" title="20">velocity <span class="op">=</span> <span class="fl">2.99e10</span> <span class="co">#cm/s</span></a>
<a class="sourceLine" id="cb272-21" title="21">pi <span class="op">=</span> np.pi</a>
<a class="sourceLine" id="cb272-22" title="22"></a>
<a class="sourceLine" id="cb272-23" title="23">mu <span class="op">=</span> (m1<span class="op">*</span>m2)<span class="op">/</span>(m1<span class="op">+</span>m2)<span class="op">*</span>mass_fac </a>
<a class="sourceLine" id="cb272-24" title="24">omega <span class="op">=</span> <span class="dv">2</span><span class="op">*</span>pi<span class="op">*</span>wave_len<span class="op">*</span>velocity </a>
<a class="sourceLine" id="cb272-25" title="25">force_const <span class="op">=</span> mu<span class="op">*</span>omega<span class="op">**</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb272-26" title="26"></a>
<a class="sourceLine" id="cb272-27" title="27">force_const_codex <span class="op">=</span> compute_k(m1,m2,wave_len)</a>
<a class="sourceLine" id="cb272-28" title="28"></a>
<a class="sourceLine" id="cb272-29" title="29"><span class="cf">if</span> np.isclose(force_const, force_const_codex) <span class="op">==</span>  <span class="va">True</span>:</a>
<a class="sourceLine" id="cb272-30" title="30">    result <span class="op">=</span> <span class="va">True</span></a>
<a class="sourceLine" id="cb272-31" title="31"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb272-32" title="32">    result <span class="op">=</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-24">Run 4</h4>
<div class="sourceCode" id="cb274"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb274-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb274-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb274-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb274-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb274-5" title="5"></a>
<a class="sourceLine" id="cb274-6" title="6"><span class="kw">def</span> compute_k(m1,m2,wave_len):</a>
<a class="sourceLine" id="cb274-7" title="7">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb274-8" title="8"><span class="co">    Two atom harmonic oscillator.</span></a>
<a class="sourceLine" id="cb274-9" title="9"><span class="co">    Returns force constant in kg/s**2 units given masses m1,m2 and wave length</span></a>
<a class="sourceLine" id="cb274-10" title="10"><span class="co">    wave_len. Masses are in kg units and wave length in cm^-1 units. Use reduced mass.</span></a>
<a class="sourceLine" id="cb274-11" title="11"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb274-12" title="12">    k <span class="op">=</span> (<span class="fl">1.0</span><span class="op">/</span><span class="fl">2.0</span>)<span class="op">*</span>(m1<span class="op">*</span>m2)<span class="op">/</span>(m1<span class="op">+</span>m2)<span class="op">*</span>(wave_len<span class="op">*</span><span class="fl">1.0e-2</span>)<span class="op">**</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb274-13" title="13">    <span class="cf">return</span> k</a>
<a class="sourceLine" id="cb274-14" title="14"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb274-15" title="15"></a>
<a class="sourceLine" id="cb274-16" title="16">m1 <span class="op">=</span> <span class="fl">12.0</span> <span class="co">#amu</span></a>
<a class="sourceLine" id="cb274-17" title="17">m2 <span class="op">=</span> <span class="fl">16.0</span> <span class="co">#amu</span></a>
<a class="sourceLine" id="cb274-18" title="18">wave_len <span class="op">=</span> <span class="dv">2100</span> <span class="co">#1/cm</span></a>
<a class="sourceLine" id="cb274-19" title="19">mass_fac <span class="op">=</span> <span class="fl">1.677e-27</span> <span class="co">#kg/amu</span></a>
<a class="sourceLine" id="cb274-20" title="20">velocity <span class="op">=</span> <span class="fl">2.99e10</span> <span class="co">#cm/s</span></a>
<a class="sourceLine" id="cb274-21" title="21">pi <span class="op">=</span> np.pi</a>
<a class="sourceLine" id="cb274-22" title="22"></a>
<a class="sourceLine" id="cb274-23" title="23">mu <span class="op">=</span> (m1<span class="op">*</span>m2)<span class="op">/</span>(m1<span class="op">+</span>m2)<span class="op">*</span>mass_fac </a>
<a class="sourceLine" id="cb274-24" title="24">omega <span class="op">=</span> <span class="dv">2</span><span class="op">*</span>pi<span class="op">*</span>wave_len<span class="op">*</span>velocity </a>
<a class="sourceLine" id="cb274-25" title="25">force_const <span class="op">=</span> mu<span class="op">*</span>omega<span class="op">**</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb274-26" title="26"></a>
<a class="sourceLine" id="cb274-27" title="27">force_const_codex <span class="op">=</span> compute_k(m1,m2,wave_len)</a>
<a class="sourceLine" id="cb274-28" title="28"></a>
<a class="sourceLine" id="cb274-29" title="29"><span class="cf">if</span> np.isclose(force_const, force_const_codex) <span class="op">==</span>  <span class="va">True</span>:</a>
<a class="sourceLine" id="cb274-30" title="30">    result <span class="op">=</span> <span class="va">True</span></a>
<a class="sourceLine" id="cb274-31" title="31"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb274-32" title="32">    result <span class="op">=</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>fourier_1d</summary></p>
<h4 id="query-25">Query</h4>
<div class="sourceCode" id="cb276"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb276-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb276-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb276-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb276-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb276-5" title="5"></a>
<a class="sourceLine" id="cb276-6" title="6"><span class="kw">def</span> fourier_1d(x):</a>
<a class="sourceLine" id="cb276-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb276-8" title="8"><span class="co">  This function returns the one dimensional fourier transform of array x.</span></a>
<a class="sourceLine" id="cb276-9" title="9"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb276-10" title="10">  [insert]</a>
<a class="sourceLine" id="cb276-11" title="11">  <span class="cf">return</span> w</a></code></pre></div>
<h4 id="run-0-25">Run 0</h4>
<div class="sourceCode" id="cb277"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb277-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb277-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb277-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb277-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb277-5" title="5"></a>
<a class="sourceLine" id="cb277-6" title="6"><span class="kw">def</span> fourier_1d(x):</a>
<a class="sourceLine" id="cb277-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb277-8" title="8"><span class="co">  This function returns the one dimensional fourier transform of array x.</span></a>
<a class="sourceLine" id="cb277-9" title="9"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb277-10" title="10">  N <span class="op">=</span> <span class="bu">len</span>(x)</a>
<a class="sourceLine" id="cb277-11" title="11">  w <span class="op">=</span> np.zeros(N, dtype<span class="op">=</span>np.<span class="bu">complex</span>)</a>
<a class="sourceLine" id="cb277-12" title="12">  <span class="cf">for</span> k <span class="kw">in</span> <span class="bu">range</span>(N):</a>
<a class="sourceLine" id="cb277-13" title="13">    <span class="cf">for</span> n <span class="kw">in</span> <span class="bu">range</span>(N):</a>
<a class="sourceLine" id="cb277-14" title="14">      w[k] <span class="op">+=</span> x[n] <span class="op">*</span> np.exp(<span class="op">-</span>2j <span class="op">*</span> np.pi <span class="op">*</span> k <span class="op">*</span> n <span class="op">/</span> N)</a>
<a class="sourceLine" id="cb277-15" title="15">  <span class="cf">return</span> w</a>
<a class="sourceLine" id="cb277-16" title="16"></a>
<a class="sourceLine" id="cb277-17" title="17"></a>
<a class="sourceLine" id="cb277-18" title="18">  <span class="cf">return</span> w</a>
<a class="sourceLine" id="cb277-19" title="19"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb277-20" title="20"><span class="im">from</span> numpy.fft <span class="im">import</span> fft</a>
<a class="sourceLine" id="cb277-21" title="21"></a>
<a class="sourceLine" id="cb277-22" title="22">x <span class="op">=</span> np.array([<span class="fl">1.0</span>, <span class="fl">2.0</span>, <span class="fl">1.0</span>, <span class="fl">-1.0</span>, <span class="fl">1.5</span>])</a>
<a class="sourceLine" id="cb277-23" title="23"></a>
<a class="sourceLine" id="cb277-24" title="24">true_y <span class="op">=</span> fft(x)</a>
<a class="sourceLine" id="cb277-25" title="25"></a>
<a class="sourceLine" id="cb277-26" title="26">test_y <span class="op">=</span> fourier_1d(x)</a>
<a class="sourceLine" id="cb277-27" title="27"></a>
<a class="sourceLine" id="cb277-28" title="28">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.allclose(true_y, test_y) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-25">Run 1</h4>
<div class="sourceCode" id="cb279"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb279-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb279-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb279-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb279-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb279-5" title="5"></a>
<a class="sourceLine" id="cb279-6" title="6"><span class="kw">def</span> fourier_1d(x):</a>
<a class="sourceLine" id="cb279-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb279-8" title="8"><span class="co">  This function returns the one dimensional fourier transform of array x.</span></a>
<a class="sourceLine" id="cb279-9" title="9"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb279-10" title="10">  N <span class="op">=</span> <span class="bu">len</span>(x)</a>
<a class="sourceLine" id="cb279-11" title="11">  w <span class="op">=</span> np.zeros(N, dtype<span class="op">=</span><span class="bu">complex</span>)</a>
<a class="sourceLine" id="cb279-12" title="12">  <span class="cf">for</span> k <span class="kw">in</span> <span class="bu">range</span>(N):</a>
<a class="sourceLine" id="cb279-13" title="13">    <span class="cf">for</span> n <span class="kw">in</span> <span class="bu">range</span>(N):</a>
<a class="sourceLine" id="cb279-14" title="14">      w[k] <span class="op">+=</span> x[n]<span class="op">*</span>np.exp(<span class="op">-</span>2j<span class="op">*</span>np.pi<span class="op">*</span>k<span class="op">*</span>n<span class="op">/</span>N)</a>
<a class="sourceLine" id="cb279-15" title="15">  <span class="cf">return</span> w</a>
<a class="sourceLine" id="cb279-16" title="16"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb279-17" title="17"><span class="im">from</span> numpy.fft <span class="im">import</span> fft</a>
<a class="sourceLine" id="cb279-18" title="18"></a>
<a class="sourceLine" id="cb279-19" title="19">x <span class="op">=</span> np.array([<span class="fl">1.0</span>, <span class="fl">2.0</span>, <span class="fl">1.0</span>, <span class="fl">-1.0</span>, <span class="fl">1.5</span>])</a>
<a class="sourceLine" id="cb279-20" title="20"></a>
<a class="sourceLine" id="cb279-21" title="21">true_y <span class="op">=</span> fft(x)</a>
<a class="sourceLine" id="cb279-22" title="22"></a>
<a class="sourceLine" id="cb279-23" title="23">test_y <span class="op">=</span> fourier_1d(x)</a>
<a class="sourceLine" id="cb279-24" title="24"></a>
<a class="sourceLine" id="cb279-25" title="25">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.allclose(true_y, test_y) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-25">Run 2</h4>
<div class="sourceCode" id="cb281"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb281-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb281-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb281-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb281-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb281-5" title="5"></a>
<a class="sourceLine" id="cb281-6" title="6"><span class="kw">def</span> fourier_1d(x):</a>
<a class="sourceLine" id="cb281-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb281-8" title="8"><span class="co">  This function returns the one dimensional fourier transform of array x.</span></a>
<a class="sourceLine" id="cb281-9" title="9"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb281-10" title="10">  w <span class="op">=</span> np.fft.fft(x)</a>
<a class="sourceLine" id="cb281-11" title="11">  <span class="cf">return</span> w</a>
<a class="sourceLine" id="cb281-12" title="12"></a>
<a class="sourceLine" id="cb281-13" title="13"></a>
<a class="sourceLine" id="cb281-14" title="14">  <span class="cf">return</span> w</a>
<a class="sourceLine" id="cb281-15" title="15"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb281-16" title="16"><span class="im">from</span> numpy.fft <span class="im">import</span> fft</a>
<a class="sourceLine" id="cb281-17" title="17"></a>
<a class="sourceLine" id="cb281-18" title="18">x <span class="op">=</span> np.array([<span class="fl">1.0</span>, <span class="fl">2.0</span>, <span class="fl">1.0</span>, <span class="fl">-1.0</span>, <span class="fl">1.5</span>])</a>
<a class="sourceLine" id="cb281-19" title="19"></a>
<a class="sourceLine" id="cb281-20" title="20">true_y <span class="op">=</span> fft(x)</a>
<a class="sourceLine" id="cb281-21" title="21"></a>
<a class="sourceLine" id="cb281-22" title="22">test_y <span class="op">=</span> fourier_1d(x)</a>
<a class="sourceLine" id="cb281-23" title="23"></a>
<a class="sourceLine" id="cb281-24" title="24">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.allclose(true_y, test_y) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-25">Run 3</h4>
<div class="sourceCode" id="cb283"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb283-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb283-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb283-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb283-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb283-5" title="5"></a>
<a class="sourceLine" id="cb283-6" title="6"><span class="kw">def</span> fourier_1d(x):</a>
<a class="sourceLine" id="cb283-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb283-8" title="8"><span class="co">  This function returns the one dimensional fourier transform of array x.</span></a>
<a class="sourceLine" id="cb283-9" title="9"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb283-10" title="10">  N <span class="op">=</span> x.size</a>
<a class="sourceLine" id="cb283-11" title="11">  n <span class="op">=</span> np.arange(N)</a>
<a class="sourceLine" id="cb283-12" title="12">  k <span class="op">=</span> n.reshape((N, <span class="dv">1</span>))</a>
<a class="sourceLine" id="cb283-13" title="13">  M <span class="op">=</span> np.exp(<span class="op">-</span>2j <span class="op">*</span> np.pi <span class="op">*</span> k <span class="op">*</span> n <span class="op">/</span> N)</a>
<a class="sourceLine" id="cb283-14" title="14">  <span class="cf">return</span> np.dot(M, x)</a>
<a class="sourceLine" id="cb283-15" title="15"></a>
<a class="sourceLine" id="cb283-16" title="16"></a>
<a class="sourceLine" id="cb283-17" title="17">  <span class="cf">return</span> w</a>
<a class="sourceLine" id="cb283-18" title="18"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb283-19" title="19"><span class="im">from</span> numpy.fft <span class="im">import</span> fft</a>
<a class="sourceLine" id="cb283-20" title="20"></a>
<a class="sourceLine" id="cb283-21" title="21">x <span class="op">=</span> np.array([<span class="fl">1.0</span>, <span class="fl">2.0</span>, <span class="fl">1.0</span>, <span class="fl">-1.0</span>, <span class="fl">1.5</span>])</a>
<a class="sourceLine" id="cb283-22" title="22"></a>
<a class="sourceLine" id="cb283-23" title="23">true_y <span class="op">=</span> fft(x)</a>
<a class="sourceLine" id="cb283-24" title="24"></a>
<a class="sourceLine" id="cb283-25" title="25">test_y <span class="op">=</span> fourier_1d(x)</a>
<a class="sourceLine" id="cb283-26" title="26"></a>
<a class="sourceLine" id="cb283-27" title="27">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.allclose(true_y, test_y) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-25">Run 4</h4>
<div class="sourceCode" id="cb285"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb285-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb285-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb285-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb285-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb285-5" title="5"></a>
<a class="sourceLine" id="cb285-6" title="6"><span class="kw">def</span> fourier_1d(x):</a>
<a class="sourceLine" id="cb285-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb285-8" title="8"><span class="co">  This function returns the one dimensional fourier transform of array x.</span></a>
<a class="sourceLine" id="cb285-9" title="9"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb285-10" title="10">  w <span class="op">=</span> np.fft.fft(x)</a>
<a class="sourceLine" id="cb285-11" title="11">  <span class="cf">return</span> w</a>
<a class="sourceLine" id="cb285-12" title="12"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb285-13" title="13"><span class="im">from</span> numpy.fft <span class="im">import</span> fft</a>
<a class="sourceLine" id="cb285-14" title="14"></a>
<a class="sourceLine" id="cb285-15" title="15">x <span class="op">=</span> np.array([<span class="fl">1.0</span>, <span class="fl">2.0</span>, <span class="fl">1.0</span>, <span class="fl">-1.0</span>, <span class="fl">1.5</span>])</a>
<a class="sourceLine" id="cb285-16" title="16"></a>
<a class="sourceLine" id="cb285-17" title="17">true_y <span class="op">=</span> fft(x)</a>
<a class="sourceLine" id="cb285-18" title="18"></a>
<a class="sourceLine" id="cb285-19" title="19">test_y <span class="op">=</span> fourier_1d(x)</a>
<a class="sourceLine" id="cb285-20" title="20"></a>
<a class="sourceLine" id="cb285-21" title="21">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.allclose(true_y, test_y) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>freezing_depression</summary></p>
<h4 id="query-26">Query</h4>
<div class="sourceCode" id="cb287"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb287-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb287-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb287-3" title="3"></a>
<a class="sourceLine" id="cb287-4" title="4"><span class="kw">def</span> freezing_depression(Kf,m):</a>
<a class="sourceLine" id="cb287-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb287-6" title="6"><span class="co">   This function returns the decrease in freezing point in Kelvin</span></a>
<a class="sourceLine" id="cb287-7" title="7"><span class="co">   The depression constant is Kf in K kg/mol and is greater than zero</span></a>
<a class="sourceLine" id="cb287-8" title="8"><span class="co">   Molality m is given in mol/kg</span></a>
<a class="sourceLine" id="cb287-9" title="9"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb287-10" title="10">   [insert]</a>
<a class="sourceLine" id="cb287-11" title="11">   <span class="cf">return</span> deltaT</a></code></pre></div>
<h4 id="run-0-26">Run 0</h4>
<div class="sourceCode" id="cb288"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb288-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb288-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb288-3" title="3"></a>
<a class="sourceLine" id="cb288-4" title="4"><span class="kw">def</span> freezing_depression(Kf,m):</a>
<a class="sourceLine" id="cb288-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb288-6" title="6"><span class="co">   This function returns the decrease in freezing point in Kelvin</span></a>
<a class="sourceLine" id="cb288-7" title="7"><span class="co">   The depression constant is Kf in K kg/mol and is greater than zero</span></a>
<a class="sourceLine" id="cb288-8" title="8"><span class="co">   Molality m is given in mol/kg</span></a>
<a class="sourceLine" id="cb288-9" title="9"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb288-10" title="10">   deltaT <span class="op">=</span> Kf<span class="op">*</span>m</a>
<a class="sourceLine" id="cb288-11" title="11">   <span class="cf">return</span> deltaT</a>
<a class="sourceLine" id="cb288-12" title="12"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb288-13" title="13">molality <span class="op">=</span> <span class="fl">0.1</span></a>
<a class="sourceLine" id="cb288-14" title="14">depression_constant <span class="op">=</span> <span class="fl">-0.512</span></a>
<a class="sourceLine" id="cb288-15" title="15">dT <span class="op">=</span> depression_constant<span class="op">*</span>molality</a>
<a class="sourceLine" id="cb288-16" title="16">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">abs</span>(freezing_depression(depression_constant,molality)<span class="op">-</span>dT)<span class="op">&lt;</span><span class="fl">0.01</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-26">Run 1</h4>
<div class="sourceCode" id="cb290"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb290-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb290-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb290-3" title="3"></a>
<a class="sourceLine" id="cb290-4" title="4"><span class="kw">def</span> freezing_depression(Kf,m):</a>
<a class="sourceLine" id="cb290-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb290-6" title="6"><span class="co">   This function returns the decrease in freezing point in Kelvin</span></a>
<a class="sourceLine" id="cb290-7" title="7"><span class="co">   The depression constant is Kf in K kg/mol and is greater than zero</span></a>
<a class="sourceLine" id="cb290-8" title="8"><span class="co">   Molality m is given in mol/kg</span></a>
<a class="sourceLine" id="cb290-9" title="9"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb290-10" title="10">   deltaT <span class="op">=</span> Kf<span class="op">*</span>m</a>
<a class="sourceLine" id="cb290-11" title="11">   <span class="cf">return</span> deltaT</a>
<a class="sourceLine" id="cb290-12" title="12"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb290-13" title="13">molality <span class="op">=</span> <span class="fl">0.1</span></a>
<a class="sourceLine" id="cb290-14" title="14">depression_constant <span class="op">=</span> <span class="fl">-0.512</span></a>
<a class="sourceLine" id="cb290-15" title="15">dT <span class="op">=</span> depression_constant<span class="op">*</span>molality</a>
<a class="sourceLine" id="cb290-16" title="16">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">abs</span>(freezing_depression(depression_constant,molality)<span class="op">-</span>dT)<span class="op">&lt;</span><span class="fl">0.01</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-26">Run 2</h4>
<div class="sourceCode" id="cb292"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb292-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb292-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb292-3" title="3"></a>
<a class="sourceLine" id="cb292-4" title="4"><span class="kw">def</span> freezing_depression(Kf,m):</a>
<a class="sourceLine" id="cb292-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb292-6" title="6"><span class="co">   This function returns the decrease in freezing point in Kelvin</span></a>
<a class="sourceLine" id="cb292-7" title="7"><span class="co">   The depression constant is Kf in K kg/mol and is greater than zero</span></a>
<a class="sourceLine" id="cb292-8" title="8"><span class="co">   Molality m is given in mol/kg</span></a>
<a class="sourceLine" id="cb292-9" title="9"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb292-10" title="10">   deltaT <span class="op">=</span> Kf<span class="op">*</span>m</a>
<a class="sourceLine" id="cb292-11" title="11">   <span class="cf">return</span> deltaT</a>
<a class="sourceLine" id="cb292-12" title="12"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb292-13" title="13">molality <span class="op">=</span> <span class="fl">0.1</span></a>
<a class="sourceLine" id="cb292-14" title="14">depression_constant <span class="op">=</span> <span class="fl">-0.512</span></a>
<a class="sourceLine" id="cb292-15" title="15">dT <span class="op">=</span> depression_constant<span class="op">*</span>molality</a>
<a class="sourceLine" id="cb292-16" title="16">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">abs</span>(freezing_depression(depression_constant,molality)<span class="op">-</span>dT)<span class="op">&lt;</span><span class="fl">0.01</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-26">Run 3</h4>
<div class="sourceCode" id="cb294"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb294-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb294-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb294-3" title="3"></a>
<a class="sourceLine" id="cb294-4" title="4"><span class="kw">def</span> freezing_depression(Kf,m):</a>
<a class="sourceLine" id="cb294-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb294-6" title="6"><span class="co">   This function returns the decrease in freezing point in Kelvin</span></a>
<a class="sourceLine" id="cb294-7" title="7"><span class="co">   The depression constant is Kf in K kg/mol and is greater than zero</span></a>
<a class="sourceLine" id="cb294-8" title="8"><span class="co">   Molality m is given in mol/kg</span></a>
<a class="sourceLine" id="cb294-9" title="9"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb294-10" title="10">   deltaT <span class="op">=</span> Kf <span class="op">*</span> m</a>
<a class="sourceLine" id="cb294-11" title="11">   <span class="cf">return</span> deltaT</a>
<a class="sourceLine" id="cb294-12" title="12"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb294-13" title="13">molality <span class="op">=</span> <span class="fl">0.1</span></a>
<a class="sourceLine" id="cb294-14" title="14">depression_constant <span class="op">=</span> <span class="fl">-0.512</span></a>
<a class="sourceLine" id="cb294-15" title="15">dT <span class="op">=</span> depression_constant<span class="op">*</span>molality</a>
<a class="sourceLine" id="cb294-16" title="16">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">abs</span>(freezing_depression(depression_constant,molality)<span class="op">-</span>dT)<span class="op">&lt;</span><span class="fl">0.01</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-26">Run 4</h4>
<div class="sourceCode" id="cb296"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb296-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb296-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb296-3" title="3"></a>
<a class="sourceLine" id="cb296-4" title="4"><span class="kw">def</span> freezing_depression(Kf,m):</a>
<a class="sourceLine" id="cb296-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb296-6" title="6"><span class="co">   This function returns the decrease in freezing point in Kelvin</span></a>
<a class="sourceLine" id="cb296-7" title="7"><span class="co">   The depression constant is Kf in K kg/mol and is greater than zero</span></a>
<a class="sourceLine" id="cb296-8" title="8"><span class="co">   Molality m is given in mol/kg</span></a>
<a class="sourceLine" id="cb296-9" title="9"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb296-10" title="10">   deltaT <span class="op">=</span> Kf<span class="op">*</span>m</a>
<a class="sourceLine" id="cb296-11" title="11">   <span class="cf">return</span> deltaT</a>
<a class="sourceLine" id="cb296-12" title="12"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb296-13" title="13">molality <span class="op">=</span> <span class="fl">0.1</span></a>
<a class="sourceLine" id="cb296-14" title="14">depression_constant <span class="op">=</span> <span class="fl">-0.512</span></a>
<a class="sourceLine" id="cb296-15" title="15">dT <span class="op">=</span> depression_constant<span class="op">*</span>molality</a>
<a class="sourceLine" id="cb296-16" title="16">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">abs</span>(freezing_depression(depression_constant,molality)<span class="op">-</span>dT)<span class="op">&lt;</span><span class="fl">0.01</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>genpos</summary></p>
<h4 id="query-27">Query</h4>
<div class="sourceCode" id="cb298"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb298-1" title="1"><span class="im">import</span> requests</a>
<a class="sourceLine" id="cb298-2" title="2"></a>
<a class="sourceLine" id="cb298-3" title="3"><span class="kw">def</span> matrix_generators(gnum):</a>
<a class="sourceLine" id="cb298-4" title="4">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb298-5" title="5"><span class="co">   Returns list of matrix generators for general positions of given space group</span></a>
<a class="sourceLine" id="cb298-6" title="6"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb298-7" title="7">   [insert]</a>
<a class="sourceLine" id="cb298-8" title="8">   <span class="cf">return</span> generators</a></code></pre></div>
<h4 id="run-0-27">Run 0</h4>
<div class="sourceCode" id="cb299"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb299-1" title="1"><span class="im">import</span> requests</a>
<a class="sourceLine" id="cb299-2" title="2"></a>
<a class="sourceLine" id="cb299-3" title="3"><span class="kw">def</span> matrix_generators(gnum):</a>
<a class="sourceLine" id="cb299-4" title="4">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb299-5" title="5"><span class="co">   Returns list of matrix generators for general positions of given space group</span></a>
<a class="sourceLine" id="cb299-6" title="6"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb299-7" title="7">   url <span class="op">=</span> <span class="st">&quot;http://www.cryst.ehu.es/cgi-bin/cryst/programs/nph-getgen&quot;</span></a>
<a class="sourceLine" id="cb299-8" title="8">   params <span class="op">=</span> {<span class="st">&#39;gnum&#39;</span>: gnum}</a>
<a class="sourceLine" id="cb299-9" title="9">   r <span class="op">=</span> requests.get(url, params<span class="op">=</span>params)</a>
<a class="sourceLine" id="cb299-10" title="10">   generators <span class="op">=</span> []</a>
<a class="sourceLine" id="cb299-11" title="11">   <span class="cf">for</span> line <span class="kw">in</span> r.text.split(<span class="st">&#39;</span><span class="ch">\n</span><span class="st">&#39;</span>):</a>
<a class="sourceLine" id="cb299-12" title="12">      <span class="cf">if</span> line.startswith(<span class="st">&#39;GENERATOR&#39;</span>):</a>
<a class="sourceLine" id="cb299-13" title="13">         generators.append(line.split()[<span class="dv">1</span>:])</a>
<a class="sourceLine" id="cb299-14" title="14">   <span class="cf">return</span> generators</a>
<a class="sourceLine" id="cb299-15" title="15"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb299-16" title="16">mgs <span class="op">=</span> matrix_generators(<span class="dv">66</span>)</a>
<a class="sourceLine" id="cb299-17" title="17">ref <span class="op">=</span> np.array([[<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span><span class="op">/</span><span class="dv">2</span>],</a>
<a class="sourceLine" id="cb299-18" title="18">                [<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span><span class="op">/</span><span class="dv">2</span>],</a>
<a class="sourceLine" id="cb299-19" title="19">                [<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>]])</a>
<a class="sourceLine" id="cb299-20" title="20">result <span class="op">=</span> np.allclose(mgs[<span class="op">-</span><span class="dv">1</span>], ref)</a></code></pre></div>
<p>Output:</p>
<pre><code>list index out of range</code></pre>
<h4 id="run-1-27">Run 1</h4>
<div class="sourceCode" id="cb301"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb301-1" title="1"><span class="im">import</span> requests</a>
<a class="sourceLine" id="cb301-2" title="2"></a>
<a class="sourceLine" id="cb301-3" title="3"><span class="kw">def</span> matrix_generators(gnum):</a>
<a class="sourceLine" id="cb301-4" title="4">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb301-5" title="5"><span class="co">   Returns list of matrix generators for general positions of given space group</span></a>
<a class="sourceLine" id="cb301-6" title="6"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb301-7" title="7">   generators <span class="op">=</span> []</a>
<a class="sourceLine" id="cb301-8" title="8">   r <span class="op">=</span> requests.get(<span class="st">&#39;http://www.cryst.ehu.es/cgi-bin/cryst/programs/nph-genpos?gnum=&#39;</span><span class="op">+</span><span class="bu">str</span>(gnum))</a>
<a class="sourceLine" id="cb301-9" title="9">   <span class="cf">for</span> line <span class="kw">in</span> r.text.split(<span class="st">&#39;</span><span class="ch">\n</span><span class="st">&#39;</span>):</a>
<a class="sourceLine" id="cb301-10" title="10">      <span class="cf">if</span> <span class="st">&#39;&lt;pre&gt;&#39;</span> <span class="kw">in</span> line:</a>
<a class="sourceLine" id="cb301-11" title="11">         <span class="cf">for</span> line <span class="kw">in</span> r.text.split(<span class="st">&#39;</span><span class="ch">\n</span><span class="st">&#39;</span>):</a>
<a class="sourceLine" id="cb301-12" title="12">            <span class="cf">if</span> <span class="st">&#39;&lt;/pre&gt;&#39;</span> <span class="kw">in</span> line:</a>
<a class="sourceLine" id="cb301-13" title="13">               <span class="cf">break</span></a>
<a class="sourceLine" id="cb301-14" title="14">            <span class="cf">else</span>:</a>
<a class="sourceLine" id="cb301-15" title="15">               generators.append(line)</a>
<a class="sourceLine" id="cb301-16" title="16">   <span class="cf">return</span> generators</a>
<a class="sourceLine" id="cb301-17" title="17"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb301-18" title="18">mgs <span class="op">=</span> matrix_generators(<span class="dv">66</span>)</a>
<a class="sourceLine" id="cb301-19" title="19">ref <span class="op">=</span> np.array([[<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span><span class="op">/</span><span class="dv">2</span>],</a>
<a class="sourceLine" id="cb301-20" title="20">                [<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span><span class="op">/</span><span class="dv">2</span>],</a>
<a class="sourceLine" id="cb301-21" title="21">                [<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>]])</a>
<a class="sourceLine" id="cb301-22" title="22">result <span class="op">=</span> np.allclose(mgs[<span class="op">-</span><span class="dv">1</span>], ref)</a></code></pre></div>
<p>Output:</p>
<pre><code>list index out of range</code></pre>
<h4 id="run-2-27">Run 2</h4>
<div class="sourceCode" id="cb303"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb303-1" title="1"><span class="im">import</span> requests</a>
<a class="sourceLine" id="cb303-2" title="2"></a>
<a class="sourceLine" id="cb303-3" title="3"><span class="kw">def</span> matrix_generators(gnum):</a>
<a class="sourceLine" id="cb303-4" title="4">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb303-5" title="5"><span class="co">   Returns list of matrix generators for general positions of given space group</span></a>
<a class="sourceLine" id="cb303-6" title="6"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb303-7" title="7">   url <span class="op">=</span> <span class="st">&quot;http://www.cryst.ehu.es/cgi-bin/cryst/programs/nph-getgen&quot;</span></a>
<a class="sourceLine" id="cb303-8" title="8">   params <span class="op">=</span> {<span class="st">&#39;gnum&#39;</span>:gnum}</a>
<a class="sourceLine" id="cb303-9" title="9">   r <span class="op">=</span> requests.get(url, params<span class="op">=</span>params)</a>
<a class="sourceLine" id="cb303-10" title="10">   generators <span class="op">=</span> r.text.split(<span class="st">&#39;</span><span class="ch">\n</span><span class="st">&#39;</span>)</a>
<a class="sourceLine" id="cb303-11" title="11">   <span class="cf">return</span> generators</a>
<a class="sourceLine" id="cb303-12" title="12"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb303-13" title="13">mgs <span class="op">=</span> matrix_generators(<span class="dv">66</span>)</a>
<a class="sourceLine" id="cb303-14" title="14">ref <span class="op">=</span> np.array([[<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span><span class="op">/</span><span class="dv">2</span>],</a>
<a class="sourceLine" id="cb303-15" title="15">                [<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span><span class="op">/</span><span class="dv">2</span>],</a>
<a class="sourceLine" id="cb303-16" title="16">                [<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>]])</a>
<a class="sourceLine" id="cb303-17" title="17">result <span class="op">=</span> np.allclose(mgs[<span class="op">-</span><span class="dv">1</span>], ref)</a></code></pre></div>
<p>Output:</p>
<pre><code>ufunc &#39;isfinite&#39; not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule &#39;&#39;safe&#39;&#39;</code></pre>
<h4 id="run-3-27">Run 3</h4>
<div class="sourceCode" id="cb305"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb305-1" title="1"><span class="im">import</span> requests</a>
<a class="sourceLine" id="cb305-2" title="2"></a>
<a class="sourceLine" id="cb305-3" title="3"><span class="kw">def</span> matrix_generators(gnum):</a>
<a class="sourceLine" id="cb305-4" title="4">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb305-5" title="5"><span class="co">   Returns list of matrix generators for general positions of given space group</span></a>
<a class="sourceLine" id="cb305-6" title="6"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb305-7" title="7">   url <span class="op">=</span> <span class="st">&#39;http://www.cryst.ehu.es/cgi-bin/cryst/programs/nph-getgen&#39;</span></a>
<a class="sourceLine" id="cb305-8" title="8">   params <span class="op">=</span> {<span class="st">&#39;gnum&#39;</span>: gnum}</a>
<a class="sourceLine" id="cb305-9" title="9">   r <span class="op">=</span> requests.get(url, params<span class="op">=</span>params)</a>
<a class="sourceLine" id="cb305-10" title="10">   generators <span class="op">=</span> r.text.split(<span class="st">&#39;</span><span class="ch">\n</span><span class="st">&#39;</span>)</a>
<a class="sourceLine" id="cb305-11" title="11">   generators.pop()</a>
<a class="sourceLine" id="cb305-12" title="12">   <span class="cf">return</span> generators</a>
<a class="sourceLine" id="cb305-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb305-14" title="14">mgs <span class="op">=</span> matrix_generators(<span class="dv">66</span>)</a>
<a class="sourceLine" id="cb305-15" title="15">ref <span class="op">=</span> np.array([[<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span><span class="op">/</span><span class="dv">2</span>],</a>
<a class="sourceLine" id="cb305-16" title="16">                [<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span><span class="op">/</span><span class="dv">2</span>],</a>
<a class="sourceLine" id="cb305-17" title="17">                [<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>]])</a>
<a class="sourceLine" id="cb305-18" title="18">result <span class="op">=</span> np.allclose(mgs[<span class="op">-</span><span class="dv">1</span>], ref)</a></code></pre></div>
<p>Output:</p>
<pre><code>ufunc &#39;isfinite&#39; not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule &#39;&#39;safe&#39;&#39;</code></pre>
<h4 id="run-4-27">Run 4</h4>
<div class="sourceCode" id="cb307"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb307-1" title="1"><span class="im">import</span> requests</a>
<a class="sourceLine" id="cb307-2" title="2"></a>
<a class="sourceLine" id="cb307-3" title="3"><span class="kw">def</span> matrix_generators(gnum):</a>
<a class="sourceLine" id="cb307-4" title="4">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb307-5" title="5"><span class="co">   Returns list of matrix generators for general positions of given space group</span></a>
<a class="sourceLine" id="cb307-6" title="6"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb307-7" title="7">   generators <span class="op">=</span> []</a>
<a class="sourceLine" id="cb307-8" title="8">   url <span class="op">=</span> <span class="st">&#39;http://www.cryst.ehu.es/cgi-bin/cryst/programs/nph-getgen?gnum=&#39;</span> <span class="op">+</span> <span class="bu">str</span>(gnum)</a>
<a class="sourceLine" id="cb307-9" title="9">   r <span class="op">=</span> requests.get(url)</a>
<a class="sourceLine" id="cb307-10" title="10">   <span class="cf">for</span> line <span class="kw">in</span> r.text.split(<span class="st">&#39;</span><span class="ch">\n</span><span class="st">&#39;</span>):</a>
<a class="sourceLine" id="cb307-11" title="11">      <span class="cf">if</span> <span class="st">&#39;&lt;pre&gt;&#39;</span> <span class="kw">in</span> line:</a>
<a class="sourceLine" id="cb307-12" title="12">         generators.append(line.split(<span class="st">&#39;&lt;pre&gt;&#39;</span>)[<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb307-13" title="13">      <span class="cf">if</span> <span class="st">&#39;&lt;/pre&gt;&#39;</span> <span class="kw">in</span> line:</a>
<a class="sourceLine" id="cb307-14" title="14">         generators.append(line.split(<span class="st">&#39;&lt;/pre&gt;&#39;</span>)[<span class="dv">0</span>])</a>
<a class="sourceLine" id="cb307-15" title="15">   <span class="cf">return</span> generators</a>
<a class="sourceLine" id="cb307-16" title="16"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb307-17" title="17">mgs <span class="op">=</span> matrix_generators(<span class="dv">66</span>)</a>
<a class="sourceLine" id="cb307-18" title="18">ref <span class="op">=</span> np.array([[<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span><span class="op">/</span><span class="dv">2</span>],</a>
<a class="sourceLine" id="cb307-19" title="19">                [<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span><span class="op">/</span><span class="dv">2</span>],</a>
<a class="sourceLine" id="cb307-20" title="20">                [<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>]])</a>
<a class="sourceLine" id="cb307-21" title="21">result <span class="op">=</span> np.allclose(mgs[<span class="op">-</span><span class="dv">1</span>], ref)</a></code></pre></div>
<p>Output:</p>
<pre><code>ufunc &#39;isfinite&#39; not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule &#39;&#39;safe&#39;&#39;</code></pre>
</details>
<details>
<p><summary>hydrophobic_res</summary></p>
<h4 id="query-28">Query</h4>
<div class="sourceCode" id="cb309"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb309-1" title="1"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb309-2" title="2"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb309-3" title="3"></a>
<a class="sourceLine" id="cb309-4" title="4"><span class="kw">def</span> get_hydrophobic_residues(pdb_filename):</a>
<a class="sourceLine" id="cb309-5" title="5">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb309-6" title="6"><span class="co">  Returns list of hydrophobic residues indices</span></a>
<a class="sourceLine" id="cb309-7" title="7"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb309-8" title="8">  [insert]</a>
<a class="sourceLine" id="cb309-9" title="9">  <span class="cf">return</span> resids</a></code></pre></div>
<h4 id="run-0-28">Run 0</h4>
<div class="sourceCode" id="cb310"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb310-1" title="1"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb310-2" title="2"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb310-3" title="3"></a>
<a class="sourceLine" id="cb310-4" title="4"><span class="kw">def</span> get_hydrophobic_residues(pdb_filename):</a>
<a class="sourceLine" id="cb310-5" title="5">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb310-6" title="6"><span class="co">  Returns list of hydrophobic residues indices</span></a>
<a class="sourceLine" id="cb310-7" title="7"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb310-8" title="8">  traj <span class="op">=</span> md.load(pdb_filename)</a>
<a class="sourceLine" id="cb310-9" title="9">  resids <span class="op">=</span> []</a>
<a class="sourceLine" id="cb310-10" title="10">  <span class="cf">for</span> i, res <span class="kw">in</span> <span class="bu">enumerate</span>(traj.topology.residues):</a>
<a class="sourceLine" id="cb310-11" title="11">    <span class="cf">if</span> res.is_water:</a>
<a class="sourceLine" id="cb310-12" title="12">      <span class="cf">continue</span></a>
<a class="sourceLine" id="cb310-13" title="13">    <span class="cf">if</span> res.name <span class="kw">in</span> [<span class="st">&#39;ALA&#39;</span>, <span class="st">&#39;VAL&#39;</span>, <span class="st">&#39;LEU&#39;</span>, <span class="st">&#39;ILE&#39;</span>, <span class="st">&#39;PHE&#39;</span>, <span class="st">&#39;TYR&#39;</span>, <span class="st">&#39;TRP&#39;</span>, <span class="st">&#39;MET&#39;</span>, <span class="st">&#39;PRO&#39;</span>]:</a>
<a class="sourceLine" id="cb310-14" title="14">      resids.append(i)</a>
<a class="sourceLine" id="cb310-15" title="15">  <span class="cf">return</span> resids</a>
<a class="sourceLine" id="cb310-16" title="16"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb310-17" title="17">t <span class="op">=</span> md.load(os.path.join(_FILE_DIR_, <span class="st">&#39;e22g.pdb&#39;</span>))</a>
<a class="sourceLine" id="cb310-18" title="18">top <span class="op">=</span> t.topology</a>
<a class="sourceLine" id="cb310-19" title="19">hp_res_list <span class="op">=</span> [<span class="st">&#39;ALA&#39;</span>, <span class="st">&#39;VAL&#39;</span>, <span class="st">&#39;LEU&#39;</span>, <span class="st">&#39;ILE&#39;</span>, <span class="st">&#39;PRO&#39;</span>, <span class="st">&#39;PHE&#39;</span>, <span class="st">&#39;CYS&#39;</span>]</a>
<a class="sourceLine" id="cb310-20" title="20">hydrophobic_res <span class="op">=</span> [res.index <span class="cf">for</span> res <span class="kw">in</span> top.residues <span class="cf">if</span> <span class="bu">str</span>(res)[</a>
<a class="sourceLine" id="cb310-21" title="21">    :<span class="dv">3</span>] <span class="kw">in</span> hp_res_list]</a>
<a class="sourceLine" id="cb310-22" title="22"><span class="bu">print</span>(hydrophobic_res)</a>
<a class="sourceLine" id="cb310-23" title="23">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> get_hydrophobic_residues(os.path.join(</a>
<a class="sourceLine" id="cb310-24" title="24">    _FILE_DIR_, <span class="st">&#39;e22g.pdb&#39;</span>)) <span class="op">==</span> hydrophobic_res <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-28">Run 1</h4>
<div class="sourceCode" id="cb312"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb312-1" title="1"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb312-2" title="2"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb312-3" title="3"></a>
<a class="sourceLine" id="cb312-4" title="4"><span class="kw">def</span> get_hydrophobic_residues(pdb_filename):</a>
<a class="sourceLine" id="cb312-5" title="5">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb312-6" title="6"><span class="co">  Returns list of hydrophobic residues indices</span></a>
<a class="sourceLine" id="cb312-7" title="7"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb312-8" title="8">  traj <span class="op">=</span> md.load(pdb_filename)</a>
<a class="sourceLine" id="cb312-9" title="9">  resids <span class="op">=</span> []</a>
<a class="sourceLine" id="cb312-10" title="10">  <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(traj.n_residues):</a>
<a class="sourceLine" id="cb312-11" title="11">    <span class="cf">if</span> traj.topology.residue(i).is_hydrophobic:</a>
<a class="sourceLine" id="cb312-12" title="12">      resids.append(i)</a>
<a class="sourceLine" id="cb312-13" title="13">  <span class="cf">return</span> resids</a>
<a class="sourceLine" id="cb312-14" title="14"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb312-15" title="15">t <span class="op">=</span> md.load(os.path.join(_FILE_DIR_, <span class="st">&#39;e22g.pdb&#39;</span>))</a>
<a class="sourceLine" id="cb312-16" title="16">top <span class="op">=</span> t.topology</a>
<a class="sourceLine" id="cb312-17" title="17">hp_res_list <span class="op">=</span> [<span class="st">&#39;ALA&#39;</span>, <span class="st">&#39;VAL&#39;</span>, <span class="st">&#39;LEU&#39;</span>, <span class="st">&#39;ILE&#39;</span>, <span class="st">&#39;PRO&#39;</span>, <span class="st">&#39;PHE&#39;</span>, <span class="st">&#39;CYS&#39;</span>]</a>
<a class="sourceLine" id="cb312-18" title="18">hydrophobic_res <span class="op">=</span> [res.index <span class="cf">for</span> res <span class="kw">in</span> top.residues <span class="cf">if</span> <span class="bu">str</span>(res)[</a>
<a class="sourceLine" id="cb312-19" title="19">    :<span class="dv">3</span>] <span class="kw">in</span> hp_res_list]</a>
<a class="sourceLine" id="cb312-20" title="20"><span class="bu">print</span>(hydrophobic_res)</a>
<a class="sourceLine" id="cb312-21" title="21">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> get_hydrophobic_residues(os.path.join(</a>
<a class="sourceLine" id="cb312-22" title="22">    _FILE_DIR_, <span class="st">&#39;e22g.pdb&#39;</span>)) <span class="op">==</span> hydrophobic_res <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>&#39;Residue&#39; object has no attribute &#39;is_hydrophobic&#39;</code></pre>
<h4 id="run-2-28">Run 2</h4>
<div class="sourceCode" id="cb314"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb314-1" title="1"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb314-2" title="2"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb314-3" title="3"></a>
<a class="sourceLine" id="cb314-4" title="4"><span class="kw">def</span> get_hydrophobic_residues(pdb_filename):</a>
<a class="sourceLine" id="cb314-5" title="5">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb314-6" title="6"><span class="co">  Returns list of hydrophobic residues indices</span></a>
<a class="sourceLine" id="cb314-7" title="7"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb314-8" title="8">  traj <span class="op">=</span> md.load(pdb_filename)</a>
<a class="sourceLine" id="cb314-9" title="9">  resids <span class="op">=</span> []</a>
<a class="sourceLine" id="cb314-10" title="10">  <span class="cf">for</span> i, res <span class="kw">in</span> <span class="bu">enumerate</span>(traj.topology.residues):</a>
<a class="sourceLine" id="cb314-11" title="11">    <span class="cf">if</span> res.is_water:</a>
<a class="sourceLine" id="cb314-12" title="12">      <span class="cf">continue</span></a>
<a class="sourceLine" id="cb314-13" title="13">    <span class="cf">if</span> res.name <span class="kw">in</span> [<span class="st">&#39;ALA&#39;</span>, <span class="st">&#39;ILE&#39;</span>, <span class="st">&#39;LEU&#39;</span>, <span class="st">&#39;VAL&#39;</span>, <span class="st">&#39;PHE&#39;</span>, <span class="st">&#39;MET&#39;</span>, <span class="st">&#39;TRP&#39;</span>, <span class="st">&#39;TYR&#39;</span>]:</a>
<a class="sourceLine" id="cb314-14" title="14">      resids.append(i)</a>
<a class="sourceLine" id="cb314-15" title="15">  <span class="cf">return</span> resids</a>
<a class="sourceLine" id="cb314-16" title="16"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb314-17" title="17">t <span class="op">=</span> md.load(os.path.join(_FILE_DIR_, <span class="st">&#39;e22g.pdb&#39;</span>))</a>
<a class="sourceLine" id="cb314-18" title="18">top <span class="op">=</span> t.topology</a>
<a class="sourceLine" id="cb314-19" title="19">hp_res_list <span class="op">=</span> [<span class="st">&#39;ALA&#39;</span>, <span class="st">&#39;VAL&#39;</span>, <span class="st">&#39;LEU&#39;</span>, <span class="st">&#39;ILE&#39;</span>, <span class="st">&#39;PRO&#39;</span>, <span class="st">&#39;PHE&#39;</span>, <span class="st">&#39;CYS&#39;</span>]</a>
<a class="sourceLine" id="cb314-20" title="20">hydrophobic_res <span class="op">=</span> [res.index <span class="cf">for</span> res <span class="kw">in</span> top.residues <span class="cf">if</span> <span class="bu">str</span>(res)[</a>
<a class="sourceLine" id="cb314-21" title="21">    :<span class="dv">3</span>] <span class="kw">in</span> hp_res_list]</a>
<a class="sourceLine" id="cb314-22" title="22"><span class="bu">print</span>(hydrophobic_res)</a>
<a class="sourceLine" id="cb314-23" title="23">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> get_hydrophobic_residues(os.path.join(</a>
<a class="sourceLine" id="cb314-24" title="24">    _FILE_DIR_, <span class="st">&#39;e22g.pdb&#39;</span>)) <span class="op">==</span> hydrophobic_res <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-28">Run 3</h4>
<div class="sourceCode" id="cb316"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb316-1" title="1"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb316-2" title="2"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb316-3" title="3"></a>
<a class="sourceLine" id="cb316-4" title="4"><span class="kw">def</span> get_hydrophobic_residues(pdb_filename):</a>
<a class="sourceLine" id="cb316-5" title="5">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb316-6" title="6"><span class="co">  Returns list of hydrophobic residues indices</span></a>
<a class="sourceLine" id="cb316-7" title="7"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb316-8" title="8">  traj <span class="op">=</span> md.load(pdb_filename)</a>
<a class="sourceLine" id="cb316-9" title="9">  resids <span class="op">=</span> []</a>
<a class="sourceLine" id="cb316-10" title="10">  <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(traj.n_residues):</a>
<a class="sourceLine" id="cb316-11" title="11">    <span class="cf">if</span> traj.topology.residue(i).is_hydrophobic:</a>
<a class="sourceLine" id="cb316-12" title="12">      resids.append(i)</a>
<a class="sourceLine" id="cb316-13" title="13">  <span class="cf">return</span> resids</a>
<a class="sourceLine" id="cb316-14" title="14"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb316-15" title="15">t <span class="op">=</span> md.load(os.path.join(_FILE_DIR_, <span class="st">&#39;e22g.pdb&#39;</span>))</a>
<a class="sourceLine" id="cb316-16" title="16">top <span class="op">=</span> t.topology</a>
<a class="sourceLine" id="cb316-17" title="17">hp_res_list <span class="op">=</span> [<span class="st">&#39;ALA&#39;</span>, <span class="st">&#39;VAL&#39;</span>, <span class="st">&#39;LEU&#39;</span>, <span class="st">&#39;ILE&#39;</span>, <span class="st">&#39;PRO&#39;</span>, <span class="st">&#39;PHE&#39;</span>, <span class="st">&#39;CYS&#39;</span>]</a>
<a class="sourceLine" id="cb316-18" title="18">hydrophobic_res <span class="op">=</span> [res.index <span class="cf">for</span> res <span class="kw">in</span> top.residues <span class="cf">if</span> <span class="bu">str</span>(res)[</a>
<a class="sourceLine" id="cb316-19" title="19">    :<span class="dv">3</span>] <span class="kw">in</span> hp_res_list]</a>
<a class="sourceLine" id="cb316-20" title="20"><span class="bu">print</span>(hydrophobic_res)</a>
<a class="sourceLine" id="cb316-21" title="21">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> get_hydrophobic_residues(os.path.join(</a>
<a class="sourceLine" id="cb316-22" title="22">    _FILE_DIR_, <span class="st">&#39;e22g.pdb&#39;</span>)) <span class="op">==</span> hydrophobic_res <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>&#39;Residue&#39; object has no attribute &#39;is_hydrophobic&#39;</code></pre>
<h4 id="run-4-28">Run 4</h4>
<div class="sourceCode" id="cb318"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb318-1" title="1"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb318-2" title="2"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb318-3" title="3"></a>
<a class="sourceLine" id="cb318-4" title="4"><span class="kw">def</span> get_hydrophobic_residues(pdb_filename):</a>
<a class="sourceLine" id="cb318-5" title="5">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb318-6" title="6"><span class="co">  Returns list of hydrophobic residues indices</span></a>
<a class="sourceLine" id="cb318-7" title="7"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb318-8" title="8">  traj <span class="op">=</span> md.load(pdb_filename)</a>
<a class="sourceLine" id="cb318-9" title="9">  resids <span class="op">=</span> []</a>
<a class="sourceLine" id="cb318-10" title="10">  <span class="cf">for</span> i, res <span class="kw">in</span> <span class="bu">enumerate</span>(traj.topology.residues):</a>
<a class="sourceLine" id="cb318-11" title="11">    <span class="cf">if</span> res.is_water:</a>
<a class="sourceLine" id="cb318-12" title="12">      <span class="cf">continue</span></a>
<a class="sourceLine" id="cb318-13" title="13">    <span class="cf">if</span> res.name <span class="kw">in</span> [<span class="st">&#39;ALA&#39;</span>, <span class="st">&#39;ILE&#39;</span>, <span class="st">&#39;LEU&#39;</span>, <span class="st">&#39;PHE&#39;</span>, <span class="st">&#39;VAL&#39;</span>, <span class="st">&#39;TRP&#39;</span>, <span class="st">&#39;TYR&#39;</span>]:</a>
<a class="sourceLine" id="cb318-14" title="14">      resids.append(i)</a>
<a class="sourceLine" id="cb318-15" title="15">  <span class="cf">return</span> resids</a>
<a class="sourceLine" id="cb318-16" title="16"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb318-17" title="17">t <span class="op">=</span> md.load(os.path.join(_FILE_DIR_, <span class="st">&#39;e22g.pdb&#39;</span>))</a>
<a class="sourceLine" id="cb318-18" title="18">top <span class="op">=</span> t.topology</a>
<a class="sourceLine" id="cb318-19" title="19">hp_res_list <span class="op">=</span> [<span class="st">&#39;ALA&#39;</span>, <span class="st">&#39;VAL&#39;</span>, <span class="st">&#39;LEU&#39;</span>, <span class="st">&#39;ILE&#39;</span>, <span class="st">&#39;PRO&#39;</span>, <span class="st">&#39;PHE&#39;</span>, <span class="st">&#39;CYS&#39;</span>]</a>
<a class="sourceLine" id="cb318-20" title="20">hydrophobic_res <span class="op">=</span> [res.index <span class="cf">for</span> res <span class="kw">in</span> top.residues <span class="cf">if</span> <span class="bu">str</span>(res)[</a>
<a class="sourceLine" id="cb318-21" title="21">    :<span class="dv">3</span>] <span class="kw">in</span> hp_res_list]</a>
<a class="sourceLine" id="cb318-22" title="22"><span class="bu">print</span>(hydrophobic_res)</a>
<a class="sourceLine" id="cb318-23" title="23">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> get_hydrophobic_residues(os.path.join(</a>
<a class="sourceLine" id="cb318-24" title="24">    _FILE_DIR_, <span class="st">&#39;e22g.pdb&#39;</span>)) <span class="op">==</span> hydrophobic_res <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>ideal_gas</summary></p>
<h4 id="query-29">Query</h4>
<div class="sourceCode" id="cb320"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb320-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb320-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb320-3" title="3"></a>
<a class="sourceLine" id="cb320-4" title="4"><span class="kw">def</span> ideal_gas_pressure(n,V,T):</a>
<a class="sourceLine" id="cb320-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb320-6" title="6"><span class="co">   This function returns the pressure for n moles of an ideal gas at temperature T and volume V, using the ideal gas equation of state.</span></a>
<a class="sourceLine" id="cb320-7" title="7"><span class="co">   The pressure returned is in atm units.</span></a>
<a class="sourceLine" id="cb320-8" title="8"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb320-9" title="9">   [insert]</a>
<a class="sourceLine" id="cb320-10" title="10">   <span class="cf">return</span> P</a></code></pre></div>
<h4 id="run-0-29">Run 0</h4>
<div class="sourceCode" id="cb321"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb321-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb321-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb321-3" title="3"></a>
<a class="sourceLine" id="cb321-4" title="4"><span class="kw">def</span> ideal_gas_pressure(n,V,T):</a>
<a class="sourceLine" id="cb321-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb321-6" title="6"><span class="co">   This function returns the pressure for n moles of an ideal gas at temperature T and volume V, using the ideal gas equation of state.</span></a>
<a class="sourceLine" id="cb321-7" title="7"><span class="co">   The pressure returned is in atm units.</span></a>
<a class="sourceLine" id="cb321-8" title="8"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb321-9" title="9">   R <span class="op">=</span> <span class="fl">0.08205746</span> <span class="co">#atm*L/mol/K</span></a>
<a class="sourceLine" id="cb321-10" title="10">   P <span class="op">=</span> n<span class="op">*</span>R<span class="op">*</span>T<span class="op">/</span>V</a>
<a class="sourceLine" id="cb321-11" title="11">   <span class="cf">return</span> P</a>
<a class="sourceLine" id="cb321-12" title="12"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb321-13" title="13"></a>
<a class="sourceLine" id="cb321-14" title="14"><span class="co"># input</span></a>
<a class="sourceLine" id="cb321-15" title="15">V <span class="op">=</span> <span class="fl">20.0</span>    <span class="co"># volume (in L)</span></a>
<a class="sourceLine" id="cb321-16" title="16">n <span class="op">=</span> <span class="fl">10.0</span>    <span class="co"># in moles</span></a>
<a class="sourceLine" id="cb321-17" title="17">R <span class="op">=</span> <span class="fl">0.08206</span>  <span class="co"># in L.atm/mol.K</span></a>
<a class="sourceLine" id="cb321-18" title="18">T <span class="op">=</span> <span class="dv">350</span>     <span class="co"># in K </span></a>
<a class="sourceLine" id="cb321-19" title="19"></a>
<a class="sourceLine" id="cb321-20" title="20">P <span class="op">=</span> n<span class="op">*</span>R<span class="op">*</span>T<span class="op">/</span>V</a>
<a class="sourceLine" id="cb321-21" title="21"><span class="co">#print(&quot;Pressure =&quot;, P)</span></a>
<a class="sourceLine" id="cb321-22" title="22"></a>
<a class="sourceLine" id="cb321-23" title="23">codex_pressure <span class="op">=</span> ideal_gas_pressure(n,V,T)</a>
<a class="sourceLine" id="cb321-24" title="24"><span class="co">#print(&quot;Codex pressure =&quot;, codex_pressure)</span></a>
<a class="sourceLine" id="cb321-25" title="25"><span class="co"># check </span></a>
<a class="sourceLine" id="cb321-26" title="26"><span class="cf">if</span> np.isclose(P, codex_pressure, rtol<span class="op">=</span><span class="fl">0.01</span>) <span class="op">==</span> <span class="va">True</span>:</a>
<a class="sourceLine" id="cb321-27" title="27">    result <span class="op">=</span> <span class="va">True</span> </a>
<a class="sourceLine" id="cb321-28" title="28"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb321-29" title="29">    result <span class="op">=</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-29">Run 1</h4>
<div class="sourceCode" id="cb323"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb323-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb323-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb323-3" title="3"></a>
<a class="sourceLine" id="cb323-4" title="4"><span class="kw">def</span> ideal_gas_pressure(n,V,T):</a>
<a class="sourceLine" id="cb323-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb323-6" title="6"><span class="co">   This function returns the pressure for n moles of an ideal gas at temperature T and volume V, using the ideal gas equation of state.</span></a>
<a class="sourceLine" id="cb323-7" title="7"><span class="co">   The pressure returned is in atm units.</span></a>
<a class="sourceLine" id="cb323-8" title="8"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb323-9" title="9">   R <span class="op">=</span> <span class="fl">0.08205746</span> <span class="co"># atm L / mol K</span></a>
<a class="sourceLine" id="cb323-10" title="10">   P <span class="op">=</span> (n<span class="op">*</span>R<span class="op">*</span>T)<span class="op">/</span>V</a>
<a class="sourceLine" id="cb323-11" title="11">   <span class="cf">return</span> P</a>
<a class="sourceLine" id="cb323-12" title="12"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb323-13" title="13"></a>
<a class="sourceLine" id="cb323-14" title="14"><span class="co"># input</span></a>
<a class="sourceLine" id="cb323-15" title="15">V <span class="op">=</span> <span class="fl">20.0</span>    <span class="co"># volume (in L)</span></a>
<a class="sourceLine" id="cb323-16" title="16">n <span class="op">=</span> <span class="fl">10.0</span>    <span class="co"># in moles</span></a>
<a class="sourceLine" id="cb323-17" title="17">R <span class="op">=</span> <span class="fl">0.08206</span>  <span class="co"># in L.atm/mol.K</span></a>
<a class="sourceLine" id="cb323-18" title="18">T <span class="op">=</span> <span class="dv">350</span>     <span class="co"># in K </span></a>
<a class="sourceLine" id="cb323-19" title="19"></a>
<a class="sourceLine" id="cb323-20" title="20">P <span class="op">=</span> n<span class="op">*</span>R<span class="op">*</span>T<span class="op">/</span>V</a>
<a class="sourceLine" id="cb323-21" title="21"><span class="co">#print(&quot;Pressure =&quot;, P)</span></a>
<a class="sourceLine" id="cb323-22" title="22"></a>
<a class="sourceLine" id="cb323-23" title="23">codex_pressure <span class="op">=</span> ideal_gas_pressure(n,V,T)</a>
<a class="sourceLine" id="cb323-24" title="24"><span class="co">#print(&quot;Codex pressure =&quot;, codex_pressure)</span></a>
<a class="sourceLine" id="cb323-25" title="25"><span class="co"># check </span></a>
<a class="sourceLine" id="cb323-26" title="26"><span class="cf">if</span> np.isclose(P, codex_pressure, rtol<span class="op">=</span><span class="fl">0.01</span>) <span class="op">==</span> <span class="va">True</span>:</a>
<a class="sourceLine" id="cb323-27" title="27">    result <span class="op">=</span> <span class="va">True</span> </a>
<a class="sourceLine" id="cb323-28" title="28"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb323-29" title="29">    result <span class="op">=</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-29">Run 2</h4>
<div class="sourceCode" id="cb325"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb325-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb325-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb325-3" title="3"></a>
<a class="sourceLine" id="cb325-4" title="4"><span class="kw">def</span> ideal_gas_pressure(n,V,T):</a>
<a class="sourceLine" id="cb325-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb325-6" title="6"><span class="co">   This function returns the pressure for n moles of an ideal gas at temperature T and volume V, using the ideal gas equation of state.</span></a>
<a class="sourceLine" id="cb325-7" title="7"><span class="co">   The pressure returned is in atm units.</span></a>
<a class="sourceLine" id="cb325-8" title="8"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb325-9" title="9">   R <span class="op">=</span> <span class="fl">0.0821</span> <span class="co"># atm L / mol K</span></a>
<a class="sourceLine" id="cb325-10" title="10">   P <span class="op">=</span> (n<span class="op">*</span>R<span class="op">*</span>T)<span class="op">/</span>V</a>
<a class="sourceLine" id="cb325-11" title="11">   <span class="cf">return</span> P</a>
<a class="sourceLine" id="cb325-12" title="12"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb325-13" title="13"></a>
<a class="sourceLine" id="cb325-14" title="14"><span class="co"># input</span></a>
<a class="sourceLine" id="cb325-15" title="15">V <span class="op">=</span> <span class="fl">20.0</span>    <span class="co"># volume (in L)</span></a>
<a class="sourceLine" id="cb325-16" title="16">n <span class="op">=</span> <span class="fl">10.0</span>    <span class="co"># in moles</span></a>
<a class="sourceLine" id="cb325-17" title="17">R <span class="op">=</span> <span class="fl">0.08206</span>  <span class="co"># in L.atm/mol.K</span></a>
<a class="sourceLine" id="cb325-18" title="18">T <span class="op">=</span> <span class="dv">350</span>     <span class="co"># in K </span></a>
<a class="sourceLine" id="cb325-19" title="19"></a>
<a class="sourceLine" id="cb325-20" title="20">P <span class="op">=</span> n<span class="op">*</span>R<span class="op">*</span>T<span class="op">/</span>V</a>
<a class="sourceLine" id="cb325-21" title="21"><span class="co">#print(&quot;Pressure =&quot;, P)</span></a>
<a class="sourceLine" id="cb325-22" title="22"></a>
<a class="sourceLine" id="cb325-23" title="23">codex_pressure <span class="op">=</span> ideal_gas_pressure(n,V,T)</a>
<a class="sourceLine" id="cb325-24" title="24"><span class="co">#print(&quot;Codex pressure =&quot;, codex_pressure)</span></a>
<a class="sourceLine" id="cb325-25" title="25"><span class="co"># check </span></a>
<a class="sourceLine" id="cb325-26" title="26"><span class="cf">if</span> np.isclose(P, codex_pressure, rtol<span class="op">=</span><span class="fl">0.01</span>) <span class="op">==</span> <span class="va">True</span>:</a>
<a class="sourceLine" id="cb325-27" title="27">    result <span class="op">=</span> <span class="va">True</span> </a>
<a class="sourceLine" id="cb325-28" title="28"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb325-29" title="29">    result <span class="op">=</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-29">Run 3</h4>
<div class="sourceCode" id="cb327"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb327-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb327-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb327-3" title="3"></a>
<a class="sourceLine" id="cb327-4" title="4"><span class="kw">def</span> ideal_gas_pressure(n,V,T):</a>
<a class="sourceLine" id="cb327-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb327-6" title="6"><span class="co">   This function returns the pressure for n moles of an ideal gas at temperature T and volume V, using the ideal gas equation of state.</span></a>
<a class="sourceLine" id="cb327-7" title="7"><span class="co">   The pressure returned is in atm units.</span></a>
<a class="sourceLine" id="cb327-8" title="8"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb327-9" title="9">   R <span class="op">=</span> <span class="fl">0.0821</span> <span class="co"># atm L / mol K</span></a>
<a class="sourceLine" id="cb327-10" title="10">   P <span class="op">=</span> (n <span class="op">*</span> R <span class="op">*</span> T) <span class="op">/</span> V</a>
<a class="sourceLine" id="cb327-11" title="11">   <span class="cf">return</span> P</a>
<a class="sourceLine" id="cb327-12" title="12"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb327-13" title="13"></a>
<a class="sourceLine" id="cb327-14" title="14"><span class="co"># input</span></a>
<a class="sourceLine" id="cb327-15" title="15">V <span class="op">=</span> <span class="fl">20.0</span>    <span class="co"># volume (in L)</span></a>
<a class="sourceLine" id="cb327-16" title="16">n <span class="op">=</span> <span class="fl">10.0</span>    <span class="co"># in moles</span></a>
<a class="sourceLine" id="cb327-17" title="17">R <span class="op">=</span> <span class="fl">0.08206</span>  <span class="co"># in L.atm/mol.K</span></a>
<a class="sourceLine" id="cb327-18" title="18">T <span class="op">=</span> <span class="dv">350</span>     <span class="co"># in K </span></a>
<a class="sourceLine" id="cb327-19" title="19"></a>
<a class="sourceLine" id="cb327-20" title="20">P <span class="op">=</span> n<span class="op">*</span>R<span class="op">*</span>T<span class="op">/</span>V</a>
<a class="sourceLine" id="cb327-21" title="21"><span class="co">#print(&quot;Pressure =&quot;, P)</span></a>
<a class="sourceLine" id="cb327-22" title="22"></a>
<a class="sourceLine" id="cb327-23" title="23">codex_pressure <span class="op">=</span> ideal_gas_pressure(n,V,T)</a>
<a class="sourceLine" id="cb327-24" title="24"><span class="co">#print(&quot;Codex pressure =&quot;, codex_pressure)</span></a>
<a class="sourceLine" id="cb327-25" title="25"><span class="co"># check </span></a>
<a class="sourceLine" id="cb327-26" title="26"><span class="cf">if</span> np.isclose(P, codex_pressure, rtol<span class="op">=</span><span class="fl">0.01</span>) <span class="op">==</span> <span class="va">True</span>:</a>
<a class="sourceLine" id="cb327-27" title="27">    result <span class="op">=</span> <span class="va">True</span> </a>
<a class="sourceLine" id="cb327-28" title="28"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb327-29" title="29">    result <span class="op">=</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-29">Run 4</h4>
<div class="sourceCode" id="cb329"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb329-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb329-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb329-3" title="3"></a>
<a class="sourceLine" id="cb329-4" title="4"><span class="kw">def</span> ideal_gas_pressure(n,V,T):</a>
<a class="sourceLine" id="cb329-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb329-6" title="6"><span class="co">   This function returns the pressure for n moles of an ideal gas at temperature T and volume V, using the ideal gas equation of state.</span></a>
<a class="sourceLine" id="cb329-7" title="7"><span class="co">   The pressure returned is in atm units.</span></a>
<a class="sourceLine" id="cb329-8" title="8"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb329-9" title="9">   R <span class="op">=</span> <span class="fl">0.08206</span> <span class="co">#atm L / mol K</span></a>
<a class="sourceLine" id="cb329-10" title="10">   P <span class="op">=</span> (n<span class="op">*</span>R<span class="op">*</span>T)<span class="op">/</span>V</a>
<a class="sourceLine" id="cb329-11" title="11">   <span class="cf">return</span> P</a>
<a class="sourceLine" id="cb329-12" title="12"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb329-13" title="13"></a>
<a class="sourceLine" id="cb329-14" title="14"><span class="co"># input</span></a>
<a class="sourceLine" id="cb329-15" title="15">V <span class="op">=</span> <span class="fl">20.0</span>    <span class="co"># volume (in L)</span></a>
<a class="sourceLine" id="cb329-16" title="16">n <span class="op">=</span> <span class="fl">10.0</span>    <span class="co"># in moles</span></a>
<a class="sourceLine" id="cb329-17" title="17">R <span class="op">=</span> <span class="fl">0.08206</span>  <span class="co"># in L.atm/mol.K</span></a>
<a class="sourceLine" id="cb329-18" title="18">T <span class="op">=</span> <span class="dv">350</span>     <span class="co"># in K </span></a>
<a class="sourceLine" id="cb329-19" title="19"></a>
<a class="sourceLine" id="cb329-20" title="20">P <span class="op">=</span> n<span class="op">*</span>R<span class="op">*</span>T<span class="op">/</span>V</a>
<a class="sourceLine" id="cb329-21" title="21"><span class="co">#print(&quot;Pressure =&quot;, P)</span></a>
<a class="sourceLine" id="cb329-22" title="22"></a>
<a class="sourceLine" id="cb329-23" title="23">codex_pressure <span class="op">=</span> ideal_gas_pressure(n,V,T)</a>
<a class="sourceLine" id="cb329-24" title="24"><span class="co">#print(&quot;Codex pressure =&quot;, codex_pressure)</span></a>
<a class="sourceLine" id="cb329-25" title="25"><span class="co"># check </span></a>
<a class="sourceLine" id="cb329-26" title="26"><span class="cf">if</span> np.isclose(P, codex_pressure, rtol<span class="op">=</span><span class="fl">0.01</span>) <span class="op">==</span> <span class="va">True</span>:</a>
<a class="sourceLine" id="cb329-27" title="27">    result <span class="op">=</span> <span class="va">True</span> </a>
<a class="sourceLine" id="cb329-28" title="28"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb329-29" title="29">    result <span class="op">=</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>integral</summary></p>
<h4 id="query-30">Query</h4>
<div class="sourceCode" id="cb331"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb331-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb331-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb331-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb331-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb331-5" title="5"></a>
<a class="sourceLine" id="cb331-6" title="6"><span class="kw">def</span> find_integral(a,b,c,d):</a>
<a class="sourceLine" id="cb331-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb331-8" title="8"><span class="co">  This function generates a one dimensional polynomial with coefficients a,b,c,d and returns its integral.</span></a>
<a class="sourceLine" id="cb331-9" title="9"></a>
<a class="sourceLine" id="cb331-10" title="10"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb331-11" title="11">  [insert]</a>
<a class="sourceLine" id="cb331-12" title="12">  <span class="cf">return</span> integral</a></code></pre></div>
<h4 id="run-0-30">Run 0</h4>
<div class="sourceCode" id="cb332"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb332-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb332-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb332-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb332-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb332-5" title="5"></a>
<a class="sourceLine" id="cb332-6" title="6"><span class="kw">def</span> find_integral(a,b,c,d):</a>
<a class="sourceLine" id="cb332-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb332-8" title="8"><span class="co">  This function generates a one dimensional polynomial with coefficients a,b,c,d and returns its integral.</span></a>
<a class="sourceLine" id="cb332-9" title="9"></a>
<a class="sourceLine" id="cb332-10" title="10"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb332-11" title="11">  x <span class="op">=</span> np.linspace(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1000</span>)</a>
<a class="sourceLine" id="cb332-12" title="12">  y <span class="op">=</span> a<span class="op">*</span>x<span class="op">**</span><span class="dv">3</span> <span class="op">+</span> b<span class="op">*</span>x<span class="op">**</span><span class="dv">2</span> <span class="op">+</span> c<span class="op">*</span>x <span class="op">+</span> d</a>
<a class="sourceLine" id="cb332-13" title="13">  integral <span class="op">=</span> np.trapz(y,x)</a>
<a class="sourceLine" id="cb332-14" title="14"></a>
<a class="sourceLine" id="cb332-15" title="15">  <span class="cf">return</span> integral</a>
<a class="sourceLine" id="cb332-16" title="16"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb332-17" title="17"></a>
<a class="sourceLine" id="cb332-18" title="18">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> find_integral(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>) <span class="op">==</span> np.poly1d([<span class="dv">1</span><span class="op">/</span><span class="dv">4</span>, <span class="dv">2</span><span class="op">/</span><span class="dv">3</span>, <span class="dv">3</span><span class="op">/</span><span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">0</span>]) <span class="cf">else</span> <span class="va">False</span> </a></code></pre></div>
<p>Output:</p>
<pre><code>The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()</code></pre>
<h4 id="run-1-30">Run 1</h4>
<div class="sourceCode" id="cb334"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb334-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb334-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb334-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb334-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb334-5" title="5"></a>
<a class="sourceLine" id="cb334-6" title="6"><span class="kw">def</span> find_integral(a,b,c,d):</a>
<a class="sourceLine" id="cb334-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb334-8" title="8"><span class="co">  This function generates a one dimensional polynomial with coefficients a,b,c,d and returns its integral.</span></a>
<a class="sourceLine" id="cb334-9" title="9"></a>
<a class="sourceLine" id="cb334-10" title="10"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb334-11" title="11">  x <span class="op">=</span> np.linspace(<span class="dv">0</span>,<span class="dv">10</span>,<span class="dv">100</span>)</a>
<a class="sourceLine" id="cb334-12" title="12">  y <span class="op">=</span> a<span class="op">*</span>x<span class="op">**</span><span class="dv">3</span> <span class="op">+</span> b<span class="op">*</span>x<span class="op">**</span><span class="dv">2</span> <span class="op">+</span> c<span class="op">*</span>x <span class="op">+</span> d</a>
<a class="sourceLine" id="cb334-13" title="13">  integral <span class="op">=</span> np.trapz(y,x)</a>
<a class="sourceLine" id="cb334-14" title="14">  <span class="cf">return</span> integral</a>
<a class="sourceLine" id="cb334-15" title="15"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb334-16" title="16"></a>
<a class="sourceLine" id="cb334-17" title="17">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> find_integral(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>) <span class="op">==</span> np.poly1d([<span class="dv">1</span><span class="op">/</span><span class="dv">4</span>, <span class="dv">2</span><span class="op">/</span><span class="dv">3</span>, <span class="dv">3</span><span class="op">/</span><span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">0</span>]) <span class="cf">else</span> <span class="va">False</span> </a></code></pre></div>
<p>Output:</p>
<pre><code>The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()</code></pre>
<h4 id="run-2-30">Run 2</h4>
<div class="sourceCode" id="cb336"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb336-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb336-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb336-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb336-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb336-5" title="5"></a>
<a class="sourceLine" id="cb336-6" title="6"><span class="kw">def</span> find_integral(a,b,c,d):</a>
<a class="sourceLine" id="cb336-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb336-8" title="8"><span class="co">  This function generates a one dimensional polynomial with coefficients a,b,c,d and returns its integral.</span></a>
<a class="sourceLine" id="cb336-9" title="9"></a>
<a class="sourceLine" id="cb336-10" title="10"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb336-11" title="11">  x <span class="op">=</span> np.linspace(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">100</span>)</a>
<a class="sourceLine" id="cb336-12" title="12">  y <span class="op">=</span> a<span class="op">*</span>x<span class="op">**</span><span class="dv">3</span> <span class="op">+</span> b<span class="op">*</span>x<span class="op">**</span><span class="dv">2</span> <span class="op">+</span> c<span class="op">*</span>x <span class="op">+</span> d</a>
<a class="sourceLine" id="cb336-13" title="13">  integral <span class="op">=</span> np.trapz(y,x)</a>
<a class="sourceLine" id="cb336-14" title="14">  <span class="cf">return</span> integral</a>
<a class="sourceLine" id="cb336-15" title="15"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb336-16" title="16"></a>
<a class="sourceLine" id="cb336-17" title="17">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> find_integral(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>) <span class="op">==</span> np.poly1d([<span class="dv">1</span><span class="op">/</span><span class="dv">4</span>, <span class="dv">2</span><span class="op">/</span><span class="dv">3</span>, <span class="dv">3</span><span class="op">/</span><span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">0</span>]) <span class="cf">else</span> <span class="va">False</span> </a></code></pre></div>
<p>Output:</p>
<pre><code>The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()</code></pre>
<h4 id="run-3-30">Run 3</h4>
<div class="sourceCode" id="cb338"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb338-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb338-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb338-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb338-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb338-5" title="5"></a>
<a class="sourceLine" id="cb338-6" title="6"><span class="kw">def</span> find_integral(a,b,c,d):</a>
<a class="sourceLine" id="cb338-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb338-8" title="8"><span class="co">  This function generates a one dimensional polynomial with coefficients a,b,c,d and returns its integral.</span></a>
<a class="sourceLine" id="cb338-9" title="9"></a>
<a class="sourceLine" id="cb338-10" title="10"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb338-11" title="11">  x <span class="op">=</span> np.linspace(<span class="op">-</span><span class="dv">10</span>,<span class="dv">10</span>,<span class="dv">100</span>)</a>
<a class="sourceLine" id="cb338-12" title="12">  y <span class="op">=</span> a<span class="op">*</span>x<span class="op">**</span><span class="dv">3</span> <span class="op">+</span> b<span class="op">*</span>x<span class="op">**</span><span class="dv">2</span> <span class="op">+</span> c<span class="op">*</span>x <span class="op">+</span> d</a>
<a class="sourceLine" id="cb338-13" title="13">  integral <span class="op">=</span> np.trapz(y,x)</a>
<a class="sourceLine" id="cb338-14" title="14">  <span class="cf">return</span> integral</a>
<a class="sourceLine" id="cb338-15" title="15"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb338-16" title="16"></a>
<a class="sourceLine" id="cb338-17" title="17">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> find_integral(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>) <span class="op">==</span> np.poly1d([<span class="dv">1</span><span class="op">/</span><span class="dv">4</span>, <span class="dv">2</span><span class="op">/</span><span class="dv">3</span>, <span class="dv">3</span><span class="op">/</span><span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">0</span>]) <span class="cf">else</span> <span class="va">False</span> </a></code></pre></div>
<p>Output:</p>
<pre><code>The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()</code></pre>
<h4 id="run-4-30">Run 4</h4>
<div class="sourceCode" id="cb340"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb340-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb340-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb340-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb340-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb340-5" title="5"></a>
<a class="sourceLine" id="cb340-6" title="6"><span class="kw">def</span> find_integral(a,b,c,d):</a>
<a class="sourceLine" id="cb340-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb340-8" title="8"><span class="co">  This function generates a one dimensional polynomial with coefficients a,b,c,d and returns its integral.</span></a>
<a class="sourceLine" id="cb340-9" title="9"></a>
<a class="sourceLine" id="cb340-10" title="10"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb340-11" title="11">  integral <span class="op">=</span> (a<span class="op">/</span><span class="dv">4</span>)<span class="op">*</span>(b<span class="op">**</span><span class="dv">4</span>) <span class="op">-</span> (b<span class="op">*</span>c<span class="op">/</span><span class="dv">3</span>) <span class="op">+</span> (d<span class="op">/</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb340-12" title="12">  <span class="cf">return</span> integral</a>
<a class="sourceLine" id="cb340-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb340-14" title="14"></a>
<a class="sourceLine" id="cb340-15" title="15">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> find_integral(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>) <span class="op">==</span> np.poly1d([<span class="dv">1</span><span class="op">/</span><span class="dv">4</span>, <span class="dv">2</span><span class="op">/</span><span class="dv">3</span>, <span class="dv">3</span><span class="op">/</span><span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">0</span>]) <span class="cf">else</span> <span class="va">False</span> </a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>trap</summary></p>
<h4 id="query-31">Query</h4>
<div class="sourceCode" id="cb342"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb342-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb342-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb342-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb342-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb342-5" title="5"></a>
<a class="sourceLine" id="cb342-6" title="6"><span class="kw">def</span> trap(f, n, a, b):</a>
<a class="sourceLine" id="cb342-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb342-8" title="8"><span class="co">  This function evaluates the integral of a univariate function f from a to b with n itervals using the composite trapezoidal rule.</span></a>
<a class="sourceLine" id="cb342-9" title="9"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb342-10" title="10">  [insert]</a>
<a class="sourceLine" id="cb342-11" title="11">  <span class="cf">return</span> integral</a></code></pre></div>
<h4 id="run-0-31">Run 0</h4>
<div class="sourceCode" id="cb343"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb343-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb343-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb343-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb343-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb343-5" title="5"></a>
<a class="sourceLine" id="cb343-6" title="6"><span class="kw">def</span> trap(f, n, a, b):</a>
<a class="sourceLine" id="cb343-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb343-8" title="8"><span class="co">  This function evaluates the integral of a univariate function f from a to b with n itervals using the composite trapezoidal rule.</span></a>
<a class="sourceLine" id="cb343-9" title="9"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb343-10" title="10">  h <span class="op">=</span> (b<span class="op">-</span>a)<span class="op">/</span>n</a>
<a class="sourceLine" id="cb343-11" title="11">  integral <span class="op">=</span> <span class="fl">0.5</span><span class="op">*</span>(f(a)<span class="op">+</span>f(b))</a>
<a class="sourceLine" id="cb343-12" title="12">  <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>,n):</a>
<a class="sourceLine" id="cb343-13" title="13">    integral <span class="op">+=</span> f(a<span class="op">+</span>i<span class="op">*</span>h)</a>
<a class="sourceLine" id="cb343-14" title="14">  integral <span class="op">*=</span> h</a>
<a class="sourceLine" id="cb343-15" title="15">  <span class="cf">return</span> integral</a>
<a class="sourceLine" id="cb343-16" title="16"><span class="im">import</span> numpy</a>
<a class="sourceLine" id="cb343-17" title="17"></a>
<a class="sourceLine" id="cb343-18" title="18"><span class="kw">def</span> f(x):</a>
<a class="sourceLine" id="cb343-19" title="19">    <span class="cf">return</span> x <span class="op">**</span> <span class="dv">4</span> <span class="op">*</span> np.log(x <span class="op">+</span> np.sqrt(x <span class="op">**</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">1</span>))</a>
<a class="sourceLine" id="cb343-20" title="20"></a>
<a class="sourceLine" id="cb343-21" title="21">a <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb343-22" title="22">b <span class="op">=</span> <span class="dv">5</span></a>
<a class="sourceLine" id="cb343-23" title="23">n <span class="op">=</span> <span class="dv">100</span></a>
<a class="sourceLine" id="cb343-24" title="24"></a>
<a class="sourceLine" id="cb343-25" title="25">x <span class="op">=</span> np.linspace(a,b,num<span class="op">=</span>n)</a>
<a class="sourceLine" id="cb343-26" title="26">test_intgr <span class="op">=</span> np.trapz(f(x), x<span class="op">=</span>x)</a>
<a class="sourceLine" id="cb343-27" title="27"></a>
<a class="sourceLine" id="cb343-28" title="28">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(trap(f,n,a,b),test_intgr) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-31">Run 1</h4>
<div class="sourceCode" id="cb345"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb345-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb345-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb345-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb345-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb345-5" title="5"></a>
<a class="sourceLine" id="cb345-6" title="6"><span class="kw">def</span> trap(f, n, a, b):</a>
<a class="sourceLine" id="cb345-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb345-8" title="8"><span class="co">  This function evaluates the integral of a univariate function f from a to b with n itervals using the composite trapezoidal rule.</span></a>
<a class="sourceLine" id="cb345-9" title="9"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb345-10" title="10">  h <span class="op">=</span> (b<span class="op">-</span>a)<span class="op">/</span>n</a>
<a class="sourceLine" id="cb345-11" title="11">  x <span class="op">=</span> np.linspace(a, b, n<span class="op">+</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb345-12" title="12">  integral <span class="op">=</span> h<span class="op">*</span>(<span class="fl">0.5</span><span class="op">*</span>f(x[<span class="dv">0</span>]) <span class="op">+</span> <span class="fl">0.5</span><span class="op">*</span>f(x[<span class="op">-</span><span class="dv">1</span>]) <span class="op">+</span> np.<span class="bu">sum</span>(f(x[<span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>])))</a>
<a class="sourceLine" id="cb345-13" title="13"></a>
<a class="sourceLine" id="cb345-14" title="14">  <span class="cf">return</span> integral</a>
<a class="sourceLine" id="cb345-15" title="15"><span class="im">import</span> numpy</a>
<a class="sourceLine" id="cb345-16" title="16"></a>
<a class="sourceLine" id="cb345-17" title="17"><span class="kw">def</span> f(x):</a>
<a class="sourceLine" id="cb345-18" title="18">    <span class="cf">return</span> x <span class="op">**</span> <span class="dv">4</span> <span class="op">*</span> np.log(x <span class="op">+</span> np.sqrt(x <span class="op">**</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">1</span>))</a>
<a class="sourceLine" id="cb345-19" title="19"></a>
<a class="sourceLine" id="cb345-20" title="20">a <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb345-21" title="21">b <span class="op">=</span> <span class="dv">5</span></a>
<a class="sourceLine" id="cb345-22" title="22">n <span class="op">=</span> <span class="dv">100</span></a>
<a class="sourceLine" id="cb345-23" title="23"></a>
<a class="sourceLine" id="cb345-24" title="24">x <span class="op">=</span> np.linspace(a,b,num<span class="op">=</span>n)</a>
<a class="sourceLine" id="cb345-25" title="25">test_intgr <span class="op">=</span> np.trapz(f(x), x<span class="op">=</span>x)</a>
<a class="sourceLine" id="cb345-26" title="26"></a>
<a class="sourceLine" id="cb345-27" title="27">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(trap(f,n,a,b),test_intgr) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-31">Run 2</h4>
<div class="sourceCode" id="cb347"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb347-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb347-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb347-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb347-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb347-5" title="5"></a>
<a class="sourceLine" id="cb347-6" title="6"><span class="kw">def</span> trap(f, n, a, b):</a>
<a class="sourceLine" id="cb347-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb347-8" title="8"><span class="co">  This function evaluates the integral of a univariate function f from a to b with n itervals using the composite trapezoidal rule.</span></a>
<a class="sourceLine" id="cb347-9" title="9"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb347-10" title="10">  h <span class="op">=</span> (b<span class="op">-</span>a)<span class="op">/</span>n</a>
<a class="sourceLine" id="cb347-11" title="11">  integral <span class="op">=</span> <span class="fl">0.5</span><span class="op">*</span>f(a) <span class="op">+</span> <span class="fl">0.5</span><span class="op">*</span>f(b)</a>
<a class="sourceLine" id="cb347-12" title="12">  <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>,n):</a>
<a class="sourceLine" id="cb347-13" title="13">    integral <span class="op">+=</span> f(a<span class="op">+</span>i<span class="op">*</span>h)</a>
<a class="sourceLine" id="cb347-14" title="14">  integral <span class="op">*=</span> h</a>
<a class="sourceLine" id="cb347-15" title="15"></a>
<a class="sourceLine" id="cb347-16" title="16">  <span class="cf">return</span> integral</a>
<a class="sourceLine" id="cb347-17" title="17"><span class="im">import</span> numpy</a>
<a class="sourceLine" id="cb347-18" title="18"></a>
<a class="sourceLine" id="cb347-19" title="19"><span class="kw">def</span> f(x):</a>
<a class="sourceLine" id="cb347-20" title="20">    <span class="cf">return</span> x <span class="op">**</span> <span class="dv">4</span> <span class="op">*</span> np.log(x <span class="op">+</span> np.sqrt(x <span class="op">**</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">1</span>))</a>
<a class="sourceLine" id="cb347-21" title="21"></a>
<a class="sourceLine" id="cb347-22" title="22">a <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb347-23" title="23">b <span class="op">=</span> <span class="dv">5</span></a>
<a class="sourceLine" id="cb347-24" title="24">n <span class="op">=</span> <span class="dv">100</span></a>
<a class="sourceLine" id="cb347-25" title="25"></a>
<a class="sourceLine" id="cb347-26" title="26">x <span class="op">=</span> np.linspace(a,b,num<span class="op">=</span>n)</a>
<a class="sourceLine" id="cb347-27" title="27">test_intgr <span class="op">=</span> np.trapz(f(x), x<span class="op">=</span>x)</a>
<a class="sourceLine" id="cb347-28" title="28"></a>
<a class="sourceLine" id="cb347-29" title="29">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(trap(f,n,a,b),test_intgr) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-31">Run 3</h4>
<div class="sourceCode" id="cb349"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb349-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb349-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb349-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb349-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb349-5" title="5"></a>
<a class="sourceLine" id="cb349-6" title="6"><span class="kw">def</span> trap(f, n, a, b):</a>
<a class="sourceLine" id="cb349-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb349-8" title="8"><span class="co">  This function evaluates the integral of a univariate function f from a to b with n itervals using the composite trapezoidal rule.</span></a>
<a class="sourceLine" id="cb349-9" title="9"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb349-10" title="10">  integral <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb349-11" title="11">  h <span class="op">=</span> (b<span class="op">-</span>a)<span class="op">/</span>n</a>
<a class="sourceLine" id="cb349-12" title="12">  <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, n):</a>
<a class="sourceLine" id="cb349-13" title="13">    integral <span class="op">+=</span> f(a <span class="op">+</span> i<span class="op">*</span>h)</a>
<a class="sourceLine" id="cb349-14" title="14">  integral <span class="op">=</span> (h<span class="op">/</span><span class="dv">2</span>)<span class="op">*</span>(f(a) <span class="op">+</span> <span class="dv">2</span><span class="op">*</span>integral <span class="op">+</span> f(b))</a>
<a class="sourceLine" id="cb349-15" title="15">  <span class="cf">return</span> integral</a>
<a class="sourceLine" id="cb349-16" title="16"><span class="im">import</span> numpy</a>
<a class="sourceLine" id="cb349-17" title="17"></a>
<a class="sourceLine" id="cb349-18" title="18"><span class="kw">def</span> f(x):</a>
<a class="sourceLine" id="cb349-19" title="19">    <span class="cf">return</span> x <span class="op">**</span> <span class="dv">4</span> <span class="op">*</span> np.log(x <span class="op">+</span> np.sqrt(x <span class="op">**</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">1</span>))</a>
<a class="sourceLine" id="cb349-20" title="20"></a>
<a class="sourceLine" id="cb349-21" title="21">a <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb349-22" title="22">b <span class="op">=</span> <span class="dv">5</span></a>
<a class="sourceLine" id="cb349-23" title="23">n <span class="op">=</span> <span class="dv">100</span></a>
<a class="sourceLine" id="cb349-24" title="24"></a>
<a class="sourceLine" id="cb349-25" title="25">x <span class="op">=</span> np.linspace(a,b,num<span class="op">=</span>n)</a>
<a class="sourceLine" id="cb349-26" title="26">test_intgr <span class="op">=</span> np.trapz(f(x), x<span class="op">=</span>x)</a>
<a class="sourceLine" id="cb349-27" title="27"></a>
<a class="sourceLine" id="cb349-28" title="28">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(trap(f,n,a,b),test_intgr) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-31">Run 4</h4>
<div class="sourceCode" id="cb351"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb351-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb351-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb351-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb351-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb351-5" title="5"></a>
<a class="sourceLine" id="cb351-6" title="6"><span class="kw">def</span> trap(f, n, a, b):</a>
<a class="sourceLine" id="cb351-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb351-8" title="8"><span class="co">  This function evaluates the integral of a univariate function f from a to b with n itervals using the composite trapezoidal rule.</span></a>
<a class="sourceLine" id="cb351-9" title="9"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb351-10" title="10">  x <span class="op">=</span> np.linspace(a, b, n<span class="op">+</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb351-11" title="11">  y <span class="op">=</span> f(x)</a>
<a class="sourceLine" id="cb351-12" title="12">  integral <span class="op">=</span> (b<span class="op">-</span>a)<span class="op">/</span>n<span class="op">*</span>(<span class="fl">0.5</span><span class="op">*</span>y[<span class="dv">0</span>] <span class="op">+</span> <span class="fl">0.5</span><span class="op">*</span>y[<span class="op">-</span><span class="dv">1</span>] <span class="op">+</span> np.<span class="bu">sum</span>(y[<span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>]))</a>
<a class="sourceLine" id="cb351-13" title="13">  <span class="cf">return</span> integral</a>
<a class="sourceLine" id="cb351-14" title="14"><span class="im">import</span> numpy</a>
<a class="sourceLine" id="cb351-15" title="15"></a>
<a class="sourceLine" id="cb351-16" title="16"><span class="kw">def</span> f(x):</a>
<a class="sourceLine" id="cb351-17" title="17">    <span class="cf">return</span> x <span class="op">**</span> <span class="dv">4</span> <span class="op">*</span> np.log(x <span class="op">+</span> np.sqrt(x <span class="op">**</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">1</span>))</a>
<a class="sourceLine" id="cb351-18" title="18"></a>
<a class="sourceLine" id="cb351-19" title="19">a <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb351-20" title="20">b <span class="op">=</span> <span class="dv">5</span></a>
<a class="sourceLine" id="cb351-21" title="21">n <span class="op">=</span> <span class="dv">100</span></a>
<a class="sourceLine" id="cb351-22" title="22"></a>
<a class="sourceLine" id="cb351-23" title="23">x <span class="op">=</span> np.linspace(a,b,num<span class="op">=</span>n)</a>
<a class="sourceLine" id="cb351-24" title="24">test_intgr <span class="op">=</span> np.trapz(f(x), x<span class="op">=</span>x)</a>
<a class="sourceLine" id="cb351-25" title="25"></a>
<a class="sourceLine" id="cb351-26" title="26">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(trap(f,n,a,b),test_intgr) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>invert_matrix</summary></p>
<h4 id="query-32">Query</h4>
<div class="sourceCode" id="cb353"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb353-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb353-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb353-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb353-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb353-5" title="5"></a>
<a class="sourceLine" id="cb353-6" title="6"><span class="kw">def</span> invert_matrix(A):</a>
<a class="sourceLine" id="cb353-7" title="7">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb353-8" title="8"><span class="co">    This function computes the inverse of matrix A</span></a>
<a class="sourceLine" id="cb353-9" title="9"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb353-10" title="10">    [insert]</a>
<a class="sourceLine" id="cb353-11" title="11">    <span class="cf">return</span> Ainv</a></code></pre></div>
<h4 id="run-0-32">Run 0</h4>
<div class="sourceCode" id="cb354"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb354-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb354-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb354-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb354-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb354-5" title="5"></a>
<a class="sourceLine" id="cb354-6" title="6"><span class="kw">def</span> invert_matrix(A):</a>
<a class="sourceLine" id="cb354-7" title="7">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb354-8" title="8"><span class="co">    This function computes the inverse of matrix A</span></a>
<a class="sourceLine" id="cb354-9" title="9"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb354-10" title="10">    Ainv <span class="op">=</span> np.linalg.inv(A)</a>
<a class="sourceLine" id="cb354-11" title="11">    <span class="cf">return</span> Ainv</a>
<a class="sourceLine" id="cb354-12" title="12"></a>
<a class="sourceLine" id="cb354-13" title="13"></a>
<a class="sourceLine" id="cb354-14" title="14"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb354-15" title="15"></a>
<a class="sourceLine" id="cb354-16" title="16">x <span class="op">=</span> np.array([[<span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>], [<span class="dv">2</span>,<span class="dv">6</span>]])</a>
<a class="sourceLine" id="cb354-17" title="17">m_i <span class="op">=</span> invert_matrix(x)</a>
<a class="sourceLine" id="cb354-18" title="18">x_i <span class="op">=</span> np.array([[<span class="fl">0.75</span>,<span class="fl">0.125</span>], [<span class="op">-</span><span class="fl">0.25</span>,<span class="fl">0.125</span>]])</a>
<a class="sourceLine" id="cb354-19" title="19"></a>
<a class="sourceLine" id="cb354-20" title="20">result <span class="op">=</span> np.array_equal(m_i,x_i)</a>
<a class="sourceLine" id="cb354-21" title="21"></a>
<a class="sourceLine" id="cb354-22" title="22"></a>
<a class="sourceLine" id="cb354-23" title="23"></a>
<a class="sourceLine" id="cb354-24" title="24"></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-32">Run 1</h4>
<div class="sourceCode" id="cb356"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb356-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb356-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb356-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb356-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb356-5" title="5"></a>
<a class="sourceLine" id="cb356-6" title="6"><span class="kw">def</span> invert_matrix(A):</a>
<a class="sourceLine" id="cb356-7" title="7">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb356-8" title="8"><span class="co">    This function computes the inverse of matrix A</span></a>
<a class="sourceLine" id="cb356-9" title="9"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb356-10" title="10">    Ainv <span class="op">=</span> np.linalg.inv(A)</a>
<a class="sourceLine" id="cb356-11" title="11">    <span class="cf">return</span> Ainv</a>
<a class="sourceLine" id="cb356-12" title="12"></a>
<a class="sourceLine" id="cb356-13" title="13"></a>
<a class="sourceLine" id="cb356-14" title="14"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb356-15" title="15"></a>
<a class="sourceLine" id="cb356-16" title="16">x <span class="op">=</span> np.array([[<span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>], [<span class="dv">2</span>,<span class="dv">6</span>]])</a>
<a class="sourceLine" id="cb356-17" title="17">m_i <span class="op">=</span> invert_matrix(x)</a>
<a class="sourceLine" id="cb356-18" title="18">x_i <span class="op">=</span> np.array([[<span class="fl">0.75</span>,<span class="fl">0.125</span>], [<span class="op">-</span><span class="fl">0.25</span>,<span class="fl">0.125</span>]])</a>
<a class="sourceLine" id="cb356-19" title="19"></a>
<a class="sourceLine" id="cb356-20" title="20">result <span class="op">=</span> np.array_equal(m_i,x_i)</a>
<a class="sourceLine" id="cb356-21" title="21"></a>
<a class="sourceLine" id="cb356-22" title="22"></a>
<a class="sourceLine" id="cb356-23" title="23"></a>
<a class="sourceLine" id="cb356-24" title="24"></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-32">Run 2</h4>
<div class="sourceCode" id="cb358"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb358-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb358-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb358-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb358-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb358-5" title="5"></a>
<a class="sourceLine" id="cb358-6" title="6"><span class="kw">def</span> invert_matrix(A):</a>
<a class="sourceLine" id="cb358-7" title="7">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb358-8" title="8"><span class="co">    This function computes the inverse of matrix A</span></a>
<a class="sourceLine" id="cb358-9" title="9"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb358-10" title="10">    Ainv <span class="op">=</span> np.linalg.inv(A)</a>
<a class="sourceLine" id="cb358-11" title="11">    <span class="cf">return</span> Ainv</a>
<a class="sourceLine" id="cb358-12" title="12"></a>
<a class="sourceLine" id="cb358-13" title="13"></a>
<a class="sourceLine" id="cb358-14" title="14"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb358-15" title="15"></a>
<a class="sourceLine" id="cb358-16" title="16">x <span class="op">=</span> np.array([[<span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>], [<span class="dv">2</span>,<span class="dv">6</span>]])</a>
<a class="sourceLine" id="cb358-17" title="17">m_i <span class="op">=</span> invert_matrix(x)</a>
<a class="sourceLine" id="cb358-18" title="18">x_i <span class="op">=</span> np.array([[<span class="fl">0.75</span>,<span class="fl">0.125</span>], [<span class="op">-</span><span class="fl">0.25</span>,<span class="fl">0.125</span>]])</a>
<a class="sourceLine" id="cb358-19" title="19"></a>
<a class="sourceLine" id="cb358-20" title="20">result <span class="op">=</span> np.array_equal(m_i,x_i)</a>
<a class="sourceLine" id="cb358-21" title="21"></a>
<a class="sourceLine" id="cb358-22" title="22"></a>
<a class="sourceLine" id="cb358-23" title="23"></a>
<a class="sourceLine" id="cb358-24" title="24"></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-32">Run 3</h4>
<div class="sourceCode" id="cb360"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb360-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb360-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb360-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb360-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb360-5" title="5"></a>
<a class="sourceLine" id="cb360-6" title="6"><span class="kw">def</span> invert_matrix(A):</a>
<a class="sourceLine" id="cb360-7" title="7">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb360-8" title="8"><span class="co">    This function computes the inverse of matrix A</span></a>
<a class="sourceLine" id="cb360-9" title="9"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb360-10" title="10">    Ainv <span class="op">=</span> np.linalg.inv(A)</a>
<a class="sourceLine" id="cb360-11" title="11">    <span class="cf">return</span> Ainv</a>
<a class="sourceLine" id="cb360-12" title="12"></a>
<a class="sourceLine" id="cb360-13" title="13"></a>
<a class="sourceLine" id="cb360-14" title="14"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb360-15" title="15"></a>
<a class="sourceLine" id="cb360-16" title="16">x <span class="op">=</span> np.array([[<span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>], [<span class="dv">2</span>,<span class="dv">6</span>]])</a>
<a class="sourceLine" id="cb360-17" title="17">m_i <span class="op">=</span> invert_matrix(x)</a>
<a class="sourceLine" id="cb360-18" title="18">x_i <span class="op">=</span> np.array([[<span class="fl">0.75</span>,<span class="fl">0.125</span>], [<span class="op">-</span><span class="fl">0.25</span>,<span class="fl">0.125</span>]])</a>
<a class="sourceLine" id="cb360-19" title="19"></a>
<a class="sourceLine" id="cb360-20" title="20">result <span class="op">=</span> np.array_equal(m_i,x_i)</a>
<a class="sourceLine" id="cb360-21" title="21"></a>
<a class="sourceLine" id="cb360-22" title="22"></a>
<a class="sourceLine" id="cb360-23" title="23"></a>
<a class="sourceLine" id="cb360-24" title="24"></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-32">Run 4</h4>
<div class="sourceCode" id="cb362"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb362-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb362-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb362-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb362-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb362-5" title="5"></a>
<a class="sourceLine" id="cb362-6" title="6"><span class="kw">def</span> invert_matrix(A):</a>
<a class="sourceLine" id="cb362-7" title="7">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb362-8" title="8"><span class="co">    This function computes the inverse of matrix A</span></a>
<a class="sourceLine" id="cb362-9" title="9"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb362-10" title="10">    Ainv <span class="op">=</span> np.linalg.inv(A)</a>
<a class="sourceLine" id="cb362-11" title="11">    <span class="cf">return</span> Ainv</a>
<a class="sourceLine" id="cb362-12" title="12"></a>
<a class="sourceLine" id="cb362-13" title="13"></a>
<a class="sourceLine" id="cb362-14" title="14"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb362-15" title="15"></a>
<a class="sourceLine" id="cb362-16" title="16">x <span class="op">=</span> np.array([[<span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>], [<span class="dv">2</span>,<span class="dv">6</span>]])</a>
<a class="sourceLine" id="cb362-17" title="17">m_i <span class="op">=</span> invert_matrix(x)</a>
<a class="sourceLine" id="cb362-18" title="18">x_i <span class="op">=</span> np.array([[<span class="fl">0.75</span>,<span class="fl">0.125</span>], [<span class="op">-</span><span class="fl">0.25</span>,<span class="fl">0.125</span>]])</a>
<a class="sourceLine" id="cb362-19" title="19"></a>
<a class="sourceLine" id="cb362-20" title="20">result <span class="op">=</span> np.array_equal(m_i,x_i)</a>
<a class="sourceLine" id="cb362-21" title="21"></a>
<a class="sourceLine" id="cb362-22" title="22"></a>
<a class="sourceLine" id="cb362-23" title="23"></a>
<a class="sourceLine" id="cb362-24" title="24"></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>iupac2smiles</summary></p>
<h4 id="query-33">Query</h4>
<div class="sourceCode" id="cb364"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb364-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb364-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb364-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb364-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb364-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb364-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb364-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb364-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb364-9" title="9"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb364-10" title="10"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb364-11" title="11"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb364-12" title="12"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb364-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb364-14" title="14"></a>
<a class="sourceLine" id="cb364-15" title="15"><span class="kw">def</span> iupac2smiles(IUPAC):</a>
<a class="sourceLine" id="cb364-16" title="16">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb364-17" title="17"><span class="co">    This function takes in the IUPAC name string and converts it to a SMILES string</span></a>
<a class="sourceLine" id="cb364-18" title="18"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb364-19" title="19">    [insert]</a>
<a class="sourceLine" id="cb364-20" title="20">    <span class="cf">return</span> SMILES</a></code></pre></div>
<h4 id="run-0-33">Run 0</h4>
<div class="sourceCode" id="cb365"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb365-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb365-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb365-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb365-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb365-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb365-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb365-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb365-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb365-9" title="9"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb365-10" title="10"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb365-11" title="11"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb365-12" title="12"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb365-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb365-14" title="14"></a>
<a class="sourceLine" id="cb365-15" title="15"><span class="kw">def</span> iupac2smiles(IUPAC):</a>
<a class="sourceLine" id="cb365-16" title="16">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb365-17" title="17"><span class="co">    This function takes in the IUPAC name string and converts it to a SMILES string</span></a>
<a class="sourceLine" id="cb365-18" title="18"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb365-19" title="19">    m <span class="op">=</span> Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(IUPAC)))</a>
<a class="sourceLine" id="cb365-20" title="20">    SMILES <span class="op">=</span> Chem.MolToSmiles(m)</a>
<a class="sourceLine" id="cb365-21" title="21">    <span class="cf">return</span> SMILES</a>
<a class="sourceLine" id="cb365-22" title="22"></a>
<a class="sourceLine" id="cb365-23" title="23">iupac <span class="op">=</span> <span class="st">&quot;2,5,5-trimethyl-2-hexene&quot;</span></a>
<a class="sourceLine" id="cb365-24" title="24">smiles <span class="op">=</span> <span class="st">&quot;CC(C)=CCC(C)(C)C&quot;</span></a>
<a class="sourceLine" id="cb365-25" title="25"></a>
<a class="sourceLine" id="cb365-26" title="26">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> iupac2smiles(iupac) <span class="op">==</span> smiles <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Python argument types in
    rdkit.Chem.rdmolfiles.MolToSmiles(NoneType)
did not match C++ signature:
    MolToSmiles(RDKit::ROMol mol, bool isomericSmiles=True, bool kekuleSmiles=False, int rootedAtAtom=-1, bool canonical=True, bool allBondsExplicit=False, bool allHsExplicit=False, bool doRandom=False)</code></pre>
<h4 id="run-1-33">Run 1</h4>
<div class="sourceCode" id="cb367"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb367-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb367-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb367-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb367-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb367-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb367-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb367-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb367-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb367-9" title="9"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb367-10" title="10"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb367-11" title="11"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb367-12" title="12"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb367-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb367-14" title="14"></a>
<a class="sourceLine" id="cb367-15" title="15"><span class="kw">def</span> iupac2smiles(IUPAC):</a>
<a class="sourceLine" id="cb367-16" title="16">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb367-17" title="17"><span class="co">    This function takes in the IUPAC name string and converts it to a SMILES string</span></a>
<a class="sourceLine" id="cb367-18" title="18"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb367-19" title="19">    mol <span class="op">=</span> Chem.MolFromSmiles(IUPAC)</a>
<a class="sourceLine" id="cb367-20" title="20">    SMILES <span class="op">=</span> Chem.MolToSmiles(mol)</a>
<a class="sourceLine" id="cb367-21" title="21">    <span class="cf">return</span> SMILES</a>
<a class="sourceLine" id="cb367-22" title="22"></a>
<a class="sourceLine" id="cb367-23" title="23">iupac <span class="op">=</span> <span class="st">&quot;2,5,5-trimethyl-2-hexene&quot;</span></a>
<a class="sourceLine" id="cb367-24" title="24">smiles <span class="op">=</span> <span class="st">&quot;CC(C)=CCC(C)(C)C&quot;</span></a>
<a class="sourceLine" id="cb367-25" title="25"></a>
<a class="sourceLine" id="cb367-26" title="26">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> iupac2smiles(iupac) <span class="op">==</span> smiles <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Python argument types in
    rdkit.Chem.rdmolfiles.MolToSmiles(NoneType)
did not match C++ signature:
    MolToSmiles(RDKit::ROMol mol, bool isomericSmiles=True, bool kekuleSmiles=False, int rootedAtAtom=-1, bool canonical=True, bool allBondsExplicit=False, bool allHsExplicit=False, bool doRandom=False)</code></pre>
<h4 id="run-2-33">Run 2</h4>
<div class="sourceCode" id="cb369"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb369-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb369-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb369-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb369-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb369-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb369-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb369-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb369-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb369-9" title="9"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb369-10" title="10"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb369-11" title="11"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb369-12" title="12"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb369-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb369-14" title="14"></a>
<a class="sourceLine" id="cb369-15" title="15"><span class="kw">def</span> iupac2smiles(IUPAC):</a>
<a class="sourceLine" id="cb369-16" title="16">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb369-17" title="17"><span class="co">    This function takes in the IUPAC name string and converts it to a SMILES string</span></a>
<a class="sourceLine" id="cb369-18" title="18"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb369-19" title="19">    mol <span class="op">=</span> Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(IUPAC)))</a>
<a class="sourceLine" id="cb369-20" title="20">    SMILES <span class="op">=</span> Chem.MolToSmiles(mol)</a>
<a class="sourceLine" id="cb369-21" title="21">    <span class="cf">return</span> SMILES</a>
<a class="sourceLine" id="cb369-22" title="22"></a>
<a class="sourceLine" id="cb369-23" title="23">iupac <span class="op">=</span> <span class="st">&quot;2,5,5-trimethyl-2-hexene&quot;</span></a>
<a class="sourceLine" id="cb369-24" title="24">smiles <span class="op">=</span> <span class="st">&quot;CC(C)=CCC(C)(C)C&quot;</span></a>
<a class="sourceLine" id="cb369-25" title="25"></a>
<a class="sourceLine" id="cb369-26" title="26">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> iupac2smiles(iupac) <span class="op">==</span> smiles <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Python argument types in
    rdkit.Chem.rdmolfiles.MolToSmiles(NoneType)
did not match C++ signature:
    MolToSmiles(RDKit::ROMol mol, bool isomericSmiles=True, bool kekuleSmiles=False, int rootedAtAtom=-1, bool canonical=True, bool allBondsExplicit=False, bool allHsExplicit=False, bool doRandom=False)</code></pre>
<h4 id="run-3-33">Run 3</h4>
<div class="sourceCode" id="cb371"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb371-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb371-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb371-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb371-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb371-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb371-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb371-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb371-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb371-9" title="9"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb371-10" title="10"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb371-11" title="11"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb371-12" title="12"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb371-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb371-14" title="14"></a>
<a class="sourceLine" id="cb371-15" title="15"><span class="kw">def</span> iupac2smiles(IUPAC):</a>
<a class="sourceLine" id="cb371-16" title="16">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb371-17" title="17"><span class="co">    This function takes in the IUPAC name string and converts it to a SMILES string</span></a>
<a class="sourceLine" id="cb371-18" title="18"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb371-19" title="19">    mol <span class="op">=</span> Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(IUPAC)))</a>
<a class="sourceLine" id="cb371-20" title="20">    SMILES <span class="op">=</span> Chem.MolToSmiles(mol)</a>
<a class="sourceLine" id="cb371-21" title="21">    <span class="cf">return</span> SMILES</a>
<a class="sourceLine" id="cb371-22" title="22"></a>
<a class="sourceLine" id="cb371-23" title="23">iupac <span class="op">=</span> <span class="st">&quot;2,5,5-trimethyl-2-hexene&quot;</span></a>
<a class="sourceLine" id="cb371-24" title="24">smiles <span class="op">=</span> <span class="st">&quot;CC(C)=CCC(C)(C)C&quot;</span></a>
<a class="sourceLine" id="cb371-25" title="25"></a>
<a class="sourceLine" id="cb371-26" title="26">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> iupac2smiles(iupac) <span class="op">==</span> smiles <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Python argument types in
    rdkit.Chem.rdmolfiles.MolToSmiles(NoneType)
did not match C++ signature:
    MolToSmiles(RDKit::ROMol mol, bool isomericSmiles=True, bool kekuleSmiles=False, int rootedAtAtom=-1, bool canonical=True, bool allBondsExplicit=False, bool allHsExplicit=False, bool doRandom=False)</code></pre>
<h4 id="run-4-33">Run 4</h4>
<div class="sourceCode" id="cb373"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb373-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb373-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb373-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb373-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb373-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb373-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb373-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb373-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb373-9" title="9"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb373-10" title="10"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb373-11" title="11"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb373-12" title="12"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb373-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb373-14" title="14"></a>
<a class="sourceLine" id="cb373-15" title="15"><span class="kw">def</span> iupac2smiles(IUPAC):</a>
<a class="sourceLine" id="cb373-16" title="16">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb373-17" title="17"><span class="co">    This function takes in the IUPAC name string and converts it to a SMILES string</span></a>
<a class="sourceLine" id="cb373-18" title="18"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb373-19" title="19">    mol <span class="op">=</span> Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolTo</a>
<a class="sourceLine" id="cb373-20" title="20">    <span class="cf">return</span> SMILES</a>
<a class="sourceLine" id="cb373-21" title="21"></a>
<a class="sourceLine" id="cb373-22" title="22">iupac <span class="op">=</span> <span class="st">&quot;2,5,5-trimethyl-2-hexene&quot;</span></a>
<a class="sourceLine" id="cb373-23" title="23">smiles <span class="op">=</span> <span class="st">&quot;CC(C)=CCC(C)(C)C&quot;</span></a>
<a class="sourceLine" id="cb373-24" title="24"></a>
<a class="sourceLine" id="cb373-25" title="25">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> iupac2smiles(iupac) <span class="op">==</span> smiles <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code></code></pre>
</details>
<details>
<p><summary>kld</summary></p>
<h4 id="query-34">Query</h4>
<div class="sourceCode" id="cb375"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb375-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb375-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb375-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb375-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb375-5" title="5"></a>
<a class="sourceLine" id="cb375-6" title="6"><span class="kw">def</span> kld(true_data, predicted_data):</a>
<a class="sourceLine" id="cb375-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb375-8" title="8"><span class="co">  This function calculates the Kullback–Leibler (KL) divergence loss between true_data and predicted_data.</span></a>
<a class="sourceLine" id="cb375-9" title="9"><span class="co">  &quot;&quot;</span></a>
<a class="sourceLine" id="cb375-10" title="10"><span class="co">  [insert]</span></a>
<a class="sourceLine" id="cb375-11" title="11"><span class="co">  return loss</span></a></code></pre></div>
<h4 id="run-0-34">Run 0</h4>
<div class="sourceCode" id="cb376"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb376-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb376-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb376-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb376-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb376-5" title="5"></a>
<a class="sourceLine" id="cb376-6" title="6"><span class="kw">def</span> kld(true_data, predicted_data):</a>
<a class="sourceLine" id="cb376-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb376-8" title="8"><span class="co">  This function calculates the Kullback–Leibler (KL) divergence loss between true_data and predicted_data.</span></a>
<a class="sourceLine" id="cb376-9" title="9"><span class="co">  &quot;&quot;</span></a>
<a class="sourceLine" id="cb376-10" title="10"><span class="co">  loss = np.sum(true_data * np.log(true_data / predicted_data))</span></a>
<a class="sourceLine" id="cb376-11" title="11"><span class="co">  return loss</span></a>
<a class="sourceLine" id="cb376-12" title="12"><span class="co">import numpy as np</span></a>
<a class="sourceLine" id="cb376-13" title="13"></a>
<a class="sourceLine" id="cb376-14" title="14"><span class="co">np.random.seed(0)</span></a>
<a class="sourceLine" id="cb376-15" title="15"><span class="co">M = 100</span></a>
<a class="sourceLine" id="cb376-16" title="16"><span class="co">targets = np.random.rand(M)</span></a>
<a class="sourceLine" id="cb376-17" title="17"><span class="co">predictions = targets * 0.9</span></a>
<a class="sourceLine" id="cb376-18" title="18"><span class="co">kld_loss = -np.sum(targets*np.log(</span></a>
<a class="sourceLine" id="cb376-19" title="19"><span class="co">    np.divide(predictions, targets) + 1e-10))</span></a>
<a class="sourceLine" id="cb376-20" title="20"></a>
<a class="sourceLine" id="cb376-21" title="21"><span class="co">result = True if np.isclose(kld(targets, predictions), kld_loss) else False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>EOF while scanning triple-quoted string literal (&lt;string&gt;, line 22)</code></pre>
<h4 id="run-1-34">Run 1</h4>
<div class="sourceCode" id="cb378"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb378-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb378-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb378-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb378-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb378-5" title="5"></a>
<a class="sourceLine" id="cb378-6" title="6"><span class="kw">def</span> kld(true_data, predicted_data):</a>
<a class="sourceLine" id="cb378-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb378-8" title="8"><span class="co">  This function calculates the Kullback–Leibler (KL) divergence loss between true_data and predicted_data.</span></a>
<a class="sourceLine" id="cb378-9" title="9"><span class="co">  &quot;&quot;</span></a>
<a class="sourceLine" id="cb378-10" title="10"><span class="co">  loss = 0.0</span></a>
<a class="sourceLine" id="cb378-11" title="11"><span class="co">  for i in range(len(true_data)):</span></a>
<a class="sourceLine" id="cb378-12" title="12"><span class="co">    loss += true_data[i] * np.log(true_data[i] / predicted_data[i])</span></a>
<a class="sourceLine" id="cb378-13" title="13"></a>
<a class="sourceLine" id="cb378-14" title="14"><span class="co">  return loss</span></a>
<a class="sourceLine" id="cb378-15" title="15"><span class="co">import numpy as np</span></a>
<a class="sourceLine" id="cb378-16" title="16"></a>
<a class="sourceLine" id="cb378-17" title="17"><span class="co">np.random.seed(0)</span></a>
<a class="sourceLine" id="cb378-18" title="18"><span class="co">M = 100</span></a>
<a class="sourceLine" id="cb378-19" title="19"><span class="co">targets = np.random.rand(M)</span></a>
<a class="sourceLine" id="cb378-20" title="20"><span class="co">predictions = targets * 0.9</span></a>
<a class="sourceLine" id="cb378-21" title="21"><span class="co">kld_loss = -np.sum(targets*np.log(</span></a>
<a class="sourceLine" id="cb378-22" title="22"><span class="co">    np.divide(predictions, targets) + 1e-10))</span></a>
<a class="sourceLine" id="cb378-23" title="23"></a>
<a class="sourceLine" id="cb378-24" title="24"><span class="co">result = True if np.isclose(kld(targets, predictions), kld_loss) else False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>EOF while scanning triple-quoted string literal (&lt;string&gt;, line 25)</code></pre>
<h4 id="run-2-34">Run 2</h4>
<div class="sourceCode" id="cb380"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb380-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb380-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb380-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb380-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb380-5" title="5"></a>
<a class="sourceLine" id="cb380-6" title="6"><span class="kw">def</span> kld(true_data, predicted_data):</a>
<a class="sourceLine" id="cb380-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb380-8" title="8"><span class="co">  This function calculates the Kullback–Leibler (KL) divergence loss between true_data and predicted_data.</span></a>
<a class="sourceLine" id="cb380-9" title="9"><span class="co">  &quot;&quot;</span></a>
<a class="sourceLine" id="cb380-10" title="10"><span class="co">  loss = 0</span></a>
<a class="sourceLine" id="cb380-11" title="11"><span class="co">  for i in range(len(true_data)):</span></a>
<a class="sourceLine" id="cb380-12" title="12"><span class="co">    loss += true_data[i] * np.log(true_data[i]/predicted_data[i])</span></a>
<a class="sourceLine" id="cb380-13" title="13"></a>
<a class="sourceLine" id="cb380-14" title="14"><span class="co">  return loss</span></a>
<a class="sourceLine" id="cb380-15" title="15"><span class="co">import numpy as np</span></a>
<a class="sourceLine" id="cb380-16" title="16"></a>
<a class="sourceLine" id="cb380-17" title="17"><span class="co">np.random.seed(0)</span></a>
<a class="sourceLine" id="cb380-18" title="18"><span class="co">M = 100</span></a>
<a class="sourceLine" id="cb380-19" title="19"><span class="co">targets = np.random.rand(M)</span></a>
<a class="sourceLine" id="cb380-20" title="20"><span class="co">predictions = targets * 0.9</span></a>
<a class="sourceLine" id="cb380-21" title="21"><span class="co">kld_loss = -np.sum(targets*np.log(</span></a>
<a class="sourceLine" id="cb380-22" title="22"><span class="co">    np.divide(predictions, targets) + 1e-10))</span></a>
<a class="sourceLine" id="cb380-23" title="23"></a>
<a class="sourceLine" id="cb380-24" title="24"><span class="co">result = True if np.isclose(kld(targets, predictions), kld_loss) else False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>EOF while scanning triple-quoted string literal (&lt;string&gt;, line 25)</code></pre>
<h4 id="run-3-34">Run 3</h4>
<div class="sourceCode" id="cb382"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb382-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb382-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb382-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb382-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb382-5" title="5"></a>
<a class="sourceLine" id="cb382-6" title="6"><span class="kw">def</span> kld(true_data, predicted_data):</a>
<a class="sourceLine" id="cb382-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb382-8" title="8"><span class="co">  This function calculates the Kullback–Leibler (KL) divergence loss between true_data and predicted_data.</span></a>
<a class="sourceLine" id="cb382-9" title="9"><span class="co">  &quot;&quot;</span></a>
<a class="sourceLine" id="cb382-10" title="10"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb382-11" title="11">  loss <span class="op">=</span> np.<span class="bu">sum</span>(np.where(true_data <span class="op">!=</span> <span class="dv">0</span>, true_data <span class="op">*</span> np.log(true_data <span class="op">/</span> predicted_data), <span class="dv">0</span>))</a>
<a class="sourceLine" id="cb382-12" title="12">  <span class="cf">return</span> loss</a>
<a class="sourceLine" id="cb382-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb382-14" title="14"></a>
<a class="sourceLine" id="cb382-15" title="15">np.random.seed(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb382-16" title="16">M <span class="op">=</span> <span class="dv">100</span></a>
<a class="sourceLine" id="cb382-17" title="17">targets <span class="op">=</span> np.random.rand(M)</a>
<a class="sourceLine" id="cb382-18" title="18">predictions <span class="op">=</span> targets <span class="op">*</span> <span class="fl">0.9</span></a>
<a class="sourceLine" id="cb382-19" title="19">kld_loss <span class="op">=</span> <span class="op">-</span>np.<span class="bu">sum</span>(targets<span class="op">*</span>np.log(</a>
<a class="sourceLine" id="cb382-20" title="20">    np.divide(predictions, targets) <span class="op">+</span> <span class="fl">1e-10</span>))</a>
<a class="sourceLine" id="cb382-21" title="21"></a>
<a class="sourceLine" id="cb382-22" title="22">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(kld(targets, predictions), kld_loss) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-34">Run 4</h4>
<div class="sourceCode" id="cb384"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb384-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb384-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb384-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb384-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb384-5" title="5"></a>
<a class="sourceLine" id="cb384-6" title="6"><span class="kw">def</span> kld(true_data, predicted_data):</a>
<a class="sourceLine" id="cb384-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb384-8" title="8"><span class="co">  This function calculates the Kullback–Leibler (KL) divergence loss between true_data and predicted_data.</span></a>
<a class="sourceLine" id="cb384-9" title="9"><span class="co">  &quot;&quot;</span></a>
<a class="sourceLine" id="cb384-10" title="10"><span class="co">  loss = np.sum(true_data * np.log(true_data / predicted_data))</span></a>
<a class="sourceLine" id="cb384-11" title="11"><span class="co">  return loss</span></a>
<a class="sourceLine" id="cb384-12" title="12"></a>
<a class="sourceLine" id="cb384-13" title="13"></a>
<a class="sourceLine" id="cb384-14" title="14"><span class="co">  return loss</span></a>
<a class="sourceLine" id="cb384-15" title="15"><span class="co">import numpy as np</span></a>
<a class="sourceLine" id="cb384-16" title="16"></a>
<a class="sourceLine" id="cb384-17" title="17"><span class="co">np.random.seed(0)</span></a>
<a class="sourceLine" id="cb384-18" title="18"><span class="co">M = 100</span></a>
<a class="sourceLine" id="cb384-19" title="19"><span class="co">targets = np.random.rand(M)</span></a>
<a class="sourceLine" id="cb384-20" title="20"><span class="co">predictions = targets * 0.9</span></a>
<a class="sourceLine" id="cb384-21" title="21"><span class="co">kld_loss = -np.sum(targets*np.log(</span></a>
<a class="sourceLine" id="cb384-22" title="22"><span class="co">    np.divide(predictions, targets) + 1e-10))</span></a>
<a class="sourceLine" id="cb384-23" title="23"></a>
<a class="sourceLine" id="cb384-24" title="24"><span class="co">result = True if np.isclose(kld(targets, predictions), kld_loss) else False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>EOF while scanning triple-quoted string literal (&lt;string&gt;, line 25)</code></pre>
</details>
<details>
<p><summary>langevin_dynamics</summary></p>
<h4 id="query-35">Query</h4>
<div class="sourceCode" id="cb386"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb386-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb386-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb386-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb386-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb386-5" title="5"></a>
<a class="sourceLine" id="cb386-6" title="6"><span class="kw">def</span> run_langevin_dynamics(x0,v0,gamma,F,n_steps,dt<span class="op">=</span><span class="fl">0.003</span>,T<span class="op">=</span><span class="fl">1.0</span>,m<span class="op">=</span><span class="dv">1</span>):</a>
<a class="sourceLine" id="cb386-7" title="7">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb386-8" title="8"><span class="co">    This function runs a Langevin dynamics simulation in 1d in an external potential</span></a>
<a class="sourceLine" id="cb386-9" title="9"><span class="co">    It returns the trajectory of x and v.</span></a>
<a class="sourceLine" id="cb386-10" title="10"></a>
<a class="sourceLine" id="cb386-11" title="11"><span class="co">    The initial position is x0</span></a>
<a class="sourceLine" id="cb386-12" title="12"><span class="co">    The initial velocity is v0</span></a>
<a class="sourceLine" id="cb386-13" title="13"><span class="co">    The temperature is T</span></a>
<a class="sourceLine" id="cb386-14" title="14"><span class="co">    m is the mass</span></a>
<a class="sourceLine" id="cb386-15" title="15"><span class="co">    F(x) is a function that returns the external force</span></a>
<a class="sourceLine" id="cb386-16" title="16"><span class="co">    gamma is the drag coefficient</span></a>
<a class="sourceLine" id="cb386-17" title="17"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb386-18" title="18">    x_traj <span class="op">=</span> np.zeros(n_steps)</a>
<a class="sourceLine" id="cb386-19" title="19">    v_traj <span class="op">=</span> np.zeros(n_steps)</a>
<a class="sourceLine" id="cb386-20" title="20">    [insert]</a>
<a class="sourceLine" id="cb386-21" title="21">    <span class="cf">return</span> x_traj, v_traj</a></code></pre></div>
<h4 id="run-0-35">Run 0</h4>
<div class="sourceCode" id="cb387"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb387-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb387-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb387-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb387-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb387-5" title="5"></a>
<a class="sourceLine" id="cb387-6" title="6"><span class="kw">def</span> run_langevin_dynamics(x0,v0,gamma,F,n_steps,dt<span class="op">=</span><span class="fl">0.003</span>,T<span class="op">=</span><span class="fl">1.0</span>,m<span class="op">=</span><span class="dv">1</span>):</a>
<a class="sourceLine" id="cb387-7" title="7">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb387-8" title="8"><span class="co">    This function runs a Langevin dynamics simulation in 1d in an external potential</span></a>
<a class="sourceLine" id="cb387-9" title="9"><span class="co">    It returns the trajectory of x and v.</span></a>
<a class="sourceLine" id="cb387-10" title="10"></a>
<a class="sourceLine" id="cb387-11" title="11"><span class="co">    The initial position is x0</span></a>
<a class="sourceLine" id="cb387-12" title="12"><span class="co">    The initial velocity is v0</span></a>
<a class="sourceLine" id="cb387-13" title="13"><span class="co">    The temperature is T</span></a>
<a class="sourceLine" id="cb387-14" title="14"><span class="co">    m is the mass</span></a>
<a class="sourceLine" id="cb387-15" title="15"><span class="co">    F(x) is a function that returns the external force</span></a>
<a class="sourceLine" id="cb387-16" title="16"><span class="co">    gamma is the drag coefficient</span></a>
<a class="sourceLine" id="cb387-17" title="17"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb387-18" title="18">    x_traj <span class="op">=</span> np.zeros(n_steps)</a>
<a class="sourceLine" id="cb387-19" title="19">    v_traj <span class="op">=</span> np.zeros(n_steps)</a>
<a class="sourceLine" id="cb387-20" title="20">    x_traj[<span class="dv">0</span>] <span class="op">=</span> x0</a>
<a class="sourceLine" id="cb387-21" title="21">    v_traj[<span class="dv">0</span>] <span class="op">=</span> v0</a>
<a class="sourceLine" id="cb387-22" title="22">    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>,n_steps):</a>
<a class="sourceLine" id="cb387-23" title="23">        v_traj[i] <span class="op">=</span> v_traj[i<span class="dv">-1</span>]<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>gamma<span class="op">*</span>dt<span class="op">/</span>m) <span class="op">+</span> F(x_traj[i<span class="dv">-1</span>])<span class="op">*</span>dt<span class="op">/</span>m <span class="op">+</span> np.sqrt(<span class="dv">2</span><span class="op">*</span>T<span class="op">*</span>gamma<span class="op">*</span>dt<span class="op">/</span>m)<span class="op">*</span>np.random.normal()</a>
<a class="sourceLine" id="cb387-24" title="24">        x_traj[i] <span class="op">=</span> x_traj[i<span class="dv">-1</span>] <span class="op">+</span> v_traj[i]<span class="op">*</span>dt</a>
<a class="sourceLine" id="cb387-25" title="25"></a>
<a class="sourceLine" id="cb387-26" title="26">    <span class="cf">return</span> x_traj, v_traj</a>
<a class="sourceLine" id="cb387-27" title="27"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb387-28" title="28"><span class="im">import</span> pylab <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb387-29" title="29"><span class="co">#def PE(q):</span></a>
<a class="sourceLine" id="cb387-30" title="30"><span class="co">#    return (q**2-1.0)**2</span></a>
<a class="sourceLine" id="cb387-31" title="31"><span class="co">#def F(q):</span></a>
<a class="sourceLine" id="cb387-32" title="32"><span class="co">#    return -4.0 * q * (q**2-1.0)</span></a>
<a class="sourceLine" id="cb387-33" title="33"><span class="kw">def</span> F(q,k<span class="op">=</span><span class="dv">2</span>):</a>
<a class="sourceLine" id="cb387-34" title="34">    <span class="cf">return</span> <span class="op">-</span>k<span class="op">*</span>q</a>
<a class="sourceLine" id="cb387-35" title="35"></a>
<a class="sourceLine" id="cb387-36" title="36">x_traj, v_traj <span class="op">=</span> run_langevin_dynamics(<span class="fl">0.1</span>,<span class="op">-</span><span class="fl">0.1</span>,<span class="fl">0.1</span>,F,<span class="dv">100000</span>)</a>
<a class="sourceLine" id="cb387-37" title="37">plt.plot(x_traj)</a>
<a class="sourceLine" id="cb387-38" title="38">plt.show()</a>
<a class="sourceLine" id="cb387-39" title="39">v_traj_half <span class="op">=</span> np.array(v_traj)[<span class="bu">len</span>(v_traj)<span class="op">//</span><span class="dv">2</span>:]</a>
<a class="sourceLine" id="cb387-40" title="40">msv <span class="op">=</span> v_traj_half.var()</a>
<a class="sourceLine" id="cb387-41" title="41">ideal_msv <span class="op">=</span> <span class="dv">1</span> <span class="co">#kT/m</span></a>
<a class="sourceLine" id="cb387-42" title="42"></a>
<a class="sourceLine" id="cb387-43" title="43">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">abs</span>(msv<span class="op">-</span>ideal_msv)<span class="op">/</span>ideal_msv <span class="op">&lt;</span> <span class="fl">0.2</span> <span class="kw">and</span> np.<span class="bu">abs</span>(np.mean(x_traj[<span class="bu">len</span>(x_traj)<span class="op">//</span><span class="dv">2</span>:]))<span class="op">&lt;</span><span class="fl">0.1</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-35">Run 1</h4>
<div class="sourceCode" id="cb389"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb389-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb389-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb389-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb389-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb389-5" title="5"></a>
<a class="sourceLine" id="cb389-6" title="6"><span class="kw">def</span> run_langevin_dynamics(x0,v0,gamma,F,n_steps,dt<span class="op">=</span><span class="fl">0.003</span>,T<span class="op">=</span><span class="fl">1.0</span>,m<span class="op">=</span><span class="dv">1</span>):</a>
<a class="sourceLine" id="cb389-7" title="7">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb389-8" title="8"><span class="co">    This function runs a Langevin dynamics simulation in 1d in an external potential</span></a>
<a class="sourceLine" id="cb389-9" title="9"><span class="co">    It returns the trajectory of x and v.</span></a>
<a class="sourceLine" id="cb389-10" title="10"></a>
<a class="sourceLine" id="cb389-11" title="11"><span class="co">    The initial position is x0</span></a>
<a class="sourceLine" id="cb389-12" title="12"><span class="co">    The initial velocity is v0</span></a>
<a class="sourceLine" id="cb389-13" title="13"><span class="co">    The temperature is T</span></a>
<a class="sourceLine" id="cb389-14" title="14"><span class="co">    m is the mass</span></a>
<a class="sourceLine" id="cb389-15" title="15"><span class="co">    F(x) is a function that returns the external force</span></a>
<a class="sourceLine" id="cb389-16" title="16"><span class="co">    gamma is the drag coefficient</span></a>
<a class="sourceLine" id="cb389-17" title="17"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb389-18" title="18">    x_traj <span class="op">=</span> np.zeros(n_steps)</a>
<a class="sourceLine" id="cb389-19" title="19">    v_traj <span class="op">=</span> np.zeros(n_steps)</a>
<a class="sourceLine" id="cb389-20" title="20">    x_traj[<span class="dv">0</span>] <span class="op">=</span> x0</a>
<a class="sourceLine" id="cb389-21" title="21">    v_traj[<span class="dv">0</span>] <span class="op">=</span> v0</a>
<a class="sourceLine" id="cb389-22" title="22">    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n_steps<span class="dv">-1</span>):</a>
<a class="sourceLine" id="cb389-23" title="23">        v_traj[i<span class="op">+</span><span class="dv">1</span>] <span class="op">=</span> v_traj[i] <span class="op">-</span> (gamma<span class="op">/</span>m)<span class="op">*</span>v_traj[i]<span class="op">*</span>dt <span class="op">-</span> (F(x_traj[i])<span class="op">/</span>m)<span class="op">*</span>dt <span class="op">+</span> np.sqrt(<span class="dv">2</span><span class="op">*</span>gamma<span class="op">*</span>T<span class="op">/</span>m)<span class="op">*</span>np.random.normal(<span class="dv">0</span>,<span class="dv">1</span>)<span class="op">*</span>np.sqrt(dt)</a>
<a class="sourceLine" id="cb389-24" title="24">        x_traj[i<span class="op">+</span><span class="dv">1</span>] <span class="op">=</span> x_traj[i] <span class="op">+</span> v_traj[i<span class="op">+</span><span class="dv">1</span>]<span class="op">*</span>dt</a>
<a class="sourceLine" id="cb389-25" title="25"></a>
<a class="sourceLine" id="cb389-26" title="26">    <span class="cf">return</span> x_traj, v_traj</a>
<a class="sourceLine" id="cb389-27" title="27"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb389-28" title="28"><span class="im">import</span> pylab <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb389-29" title="29"><span class="co">#def PE(q):</span></a>
<a class="sourceLine" id="cb389-30" title="30"><span class="co">#    return (q**2-1.0)**2</span></a>
<a class="sourceLine" id="cb389-31" title="31"><span class="co">#def F(q):</span></a>
<a class="sourceLine" id="cb389-32" title="32"><span class="co">#    return -4.0 * q * (q**2-1.0)</span></a>
<a class="sourceLine" id="cb389-33" title="33"><span class="kw">def</span> F(q,k<span class="op">=</span><span class="dv">2</span>):</a>
<a class="sourceLine" id="cb389-34" title="34">    <span class="cf">return</span> <span class="op">-</span>k<span class="op">*</span>q</a>
<a class="sourceLine" id="cb389-35" title="35"></a>
<a class="sourceLine" id="cb389-36" title="36">x_traj, v_traj <span class="op">=</span> run_langevin_dynamics(<span class="fl">0.1</span>,<span class="op">-</span><span class="fl">0.1</span>,<span class="fl">0.1</span>,F,<span class="dv">100000</span>)</a>
<a class="sourceLine" id="cb389-37" title="37">plt.plot(x_traj)</a>
<a class="sourceLine" id="cb389-38" title="38">plt.show()</a>
<a class="sourceLine" id="cb389-39" title="39">v_traj_half <span class="op">=</span> np.array(v_traj)[<span class="bu">len</span>(v_traj)<span class="op">//</span><span class="dv">2</span>:]</a>
<a class="sourceLine" id="cb389-40" title="40">msv <span class="op">=</span> v_traj_half.var()</a>
<a class="sourceLine" id="cb389-41" title="41">ideal_msv <span class="op">=</span> <span class="dv">1</span> <span class="co">#kT/m</span></a>
<a class="sourceLine" id="cb389-42" title="42"></a>
<a class="sourceLine" id="cb389-43" title="43">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">abs</span>(msv<span class="op">-</span>ideal_msv)<span class="op">/</span>ideal_msv <span class="op">&lt;</span> <span class="fl">0.2</span> <span class="kw">and</span> np.<span class="bu">abs</span>(np.mean(x_traj[<span class="bu">len</span>(x_traj)<span class="op">//</span><span class="dv">2</span>:]))<span class="op">&lt;</span><span class="fl">0.1</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-35">Run 2</h4>
<div class="sourceCode" id="cb391"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb391-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb391-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb391-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb391-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb391-5" title="5"></a>
<a class="sourceLine" id="cb391-6" title="6"><span class="kw">def</span> run_langevin_dynamics(x0,v0,gamma,F,n_steps,dt<span class="op">=</span><span class="fl">0.003</span>,T<span class="op">=</span><span class="fl">1.0</span>,m<span class="op">=</span><span class="dv">1</span>):</a>
<a class="sourceLine" id="cb391-7" title="7">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb391-8" title="8"><span class="co">    This function runs a Langevin dynamics simulation in 1d in an external potential</span></a>
<a class="sourceLine" id="cb391-9" title="9"><span class="co">    It returns the trajectory of x and v.</span></a>
<a class="sourceLine" id="cb391-10" title="10"></a>
<a class="sourceLine" id="cb391-11" title="11"><span class="co">    The initial position is x0</span></a>
<a class="sourceLine" id="cb391-12" title="12"><span class="co">    The initial velocity is v0</span></a>
<a class="sourceLine" id="cb391-13" title="13"><span class="co">    The temperature is T</span></a>
<a class="sourceLine" id="cb391-14" title="14"><span class="co">    m is the mass</span></a>
<a class="sourceLine" id="cb391-15" title="15"><span class="co">    F(x) is a function that returns the external force</span></a>
<a class="sourceLine" id="cb391-16" title="16"><span class="co">    gamma is the drag coefficient</span></a>
<a class="sourceLine" id="cb391-17" title="17"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb391-18" title="18">    x_traj <span class="op">=</span> np.zeros(n_steps)</a>
<a class="sourceLine" id="cb391-19" title="19">    v_traj <span class="op">=</span> np.zeros(n_steps)</a>
<a class="sourceLine" id="cb391-20" title="20">    x_traj[<span class="dv">0</span>] <span class="op">=</span> x0</a>
<a class="sourceLine" id="cb391-21" title="21">    v_traj[<span class="dv">0</span>] <span class="op">=</span> v0</a>
<a class="sourceLine" id="cb391-22" title="22">    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n_steps<span class="dv">-1</span>):</a>
<a class="sourceLine" id="cb391-23" title="23">        v_traj[i<span class="op">+</span><span class="dv">1</span>] <span class="op">=</span> (v_traj[i] <span class="op">-</span> dt<span class="op">*</span>F(x_traj[i])<span class="op">/</span>m <span class="op">-</span> gamma<span class="op">*</span>v_traj[i]<span class="op">*</span>dt <span class="op">+</span> np.sqrt(<span class="dv">2</span><span class="op">*</span>gamma<span class="op">*</span>T<span class="op">*</span>dt)<span class="op">*</span>np.random.normal())<span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>gamma<span class="op">*</span>dt)</a>
<a class="sourceLine" id="cb391-24" title="24">        x_traj[i<span class="op">+</span><span class="dv">1</span>] <span class="op">=</span> x_traj[i] <span class="op">+</span> v_traj[i<span class="op">+</span><span class="dv">1</span>]<span class="op">*</span>dt</a>
<a class="sourceLine" id="cb391-25" title="25"></a>
<a class="sourceLine" id="cb391-26" title="26">    <span class="cf">return</span> x_traj, v_traj</a>
<a class="sourceLine" id="cb391-27" title="27"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb391-28" title="28"><span class="im">import</span> pylab <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb391-29" title="29"><span class="co">#def PE(q):</span></a>
<a class="sourceLine" id="cb391-30" title="30"><span class="co">#    return (q**2-1.0)**2</span></a>
<a class="sourceLine" id="cb391-31" title="31"><span class="co">#def F(q):</span></a>
<a class="sourceLine" id="cb391-32" title="32"><span class="co">#    return -4.0 * q * (q**2-1.0)</span></a>
<a class="sourceLine" id="cb391-33" title="33"><span class="kw">def</span> F(q,k<span class="op">=</span><span class="dv">2</span>):</a>
<a class="sourceLine" id="cb391-34" title="34">    <span class="cf">return</span> <span class="op">-</span>k<span class="op">*</span>q</a>
<a class="sourceLine" id="cb391-35" title="35"></a>
<a class="sourceLine" id="cb391-36" title="36">x_traj, v_traj <span class="op">=</span> run_langevin_dynamics(<span class="fl">0.1</span>,<span class="op">-</span><span class="fl">0.1</span>,<span class="fl">0.1</span>,F,<span class="dv">100000</span>)</a>
<a class="sourceLine" id="cb391-37" title="37">plt.plot(x_traj)</a>
<a class="sourceLine" id="cb391-38" title="38">plt.show()</a>
<a class="sourceLine" id="cb391-39" title="39">v_traj_half <span class="op">=</span> np.array(v_traj)[<span class="bu">len</span>(v_traj)<span class="op">//</span><span class="dv">2</span>:]</a>
<a class="sourceLine" id="cb391-40" title="40">msv <span class="op">=</span> v_traj_half.var()</a>
<a class="sourceLine" id="cb391-41" title="41">ideal_msv <span class="op">=</span> <span class="dv">1</span> <span class="co">#kT/m</span></a>
<a class="sourceLine" id="cb391-42" title="42"></a>
<a class="sourceLine" id="cb391-43" title="43">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">abs</span>(msv<span class="op">-</span>ideal_msv)<span class="op">/</span>ideal_msv <span class="op">&lt;</span> <span class="fl">0.2</span> <span class="kw">and</span> np.<span class="bu">abs</span>(np.mean(x_traj[<span class="bu">len</span>(x_traj)<span class="op">//</span><span class="dv">2</span>:]))<span class="op">&lt;</span><span class="fl">0.1</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-35">Run 3</h4>
<div class="sourceCode" id="cb393"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb393-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb393-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb393-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb393-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb393-5" title="5"></a>
<a class="sourceLine" id="cb393-6" title="6"><span class="kw">def</span> run_langevin_dynamics(x0,v0,gamma,F,n_steps,dt<span class="op">=</span><span class="fl">0.003</span>,T<span class="op">=</span><span class="fl">1.0</span>,m<span class="op">=</span><span class="dv">1</span>):</a>
<a class="sourceLine" id="cb393-7" title="7">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb393-8" title="8"><span class="co">    This function runs a Langevin dynamics simulation in 1d in an external potential</span></a>
<a class="sourceLine" id="cb393-9" title="9"><span class="co">    It returns the trajectory of x and v.</span></a>
<a class="sourceLine" id="cb393-10" title="10"></a>
<a class="sourceLine" id="cb393-11" title="11"><span class="co">    The initial position is x0</span></a>
<a class="sourceLine" id="cb393-12" title="12"><span class="co">    The initial velocity is v0</span></a>
<a class="sourceLine" id="cb393-13" title="13"><span class="co">    The temperature is T</span></a>
<a class="sourceLine" id="cb393-14" title="14"><span class="co">    m is the mass</span></a>
<a class="sourceLine" id="cb393-15" title="15"><span class="co">    F(x) is a function that returns the external force</span></a>
<a class="sourceLine" id="cb393-16" title="16"><span class="co">    gamma is the drag coefficient</span></a>
<a class="sourceLine" id="cb393-17" title="17"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb393-18" title="18">    x_traj <span class="op">=</span> np.zeros(n_steps)</a>
<a class="sourceLine" id="cb393-19" title="19">    v_traj <span class="op">=</span> np.zeros(n_steps)</a>
<a class="sourceLine" id="cb393-20" title="20">    x_traj[<span class="dv">0</span>] <span class="op">=</span> x0</a>
<a class="sourceLine" id="cb393-21" title="21">    v_traj[<span class="dv">0</span>] <span class="op">=</span> v0</a>
<a class="sourceLine" id="cb393-22" title="22">    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n_steps<span class="dv">-1</span>):</a>
<a class="sourceLine" id="cb393-23" title="23">        v_traj[i<span class="op">+</span><span class="dv">1</span>] <span class="op">=</span> v_traj[i] <span class="op">-</span> (gamma<span class="op">/</span>m)<span class="op">*</span>v_traj[i]<span class="op">*</span>dt <span class="op">-</span> (F(x_traj[i])<span class="op">/</span>m)<span class="op">*</span>dt <span class="op">+</span> np.sqrt(<span class="dv">2</span><span class="op">*</span>gamma<span class="op">*</span>T<span class="op">/</span>m)<span class="op">*</span>np.random.normal(<span class="dv">0</span>,<span class="dv">1</span>)<span class="op">*</span>np.sqrt(dt)</a>
<a class="sourceLine" id="cb393-24" title="24">        x_traj[i<span class="op">+</span><span class="dv">1</span>] <span class="op">=</span> x_traj[i] <span class="op">+</span> v_traj[i<span class="op">+</span><span class="dv">1</span>]<span class="op">*</span>dt</a>
<a class="sourceLine" id="cb393-25" title="25"></a>
<a class="sourceLine" id="cb393-26" title="26">    <span class="cf">return</span> x_traj, v_traj</a>
<a class="sourceLine" id="cb393-27" title="27"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb393-28" title="28"><span class="im">import</span> pylab <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb393-29" title="29"><span class="co">#def PE(q):</span></a>
<a class="sourceLine" id="cb393-30" title="30"><span class="co">#    return (q**2-1.0)**2</span></a>
<a class="sourceLine" id="cb393-31" title="31"><span class="co">#def F(q):</span></a>
<a class="sourceLine" id="cb393-32" title="32"><span class="co">#    return -4.0 * q * (q**2-1.0)</span></a>
<a class="sourceLine" id="cb393-33" title="33"><span class="kw">def</span> F(q,k<span class="op">=</span><span class="dv">2</span>):</a>
<a class="sourceLine" id="cb393-34" title="34">    <span class="cf">return</span> <span class="op">-</span>k<span class="op">*</span>q</a>
<a class="sourceLine" id="cb393-35" title="35"></a>
<a class="sourceLine" id="cb393-36" title="36">x_traj, v_traj <span class="op">=</span> run_langevin_dynamics(<span class="fl">0.1</span>,<span class="op">-</span><span class="fl">0.1</span>,<span class="fl">0.1</span>,F,<span class="dv">100000</span>)</a>
<a class="sourceLine" id="cb393-37" title="37">plt.plot(x_traj)</a>
<a class="sourceLine" id="cb393-38" title="38">plt.show()</a>
<a class="sourceLine" id="cb393-39" title="39">v_traj_half <span class="op">=</span> np.array(v_traj)[<span class="bu">len</span>(v_traj)<span class="op">//</span><span class="dv">2</span>:]</a>
<a class="sourceLine" id="cb393-40" title="40">msv <span class="op">=</span> v_traj_half.var()</a>
<a class="sourceLine" id="cb393-41" title="41">ideal_msv <span class="op">=</span> <span class="dv">1</span> <span class="co">#kT/m</span></a>
<a class="sourceLine" id="cb393-42" title="42"></a>
<a class="sourceLine" id="cb393-43" title="43">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">abs</span>(msv<span class="op">-</span>ideal_msv)<span class="op">/</span>ideal_msv <span class="op">&lt;</span> <span class="fl">0.2</span> <span class="kw">and</span> np.<span class="bu">abs</span>(np.mean(x_traj[<span class="bu">len</span>(x_traj)<span class="op">//</span><span class="dv">2</span>:]))<span class="op">&lt;</span><span class="fl">0.1</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-35">Run 4</h4>
<div class="sourceCode" id="cb395"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb395-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb395-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb395-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb395-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb395-5" title="5"></a>
<a class="sourceLine" id="cb395-6" title="6"><span class="kw">def</span> run_langevin_dynamics(x0,v0,gamma,F,n_steps,dt<span class="op">=</span><span class="fl">0.003</span>,T<span class="op">=</span><span class="fl">1.0</span>,m<span class="op">=</span><span class="dv">1</span>):</a>
<a class="sourceLine" id="cb395-7" title="7">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb395-8" title="8"><span class="co">    This function runs a Langevin dynamics simulation in 1d in an external potential</span></a>
<a class="sourceLine" id="cb395-9" title="9"><span class="co">    It returns the trajectory of x and v.</span></a>
<a class="sourceLine" id="cb395-10" title="10"></a>
<a class="sourceLine" id="cb395-11" title="11"><span class="co">    The initial position is x0</span></a>
<a class="sourceLine" id="cb395-12" title="12"><span class="co">    The initial velocity is v0</span></a>
<a class="sourceLine" id="cb395-13" title="13"><span class="co">    The temperature is T</span></a>
<a class="sourceLine" id="cb395-14" title="14"><span class="co">    m is the mass</span></a>
<a class="sourceLine" id="cb395-15" title="15"><span class="co">    F(x) is a function that returns the external force</span></a>
<a class="sourceLine" id="cb395-16" title="16"><span class="co">    gamma is the drag coefficient</span></a>
<a class="sourceLine" id="cb395-17" title="17"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb395-18" title="18">    x_traj <span class="op">=</span> np.zeros(n_steps)</a>
<a class="sourceLine" id="cb395-19" title="19">    v_traj <span class="op">=</span> np.zeros(n_steps)</a>
<a class="sourceLine" id="cb395-20" title="20">    x_traj[<span class="dv">0</span>] <span class="op">=</span> x0</a>
<a class="sourceLine" id="cb395-21" title="21">    v_traj[<span class="dv">0</span>] <span class="op">=</span> v0</a>
<a class="sourceLine" id="cb395-22" title="22">    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n_steps<span class="dv">-1</span>):</a>
<a class="sourceLine" id="cb395-23" title="23">        x_traj[i<span class="op">+</span><span class="dv">1</span>] <span class="op">=</span> x_traj[i] <span class="op">+</span> dt<span class="op">*</span>v_traj[i]</a>
<a class="sourceLine" id="cb395-24" title="24">        v_traj[i<span class="op">+</span><span class="dv">1</span>] <span class="op">=</span> v_traj[i] <span class="op">-</span> dt<span class="op">*</span>gamma<span class="op">*</span>v_traj[i] <span class="op">-</span> dt<span class="op">*</span>F(x_traj[i]) <span class="op">+</span> np.sqrt(<span class="dv">2</span><span class="op">*</span>T<span class="op">*</span>gamma<span class="op">*</span>dt)<span class="op">*</span>np.random.normal()</a>
<a class="sourceLine" id="cb395-25" title="25"></a>
<a class="sourceLine" id="cb395-26" title="26">    <span class="cf">return</span> x_traj, v_traj</a>
<a class="sourceLine" id="cb395-27" title="27"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb395-28" title="28"><span class="im">import</span> pylab <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb395-29" title="29"><span class="co">#def PE(q):</span></a>
<a class="sourceLine" id="cb395-30" title="30"><span class="co">#    return (q**2-1.0)**2</span></a>
<a class="sourceLine" id="cb395-31" title="31"><span class="co">#def F(q):</span></a>
<a class="sourceLine" id="cb395-32" title="32"><span class="co">#    return -4.0 * q * (q**2-1.0)</span></a>
<a class="sourceLine" id="cb395-33" title="33"><span class="kw">def</span> F(q,k<span class="op">=</span><span class="dv">2</span>):</a>
<a class="sourceLine" id="cb395-34" title="34">    <span class="cf">return</span> <span class="op">-</span>k<span class="op">*</span>q</a>
<a class="sourceLine" id="cb395-35" title="35"></a>
<a class="sourceLine" id="cb395-36" title="36">x_traj, v_traj <span class="op">=</span> run_langevin_dynamics(<span class="fl">0.1</span>,<span class="op">-</span><span class="fl">0.1</span>,<span class="fl">0.1</span>,F,<span class="dv">100000</span>)</a>
<a class="sourceLine" id="cb395-37" title="37">plt.plot(x_traj)</a>
<a class="sourceLine" id="cb395-38" title="38">plt.show()</a>
<a class="sourceLine" id="cb395-39" title="39">v_traj_half <span class="op">=</span> np.array(v_traj)[<span class="bu">len</span>(v_traj)<span class="op">//</span><span class="dv">2</span>:]</a>
<a class="sourceLine" id="cb395-40" title="40">msv <span class="op">=</span> v_traj_half.var()</a>
<a class="sourceLine" id="cb395-41" title="41">ideal_msv <span class="op">=</span> <span class="dv">1</span> <span class="co">#kT/m</span></a>
<a class="sourceLine" id="cb395-42" title="42"></a>
<a class="sourceLine" id="cb395-43" title="43">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">abs</span>(msv<span class="op">-</span>ideal_msv)<span class="op">/</span>ideal_msv <span class="op">&lt;</span> <span class="fl">0.2</span> <span class="kw">and</span> np.<span class="bu">abs</span>(np.mean(x_traj[<span class="bu">len</span>(x_traj)<span class="op">//</span><span class="dv">2</span>:]))<span class="op">&lt;</span><span class="fl">0.1</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>lipinski_rule_of_five</summary></p>
<h4 id="query-36">Query</h4>
<div class="sourceCode" id="cb397"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb397-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb397-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb397-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb397-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb397-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb397-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb397-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb397-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb397-9" title="9"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb397-10" title="10"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb397-11" title="11"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb397-12" title="12"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb397-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb397-14" title="14"></a>
<a class="sourceLine" id="cb397-15" title="15"><span class="kw">def</span> lipinski_rule_of_five(smiles):</a>
<a class="sourceLine" id="cb397-16" title="16">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb397-17" title="17"><span class="co">    This function calculates the Lipinski descriptors of the given SMILES string and returns a boolean to indicate if Lipinski&#39;s rule of five was satisfied.</span></a>
<a class="sourceLine" id="cb397-18" title="18"></a>
<a class="sourceLine" id="cb397-19" title="19"><span class="co">    Lipinski&#39;s rules are:</span></a>
<a class="sourceLine" id="cb397-20" title="20"><span class="co">    Hydrogen bond donors &lt;= 5</span></a>
<a class="sourceLine" id="cb397-21" title="21"><span class="co">    Hydrogen bond acceptors &lt;= 10</span></a>
<a class="sourceLine" id="cb397-22" title="22"><span class="co">    Molecular weight &lt; 500 daltons</span></a>
<a class="sourceLine" id="cb397-23" title="23"><span class="co">    logP &lt; 5</span></a>
<a class="sourceLine" id="cb397-24" title="24"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb397-25" title="25">    [insert]</a>
<a class="sourceLine" id="cb397-26" title="26">    <span class="cf">return</span> result</a></code></pre></div>
<h4 id="run-0-36">Run 0</h4>
<div class="sourceCode" id="cb398"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb398-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb398-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb398-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb398-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb398-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb398-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb398-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb398-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb398-9" title="9"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb398-10" title="10"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb398-11" title="11"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb398-12" title="12"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb398-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb398-14" title="14"></a>
<a class="sourceLine" id="cb398-15" title="15"><span class="kw">def</span> lipinski_rule_of_five(smiles):</a>
<a class="sourceLine" id="cb398-16" title="16">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb398-17" title="17"><span class="co">    This function calculates the Lipinski descriptors of the given SMILES string and returns a boolean to indicate if Lipinski&#39;s rule of five was satisfied.</span></a>
<a class="sourceLine" id="cb398-18" title="18"></a>
<a class="sourceLine" id="cb398-19" title="19"><span class="co">    Lipinski&#39;s rules are:</span></a>
<a class="sourceLine" id="cb398-20" title="20"><span class="co">    Hydrogen bond donors &lt;= 5</span></a>
<a class="sourceLine" id="cb398-21" title="21"><span class="co">    Hydrogen bond acceptors &lt;= 10</span></a>
<a class="sourceLine" id="cb398-22" title="22"><span class="co">    Molecular weight &lt; 500 daltons</span></a>
<a class="sourceLine" id="cb398-23" title="23"><span class="co">    logP &lt; 5</span></a>
<a class="sourceLine" id="cb398-24" title="24"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb398-25" title="25">    mol <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb398-26" title="26">    result <span class="op">=</span> <span class="va">True</span></a>
<a class="sourceLine" id="cb398-27" title="27">    <span class="cf">if</span> mol <span class="kw">is</span> <span class="va">None</span>:</a>
<a class="sourceLine" id="cb398-28" title="28">        result <span class="op">=</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb398-29" title="29">    <span class="cf">else</span>:</a>
<a class="sourceLine" id="cb398-30" title="30">        <span class="cf">if</span> rdMolDescriptors.CalcNumHBD(mol) <span class="op">&gt;</span> <span class="dv">5</span>:</a>
<a class="sourceLine" id="cb398-31" title="31">            result <span class="op">=</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb398-32" title="32">        <span class="cf">if</span> rdMolDescriptors.CalcNumHBA(mol) <span class="op">&gt;</span> <span class="dv">10</span>:</a>
<a class="sourceLine" id="cb398-33" title="33">            result <span class="op">=</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb398-34" title="34">        <span class="cf">if</span> Descriptors.MolWt(mol) <span class="op">&gt;</span> <span class="dv">500</span>:</a>
<a class="sourceLine" id="cb398-35" title="35">            result <span class="op">=</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb398-36" title="36">        <span class="cf">if</span> Crippen.MolLogP(mol) <span class="op">&gt;</span> <span class="dv">5</span>:</a>
<a class="sourceLine" id="cb398-37" title="37">            result <span class="op">=</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb398-38" title="38">    <span class="cf">return</span> result</a>
<a class="sourceLine" id="cb398-39" title="39"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb398-40" title="40">smiles <span class="op">=</span> <span class="st">&#39;CC1=CN=C(C(=C1OC)C)CS(=O)C2=NC3=C(N2)C=C(C=C3)OC&#39;</span>  <span class="co"># omeprazole</span></a>
<a class="sourceLine" id="cb398-41" title="41">m <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb398-42" title="42">hbd <span class="op">=</span> Chem.rdMolDescriptors.CalcNumHBD(m)</a>
<a class="sourceLine" id="cb398-43" title="43">hba <span class="op">=</span> Chem.rdMolDescriptors.CalcNumHBA(m)</a>
<a class="sourceLine" id="cb398-44" title="44">wt <span class="op">=</span> Chem.rdMolDescriptors.CalcExactMolWt(m)</a>
<a class="sourceLine" id="cb398-45" title="45">logp <span class="op">=</span> Chem.Crippen.MolLogP(m)</a>
<a class="sourceLine" id="cb398-46" title="46"></a>
<a class="sourceLine" id="cb398-47" title="47"><span class="cf">if</span> hbd <span class="op">&lt;</span> <span class="dv">5</span> <span class="kw">and</span> hba <span class="op">&lt;</span> <span class="dv">10</span> <span class="kw">and</span> wt <span class="op">&lt;</span> <span class="dv">500</span> <span class="kw">and</span> logp <span class="op">&lt;</span> <span class="dv">5</span>:</a>
<a class="sourceLine" id="cb398-48" title="48">    passed <span class="op">=</span> <span class="va">True</span></a>
<a class="sourceLine" id="cb398-49" title="49"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb398-50" title="50">    passed <span class="op">=</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb398-51" title="51"></a>
<a class="sourceLine" id="cb398-52" title="52">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> lipinski_rule_of_five(smiles) <span class="op">==</span> passed <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-36">Run 1</h4>
<div class="sourceCode" id="cb400"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb400-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb400-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb400-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb400-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb400-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb400-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb400-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb400-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb400-9" title="9"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb400-10" title="10"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb400-11" title="11"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb400-12" title="12"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb400-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb400-14" title="14"></a>
<a class="sourceLine" id="cb400-15" title="15"><span class="kw">def</span> lipinski_rule_of_five(smiles):</a>
<a class="sourceLine" id="cb400-16" title="16">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb400-17" title="17"><span class="co">    This function calculates the Lipinski descriptors of the given SMILES string and returns a boolean to indicate if Lipinski&#39;s rule of five was satisfied.</span></a>
<a class="sourceLine" id="cb400-18" title="18"></a>
<a class="sourceLine" id="cb400-19" title="19"><span class="co">    Lipinski&#39;s rules are:</span></a>
<a class="sourceLine" id="cb400-20" title="20"><span class="co">    Hydrogen bond donors &lt;= 5</span></a>
<a class="sourceLine" id="cb400-21" title="21"><span class="co">    Hydrogen bond acceptors &lt;= 10</span></a>
<a class="sourceLine" id="cb400-22" title="22"><span class="co">    Molecular weight &lt; 500 daltons</span></a>
<a class="sourceLine" id="cb400-23" title="23"><span class="co">    logP &lt; 5</span></a>
<a class="sourceLine" id="cb400-24" title="24"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb400-25" title="25">    mol <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb400-26" title="26">    result <span class="op">=</span> <span class="va">True</span></a>
<a class="sourceLine" id="cb400-27" title="27">    <span class="cf">if</span> rdMolDescriptors.CalcNumHBD(mol) <span class="op">&gt;</span> <span class="dv">5</span>:</a>
<a class="sourceLine" id="cb400-28" title="28">        result <span class="op">=</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb400-29" title="29">    <span class="cf">if</span> rdMolDescriptors.CalcNumHBA(mol) <span class="op">&gt;</span> <span class="dv">10</span>:</a>
<a class="sourceLine" id="cb400-30" title="30">        result <span class="op">=</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb400-31" title="31">    <span class="cf">if</span> Descriptors.MolWt(mol) <span class="op">&gt;</span> <span class="dv">500</span>:</a>
<a class="sourceLine" id="cb400-32" title="32">        result <span class="op">=</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb400-33" title="33">    <span class="cf">if</span> Crippen.MolLogP(mol) <span class="op">&gt;</span> <span class="dv">5</span>:</a>
<a class="sourceLine" id="cb400-34" title="34">        result <span class="op">=</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb400-35" title="35">    <span class="cf">return</span> result</a>
<a class="sourceLine" id="cb400-36" title="36"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb400-37" title="37">smiles <span class="op">=</span> <span class="st">&#39;CC1=CN=C(C(=C1OC)C)CS(=O)C2=NC3=C(N2)C=C(C=C3)OC&#39;</span>  <span class="co"># omeprazole</span></a>
<a class="sourceLine" id="cb400-38" title="38">m <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb400-39" title="39">hbd <span class="op">=</span> Chem.rdMolDescriptors.CalcNumHBD(m)</a>
<a class="sourceLine" id="cb400-40" title="40">hba <span class="op">=</span> Chem.rdMolDescriptors.CalcNumHBA(m)</a>
<a class="sourceLine" id="cb400-41" title="41">wt <span class="op">=</span> Chem.rdMolDescriptors.CalcExactMolWt(m)</a>
<a class="sourceLine" id="cb400-42" title="42">logp <span class="op">=</span> Chem.Crippen.MolLogP(m)</a>
<a class="sourceLine" id="cb400-43" title="43"></a>
<a class="sourceLine" id="cb400-44" title="44"><span class="cf">if</span> hbd <span class="op">&lt;</span> <span class="dv">5</span> <span class="kw">and</span> hba <span class="op">&lt;</span> <span class="dv">10</span> <span class="kw">and</span> wt <span class="op">&lt;</span> <span class="dv">500</span> <span class="kw">and</span> logp <span class="op">&lt;</span> <span class="dv">5</span>:</a>
<a class="sourceLine" id="cb400-45" title="45">    passed <span class="op">=</span> <span class="va">True</span></a>
<a class="sourceLine" id="cb400-46" title="46"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb400-47" title="47">    passed <span class="op">=</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb400-48" title="48"></a>
<a class="sourceLine" id="cb400-49" title="49">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> lipinski_rule_of_five(smiles) <span class="op">==</span> passed <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-36">Run 2</h4>
<div class="sourceCode" id="cb402"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb402-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb402-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb402-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb402-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb402-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb402-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb402-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb402-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb402-9" title="9"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb402-10" title="10"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb402-11" title="11"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb402-12" title="12"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb402-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb402-14" title="14"></a>
<a class="sourceLine" id="cb402-15" title="15"><span class="kw">def</span> lipinski_rule_of_five(smiles):</a>
<a class="sourceLine" id="cb402-16" title="16">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb402-17" title="17"><span class="co">    This function calculates the Lipinski descriptors of the given SMILES string and returns a boolean to indicate if Lipinski&#39;s rule of five was satisfied.</span></a>
<a class="sourceLine" id="cb402-18" title="18"></a>
<a class="sourceLine" id="cb402-19" title="19"><span class="co">    Lipinski&#39;s rules are:</span></a>
<a class="sourceLine" id="cb402-20" title="20"><span class="co">    Hydrogen bond donors &lt;= 5</span></a>
<a class="sourceLine" id="cb402-21" title="21"><span class="co">    Hydrogen bond acceptors &lt;= 10</span></a>
<a class="sourceLine" id="cb402-22" title="22"><span class="co">    Molecular weight &lt; 500 daltons</span></a>
<a class="sourceLine" id="cb402-23" title="23"><span class="co">    logP &lt; 5</span></a>
<a class="sourceLine" id="cb402-24" title="24"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb402-25" title="25">    mol <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb402-26" title="26">    result <span class="op">=</span> <span class="va">True</span></a>
<a class="sourceLine" id="cb402-27" title="27">    <span class="cf">if</span> rdMolDescriptors.CalcNumHBD(mol) <span class="op">&gt;</span> <span class="dv">5</span>:</a>
<a class="sourceLine" id="cb402-28" title="28">        result <span class="op">=</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb402-29" title="29">    <span class="cf">if</span> rdMolDescriptors.CalcNumHBA(mol) <span class="op">&gt;</span> <span class="dv">10</span>:</a>
<a class="sourceLine" id="cb402-30" title="30">        result <span class="op">=</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb402-31" title="31">    <span class="cf">if</span> Descriptors.MolWt(mol) <span class="op">&gt;</span> <span class="dv">500</span>:</a>
<a class="sourceLine" id="cb402-32" title="32">        result <span class="op">=</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb402-33" title="33">    <span class="cf">if</span> Crippen.MolLogP(mol) <span class="op">&gt;</span> <span class="dv">5</span>:</a>
<a class="sourceLine" id="cb402-34" title="34">        result <span class="op">=</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb402-35" title="35"></a>
<a class="sourceLine" id="cb402-36" title="36">    <span class="cf">return</span> result</a>
<a class="sourceLine" id="cb402-37" title="37"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb402-38" title="38">smiles <span class="op">=</span> <span class="st">&#39;CC1=CN=C(C(=C1OC)C)CS(=O)C2=NC3=C(N2)C=C(C=C3)OC&#39;</span>  <span class="co"># omeprazole</span></a>
<a class="sourceLine" id="cb402-39" title="39">m <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb402-40" title="40">hbd <span class="op">=</span> Chem.rdMolDescriptors.CalcNumHBD(m)</a>
<a class="sourceLine" id="cb402-41" title="41">hba <span class="op">=</span> Chem.rdMolDescriptors.CalcNumHBA(m)</a>
<a class="sourceLine" id="cb402-42" title="42">wt <span class="op">=</span> Chem.rdMolDescriptors.CalcExactMolWt(m)</a>
<a class="sourceLine" id="cb402-43" title="43">logp <span class="op">=</span> Chem.Crippen.MolLogP(m)</a>
<a class="sourceLine" id="cb402-44" title="44"></a>
<a class="sourceLine" id="cb402-45" title="45"><span class="cf">if</span> hbd <span class="op">&lt;</span> <span class="dv">5</span> <span class="kw">and</span> hba <span class="op">&lt;</span> <span class="dv">10</span> <span class="kw">and</span> wt <span class="op">&lt;</span> <span class="dv">500</span> <span class="kw">and</span> logp <span class="op">&lt;</span> <span class="dv">5</span>:</a>
<a class="sourceLine" id="cb402-46" title="46">    passed <span class="op">=</span> <span class="va">True</span></a>
<a class="sourceLine" id="cb402-47" title="47"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb402-48" title="48">    passed <span class="op">=</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb402-49" title="49"></a>
<a class="sourceLine" id="cb402-50" title="50">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> lipinski_rule_of_five(smiles) <span class="op">==</span> passed <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-36">Run 3</h4>
<div class="sourceCode" id="cb404"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb404-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb404-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb404-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb404-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb404-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb404-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb404-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb404-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb404-9" title="9"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb404-10" title="10"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb404-11" title="11"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb404-12" title="12"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb404-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb404-14" title="14"></a>
<a class="sourceLine" id="cb404-15" title="15"><span class="kw">def</span> lipinski_rule_of_five(smiles):</a>
<a class="sourceLine" id="cb404-16" title="16">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb404-17" title="17"><span class="co">    This function calculates the Lipinski descriptors of the given SMILES string and returns a boolean to indicate if Lipinski&#39;s rule of five was satisfied.</span></a>
<a class="sourceLine" id="cb404-18" title="18"></a>
<a class="sourceLine" id="cb404-19" title="19"><span class="co">    Lipinski&#39;s rules are:</span></a>
<a class="sourceLine" id="cb404-20" title="20"><span class="co">    Hydrogen bond donors &lt;= 5</span></a>
<a class="sourceLine" id="cb404-21" title="21"><span class="co">    Hydrogen bond acceptors &lt;= 10</span></a>
<a class="sourceLine" id="cb404-22" title="22"><span class="co">    Molecular weight &lt; 500 daltons</span></a>
<a class="sourceLine" id="cb404-23" title="23"><span class="co">    logP &lt; 5</span></a>
<a class="sourceLine" id="cb404-24" title="24"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb404-25" title="25">    mol <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb404-26" title="26">    result <span class="op">=</span> <span class="va">True</span></a>
<a class="sourceLine" id="cb404-27" title="27">    <span class="cf">if</span> Descriptors.NumHDonors(mol) <span class="op">&gt;</span> <span class="dv">5</span>:</a>
<a class="sourceLine" id="cb404-28" title="28">        result <span class="op">=</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb404-29" title="29">    <span class="cf">if</span> Descriptors.NumHAcceptors(mol) <span class="op">&gt;</span> <span class="dv">10</span>:</a>
<a class="sourceLine" id="cb404-30" title="30">        result <span class="op">=</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb404-31" title="31">    <span class="cf">if</span> Descriptors.MolWt(mol) <span class="op">&gt;</span> <span class="dv">500</span>:</a>
<a class="sourceLine" id="cb404-32" title="32">        result <span class="op">=</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb404-33" title="33">    <span class="cf">if</span> Crippen.MolLogP(mol) <span class="op">&gt;</span> <span class="dv">5</span>:</a>
<a class="sourceLine" id="cb404-34" title="34">        result <span class="op">=</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb404-35" title="35">    <span class="cf">return</span> result</a>
<a class="sourceLine" id="cb404-36" title="36"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb404-37" title="37">smiles <span class="op">=</span> <span class="st">&#39;CC1=CN=C(C(=C1OC)C)CS(=O)C2=NC3=C(N2)C=C(C=C3)OC&#39;</span>  <span class="co"># omeprazole</span></a>
<a class="sourceLine" id="cb404-38" title="38">m <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb404-39" title="39">hbd <span class="op">=</span> Chem.rdMolDescriptors.CalcNumHBD(m)</a>
<a class="sourceLine" id="cb404-40" title="40">hba <span class="op">=</span> Chem.rdMolDescriptors.CalcNumHBA(m)</a>
<a class="sourceLine" id="cb404-41" title="41">wt <span class="op">=</span> Chem.rdMolDescriptors.CalcExactMolWt(m)</a>
<a class="sourceLine" id="cb404-42" title="42">logp <span class="op">=</span> Chem.Crippen.MolLogP(m)</a>
<a class="sourceLine" id="cb404-43" title="43"></a>
<a class="sourceLine" id="cb404-44" title="44"><span class="cf">if</span> hbd <span class="op">&lt;</span> <span class="dv">5</span> <span class="kw">and</span> hba <span class="op">&lt;</span> <span class="dv">10</span> <span class="kw">and</span> wt <span class="op">&lt;</span> <span class="dv">500</span> <span class="kw">and</span> logp <span class="op">&lt;</span> <span class="dv">5</span>:</a>
<a class="sourceLine" id="cb404-45" title="45">    passed <span class="op">=</span> <span class="va">True</span></a>
<a class="sourceLine" id="cb404-46" title="46"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb404-47" title="47">    passed <span class="op">=</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb404-48" title="48"></a>
<a class="sourceLine" id="cb404-49" title="49">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> lipinski_rule_of_five(smiles) <span class="op">==</span> passed <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-36">Run 4</h4>
<div class="sourceCode" id="cb406"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb406-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb406-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb406-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb406-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb406-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb406-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb406-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb406-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb406-9" title="9"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb406-10" title="10"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb406-11" title="11"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb406-12" title="12"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb406-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb406-14" title="14"></a>
<a class="sourceLine" id="cb406-15" title="15"><span class="kw">def</span> lipinski_rule_of_five(smiles):</a>
<a class="sourceLine" id="cb406-16" title="16">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb406-17" title="17"><span class="co">    This function calculates the Lipinski descriptors of the given SMILES string and returns a boolean to indicate if Lipinski&#39;s rule of five was satisfied.</span></a>
<a class="sourceLine" id="cb406-18" title="18"></a>
<a class="sourceLine" id="cb406-19" title="19"><span class="co">    Lipinski&#39;s rules are:</span></a>
<a class="sourceLine" id="cb406-20" title="20"><span class="co">    Hydrogen bond donors &lt;= 5</span></a>
<a class="sourceLine" id="cb406-21" title="21"><span class="co">    Hydrogen bond acceptors &lt;= 10</span></a>
<a class="sourceLine" id="cb406-22" title="22"><span class="co">    Molecular weight &lt; 500 daltons</span></a>
<a class="sourceLine" id="cb406-23" title="23"><span class="co">    logP &lt; 5</span></a>
<a class="sourceLine" id="cb406-24" title="24"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb406-25" title="25">    mol <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb406-26" title="26">    result <span class="op">=</span> <span class="va">True</span></a>
<a class="sourceLine" id="cb406-27" title="27">    <span class="cf">if</span> rdMolDescriptors.CalcNumHBD(mol) <span class="op">&gt;</span> <span class="dv">5</span>:</a>
<a class="sourceLine" id="cb406-28" title="28">        result <span class="op">=</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb406-29" title="29">    <span class="cf">if</span> rdMolDescriptors.CalcNumHBA(mol) <span class="op">&gt;</span> <span class="dv">10</span>:</a>
<a class="sourceLine" id="cb406-30" title="30">        result <span class="op">=</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb406-31" title="31">    <span class="cf">if</span> Descriptors.MolWt(mol) <span class="op">&gt;</span> <span class="dv">500</span>:</a>
<a class="sourceLine" id="cb406-32" title="32">        result <span class="op">=</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb406-33" title="33">    <span class="cf">if</span> Crippen.MolLogP(mol) <span class="op">&gt;</span> <span class="dv">5</span>:</a>
<a class="sourceLine" id="cb406-34" title="34">        result <span class="op">=</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb406-35" title="35">    <span class="cf">return</span> result</a>
<a class="sourceLine" id="cb406-36" title="36"></a>
<a class="sourceLine" id="cb406-37" title="37"></a>
<a class="sourceLine" id="cb406-38" title="38">    <span class="cf">return</span> result</a>
<a class="sourceLine" id="cb406-39" title="39"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb406-40" title="40">smiles <span class="op">=</span> <span class="st">&#39;CC1=CN=C(C(=C1OC)C)CS(=O)C2=NC3=C(N2)C=C(C=C3)OC&#39;</span>  <span class="co"># omeprazole</span></a>
<a class="sourceLine" id="cb406-41" title="41">m <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb406-42" title="42">hbd <span class="op">=</span> Chem.rdMolDescriptors.CalcNumHBD(m)</a>
<a class="sourceLine" id="cb406-43" title="43">hba <span class="op">=</span> Chem.rdMolDescriptors.CalcNumHBA(m)</a>
<a class="sourceLine" id="cb406-44" title="44">wt <span class="op">=</span> Chem.rdMolDescriptors.CalcExactMolWt(m)</a>
<a class="sourceLine" id="cb406-45" title="45">logp <span class="op">=</span> Chem.Crippen.MolLogP(m)</a>
<a class="sourceLine" id="cb406-46" title="46"></a>
<a class="sourceLine" id="cb406-47" title="47"><span class="cf">if</span> hbd <span class="op">&lt;</span> <span class="dv">5</span> <span class="kw">and</span> hba <span class="op">&lt;</span> <span class="dv">10</span> <span class="kw">and</span> wt <span class="op">&lt;</span> <span class="dv">500</span> <span class="kw">and</span> logp <span class="op">&lt;</span> <span class="dv">5</span>:</a>
<a class="sourceLine" id="cb406-48" title="48">    passed <span class="op">=</span> <span class="va">True</span></a>
<a class="sourceLine" id="cb406-49" title="49"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb406-50" title="50">    passed <span class="op">=</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb406-51" title="51"></a>
<a class="sourceLine" id="cb406-52" title="52">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> lipinski_rule_of_five(smiles) <span class="op">==</span> passed <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>mape</summary></p>
<h4 id="query-37">Query</h4>
<div class="sourceCode" id="cb408"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb408-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb408-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb408-3" title="3"></a>
<a class="sourceLine" id="cb408-4" title="4"><span class="kw">def</span> mape(y_hat,y):</a>
<a class="sourceLine" id="cb408-5" title="5">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb408-6" title="6"><span class="co">  This function computes the mean absolute percentage error (mape) between y_hat and y.</span></a>
<a class="sourceLine" id="cb408-7" title="7"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb408-8" title="8">  [insert]</a>
<a class="sourceLine" id="cb408-9" title="9">  <span class="cf">return</span> e</a></code></pre></div>
<h4 id="run-0-37">Run 0</h4>
<div class="sourceCode" id="cb409"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb409-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb409-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb409-3" title="3"></a>
<a class="sourceLine" id="cb409-4" title="4"><span class="kw">def</span> mape(y_hat,y):</a>
<a class="sourceLine" id="cb409-5" title="5">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb409-6" title="6"><span class="co">  This function computes the mean absolute percentage error (mape) between y_hat and y.</span></a>
<a class="sourceLine" id="cb409-7" title="7"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb409-8" title="8">  e <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb409-9" title="9">  <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(y)):</a>
<a class="sourceLine" id="cb409-10" title="10">    e <span class="op">+=</span> <span class="bu">abs</span>(y_hat[i] <span class="op">-</span> y[i])<span class="op">/</span>y[i]</a>
<a class="sourceLine" id="cb409-11" title="11">  e <span class="op">/=</span> <span class="bu">len</span>(y)</a>
<a class="sourceLine" id="cb409-12" title="12">  <span class="cf">return</span> e</a>
<a class="sourceLine" id="cb409-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb409-14" title="14"></a>
<a class="sourceLine" id="cb409-15" title="15">np.random.seed(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb409-16" title="16">M<span class="op">=</span><span class="dv">100</span></a>
<a class="sourceLine" id="cb409-17" title="17">y_hat <span class="op">=</span> np.random.normal(loc<span class="op">=</span><span class="dv">10</span>,scale<span class="op">=</span><span class="dv">3</span>,size<span class="op">=</span>(M,))</a>
<a class="sourceLine" id="cb409-18" title="18">y <span class="op">=</span> np.random.normal(loc<span class="op">=</span><span class="dv">9</span>, scale<span class="op">=</span><span class="dv">2</span>, size<span class="op">=</span>(M,))</a>
<a class="sourceLine" id="cb409-19" title="19"></a>
<a class="sourceLine" id="cb409-20" title="20">test_mape <span class="op">=</span> <span class="bu">abs</span>((y <span class="op">-</span> y_hat)<span class="op">*</span><span class="dv">100</span><span class="op">/</span> y).mean()</a>
<a class="sourceLine" id="cb409-21" title="21">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(mape(y_hat,y),test_mape) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-37">Run 1</h4>
<div class="sourceCode" id="cb411"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb411-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb411-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb411-3" title="3"></a>
<a class="sourceLine" id="cb411-4" title="4"><span class="kw">def</span> mape(y_hat,y):</a>
<a class="sourceLine" id="cb411-5" title="5">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb411-6" title="6"><span class="co">  This function computes the mean absolute percentage error (mape) between y_hat and y.</span></a>
<a class="sourceLine" id="cb411-7" title="7"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb411-8" title="8">  e <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb411-9" title="9">  <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(y)):</a>
<a class="sourceLine" id="cb411-10" title="10">    e <span class="op">+=</span> <span class="bu">abs</span>(y_hat[i]<span class="op">-</span>y[i])<span class="op">/</span>y[i]</a>
<a class="sourceLine" id="cb411-11" title="11">  e <span class="op">/=</span> <span class="bu">len</span>(y)</a>
<a class="sourceLine" id="cb411-12" title="12">  <span class="cf">return</span> e</a>
<a class="sourceLine" id="cb411-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb411-14" title="14"></a>
<a class="sourceLine" id="cb411-15" title="15">np.random.seed(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb411-16" title="16">M<span class="op">=</span><span class="dv">100</span></a>
<a class="sourceLine" id="cb411-17" title="17">y_hat <span class="op">=</span> np.random.normal(loc<span class="op">=</span><span class="dv">10</span>,scale<span class="op">=</span><span class="dv">3</span>,size<span class="op">=</span>(M,))</a>
<a class="sourceLine" id="cb411-18" title="18">y <span class="op">=</span> np.random.normal(loc<span class="op">=</span><span class="dv">9</span>, scale<span class="op">=</span><span class="dv">2</span>, size<span class="op">=</span>(M,))</a>
<a class="sourceLine" id="cb411-19" title="19"></a>
<a class="sourceLine" id="cb411-20" title="20">test_mape <span class="op">=</span> <span class="bu">abs</span>((y <span class="op">-</span> y_hat)<span class="op">*</span><span class="dv">100</span><span class="op">/</span> y).mean()</a>
<a class="sourceLine" id="cb411-21" title="21">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(mape(y_hat,y),test_mape) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-37">Run 2</h4>
<div class="sourceCode" id="cb413"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb413-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb413-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb413-3" title="3"></a>
<a class="sourceLine" id="cb413-4" title="4"><span class="kw">def</span> mape(y_hat,y):</a>
<a class="sourceLine" id="cb413-5" title="5">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb413-6" title="6"><span class="co">  This function computes the mean absolute percentage error (mape) between y_hat and y.</span></a>
<a class="sourceLine" id="cb413-7" title="7"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb413-8" title="8">  e <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb413-9" title="9">  <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(y)):</a>
<a class="sourceLine" id="cb413-10" title="10">    e <span class="op">+=</span> <span class="bu">abs</span>(y_hat[i]<span class="op">-</span>y[i])<span class="op">/</span>y[i]</a>
<a class="sourceLine" id="cb413-11" title="11">  e <span class="op">/=</span> <span class="bu">len</span>(y)</a>
<a class="sourceLine" id="cb413-12" title="12">  <span class="cf">return</span> e</a>
<a class="sourceLine" id="cb413-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb413-14" title="14"></a>
<a class="sourceLine" id="cb413-15" title="15">np.random.seed(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb413-16" title="16">M<span class="op">=</span><span class="dv">100</span></a>
<a class="sourceLine" id="cb413-17" title="17">y_hat <span class="op">=</span> np.random.normal(loc<span class="op">=</span><span class="dv">10</span>,scale<span class="op">=</span><span class="dv">3</span>,size<span class="op">=</span>(M,))</a>
<a class="sourceLine" id="cb413-18" title="18">y <span class="op">=</span> np.random.normal(loc<span class="op">=</span><span class="dv">9</span>, scale<span class="op">=</span><span class="dv">2</span>, size<span class="op">=</span>(M,))</a>
<a class="sourceLine" id="cb413-19" title="19"></a>
<a class="sourceLine" id="cb413-20" title="20">test_mape <span class="op">=</span> <span class="bu">abs</span>((y <span class="op">-</span> y_hat)<span class="op">*</span><span class="dv">100</span><span class="op">/</span> y).mean()</a>
<a class="sourceLine" id="cb413-21" title="21">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(mape(y_hat,y),test_mape) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-37">Run 3</h4>
<div class="sourceCode" id="cb415"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb415-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb415-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb415-3" title="3"></a>
<a class="sourceLine" id="cb415-4" title="4"><span class="kw">def</span> mape(y_hat,y):</a>
<a class="sourceLine" id="cb415-5" title="5">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb415-6" title="6"><span class="co">  This function computes the mean absolute percentage error (mape) between y_hat and y.</span></a>
<a class="sourceLine" id="cb415-7" title="7"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb415-8" title="8">  <span class="cf">if</span> <span class="bu">len</span>(y_hat) <span class="op">!=</span> <span class="bu">len</span>(y):</a>
<a class="sourceLine" id="cb415-9" title="9">    sys.exit(<span class="st">&quot;y_hat and y must have the same length&quot;</span>)</a>
<a class="sourceLine" id="cb415-10" title="10">  e <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb415-11" title="11">  <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(y_hat)):</a>
<a class="sourceLine" id="cb415-12" title="12">    e <span class="op">+=</span> math.fabs(y_hat[i]<span class="op">-</span>y[i])<span class="op">/</span>y[i]</a>
<a class="sourceLine" id="cb415-13" title="13">  e <span class="op">/=</span> <span class="bu">len</span>(y_hat)</a>
<a class="sourceLine" id="cb415-14" title="14">  <span class="cf">return</span> e</a>
<a class="sourceLine" id="cb415-15" title="15"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb415-16" title="16"></a>
<a class="sourceLine" id="cb415-17" title="17">np.random.seed(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb415-18" title="18">M<span class="op">=</span><span class="dv">100</span></a>
<a class="sourceLine" id="cb415-19" title="19">y_hat <span class="op">=</span> np.random.normal(loc<span class="op">=</span><span class="dv">10</span>,scale<span class="op">=</span><span class="dv">3</span>,size<span class="op">=</span>(M,))</a>
<a class="sourceLine" id="cb415-20" title="20">y <span class="op">=</span> np.random.normal(loc<span class="op">=</span><span class="dv">9</span>, scale<span class="op">=</span><span class="dv">2</span>, size<span class="op">=</span>(M,))</a>
<a class="sourceLine" id="cb415-21" title="21"></a>
<a class="sourceLine" id="cb415-22" title="22">test_mape <span class="op">=</span> <span class="bu">abs</span>((y <span class="op">-</span> y_hat)<span class="op">*</span><span class="dv">100</span><span class="op">/</span> y).mean()</a>
<a class="sourceLine" id="cb415-23" title="23">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(mape(y_hat,y),test_mape) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-37">Run 4</h4>
<div class="sourceCode" id="cb417"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb417-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb417-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb417-3" title="3"></a>
<a class="sourceLine" id="cb417-4" title="4"><span class="kw">def</span> mape(y_hat,y):</a>
<a class="sourceLine" id="cb417-5" title="5">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb417-6" title="6"><span class="co">  This function computes the mean absolute percentage error (mape) between y_hat and y.</span></a>
<a class="sourceLine" id="cb417-7" title="7"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb417-8" title="8">  e <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb417-9" title="9">  <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(y)):</a>
<a class="sourceLine" id="cb417-10" title="10">    e <span class="op">+=</span> <span class="bu">abs</span>((y_hat[i] <span class="op">-</span> y[i])<span class="op">/</span>y[i])</a>
<a class="sourceLine" id="cb417-11" title="11">  e <span class="op">=</span> e<span class="op">/</span><span class="bu">len</span>(y)</a>
<a class="sourceLine" id="cb417-12" title="12">  <span class="cf">return</span> e</a>
<a class="sourceLine" id="cb417-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb417-14" title="14"></a>
<a class="sourceLine" id="cb417-15" title="15">np.random.seed(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb417-16" title="16">M<span class="op">=</span><span class="dv">100</span></a>
<a class="sourceLine" id="cb417-17" title="17">y_hat <span class="op">=</span> np.random.normal(loc<span class="op">=</span><span class="dv">10</span>,scale<span class="op">=</span><span class="dv">3</span>,size<span class="op">=</span>(M,))</a>
<a class="sourceLine" id="cb417-18" title="18">y <span class="op">=</span> np.random.normal(loc<span class="op">=</span><span class="dv">9</span>, scale<span class="op">=</span><span class="dv">2</span>, size<span class="op">=</span>(M,))</a>
<a class="sourceLine" id="cb417-19" title="19"></a>
<a class="sourceLine" id="cb417-20" title="20">test_mape <span class="op">=</span> <span class="bu">abs</span>((y <span class="op">-</span> y_hat)<span class="op">*</span><span class="dv">100</span><span class="op">/</span> y).mean()</a>
<a class="sourceLine" id="cb417-21" title="21">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(mape(y_hat,y),test_mape) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>mapping_operator</summary></p>
<h4 id="query-38">Query</h4>
<div class="sourceCode" id="cb419"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb419-1" title="1"><span class="im">import</span> MDAnalysis</a>
<a class="sourceLine" id="cb419-2" title="2"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb419-3" title="3"></a>
<a class="sourceLine" id="cb419-4" title="4"><span class="kw">def</span> mapping_operator(molecule, beads_mappings):</a>
<a class="sourceLine" id="cb419-5" title="5">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb419-6" title="6"><span class="co">  This function generates a mass-mass weighted mapping matrix given an MD analysis molecule</span></a>
<a class="sourceLine" id="cb419-7" title="7"><span class="co">  and atom selections for the beads.</span></a>
<a class="sourceLine" id="cb419-8" title="8"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb419-9" title="9">  [insert]</a>
<a class="sourceLine" id="cb419-10" title="10">  <span class="cf">return</span> M</a></code></pre></div>
<h4 id="run-0-38">Run 0</h4>
<div class="sourceCode" id="cb420"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb420-1" title="1"><span class="im">import</span> MDAnalysis</a>
<a class="sourceLine" id="cb420-2" title="2"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb420-3" title="3"></a>
<a class="sourceLine" id="cb420-4" title="4"><span class="kw">def</span> mapping_operator(molecule, beads_mappings):</a>
<a class="sourceLine" id="cb420-5" title="5">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb420-6" title="6"><span class="co">  This function generates a mass-mass weighted mapping matrix given an MD analysis molecule</span></a>
<a class="sourceLine" id="cb420-7" title="7"><span class="co">  and atom selections for the beads.</span></a>
<a class="sourceLine" id="cb420-8" title="8"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb420-9" title="9">  M <span class="op">=</span> np.zeros((<span class="bu">len</span>(beads_mappings), molecule.n_atoms))</a>
<a class="sourceLine" id="cb420-10" title="10">  <span class="cf">for</span> i, bead <span class="kw">in</span> <span class="bu">enumerate</span>(beads_mappings):</a>
<a class="sourceLine" id="cb420-11" title="11">    M[i, bead.indices] <span class="op">=</span> bead.masses <span class="op">/</span> bead.masses.<span class="bu">sum</span>()</a>
<a class="sourceLine" id="cb420-12" title="12">  <span class="cf">return</span> M</a>
<a class="sourceLine" id="cb420-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb420-14" title="14"><span class="im">import</span> MDAnalysis <span class="im">as</span> mda</a>
<a class="sourceLine" id="cb420-15" title="15"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb420-16" title="16"></a>
<a class="sourceLine" id="cb420-17" title="17"><span class="co"># read molecule</span></a>
<a class="sourceLine" id="cb420-18" title="18">u <span class="op">=</span> mda.Universe(os.path.join(_FILE_DIR_, <span class="st">&#39;water.gro&#39;</span>))</a>
<a class="sourceLine" id="cb420-19" title="19">molecule <span class="op">=</span> u.atoms</a>
<a class="sourceLine" id="cb420-20" title="20"><span class="co"># define atoms that belong to the a single bead</span></a>
<a class="sourceLine" id="cb420-21" title="21">beads_mappings <span class="op">=</span> [[<span class="st">&#39;OW&#39;</span>, <span class="st">&#39;HW1&#39;</span>, <span class="st">&#39;HW2&#39;</span>]]</a>
<a class="sourceLine" id="cb420-22" title="22">Mws_dict <span class="op">=</span> <span class="bu">dict</span>(<span class="bu">zip</span>(molecule.names, molecule.masses))</a>
<a class="sourceLine" id="cb420-23" title="23">M, N <span class="op">=</span> <span class="bu">len</span>(beads_mappings), <span class="bu">len</span>(molecule)</a>
<a class="sourceLine" id="cb420-24" title="24">CG_matrix <span class="op">=</span> np.zeros((M, N))</a>
<a class="sourceLine" id="cb420-25" title="25">index <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb420-26" title="26"><span class="cf">for</span> s <span class="kw">in</span> <span class="bu">range</span>(M):</a>
<a class="sourceLine" id="cb420-27" title="27">    <span class="cf">for</span> i, atom <span class="kw">in</span> <span class="bu">enumerate</span>(beads_mappings[s]):</a>
<a class="sourceLine" id="cb420-28" title="28">        CG_matrix[s, i <span class="op">+</span> index] <span class="op">=</span> [v <span class="cf">for</span> k,</a>
<a class="sourceLine" id="cb420-29" title="29">                                   v <span class="kw">in</span> Mws_dict.items() <span class="cf">if</span> atom <span class="kw">in</span> k][<span class="dv">0</span>]</a>
<a class="sourceLine" id="cb420-30" title="30">    index <span class="op">+=</span> np.count_nonzero(CG_matrix[s])</a>
<a class="sourceLine" id="cb420-31" title="31">    CG_matrix[s] <span class="op">=</span> CG_matrix[s] <span class="op">/</span> np.<span class="bu">sum</span>(CG_matrix[s])</a>
<a class="sourceLine" id="cb420-32" title="32"></a>
<a class="sourceLine" id="cb420-33" title="33">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(</a>
<a class="sourceLine" id="cb420-34" title="34">    CG_matrix, mapping_operator(molecule, beads_mappings)).<span class="bu">all</span>() <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>&#39;list&#39; object has no attribute &#39;masses&#39;</code></pre>
<h4 id="run-1-38">Run 1</h4>
<div class="sourceCode" id="cb422"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb422-1" title="1"><span class="im">import</span> MDAnalysis</a>
<a class="sourceLine" id="cb422-2" title="2"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb422-3" title="3"></a>
<a class="sourceLine" id="cb422-4" title="4"><span class="kw">def</span> mapping_operator(molecule, beads_mappings):</a>
<a class="sourceLine" id="cb422-5" title="5">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb422-6" title="6"><span class="co">  This function generates a mass-mass weighted mapping matrix given an MD analysis molecule</span></a>
<a class="sourceLine" id="cb422-7" title="7"><span class="co">  and atom selections for the beads.</span></a>
<a class="sourceLine" id="cb422-8" title="8"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb422-9" title="9">  M <span class="op">=</span> np.zeros((<span class="bu">len</span>(molecule.atoms), <span class="bu">len</span>(beads_mappings)))</a>
<a class="sourceLine" id="cb422-10" title="10">  <span class="cf">for</span> i, bead <span class="kw">in</span> <span class="bu">enumerate</span>(beads_mappings):</a>
<a class="sourceLine" id="cb422-11" title="11">    M[bead.indices, i] <span class="op">=</span> bead.masses</a>
<a class="sourceLine" id="cb422-12" title="12"></a>
<a class="sourceLine" id="cb422-13" title="13">  <span class="cf">return</span> M</a>
<a class="sourceLine" id="cb422-14" title="14"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb422-15" title="15"><span class="im">import</span> MDAnalysis <span class="im">as</span> mda</a>
<a class="sourceLine" id="cb422-16" title="16"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb422-17" title="17"></a>
<a class="sourceLine" id="cb422-18" title="18"><span class="co"># read molecule</span></a>
<a class="sourceLine" id="cb422-19" title="19">u <span class="op">=</span> mda.Universe(os.path.join(_FILE_DIR_, <span class="st">&#39;water.gro&#39;</span>))</a>
<a class="sourceLine" id="cb422-20" title="20">molecule <span class="op">=</span> u.atoms</a>
<a class="sourceLine" id="cb422-21" title="21"><span class="co"># define atoms that belong to the a single bead</span></a>
<a class="sourceLine" id="cb422-22" title="22">beads_mappings <span class="op">=</span> [[<span class="st">&#39;OW&#39;</span>, <span class="st">&#39;HW1&#39;</span>, <span class="st">&#39;HW2&#39;</span>]]</a>
<a class="sourceLine" id="cb422-23" title="23">Mws_dict <span class="op">=</span> <span class="bu">dict</span>(<span class="bu">zip</span>(molecule.names, molecule.masses))</a>
<a class="sourceLine" id="cb422-24" title="24">M, N <span class="op">=</span> <span class="bu">len</span>(beads_mappings), <span class="bu">len</span>(molecule)</a>
<a class="sourceLine" id="cb422-25" title="25">CG_matrix <span class="op">=</span> np.zeros((M, N))</a>
<a class="sourceLine" id="cb422-26" title="26">index <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb422-27" title="27"><span class="cf">for</span> s <span class="kw">in</span> <span class="bu">range</span>(M):</a>
<a class="sourceLine" id="cb422-28" title="28">    <span class="cf">for</span> i, atom <span class="kw">in</span> <span class="bu">enumerate</span>(beads_mappings[s]):</a>
<a class="sourceLine" id="cb422-29" title="29">        CG_matrix[s, i <span class="op">+</span> index] <span class="op">=</span> [v <span class="cf">for</span> k,</a>
<a class="sourceLine" id="cb422-30" title="30">                                   v <span class="kw">in</span> Mws_dict.items() <span class="cf">if</span> atom <span class="kw">in</span> k][<span class="dv">0</span>]</a>
<a class="sourceLine" id="cb422-31" title="31">    index <span class="op">+=</span> np.count_nonzero(CG_matrix[s])</a>
<a class="sourceLine" id="cb422-32" title="32">    CG_matrix[s] <span class="op">=</span> CG_matrix[s] <span class="op">/</span> np.<span class="bu">sum</span>(CG_matrix[s])</a>
<a class="sourceLine" id="cb422-33" title="33"></a>
<a class="sourceLine" id="cb422-34" title="34">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(</a>
<a class="sourceLine" id="cb422-35" title="35">    CG_matrix, mapping_operator(molecule, beads_mappings)).<span class="bu">all</span>() <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>&#39;list&#39; object has no attribute &#39;masses&#39;</code></pre>
<h4 id="run-2-38">Run 2</h4>
<div class="sourceCode" id="cb424"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb424-1" title="1"><span class="im">import</span> MDAnalysis</a>
<a class="sourceLine" id="cb424-2" title="2"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb424-3" title="3"></a>
<a class="sourceLine" id="cb424-4" title="4"><span class="kw">def</span> mapping_operator(molecule, beads_mappings):</a>
<a class="sourceLine" id="cb424-5" title="5">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb424-6" title="6"><span class="co">  This function generates a mass-mass weighted mapping matrix given an MD analysis molecule</span></a>
<a class="sourceLine" id="cb424-7" title="7"><span class="co">  and atom selections for the beads.</span></a>
<a class="sourceLine" id="cb424-8" title="8"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb424-9" title="9">  M <span class="op">=</span> np.zeros((<span class="bu">len</span>(beads_mappings), molecule.n_atoms))</a>
<a class="sourceLine" id="cb424-10" title="10">  <span class="cf">for</span> i, beads_mapping <span class="kw">in</span> <span class="bu">enumerate</span>(beads_mappings):</a>
<a class="sourceLine" id="cb424-11" title="11">    M[i, beads_mapping.indices] <span class="op">=</span> beads_mapping.masses <span class="op">/</span> np.<span class="bu">sum</span>(beads_mapping.masses)</a>
<a class="sourceLine" id="cb424-12" title="12">  <span class="cf">return</span> M</a>
<a class="sourceLine" id="cb424-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb424-14" title="14"><span class="im">import</span> MDAnalysis <span class="im">as</span> mda</a>
<a class="sourceLine" id="cb424-15" title="15"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb424-16" title="16"></a>
<a class="sourceLine" id="cb424-17" title="17"><span class="co"># read molecule</span></a>
<a class="sourceLine" id="cb424-18" title="18">u <span class="op">=</span> mda.Universe(os.path.join(_FILE_DIR_, <span class="st">&#39;water.gro&#39;</span>))</a>
<a class="sourceLine" id="cb424-19" title="19">molecule <span class="op">=</span> u.atoms</a>
<a class="sourceLine" id="cb424-20" title="20"><span class="co"># define atoms that belong to the a single bead</span></a>
<a class="sourceLine" id="cb424-21" title="21">beads_mappings <span class="op">=</span> [[<span class="st">&#39;OW&#39;</span>, <span class="st">&#39;HW1&#39;</span>, <span class="st">&#39;HW2&#39;</span>]]</a>
<a class="sourceLine" id="cb424-22" title="22">Mws_dict <span class="op">=</span> <span class="bu">dict</span>(<span class="bu">zip</span>(molecule.names, molecule.masses))</a>
<a class="sourceLine" id="cb424-23" title="23">M, N <span class="op">=</span> <span class="bu">len</span>(beads_mappings), <span class="bu">len</span>(molecule)</a>
<a class="sourceLine" id="cb424-24" title="24">CG_matrix <span class="op">=</span> np.zeros((M, N))</a>
<a class="sourceLine" id="cb424-25" title="25">index <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb424-26" title="26"><span class="cf">for</span> s <span class="kw">in</span> <span class="bu">range</span>(M):</a>
<a class="sourceLine" id="cb424-27" title="27">    <span class="cf">for</span> i, atom <span class="kw">in</span> <span class="bu">enumerate</span>(beads_mappings[s]):</a>
<a class="sourceLine" id="cb424-28" title="28">        CG_matrix[s, i <span class="op">+</span> index] <span class="op">=</span> [v <span class="cf">for</span> k,</a>
<a class="sourceLine" id="cb424-29" title="29">                                   v <span class="kw">in</span> Mws_dict.items() <span class="cf">if</span> atom <span class="kw">in</span> k][<span class="dv">0</span>]</a>
<a class="sourceLine" id="cb424-30" title="30">    index <span class="op">+=</span> np.count_nonzero(CG_matrix[s])</a>
<a class="sourceLine" id="cb424-31" title="31">    CG_matrix[s] <span class="op">=</span> CG_matrix[s] <span class="op">/</span> np.<span class="bu">sum</span>(CG_matrix[s])</a>
<a class="sourceLine" id="cb424-32" title="32"></a>
<a class="sourceLine" id="cb424-33" title="33">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(</a>
<a class="sourceLine" id="cb424-34" title="34">    CG_matrix, mapping_operator(molecule, beads_mappings)).<span class="bu">all</span>() <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>&#39;list&#39; object has no attribute &#39;masses&#39;</code></pre>
<h4 id="run-3-38">Run 3</h4>
<div class="sourceCode" id="cb426"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb426-1" title="1"><span class="im">import</span> MDAnalysis</a>
<a class="sourceLine" id="cb426-2" title="2"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb426-3" title="3"></a>
<a class="sourceLine" id="cb426-4" title="4"><span class="kw">def</span> mapping_operator(molecule, beads_mappings):</a>
<a class="sourceLine" id="cb426-5" title="5">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb426-6" title="6"><span class="co">  This function generates a mass-mass weighted mapping matrix given an MD analysis molecule</span></a>
<a class="sourceLine" id="cb426-7" title="7"><span class="co">  and atom selections for the beads.</span></a>
<a class="sourceLine" id="cb426-8" title="8"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb426-9" title="9">  M <span class="op">=</span> np.zeros((<span class="bu">len</span>(beads_mappings), molecule.n_atoms))</a>
<a class="sourceLine" id="cb426-10" title="10">  <span class="cf">for</span> i, bead <span class="kw">in</span> <span class="bu">enumerate</span>(beads_mappings):</a>
<a class="sourceLine" id="cb426-11" title="11">    M[i, bead.indices] <span class="op">=</span> bead.masses</a>
<a class="sourceLine" id="cb426-12" title="12">  M <span class="op">/=</span> np.<span class="bu">sum</span>(M, axis<span class="op">=</span><span class="dv">1</span>)[:, np.newaxis]</a>
<a class="sourceLine" id="cb426-13" title="13">  <span class="cf">return</span> M</a>
<a class="sourceLine" id="cb426-14" title="14"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb426-15" title="15"><span class="im">import</span> MDAnalysis <span class="im">as</span> mda</a>
<a class="sourceLine" id="cb426-16" title="16"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb426-17" title="17"></a>
<a class="sourceLine" id="cb426-18" title="18"><span class="co"># read molecule</span></a>
<a class="sourceLine" id="cb426-19" title="19">u <span class="op">=</span> mda.Universe(os.path.join(_FILE_DIR_, <span class="st">&#39;water.gro&#39;</span>))</a>
<a class="sourceLine" id="cb426-20" title="20">molecule <span class="op">=</span> u.atoms</a>
<a class="sourceLine" id="cb426-21" title="21"><span class="co"># define atoms that belong to the a single bead</span></a>
<a class="sourceLine" id="cb426-22" title="22">beads_mappings <span class="op">=</span> [[<span class="st">&#39;OW&#39;</span>, <span class="st">&#39;HW1&#39;</span>, <span class="st">&#39;HW2&#39;</span>]]</a>
<a class="sourceLine" id="cb426-23" title="23">Mws_dict <span class="op">=</span> <span class="bu">dict</span>(<span class="bu">zip</span>(molecule.names, molecule.masses))</a>
<a class="sourceLine" id="cb426-24" title="24">M, N <span class="op">=</span> <span class="bu">len</span>(beads_mappings), <span class="bu">len</span>(molecule)</a>
<a class="sourceLine" id="cb426-25" title="25">CG_matrix <span class="op">=</span> np.zeros((M, N))</a>
<a class="sourceLine" id="cb426-26" title="26">index <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb426-27" title="27"><span class="cf">for</span> s <span class="kw">in</span> <span class="bu">range</span>(M):</a>
<a class="sourceLine" id="cb426-28" title="28">    <span class="cf">for</span> i, atom <span class="kw">in</span> <span class="bu">enumerate</span>(beads_mappings[s]):</a>
<a class="sourceLine" id="cb426-29" title="29">        CG_matrix[s, i <span class="op">+</span> index] <span class="op">=</span> [v <span class="cf">for</span> k,</a>
<a class="sourceLine" id="cb426-30" title="30">                                   v <span class="kw">in</span> Mws_dict.items() <span class="cf">if</span> atom <span class="kw">in</span> k][<span class="dv">0</span>]</a>
<a class="sourceLine" id="cb426-31" title="31">    index <span class="op">+=</span> np.count_nonzero(CG_matrix[s])</a>
<a class="sourceLine" id="cb426-32" title="32">    CG_matrix[s] <span class="op">=</span> CG_matrix[s] <span class="op">/</span> np.<span class="bu">sum</span>(CG_matrix[s])</a>
<a class="sourceLine" id="cb426-33" title="33"></a>
<a class="sourceLine" id="cb426-34" title="34">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(</a>
<a class="sourceLine" id="cb426-35" title="35">    CG_matrix, mapping_operator(molecule, beads_mappings)).<span class="bu">all</span>() <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>&#39;list&#39; object has no attribute &#39;masses&#39;</code></pre>
<h4 id="run-4-38">Run 4</h4>
<div class="sourceCode" id="cb428"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb428-1" title="1"><span class="im">import</span> MDAnalysis</a>
<a class="sourceLine" id="cb428-2" title="2"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb428-3" title="3"></a>
<a class="sourceLine" id="cb428-4" title="4"><span class="kw">def</span> mapping_operator(molecule, beads_mappings):</a>
<a class="sourceLine" id="cb428-5" title="5">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb428-6" title="6"><span class="co">  This function generates a mass-mass weighted mapping matrix given an MD analysis molecule</span></a>
<a class="sourceLine" id="cb428-7" title="7"><span class="co">  and atom selections for the beads.</span></a>
<a class="sourceLine" id="cb428-8" title="8"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb428-9" title="9">  M <span class="op">=</span> np.zeros((<span class="bu">len</span>(beads_mappings), molecule.n_atoms))</a>
<a class="sourceLine" id="cb428-10" title="10">  <span class="cf">for</span> i, beads_selection <span class="kw">in</span> <span class="bu">enumerate</span>(beads_mappings):</a>
<a class="sourceLine" id="cb428-11" title="11">    M[i,:] <span class="op">=</span> np.<span class="bu">sum</span>(molecule.atoms.masses[beads_selection.indices])</a>
<a class="sourceLine" id="cb428-12" title="12"></a>
<a class="sourceLine" id="cb428-13" title="13">  <span class="cf">return</span> M</a>
<a class="sourceLine" id="cb428-14" title="14"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb428-15" title="15"><span class="im">import</span> MDAnalysis <span class="im">as</span> mda</a>
<a class="sourceLine" id="cb428-16" title="16"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb428-17" title="17"></a>
<a class="sourceLine" id="cb428-18" title="18"><span class="co"># read molecule</span></a>
<a class="sourceLine" id="cb428-19" title="19">u <span class="op">=</span> mda.Universe(os.path.join(_FILE_DIR_, <span class="st">&#39;water.gro&#39;</span>))</a>
<a class="sourceLine" id="cb428-20" title="20">molecule <span class="op">=</span> u.atoms</a>
<a class="sourceLine" id="cb428-21" title="21"><span class="co"># define atoms that belong to the a single bead</span></a>
<a class="sourceLine" id="cb428-22" title="22">beads_mappings <span class="op">=</span> [[<span class="st">&#39;OW&#39;</span>, <span class="st">&#39;HW1&#39;</span>, <span class="st">&#39;HW2&#39;</span>]]</a>
<a class="sourceLine" id="cb428-23" title="23">Mws_dict <span class="op">=</span> <span class="bu">dict</span>(<span class="bu">zip</span>(molecule.names, molecule.masses))</a>
<a class="sourceLine" id="cb428-24" title="24">M, N <span class="op">=</span> <span class="bu">len</span>(beads_mappings), <span class="bu">len</span>(molecule)</a>
<a class="sourceLine" id="cb428-25" title="25">CG_matrix <span class="op">=</span> np.zeros((M, N))</a>
<a class="sourceLine" id="cb428-26" title="26">index <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb428-27" title="27"><span class="cf">for</span> s <span class="kw">in</span> <span class="bu">range</span>(M):</a>
<a class="sourceLine" id="cb428-28" title="28">    <span class="cf">for</span> i, atom <span class="kw">in</span> <span class="bu">enumerate</span>(beads_mappings[s]):</a>
<a class="sourceLine" id="cb428-29" title="29">        CG_matrix[s, i <span class="op">+</span> index] <span class="op">=</span> [v <span class="cf">for</span> k,</a>
<a class="sourceLine" id="cb428-30" title="30">                                   v <span class="kw">in</span> Mws_dict.items() <span class="cf">if</span> atom <span class="kw">in</span> k][<span class="dv">0</span>]</a>
<a class="sourceLine" id="cb428-31" title="31">    index <span class="op">+=</span> np.count_nonzero(CG_matrix[s])</a>
<a class="sourceLine" id="cb428-32" title="32">    CG_matrix[s] <span class="op">=</span> CG_matrix[s] <span class="op">/</span> np.<span class="bu">sum</span>(CG_matrix[s])</a>
<a class="sourceLine" id="cb428-33" title="33"></a>
<a class="sourceLine" id="cb428-34" title="34">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(</a>
<a class="sourceLine" id="cb428-35" title="35">    CG_matrix, mapping_operator(molecule, beads_mappings)).<span class="bu">all</span>() <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>&#39;list&#39; object has no attribute &#39;indices&#39;</code></pre>
</details>
<details>
<p><summary>matpow</summary></p>
<h4 id="query-39">Query</h4>
<div class="sourceCode" id="cb430"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb430-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb430-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb430-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb430-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb430-5" title="5"></a>
<a class="sourceLine" id="cb430-6" title="6"><span class="kw">def</span> matpow(x,n):</a>
<a class="sourceLine" id="cb430-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb430-8" title="8"><span class="co">  This function computes matrix x raised to the power n.</span></a>
<a class="sourceLine" id="cb430-9" title="9"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb430-10" title="10">  [insert]</a>
<a class="sourceLine" id="cb430-11" title="11">  <span class="cf">return</span> r</a></code></pre></div>
<h4 id="run-0-39">Run 0</h4>
<div class="sourceCode" id="cb431"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb431-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb431-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb431-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb431-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb431-5" title="5"></a>
<a class="sourceLine" id="cb431-6" title="6"><span class="kw">def</span> matpow(x,n):</a>
<a class="sourceLine" id="cb431-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb431-8" title="8"><span class="co">  This function computes matrix x raised to the power n.</span></a>
<a class="sourceLine" id="cb431-9" title="9"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb431-10" title="10">  r <span class="op">=</span> np.eye(x.shape[<span class="dv">0</span>])</a>
<a class="sourceLine" id="cb431-11" title="11">  <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n):</a>
<a class="sourceLine" id="cb431-12" title="12">    r <span class="op">=</span> np.dot(r,x)</a>
<a class="sourceLine" id="cb431-13" title="13">  <span class="cf">return</span> r</a>
<a class="sourceLine" id="cb431-14" title="14"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb431-15" title="15"></a>
<a class="sourceLine" id="cb431-16" title="16"></a>
<a class="sourceLine" id="cb431-17" title="17">x <span class="op">=</span> np.array([[<span class="dv">0</span>, <span class="dv">1</span>], [<span class="op">-</span><span class="dv">1</span>, <span class="dv">0</span>]])</a>
<a class="sourceLine" id="cb431-18" title="18"></a>
<a class="sourceLine" id="cb431-19" title="19">true_y <span class="op">=</span> np.linalg.matrix_power(x,<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb431-20" title="20"></a>
<a class="sourceLine" id="cb431-21" title="21">pred_y <span class="op">=</span> matpow(x,<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb431-22" title="22"></a>
<a class="sourceLine" id="cb431-23" title="23">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.allclose(true_y,pred_y) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-39">Run 1</h4>
<div class="sourceCode" id="cb433"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb433-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb433-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb433-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb433-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb433-5" title="5"></a>
<a class="sourceLine" id="cb433-6" title="6"><span class="kw">def</span> matpow(x,n):</a>
<a class="sourceLine" id="cb433-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb433-8" title="8"><span class="co">  This function computes matrix x raised to the power n.</span></a>
<a class="sourceLine" id="cb433-9" title="9"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb433-10" title="10">  r <span class="op">=</span> np.eye(x.shape[<span class="dv">0</span>])</a>
<a class="sourceLine" id="cb433-11" title="11">  <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n):</a>
<a class="sourceLine" id="cb433-12" title="12">    r <span class="op">=</span> np.dot(r,x)</a>
<a class="sourceLine" id="cb433-13" title="13">  <span class="cf">return</span> r</a>
<a class="sourceLine" id="cb433-14" title="14"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb433-15" title="15"></a>
<a class="sourceLine" id="cb433-16" title="16"></a>
<a class="sourceLine" id="cb433-17" title="17">x <span class="op">=</span> np.array([[<span class="dv">0</span>, <span class="dv">1</span>], [<span class="op">-</span><span class="dv">1</span>, <span class="dv">0</span>]])</a>
<a class="sourceLine" id="cb433-18" title="18"></a>
<a class="sourceLine" id="cb433-19" title="19">true_y <span class="op">=</span> np.linalg.matrix_power(x,<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb433-20" title="20"></a>
<a class="sourceLine" id="cb433-21" title="21">pred_y <span class="op">=</span> matpow(x,<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb433-22" title="22"></a>
<a class="sourceLine" id="cb433-23" title="23">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.allclose(true_y,pred_y) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-39">Run 2</h4>
<div class="sourceCode" id="cb435"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb435-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb435-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb435-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb435-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb435-5" title="5"></a>
<a class="sourceLine" id="cb435-6" title="6"><span class="kw">def</span> matpow(x,n):</a>
<a class="sourceLine" id="cb435-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb435-8" title="8"><span class="co">  This function computes matrix x raised to the power n.</span></a>
<a class="sourceLine" id="cb435-9" title="9"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb435-10" title="10">  <span class="cf">if</span> n <span class="op">==</span> <span class="dv">0</span>:</a>
<a class="sourceLine" id="cb435-11" title="11">    <span class="cf">return</span> np.eye(x.shape[<span class="dv">0</span>])</a>
<a class="sourceLine" id="cb435-12" title="12">  <span class="cf">elif</span> n <span class="op">==</span> <span class="dv">1</span>:</a>
<a class="sourceLine" id="cb435-13" title="13">    <span class="cf">return</span> x</a>
<a class="sourceLine" id="cb435-14" title="14">  <span class="cf">elif</span> n <span class="op">%</span> <span class="dv">2</span> <span class="op">==</span> <span class="dv">0</span>:</a>
<a class="sourceLine" id="cb435-15" title="15">    <span class="cf">return</span> matpow(x.dot(x),n<span class="op">/</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb435-16" title="16">  <span class="cf">else</span>:</a>
<a class="sourceLine" id="cb435-17" title="17">    <span class="cf">return</span> x.dot(matpow(x,n<span class="dv">-1</span>))</a>
<a class="sourceLine" id="cb435-18" title="18"></a>
<a class="sourceLine" id="cb435-19" title="19"></a>
<a class="sourceLine" id="cb435-20" title="20">  <span class="cf">return</span> r</a>
<a class="sourceLine" id="cb435-21" title="21"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb435-22" title="22"></a>
<a class="sourceLine" id="cb435-23" title="23"></a>
<a class="sourceLine" id="cb435-24" title="24">x <span class="op">=</span> np.array([[<span class="dv">0</span>, <span class="dv">1</span>], [<span class="op">-</span><span class="dv">1</span>, <span class="dv">0</span>]])</a>
<a class="sourceLine" id="cb435-25" title="25"></a>
<a class="sourceLine" id="cb435-26" title="26">true_y <span class="op">=</span> np.linalg.matrix_power(x,<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb435-27" title="27"></a>
<a class="sourceLine" id="cb435-28" title="28">pred_y <span class="op">=</span> matpow(x,<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb435-29" title="29"></a>
<a class="sourceLine" id="cb435-30" title="30">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.allclose(true_y,pred_y) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-39">Run 3</h4>
<div class="sourceCode" id="cb437"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb437-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb437-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb437-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb437-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb437-5" title="5"></a>
<a class="sourceLine" id="cb437-6" title="6"><span class="kw">def</span> matpow(x,n):</a>
<a class="sourceLine" id="cb437-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb437-8" title="8"><span class="co">  This function computes matrix x raised to the power n.</span></a>
<a class="sourceLine" id="cb437-9" title="9"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb437-10" title="10">  r <span class="op">=</span> np.eye(x.shape[<span class="dv">0</span>])</a>
<a class="sourceLine" id="cb437-11" title="11">  <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n):</a>
<a class="sourceLine" id="cb437-12" title="12">    r <span class="op">=</span> np.dot(r,x)</a>
<a class="sourceLine" id="cb437-13" title="13">  <span class="cf">return</span> r</a>
<a class="sourceLine" id="cb437-14" title="14"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb437-15" title="15"></a>
<a class="sourceLine" id="cb437-16" title="16"></a>
<a class="sourceLine" id="cb437-17" title="17">x <span class="op">=</span> np.array([[<span class="dv">0</span>, <span class="dv">1</span>], [<span class="op">-</span><span class="dv">1</span>, <span class="dv">0</span>]])</a>
<a class="sourceLine" id="cb437-18" title="18"></a>
<a class="sourceLine" id="cb437-19" title="19">true_y <span class="op">=</span> np.linalg.matrix_power(x,<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb437-20" title="20"></a>
<a class="sourceLine" id="cb437-21" title="21">pred_y <span class="op">=</span> matpow(x,<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb437-22" title="22"></a>
<a class="sourceLine" id="cb437-23" title="23">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.allclose(true_y,pred_y) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-39">Run 4</h4>
<div class="sourceCode" id="cb439"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb439-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb439-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb439-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb439-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb439-5" title="5"></a>
<a class="sourceLine" id="cb439-6" title="6"><span class="kw">def</span> matpow(x,n):</a>
<a class="sourceLine" id="cb439-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb439-8" title="8"><span class="co">  This function computes matrix x raised to the power n.</span></a>
<a class="sourceLine" id="cb439-9" title="9"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb439-10" title="10">  r <span class="op">=</span> np.eye(x.shape[<span class="dv">0</span>])</a>
<a class="sourceLine" id="cb439-11" title="11">  <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n):</a>
<a class="sourceLine" id="cb439-12" title="12">    r <span class="op">=</span> np.dot(r,x)</a>
<a class="sourceLine" id="cb439-13" title="13">  <span class="cf">return</span> r</a>
<a class="sourceLine" id="cb439-14" title="14"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb439-15" title="15"></a>
<a class="sourceLine" id="cb439-16" title="16"></a>
<a class="sourceLine" id="cb439-17" title="17">x <span class="op">=</span> np.array([[<span class="dv">0</span>, <span class="dv">1</span>], [<span class="op">-</span><span class="dv">1</span>, <span class="dv">0</span>]])</a>
<a class="sourceLine" id="cb439-18" title="18"></a>
<a class="sourceLine" id="cb439-19" title="19">true_y <span class="op">=</span> np.linalg.matrix_power(x,<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb439-20" title="20"></a>
<a class="sourceLine" id="cb439-21" title="21">pred_y <span class="op">=</span> matpow(x,<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb439-22" title="22"></a>
<a class="sourceLine" id="cb439-23" title="23">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.allclose(true_y,pred_y) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>matrix_factorial</summary></p>
<h4 id="query-40">Query</h4>
<div class="sourceCode" id="cb441"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb441-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb441-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb441-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb441-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb441-5" title="5"></a>
<a class="sourceLine" id="cb441-6" title="6"><span class="kw">def</span> matrix_factorial(n):</a>
<a class="sourceLine" id="cb441-7" title="7">     <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb441-8" title="8"><span class="co">     This function calculates and returns the factorial of a matrix (array) element wise</span></a>
<a class="sourceLine" id="cb441-9" title="9"><span class="co">     &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb441-10" title="10">     [insert]</a>
<a class="sourceLine" id="cb441-11" title="11">     <span class="cf">return</span> f</a></code></pre></div>
<h4 id="run-0-40">Run 0</h4>
<div class="sourceCode" id="cb442"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb442-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb442-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb442-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb442-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb442-5" title="5"></a>
<a class="sourceLine" id="cb442-6" title="6"><span class="kw">def</span> matrix_factorial(n):</a>
<a class="sourceLine" id="cb442-7" title="7">     <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb442-8" title="8"><span class="co">     This function calculates and returns the factorial of a matrix (array) element wise</span></a>
<a class="sourceLine" id="cb442-9" title="9"><span class="co">     &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb442-10" title="10">     f <span class="op">=</span> np.zeros(n.shape)</a>
<a class="sourceLine" id="cb442-11" title="11">     <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n.shape[<span class="dv">0</span>]):</a>
<a class="sourceLine" id="cb442-12" title="12">          <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(n.shape[<span class="dv">1</span>]):</a>
<a class="sourceLine" id="cb442-13" title="13">               f[i,j] <span class="op">=</span> np.math.factorial(n[i,j])</a>
<a class="sourceLine" id="cb442-14" title="14"></a>
<a class="sourceLine" id="cb442-15" title="15">     <span class="cf">return</span> f</a>
<a class="sourceLine" id="cb442-16" title="16"></a>
<a class="sourceLine" id="cb442-17" title="17"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb442-18" title="18"></a>
<a class="sourceLine" id="cb442-19" title="19">x <span class="op">=</span> np.array([[<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>], [<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>]])</a>
<a class="sourceLine" id="cb442-20" title="20">m_f <span class="op">=</span> matrix_factorial(x)</a>
<a class="sourceLine" id="cb442-21" title="21">x_f <span class="op">=</span> np.array([[<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">6</span>], [<span class="dv">24</span>,<span class="dv">120</span>,<span class="dv">720</span>]])</a>
<a class="sourceLine" id="cb442-22" title="22"></a>
<a class="sourceLine" id="cb442-23" title="23">result <span class="op">=</span> np.array_equal(x_f,m_f) </a>
<a class="sourceLine" id="cb442-24" title="24"></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-40">Run 1</h4>
<div class="sourceCode" id="cb444"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb444-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb444-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb444-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb444-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb444-5" title="5"></a>
<a class="sourceLine" id="cb444-6" title="6"><span class="kw">def</span> matrix_factorial(n):</a>
<a class="sourceLine" id="cb444-7" title="7">     <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb444-8" title="8"><span class="co">     This function calculates and returns the factorial of a matrix (array) element wise</span></a>
<a class="sourceLine" id="cb444-9" title="9"><span class="co">     &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb444-10" title="10">     f <span class="op">=</span> np.zeros(n.shape)</a>
<a class="sourceLine" id="cb444-11" title="11">     <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n.shape[<span class="dv">0</span>]):</a>
<a class="sourceLine" id="cb444-12" title="12">          <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(n.shape[<span class="dv">1</span>]):</a>
<a class="sourceLine" id="cb444-13" title="13">               f[i,j] <span class="op">=</span> np.math.factorial(n[i,j])</a>
<a class="sourceLine" id="cb444-14" title="14">     <span class="cf">return</span> f</a>
<a class="sourceLine" id="cb444-15" title="15"></a>
<a class="sourceLine" id="cb444-16" title="16"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb444-17" title="17"></a>
<a class="sourceLine" id="cb444-18" title="18">x <span class="op">=</span> np.array([[<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>], [<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>]])</a>
<a class="sourceLine" id="cb444-19" title="19">m_f <span class="op">=</span> matrix_factorial(x)</a>
<a class="sourceLine" id="cb444-20" title="20">x_f <span class="op">=</span> np.array([[<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">6</span>], [<span class="dv">24</span>,<span class="dv">120</span>,<span class="dv">720</span>]])</a>
<a class="sourceLine" id="cb444-21" title="21"></a>
<a class="sourceLine" id="cb444-22" title="22">result <span class="op">=</span> np.array_equal(x_f,m_f) </a>
<a class="sourceLine" id="cb444-23" title="23"></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-40">Run 2</h4>
<div class="sourceCode" id="cb446"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb446-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb446-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb446-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb446-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb446-5" title="5"></a>
<a class="sourceLine" id="cb446-6" title="6"><span class="kw">def</span> matrix_factorial(n):</a>
<a class="sourceLine" id="cb446-7" title="7">     <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb446-8" title="8"><span class="co">     This function calculates and returns the factorial of a matrix (array) element wise</span></a>
<a class="sourceLine" id="cb446-9" title="9"><span class="co">     &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb446-10" title="10">     f <span class="op">=</span> np.zeros(n.shape)</a>
<a class="sourceLine" id="cb446-11" title="11">     <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n.shape[<span class="dv">0</span>]):</a>
<a class="sourceLine" id="cb446-12" title="12">          <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(n.shape[<span class="dv">1</span>]):</a>
<a class="sourceLine" id="cb446-13" title="13">               f[i,j] <span class="op">=</span> np.math.factorial(n[i,j])</a>
<a class="sourceLine" id="cb446-14" title="14">     <span class="cf">return</span> f</a>
<a class="sourceLine" id="cb446-15" title="15"></a>
<a class="sourceLine" id="cb446-16" title="16"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb446-17" title="17"></a>
<a class="sourceLine" id="cb446-18" title="18">x <span class="op">=</span> np.array([[<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>], [<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>]])</a>
<a class="sourceLine" id="cb446-19" title="19">m_f <span class="op">=</span> matrix_factorial(x)</a>
<a class="sourceLine" id="cb446-20" title="20">x_f <span class="op">=</span> np.array([[<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">6</span>], [<span class="dv">24</span>,<span class="dv">120</span>,<span class="dv">720</span>]])</a>
<a class="sourceLine" id="cb446-21" title="21"></a>
<a class="sourceLine" id="cb446-22" title="22">result <span class="op">=</span> np.array_equal(x_f,m_f) </a>
<a class="sourceLine" id="cb446-23" title="23"></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-40">Run 3</h4>
<div class="sourceCode" id="cb448"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb448-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb448-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb448-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb448-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb448-5" title="5"></a>
<a class="sourceLine" id="cb448-6" title="6"><span class="kw">def</span> matrix_factorial(n):</a>
<a class="sourceLine" id="cb448-7" title="7">     <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb448-8" title="8"><span class="co">     This function calculates and returns the factorial of a matrix (array) element wise</span></a>
<a class="sourceLine" id="cb448-9" title="9"><span class="co">     &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb448-10" title="10">     f <span class="op">=</span> np.zeros(n.shape)</a>
<a class="sourceLine" id="cb448-11" title="11">     <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n.shape[<span class="dv">0</span>]):</a>
<a class="sourceLine" id="cb448-12" title="12">          <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(n.shape[<span class="dv">1</span>]):</a>
<a class="sourceLine" id="cb448-13" title="13">               f[i,j] <span class="op">=</span> np.math.factorial(n[i,j])</a>
<a class="sourceLine" id="cb448-14" title="14"></a>
<a class="sourceLine" id="cb448-15" title="15">     <span class="cf">return</span> f</a>
<a class="sourceLine" id="cb448-16" title="16"></a>
<a class="sourceLine" id="cb448-17" title="17"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb448-18" title="18"></a>
<a class="sourceLine" id="cb448-19" title="19">x <span class="op">=</span> np.array([[<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>], [<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>]])</a>
<a class="sourceLine" id="cb448-20" title="20">m_f <span class="op">=</span> matrix_factorial(x)</a>
<a class="sourceLine" id="cb448-21" title="21">x_f <span class="op">=</span> np.array([[<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">6</span>], [<span class="dv">24</span>,<span class="dv">120</span>,<span class="dv">720</span>]])</a>
<a class="sourceLine" id="cb448-22" title="22"></a>
<a class="sourceLine" id="cb448-23" title="23">result <span class="op">=</span> np.array_equal(x_f,m_f) </a>
<a class="sourceLine" id="cb448-24" title="24"></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-40">Run 4</h4>
<div class="sourceCode" id="cb450"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb450-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb450-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb450-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb450-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb450-5" title="5"></a>
<a class="sourceLine" id="cb450-6" title="6"><span class="kw">def</span> matrix_factorial(n):</a>
<a class="sourceLine" id="cb450-7" title="7">     <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb450-8" title="8"><span class="co">     This function calculates and returns the factorial of a matrix (array) element wise</span></a>
<a class="sourceLine" id="cb450-9" title="9"><span class="co">     &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb450-10" title="10">     f <span class="op">=</span> np.zeros(n.shape)</a>
<a class="sourceLine" id="cb450-11" title="11">     <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n.shape[<span class="dv">0</span>]):</a>
<a class="sourceLine" id="cb450-12" title="12">          <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(n.shape[<span class="dv">1</span>]):</a>
<a class="sourceLine" id="cb450-13" title="13">               f[i,j] <span class="op">=</span> np.math.factorial(n[i,j])</a>
<a class="sourceLine" id="cb450-14" title="14">     <span class="cf">return</span> f</a>
<a class="sourceLine" id="cb450-15" title="15"></a>
<a class="sourceLine" id="cb450-16" title="16"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb450-17" title="17"></a>
<a class="sourceLine" id="cb450-18" title="18">x <span class="op">=</span> np.array([[<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>], [<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>]])</a>
<a class="sourceLine" id="cb450-19" title="19">m_f <span class="op">=</span> matrix_factorial(x)</a>
<a class="sourceLine" id="cb450-20" title="20">x_f <span class="op">=</span> np.array([[<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">6</span>], [<span class="dv">24</span>,<span class="dv">120</span>,<span class="dv">720</span>]])</a>
<a class="sourceLine" id="cb450-21" title="21"></a>
<a class="sourceLine" id="cb450-22" title="22">result <span class="op">=</span> np.array_equal(x_f,m_f) </a>
<a class="sourceLine" id="cb450-23" title="23"></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>max-boltz</summary></p>
<h4 id="query-41">Query</h4>
<div class="sourceCode" id="cb452"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb452-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb452-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb452-3" title="3"></a>
<a class="sourceLine" id="cb452-4" title="4"><span class="kw">def</span> max_boltz_rms_speed(T,M):</a>
<a class="sourceLine" id="cb452-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb452-6" title="6"><span class="co">   This function returns the rms speed of a molecule in m/s</span></a>
<a class="sourceLine" id="cb452-7" title="7"></a>
<a class="sourceLine" id="cb452-8" title="8"><span class="co">   The temperature is T in Kelvin</span></a>
<a class="sourceLine" id="cb452-9" title="9"><span class="co">   The molecule has mass M in kiolograms</span></a>
<a class="sourceLine" id="cb452-10" title="10"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb452-11" title="11">   [insert]</a>
<a class="sourceLine" id="cb452-12" title="12">   <span class="cf">return</span> s</a></code></pre></div>
<h4 id="run-0-41">Run 0</h4>
<div class="sourceCode" id="cb453"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb453-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb453-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb453-3" title="3"></a>
<a class="sourceLine" id="cb453-4" title="4"><span class="kw">def</span> max_boltz_rms_speed(T,M):</a>
<a class="sourceLine" id="cb453-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb453-6" title="6"><span class="co">   This function returns the rms speed of a molecule in m/s</span></a>
<a class="sourceLine" id="cb453-7" title="7"></a>
<a class="sourceLine" id="cb453-8" title="8"><span class="co">   The temperature is T in Kelvin</span></a>
<a class="sourceLine" id="cb453-9" title="9"><span class="co">   The molecule has mass M in kiolograms</span></a>
<a class="sourceLine" id="cb453-10" title="10"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb453-11" title="11">   k <span class="op">=</span> <span class="fl">1.3806503e-23</span></a>
<a class="sourceLine" id="cb453-12" title="12">   s <span class="op">=</span> math.sqrt(<span class="dv">3</span><span class="op">*</span>k<span class="op">*</span>T<span class="op">/</span>M)</a>
<a class="sourceLine" id="cb453-13" title="13">   <span class="cf">return</span> s</a>
<a class="sourceLine" id="cb453-14" title="14"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb453-15" title="15"></a>
<a class="sourceLine" id="cb453-16" title="16"><span class="co"># input params</span></a>
<a class="sourceLine" id="cb453-17" title="17">M <span class="op">=</span> <span class="fl">32e-3</span>           <span class="co"># for O2, kg/mol</span></a>
<a class="sourceLine" id="cb453-18" title="18">R <span class="op">=</span> <span class="fl">8.314</span>           <span class="co"># J/mol.K</span></a>
<a class="sourceLine" id="cb453-19" title="19">T <span class="op">=</span> <span class="dv">300</span></a>
<a class="sourceLine" id="cb453-20" title="20"></a>
<a class="sourceLine" id="cb453-21" title="21">c_rms <span class="op">=</span> np.sqrt(<span class="fl">3.0</span><span class="op">*</span>R<span class="op">*</span>T<span class="op">/</span>M)</a>
<a class="sourceLine" id="cb453-22" title="22"><span class="co">#print(&quot;rms speeds :&quot;, c_rms)</span></a>
<a class="sourceLine" id="cb453-23" title="23"></a>
<a class="sourceLine" id="cb453-24" title="24">M_in_kg <span class="op">=</span> M<span class="op">/</span><span class="fl">6.022e23</span></a>
<a class="sourceLine" id="cb453-25" title="25"></a>
<a class="sourceLine" id="cb453-26" title="26">c_rms_codex <span class="op">=</span> max_boltz_rms_speed(T,M_in_kg)</a>
<a class="sourceLine" id="cb453-27" title="27"><span class="co">#print(&quot;rms speeds from codex :&quot;, c_rms_codex)</span></a>
<a class="sourceLine" id="cb453-28" title="28"></a>
<a class="sourceLine" id="cb453-29" title="29"><span class="co"># check</span></a>
<a class="sourceLine" id="cb453-30" title="30"><span class="cf">if</span> np.isclose(c_rms,c_rms_codex,rtol<span class="op">=</span><span class="fl">0.01</span>):</a>
<a class="sourceLine" id="cb453-31" title="31">    result <span class="op">=</span> <span class="va">True</span> </a>
<a class="sourceLine" id="cb453-32" title="32"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb453-33" title="33">    result <span class="op">=</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-41">Run 1</h4>
<div class="sourceCode" id="cb455"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb455-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb455-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb455-3" title="3"></a>
<a class="sourceLine" id="cb455-4" title="4"><span class="kw">def</span> max_boltz_rms_speed(T,M):</a>
<a class="sourceLine" id="cb455-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb455-6" title="6"><span class="co">   This function returns the rms speed of a molecule in m/s</span></a>
<a class="sourceLine" id="cb455-7" title="7"></a>
<a class="sourceLine" id="cb455-8" title="8"><span class="co">   The temperature is T in Kelvin</span></a>
<a class="sourceLine" id="cb455-9" title="9"><span class="co">   The molecule has mass M in kiolograms</span></a>
<a class="sourceLine" id="cb455-10" title="10"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb455-11" title="11">   k <span class="op">=</span> <span class="fl">1.38064852e-23</span></a>
<a class="sourceLine" id="cb455-12" title="12">   s <span class="op">=</span> math.sqrt(<span class="dv">3</span><span class="op">*</span>k<span class="op">*</span>T<span class="op">/</span>M)</a>
<a class="sourceLine" id="cb455-13" title="13">   <span class="cf">return</span> s</a>
<a class="sourceLine" id="cb455-14" title="14"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb455-15" title="15"></a>
<a class="sourceLine" id="cb455-16" title="16"><span class="co"># input params</span></a>
<a class="sourceLine" id="cb455-17" title="17">M <span class="op">=</span> <span class="fl">32e-3</span>           <span class="co"># for O2, kg/mol</span></a>
<a class="sourceLine" id="cb455-18" title="18">R <span class="op">=</span> <span class="fl">8.314</span>           <span class="co"># J/mol.K</span></a>
<a class="sourceLine" id="cb455-19" title="19">T <span class="op">=</span> <span class="dv">300</span></a>
<a class="sourceLine" id="cb455-20" title="20"></a>
<a class="sourceLine" id="cb455-21" title="21">c_rms <span class="op">=</span> np.sqrt(<span class="fl">3.0</span><span class="op">*</span>R<span class="op">*</span>T<span class="op">/</span>M)</a>
<a class="sourceLine" id="cb455-22" title="22"><span class="co">#print(&quot;rms speeds :&quot;, c_rms)</span></a>
<a class="sourceLine" id="cb455-23" title="23"></a>
<a class="sourceLine" id="cb455-24" title="24">M_in_kg <span class="op">=</span> M<span class="op">/</span><span class="fl">6.022e23</span></a>
<a class="sourceLine" id="cb455-25" title="25"></a>
<a class="sourceLine" id="cb455-26" title="26">c_rms_codex <span class="op">=</span> max_boltz_rms_speed(T,M_in_kg)</a>
<a class="sourceLine" id="cb455-27" title="27"><span class="co">#print(&quot;rms speeds from codex :&quot;, c_rms_codex)</span></a>
<a class="sourceLine" id="cb455-28" title="28"></a>
<a class="sourceLine" id="cb455-29" title="29"><span class="co"># check</span></a>
<a class="sourceLine" id="cb455-30" title="30"><span class="cf">if</span> np.isclose(c_rms,c_rms_codex,rtol<span class="op">=</span><span class="fl">0.01</span>):</a>
<a class="sourceLine" id="cb455-31" title="31">    result <span class="op">=</span> <span class="va">True</span> </a>
<a class="sourceLine" id="cb455-32" title="32"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb455-33" title="33">    result <span class="op">=</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-41">Run 2</h4>
<div class="sourceCode" id="cb457"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb457-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb457-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb457-3" title="3"></a>
<a class="sourceLine" id="cb457-4" title="4"><span class="kw">def</span> max_boltz_rms_speed(T,M):</a>
<a class="sourceLine" id="cb457-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb457-6" title="6"><span class="co">   This function returns the rms speed of a molecule in m/s</span></a>
<a class="sourceLine" id="cb457-7" title="7"></a>
<a class="sourceLine" id="cb457-8" title="8"><span class="co">   The temperature is T in Kelvin</span></a>
<a class="sourceLine" id="cb457-9" title="9"><span class="co">   The molecule has mass M in kiolograms</span></a>
<a class="sourceLine" id="cb457-10" title="10"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb457-11" title="11">   k <span class="op">=</span> <span class="fl">1.38064852e-23</span></a>
<a class="sourceLine" id="cb457-12" title="12">   s <span class="op">=</span> math.sqrt(<span class="dv">3</span><span class="op">*</span>k<span class="op">*</span>T<span class="op">/</span>M)</a>
<a class="sourceLine" id="cb457-13" title="13">   <span class="cf">return</span> s</a>
<a class="sourceLine" id="cb457-14" title="14"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb457-15" title="15"></a>
<a class="sourceLine" id="cb457-16" title="16"><span class="co"># input params</span></a>
<a class="sourceLine" id="cb457-17" title="17">M <span class="op">=</span> <span class="fl">32e-3</span>           <span class="co"># for O2, kg/mol</span></a>
<a class="sourceLine" id="cb457-18" title="18">R <span class="op">=</span> <span class="fl">8.314</span>           <span class="co"># J/mol.K</span></a>
<a class="sourceLine" id="cb457-19" title="19">T <span class="op">=</span> <span class="dv">300</span></a>
<a class="sourceLine" id="cb457-20" title="20"></a>
<a class="sourceLine" id="cb457-21" title="21">c_rms <span class="op">=</span> np.sqrt(<span class="fl">3.0</span><span class="op">*</span>R<span class="op">*</span>T<span class="op">/</span>M)</a>
<a class="sourceLine" id="cb457-22" title="22"><span class="co">#print(&quot;rms speeds :&quot;, c_rms)</span></a>
<a class="sourceLine" id="cb457-23" title="23"></a>
<a class="sourceLine" id="cb457-24" title="24">M_in_kg <span class="op">=</span> M<span class="op">/</span><span class="fl">6.022e23</span></a>
<a class="sourceLine" id="cb457-25" title="25"></a>
<a class="sourceLine" id="cb457-26" title="26">c_rms_codex <span class="op">=</span> max_boltz_rms_speed(T,M_in_kg)</a>
<a class="sourceLine" id="cb457-27" title="27"><span class="co">#print(&quot;rms speeds from codex :&quot;, c_rms_codex)</span></a>
<a class="sourceLine" id="cb457-28" title="28"></a>
<a class="sourceLine" id="cb457-29" title="29"><span class="co"># check</span></a>
<a class="sourceLine" id="cb457-30" title="30"><span class="cf">if</span> np.isclose(c_rms,c_rms_codex,rtol<span class="op">=</span><span class="fl">0.01</span>):</a>
<a class="sourceLine" id="cb457-31" title="31">    result <span class="op">=</span> <span class="va">True</span> </a>
<a class="sourceLine" id="cb457-32" title="32"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb457-33" title="33">    result <span class="op">=</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-41">Run 3</h4>
<div class="sourceCode" id="cb459"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb459-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb459-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb459-3" title="3"></a>
<a class="sourceLine" id="cb459-4" title="4"><span class="kw">def</span> max_boltz_rms_speed(T,M):</a>
<a class="sourceLine" id="cb459-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb459-6" title="6"><span class="co">   This function returns the rms speed of a molecule in m/s</span></a>
<a class="sourceLine" id="cb459-7" title="7"></a>
<a class="sourceLine" id="cb459-8" title="8"><span class="co">   The temperature is T in Kelvin</span></a>
<a class="sourceLine" id="cb459-9" title="9"><span class="co">   The molecule has mass M in kiolograms</span></a>
<a class="sourceLine" id="cb459-10" title="10"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb459-11" title="11">   k <span class="op">=</span> <span class="fl">1.3806488e-23</span></a>
<a class="sourceLine" id="cb459-12" title="12">   s <span class="op">=</span> math.sqrt(<span class="dv">3</span><span class="op">*</span>k<span class="op">*</span>T<span class="op">/</span>M)</a>
<a class="sourceLine" id="cb459-13" title="13">   <span class="cf">return</span> s</a>
<a class="sourceLine" id="cb459-14" title="14"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb459-15" title="15"></a>
<a class="sourceLine" id="cb459-16" title="16"><span class="co"># input params</span></a>
<a class="sourceLine" id="cb459-17" title="17">M <span class="op">=</span> <span class="fl">32e-3</span>           <span class="co"># for O2, kg/mol</span></a>
<a class="sourceLine" id="cb459-18" title="18">R <span class="op">=</span> <span class="fl">8.314</span>           <span class="co"># J/mol.K</span></a>
<a class="sourceLine" id="cb459-19" title="19">T <span class="op">=</span> <span class="dv">300</span></a>
<a class="sourceLine" id="cb459-20" title="20"></a>
<a class="sourceLine" id="cb459-21" title="21">c_rms <span class="op">=</span> np.sqrt(<span class="fl">3.0</span><span class="op">*</span>R<span class="op">*</span>T<span class="op">/</span>M)</a>
<a class="sourceLine" id="cb459-22" title="22"><span class="co">#print(&quot;rms speeds :&quot;, c_rms)</span></a>
<a class="sourceLine" id="cb459-23" title="23"></a>
<a class="sourceLine" id="cb459-24" title="24">M_in_kg <span class="op">=</span> M<span class="op">/</span><span class="fl">6.022e23</span></a>
<a class="sourceLine" id="cb459-25" title="25"></a>
<a class="sourceLine" id="cb459-26" title="26">c_rms_codex <span class="op">=</span> max_boltz_rms_speed(T,M_in_kg)</a>
<a class="sourceLine" id="cb459-27" title="27"><span class="co">#print(&quot;rms speeds from codex :&quot;, c_rms_codex)</span></a>
<a class="sourceLine" id="cb459-28" title="28"></a>
<a class="sourceLine" id="cb459-29" title="29"><span class="co"># check</span></a>
<a class="sourceLine" id="cb459-30" title="30"><span class="cf">if</span> np.isclose(c_rms,c_rms_codex,rtol<span class="op">=</span><span class="fl">0.01</span>):</a>
<a class="sourceLine" id="cb459-31" title="31">    result <span class="op">=</span> <span class="va">True</span> </a>
<a class="sourceLine" id="cb459-32" title="32"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb459-33" title="33">    result <span class="op">=</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-41">Run 4</h4>
<div class="sourceCode" id="cb461"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb461-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb461-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb461-3" title="3"></a>
<a class="sourceLine" id="cb461-4" title="4"><span class="kw">def</span> max_boltz_rms_speed(T,M):</a>
<a class="sourceLine" id="cb461-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb461-6" title="6"><span class="co">   This function returns the rms speed of a molecule in m/s</span></a>
<a class="sourceLine" id="cb461-7" title="7"></a>
<a class="sourceLine" id="cb461-8" title="8"><span class="co">   The temperature is T in Kelvin</span></a>
<a class="sourceLine" id="cb461-9" title="9"><span class="co">   The molecule has mass M in kiolograms</span></a>
<a class="sourceLine" id="cb461-10" title="10"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb461-11" title="11">   k <span class="op">=</span> <span class="fl">1.3806488e-23</span></a>
<a class="sourceLine" id="cb461-12" title="12">   s <span class="op">=</span> math.sqrt(<span class="fl">3.0</span><span class="op">*</span>k<span class="op">*</span>T<span class="op">/</span>M)</a>
<a class="sourceLine" id="cb461-13" title="13">   <span class="cf">return</span> s</a>
<a class="sourceLine" id="cb461-14" title="14"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb461-15" title="15"></a>
<a class="sourceLine" id="cb461-16" title="16"><span class="co"># input params</span></a>
<a class="sourceLine" id="cb461-17" title="17">M <span class="op">=</span> <span class="fl">32e-3</span>           <span class="co"># for O2, kg/mol</span></a>
<a class="sourceLine" id="cb461-18" title="18">R <span class="op">=</span> <span class="fl">8.314</span>           <span class="co"># J/mol.K</span></a>
<a class="sourceLine" id="cb461-19" title="19">T <span class="op">=</span> <span class="dv">300</span></a>
<a class="sourceLine" id="cb461-20" title="20"></a>
<a class="sourceLine" id="cb461-21" title="21">c_rms <span class="op">=</span> np.sqrt(<span class="fl">3.0</span><span class="op">*</span>R<span class="op">*</span>T<span class="op">/</span>M)</a>
<a class="sourceLine" id="cb461-22" title="22"><span class="co">#print(&quot;rms speeds :&quot;, c_rms)</span></a>
<a class="sourceLine" id="cb461-23" title="23"></a>
<a class="sourceLine" id="cb461-24" title="24">M_in_kg <span class="op">=</span> M<span class="op">/</span><span class="fl">6.022e23</span></a>
<a class="sourceLine" id="cb461-25" title="25"></a>
<a class="sourceLine" id="cb461-26" title="26">c_rms_codex <span class="op">=</span> max_boltz_rms_speed(T,M_in_kg)</a>
<a class="sourceLine" id="cb461-27" title="27"><span class="co">#print(&quot;rms speeds from codex :&quot;, c_rms_codex)</span></a>
<a class="sourceLine" id="cb461-28" title="28"></a>
<a class="sourceLine" id="cb461-29" title="29"><span class="co"># check</span></a>
<a class="sourceLine" id="cb461-30" title="30"><span class="cf">if</span> np.isclose(c_rms,c_rms_codex,rtol<span class="op">=</span><span class="fl">0.01</span>):</a>
<a class="sourceLine" id="cb461-31" title="31">    result <span class="op">=</span> <span class="va">True</span> </a>
<a class="sourceLine" id="cb461-32" title="32"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb461-33" title="33">    result <span class="op">=</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>mol_charge</summary></p>
<h4 id="query-42">Query</h4>
<div class="sourceCode" id="cb463"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb463-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb463-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb463-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb463-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb463-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb463-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb463-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb463-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb463-9" title="9"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb463-10" title="10"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb463-11" title="11"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb463-12" title="12"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb463-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb463-14" title="14"></a>
<a class="sourceLine" id="cb463-15" title="15"><span class="kw">def</span> net_charge(smiles):</a>
<a class="sourceLine" id="cb463-16" title="16">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb463-17" title="17"><span class="co">    This function returns net charge of given molecule</span></a>
<a class="sourceLine" id="cb463-18" title="18"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb463-19" title="19">    [insert]</a>
<a class="sourceLine" id="cb463-20" title="20">    <span class="cf">return</span> charge</a></code></pre></div>
<h4 id="run-0-42">Run 0</h4>
<div class="sourceCode" id="cb464"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb464-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb464-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb464-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb464-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb464-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb464-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb464-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb464-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb464-9" title="9"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb464-10" title="10"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb464-11" title="11"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb464-12" title="12"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb464-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb464-14" title="14"></a>
<a class="sourceLine" id="cb464-15" title="15"><span class="kw">def</span> net_charge(smiles):</a>
<a class="sourceLine" id="cb464-16" title="16">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb464-17" title="17"><span class="co">    This function returns net charge of given molecule</span></a>
<a class="sourceLine" id="cb464-18" title="18"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb464-19" title="19">    mol <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb464-20" title="20">    charge <span class="op">=</span> Descriptors.MolLogP(mol)</a>
<a class="sourceLine" id="cb464-21" title="21">    <span class="cf">if</span> charge <span class="kw">is</span> <span class="va">None</span>:</a>
<a class="sourceLine" id="cb464-22" title="22">        charge <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb464-23" title="23">    <span class="cf">else</span>:</a>
<a class="sourceLine" id="cb464-24" title="24">        charge <span class="op">=</span> <span class="bu">int</span>(charge)</a>
<a class="sourceLine" id="cb464-25" title="25">    <span class="cf">return</span> charge</a>
<a class="sourceLine" id="cb464-26" title="26"></a>
<a class="sourceLine" id="cb464-27" title="27">s <span class="op">=</span> <span class="st">&#39;C1([O-])C=CC=C1NC2CCCCCC2C3=CC=CC=C3&#39;</span></a>
<a class="sourceLine" id="cb464-28" title="28">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> net_charge(s) <span class="op">==</span> <span class="dv">-1</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-42">Run 1</h4>
<div class="sourceCode" id="cb466"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb466-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb466-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb466-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb466-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb466-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb466-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb466-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb466-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb466-9" title="9"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb466-10" title="10"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb466-11" title="11"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb466-12" title="12"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb466-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb466-14" title="14"></a>
<a class="sourceLine" id="cb466-15" title="15"><span class="kw">def</span> net_charge(smiles):</a>
<a class="sourceLine" id="cb466-16" title="16">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb466-17" title="17"><span class="co">    This function returns net charge of given molecule</span></a>
<a class="sourceLine" id="cb466-18" title="18"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb466-19" title="19">    mol <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb466-20" title="20">    charge <span class="op">=</span> Descriptors.MolWt(mol)</a>
<a class="sourceLine" id="cb466-21" title="21">    <span class="cf">return</span> charge</a>
<a class="sourceLine" id="cb466-22" title="22"></a>
<a class="sourceLine" id="cb466-23" title="23">s <span class="op">=</span> <span class="st">&#39;C1([O-])C=CC=C1NC2CCCCCC2C3=CC=CC=C3&#39;</span></a>
<a class="sourceLine" id="cb466-24" title="24">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> net_charge(s) <span class="op">==</span> <span class="dv">-1</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-42">Run 2</h4>
<div class="sourceCode" id="cb468"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb468-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb468-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb468-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb468-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb468-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb468-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb468-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb468-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb468-9" title="9"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb468-10" title="10"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb468-11" title="11"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb468-12" title="12"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb468-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb468-14" title="14"></a>
<a class="sourceLine" id="cb468-15" title="15"><span class="kw">def</span> net_charge(smiles):</a>
<a class="sourceLine" id="cb468-16" title="16">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb468-17" title="17"><span class="co">    This function returns net charge of given molecule</span></a>
<a class="sourceLine" id="cb468-18" title="18"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb468-19" title="19">    mol <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb468-20" title="20">    charge <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb468-21" title="21">    <span class="cf">for</span> atom <span class="kw">in</span> mol.GetAtoms():</a>
<a class="sourceLine" id="cb468-22" title="22">        charge <span class="op">+=</span> atom.GetFormalCharge()</a>
<a class="sourceLine" id="cb468-23" title="23">    <span class="cf">return</span> charge</a>
<a class="sourceLine" id="cb468-24" title="24"></a>
<a class="sourceLine" id="cb468-25" title="25">s <span class="op">=</span> <span class="st">&#39;C1([O-])C=CC=C1NC2CCCCCC2C3=CC=CC=C3&#39;</span></a>
<a class="sourceLine" id="cb468-26" title="26">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> net_charge(s) <span class="op">==</span> <span class="dv">-1</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-42">Run 3</h4>
<div class="sourceCode" id="cb470"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb470-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb470-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb470-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb470-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb470-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb470-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb470-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb470-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb470-9" title="9"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb470-10" title="10"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb470-11" title="11"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb470-12" title="12"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb470-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb470-14" title="14"></a>
<a class="sourceLine" id="cb470-15" title="15"><span class="kw">def</span> net_charge(smiles):</a>
<a class="sourceLine" id="cb470-16" title="16">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb470-17" title="17"><span class="co">    This function returns net charge of given molecule</span></a>
<a class="sourceLine" id="cb470-18" title="18"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb470-19" title="19">    mol <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb470-20" title="20">    charge <span class="op">=</span> Descriptors.MolWt(mol)</a>
<a class="sourceLine" id="cb470-21" title="21">    <span class="cf">return</span> charge</a>
<a class="sourceLine" id="cb470-22" title="22"></a>
<a class="sourceLine" id="cb470-23" title="23">s <span class="op">=</span> <span class="st">&#39;C1([O-])C=CC=C1NC2CCCCCC2C3=CC=CC=C3&#39;</span></a>
<a class="sourceLine" id="cb470-24" title="24">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> net_charge(s) <span class="op">==</span> <span class="dv">-1</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-42">Run 4</h4>
<div class="sourceCode" id="cb472"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb472-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb472-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb472-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb472-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb472-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb472-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb472-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb472-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb472-9" title="9"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb472-10" title="10"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb472-11" title="11"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb472-12" title="12"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb472-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb472-14" title="14"></a>
<a class="sourceLine" id="cb472-15" title="15"><span class="kw">def</span> net_charge(smiles):</a>
<a class="sourceLine" id="cb472-16" title="16">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb472-17" title="17"><span class="co">    This function returns net charge of given molecule</span></a>
<a class="sourceLine" id="cb472-18" title="18"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb472-19" title="19">    mol <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb472-20" title="20">    charge <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb472-21" title="21">    <span class="cf">for</span> atom <span class="kw">in</span> mol.GetAtoms():</a>
<a class="sourceLine" id="cb472-22" title="22">        charge <span class="op">+=</span> atom.GetFormalCharge()</a>
<a class="sourceLine" id="cb472-23" title="23">    <span class="cf">return</span> charge</a>
<a class="sourceLine" id="cb472-24" title="24"></a>
<a class="sourceLine" id="cb472-25" title="25">s <span class="op">=</span> <span class="st">&#39;C1([O-])C=CC=C1NC2CCCCCC2C3=CC=CC=C3&#39;</span></a>
<a class="sourceLine" id="cb472-26" title="26">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> net_charge(s) <span class="op">==</span> <span class="dv">-1</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>net_charge</summary></p>
<h4 id="query-43">Query</h4>
<div class="sourceCode" id="cb474"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb474-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb474-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb474-3" title="3"></a>
<a class="sourceLine" id="cb474-4" title="4"><span class="kw">def</span> net_charge(sequence):</a>
<a class="sourceLine" id="cb474-5" title="5">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb474-6" title="6"><span class="co">    This function returns net charge of amino acid sequence</span></a>
<a class="sourceLine" id="cb474-7" title="7"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb474-8" title="8">    [insert]</a>
<a class="sourceLine" id="cb474-9" title="9">    <span class="cf">return</span> charge</a></code></pre></div>
<h4 id="run-0-43">Run 0</h4>
<div class="sourceCode" id="cb475"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb475-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb475-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb475-3" title="3"></a>
<a class="sourceLine" id="cb475-4" title="4"><span class="kw">def</span> net_charge(sequence):</a>
<a class="sourceLine" id="cb475-5" title="5">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb475-6" title="6"><span class="co">    This function returns net charge of amino acid sequence</span></a>
<a class="sourceLine" id="cb475-7" title="7"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb475-8" title="8">    charge <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb475-9" title="9">    <span class="cf">for</span> i <span class="kw">in</span> sequence:</a>
<a class="sourceLine" id="cb475-10" title="10">        <span class="cf">if</span> i <span class="op">==</span> <span class="st">&#39;K&#39;</span> <span class="kw">or</span> i <span class="op">==</span> <span class="st">&#39;R&#39;</span>:</a>
<a class="sourceLine" id="cb475-11" title="11">            charge <span class="op">+=</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb475-12" title="12">        <span class="cf">elif</span> i <span class="op">==</span> <span class="st">&#39;D&#39;</span> <span class="kw">or</span> i <span class="op">==</span> <span class="st">&#39;E&#39;</span>:</a>
<a class="sourceLine" id="cb475-13" title="13">            charge <span class="op">-=</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb475-14" title="14">        <span class="cf">else</span>:</a>
<a class="sourceLine" id="cb475-15" title="15">            charge <span class="op">+=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb475-16" title="16"></a>
<a class="sourceLine" id="cb475-17" title="17">    <span class="cf">return</span> charge</a>
<a class="sourceLine" id="cb475-18" title="18"></a>
<a class="sourceLine" id="cb475-19" title="19">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> net_charge(<span class="st">&quot;DSAVRCPQD&quot;</span>) <span class="op">==</span> <span class="dv">-1</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-43">Run 1</h4>
<div class="sourceCode" id="cb477"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb477-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb477-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb477-3" title="3"></a>
<a class="sourceLine" id="cb477-4" title="4"><span class="kw">def</span> net_charge(sequence):</a>
<a class="sourceLine" id="cb477-5" title="5">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb477-6" title="6"><span class="co">    This function returns net charge of amino acid sequence</span></a>
<a class="sourceLine" id="cb477-7" title="7"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb477-8" title="8">    charge <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb477-9" title="9">    <span class="cf">for</span> aa <span class="kw">in</span> sequence:</a>
<a class="sourceLine" id="cb477-10" title="10">        <span class="cf">if</span> aa <span class="kw">in</span> [<span class="st">&#39;R&#39;</span>, <span class="st">&#39;K&#39;</span>]:</a>
<a class="sourceLine" id="cb477-11" title="11">            charge <span class="op">+=</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb477-12" title="12">        <span class="cf">elif</span> aa <span class="kw">in</span> [<span class="st">&#39;D&#39;</span>, <span class="st">&#39;E&#39;</span>]:</a>
<a class="sourceLine" id="cb477-13" title="13">            charge <span class="op">-=</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb477-14" title="14">    <span class="cf">return</span> charge</a>
<a class="sourceLine" id="cb477-15" title="15"></a>
<a class="sourceLine" id="cb477-16" title="16">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> net_charge(<span class="st">&quot;DSAVRCPQD&quot;</span>) <span class="op">==</span> <span class="dv">-1</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-43">Run 2</h4>
<div class="sourceCode" id="cb479"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb479-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb479-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb479-3" title="3"></a>
<a class="sourceLine" id="cb479-4" title="4"><span class="kw">def</span> net_charge(sequence):</a>
<a class="sourceLine" id="cb479-5" title="5">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb479-6" title="6"><span class="co">    This function returns net charge of amino acid sequence</span></a>
<a class="sourceLine" id="cb479-7" title="7"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb479-8" title="8">    charge <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb479-9" title="9">    <span class="cf">for</span> i <span class="kw">in</span> sequence:</a>
<a class="sourceLine" id="cb479-10" title="10">        <span class="cf">if</span> i <span class="op">==</span> <span class="st">&#39;R&#39;</span> <span class="kw">or</span> i <span class="op">==</span> <span class="st">&#39;K&#39;</span>:</a>
<a class="sourceLine" id="cb479-11" title="11">            charge <span class="op">+=</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb479-12" title="12">        <span class="cf">elif</span> i <span class="op">==</span> <span class="st">&#39;D&#39;</span> <span class="kw">or</span> i <span class="op">==</span> <span class="st">&#39;E&#39;</span>:</a>
<a class="sourceLine" id="cb479-13" title="13">            charge <span class="op">-=</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb479-14" title="14">        <span class="cf">else</span>:</a>
<a class="sourceLine" id="cb479-15" title="15">            charge <span class="op">+=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb479-16" title="16">    <span class="cf">return</span> charge</a>
<a class="sourceLine" id="cb479-17" title="17"></a>
<a class="sourceLine" id="cb479-18" title="18">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> net_charge(<span class="st">&quot;DSAVRCPQD&quot;</span>) <span class="op">==</span> <span class="dv">-1</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-43">Run 3</h4>
<div class="sourceCode" id="cb481"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb481-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb481-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb481-3" title="3"></a>
<a class="sourceLine" id="cb481-4" title="4"><span class="kw">def</span> net_charge(sequence):</a>
<a class="sourceLine" id="cb481-5" title="5">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb481-6" title="6"><span class="co">    This function returns net charge of amino acid sequence</span></a>
<a class="sourceLine" id="cb481-7" title="7"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb481-8" title="8">    charge <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb481-9" title="9">    <span class="cf">for</span> i <span class="kw">in</span> sequence:</a>
<a class="sourceLine" id="cb481-10" title="10">        <span class="cf">if</span> i <span class="op">==</span> <span class="st">&quot;R&quot;</span> <span class="kw">or</span> i <span class="op">==</span> <span class="st">&quot;K&quot;</span>:</a>
<a class="sourceLine" id="cb481-11" title="11">            charge <span class="op">+=</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb481-12" title="12">        <span class="cf">elif</span> i <span class="op">==</span> <span class="st">&quot;D&quot;</span> <span class="kw">or</span> i <span class="op">==</span> <span class="st">&quot;E&quot;</span>:</a>
<a class="sourceLine" id="cb481-13" title="13">            charge <span class="op">-=</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb481-14" title="14">    <span class="cf">return</span> charge</a>
<a class="sourceLine" id="cb481-15" title="15"></a>
<a class="sourceLine" id="cb481-16" title="16">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> net_charge(<span class="st">&quot;DSAVRCPQD&quot;</span>) <span class="op">==</span> <span class="dv">-1</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-43">Run 4</h4>
<div class="sourceCode" id="cb483"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb483-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb483-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb483-3" title="3"></a>
<a class="sourceLine" id="cb483-4" title="4"><span class="kw">def</span> net_charge(sequence):</a>
<a class="sourceLine" id="cb483-5" title="5">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb483-6" title="6"><span class="co">    This function returns net charge of amino acid sequence</span></a>
<a class="sourceLine" id="cb483-7" title="7"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb483-8" title="8">    charge <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb483-9" title="9">    <span class="cf">for</span> aa <span class="kw">in</span> sequence:</a>
<a class="sourceLine" id="cb483-10" title="10">        <span class="cf">if</span> aa <span class="op">==</span> <span class="st">&#39;K&#39;</span> <span class="kw">or</span> aa <span class="op">==</span> <span class="st">&#39;R&#39;</span>:</a>
<a class="sourceLine" id="cb483-11" title="11">            charge <span class="op">+=</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb483-12" title="12">        <span class="cf">elif</span> aa <span class="op">==</span> <span class="st">&#39;D&#39;</span> <span class="kw">or</span> aa <span class="op">==</span> <span class="st">&#39;E&#39;</span>:</a>
<a class="sourceLine" id="cb483-13" title="13">            charge <span class="op">-=</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb483-14" title="14">        <span class="cf">else</span>:</a>
<a class="sourceLine" id="cb483-15" title="15">            <span class="cf">pass</span></a>
<a class="sourceLine" id="cb483-16" title="16"></a>
<a class="sourceLine" id="cb483-17" title="17">    <span class="cf">return</span> charge</a>
<a class="sourceLine" id="cb483-18" title="18"></a>
<a class="sourceLine" id="cb483-19" title="19">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> net_charge(<span class="st">&quot;DSAVRCPQD&quot;</span>) <span class="op">==</span> <span class="dv">-1</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>solve_ode</summary></p>
<h4 id="query-44">Query</h4>
<div class="sourceCode" id="cb485"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb485-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb485-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb485-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb485-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb485-5" title="5"></a>
<a class="sourceLine" id="cb485-6" title="6"><span class="kw">def</span> solve_ode(fn, t, y0):</a>
<a class="sourceLine" id="cb485-7" title="7">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb485-8" title="8"><span class="co">    Solve an initial value problem for system of Ordinary Differential Equations using the Explicit Runge-Kutta method of order 5. t is a 1D vector and dy/dt=fn(t,y). Returns the values of the solution y at t.</span></a>
<a class="sourceLine" id="cb485-9" title="9"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb485-10" title="10">    [insert]</a>
<a class="sourceLine" id="cb485-11" title="11">    <span class="cf">return</span> sol</a></code></pre></div>
<h4 id="run-0-44">Run 0</h4>
<div class="sourceCode" id="cb486"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb486-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb486-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb486-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb486-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb486-5" title="5"></a>
<a class="sourceLine" id="cb486-6" title="6"><span class="kw">def</span> solve_ode(fn, t, y0):</a>
<a class="sourceLine" id="cb486-7" title="7">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb486-8" title="8"><span class="co">    Solve an initial value problem for system of Ordinary Differential Equations using the Explicit Runge-Kutta method of order 5. t is a 1D vector and dy/dt=fn(t,y). Returns the values of the solution y at t.</span></a>
<a class="sourceLine" id="cb486-9" title="9"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb486-10" title="10">    sol <span class="op">=</span> np.zeros((<span class="bu">len</span>(t), <span class="bu">len</span>(y0)))</a>
<a class="sourceLine" id="cb486-11" title="11">    sol[<span class="dv">0</span>] <span class="op">=</span> y0</a>
<a class="sourceLine" id="cb486-12" title="12">    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(t)<span class="op">-</span><span class="dv">1</span>):</a>
<a class="sourceLine" id="cb486-13" title="13">        k1 <span class="op">=</span> fn(t[i], sol[i])</a>
<a class="sourceLine" id="cb486-14" title="14">        k2 <span class="op">=</span> fn(t[i] <span class="op">+</span> t[i<span class="op">+</span><span class="dv">1</span>]<span class="op">/</span><span class="dv">4</span>, sol[i] <span class="op">+</span> k1<span class="op">*</span>t[i<span class="op">+</span><span class="dv">1</span>]<span class="op">/</span><span class="dv">4</span>)</a>
<a class="sourceLine" id="cb486-15" title="15">        k3 <span class="op">=</span> fn(t[i] <span class="op">+</span> <span class="dv">3</span><span class="op">*</span>t[i<span class="op">+</span><span class="dv">1</span>]<span class="op">/</span><span class="dv">8</span>, sol[i] <span class="op">+</span> <span class="dv">3</span><span class="op">*</span>k1<span class="op">*</span>t[i<span class="op">+</span><span class="dv">1</span>]<span class="op">/</span><span class="dv">32</span> <span class="op">+</span> <span class="dv">9</span><span class="op">*</span>k2<span class="op">*</span>t[i<span class="op">+</span><span class="dv">1</span>]<span class="op">/</span><span class="dv">32</span>)</a>
<a class="sourceLine" id="cb486-16" title="16">        k4 <span class="op">=</span> fn(t[i] <span class="op">+</span> <span class="dv">12</span><span class="op">*</span>t[i<span class="op">+</span><span class="dv">1</span>]<span class="op">/</span><span class="dv">13</span>, sol[i] <span class="op">+</span> <span class="dv">1932</span><span class="op">*</span>k1<span class="op">*</span>t[i<span class="op">+</span><span class="dv">1</span>]<span class="op">/</span><span class="dv">2197</span> <span class="op">-</span> <span class="dv">7200</span><span class="op">*</span>k2<span class="op">*</span>t[i<span class="op">+</span><span class="dv">1</span>]<span class="op">/</span><span class="dv">2197</span> <span class="op">+</span> <span class="dv">7296</span><span class="op">*</span>k3<span class="op">*</span>t[i<span class="op">+</span><span class="dv">1</span>]<span class="op">/</span><span class="dv">2197</span>)</a>
<a class="sourceLine" id="cb486-17" title="17">        k5 <span class="op">=</span> fn(t[i] <span class="op">+</span> t[i<span class="op">+</span><span class="dv">1</span>], sol[i] <span class="op">+</span> <span class="dv">439</span><span class="op">*</span>k1<span class="op">*</span>t[i<span class="op">+</span><span class="dv">1</span>]<span class="op">/</span><span class="dv">216</span> <span class="op">-</span> <span class="dv">8</span><span class="op">*</span>k2<span class="op">*</span>t[i<span class="op">+</span><span class="dv">1</span>] <span class="op">+</span> <span class="dv">3680</span><span class="op">*</span>k3<span class="op">*</span>t[i<span class="op">+</span><span class="dv">1</span>]<span class="op">/</span><span class="dv">513</span> <span class="op">-</span> <span class="dv">845</span><span class="op">*</span>k4<span class="op">*</span>t[i<span class="op">+</span><span class="dv">1</span>]<span class="op">/</span><span class="dv">4104</span>)</a>
<a class="sourceLine" id="cb486-18" title="18">        k6 <span class="op">=</span> fn(t[i] <span class="op">+</span> t[i<span class="op">+</span><span class="dv">1</span>]<span class="op">/</span><span class="dv">2</span>, sol[i] <span class="op">-</span> <span class="dv">8</span><span class="op">*</span>k1<span class="op">*</span>t[i<span class="op">+</span><span class="dv">1</span>]<span class="op">/</span><span class="dv">27</span> <span class="op">+</span> <span class="dv">2</span><span class="op">*</span>k2<span class="op">*</span>t[i<span class="op">+</span><span class="dv">1</span>] <span class="op">-</span> <span class="dv">3544</span><span class="op">*</span>k3<span class="op">*</span>t[i<span class="op">+</span><span class="dv">1</span>]<span class="op">/</span><span class="dv">2565</span> <span class="op">+</span> <span class="dv">1859</span><span class="op">*</span>k4<span class="op">*</span>t[i<span class="op">+</span><span class="dv">1</span>]<span class="op">/</span><span class="dv">4104</span> <span class="op">-</span> <span class="dv">11</span><span class="op">*</span>k5<span class="op">*</span>t[i<span class="op">+</span><span class="dv">1</span>]<span class="op">/</span><span class="dv">40</span>)</a>
<a class="sourceLine" id="cb486-19" title="19">        sol[i<span class="op">+</span><span class="dv">1</span>] <span class="op">=</span> sol[i] <span class="op">+</span> t[i<span class="op">+</span><span class="dv">1</span>]<span class="op">*</span>(<span class="dv">25</span><span class="op">*</span>k1<span class="op">/</span><span class="dv">216</span> <span class="op">+</span> <span class="dv">1408</span><span class="op">*</span>k3<span class="op">/</span><span class="dv">2565</span> <span class="op">+</span> <span class="dv">2197</span><span class="op">*</span>k4<span class="op">/</span><span class="dv">4104</span> <span class="op">-</span> k5<span class="op">/</span><span class="dv">5</span>)</a>
<a class="sourceLine" id="cb486-20" title="20">    <span class="cf">return</span> sol</a>
<a class="sourceLine" id="cb486-21" title="21"></a>
<a class="sourceLine" id="cb486-22" title="22"></a>
<a class="sourceLine" id="cb486-23" title="23">    <span class="cf">return</span> sol</a>
<a class="sourceLine" id="cb486-24" title="24"><span class="im">from</span> scipy.integrate <span class="im">import</span> solve_ivp</a>
<a class="sourceLine" id="cb486-25" title="25"><span class="kw">def</span> exponential_decay(t, y): </a>
<a class="sourceLine" id="cb486-26" title="26">    <span class="cf">return</span> <span class="fl">-0.5</span> <span class="op">*</span> y</a>
<a class="sourceLine" id="cb486-27" title="27">solution <span class="op">=</span> solve_ivp(exponential_decay, [<span class="dv">0</span>, <span class="dv">10</span>], [<span class="dv">4</span>], t_eval<span class="op">=</span>[<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">8</span>])</a>
<a class="sourceLine" id="cb486-28" title="28"></a>
<a class="sourceLine" id="cb486-29" title="29">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.allclose(solution, solve_ode(exponential_decay, [<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">8</span>], [<span class="dv">4</span>])) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>ufunc &#39;isfinite&#39; not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule &#39;&#39;safe&#39;&#39;</code></pre>
<h4 id="run-1-44">Run 1</h4>
<div class="sourceCode" id="cb488"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb488-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb488-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb488-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb488-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb488-5" title="5"></a>
<a class="sourceLine" id="cb488-6" title="6"><span class="kw">def</span> solve_ode(fn, t, y0):</a>
<a class="sourceLine" id="cb488-7" title="7">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb488-8" title="8"><span class="co">    Solve an initial value problem for system of Ordinary Differential Equations using the Explicit Runge-Kutta method of order 5. t is a 1D vector and dy/dt=fn(t,y). Returns the values of the solution y at t.</span></a>
<a class="sourceLine" id="cb488-9" title="9"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb488-10" title="10">    n <span class="op">=</span> <span class="bu">len</span>(t)</a>
<a class="sourceLine" id="cb488-11" title="11">    y <span class="op">=</span> np.zeros((n, <span class="bu">len</span>(y0)))</a>
<a class="sourceLine" id="cb488-12" title="12">    y[<span class="dv">0</span>] <span class="op">=</span> y0</a>
<a class="sourceLine" id="cb488-13" title="13">    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n<span class="dv">-1</span>):</a>
<a class="sourceLine" id="cb488-14" title="14">        h <span class="op">=</span> t[i<span class="op">+</span><span class="dv">1</span>] <span class="op">-</span> t[i]</a>
<a class="sourceLine" id="cb488-15" title="15">        k1 <span class="op">=</span> fn(t[i], y[i])</a>
<a class="sourceLine" id="cb488-16" title="16">        k2 <span class="op">=</span> fn(t[i] <span class="op">+</span> h<span class="op">/</span><span class="dv">4</span>, y[i] <span class="op">+</span> h<span class="op">/</span><span class="dv">4</span><span class="op">*</span>k1)</a>
<a class="sourceLine" id="cb488-17" title="17">        k3 <span class="op">=</span> fn(t[i] <span class="op">+</span> <span class="dv">3</span><span class="op">*</span>h<span class="op">/</span><span class="dv">8</span>, y[i] <span class="op">+</span> <span class="dv">3</span><span class="op">*</span>h<span class="op">/</span><span class="dv">32</span><span class="op">*</span>k1 <span class="op">+</span> <span class="dv">9</span><span class="op">*</span>h<span class="op">/</span><span class="dv">32</span><span class="op">*</span>k2)</a>
<a class="sourceLine" id="cb488-18" title="18">        k4 <span class="op">=</span> fn(t[i] <span class="op">+</span> <span class="dv">12</span><span class="op">*</span>h<span class="op">/</span><span class="dv">13</span>, y[i] <span class="op">+</span> <span class="dv">1932</span><span class="op">*</span>h<span class="op">/</span><span class="dv">2197</span><span class="op">*</span>k1 <span class="op">-</span> <span class="dv">7200</span><span class="op">*</span>h<span class="op">/</span><span class="dv">2197</span><span class="op">*</span>k2 <span class="op">+</span> <span class="dv">7296</span><span class="op">*</span>h<span class="op">/</span><span class="dv">2197</span><span class="op">*</span>k3)</a>
<a class="sourceLine" id="cb488-19" title="19">        k5 <span class="op">=</span> fn(t[i] <span class="op">+</span> h, y[i] <span class="op">+</span> <span class="dv">439</span><span class="op">*</span>h<span class="op">/</span><span class="dv">216</span><span class="op">*</span>k1 <span class="op">-</span> <span class="dv">8</span><span class="op">*</span>h<span class="op">*</span>k2 <span class="op">+</span> <span class="dv">3680</span><span class="op">*</span>h<span class="op">/</span><span class="dv">513</span><span class="op">*</span>k3 <span class="op">-</span> <span class="dv">845</span><span class="op">*</span>h<span class="op">/</span><span class="dv">4104</span><span class="op">*</span>k4)</a>
<a class="sourceLine" id="cb488-20" title="20">        k6 <span class="op">=</span> fn(t[i] <span class="op">+</span> h<span class="op">/</span><span class="dv">2</span>, y[i] <span class="op">-</span> <span class="dv">8</span><span class="op">*</span>h<span class="op">/</span><span class="dv">27</span><span class="op">*</span>k1 <span class="op">+</span> <span class="dv">2</span><span class="op">*</span>h<span class="op">*</span>k2 <span class="op">-</span> <span class="dv">3544</span><span class="op">*</span>h<span class="op">/</span><span class="dv">2565</span><span class="op">*</span>k3 <span class="op">+</span> <span class="dv">1859</span><span class="op">*</span>h<span class="op">/</span><span class="dv">4104</span><span class="op">*</span>k4 <span class="op">-</span> <span class="dv">11</span><span class="op">*</span>h<span class="op">/</span><span class="dv">40</span><span class="op">*</span>k5)</a>
<a class="sourceLine" id="cb488-21" title="21">        y[i<span class="op">+</span><span class="dv">1</span>] <span class="op">=</span> y[i] <span class="op">+</span> h<span class="op">/</span><span class="dv">6</span><span class="op">*</span>(<span class="dv">25</span><span class="op">*</span>k1<span class="op">/</span><span class="dv">216</span> <span class="op">+</span> <span class="dv">1408</span><span class="op">*</span>k3<span class="op">/</span><span class="dv">2565</span> <span class="op">+</span> <span class="dv">2197</span><span class="op">*</span>k4<span class="op">/</span><span class="dv">4104</span> <span class="op">-</span> k5<span class="op">/</span><span class="dv">5</span>)</a>
<a class="sourceLine" id="cb488-22" title="22">    sol <span class="op">=</span> y</a>
<a class="sourceLine" id="cb488-23" title="23">    <span class="cf">return</span> sol</a>
<a class="sourceLine" id="cb488-24" title="24"></a>
<a class="sourceLine" id="cb488-25" title="25"></a>
<a class="sourceLine" id="cb488-26" title="26">    <span class="cf">return</span> sol</a>
<a class="sourceLine" id="cb488-27" title="27"><span class="im">from</span> scipy.integrate <span class="im">import</span> solve_ivp</a>
<a class="sourceLine" id="cb488-28" title="28"><span class="kw">def</span> exponential_decay(t, y): </a>
<a class="sourceLine" id="cb488-29" title="29">    <span class="cf">return</span> <span class="fl">-0.5</span> <span class="op">*</span> y</a>
<a class="sourceLine" id="cb488-30" title="30">solution <span class="op">=</span> solve_ivp(exponential_decay, [<span class="dv">0</span>, <span class="dv">10</span>], [<span class="dv">4</span>], t_eval<span class="op">=</span>[<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">8</span>])</a>
<a class="sourceLine" id="cb488-31" title="31"></a>
<a class="sourceLine" id="cb488-32" title="32">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.allclose(solution, solve_ode(exponential_decay, [<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">8</span>], [<span class="dv">4</span>])) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>ufunc &#39;isfinite&#39; not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule &#39;&#39;safe&#39;&#39;</code></pre>
<h4 id="run-2-44">Run 2</h4>
<div class="sourceCode" id="cb490"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb490-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb490-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb490-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb490-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb490-5" title="5"></a>
<a class="sourceLine" id="cb490-6" title="6"><span class="kw">def</span> solve_ode(fn, t, y0):</a>
<a class="sourceLine" id="cb490-7" title="7">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb490-8" title="8"><span class="co">    Solve an initial value problem for system of Ordinary Differential Equations using the Explicit Runge-Kutta method of order 5. t is a 1D vector and dy/dt=fn(t,y). Returns the values of the solution y at t.</span></a>
<a class="sourceLine" id="cb490-9" title="9"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb490-10" title="10">    sol <span class="op">=</span> np.zeros((<span class="bu">len</span>(t), <span class="bu">len</span>(y0)))</a>
<a class="sourceLine" id="cb490-11" title="11">    sol[<span class="dv">0</span>] <span class="op">=</span> y0</a>
<a class="sourceLine" id="cb490-12" title="12">    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(t)<span class="op">-</span><span class="dv">1</span>):</a>
<a class="sourceLine" id="cb490-13" title="13">        h <span class="op">=</span> t[i<span class="op">+</span><span class="dv">1</span>] <span class="op">-</span> t[i]</a>
<a class="sourceLine" id="cb490-14" title="14">        k1 <span class="op">=</span> h<span class="op">*</span>fn(t[i], sol[i])</a>
<a class="sourceLine" id="cb490-15" title="15">        k2 <span class="op">=</span> h<span class="op">*</span>fn(t[i] <span class="op">+</span> h<span class="op">/</span><span class="dv">4</span>, sol[i] <span class="op">+</span> k1<span class="op">/</span><span class="dv">4</span>)</a>
<a class="sourceLine" id="cb490-16" title="16">        k3 <span class="op">=</span> h<span class="op">*</span>fn(t[i] <span class="op">+</span> <span class="dv">3</span><span class="op">*</span>h<span class="op">/</span><span class="dv">8</span>, sol[i] <span class="op">+</span> <span class="dv">3</span><span class="op">*</span>k1<span class="op">/</span><span class="dv">32</span> <span class="op">+</span> <span class="dv">9</span><span class="op">*</span>k2<span class="op">/</span><span class="dv">32</span>)</a>
<a class="sourceLine" id="cb490-17" title="17">        k4 <span class="op">=</span> h<span class="op">*</span>fn(t[i] <span class="op">+</span> <span class="dv">12</span><span class="op">*</span>h<span class="op">/</span><span class="dv">13</span>, sol[i] <span class="op">+</span> <span class="dv">1932</span><span class="op">*</span>k1<span class="op">/</span><span class="dv">2197</span> <span class="op">-</span> <span class="dv">7200</span><span class="op">*</span>k2<span class="op">/</span><span class="dv">2197</span> <span class="op">+</span> <span class="dv">7296</span><span class="op">*</span>k3<span class="op">/</span><span class="dv">2197</span>)</a>
<a class="sourceLine" id="cb490-18" title="18">        k5 <span class="op">=</span> h<span class="op">*</span>fn(t[i] <span class="op">+</span> h, sol[i] <span class="op">+</span> <span class="dv">439</span><span class="op">*</span>k1<span class="op">/</span><span class="dv">216</span> <span class="op">-</span> <span class="dv">8</span><span class="op">*</span>k2 <span class="op">+</span> <span class="dv">3680</span><span class="op">*</span>k3<span class="op">/</span><span class="dv">513</span> <span class="op">-</span> <span class="dv">845</span><span class="op">*</span>k4<span class="op">/</span><span class="dv">4104</span>)</a>
<a class="sourceLine" id="cb490-19" title="19">        k6 <span class="op">=</span> h<span class="op">*</span>fn(t[i] <span class="op">+</span> h<span class="op">/</span><span class="dv">2</span>, sol[i] <span class="op">-</span> <span class="dv">8</span><span class="op">*</span>k1<span class="op">/</span><span class="dv">27</span> <span class="op">+</span> <span class="dv">2</span><span class="op">*</span>k2 <span class="op">-</span> <span class="dv">3544</span><span class="op">*</span>k3<span class="op">/</span><span class="dv">2565</span> <span class="op">+</span> <span class="dv">1859</span><span class="op">*</span>k4<span class="op">/</span><span class="dv">4104</span> <span class="op">-</span> <span class="dv">11</span><span class="op">*</span>k5<span class="op">/</span><span class="dv">40</span>)</a>
<a class="sourceLine" id="cb490-20" title="20">        sol[i<span class="op">+</span><span class="dv">1</span>] <span class="op">=</span> sol[i] <span class="op">+</span> <span class="dv">25</span><span class="op">*</span>k1<span class="op">/</span><span class="dv">216</span> <span class="op">+</span> <span class="dv">1408</span><span class="op">*</span>k3<span class="op">/</span><span class="dv">2565</span> <span class="op">+</span> <span class="dv">2197</span><span class="op">*</span>k4<span class="op">/</span><span class="dv">4104</span> <span class="op">-</span> k5<span class="op">/</span><span class="dv">5</span></a>
<a class="sourceLine" id="cb490-21" title="21">    <span class="cf">return</span> sol</a>
<a class="sourceLine" id="cb490-22" title="22"></a>
<a class="sourceLine" id="cb490-23" title="23"></a>
<a class="sourceLine" id="cb490-24" title="24">    <span class="cf">return</span> sol</a>
<a class="sourceLine" id="cb490-25" title="25"><span class="im">from</span> scipy.integrate <span class="im">import</span> solve_ivp</a>
<a class="sourceLine" id="cb490-26" title="26"><span class="kw">def</span> exponential_decay(t, y): </a>
<a class="sourceLine" id="cb490-27" title="27">    <span class="cf">return</span> <span class="fl">-0.5</span> <span class="op">*</span> y</a>
<a class="sourceLine" id="cb490-28" title="28">solution <span class="op">=</span> solve_ivp(exponential_decay, [<span class="dv">0</span>, <span class="dv">10</span>], [<span class="dv">4</span>], t_eval<span class="op">=</span>[<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">8</span>])</a>
<a class="sourceLine" id="cb490-29" title="29"></a>
<a class="sourceLine" id="cb490-30" title="30">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.allclose(solution, solve_ode(exponential_decay, [<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">8</span>], [<span class="dv">4</span>])) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>ufunc &#39;isfinite&#39; not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule &#39;&#39;safe&#39;&#39;</code></pre>
<h4 id="run-3-44">Run 3</h4>
<div class="sourceCode" id="cb492"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb492-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb492-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb492-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb492-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb492-5" title="5"></a>
<a class="sourceLine" id="cb492-6" title="6"><span class="kw">def</span> solve_ode(fn, t, y0):</a>
<a class="sourceLine" id="cb492-7" title="7">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb492-8" title="8"><span class="co">    Solve an initial value problem for system of Ordinary Differential Equations using the Explicit Runge-Kutta method of order 5. t is a 1D vector and dy/dt=fn(t,y). Returns the values of the solution y at t.</span></a>
<a class="sourceLine" id="cb492-9" title="9"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb492-10" title="10">    n <span class="op">=</span> <span class="bu">len</span>(t)</a>
<a class="sourceLine" id="cb492-11" title="11">    y <span class="op">=</span> np.zeros((n, <span class="bu">len</span>(y0)))</a>
<a class="sourceLine" id="cb492-12" title="12">    y[<span class="dv">0</span>] <span class="op">=</span> y0</a>
<a class="sourceLine" id="cb492-13" title="13">    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n<span class="dv">-1</span>):</a>
<a class="sourceLine" id="cb492-14" title="14">        h <span class="op">=</span> t[i<span class="op">+</span><span class="dv">1</span>] <span class="op">-</span> t[i]</a>
<a class="sourceLine" id="cb492-15" title="15">        k1 <span class="op">=</span> h<span class="op">*</span>fn(t[i], y[i])</a>
<a class="sourceLine" id="cb492-16" title="16">        k2 <span class="op">=</span> h<span class="op">*</span>fn(t[i] <span class="op">+</span> h<span class="op">/</span><span class="dv">4</span>, y[i] <span class="op">+</span> k1<span class="op">/</span><span class="dv">4</span>)</a>
<a class="sourceLine" id="cb492-17" title="17">        k3 <span class="op">=</span> h<span class="op">*</span>fn(t[i] <span class="op">+</span> <span class="dv">3</span><span class="op">*</span>h<span class="op">/</span><span class="dv">8</span>, y[i] <span class="op">+</span> <span class="dv">3</span><span class="op">*</span>k1<span class="op">/</span><span class="dv">32</span> <span class="op">+</span> <span class="dv">9</span><span class="op">*</span>k2<span class="op">/</span><span class="dv">32</span>)</a>
<a class="sourceLine" id="cb492-18" title="18">        k4 <span class="op">=</span> h<span class="op">*</span>fn(t[i] <span class="op">+</span> <span class="dv">12</span><span class="op">*</span>h<span class="op">/</span><span class="dv">13</span>, y[i] <span class="op">+</span> <span class="dv">1932</span><span class="op">*</span>k1<span class="op">/</span><span class="dv">2197</span> <span class="op">-</span> <span class="dv">7200</span><span class="op">*</span>k2<span class="op">/</span><span class="dv">2197</span> <span class="op">+</span> <span class="dv">7296</span><span class="op">*</span>k3<span class="op">/</span><span class="dv">2197</span>)</a>
<a class="sourceLine" id="cb492-19" title="19">        k5 <span class="op">=</span> h<span class="op">*</span>fn(t[i] <span class="op">+</span> h, y[i] <span class="op">+</span> <span class="dv">439</span><span class="op">*</span>k1<span class="op">/</span><span class="dv">216</span> <span class="op">-</span> <span class="dv">8</span><span class="op">*</span>k2 <span class="op">+</span> <span class="dv">3680</span><span class="op">*</span>k3<span class="op">/</span><span class="dv">513</span> <span class="op">-</span> <span class="dv">845</span><span class="op">*</span>k4<span class="op">/</span><span class="dv">4104</span>)</a>
<a class="sourceLine" id="cb492-20" title="20">        k6 <span class="op">=</span> h<span class="op">*</span>fn(t[i] <span class="op">+</span> h<span class="op">/</span><span class="dv">2</span>, y[i] <span class="op">-</span> <span class="dv">8</span><span class="op">*</span>k1<span class="op">/</span><span class="dv">27</span> <span class="op">+</span> <span class="dv">2</span><span class="op">*</span>k2 <span class="op">-</span> <span class="dv">3544</span><span class="op">*</span>k3<span class="op">/</span><span class="dv">2565</span> <span class="op">+</span> <span class="dv">1859</span><span class="op">*</span>k4<span class="op">/</span><span class="dv">4104</span> <span class="op">-</span> <span class="dv">11</span><span class="op">*</span>k5<span class="op">/</span><span class="dv">40</span>)</a>
<a class="sourceLine" id="cb492-21" title="21">        y[i<span class="op">+</span><span class="dv">1</span>] <span class="op">=</span> y[i] <span class="op">+</span> <span class="dv">25</span><span class="op">*</span>k1<span class="op">/</span><span class="dv">216</span> <span class="op">+</span> <span class="dv">1408</span><span class="op">*</span>k3<span class="op">/</span><span class="dv">2565</span> <span class="op">+</span> <span class="dv">2197</span><span class="op">*</span>k4<span class="op">/</span><span class="dv">4104</span> <span class="op">-</span> k5<span class="op">/</span><span class="dv">5</span></a>
<a class="sourceLine" id="cb492-22" title="22">    <span class="cf">return</span> y</a>
<a class="sourceLine" id="cb492-23" title="23"></a>
<a class="sourceLine" id="cb492-24" title="24"></a>
<a class="sourceLine" id="cb492-25" title="25">    <span class="cf">return</span> sol</a>
<a class="sourceLine" id="cb492-26" title="26"><span class="im">from</span> scipy.integrate <span class="im">import</span> solve_ivp</a>
<a class="sourceLine" id="cb492-27" title="27"><span class="kw">def</span> exponential_decay(t, y): </a>
<a class="sourceLine" id="cb492-28" title="28">    <span class="cf">return</span> <span class="fl">-0.5</span> <span class="op">*</span> y</a>
<a class="sourceLine" id="cb492-29" title="29">solution <span class="op">=</span> solve_ivp(exponential_decay, [<span class="dv">0</span>, <span class="dv">10</span>], [<span class="dv">4</span>], t_eval<span class="op">=</span>[<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">8</span>])</a>
<a class="sourceLine" id="cb492-30" title="30"></a>
<a class="sourceLine" id="cb492-31" title="31">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.allclose(solution, solve_ode(exponential_decay, [<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">8</span>], [<span class="dv">4</span>])) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>ufunc &#39;isfinite&#39; not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule &#39;&#39;safe&#39;&#39;</code></pre>
<h4 id="run-4-44">Run 4</h4>
<div class="sourceCode" id="cb494"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb494-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb494-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb494-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb494-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb494-5" title="5"></a>
<a class="sourceLine" id="cb494-6" title="6"><span class="kw">def</span> solve_ode(fn, t, y0):</a>
<a class="sourceLine" id="cb494-7" title="7">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb494-8" title="8"><span class="co">    Solve an initial value problem for system of Ordinary Differential Equations using the Explicit Runge-Kutta method of order 5. t is a 1D vector and dy/dt=fn(t,y). Returns the values of the solution y at t.</span></a>
<a class="sourceLine" id="cb494-9" title="9"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb494-10" title="10">    n <span class="op">=</span> <span class="bu">len</span>(t)</a>
<a class="sourceLine" id="cb494-11" title="11">    y <span class="op">=</span> np.zeros((n, <span class="bu">len</span>(y0)))</a>
<a class="sourceLine" id="cb494-12" title="12">    y[<span class="dv">0</span>] <span class="op">=</span> y0</a>
<a class="sourceLine" id="cb494-13" title="13">    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n<span class="dv">-1</span>):</a>
<a class="sourceLine" id="cb494-14" title="14">        h <span class="op">=</span> t[i<span class="op">+</span><span class="dv">1</span>]<span class="op">-</span>t[i]</a>
<a class="sourceLine" id="cb494-15" title="15">        k1 <span class="op">=</span> h<span class="op">*</span>fn(t[i], y[i])</a>
<a class="sourceLine" id="cb494-16" title="16">        k2 <span class="op">=</span> h<span class="op">*</span>fn(t[i]<span class="op">+</span>h<span class="op">/</span><span class="dv">4</span>, y[i]<span class="op">+</span>k1<span class="op">/</span><span class="dv">4</span>)</a>
<a class="sourceLine" id="cb494-17" title="17">        k3 <span class="op">=</span> h<span class="op">*</span>fn(t[i]<span class="op">+</span><span class="dv">3</span><span class="op">*</span>h<span class="op">/</span><span class="dv">8</span>, y[i]<span class="op">+</span><span class="dv">3</span><span class="op">*</span>k1<span class="op">/</span><span class="dv">32</span><span class="op">+</span><span class="dv">9</span><span class="op">*</span>k2<span class="op">/</span><span class="dv">32</span>)</a>
<a class="sourceLine" id="cb494-18" title="18">        k4 <span class="op">=</span> h<span class="op">*</span>fn(t[i]<span class="op">+</span><span class="dv">12</span><span class="op">*</span>h<span class="op">/</span><span class="dv">13</span>, y[i]<span class="op">+</span><span class="dv">1932</span><span class="op">*</span>k1<span class="op">/</span><span class="dv">2197-7200</span><span class="op">*</span>k2<span class="op">/</span><span class="dv">2197</span><span class="op">+</span><span class="dv">7296</span><span class="op">*</span>k3<span class="op">/</span><span class="dv">2197</span>)</a>
<a class="sourceLine" id="cb494-19" title="19">        k5 <span class="op">=</span> h<span class="op">*</span>fn(t[i]<span class="op">+</span>h, y[i]<span class="op">+</span><span class="dv">439</span><span class="op">*</span>k1<span class="op">/</span><span class="dv">216-8</span><span class="op">*</span>k2<span class="op">+</span><span class="dv">3680</span><span class="op">*</span>k3<span class="op">/</span><span class="dv">513-845</span><span class="op">*</span>k4<span class="op">/</span><span class="dv">4104</span>)</a>
<a class="sourceLine" id="cb494-20" title="20">        k6 <span class="op">=</span> h<span class="op">*</span>fn(t[i]<span class="op">+</span>h<span class="op">/</span><span class="dv">2</span>, y[i]<span class="op">-</span><span class="dv">8</span><span class="op">*</span>k1<span class="op">/</span><span class="dv">27</span><span class="op">+</span><span class="dv">2</span><span class="op">*</span>k2<span class="dv">-3544</span><span class="op">*</span>k3<span class="op">/</span><span class="dv">2565</span><span class="op">+</span><span class="dv">1859</span><span class="op">*</span>k4<span class="op">/</span><span class="dv">4104-11</span><span class="op">*</span>k5<span class="op">/</span><span class="dv">40</span>)</a>
<a class="sourceLine" id="cb494-21" title="21">        y[i<span class="op">+</span><span class="dv">1</span>] <span class="op">=</span> y[i] <span class="op">+</span> <span class="dv">25</span><span class="op">*</span>k1<span class="op">/</span><span class="dv">216</span><span class="op">+</span><span class="dv">1408</span><span class="op">*</span>k3<span class="op">/</span><span class="dv">2565</span><span class="op">+</span><span class="dv">2197</span><span class="op">*</span>k4<span class="op">/</span><span class="dv">4104</span><span class="op">-</span>k5<span class="op">/</span><span class="dv">5</span></a>
<a class="sourceLine" id="cb494-22" title="22">    <span class="cf">return</span> y</a>
<a class="sourceLine" id="cb494-23" title="23"></a>
<a class="sourceLine" id="cb494-24" title="24"></a>
<a class="sourceLine" id="cb494-25" title="25">    <span class="cf">return</span> sol</a>
<a class="sourceLine" id="cb494-26" title="26"><span class="im">from</span> scipy.integrate <span class="im">import</span> solve_ivp</a>
<a class="sourceLine" id="cb494-27" title="27"><span class="kw">def</span> exponential_decay(t, y): </a>
<a class="sourceLine" id="cb494-28" title="28">    <span class="cf">return</span> <span class="fl">-0.5</span> <span class="op">*</span> y</a>
<a class="sourceLine" id="cb494-29" title="29">solution <span class="op">=</span> solve_ivp(exponential_decay, [<span class="dv">0</span>, <span class="dv">10</span>], [<span class="dv">4</span>], t_eval<span class="op">=</span>[<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">8</span>])</a>
<a class="sourceLine" id="cb494-30" title="30"></a>
<a class="sourceLine" id="cb494-31" title="31">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.allclose(solution, solve_ode(exponential_decay, [<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">8</span>], [<span class="dv">4</span>])) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>ufunc &#39;isfinite&#39; not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule &#39;&#39;safe&#39;&#39;</code></pre>
</details>
<details>
<p><summary>ohe</summary></p>
<h4 id="query-45">Query</h4>
<div class="sourceCode" id="cb496"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb496-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb496-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb496-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb496-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb496-5" title="5"></a>
<a class="sourceLine" id="cb496-6" title="6"><span class="kw">def</span> ohe(a):</a>
<a class="sourceLine" id="cb496-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb496-8" title="8"><span class="co">  This function generates one-hot encodings for</span></a>
<a class="sourceLine" id="cb496-9" title="9"><span class="co">  the class names in the given list of strings.</span></a>
<a class="sourceLine" id="cb496-10" title="10"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb496-11" title="11">  [insert]</a>
<a class="sourceLine" id="cb496-12" title="12">  <span class="cf">return</span> v</a></code></pre></div>
<h4 id="run-0-45">Run 0</h4>
<div class="sourceCode" id="cb497"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb497-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb497-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb497-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb497-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb497-5" title="5"></a>
<a class="sourceLine" id="cb497-6" title="6"><span class="kw">def</span> ohe(a):</a>
<a class="sourceLine" id="cb497-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb497-8" title="8"><span class="co">  This function generates one-hot encodings for</span></a>
<a class="sourceLine" id="cb497-9" title="9"><span class="co">  the class names in the given list of strings.</span></a>
<a class="sourceLine" id="cb497-10" title="10"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb497-11" title="11">  n <span class="op">=</span> <span class="bu">len</span>(a)</a>
<a class="sourceLine" id="cb497-12" title="12">  v <span class="op">=</span> np.zeros((n, <span class="bu">len</span>(<span class="bu">set</span>(a))))</a>
<a class="sourceLine" id="cb497-13" title="13">  <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n):</a>
<a class="sourceLine" id="cb497-14" title="14">    v[i, a[i]] <span class="op">=</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb497-15" title="15">  <span class="cf">return</span> v</a>
<a class="sourceLine" id="cb497-16" title="16"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb497-17" title="17"></a>
<a class="sourceLine" id="cb497-18" title="18">dog_breeds <span class="op">=</span> [<span class="st">&#39;German Shepherd&#39;</span>, <span class="st">&#39;Husky&#39;</span>,</a>
<a class="sourceLine" id="cb497-19" title="19">              <span class="st">&#39;Bulldog&#39;</span>, <span class="st">&#39;Dobermann&#39;</span>, <span class="st">&#39;Great Dane&#39;</span>, <span class="st">&#39;Husky&#39;</span>, <span class="st">&#39;Bulldog&#39;</span>, <span class="st">&#39;German Shepherd&#39;</span>, <span class="st">&#39;Great Dane&#39;</span>, <span class="st">&#39;German Shepherd&#39;</span>]</a>
<a class="sourceLine" id="cb497-20" title="20"></a>
<a class="sourceLine" id="cb497-21" title="21">unique_list <span class="op">=</span> <span class="bu">sorted</span>(<span class="bu">list</span>(<span class="bu">set</span>(dog_breeds)))</a>
<a class="sourceLine" id="cb497-22" title="22">n <span class="op">=</span> <span class="bu">len</span>(dog_breeds)</a>
<a class="sourceLine" id="cb497-23" title="23">m <span class="op">=</span> <span class="bu">len</span>(unique_list)</a>
<a class="sourceLine" id="cb497-24" title="24">ohe_array <span class="op">=</span> np.zeros((n, m))</a>
<a class="sourceLine" id="cb497-25" title="25">j <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb497-26" title="26"><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n):</a>
<a class="sourceLine" id="cb497-27" title="27">        ohe_array[j, unique_list.index(dog_breeds[i])] <span class="op">=</span> <span class="fl">1.</span></a>
<a class="sourceLine" id="cb497-28" title="28">        j <span class="op">+=</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb497-29" title="29"></a>
<a class="sourceLine" id="cb497-30" title="30">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(ohe(dog_breeds), ohe_array).<span class="bu">all</span>() <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>only integers, slices (`:`), ellipsis (`...`), numpy.newaxis (`None`) and integer or boolean arrays are valid indices</code></pre>
<h4 id="run-1-45">Run 1</h4>
<div class="sourceCode" id="cb499"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb499-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb499-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb499-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb499-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb499-5" title="5"></a>
<a class="sourceLine" id="cb499-6" title="6"><span class="kw">def</span> ohe(a):</a>
<a class="sourceLine" id="cb499-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb499-8" title="8"><span class="co">  This function generates one-hot encodings for</span></a>
<a class="sourceLine" id="cb499-9" title="9"><span class="co">  the class names in the given list of strings.</span></a>
<a class="sourceLine" id="cb499-10" title="10"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb499-11" title="11">  v <span class="op">=</span> np.zeros((<span class="bu">len</span>(a), <span class="bu">len</span>(np.unique(a))))</a>
<a class="sourceLine" id="cb499-12" title="12">  <span class="cf">for</span> i, k <span class="kw">in</span> <span class="bu">enumerate</span>(a):</a>
<a class="sourceLine" id="cb499-13" title="13">    v[i, k] <span class="op">=</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb499-14" title="14"></a>
<a class="sourceLine" id="cb499-15" title="15">  <span class="cf">return</span> v</a>
<a class="sourceLine" id="cb499-16" title="16"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb499-17" title="17"></a>
<a class="sourceLine" id="cb499-18" title="18">dog_breeds <span class="op">=</span> [<span class="st">&#39;German Shepherd&#39;</span>, <span class="st">&#39;Husky&#39;</span>,</a>
<a class="sourceLine" id="cb499-19" title="19">              <span class="st">&#39;Bulldog&#39;</span>, <span class="st">&#39;Dobermann&#39;</span>, <span class="st">&#39;Great Dane&#39;</span>, <span class="st">&#39;Husky&#39;</span>, <span class="st">&#39;Bulldog&#39;</span>, <span class="st">&#39;German Shepherd&#39;</span>, <span class="st">&#39;Great Dane&#39;</span>, <span class="st">&#39;German Shepherd&#39;</span>]</a>
<a class="sourceLine" id="cb499-20" title="20"></a>
<a class="sourceLine" id="cb499-21" title="21">unique_list <span class="op">=</span> <span class="bu">sorted</span>(<span class="bu">list</span>(<span class="bu">set</span>(dog_breeds)))</a>
<a class="sourceLine" id="cb499-22" title="22">n <span class="op">=</span> <span class="bu">len</span>(dog_breeds)</a>
<a class="sourceLine" id="cb499-23" title="23">m <span class="op">=</span> <span class="bu">len</span>(unique_list)</a>
<a class="sourceLine" id="cb499-24" title="24">ohe_array <span class="op">=</span> np.zeros((n, m))</a>
<a class="sourceLine" id="cb499-25" title="25">j <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb499-26" title="26"><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n):</a>
<a class="sourceLine" id="cb499-27" title="27">        ohe_array[j, unique_list.index(dog_breeds[i])] <span class="op">=</span> <span class="fl">1.</span></a>
<a class="sourceLine" id="cb499-28" title="28">        j <span class="op">+=</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb499-29" title="29"></a>
<a class="sourceLine" id="cb499-30" title="30">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(ohe(dog_breeds), ohe_array).<span class="bu">all</span>() <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>only integers, slices (`:`), ellipsis (`...`), numpy.newaxis (`None`) and integer or boolean arrays are valid indices</code></pre>
<h4 id="run-2-45">Run 2</h4>
<div class="sourceCode" id="cb501"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb501-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb501-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb501-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb501-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb501-5" title="5"></a>
<a class="sourceLine" id="cb501-6" title="6"><span class="kw">def</span> ohe(a):</a>
<a class="sourceLine" id="cb501-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb501-8" title="8"><span class="co">  This function generates one-hot encodings for</span></a>
<a class="sourceLine" id="cb501-9" title="9"><span class="co">  the class names in the given list of strings.</span></a>
<a class="sourceLine" id="cb501-10" title="10"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb501-11" title="11">  v <span class="op">=</span> np.zeros((<span class="bu">len</span>(a), <span class="bu">len</span>(<span class="bu">set</span>(a))))</a>
<a class="sourceLine" id="cb501-12" title="12">  <span class="cf">for</span> i, k <span class="kw">in</span> <span class="bu">enumerate</span>(a):</a>
<a class="sourceLine" id="cb501-13" title="13">    v[i, k] <span class="op">=</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb501-14" title="14">  <span class="cf">return</span> v</a>
<a class="sourceLine" id="cb501-15" title="15"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb501-16" title="16"></a>
<a class="sourceLine" id="cb501-17" title="17">dog_breeds <span class="op">=</span> [<span class="st">&#39;German Shepherd&#39;</span>, <span class="st">&#39;Husky&#39;</span>,</a>
<a class="sourceLine" id="cb501-18" title="18">              <span class="st">&#39;Bulldog&#39;</span>, <span class="st">&#39;Dobermann&#39;</span>, <span class="st">&#39;Great Dane&#39;</span>, <span class="st">&#39;Husky&#39;</span>, <span class="st">&#39;Bulldog&#39;</span>, <span class="st">&#39;German Shepherd&#39;</span>, <span class="st">&#39;Great Dane&#39;</span>, <span class="st">&#39;German Shepherd&#39;</span>]</a>
<a class="sourceLine" id="cb501-19" title="19"></a>
<a class="sourceLine" id="cb501-20" title="20">unique_list <span class="op">=</span> <span class="bu">sorted</span>(<span class="bu">list</span>(<span class="bu">set</span>(dog_breeds)))</a>
<a class="sourceLine" id="cb501-21" title="21">n <span class="op">=</span> <span class="bu">len</span>(dog_breeds)</a>
<a class="sourceLine" id="cb501-22" title="22">m <span class="op">=</span> <span class="bu">len</span>(unique_list)</a>
<a class="sourceLine" id="cb501-23" title="23">ohe_array <span class="op">=</span> np.zeros((n, m))</a>
<a class="sourceLine" id="cb501-24" title="24">j <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb501-25" title="25"><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n):</a>
<a class="sourceLine" id="cb501-26" title="26">        ohe_array[j, unique_list.index(dog_breeds[i])] <span class="op">=</span> <span class="fl">1.</span></a>
<a class="sourceLine" id="cb501-27" title="27">        j <span class="op">+=</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb501-28" title="28"></a>
<a class="sourceLine" id="cb501-29" title="29">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(ohe(dog_breeds), ohe_array).<span class="bu">all</span>() <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>only integers, slices (`:`), ellipsis (`...`), numpy.newaxis (`None`) and integer or boolean arrays are valid indices</code></pre>
<h4 id="run-3-45">Run 3</h4>
<div class="sourceCode" id="cb503"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb503-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb503-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb503-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb503-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb503-5" title="5"></a>
<a class="sourceLine" id="cb503-6" title="6"><span class="kw">def</span> ohe(a):</a>
<a class="sourceLine" id="cb503-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb503-8" title="8"><span class="co">  This function generates one-hot encodings for</span></a>
<a class="sourceLine" id="cb503-9" title="9"><span class="co">  the class names in the given list of strings.</span></a>
<a class="sourceLine" id="cb503-10" title="10"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb503-11" title="11">  v <span class="op">=</span> np.zeros((<span class="bu">len</span>(a), <span class="bu">len</span>(a)))</a>
<a class="sourceLine" id="cb503-12" title="12">  <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(a)):</a>
<a class="sourceLine" id="cb503-13" title="13">    v[i,i] <span class="op">=</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb503-14" title="14"></a>
<a class="sourceLine" id="cb503-15" title="15">  <span class="cf">return</span> v</a>
<a class="sourceLine" id="cb503-16" title="16"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb503-17" title="17"></a>
<a class="sourceLine" id="cb503-18" title="18">dog_breeds <span class="op">=</span> [<span class="st">&#39;German Shepherd&#39;</span>, <span class="st">&#39;Husky&#39;</span>,</a>
<a class="sourceLine" id="cb503-19" title="19">              <span class="st">&#39;Bulldog&#39;</span>, <span class="st">&#39;Dobermann&#39;</span>, <span class="st">&#39;Great Dane&#39;</span>, <span class="st">&#39;Husky&#39;</span>, <span class="st">&#39;Bulldog&#39;</span>, <span class="st">&#39;German Shepherd&#39;</span>, <span class="st">&#39;Great Dane&#39;</span>, <span class="st">&#39;German Shepherd&#39;</span>]</a>
<a class="sourceLine" id="cb503-20" title="20"></a>
<a class="sourceLine" id="cb503-21" title="21">unique_list <span class="op">=</span> <span class="bu">sorted</span>(<span class="bu">list</span>(<span class="bu">set</span>(dog_breeds)))</a>
<a class="sourceLine" id="cb503-22" title="22">n <span class="op">=</span> <span class="bu">len</span>(dog_breeds)</a>
<a class="sourceLine" id="cb503-23" title="23">m <span class="op">=</span> <span class="bu">len</span>(unique_list)</a>
<a class="sourceLine" id="cb503-24" title="24">ohe_array <span class="op">=</span> np.zeros((n, m))</a>
<a class="sourceLine" id="cb503-25" title="25">j <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb503-26" title="26"><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n):</a>
<a class="sourceLine" id="cb503-27" title="27">        ohe_array[j, unique_list.index(dog_breeds[i])] <span class="op">=</span> <span class="fl">1.</span></a>
<a class="sourceLine" id="cb503-28" title="28">        j <span class="op">+=</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb503-29" title="29"></a>
<a class="sourceLine" id="cb503-30" title="30">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(ohe(dog_breeds), ohe_array).<span class="bu">all</span>() <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>operands could not be broadcast together with shapes (10,10) (10,5) </code></pre>
<h4 id="run-4-45">Run 4</h4>
<div class="sourceCode" id="cb505"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb505-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb505-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb505-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb505-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb505-5" title="5"></a>
<a class="sourceLine" id="cb505-6" title="6"><span class="kw">def</span> ohe(a):</a>
<a class="sourceLine" id="cb505-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb505-8" title="8"><span class="co">  This function generates one-hot encodings for</span></a>
<a class="sourceLine" id="cb505-9" title="9"><span class="co">  the class names in the given list of strings.</span></a>
<a class="sourceLine" id="cb505-10" title="10"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb505-11" title="11">  v <span class="op">=</span> np.zeros((<span class="bu">len</span>(a), <span class="bu">len</span>(a)))</a>
<a class="sourceLine" id="cb505-12" title="12">  <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(a)):</a>
<a class="sourceLine" id="cb505-13" title="13">    v[i,i] <span class="op">=</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb505-14" title="14"></a>
<a class="sourceLine" id="cb505-15" title="15">  <span class="cf">return</span> v</a>
<a class="sourceLine" id="cb505-16" title="16"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb505-17" title="17"></a>
<a class="sourceLine" id="cb505-18" title="18">dog_breeds <span class="op">=</span> [<span class="st">&#39;German Shepherd&#39;</span>, <span class="st">&#39;Husky&#39;</span>,</a>
<a class="sourceLine" id="cb505-19" title="19">              <span class="st">&#39;Bulldog&#39;</span>, <span class="st">&#39;Dobermann&#39;</span>, <span class="st">&#39;Great Dane&#39;</span>, <span class="st">&#39;Husky&#39;</span>, <span class="st">&#39;Bulldog&#39;</span>, <span class="st">&#39;German Shepherd&#39;</span>, <span class="st">&#39;Great Dane&#39;</span>, <span class="st">&#39;German Shepherd&#39;</span>]</a>
<a class="sourceLine" id="cb505-20" title="20"></a>
<a class="sourceLine" id="cb505-21" title="21">unique_list <span class="op">=</span> <span class="bu">sorted</span>(<span class="bu">list</span>(<span class="bu">set</span>(dog_breeds)))</a>
<a class="sourceLine" id="cb505-22" title="22">n <span class="op">=</span> <span class="bu">len</span>(dog_breeds)</a>
<a class="sourceLine" id="cb505-23" title="23">m <span class="op">=</span> <span class="bu">len</span>(unique_list)</a>
<a class="sourceLine" id="cb505-24" title="24">ohe_array <span class="op">=</span> np.zeros((n, m))</a>
<a class="sourceLine" id="cb505-25" title="25">j <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb505-26" title="26"><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n):</a>
<a class="sourceLine" id="cb505-27" title="27">        ohe_array[j, unique_list.index(dog_breeds[i])] <span class="op">=</span> <span class="fl">1.</span></a>
<a class="sourceLine" id="cb505-28" title="28">        j <span class="op">+=</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb505-29" title="29"></a>
<a class="sourceLine" id="cb505-30" title="30">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(ohe(dog_breeds), ohe_array).<span class="bu">all</span>() <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>operands could not be broadcast together with shapes (10,10) (10,5) </code></pre>
</details>
<details>
<p><summary>osmotic_pressure</summary></p>
<h4 id="query-46">Query</h4>
<div class="sourceCode" id="cb507"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb507-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb507-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb507-3" title="3"></a>
<a class="sourceLine" id="cb507-4" title="4"><span class="kw">def</span> osmotic_pressure_concentration(Pi,T):</a>
<a class="sourceLine" id="cb507-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb507-6" title="6"><span class="co">   This function returns the concentration in mol/l given an osmotic pressure Pi and temperature T</span></a>
<a class="sourceLine" id="cb507-7" title="7"><span class="co">   T is in K</span></a>
<a class="sourceLine" id="cb507-8" title="8"><span class="co">   Pi is in atm</span></a>
<a class="sourceLine" id="cb507-9" title="9"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb507-10" title="10">   R <span class="op">=</span> <span class="fl">0.08206</span> <span class="co"># l atm /K /mol</span></a>
<a class="sourceLine" id="cb507-11" title="11">   [insert]</a>
<a class="sourceLine" id="cb507-12" title="12">   <span class="cf">return</span> p</a></code></pre></div>
<h4 id="run-0-46">Run 0</h4>
<div class="sourceCode" id="cb508"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb508-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb508-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb508-3" title="3"></a>
<a class="sourceLine" id="cb508-4" title="4"><span class="kw">def</span> osmotic_pressure_concentration(Pi,T):</a>
<a class="sourceLine" id="cb508-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb508-6" title="6"><span class="co">   This function returns the concentration in mol/l given an osmotic pressure Pi and temperature T</span></a>
<a class="sourceLine" id="cb508-7" title="7"><span class="co">   T is in K</span></a>
<a class="sourceLine" id="cb508-8" title="8"><span class="co">   Pi is in atm</span></a>
<a class="sourceLine" id="cb508-9" title="9"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb508-10" title="10">   R <span class="op">=</span> <span class="fl">0.08206</span> <span class="co"># l atm /K /mol</span></a>
<a class="sourceLine" id="cb508-11" title="11">   p <span class="op">=</span> Pi<span class="op">/</span>(R<span class="op">*</span>T)</a>
<a class="sourceLine" id="cb508-12" title="12">   <span class="cf">return</span> p</a>
<a class="sourceLine" id="cb508-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb508-14" title="14">pressure <span class="op">=</span> <span class="fl">0.02</span> <span class="co">#atm</span></a>
<a class="sourceLine" id="cb508-15" title="15">temperature <span class="op">=</span> <span class="dv">310</span> <span class="co">#K </span></a>
<a class="sourceLine" id="cb508-16" title="16">c <span class="op">=</span> pressure<span class="op">/</span>(<span class="fl">0.08206</span><span class="op">*</span>temperature)</a>
<a class="sourceLine" id="cb508-17" title="17">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">abs</span>(osmotic_pressure_concentration(pressure,temperature)<span class="op">-</span>c)<span class="op">&lt;</span><span class="fl">0.01</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-46">Run 1</h4>
<div class="sourceCode" id="cb510"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb510-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb510-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb510-3" title="3"></a>
<a class="sourceLine" id="cb510-4" title="4"><span class="kw">def</span> osmotic_pressure_concentration(Pi,T):</a>
<a class="sourceLine" id="cb510-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb510-6" title="6"><span class="co">   This function returns the concentration in mol/l given an osmotic pressure Pi and temperature T</span></a>
<a class="sourceLine" id="cb510-7" title="7"><span class="co">   T is in K</span></a>
<a class="sourceLine" id="cb510-8" title="8"><span class="co">   Pi is in atm</span></a>
<a class="sourceLine" id="cb510-9" title="9"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb510-10" title="10">   R <span class="op">=</span> <span class="fl">0.08206</span> <span class="co"># l atm /K /mol</span></a>
<a class="sourceLine" id="cb510-11" title="11">   p <span class="op">=</span> Pi<span class="op">/</span>(R<span class="op">*</span>T)</a>
<a class="sourceLine" id="cb510-12" title="12">   <span class="cf">return</span> p</a>
<a class="sourceLine" id="cb510-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb510-14" title="14">pressure <span class="op">=</span> <span class="fl">0.02</span> <span class="co">#atm</span></a>
<a class="sourceLine" id="cb510-15" title="15">temperature <span class="op">=</span> <span class="dv">310</span> <span class="co">#K </span></a>
<a class="sourceLine" id="cb510-16" title="16">c <span class="op">=</span> pressure<span class="op">/</span>(<span class="fl">0.08206</span><span class="op">*</span>temperature)</a>
<a class="sourceLine" id="cb510-17" title="17">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">abs</span>(osmotic_pressure_concentration(pressure,temperature)<span class="op">-</span>c)<span class="op">&lt;</span><span class="fl">0.01</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-46">Run 2</h4>
<div class="sourceCode" id="cb512"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb512-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb512-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb512-3" title="3"></a>
<a class="sourceLine" id="cb512-4" title="4"><span class="kw">def</span> osmotic_pressure_concentration(Pi,T):</a>
<a class="sourceLine" id="cb512-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb512-6" title="6"><span class="co">   This function returns the concentration in mol/l given an osmotic pressure Pi and temperature T</span></a>
<a class="sourceLine" id="cb512-7" title="7"><span class="co">   T is in K</span></a>
<a class="sourceLine" id="cb512-8" title="8"><span class="co">   Pi is in atm</span></a>
<a class="sourceLine" id="cb512-9" title="9"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb512-10" title="10">   R <span class="op">=</span> <span class="fl">0.08206</span> <span class="co"># l atm /K /mol</span></a>
<a class="sourceLine" id="cb512-11" title="11">   p <span class="op">=</span> Pi<span class="op">/</span>(R<span class="op">*</span>T)</a>
<a class="sourceLine" id="cb512-12" title="12">   <span class="cf">return</span> p</a>
<a class="sourceLine" id="cb512-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb512-14" title="14">pressure <span class="op">=</span> <span class="fl">0.02</span> <span class="co">#atm</span></a>
<a class="sourceLine" id="cb512-15" title="15">temperature <span class="op">=</span> <span class="dv">310</span> <span class="co">#K </span></a>
<a class="sourceLine" id="cb512-16" title="16">c <span class="op">=</span> pressure<span class="op">/</span>(<span class="fl">0.08206</span><span class="op">*</span>temperature)</a>
<a class="sourceLine" id="cb512-17" title="17">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">abs</span>(osmotic_pressure_concentration(pressure,temperature)<span class="op">-</span>c)<span class="op">&lt;</span><span class="fl">0.01</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-46">Run 3</h4>
<div class="sourceCode" id="cb514"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb514-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb514-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb514-3" title="3"></a>
<a class="sourceLine" id="cb514-4" title="4"><span class="kw">def</span> osmotic_pressure_concentration(Pi,T):</a>
<a class="sourceLine" id="cb514-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb514-6" title="6"><span class="co">   This function returns the concentration in mol/l given an osmotic pressure Pi and temperature T</span></a>
<a class="sourceLine" id="cb514-7" title="7"><span class="co">   T is in K</span></a>
<a class="sourceLine" id="cb514-8" title="8"><span class="co">   Pi is in atm</span></a>
<a class="sourceLine" id="cb514-9" title="9"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb514-10" title="10">   R <span class="op">=</span> <span class="fl">0.08206</span> <span class="co"># l atm /K /mol</span></a>
<a class="sourceLine" id="cb514-11" title="11">   p <span class="op">=</span> Pi<span class="op">/</span>(R<span class="op">*</span>T)</a>
<a class="sourceLine" id="cb514-12" title="12">   <span class="cf">return</span> p</a>
<a class="sourceLine" id="cb514-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb514-14" title="14">pressure <span class="op">=</span> <span class="fl">0.02</span> <span class="co">#atm</span></a>
<a class="sourceLine" id="cb514-15" title="15">temperature <span class="op">=</span> <span class="dv">310</span> <span class="co">#K </span></a>
<a class="sourceLine" id="cb514-16" title="16">c <span class="op">=</span> pressure<span class="op">/</span>(<span class="fl">0.08206</span><span class="op">*</span>temperature)</a>
<a class="sourceLine" id="cb514-17" title="17">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">abs</span>(osmotic_pressure_concentration(pressure,temperature)<span class="op">-</span>c)<span class="op">&lt;</span><span class="fl">0.01</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-46">Run 4</h4>
<div class="sourceCode" id="cb516"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb516-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb516-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb516-3" title="3"></a>
<a class="sourceLine" id="cb516-4" title="4"><span class="kw">def</span> osmotic_pressure_concentration(Pi,T):</a>
<a class="sourceLine" id="cb516-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb516-6" title="6"><span class="co">   This function returns the concentration in mol/l given an osmotic pressure Pi and temperature T</span></a>
<a class="sourceLine" id="cb516-7" title="7"><span class="co">   T is in K</span></a>
<a class="sourceLine" id="cb516-8" title="8"><span class="co">   Pi is in atm</span></a>
<a class="sourceLine" id="cb516-9" title="9"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb516-10" title="10">   R <span class="op">=</span> <span class="fl">0.08206</span> <span class="co"># l atm /K /mol</span></a>
<a class="sourceLine" id="cb516-11" title="11">   p <span class="op">=</span> Pi<span class="op">/</span>(R<span class="op">*</span>T)</a>
<a class="sourceLine" id="cb516-12" title="12">   <span class="cf">return</span> p</a>
<a class="sourceLine" id="cb516-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb516-14" title="14">pressure <span class="op">=</span> <span class="fl">0.02</span> <span class="co">#atm</span></a>
<a class="sourceLine" id="cb516-15" title="15">temperature <span class="op">=</span> <span class="dv">310</span> <span class="co">#K </span></a>
<a class="sourceLine" id="cb516-16" title="16">c <span class="op">=</span> pressure<span class="op">/</span>(<span class="fl">0.08206</span><span class="op">*</span>temperature)</a>
<a class="sourceLine" id="cb516-17" title="17">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">abs</span>(osmotic_pressure_concentration(pressure,temperature)<span class="op">-</span>c)<span class="op">&lt;</span><span class="fl">0.01</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>pair_wise</summary></p>
<h4 id="query-47">Query</h4>
<div class="sourceCode" id="cb518"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb518-1" title="1"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb518-2" title="2"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb518-3" title="3"></a>
<a class="sourceLine" id="cb518-4" title="4"><span class="kw">def</span> pairwise_dist(pdb_file):</a>
<a class="sourceLine" id="cb518-5" title="5">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb518-6" title="6"><span class="co">  1 This function loads a pdb</span></a>
<a class="sourceLine" id="cb518-7" title="7"><span class="co">  2 Selects only the alpha carbons</span></a>
<a class="sourceLine" id="cb518-8" title="8"><span class="co">  3 Calculates the number of unique alpha carbon pairs</span></a>
<a class="sourceLine" id="cb518-9" title="9"><span class="co">  4 Returns the distances between each alpha carbon pair</span></a>
<a class="sourceLine" id="cb518-10" title="10"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb518-11" title="11">  [insert]</a>
<a class="sourceLine" id="cb518-12" title="12">  <span class="cf">return</span> distances</a></code></pre></div>
<h4 id="run-0-47">Run 0</h4>
<div class="sourceCode" id="cb519"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb519-1" title="1"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb519-2" title="2"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb519-3" title="3"></a>
<a class="sourceLine" id="cb519-4" title="4"><span class="kw">def</span> pairwise_dist(pdb_file):</a>
<a class="sourceLine" id="cb519-5" title="5">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb519-6" title="6"><span class="co">  1 This function loads a pdb</span></a>
<a class="sourceLine" id="cb519-7" title="7"><span class="co">  2 Selects only the alpha carbons</span></a>
<a class="sourceLine" id="cb519-8" title="8"><span class="co">  3 Calculates the number of unique alpha carbon pairs</span></a>
<a class="sourceLine" id="cb519-9" title="9"><span class="co">  4 Returns the distances between each alpha carbon pair</span></a>
<a class="sourceLine" id="cb519-10" title="10"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb519-11" title="11">  traj <span class="op">=</span> md.load(pdb_file)</a>
<a class="sourceLine" id="cb519-12" title="12">  topology <span class="op">=</span> traj.topology</a>
<a class="sourceLine" id="cb519-13" title="13">  alpha_carbons <span class="op">=</span> topology.select(<span class="st">&#39;name CA&#39;</span>)</a>
<a class="sourceLine" id="cb519-14" title="14">  n_alpha_carbons <span class="op">=</span> <span class="bu">len</span>(alpha_carbons)</a>
<a class="sourceLine" id="cb519-15" title="15">  distances <span class="op">=</span> np.zeros((n_alpha_carbons, n_alpha_carbons))</a>
<a class="sourceLine" id="cb519-16" title="16">  <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n_alpha_carbons):</a>
<a class="sourceLine" id="cb519-17" title="17">    <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(i<span class="op">+</span><span class="dv">1</span>, n_alpha_carbons):</a>
<a class="sourceLine" id="cb519-18" title="18">      distances[i,j] <span class="op">=</span> md.compute_distances(traj, [alpha_carbons[i], alpha_carbons[j]])</a>
<a class="sourceLine" id="cb519-19" title="19">      distances[j,i] <span class="op">=</span> distances[i,j]</a>
<a class="sourceLine" id="cb519-20" title="20">  <span class="cf">return</span> distances</a>
<a class="sourceLine" id="cb519-21" title="21"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb519-22" title="22"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb519-23" title="23"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb519-24" title="24"></a>
<a class="sourceLine" id="cb519-25" title="25">pdb_file <span class="op">=</span> os.path.join(_FILE_DIR_, <span class="st">&quot;1VII.pdb&quot;</span>)</a>
<a class="sourceLine" id="cb519-26" title="26"></a>
<a class="sourceLine" id="cb519-27" title="27"></a>
<a class="sourceLine" id="cb519-28" title="28"><span class="kw">def</span> pairwise(pdb_file):</a>
<a class="sourceLine" id="cb519-29" title="29">    <span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb519-30" title="30">    <span class="im">from</span> itertools <span class="im">import</span> combinations</a>
<a class="sourceLine" id="cb519-31" title="31">    pdb <span class="op">=</span> md.load(pdb_file)</a>
<a class="sourceLine" id="cb519-32" title="32">    cas <span class="op">=</span> pdb.top.select(<span class="st">&quot;name CA&quot;</span>)</a>
<a class="sourceLine" id="cb519-33" title="33">    distances <span class="op">=</span> []</a>
<a class="sourceLine" id="cb519-34" title="34">    comb <span class="op">=</span> combinations(cas, <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb519-35" title="35">    distances <span class="op">=</span> md.compute_distances(pdb, comb, periodic<span class="op">=</span><span class="va">True</span>)</a>
<a class="sourceLine" id="cb519-36" title="36">    <span class="cf">return</span> distances</a>
<a class="sourceLine" id="cb519-37" title="37"></a>
<a class="sourceLine" id="cb519-38" title="38"></a>
<a class="sourceLine" id="cb519-39" title="39">my_result <span class="op">=</span> pairwise(pdb_file)</a>
<a class="sourceLine" id="cb519-40" title="40">nlcc_result <span class="op">=</span> pairwise_dist(pdb_file)</a>
<a class="sourceLine" id="cb519-41" title="41"></a>
<a class="sourceLine" id="cb519-42" title="42"><span class="co">#print(&quot;My result:&quot;, my_result)</span></a>
<a class="sourceLine" id="cb519-43" title="43"><span class="co">#print(&quot;nlcc result&quot;, nlcc_result)</span></a>
<a class="sourceLine" id="cb519-44" title="44"></a>
<a class="sourceLine" id="cb519-45" title="45">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">abs</span>(np.mean(my_result) <span class="op">-</span></a>
<a class="sourceLine" id="cb519-46" title="46">                        np.mean(nlcc_result)) <span class="op">&lt;</span> <span class="fl">0.01</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>&#39;Constant&#39; object has no attribute &#39;kind&#39;</code></pre>
<h4 id="run-1-47">Run 1</h4>
<div class="sourceCode" id="cb521"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb521-1" title="1"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb521-2" title="2"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb521-3" title="3"></a>
<a class="sourceLine" id="cb521-4" title="4"><span class="kw">def</span> pairwise_dist(pdb_file):</a>
<a class="sourceLine" id="cb521-5" title="5">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb521-6" title="6"><span class="co">  1 This function loads a pdb</span></a>
<a class="sourceLine" id="cb521-7" title="7"><span class="co">  2 Selects only the alpha carbons</span></a>
<a class="sourceLine" id="cb521-8" title="8"><span class="co">  3 Calculates the number of unique alpha carbon pairs</span></a>
<a class="sourceLine" id="cb521-9" title="9"><span class="co">  4 Returns the distances between each alpha carbon pair</span></a>
<a class="sourceLine" id="cb521-10" title="10"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb521-11" title="11">  traj <span class="op">=</span> md.load(pdb_file)</a>
<a class="sourceLine" id="cb521-12" title="12">  topology <span class="op">=</span> traj.topology</a>
<a class="sourceLine" id="cb521-13" title="13">  alpha_carbons <span class="op">=</span> topology.select(<span class="st">&#39;name CA&#39;</span>)</a>
<a class="sourceLine" id="cb521-14" title="14">  distances <span class="op">=</span> md.compute_distances(traj, alpha_carbons, periodic<span class="op">=</span><span class="va">False</span>)</a>
<a class="sourceLine" id="cb521-15" title="15">  distances <span class="op">=</span> distances[np.triu_indices(<span class="bu">len</span>(alpha_carbons), k<span class="op">=</span><span class="dv">1</span>)]</a>
<a class="sourceLine" id="cb521-16" title="16">  <span class="cf">return</span> distances</a>
<a class="sourceLine" id="cb521-17" title="17"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb521-18" title="18"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb521-19" title="19"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb521-20" title="20"></a>
<a class="sourceLine" id="cb521-21" title="21">pdb_file <span class="op">=</span> os.path.join(_FILE_DIR_, <span class="st">&quot;1VII.pdb&quot;</span>)</a>
<a class="sourceLine" id="cb521-22" title="22"></a>
<a class="sourceLine" id="cb521-23" title="23"></a>
<a class="sourceLine" id="cb521-24" title="24"><span class="kw">def</span> pairwise(pdb_file):</a>
<a class="sourceLine" id="cb521-25" title="25">    <span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb521-26" title="26">    <span class="im">from</span> itertools <span class="im">import</span> combinations</a>
<a class="sourceLine" id="cb521-27" title="27">    pdb <span class="op">=</span> md.load(pdb_file)</a>
<a class="sourceLine" id="cb521-28" title="28">    cas <span class="op">=</span> pdb.top.select(<span class="st">&quot;name CA&quot;</span>)</a>
<a class="sourceLine" id="cb521-29" title="29">    distances <span class="op">=</span> []</a>
<a class="sourceLine" id="cb521-30" title="30">    comb <span class="op">=</span> combinations(cas, <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb521-31" title="31">    distances <span class="op">=</span> md.compute_distances(pdb, comb, periodic<span class="op">=</span><span class="va">True</span>)</a>
<a class="sourceLine" id="cb521-32" title="32">    <span class="cf">return</span> distances</a>
<a class="sourceLine" id="cb521-33" title="33"></a>
<a class="sourceLine" id="cb521-34" title="34"></a>
<a class="sourceLine" id="cb521-35" title="35">my_result <span class="op">=</span> pairwise(pdb_file)</a>
<a class="sourceLine" id="cb521-36" title="36">nlcc_result <span class="op">=</span> pairwise_dist(pdb_file)</a>
<a class="sourceLine" id="cb521-37" title="37"></a>
<a class="sourceLine" id="cb521-38" title="38"><span class="co">#print(&quot;My result:&quot;, my_result)</span></a>
<a class="sourceLine" id="cb521-39" title="39"><span class="co">#print(&quot;nlcc result&quot;, nlcc_result)</span></a>
<a class="sourceLine" id="cb521-40" title="40"></a>
<a class="sourceLine" id="cb521-41" title="41">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">abs</span>(np.mean(my_result) <span class="op">-</span></a>
<a class="sourceLine" id="cb521-42" title="42">                        np.mean(nlcc_result)) <span class="op">&lt;</span> <span class="fl">0.01</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>&#39;Constant&#39; object has no attribute &#39;kind&#39;</code></pre>
<h4 id="run-2-47">Run 2</h4>
<div class="sourceCode" id="cb523"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb523-1" title="1"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb523-2" title="2"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb523-3" title="3"></a>
<a class="sourceLine" id="cb523-4" title="4"><span class="kw">def</span> pairwise_dist(pdb_file):</a>
<a class="sourceLine" id="cb523-5" title="5">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb523-6" title="6"><span class="co">  1 This function loads a pdb</span></a>
<a class="sourceLine" id="cb523-7" title="7"><span class="co">  2 Selects only the alpha carbons</span></a>
<a class="sourceLine" id="cb523-8" title="8"><span class="co">  3 Calculates the number of unique alpha carbon pairs</span></a>
<a class="sourceLine" id="cb523-9" title="9"><span class="co">  4 Returns the distances between each alpha carbon pair</span></a>
<a class="sourceLine" id="cb523-10" title="10"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb523-11" title="11">  traj <span class="op">=</span> md.load(pdb_file)</a>
<a class="sourceLine" id="cb523-12" title="12">  alpha_carbons <span class="op">=</span> traj.topology.select(<span class="st">&#39;name CA&#39;</span>)</a>
<a class="sourceLine" id="cb523-13" title="13">  distances <span class="op">=</span> md.compute_distances(traj, alpha_carbons, periodic<span class="op">=</span><span class="va">False</span>)</a>
<a class="sourceLine" id="cb523-14" title="14">  distances <span class="op">=</span> distances[<span class="dv">0</span>]</a>
<a class="sourceLine" id="cb523-15" title="15">  distances <span class="op">=</span> np.tril(distances)</a>
<a class="sourceLine" id="cb523-16" title="16">  distances <span class="op">=</span> distances[distances <span class="op">&gt;</span> <span class="dv">0</span>]</a>
<a class="sourceLine" id="cb523-17" title="17">  <span class="cf">return</span> distances</a>
<a class="sourceLine" id="cb523-18" title="18"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb523-19" title="19"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb523-20" title="20"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb523-21" title="21"></a>
<a class="sourceLine" id="cb523-22" title="22">pdb_file <span class="op">=</span> os.path.join(_FILE_DIR_, <span class="st">&quot;1VII.pdb&quot;</span>)</a>
<a class="sourceLine" id="cb523-23" title="23"></a>
<a class="sourceLine" id="cb523-24" title="24"></a>
<a class="sourceLine" id="cb523-25" title="25"><span class="kw">def</span> pairwise(pdb_file):</a>
<a class="sourceLine" id="cb523-26" title="26">    <span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb523-27" title="27">    <span class="im">from</span> itertools <span class="im">import</span> combinations</a>
<a class="sourceLine" id="cb523-28" title="28">    pdb <span class="op">=</span> md.load(pdb_file)</a>
<a class="sourceLine" id="cb523-29" title="29">    cas <span class="op">=</span> pdb.top.select(<span class="st">&quot;name CA&quot;</span>)</a>
<a class="sourceLine" id="cb523-30" title="30">    distances <span class="op">=</span> []</a>
<a class="sourceLine" id="cb523-31" title="31">    comb <span class="op">=</span> combinations(cas, <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb523-32" title="32">    distances <span class="op">=</span> md.compute_distances(pdb, comb, periodic<span class="op">=</span><span class="va">True</span>)</a>
<a class="sourceLine" id="cb523-33" title="33">    <span class="cf">return</span> distances</a>
<a class="sourceLine" id="cb523-34" title="34"></a>
<a class="sourceLine" id="cb523-35" title="35"></a>
<a class="sourceLine" id="cb523-36" title="36">my_result <span class="op">=</span> pairwise(pdb_file)</a>
<a class="sourceLine" id="cb523-37" title="37">nlcc_result <span class="op">=</span> pairwise_dist(pdb_file)</a>
<a class="sourceLine" id="cb523-38" title="38"></a>
<a class="sourceLine" id="cb523-39" title="39"><span class="co">#print(&quot;My result:&quot;, my_result)</span></a>
<a class="sourceLine" id="cb523-40" title="40"><span class="co">#print(&quot;nlcc result&quot;, nlcc_result)</span></a>
<a class="sourceLine" id="cb523-41" title="41"></a>
<a class="sourceLine" id="cb523-42" title="42">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">abs</span>(np.mean(my_result) <span class="op">-</span></a>
<a class="sourceLine" id="cb523-43" title="43">                        np.mean(nlcc_result)) <span class="op">&lt;</span> <span class="fl">0.01</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>&#39;Constant&#39; object has no attribute &#39;kind&#39;</code></pre>
<h4 id="run-3-47">Run 3</h4>
<div class="sourceCode" id="cb525"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb525-1" title="1"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb525-2" title="2"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb525-3" title="3"></a>
<a class="sourceLine" id="cb525-4" title="4"><span class="kw">def</span> pairwise_dist(pdb_file):</a>
<a class="sourceLine" id="cb525-5" title="5">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb525-6" title="6"><span class="co">  1 This function loads a pdb</span></a>
<a class="sourceLine" id="cb525-7" title="7"><span class="co">  2 Selects only the alpha carbons</span></a>
<a class="sourceLine" id="cb525-8" title="8"><span class="co">  3 Calculates the number of unique alpha carbon pairs</span></a>
<a class="sourceLine" id="cb525-9" title="9"><span class="co">  4 Returns the distances between each alpha carbon pair</span></a>
<a class="sourceLine" id="cb525-10" title="10"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb525-11" title="11">  traj <span class="op">=</span> md.load(pdb_file)</a>
<a class="sourceLine" id="cb525-12" title="12">  topology <span class="op">=</span> traj.topology</a>
<a class="sourceLine" id="cb525-13" title="13">  alpha_carbons <span class="op">=</span> topology.select(<span class="st">&#39;name CA&#39;</span>)</a>
<a class="sourceLine" id="cb525-14" title="14">  distances <span class="op">=</span> md.compute_distances(traj, alpha_carbons, alpha_carbons)</a>
<a class="sourceLine" id="cb525-15" title="15">  distances <span class="op">=</span> distances[np.triu_indices(<span class="bu">len</span>(alpha_carbons), k<span class="op">=</span><span class="dv">1</span>)]</a>
<a class="sourceLine" id="cb525-16" title="16">  <span class="cf">return</span> distances</a>
<a class="sourceLine" id="cb525-17" title="17"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb525-18" title="18"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb525-19" title="19"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb525-20" title="20"></a>
<a class="sourceLine" id="cb525-21" title="21">pdb_file <span class="op">=</span> os.path.join(_FILE_DIR_, <span class="st">&quot;1VII.pdb&quot;</span>)</a>
<a class="sourceLine" id="cb525-22" title="22"></a>
<a class="sourceLine" id="cb525-23" title="23"></a>
<a class="sourceLine" id="cb525-24" title="24"><span class="kw">def</span> pairwise(pdb_file):</a>
<a class="sourceLine" id="cb525-25" title="25">    <span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb525-26" title="26">    <span class="im">from</span> itertools <span class="im">import</span> combinations</a>
<a class="sourceLine" id="cb525-27" title="27">    pdb <span class="op">=</span> md.load(pdb_file)</a>
<a class="sourceLine" id="cb525-28" title="28">    cas <span class="op">=</span> pdb.top.select(<span class="st">&quot;name CA&quot;</span>)</a>
<a class="sourceLine" id="cb525-29" title="29">    distances <span class="op">=</span> []</a>
<a class="sourceLine" id="cb525-30" title="30">    comb <span class="op">=</span> combinations(cas, <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb525-31" title="31">    distances <span class="op">=</span> md.compute_distances(pdb, comb, periodic<span class="op">=</span><span class="va">True</span>)</a>
<a class="sourceLine" id="cb525-32" title="32">    <span class="cf">return</span> distances</a>
<a class="sourceLine" id="cb525-33" title="33"></a>
<a class="sourceLine" id="cb525-34" title="34"></a>
<a class="sourceLine" id="cb525-35" title="35">my_result <span class="op">=</span> pairwise(pdb_file)</a>
<a class="sourceLine" id="cb525-36" title="36">nlcc_result <span class="op">=</span> pairwise_dist(pdb_file)</a>
<a class="sourceLine" id="cb525-37" title="37"></a>
<a class="sourceLine" id="cb525-38" title="38"><span class="co">#print(&quot;My result:&quot;, my_result)</span></a>
<a class="sourceLine" id="cb525-39" title="39"><span class="co">#print(&quot;nlcc result&quot;, nlcc_result)</span></a>
<a class="sourceLine" id="cb525-40" title="40"></a>
<a class="sourceLine" id="cb525-41" title="41">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">abs</span>(np.mean(my_result) <span class="op">-</span></a>
<a class="sourceLine" id="cb525-42" title="42">                        np.mean(nlcc_result)) <span class="op">&lt;</span> <span class="fl">0.01</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>&#39;Constant&#39; object has no attribute &#39;kind&#39;</code></pre>
<h4 id="run-4-47">Run 4</h4>
<div class="sourceCode" id="cb527"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb527-1" title="1"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb527-2" title="2"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb527-3" title="3"></a>
<a class="sourceLine" id="cb527-4" title="4"><span class="kw">def</span> pairwise_dist(pdb_file):</a>
<a class="sourceLine" id="cb527-5" title="5">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb527-6" title="6"><span class="co">  1 This function loads a pdb</span></a>
<a class="sourceLine" id="cb527-7" title="7"><span class="co">  2 Selects only the alpha carbons</span></a>
<a class="sourceLine" id="cb527-8" title="8"><span class="co">  3 Calculates the number of unique alpha carbon pairs</span></a>
<a class="sourceLine" id="cb527-9" title="9"><span class="co">  4 Returns the distances between each alpha carbon pair</span></a>
<a class="sourceLine" id="cb527-10" title="10"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb527-11" title="11">  traj <span class="op">=</span> md.load(pdb_file)</a>
<a class="sourceLine" id="cb527-12" title="12">  topology <span class="op">=</span> traj.topology</a>
<a class="sourceLine" id="cb527-13" title="13">  alpha_carbons <span class="op">=</span> topology.select(<span class="st">&#39;name CA&#39;</span>)</a>
<a class="sourceLine" id="cb527-14" title="14">  distances <span class="op">=</span> md.compute_distances(traj, alpha_carbons, alpha_carbons)</a>
<a class="sourceLine" id="cb527-15" title="15">  distances <span class="op">=</span> np.tril(distances)</a>
<a class="sourceLine" id="cb527-16" title="16">  distances <span class="op">=</span> distances[distances <span class="op">&gt;</span> <span class="dv">0</span>]</a>
<a class="sourceLine" id="cb527-17" title="17">  <span class="cf">return</span> distances</a>
<a class="sourceLine" id="cb527-18" title="18"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb527-19" title="19"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb527-20" title="20"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb527-21" title="21"></a>
<a class="sourceLine" id="cb527-22" title="22">pdb_file <span class="op">=</span> os.path.join(_FILE_DIR_, <span class="st">&quot;1VII.pdb&quot;</span>)</a>
<a class="sourceLine" id="cb527-23" title="23"></a>
<a class="sourceLine" id="cb527-24" title="24"></a>
<a class="sourceLine" id="cb527-25" title="25"><span class="kw">def</span> pairwise(pdb_file):</a>
<a class="sourceLine" id="cb527-26" title="26">    <span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb527-27" title="27">    <span class="im">from</span> itertools <span class="im">import</span> combinations</a>
<a class="sourceLine" id="cb527-28" title="28">    pdb <span class="op">=</span> md.load(pdb_file)</a>
<a class="sourceLine" id="cb527-29" title="29">    cas <span class="op">=</span> pdb.top.select(<span class="st">&quot;name CA&quot;</span>)</a>
<a class="sourceLine" id="cb527-30" title="30">    distances <span class="op">=</span> []</a>
<a class="sourceLine" id="cb527-31" title="31">    comb <span class="op">=</span> combinations(cas, <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb527-32" title="32">    distances <span class="op">=</span> md.compute_distances(pdb, comb, periodic<span class="op">=</span><span class="va">True</span>)</a>
<a class="sourceLine" id="cb527-33" title="33">    <span class="cf">return</span> distances</a>
<a class="sourceLine" id="cb527-34" title="34"></a>
<a class="sourceLine" id="cb527-35" title="35"></a>
<a class="sourceLine" id="cb527-36" title="36">my_result <span class="op">=</span> pairwise(pdb_file)</a>
<a class="sourceLine" id="cb527-37" title="37">nlcc_result <span class="op">=</span> pairwise_dist(pdb_file)</a>
<a class="sourceLine" id="cb527-38" title="38"></a>
<a class="sourceLine" id="cb527-39" title="39"><span class="co">#print(&quot;My result:&quot;, my_result)</span></a>
<a class="sourceLine" id="cb527-40" title="40"><span class="co">#print(&quot;nlcc result&quot;, nlcc_result)</span></a>
<a class="sourceLine" id="cb527-41" title="41"></a>
<a class="sourceLine" id="cb527-42" title="42">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">abs</span>(np.mean(my_result) <span class="op">-</span></a>
<a class="sourceLine" id="cb527-43" title="43">                        np.mean(nlcc_result)) <span class="op">&lt;</span> <span class="fl">0.01</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>&#39;Constant&#39; object has no attribute &#39;kind&#39;</code></pre>
</details>
<details>
<p><summary>pi</summary></p>
<h4 id="query-48">Query</h4>
<div class="sourceCode" id="cb529"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb529-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb529-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb529-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb529-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb529-5" title="5"></a>
<a class="sourceLine" id="cb529-6" title="6"><span class="kw">def</span> pi(nsamples):</a>
<a class="sourceLine" id="cb529-7" title="7">    <span class="co">&quot;&quot;&quot; This function returns the value of pi by monte carlo sampling &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb529-8" title="8">    [insert]</a>
<a class="sourceLine" id="cb529-9" title="9">    <span class="cf">return</span> pi_est</a></code></pre></div>
<h4 id="run-0-48">Run 0</h4>
<div class="sourceCode" id="cb530"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb530-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb530-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb530-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb530-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb530-5" title="5"></a>
<a class="sourceLine" id="cb530-6" title="6"><span class="kw">def</span> pi(nsamples):</a>
<a class="sourceLine" id="cb530-7" title="7">    <span class="co">&quot;&quot;&quot; This function returns the value of pi by monte carlo sampling &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb530-8" title="8">    x <span class="op">=</span> np.random.uniform(<span class="dv">0</span>,<span class="dv">1</span>,nsamples)</a>
<a class="sourceLine" id="cb530-9" title="9">    y <span class="op">=</span> np.random.uniform(<span class="dv">0</span>,<span class="dv">1</span>,nsamples)</a>
<a class="sourceLine" id="cb530-10" title="10">    r <span class="op">=</span> np.sqrt(x<span class="op">**</span><span class="dv">2</span> <span class="op">+</span> y<span class="op">**</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb530-11" title="11">    pi_est <span class="op">=</span> <span class="fl">4.0</span><span class="op">*</span>np.<span class="bu">sum</span>(r<span class="op">&lt;</span><span class="dv">1</span>)<span class="op">/</span>nsamples</a>
<a class="sourceLine" id="cb530-12" title="12">    <span class="cf">return</span> pi_est</a>
<a class="sourceLine" id="cb530-13" title="13">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">abs</span>(pi(<span class="dv">10000</span>)<span class="op">-</span><span class="fl">3.14159265</span>)<span class="op">&lt;</span><span class="fl">0.1</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-48">Run 1</h4>
<div class="sourceCode" id="cb532"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb532-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb532-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb532-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb532-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb532-5" title="5"></a>
<a class="sourceLine" id="cb532-6" title="6"><span class="kw">def</span> pi(nsamples):</a>
<a class="sourceLine" id="cb532-7" title="7">    <span class="co">&quot;&quot;&quot; This function returns the value of pi by monte carlo sampling &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb532-8" title="8">    x <span class="op">=</span> np.random.uniform(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>,nsamples)</a>
<a class="sourceLine" id="cb532-9" title="9">    y <span class="op">=</span> np.random.uniform(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>,nsamples)</a>
<a class="sourceLine" id="cb532-10" title="10">    r <span class="op">=</span> np.sqrt(x<span class="op">**</span><span class="dv">2</span> <span class="op">+</span> y<span class="op">**</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb532-11" title="11">    pi_est <span class="op">=</span> <span class="dv">4</span> <span class="op">*</span> np.<span class="bu">sum</span>(r<span class="op">&lt;</span><span class="dv">1</span>) <span class="op">/</span> nsamples</a>
<a class="sourceLine" id="cb532-12" title="12">    <span class="cf">return</span> pi_est</a>
<a class="sourceLine" id="cb532-13" title="13">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">abs</span>(pi(<span class="dv">10000</span>)<span class="op">-</span><span class="fl">3.14159265</span>)<span class="op">&lt;</span><span class="fl">0.1</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-48">Run 2</h4>
<div class="sourceCode" id="cb534"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb534-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb534-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb534-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb534-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb534-5" title="5"></a>
<a class="sourceLine" id="cb534-6" title="6"><span class="kw">def</span> pi(nsamples):</a>
<a class="sourceLine" id="cb534-7" title="7">    <span class="co">&quot;&quot;&quot; This function returns the value of pi by monte carlo sampling &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb534-8" title="8">    <span class="co"># generate random numbers</span></a>
<a class="sourceLine" id="cb534-9" title="9">    x <span class="op">=</span> np.random.uniform(<span class="dv">0</span>,<span class="dv">1</span>,nsamples)</a>
<a class="sourceLine" id="cb534-10" title="10">    y <span class="op">=</span> np.random.uniform(<span class="dv">0</span>,<span class="dv">1</span>,nsamples)</a>
<a class="sourceLine" id="cb534-11" title="11">    <span class="co"># calculate the distance from the origin</span></a>
<a class="sourceLine" id="cb534-12" title="12">    r <span class="op">=</span> np.sqrt(x<span class="op">**</span><span class="dv">2</span> <span class="op">+</span> y<span class="op">**</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb534-13" title="13">    <span class="co"># count the number of points inside the circle</span></a>
<a class="sourceLine" id="cb534-14" title="14">    ninside <span class="op">=</span> np.<span class="bu">sum</span>(r <span class="op">&lt;</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb534-15" title="15">    <span class="co"># calculate the area of the circle</span></a>
<a class="sourceLine" id="cb534-16" title="16">    area <span class="op">=</span> ninside<span class="op">/</span>nsamples</a>
<a class="sourceLine" id="cb534-17" title="17">    <span class="co"># calculate the value of pi</span></a>
<a class="sourceLine" id="cb534-18" title="18">    pi_est <span class="op">=</span> area<span class="op">*</span><span class="dv">4</span></a>
<a class="sourceLine" id="cb534-19" title="19">    <span class="co"># return the value of pi</span></a>
<a class="sourceLine" id="cb534-20" title="20">    <span class="cf">return</span> pi_est</a>
<a class="sourceLine" id="cb534-21" title="21"></a>
<a class="sourceLine" id="cb534-22" title="22"></a>
<a class="sourceLine" id="cb534-23" title="23">    <span class="cf">return</span> pi_est</a>
<a class="sourceLine" id="cb534-24" title="24">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">abs</span>(pi(<span class="dv">10000</span>)<span class="op">-</span><span class="fl">3.14159265</span>)<span class="op">&lt;</span><span class="fl">0.1</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-48">Run 3</h4>
<div class="sourceCode" id="cb536"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb536-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb536-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb536-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb536-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb536-5" title="5"></a>
<a class="sourceLine" id="cb536-6" title="6"><span class="kw">def</span> pi(nsamples):</a>
<a class="sourceLine" id="cb536-7" title="7">    <span class="co">&quot;&quot;&quot; This function returns the value of pi by monte carlo sampling &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb536-8" title="8">    x <span class="op">=</span> np.random.uniform(<span class="dv">0</span>,<span class="dv">1</span>,nsamples)</a>
<a class="sourceLine" id="cb536-9" title="9">    y <span class="op">=</span> np.random.uniform(<span class="dv">0</span>,<span class="dv">1</span>,nsamples)</a>
<a class="sourceLine" id="cb536-10" title="10">    r <span class="op">=</span> np.sqrt(x<span class="op">**</span><span class="dv">2</span> <span class="op">+</span> y<span class="op">**</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb536-11" title="11">    pi_est <span class="op">=</span> <span class="dv">4</span><span class="op">*</span>np.<span class="bu">sum</span>(r<span class="op">&lt;</span><span class="dv">1</span>)<span class="op">/</span>nsamples</a>
<a class="sourceLine" id="cb536-12" title="12">    <span class="cf">return</span> pi_est</a>
<a class="sourceLine" id="cb536-13" title="13"></a>
<a class="sourceLine" id="cb536-14" title="14"></a>
<a class="sourceLine" id="cb536-15" title="15">    <span class="cf">return</span> pi_est</a>
<a class="sourceLine" id="cb536-16" title="16">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">abs</span>(pi(<span class="dv">10000</span>)<span class="op">-</span><span class="fl">3.14159265</span>)<span class="op">&lt;</span><span class="fl">0.1</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-48">Run 4</h4>
<div class="sourceCode" id="cb538"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb538-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb538-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb538-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb538-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb538-5" title="5"></a>
<a class="sourceLine" id="cb538-6" title="6"><span class="kw">def</span> pi(nsamples):</a>
<a class="sourceLine" id="cb538-7" title="7">    <span class="co">&quot;&quot;&quot; This function returns the value of pi by monte carlo sampling &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb538-8" title="8">    x <span class="op">=</span> np.random.uniform(<span class="dv">0</span>,<span class="dv">1</span>,nsamples)</a>
<a class="sourceLine" id="cb538-9" title="9">    y <span class="op">=</span> np.random.uniform(<span class="dv">0</span>,<span class="dv">1</span>,nsamples)</a>
<a class="sourceLine" id="cb538-10" title="10">    r <span class="op">=</span> np.sqrt(x<span class="op">**</span><span class="dv">2</span> <span class="op">+</span> y<span class="op">**</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb538-11" title="11">    pi_est <span class="op">=</span> <span class="dv">4</span><span class="op">*</span>np.<span class="bu">sum</span>(r<span class="op">&lt;</span><span class="dv">1</span>)<span class="op">/</span>nsamples</a>
<a class="sourceLine" id="cb538-12" title="12">    <span class="cf">return</span> pi_est</a>
<a class="sourceLine" id="cb538-13" title="13"></a>
<a class="sourceLine" id="cb538-14" title="14"></a>
<a class="sourceLine" id="cb538-15" title="15">    <span class="cf">return</span> pi_est</a>
<a class="sourceLine" id="cb538-16" title="16">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">abs</span>(pi(<span class="dv">10000</span>)<span class="op">-</span><span class="fl">3.14159265</span>)<span class="op">&lt;</span><span class="fl">0.1</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>pib_1d</summary></p>
<h4 id="query-49">Query</h4>
<div class="sourceCode" id="cb540"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb540-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb540-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb540-3" title="3"></a>
<a class="sourceLine" id="cb540-4" title="4"><span class="kw">def</span> particle_in_box(n,m,L,hbar<span class="op">=</span><span class="dv">1</span>):</a>
<a class="sourceLine" id="cb540-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb540-6" title="6"><span class="co">   This function returns the energy for a quantum particle in a 1d box</span></a>
<a class="sourceLine" id="cb540-7" title="7"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb540-8" title="8">   [insert]</a>
<a class="sourceLine" id="cb540-9" title="9">   <span class="cf">return</span> e</a></code></pre></div>
<h4 id="run-0-49">Run 0</h4>
<div class="sourceCode" id="cb541"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb541-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb541-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb541-3" title="3"></a>
<a class="sourceLine" id="cb541-4" title="4"><span class="kw">def</span> particle_in_box(n,m,L,hbar<span class="op">=</span><span class="dv">1</span>):</a>
<a class="sourceLine" id="cb541-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb541-6" title="6"><span class="co">   This function returns the energy for a quantum particle in a 1d box</span></a>
<a class="sourceLine" id="cb541-7" title="7"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb541-8" title="8">   e <span class="op">=</span> (n<span class="op">**</span><span class="dv">2</span><span class="op">*</span>math.pi<span class="op">**</span><span class="dv">2</span><span class="op">*</span>hbar<span class="op">**</span><span class="dv">2</span>)<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>m<span class="op">*</span>L<span class="op">**</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb541-9" title="9">   <span class="cf">return</span> e</a>
<a class="sourceLine" id="cb541-10" title="10"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb541-11" title="11"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb541-12" title="12"></a>
<a class="sourceLine" id="cb541-13" title="13"><span class="co"># input params </span></a>
<a class="sourceLine" id="cb541-14" title="14">L <span class="op">=</span> <span class="dv">10</span>     <span class="co"># length of the box</span></a>
<a class="sourceLine" id="cb541-15" title="15">m <span class="op">=</span> <span class="dv">1</span>      <span class="co"># masss of the particle</span></a>
<a class="sourceLine" id="cb541-16" title="16">n <span class="op">=</span> <span class="dv">10</span>     <span class="co"># quantum number </span></a>
<a class="sourceLine" id="cb541-17" title="17">hbar <span class="op">=</span> <span class="dv">1</span>      <span class="co"># planck constant</span></a>
<a class="sourceLine" id="cb541-18" title="18"></a>
<a class="sourceLine" id="cb541-19" title="19"><span class="co"># energy</span></a>
<a class="sourceLine" id="cb541-20" title="20">e_n <span class="op">=</span> ((n<span class="op">**</span><span class="dv">2</span>)<span class="op">*</span>(hbar<span class="op">**</span><span class="dv">2</span>)<span class="op">*</span>(np.pi<span class="op">**</span><span class="dv">2</span>))<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>m<span class="op">*</span>L<span class="op">**</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb541-21" title="21"><span class="bu">print</span>(<span class="st">&quot;energy =&quot;</span>, e_n)</a>
<a class="sourceLine" id="cb541-22" title="22"></a>
<a class="sourceLine" id="cb541-23" title="23">e_n_codex <span class="op">=</span> particle_in_box(n,m,L)  </a>
<a class="sourceLine" id="cb541-24" title="24"><span class="bu">print</span>(<span class="st">&quot;energy from codex =&quot;</span>, e_n_codex)</a>
<a class="sourceLine" id="cb541-25" title="25"></a>
<a class="sourceLine" id="cb541-26" title="26"></a>
<a class="sourceLine" id="cb541-27" title="27"><span class="co"># check</span></a>
<a class="sourceLine" id="cb541-28" title="28"><span class="cf">if</span> <span class="bu">abs</span>(e_n <span class="op">-</span> e_n_codex) <span class="op">&lt;=</span> <span class="fl">1e-3</span>:</a>
<a class="sourceLine" id="cb541-29" title="29">    result <span class="op">=</span> <span class="va">True</span> </a>
<a class="sourceLine" id="cb541-30" title="30"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb541-31" title="31">    result <span class="op">=</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb541-32" title="32"></a>
<a class="sourceLine" id="cb541-33" title="33"></a>
<a class="sourceLine" id="cb541-34" title="34"></a>
<a class="sourceLine" id="cb541-35" title="35"></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-49">Run 1</h4>
<div class="sourceCode" id="cb543"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb543-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb543-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb543-3" title="3"></a>
<a class="sourceLine" id="cb543-4" title="4"><span class="kw">def</span> particle_in_box(n,m,L,hbar<span class="op">=</span><span class="dv">1</span>):</a>
<a class="sourceLine" id="cb543-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb543-6" title="6"><span class="co">   This function returns the energy for a quantum particle in a 1d box</span></a>
<a class="sourceLine" id="cb543-7" title="7"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb543-8" title="8">   e <span class="op">=</span> (n<span class="op">**</span><span class="dv">2</span> <span class="op">*</span> math.pi<span class="op">**</span><span class="dv">2</span> <span class="op">*</span> hbar<span class="op">**</span><span class="dv">2</span>)<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>m<span class="op">*</span>L<span class="op">**</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb543-9" title="9">   <span class="cf">return</span> e</a>
<a class="sourceLine" id="cb543-10" title="10"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb543-11" title="11"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb543-12" title="12"></a>
<a class="sourceLine" id="cb543-13" title="13"><span class="co"># input params </span></a>
<a class="sourceLine" id="cb543-14" title="14">L <span class="op">=</span> <span class="dv">10</span>     <span class="co"># length of the box</span></a>
<a class="sourceLine" id="cb543-15" title="15">m <span class="op">=</span> <span class="dv">1</span>      <span class="co"># masss of the particle</span></a>
<a class="sourceLine" id="cb543-16" title="16">n <span class="op">=</span> <span class="dv">10</span>     <span class="co"># quantum number </span></a>
<a class="sourceLine" id="cb543-17" title="17">hbar <span class="op">=</span> <span class="dv">1</span>      <span class="co"># planck constant</span></a>
<a class="sourceLine" id="cb543-18" title="18"></a>
<a class="sourceLine" id="cb543-19" title="19"><span class="co"># energy</span></a>
<a class="sourceLine" id="cb543-20" title="20">e_n <span class="op">=</span> ((n<span class="op">**</span><span class="dv">2</span>)<span class="op">*</span>(hbar<span class="op">**</span><span class="dv">2</span>)<span class="op">*</span>(np.pi<span class="op">**</span><span class="dv">2</span>))<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>m<span class="op">*</span>L<span class="op">**</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb543-21" title="21"><span class="bu">print</span>(<span class="st">&quot;energy =&quot;</span>, e_n)</a>
<a class="sourceLine" id="cb543-22" title="22"></a>
<a class="sourceLine" id="cb543-23" title="23">e_n_codex <span class="op">=</span> particle_in_box(n,m,L)  </a>
<a class="sourceLine" id="cb543-24" title="24"><span class="bu">print</span>(<span class="st">&quot;energy from codex =&quot;</span>, e_n_codex)</a>
<a class="sourceLine" id="cb543-25" title="25"></a>
<a class="sourceLine" id="cb543-26" title="26"></a>
<a class="sourceLine" id="cb543-27" title="27"><span class="co"># check</span></a>
<a class="sourceLine" id="cb543-28" title="28"><span class="cf">if</span> <span class="bu">abs</span>(e_n <span class="op">-</span> e_n_codex) <span class="op">&lt;=</span> <span class="fl">1e-3</span>:</a>
<a class="sourceLine" id="cb543-29" title="29">    result <span class="op">=</span> <span class="va">True</span> </a>
<a class="sourceLine" id="cb543-30" title="30"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb543-31" title="31">    result <span class="op">=</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb543-32" title="32"></a>
<a class="sourceLine" id="cb543-33" title="33"></a>
<a class="sourceLine" id="cb543-34" title="34"></a>
<a class="sourceLine" id="cb543-35" title="35"></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-49">Run 2</h4>
<div class="sourceCode" id="cb545"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb545-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb545-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb545-3" title="3"></a>
<a class="sourceLine" id="cb545-4" title="4"><span class="kw">def</span> particle_in_box(n,m,L,hbar<span class="op">=</span><span class="dv">1</span>):</a>
<a class="sourceLine" id="cb545-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb545-6" title="6"><span class="co">   This function returns the energy for a quantum particle in a 1d box</span></a>
<a class="sourceLine" id="cb545-7" title="7"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb545-8" title="8">   e <span class="op">=</span> (n<span class="op">**</span><span class="dv">2</span> <span class="op">*</span> math.pi<span class="op">**</span><span class="dv">2</span> <span class="op">*</span> hbar<span class="op">**</span><span class="dv">2</span>)<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>m<span class="op">*</span>L<span class="op">**</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb545-9" title="9">   <span class="cf">return</span> e</a>
<a class="sourceLine" id="cb545-10" title="10"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb545-11" title="11"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb545-12" title="12"></a>
<a class="sourceLine" id="cb545-13" title="13"><span class="co"># input params </span></a>
<a class="sourceLine" id="cb545-14" title="14">L <span class="op">=</span> <span class="dv">10</span>     <span class="co"># length of the box</span></a>
<a class="sourceLine" id="cb545-15" title="15">m <span class="op">=</span> <span class="dv">1</span>      <span class="co"># masss of the particle</span></a>
<a class="sourceLine" id="cb545-16" title="16">n <span class="op">=</span> <span class="dv">10</span>     <span class="co"># quantum number </span></a>
<a class="sourceLine" id="cb545-17" title="17">hbar <span class="op">=</span> <span class="dv">1</span>      <span class="co"># planck constant</span></a>
<a class="sourceLine" id="cb545-18" title="18"></a>
<a class="sourceLine" id="cb545-19" title="19"><span class="co"># energy</span></a>
<a class="sourceLine" id="cb545-20" title="20">e_n <span class="op">=</span> ((n<span class="op">**</span><span class="dv">2</span>)<span class="op">*</span>(hbar<span class="op">**</span><span class="dv">2</span>)<span class="op">*</span>(np.pi<span class="op">**</span><span class="dv">2</span>))<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>m<span class="op">*</span>L<span class="op">**</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb545-21" title="21"><span class="bu">print</span>(<span class="st">&quot;energy =&quot;</span>, e_n)</a>
<a class="sourceLine" id="cb545-22" title="22"></a>
<a class="sourceLine" id="cb545-23" title="23">e_n_codex <span class="op">=</span> particle_in_box(n,m,L)  </a>
<a class="sourceLine" id="cb545-24" title="24"><span class="bu">print</span>(<span class="st">&quot;energy from codex =&quot;</span>, e_n_codex)</a>
<a class="sourceLine" id="cb545-25" title="25"></a>
<a class="sourceLine" id="cb545-26" title="26"></a>
<a class="sourceLine" id="cb545-27" title="27"><span class="co"># check</span></a>
<a class="sourceLine" id="cb545-28" title="28"><span class="cf">if</span> <span class="bu">abs</span>(e_n <span class="op">-</span> e_n_codex) <span class="op">&lt;=</span> <span class="fl">1e-3</span>:</a>
<a class="sourceLine" id="cb545-29" title="29">    result <span class="op">=</span> <span class="va">True</span> </a>
<a class="sourceLine" id="cb545-30" title="30"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb545-31" title="31">    result <span class="op">=</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb545-32" title="32"></a>
<a class="sourceLine" id="cb545-33" title="33"></a>
<a class="sourceLine" id="cb545-34" title="34"></a>
<a class="sourceLine" id="cb545-35" title="35"></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-49">Run 3</h4>
<div class="sourceCode" id="cb547"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb547-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb547-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb547-3" title="3"></a>
<a class="sourceLine" id="cb547-4" title="4"><span class="kw">def</span> particle_in_box(n,m,L,hbar<span class="op">=</span><span class="dv">1</span>):</a>
<a class="sourceLine" id="cb547-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb547-6" title="6"><span class="co">   This function returns the energy for a quantum particle in a 1d box</span></a>
<a class="sourceLine" id="cb547-7" title="7"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb547-8" title="8">   e <span class="op">=</span> (n<span class="op">**</span><span class="dv">2</span><span class="op">*</span>math.pi<span class="op">**</span><span class="dv">2</span><span class="op">*</span>hbar<span class="op">**</span><span class="dv">2</span>)<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>m<span class="op">*</span>L<span class="op">**</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb547-9" title="9">   <span class="cf">return</span> e</a>
<a class="sourceLine" id="cb547-10" title="10"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb547-11" title="11"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb547-12" title="12"></a>
<a class="sourceLine" id="cb547-13" title="13"><span class="co"># input params </span></a>
<a class="sourceLine" id="cb547-14" title="14">L <span class="op">=</span> <span class="dv">10</span>     <span class="co"># length of the box</span></a>
<a class="sourceLine" id="cb547-15" title="15">m <span class="op">=</span> <span class="dv">1</span>      <span class="co"># masss of the particle</span></a>
<a class="sourceLine" id="cb547-16" title="16">n <span class="op">=</span> <span class="dv">10</span>     <span class="co"># quantum number </span></a>
<a class="sourceLine" id="cb547-17" title="17">hbar <span class="op">=</span> <span class="dv">1</span>      <span class="co"># planck constant</span></a>
<a class="sourceLine" id="cb547-18" title="18"></a>
<a class="sourceLine" id="cb547-19" title="19"><span class="co"># energy</span></a>
<a class="sourceLine" id="cb547-20" title="20">e_n <span class="op">=</span> ((n<span class="op">**</span><span class="dv">2</span>)<span class="op">*</span>(hbar<span class="op">**</span><span class="dv">2</span>)<span class="op">*</span>(np.pi<span class="op">**</span><span class="dv">2</span>))<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>m<span class="op">*</span>L<span class="op">**</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb547-21" title="21"><span class="bu">print</span>(<span class="st">&quot;energy =&quot;</span>, e_n)</a>
<a class="sourceLine" id="cb547-22" title="22"></a>
<a class="sourceLine" id="cb547-23" title="23">e_n_codex <span class="op">=</span> particle_in_box(n,m,L)  </a>
<a class="sourceLine" id="cb547-24" title="24"><span class="bu">print</span>(<span class="st">&quot;energy from codex =&quot;</span>, e_n_codex)</a>
<a class="sourceLine" id="cb547-25" title="25"></a>
<a class="sourceLine" id="cb547-26" title="26"></a>
<a class="sourceLine" id="cb547-27" title="27"><span class="co"># check</span></a>
<a class="sourceLine" id="cb547-28" title="28"><span class="cf">if</span> <span class="bu">abs</span>(e_n <span class="op">-</span> e_n_codex) <span class="op">&lt;=</span> <span class="fl">1e-3</span>:</a>
<a class="sourceLine" id="cb547-29" title="29">    result <span class="op">=</span> <span class="va">True</span> </a>
<a class="sourceLine" id="cb547-30" title="30"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb547-31" title="31">    result <span class="op">=</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb547-32" title="32"></a>
<a class="sourceLine" id="cb547-33" title="33"></a>
<a class="sourceLine" id="cb547-34" title="34"></a>
<a class="sourceLine" id="cb547-35" title="35"></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-49">Run 4</h4>
<div class="sourceCode" id="cb549"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb549-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb549-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb549-3" title="3"></a>
<a class="sourceLine" id="cb549-4" title="4"><span class="kw">def</span> particle_in_box(n,m,L,hbar<span class="op">=</span><span class="dv">1</span>):</a>
<a class="sourceLine" id="cb549-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb549-6" title="6"><span class="co">   This function returns the energy for a quantum particle in a 1d box</span></a>
<a class="sourceLine" id="cb549-7" title="7"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb549-8" title="8">   e <span class="op">=</span> (n<span class="op">**</span><span class="dv">2</span><span class="op">*</span>math.pi<span class="op">**</span><span class="dv">2</span><span class="op">*</span>hbar<span class="op">**</span><span class="dv">2</span>)<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>m<span class="op">*</span>L<span class="op">**</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb549-9" title="9">   <span class="cf">return</span> e</a>
<a class="sourceLine" id="cb549-10" title="10"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb549-11" title="11"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb549-12" title="12"></a>
<a class="sourceLine" id="cb549-13" title="13"><span class="co"># input params </span></a>
<a class="sourceLine" id="cb549-14" title="14">L <span class="op">=</span> <span class="dv">10</span>     <span class="co"># length of the box</span></a>
<a class="sourceLine" id="cb549-15" title="15">m <span class="op">=</span> <span class="dv">1</span>      <span class="co"># masss of the particle</span></a>
<a class="sourceLine" id="cb549-16" title="16">n <span class="op">=</span> <span class="dv">10</span>     <span class="co"># quantum number </span></a>
<a class="sourceLine" id="cb549-17" title="17">hbar <span class="op">=</span> <span class="dv">1</span>      <span class="co"># planck constant</span></a>
<a class="sourceLine" id="cb549-18" title="18"></a>
<a class="sourceLine" id="cb549-19" title="19"><span class="co"># energy</span></a>
<a class="sourceLine" id="cb549-20" title="20">e_n <span class="op">=</span> ((n<span class="op">**</span><span class="dv">2</span>)<span class="op">*</span>(hbar<span class="op">**</span><span class="dv">2</span>)<span class="op">*</span>(np.pi<span class="op">**</span><span class="dv">2</span>))<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>m<span class="op">*</span>L<span class="op">**</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb549-21" title="21"><span class="bu">print</span>(<span class="st">&quot;energy =&quot;</span>, e_n)</a>
<a class="sourceLine" id="cb549-22" title="22"></a>
<a class="sourceLine" id="cb549-23" title="23">e_n_codex <span class="op">=</span> particle_in_box(n,m,L)  </a>
<a class="sourceLine" id="cb549-24" title="24"><span class="bu">print</span>(<span class="st">&quot;energy from codex =&quot;</span>, e_n_codex)</a>
<a class="sourceLine" id="cb549-25" title="25"></a>
<a class="sourceLine" id="cb549-26" title="26"></a>
<a class="sourceLine" id="cb549-27" title="27"><span class="co"># check</span></a>
<a class="sourceLine" id="cb549-28" title="28"><span class="cf">if</span> <span class="bu">abs</span>(e_n <span class="op">-</span> e_n_codex) <span class="op">&lt;=</span> <span class="fl">1e-3</span>:</a>
<a class="sourceLine" id="cb549-29" title="29">    result <span class="op">=</span> <span class="va">True</span> </a>
<a class="sourceLine" id="cb549-30" title="30"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb549-31" title="31">    result <span class="op">=</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb549-32" title="32"></a>
<a class="sourceLine" id="cb549-33" title="33"></a>
<a class="sourceLine" id="cb549-34" title="34"></a>
<a class="sourceLine" id="cb549-35" title="35"></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>pred_interval</summary></p>
<h4 id="query-50">Query</h4>
<div class="sourceCode" id="cb551"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb551-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb551-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb551-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb551-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb551-5" title="5"></a>
<a class="sourceLine" id="cb551-6" title="6"><span class="kw">def</span> num_trials(pred_level):</a>
<a class="sourceLine" id="cb551-7" title="7">   <span class="co">&quot;&quot;&quot;Returns the minimum number of trials needed to achieve</span></a>
<a class="sourceLine" id="cb551-8" title="8"><span class="co">      a probability given by pred_level in a geometric distribution</span></a>
<a class="sourceLine" id="cb551-9" title="9"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb551-10" title="10">   [insert]</a>
<a class="sourceLine" id="cb551-11" title="11">   <span class="cf">return</span> n</a></code></pre></div>
<h4 id="run-0-50">Run 0</h4>
<div class="sourceCode" id="cb552"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb552-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb552-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb552-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb552-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb552-5" title="5"></a>
<a class="sourceLine" id="cb552-6" title="6"><span class="kw">def</span> num_trials(pred_level):</a>
<a class="sourceLine" id="cb552-7" title="7">   <span class="co">&quot;&quot;&quot;Returns the minimum number of trials needed to achieve</span></a>
<a class="sourceLine" id="cb552-8" title="8"><span class="co">      a probability given by pred_level in a geometric distribution</span></a>
<a class="sourceLine" id="cb552-9" title="9"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb552-10" title="10">   n <span class="op">=</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb552-11" title="11">   <span class="cf">while</span> (<span class="dv">1</span><span class="op">-</span>pred_level)<span class="op">**</span>n <span class="op">&gt;</span> pred_level:</a>
<a class="sourceLine" id="cb552-12" title="12">      n <span class="op">+=</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb552-13" title="13">   <span class="cf">return</span> n</a>
<a class="sourceLine" id="cb552-14" title="14"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb552-15" title="15"></a>
<a class="sourceLine" id="cb552-16" title="16">prediction_level <span class="op">=</span> <span class="fl">0.9</span></a>
<a class="sourceLine" id="cb552-17" title="17">samples <span class="op">=</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="dv">100</span>)</a>
<a class="sourceLine" id="cb552-18" title="18">p <span class="op">=</span> <span class="fl">0.1</span></a>
<a class="sourceLine" id="cb552-19" title="19">psum <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb552-20" title="20"><span class="cf">for</span> n <span class="kw">in</span> samples:</a>
<a class="sourceLine" id="cb552-21" title="21">    psum <span class="op">+=</span> (<span class="dv">1</span> <span class="op">-</span> p) <span class="op">**</span> (n <span class="op">-</span> <span class="dv">1</span>) <span class="op">*</span> p</a>
<a class="sourceLine" id="cb552-22" title="22">    <span class="cf">if</span>(psum <span class="op">&gt;=</span> prediction_level):</a>
<a class="sourceLine" id="cb552-23" title="23">        <span class="cf">break</span></a>
<a class="sourceLine" id="cb552-24" title="24"></a>
<a class="sourceLine" id="cb552-25" title="25">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> num_trials(prediction_level) <span class="op">==</span> n <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-50">Run 1</h4>
<div class="sourceCode" id="cb554"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb554-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb554-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb554-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb554-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb554-5" title="5"></a>
<a class="sourceLine" id="cb554-6" title="6"><span class="kw">def</span> num_trials(pred_level):</a>
<a class="sourceLine" id="cb554-7" title="7">   <span class="co">&quot;&quot;&quot;Returns the minimum number of trials needed to achieve</span></a>
<a class="sourceLine" id="cb554-8" title="8"><span class="co">      a probability given by pred_level in a geometric distribution</span></a>
<a class="sourceLine" id="cb554-9" title="9"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb554-10" title="10">   n <span class="op">=</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb554-11" title="11">   <span class="cf">while</span> (<span class="dv">1</span> <span class="op">-</span> (<span class="dv">1</span><span class="op">/</span><span class="dv">2</span>)<span class="op">**</span>n) <span class="op">&lt;</span> pred_level:</a>
<a class="sourceLine" id="cb554-12" title="12">      n <span class="op">+=</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb554-13" title="13">   <span class="cf">return</span> n</a>
<a class="sourceLine" id="cb554-14" title="14"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb554-15" title="15"></a>
<a class="sourceLine" id="cb554-16" title="16">prediction_level <span class="op">=</span> <span class="fl">0.9</span></a>
<a class="sourceLine" id="cb554-17" title="17">samples <span class="op">=</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="dv">100</span>)</a>
<a class="sourceLine" id="cb554-18" title="18">p <span class="op">=</span> <span class="fl">0.1</span></a>
<a class="sourceLine" id="cb554-19" title="19">psum <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb554-20" title="20"><span class="cf">for</span> n <span class="kw">in</span> samples:</a>
<a class="sourceLine" id="cb554-21" title="21">    psum <span class="op">+=</span> (<span class="dv">1</span> <span class="op">-</span> p) <span class="op">**</span> (n <span class="op">-</span> <span class="dv">1</span>) <span class="op">*</span> p</a>
<a class="sourceLine" id="cb554-22" title="22">    <span class="cf">if</span>(psum <span class="op">&gt;=</span> prediction_level):</a>
<a class="sourceLine" id="cb554-23" title="23">        <span class="cf">break</span></a>
<a class="sourceLine" id="cb554-24" title="24"></a>
<a class="sourceLine" id="cb554-25" title="25">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> num_trials(prediction_level) <span class="op">==</span> n <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-50">Run 2</h4>
<div class="sourceCode" id="cb556"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb556-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb556-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb556-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb556-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb556-5" title="5"></a>
<a class="sourceLine" id="cb556-6" title="6"><span class="kw">def</span> num_trials(pred_level):</a>
<a class="sourceLine" id="cb556-7" title="7">   <span class="co">&quot;&quot;&quot;Returns the minimum number of trials needed to achieve</span></a>
<a class="sourceLine" id="cb556-8" title="8"><span class="co">      a probability given by pred_level in a geometric distribution</span></a>
<a class="sourceLine" id="cb556-9" title="9"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb556-10" title="10">   n <span class="op">=</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb556-11" title="11">   <span class="cf">while</span> (<span class="dv">1</span><span class="fl">-0.5</span><span class="op">**</span>n) <span class="op">&lt;</span> pred_level:</a>
<a class="sourceLine" id="cb556-12" title="12">      n <span class="op">+=</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb556-13" title="13">   <span class="cf">return</span> n</a>
<a class="sourceLine" id="cb556-14" title="14"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb556-15" title="15"></a>
<a class="sourceLine" id="cb556-16" title="16">prediction_level <span class="op">=</span> <span class="fl">0.9</span></a>
<a class="sourceLine" id="cb556-17" title="17">samples <span class="op">=</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="dv">100</span>)</a>
<a class="sourceLine" id="cb556-18" title="18">p <span class="op">=</span> <span class="fl">0.1</span></a>
<a class="sourceLine" id="cb556-19" title="19">psum <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb556-20" title="20"><span class="cf">for</span> n <span class="kw">in</span> samples:</a>
<a class="sourceLine" id="cb556-21" title="21">    psum <span class="op">+=</span> (<span class="dv">1</span> <span class="op">-</span> p) <span class="op">**</span> (n <span class="op">-</span> <span class="dv">1</span>) <span class="op">*</span> p</a>
<a class="sourceLine" id="cb556-22" title="22">    <span class="cf">if</span>(psum <span class="op">&gt;=</span> prediction_level):</a>
<a class="sourceLine" id="cb556-23" title="23">        <span class="cf">break</span></a>
<a class="sourceLine" id="cb556-24" title="24"></a>
<a class="sourceLine" id="cb556-25" title="25">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> num_trials(prediction_level) <span class="op">==</span> n <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-50">Run 3</h4>
<div class="sourceCode" id="cb558"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb558-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb558-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb558-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb558-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb558-5" title="5"></a>
<a class="sourceLine" id="cb558-6" title="6"><span class="kw">def</span> num_trials(pred_level):</a>
<a class="sourceLine" id="cb558-7" title="7">   <span class="co">&quot;&quot;&quot;Returns the minimum number of trials needed to achieve</span></a>
<a class="sourceLine" id="cb558-8" title="8"><span class="co">      a probability given by pred_level in a geometric distribution</span></a>
<a class="sourceLine" id="cb558-9" title="9"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb558-10" title="10">   n <span class="op">=</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb558-11" title="11">   <span class="cf">while</span> (<span class="dv">1</span> <span class="op">-</span> (<span class="dv">1</span><span class="op">/</span><span class="dv">2</span>)<span class="op">**</span>n) <span class="op">&lt;</span> pred_level:</a>
<a class="sourceLine" id="cb558-12" title="12">      n <span class="op">+=</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb558-13" title="13">   <span class="cf">return</span> n</a>
<a class="sourceLine" id="cb558-14" title="14"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb558-15" title="15"></a>
<a class="sourceLine" id="cb558-16" title="16">prediction_level <span class="op">=</span> <span class="fl">0.9</span></a>
<a class="sourceLine" id="cb558-17" title="17">samples <span class="op">=</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="dv">100</span>)</a>
<a class="sourceLine" id="cb558-18" title="18">p <span class="op">=</span> <span class="fl">0.1</span></a>
<a class="sourceLine" id="cb558-19" title="19">psum <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb558-20" title="20"><span class="cf">for</span> n <span class="kw">in</span> samples:</a>
<a class="sourceLine" id="cb558-21" title="21">    psum <span class="op">+=</span> (<span class="dv">1</span> <span class="op">-</span> p) <span class="op">**</span> (n <span class="op">-</span> <span class="dv">1</span>) <span class="op">*</span> p</a>
<a class="sourceLine" id="cb558-22" title="22">    <span class="cf">if</span>(psum <span class="op">&gt;=</span> prediction_level):</a>
<a class="sourceLine" id="cb558-23" title="23">        <span class="cf">break</span></a>
<a class="sourceLine" id="cb558-24" title="24"></a>
<a class="sourceLine" id="cb558-25" title="25">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> num_trials(prediction_level) <span class="op">==</span> n <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-50">Run 4</h4>
<div class="sourceCode" id="cb560"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb560-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb560-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb560-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb560-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb560-5" title="5"></a>
<a class="sourceLine" id="cb560-6" title="6"><span class="kw">def</span> num_trials(pred_level):</a>
<a class="sourceLine" id="cb560-7" title="7">   <span class="co">&quot;&quot;&quot;Returns the minimum number of trials needed to achieve</span></a>
<a class="sourceLine" id="cb560-8" title="8"><span class="co">      a probability given by pred_level in a geometric distribution</span></a>
<a class="sourceLine" id="cb560-9" title="9"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb560-10" title="10">   n <span class="op">=</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb560-11" title="11">   <span class="cf">while</span> (<span class="dv">1</span><span class="op">-</span>pred_level)<span class="op">**</span>n <span class="op">&gt;</span> pred_level:</a>
<a class="sourceLine" id="cb560-12" title="12">      n <span class="op">+=</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb560-13" title="13">   <span class="cf">return</span> n</a>
<a class="sourceLine" id="cb560-14" title="14"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb560-15" title="15"></a>
<a class="sourceLine" id="cb560-16" title="16">prediction_level <span class="op">=</span> <span class="fl">0.9</span></a>
<a class="sourceLine" id="cb560-17" title="17">samples <span class="op">=</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="dv">100</span>)</a>
<a class="sourceLine" id="cb560-18" title="18">p <span class="op">=</span> <span class="fl">0.1</span></a>
<a class="sourceLine" id="cb560-19" title="19">psum <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb560-20" title="20"><span class="cf">for</span> n <span class="kw">in</span> samples:</a>
<a class="sourceLine" id="cb560-21" title="21">    psum <span class="op">+=</span> (<span class="dv">1</span> <span class="op">-</span> p) <span class="op">**</span> (n <span class="op">-</span> <span class="dv">1</span>) <span class="op">*</span> p</a>
<a class="sourceLine" id="cb560-22" title="22">    <span class="cf">if</span>(psum <span class="op">&gt;=</span> prediction_level):</a>
<a class="sourceLine" id="cb560-23" title="23">        <span class="cf">break</span></a>
<a class="sourceLine" id="cb560-24" title="24"></a>
<a class="sourceLine" id="cb560-25" title="25">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> num_trials(prediction_level) <span class="op">==</span> n <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>pubchem</summary></p>
<h4 id="query-51">Query</h4>
<div class="sourceCode" id="cb562"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb562-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb562-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb562-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb562-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb562-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb562-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb562-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb562-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb562-9" title="9"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb562-10" title="10"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb562-11" title="11"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb562-12" title="12"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb562-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb562-14" title="14"></a>
<a class="sourceLine" id="cb562-15" title="15"><span class="im">import</span> requests</a>
<a class="sourceLine" id="cb562-16" title="16"></a>
<a class="sourceLine" id="cb562-17" title="17"><span class="kw">def</span> find_similar(smiles):</a>
<a class="sourceLine" id="cb562-18" title="18">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb562-19" title="19"><span class="co">  Returns a set of molecules with greater than 80% similarity using the PubChem REST API.</span></a>
<a class="sourceLine" id="cb562-20" title="20"><span class="co">  The returned molecules are SMILES strings, not CIDs.</span></a>
<a class="sourceLine" id="cb562-21" title="21"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb562-22" title="22">  [insert]</a>
<a class="sourceLine" id="cb562-23" title="23">  <span class="cf">return</span> mols</a></code></pre></div>
<h4 id="run-0-51">Run 0</h4>
<div class="sourceCode" id="cb563"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb563-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb563-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb563-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb563-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb563-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb563-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb563-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb563-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb563-9" title="9"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb563-10" title="10"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb563-11" title="11"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb563-12" title="12"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb563-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb563-14" title="14"></a>
<a class="sourceLine" id="cb563-15" title="15"><span class="im">import</span> requests</a>
<a class="sourceLine" id="cb563-16" title="16"></a>
<a class="sourceLine" id="cb563-17" title="17"><span class="kw">def</span> find_similar(smiles):</a>
<a class="sourceLine" id="cb563-18" title="18">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb563-19" title="19"><span class="co">  Returns a set of molecules with greater than 80% similarity using the PubChem REST API.</span></a>
<a class="sourceLine" id="cb563-20" title="20"><span class="co">  The returned molecules are SMILES strings, not CIDs.</span></a>
<a class="sourceLine" id="cb563-21" title="21"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb563-22" title="22">  url <span class="op">=</span> <span class="st">&quot;https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/smiles/similarity/&quot;</span></a>
<a class="sourceLine" id="cb563-23" title="23">  url <span class="op">+=</span> smiles</a>
<a class="sourceLine" id="cb563-24" title="24">  url <span class="op">+=</span> <span class="st">&quot;/cids/TXT?Threshold=80&quot;</span></a>
<a class="sourceLine" id="cb563-25" title="25">  response <span class="op">=</span> requests.get(url)</a>
<a class="sourceLine" id="cb563-26" title="26">  cids <span class="op">=</span> response.text.split()</a>
<a class="sourceLine" id="cb563-27" title="27">  mols <span class="op">=</span> []</a>
<a class="sourceLine" id="cb563-28" title="28">  <span class="cf">for</span> cid <span class="kw">in</span> cids:</a>
<a class="sourceLine" id="cb563-29" title="29">    url <span class="op">=</span> <span class="st">&quot;https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/cid/&quot;</span></a>
<a class="sourceLine" id="cb563-30" title="30">    url <span class="op">+=</span> cid</a>
<a class="sourceLine" id="cb563-31" title="31">    url <span class="op">+=</span> <span class="st">&quot;/property/CanonicalSMILES/TXT&quot;</span></a>
<a class="sourceLine" id="cb563-32" title="32">    response <span class="op">=</span> requests.get(url)</a>
<a class="sourceLine" id="cb563-33" title="33">    mols.append(response.text)</a>
<a class="sourceLine" id="cb563-34" title="34">  <span class="cf">return</span> mols</a>
<a class="sourceLine" id="cb563-35" title="35"><span class="im">import</span> requests</a>
<a class="sourceLine" id="cb563-36" title="36"><span class="im">import</span> time</a>
<a class="sourceLine" id="cb563-37" title="37"></a>
<a class="sourceLine" id="cb563-38" title="38">time.sleep(<span class="fl">0.5</span>)</a>
<a class="sourceLine" id="cb563-39" title="39"></a>
<a class="sourceLine" id="cb563-40" title="40"></a>
<a class="sourceLine" id="cb563-41" title="41"><span class="kw">def</span> ref_find_similar(s):</a>
<a class="sourceLine" id="cb563-42" title="42">    url <span class="op">=</span> <span class="ss">f&quot;https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/fastsimilarity_2d/smiles/</span><span class="sc">{s}</span><span class="ss">/property/CanonicalSMILES/JSON&quot;</span></a>
<a class="sourceLine" id="cb563-43" title="43">    reply <span class="op">=</span> requests.get(</a>
<a class="sourceLine" id="cb563-44" title="44">        url,</a>
<a class="sourceLine" id="cb563-45" title="45">        params<span class="op">=</span>{<span class="st">&quot;Threshold&quot;</span>: <span class="dv">80</span>, <span class="st">&quot;MaxRecords&quot;</span>: <span class="dv">100</span>},</a>
<a class="sourceLine" id="cb563-46" title="46">        headers<span class="op">=</span>{<span class="st">&quot;accept&quot;</span>: <span class="st">&quot;text/json&quot;</span>},</a>
<a class="sourceLine" id="cb563-47" title="47">        timeout<span class="op">=</span><span class="dv">10</span>,</a>
<a class="sourceLine" id="cb563-48" title="48">    )</a>
<a class="sourceLine" id="cb563-49" title="49">    data <span class="op">=</span> reply.json()</a>
<a class="sourceLine" id="cb563-50" title="50">    smiles <span class="op">=</span> [d[<span class="st">&quot;CanonicalSMILES&quot;</span>]</a>
<a class="sourceLine" id="cb563-51" title="51">              <span class="cf">for</span> d <span class="kw">in</span> data[<span class="st">&quot;PropertyTable&quot;</span>][<span class="st">&quot;Properties&quot;</span>]]</a>
<a class="sourceLine" id="cb563-52" title="52">    smiles <span class="op">=</span> <span class="bu">set</span>(smiles)</a>
<a class="sourceLine" id="cb563-53" title="53">    <span class="cf">return</span> smiles</a>
<a class="sourceLine" id="cb563-54" title="54"></a>
<a class="sourceLine" id="cb563-55" title="55"></a>
<a class="sourceLine" id="cb563-56" title="56">s <span class="op">=</span> <span class="st">&#39;CC=C=C(C(=O)N)&#39;</span></a>
<a class="sourceLine" id="cb563-57" title="57">ref_sim <span class="op">=</span> ref_find_similar(s)</a>
<a class="sourceLine" id="cb563-58" title="58">sim <span class="op">=</span> find_similar(s)</a>
<a class="sourceLine" id="cb563-59" title="59">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> ref_sim <span class="op">==</span> <span class="bu">set</span>(sim) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>(&#39;Connection aborted.&#39;, TimeoutError(&#39;Timeout&#39;))</code></pre>
<h4 id="run-1-51">Run 1</h4>
<div class="sourceCode" id="cb565"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb565-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb565-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb565-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb565-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb565-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb565-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb565-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb565-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb565-9" title="9"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb565-10" title="10"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb565-11" title="11"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb565-12" title="12"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb565-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb565-14" title="14"></a>
<a class="sourceLine" id="cb565-15" title="15"><span class="im">import</span> requests</a>
<a class="sourceLine" id="cb565-16" title="16"></a>
<a class="sourceLine" id="cb565-17" title="17"><span class="kw">def</span> find_similar(smiles):</a>
<a class="sourceLine" id="cb565-18" title="18">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb565-19" title="19"><span class="co">  Returns a set of molecules with greater than 80% similarity using the PubChem REST API.</span></a>
<a class="sourceLine" id="cb565-20" title="20"><span class="co">  The returned molecules are SMILES strings, not CIDs.</span></a>
<a class="sourceLine" id="cb565-21" title="21"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb565-22" title="22">  url <span class="op">=</span> <span class="st">&#39;https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/smiles/</span><span class="sc">{}</span><span class="st">/cids/TXT?cids_type=similarity&amp;Threshold=80&#39;</span>.<span class="bu">format</span>(smiles)</a>
<a class="sourceLine" id="cb565-23" title="23">  response <span class="op">=</span> requests.get(url)</a>
<a class="sourceLine" id="cb565-24" title="24">  cids <span class="op">=</span> response.text.split(<span class="st">&#39;</span><span class="ch">\n</span><span class="st">&#39;</span>)</a>
<a class="sourceLine" id="cb565-25" title="25">  cids <span class="op">=</span> [cid <span class="cf">for</span> cid <span class="kw">in</span> cids <span class="cf">if</span> cid]</a>
<a class="sourceLine" id="cb565-26" title="26">  cids <span class="op">=</span> <span class="st">&#39;,&#39;</span>.join(cids)</a>
<a class="sourceLine" id="cb565-27" title="27">  url <span class="op">=</span> <span class="st">&#39;https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/cid/</span><span class="sc">{}</span><span class="st">/property/CanonicalSMILES/TXT&#39;</span>.<span class="bu">format</span>(cids)</a>
<a class="sourceLine" id="cb565-28" title="28">  response <span class="op">=</span> requests.get(url)</a>
<a class="sourceLine" id="cb565-29" title="29">  mols <span class="op">=</span> response.text.split(<span class="st">&#39;</span><span class="ch">\n</span><span class="st">&#39;</span>)</a>
<a class="sourceLine" id="cb565-30" title="30">  mols <span class="op">=</span> [mol <span class="cf">for</span> mol <span class="kw">in</span> mols <span class="cf">if</span> mol]</a>
<a class="sourceLine" id="cb565-31" title="31">  <span class="cf">return</span> mols</a>
<a class="sourceLine" id="cb565-32" title="32"><span class="im">import</span> requests</a>
<a class="sourceLine" id="cb565-33" title="33"><span class="im">import</span> time</a>
<a class="sourceLine" id="cb565-34" title="34"></a>
<a class="sourceLine" id="cb565-35" title="35">time.sleep(<span class="fl">0.5</span>)</a>
<a class="sourceLine" id="cb565-36" title="36"></a>
<a class="sourceLine" id="cb565-37" title="37"></a>
<a class="sourceLine" id="cb565-38" title="38"><span class="kw">def</span> ref_find_similar(s):</a>
<a class="sourceLine" id="cb565-39" title="39">    url <span class="op">=</span> <span class="ss">f&quot;https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/fastsimilarity_2d/smiles/</span><span class="sc">{s}</span><span class="ss">/property/CanonicalSMILES/JSON&quot;</span></a>
<a class="sourceLine" id="cb565-40" title="40">    reply <span class="op">=</span> requests.get(</a>
<a class="sourceLine" id="cb565-41" title="41">        url,</a>
<a class="sourceLine" id="cb565-42" title="42">        params<span class="op">=</span>{<span class="st">&quot;Threshold&quot;</span>: <span class="dv">80</span>, <span class="st">&quot;MaxRecords&quot;</span>: <span class="dv">100</span>},</a>
<a class="sourceLine" id="cb565-43" title="43">        headers<span class="op">=</span>{<span class="st">&quot;accept&quot;</span>: <span class="st">&quot;text/json&quot;</span>},</a>
<a class="sourceLine" id="cb565-44" title="44">        timeout<span class="op">=</span><span class="dv">10</span>,</a>
<a class="sourceLine" id="cb565-45" title="45">    )</a>
<a class="sourceLine" id="cb565-46" title="46">    data <span class="op">=</span> reply.json()</a>
<a class="sourceLine" id="cb565-47" title="47">    smiles <span class="op">=</span> [d[<span class="st">&quot;CanonicalSMILES&quot;</span>]</a>
<a class="sourceLine" id="cb565-48" title="48">              <span class="cf">for</span> d <span class="kw">in</span> data[<span class="st">&quot;PropertyTable&quot;</span>][<span class="st">&quot;Properties&quot;</span>]]</a>
<a class="sourceLine" id="cb565-49" title="49">    smiles <span class="op">=</span> <span class="bu">set</span>(smiles)</a>
<a class="sourceLine" id="cb565-50" title="50">    <span class="cf">return</span> smiles</a>
<a class="sourceLine" id="cb565-51" title="51"></a>
<a class="sourceLine" id="cb565-52" title="52"></a>
<a class="sourceLine" id="cb565-53" title="53">s <span class="op">=</span> <span class="st">&#39;CC=C=C(C(=O)N)&#39;</span></a>
<a class="sourceLine" id="cb565-54" title="54">ref_sim <span class="op">=</span> ref_find_similar(s)</a>
<a class="sourceLine" id="cb565-55" title="55">sim <span class="op">=</span> find_similar(s)</a>
<a class="sourceLine" id="cb565-56" title="56">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> ref_sim <span class="op">==</span> <span class="bu">set</span>(sim) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-51">Run 2</h4>
<div class="sourceCode" id="cb567"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb567-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb567-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb567-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb567-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb567-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb567-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb567-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb567-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb567-9" title="9"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb567-10" title="10"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb567-11" title="11"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb567-12" title="12"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb567-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb567-14" title="14"></a>
<a class="sourceLine" id="cb567-15" title="15"><span class="im">import</span> requests</a>
<a class="sourceLine" id="cb567-16" title="16"></a>
<a class="sourceLine" id="cb567-17" title="17"><span class="kw">def</span> find_similar(smiles):</a>
<a class="sourceLine" id="cb567-18" title="18">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb567-19" title="19"><span class="co">  Returns a set of molecules with greater than 80% similarity using the PubChem REST API.</span></a>
<a class="sourceLine" id="cb567-20" title="20"><span class="co">  The returned molecules are SMILES strings, not CIDs.</span></a>
<a class="sourceLine" id="cb567-21" title="21"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb567-22" title="22">  url <span class="op">=</span> <span class="st">&quot;https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/smiles/similarity/smiles/</span><span class="sc">{}</span><span class="st">/cids/TXT?Threshold=80&quot;</span>.<span class="bu">format</span>(smiles)</a>
<a class="sourceLine" id="cb567-23" title="23">  response <span class="op">=</span> requests.get(url)</a>
<a class="sourceLine" id="cb567-24" title="24">  cids <span class="op">=</span> response.text.split()</a>
<a class="sourceLine" id="cb567-25" title="25">  mols <span class="op">=</span> <span class="bu">set</span>()</a>
<a class="sourceLine" id="cb567-26" title="26">  <span class="cf">for</span> cid <span class="kw">in</span> cids:</a>
<a class="sourceLine" id="cb567-27" title="27">    url <span class="op">=</span> <span class="st">&quot;https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/cid/</span><span class="sc">{}</span><span class="st">/property/CanonicalSMILES/TXT&quot;</span>.<span class="bu">format</span>(cid)</a>
<a class="sourceLine" id="cb567-28" title="28">    response <span class="op">=</span> requests.get(url)</a>
<a class="sourceLine" id="cb567-29" title="29">    mols.add(response.text)</a>
<a class="sourceLine" id="cb567-30" title="30">  <span class="cf">return</span> mols</a>
<a class="sourceLine" id="cb567-31" title="31"><span class="im">import</span> requests</a>
<a class="sourceLine" id="cb567-32" title="32"><span class="im">import</span> time</a>
<a class="sourceLine" id="cb567-33" title="33"></a>
<a class="sourceLine" id="cb567-34" title="34">time.sleep(<span class="fl">0.5</span>)</a>
<a class="sourceLine" id="cb567-35" title="35"></a>
<a class="sourceLine" id="cb567-36" title="36"></a>
<a class="sourceLine" id="cb567-37" title="37"><span class="kw">def</span> ref_find_similar(s):</a>
<a class="sourceLine" id="cb567-38" title="38">    url <span class="op">=</span> <span class="ss">f&quot;https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/fastsimilarity_2d/smiles/</span><span class="sc">{s}</span><span class="ss">/property/CanonicalSMILES/JSON&quot;</span></a>
<a class="sourceLine" id="cb567-39" title="39">    reply <span class="op">=</span> requests.get(</a>
<a class="sourceLine" id="cb567-40" title="40">        url,</a>
<a class="sourceLine" id="cb567-41" title="41">        params<span class="op">=</span>{<span class="st">&quot;Threshold&quot;</span>: <span class="dv">80</span>, <span class="st">&quot;MaxRecords&quot;</span>: <span class="dv">100</span>},</a>
<a class="sourceLine" id="cb567-42" title="42">        headers<span class="op">=</span>{<span class="st">&quot;accept&quot;</span>: <span class="st">&quot;text/json&quot;</span>},</a>
<a class="sourceLine" id="cb567-43" title="43">        timeout<span class="op">=</span><span class="dv">10</span>,</a>
<a class="sourceLine" id="cb567-44" title="44">    )</a>
<a class="sourceLine" id="cb567-45" title="45">    data <span class="op">=</span> reply.json()</a>
<a class="sourceLine" id="cb567-46" title="46">    smiles <span class="op">=</span> [d[<span class="st">&quot;CanonicalSMILES&quot;</span>]</a>
<a class="sourceLine" id="cb567-47" title="47">              <span class="cf">for</span> d <span class="kw">in</span> data[<span class="st">&quot;PropertyTable&quot;</span>][<span class="st">&quot;Properties&quot;</span>]]</a>
<a class="sourceLine" id="cb567-48" title="48">    smiles <span class="op">=</span> <span class="bu">set</span>(smiles)</a>
<a class="sourceLine" id="cb567-49" title="49">    <span class="cf">return</span> smiles</a>
<a class="sourceLine" id="cb567-50" title="50"></a>
<a class="sourceLine" id="cb567-51" title="51"></a>
<a class="sourceLine" id="cb567-52" title="52">s <span class="op">=</span> <span class="st">&#39;CC=C=C(C(=O)N)&#39;</span></a>
<a class="sourceLine" id="cb567-53" title="53">ref_sim <span class="op">=</span> ref_find_similar(s)</a>
<a class="sourceLine" id="cb567-54" title="54">sim <span class="op">=</span> find_similar(s)</a>
<a class="sourceLine" id="cb567-55" title="55">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> ref_sim <span class="op">==</span> <span class="bu">set</span>(sim) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>(&#39;Connection aborted.&#39;, TimeoutError(&#39;Timeout&#39;))</code></pre>
<h4 id="run-3-51">Run 3</h4>
<div class="sourceCode" id="cb569"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb569-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb569-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb569-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb569-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb569-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb569-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb569-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb569-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb569-9" title="9"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb569-10" title="10"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb569-11" title="11"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb569-12" title="12"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb569-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb569-14" title="14"></a>
<a class="sourceLine" id="cb569-15" title="15"><span class="im">import</span> requests</a>
<a class="sourceLine" id="cb569-16" title="16"></a>
<a class="sourceLine" id="cb569-17" title="17"><span class="kw">def</span> find_similar(smiles):</a>
<a class="sourceLine" id="cb569-18" title="18">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb569-19" title="19"><span class="co">  Returns a set of molecules with greater than 80% similarity using the PubChem REST API.</span></a>
<a class="sourceLine" id="cb569-20" title="20"><span class="co">  The returned molecules are SMILES strings, not CIDs.</span></a>
<a class="sourceLine" id="cb569-21" title="21"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb569-22" title="22">  url <span class="op">=</span> <span class="st">&#39;https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/smiles/similarity/smiles/&#39;</span> <span class="op">+</span> smiles <span class="op">+</span> <span class="st">&#39;/cids/TXT?Threshold=80&#39;</span></a>
<a class="sourceLine" id="cb569-23" title="23">  r <span class="op">=</span> requests.get(url)</a>
<a class="sourceLine" id="cb569-24" title="24">  cids <span class="op">=</span> r.text.split(<span class="st">&#39;</span><span class="ch">\n</span><span class="st">&#39;</span>)</a>
<a class="sourceLine" id="cb569-25" title="25">  cids <span class="op">=</span> [cid <span class="cf">for</span> cid <span class="kw">in</span> cids <span class="cf">if</span> cid <span class="op">!=</span> <span class="st">&#39;&#39;</span>]</a>
<a class="sourceLine" id="cb569-26" title="26">  mols <span class="op">=</span> []</a>
<a class="sourceLine" id="cb569-27" title="27">  <span class="cf">for</span> cid <span class="kw">in</span> cids:</a>
<a class="sourceLine" id="cb569-28" title="28">    url <span class="op">=</span> <span class="st">&#39;https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/cid/&#39;</span> <span class="op">+</span> cid <span class="op">+</span> <span class="st">&#39;/property/CanonicalSMILES/TXT&#39;</span></a>
<a class="sourceLine" id="cb569-29" title="29">    r <span class="op">=</span> requests.get(url)</a>
<a class="sourceLine" id="cb569-30" title="30">    mols.append(r.text)</a>
<a class="sourceLine" id="cb569-31" title="31">  <span class="cf">return</span> mols</a>
<a class="sourceLine" id="cb569-32" title="32"><span class="im">import</span> requests</a>
<a class="sourceLine" id="cb569-33" title="33"><span class="im">import</span> time</a>
<a class="sourceLine" id="cb569-34" title="34"></a>
<a class="sourceLine" id="cb569-35" title="35">time.sleep(<span class="fl">0.5</span>)</a>
<a class="sourceLine" id="cb569-36" title="36"></a>
<a class="sourceLine" id="cb569-37" title="37"></a>
<a class="sourceLine" id="cb569-38" title="38"><span class="kw">def</span> ref_find_similar(s):</a>
<a class="sourceLine" id="cb569-39" title="39">    url <span class="op">=</span> <span class="ss">f&quot;https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/fastsimilarity_2d/smiles/</span><span class="sc">{s}</span><span class="ss">/property/CanonicalSMILES/JSON&quot;</span></a>
<a class="sourceLine" id="cb569-40" title="40">    reply <span class="op">=</span> requests.get(</a>
<a class="sourceLine" id="cb569-41" title="41">        url,</a>
<a class="sourceLine" id="cb569-42" title="42">        params<span class="op">=</span>{<span class="st">&quot;Threshold&quot;</span>: <span class="dv">80</span>, <span class="st">&quot;MaxRecords&quot;</span>: <span class="dv">100</span>},</a>
<a class="sourceLine" id="cb569-43" title="43">        headers<span class="op">=</span>{<span class="st">&quot;accept&quot;</span>: <span class="st">&quot;text/json&quot;</span>},</a>
<a class="sourceLine" id="cb569-44" title="44">        timeout<span class="op">=</span><span class="dv">10</span>,</a>
<a class="sourceLine" id="cb569-45" title="45">    )</a>
<a class="sourceLine" id="cb569-46" title="46">    data <span class="op">=</span> reply.json()</a>
<a class="sourceLine" id="cb569-47" title="47">    smiles <span class="op">=</span> [d[<span class="st">&quot;CanonicalSMILES&quot;</span>]</a>
<a class="sourceLine" id="cb569-48" title="48">              <span class="cf">for</span> d <span class="kw">in</span> data[<span class="st">&quot;PropertyTable&quot;</span>][<span class="st">&quot;Properties&quot;</span>]]</a>
<a class="sourceLine" id="cb569-49" title="49">    smiles <span class="op">=</span> <span class="bu">set</span>(smiles)</a>
<a class="sourceLine" id="cb569-50" title="50">    <span class="cf">return</span> smiles</a>
<a class="sourceLine" id="cb569-51" title="51"></a>
<a class="sourceLine" id="cb569-52" title="52"></a>
<a class="sourceLine" id="cb569-53" title="53">s <span class="op">=</span> <span class="st">&#39;CC=C=C(C(=O)N)&#39;</span></a>
<a class="sourceLine" id="cb569-54" title="54">ref_sim <span class="op">=</span> ref_find_similar(s)</a>
<a class="sourceLine" id="cb569-55" title="55">sim <span class="op">=</span> find_similar(s)</a>
<a class="sourceLine" id="cb569-56" title="56">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> ref_sim <span class="op">==</span> <span class="bu">set</span>(sim) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-51">Run 4</h4>
<div class="sourceCode" id="cb571"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb571-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb571-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb571-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb571-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb571-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb571-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb571-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb571-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb571-9" title="9"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb571-10" title="10"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb571-11" title="11"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb571-12" title="12"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb571-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb571-14" title="14"></a>
<a class="sourceLine" id="cb571-15" title="15"><span class="im">import</span> requests</a>
<a class="sourceLine" id="cb571-16" title="16"></a>
<a class="sourceLine" id="cb571-17" title="17"><span class="kw">def</span> find_similar(smiles):</a>
<a class="sourceLine" id="cb571-18" title="18">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb571-19" title="19"><span class="co">  Returns a set of molecules with greater than 80% similarity using the PubChem REST API.</span></a>
<a class="sourceLine" id="cb571-20" title="20"><span class="co">  The returned molecules are SMILES strings, not CIDs.</span></a>
<a class="sourceLine" id="cb571-21" title="21"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb571-22" title="22">  url <span class="op">=</span> <span class="st">&#39;https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/smiles/</span><span class="sc">%s</span><span class="st">/cids/TXT&#39;</span> <span class="op">%</span> smiles</a>
<a class="sourceLine" id="cb571-23" title="23">  response <span class="op">=</span> requests.get(url)</a>
<a class="sourceLine" id="cb571-24" title="24">  cids <span class="op">=</span> response.text.split()</a>
<a class="sourceLine" id="cb571-25" title="25">  cids <span class="op">=</span> cids[:<span class="dv">10</span>]</a>
<a class="sourceLine" id="cb571-26" title="26">  cids <span class="op">=</span> <span class="st">&#39;,&#39;</span>.join(cids)</a>
<a class="sourceLine" id="cb571-27" title="27">  url <span class="op">=</span> <span class="st">&#39;https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/cid/</span><span class="sc">%s</span><span class="st">/property/CanonicalSMILES/TXT&#39;</span> <span class="op">%</span> cids</a>
<a class="sourceLine" id="cb571-28" title="28">  response <span class="op">=</span> requests.get(url)</a>
<a class="sourceLine" id="cb571-29" title="29">  mols <span class="op">=</span> response.text.split()</a>
<a class="sourceLine" id="cb571-30" title="30">  mols <span class="op">=</span> mols[:<span class="dv">10</span>]</a>
<a class="sourceLine" id="cb571-31" title="31">  <span class="cf">return</span> mols</a>
<a class="sourceLine" id="cb571-32" title="32"><span class="im">import</span> requests</a>
<a class="sourceLine" id="cb571-33" title="33"><span class="im">import</span> time</a>
<a class="sourceLine" id="cb571-34" title="34"></a>
<a class="sourceLine" id="cb571-35" title="35">time.sleep(<span class="fl">0.5</span>)</a>
<a class="sourceLine" id="cb571-36" title="36"></a>
<a class="sourceLine" id="cb571-37" title="37"></a>
<a class="sourceLine" id="cb571-38" title="38"><span class="kw">def</span> ref_find_similar(s):</a>
<a class="sourceLine" id="cb571-39" title="39">    url <span class="op">=</span> <span class="ss">f&quot;https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/fastsimilarity_2d/smiles/</span><span class="sc">{s}</span><span class="ss">/property/CanonicalSMILES/JSON&quot;</span></a>
<a class="sourceLine" id="cb571-40" title="40">    reply <span class="op">=</span> requests.get(</a>
<a class="sourceLine" id="cb571-41" title="41">        url,</a>
<a class="sourceLine" id="cb571-42" title="42">        params<span class="op">=</span>{<span class="st">&quot;Threshold&quot;</span>: <span class="dv">80</span>, <span class="st">&quot;MaxRecords&quot;</span>: <span class="dv">100</span>},</a>
<a class="sourceLine" id="cb571-43" title="43">        headers<span class="op">=</span>{<span class="st">&quot;accept&quot;</span>: <span class="st">&quot;text/json&quot;</span>},</a>
<a class="sourceLine" id="cb571-44" title="44">        timeout<span class="op">=</span><span class="dv">10</span>,</a>
<a class="sourceLine" id="cb571-45" title="45">    )</a>
<a class="sourceLine" id="cb571-46" title="46">    data <span class="op">=</span> reply.json()</a>
<a class="sourceLine" id="cb571-47" title="47">    smiles <span class="op">=</span> [d[<span class="st">&quot;CanonicalSMILES&quot;</span>]</a>
<a class="sourceLine" id="cb571-48" title="48">              <span class="cf">for</span> d <span class="kw">in</span> data[<span class="st">&quot;PropertyTable&quot;</span>][<span class="st">&quot;Properties&quot;</span>]]</a>
<a class="sourceLine" id="cb571-49" title="49">    smiles <span class="op">=</span> <span class="bu">set</span>(smiles)</a>
<a class="sourceLine" id="cb571-50" title="50">    <span class="cf">return</span> smiles</a>
<a class="sourceLine" id="cb571-51" title="51"></a>
<a class="sourceLine" id="cb571-52" title="52"></a>
<a class="sourceLine" id="cb571-53" title="53">s <span class="op">=</span> <span class="st">&#39;CC=C=C(C(=O)N)&#39;</span></a>
<a class="sourceLine" id="cb571-54" title="54">ref_sim <span class="op">=</span> ref_find_similar(s)</a>
<a class="sourceLine" id="cb571-55" title="55">sim <span class="op">=</span> find_similar(s)</a>
<a class="sourceLine" id="cb571-56" title="56">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> ref_sim <span class="op">==</span> <span class="bu">set</span>(sim) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>pyscf_energy</summary></p>
<h4 id="query-52">Query</h4>
<div class="sourceCode" id="cb573"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb573-1" title="1"><span class="im">import</span> pyscf</a>
<a class="sourceLine" id="cb573-2" title="2"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb573-3" title="3"></a>
<a class="sourceLine" id="cb573-4" title="4"><span class="kw">def</span> calc_molecule_energy(atom,basis):</a>
<a class="sourceLine" id="cb573-5" title="5">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb573-6" title="6"><span class="co">    This function returns the ground state energy for atom using restricted Hartree-Fock in the given basis</span></a>
<a class="sourceLine" id="cb573-7" title="7"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb573-8" title="8">    [insert]</a>
<a class="sourceLine" id="cb573-9" title="9">    <span class="cf">return</span> ground_energy</a></code></pre></div>
<h4 id="run-0-52">Run 0</h4>
<div class="sourceCode" id="cb574"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb574-1" title="1"><span class="im">import</span> pyscf</a>
<a class="sourceLine" id="cb574-2" title="2"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb574-3" title="3"></a>
<a class="sourceLine" id="cb574-4" title="4"><span class="kw">def</span> calc_molecule_energy(atom,basis):</a>
<a class="sourceLine" id="cb574-5" title="5">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb574-6" title="6"><span class="co">    This function returns the ground state energy for atom using restricted Hartree-Fock in the given basis</span></a>
<a class="sourceLine" id="cb574-7" title="7"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb574-8" title="8">    mol <span class="op">=</span> pyscf.gto.M(atom<span class="op">=</span>atom,basis<span class="op">=</span>basis)</a>
<a class="sourceLine" id="cb574-9" title="9">    mf <span class="op">=</span> pyscf.scf.RHF(mol)</a>
<a class="sourceLine" id="cb574-10" title="10">    mf.scf()</a>
<a class="sourceLine" id="cb574-11" title="11">    ground_energy <span class="op">=</span> mf.e_tot</a>
<a class="sourceLine" id="cb574-12" title="12"></a>
<a class="sourceLine" id="cb574-13" title="13">    <span class="cf">return</span> ground_energy</a>
<a class="sourceLine" id="cb574-14" title="14">atom_coordinates <span class="op">=</span> <span class="st">&quot;H 0 0 0; F 0 0 1&quot;</span></a>
<a class="sourceLine" id="cb574-15" title="15">basis <span class="op">=</span> <span class="st">&quot;sto-3g&quot;</span></a>
<a class="sourceLine" id="cb574-16" title="16"></a>
<a class="sourceLine" id="cb574-17" title="17"><span class="co">#so that it doesn&#39;t fail b/c not importing these in prompt:</span></a>
<a class="sourceLine" id="cb574-18" title="18"><span class="im">from</span> pyscf <span class="im">import</span> gto, scf</a>
<a class="sourceLine" id="cb574-19" title="19"></a>
<a class="sourceLine" id="cb574-20" title="20"><span class="kw">def</span> calc_molecule_energy_test(atom_coordinates,basis):</a>
<a class="sourceLine" id="cb574-21" title="21">    mol <span class="op">=</span> gto.M(atom<span class="op">=</span>atom_coordinates,basis<span class="op">=</span>basis)</a>
<a class="sourceLine" id="cb574-22" title="22">    mf <span class="op">=</span> scf.RHF(mol)</a>
<a class="sourceLine" id="cb574-23" title="23">    <span class="cf">return</span> mf.kernel()</a>
<a class="sourceLine" id="cb574-24" title="24"></a>
<a class="sourceLine" id="cb574-25" title="25">my_energy <span class="op">=</span> calc_molecule_energy_test(atom_coordinates,basis)</a>
<a class="sourceLine" id="cb574-26" title="26">nlcc_energy <span class="op">=</span> calc_molecule_energy(atom_coordinates,basis)</a>
<a class="sourceLine" id="cb574-27" title="27"></a>
<a class="sourceLine" id="cb574-28" title="28"><span class="bu">print</span>(<span class="st">&quot;My result:&quot;</span>, my_energy)</a>
<a class="sourceLine" id="cb574-29" title="29"><span class="bu">print</span>(<span class="st">&quot;nlcc result:&quot;</span>, nlcc_energy)</a>
<a class="sourceLine" id="cb574-30" title="30"></a>
<a class="sourceLine" id="cb574-31" title="31">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">abs</span>( my_energy <span class="op">-</span> nlcc_energy )<span class="op">&lt;</span><span class="fl">0.1</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>&#39;NoneType&#39; object has no attribute &#39;write&#39;</code></pre>
<h4 id="run-1-52">Run 1</h4>
<div class="sourceCode" id="cb576"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb576-1" title="1"><span class="im">import</span> pyscf</a>
<a class="sourceLine" id="cb576-2" title="2"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb576-3" title="3"></a>
<a class="sourceLine" id="cb576-4" title="4"><span class="kw">def</span> calc_molecule_energy(atom,basis):</a>
<a class="sourceLine" id="cb576-5" title="5">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb576-6" title="6"><span class="co">    This function returns the ground state energy for atom using restricted Hartree-Fock in the given basis</span></a>
<a class="sourceLine" id="cb576-7" title="7"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb576-8" title="8">    mol <span class="op">=</span> pyscf.gto.M(atom<span class="op">=</span>atom,basis<span class="op">=</span>basis)</a>
<a class="sourceLine" id="cb576-9" title="9">    mf <span class="op">=</span> pyscf.scf.RHF(mol)</a>
<a class="sourceLine" id="cb576-10" title="10">    mf.kernel()</a>
<a class="sourceLine" id="cb576-11" title="11">    ground_energy <span class="op">=</span> mf.e_tot</a>
<a class="sourceLine" id="cb576-12" title="12">    <span class="bu">print</span>(ground_energy)</a>
<a class="sourceLine" id="cb576-13" title="13">    <span class="cf">return</span> ground_energy</a>
<a class="sourceLine" id="cb576-14" title="14">atom_coordinates <span class="op">=</span> <span class="st">&quot;H 0 0 0; F 0 0 1&quot;</span></a>
<a class="sourceLine" id="cb576-15" title="15">basis <span class="op">=</span> <span class="st">&quot;sto-3g&quot;</span></a>
<a class="sourceLine" id="cb576-16" title="16"></a>
<a class="sourceLine" id="cb576-17" title="17"><span class="co">#so that it doesn&#39;t fail b/c not importing these in prompt:</span></a>
<a class="sourceLine" id="cb576-18" title="18"><span class="im">from</span> pyscf <span class="im">import</span> gto, scf</a>
<a class="sourceLine" id="cb576-19" title="19"></a>
<a class="sourceLine" id="cb576-20" title="20"><span class="kw">def</span> calc_molecule_energy_test(atom_coordinates,basis):</a>
<a class="sourceLine" id="cb576-21" title="21">    mol <span class="op">=</span> gto.M(atom<span class="op">=</span>atom_coordinates,basis<span class="op">=</span>basis)</a>
<a class="sourceLine" id="cb576-22" title="22">    mf <span class="op">=</span> scf.RHF(mol)</a>
<a class="sourceLine" id="cb576-23" title="23">    <span class="cf">return</span> mf.kernel()</a>
<a class="sourceLine" id="cb576-24" title="24"></a>
<a class="sourceLine" id="cb576-25" title="25">my_energy <span class="op">=</span> calc_molecule_energy_test(atom_coordinates,basis)</a>
<a class="sourceLine" id="cb576-26" title="26">nlcc_energy <span class="op">=</span> calc_molecule_energy(atom_coordinates,basis)</a>
<a class="sourceLine" id="cb576-27" title="27"></a>
<a class="sourceLine" id="cb576-28" title="28"><span class="bu">print</span>(<span class="st">&quot;My result:&quot;</span>, my_energy)</a>
<a class="sourceLine" id="cb576-29" title="29"><span class="bu">print</span>(<span class="st">&quot;nlcc result:&quot;</span>, nlcc_energy)</a>
<a class="sourceLine" id="cb576-30" title="30"></a>
<a class="sourceLine" id="cb576-31" title="31">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">abs</span>( my_energy <span class="op">-</span> nlcc_energy )<span class="op">&lt;</span><span class="fl">0.1</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>&#39;NoneType&#39; object has no attribute &#39;write&#39;</code></pre>
<h4 id="run-2-52">Run 2</h4>
<div class="sourceCode" id="cb578"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb578-1" title="1"><span class="im">import</span> pyscf</a>
<a class="sourceLine" id="cb578-2" title="2"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb578-3" title="3"></a>
<a class="sourceLine" id="cb578-4" title="4"><span class="kw">def</span> calc_molecule_energy(atom,basis):</a>
<a class="sourceLine" id="cb578-5" title="5">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb578-6" title="6"><span class="co">    This function returns the ground state energy for atom using restricted Hartree-Fock in the given basis</span></a>
<a class="sourceLine" id="cb578-7" title="7"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb578-8" title="8">    mol <span class="op">=</span> pyscf.gto.M(atom<span class="op">=</span>atom, basis<span class="op">=</span>basis)</a>
<a class="sourceLine" id="cb578-9" title="9">    mf <span class="op">=</span> pyscf.scf.RHF(mol)</a>
<a class="sourceLine" id="cb578-10" title="10">    mf.kernel()</a>
<a class="sourceLine" id="cb578-11" title="11">    ground_energy <span class="op">=</span> mf.e_tot</a>
<a class="sourceLine" id="cb578-12" title="12">    <span class="bu">print</span>(ground_energy)</a>
<a class="sourceLine" id="cb578-13" title="13">    <span class="cf">return</span> ground_energy</a>
<a class="sourceLine" id="cb578-14" title="14">atom_coordinates <span class="op">=</span> <span class="st">&quot;H 0 0 0; F 0 0 1&quot;</span></a>
<a class="sourceLine" id="cb578-15" title="15">basis <span class="op">=</span> <span class="st">&quot;sto-3g&quot;</span></a>
<a class="sourceLine" id="cb578-16" title="16"></a>
<a class="sourceLine" id="cb578-17" title="17"><span class="co">#so that it doesn&#39;t fail b/c not importing these in prompt:</span></a>
<a class="sourceLine" id="cb578-18" title="18"><span class="im">from</span> pyscf <span class="im">import</span> gto, scf</a>
<a class="sourceLine" id="cb578-19" title="19"></a>
<a class="sourceLine" id="cb578-20" title="20"><span class="kw">def</span> calc_molecule_energy_test(atom_coordinates,basis):</a>
<a class="sourceLine" id="cb578-21" title="21">    mol <span class="op">=</span> gto.M(atom<span class="op">=</span>atom_coordinates,basis<span class="op">=</span>basis)</a>
<a class="sourceLine" id="cb578-22" title="22">    mf <span class="op">=</span> scf.RHF(mol)</a>
<a class="sourceLine" id="cb578-23" title="23">    <span class="cf">return</span> mf.kernel()</a>
<a class="sourceLine" id="cb578-24" title="24"></a>
<a class="sourceLine" id="cb578-25" title="25">my_energy <span class="op">=</span> calc_molecule_energy_test(atom_coordinates,basis)</a>
<a class="sourceLine" id="cb578-26" title="26">nlcc_energy <span class="op">=</span> calc_molecule_energy(atom_coordinates,basis)</a>
<a class="sourceLine" id="cb578-27" title="27"></a>
<a class="sourceLine" id="cb578-28" title="28"><span class="bu">print</span>(<span class="st">&quot;My result:&quot;</span>, my_energy)</a>
<a class="sourceLine" id="cb578-29" title="29"><span class="bu">print</span>(<span class="st">&quot;nlcc result:&quot;</span>, nlcc_energy)</a>
<a class="sourceLine" id="cb578-30" title="30"></a>
<a class="sourceLine" id="cb578-31" title="31">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">abs</span>( my_energy <span class="op">-</span> nlcc_energy )<span class="op">&lt;</span><span class="fl">0.1</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>&#39;NoneType&#39; object has no attribute &#39;write&#39;</code></pre>
<h4 id="run-3-52">Run 3</h4>
<div class="sourceCode" id="cb580"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb580-1" title="1"><span class="im">import</span> pyscf</a>
<a class="sourceLine" id="cb580-2" title="2"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb580-3" title="3"></a>
<a class="sourceLine" id="cb580-4" title="4"><span class="kw">def</span> calc_molecule_energy(atom,basis):</a>
<a class="sourceLine" id="cb580-5" title="5">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb580-6" title="6"><span class="co">    This function returns the ground state energy for atom using restricted Hartree-Fock in the given basis</span></a>
<a class="sourceLine" id="cb580-7" title="7"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb580-8" title="8">    mol <span class="op">=</span> pyscf.gto.M(atom<span class="op">=</span>atom,basis<span class="op">=</span>basis)</a>
<a class="sourceLine" id="cb580-9" title="9">    mol.build()</a>
<a class="sourceLine" id="cb580-10" title="10">    mf <span class="op">=</span> pyscf.scf.RHF(mol)</a>
<a class="sourceLine" id="cb580-11" title="11">    mf.scf()</a>
<a class="sourceLine" id="cb580-12" title="12">    ground_energy <span class="op">=</span> mf.e_tot</a>
<a class="sourceLine" id="cb580-13" title="13">    <span class="bu">print</span>(<span class="st">&quot;Ground state energy for </span><span class="sc">{}</span><span class="st"> in </span><span class="sc">{}</span><span class="st"> basis is </span><span class="sc">{}</span><span class="st">&quot;</span>.<span class="bu">format</span>(atom,basis,ground_energy))</a>
<a class="sourceLine" id="cb580-14" title="14">    <span class="cf">return</span> ground_energy</a>
<a class="sourceLine" id="cb580-15" title="15">atom_coordinates <span class="op">=</span> <span class="st">&quot;H 0 0 0; F 0 0 1&quot;</span></a>
<a class="sourceLine" id="cb580-16" title="16">basis <span class="op">=</span> <span class="st">&quot;sto-3g&quot;</span></a>
<a class="sourceLine" id="cb580-17" title="17"></a>
<a class="sourceLine" id="cb580-18" title="18"><span class="co">#so that it doesn&#39;t fail b/c not importing these in prompt:</span></a>
<a class="sourceLine" id="cb580-19" title="19"><span class="im">from</span> pyscf <span class="im">import</span> gto, scf</a>
<a class="sourceLine" id="cb580-20" title="20"></a>
<a class="sourceLine" id="cb580-21" title="21"><span class="kw">def</span> calc_molecule_energy_test(atom_coordinates,basis):</a>
<a class="sourceLine" id="cb580-22" title="22">    mol <span class="op">=</span> gto.M(atom<span class="op">=</span>atom_coordinates,basis<span class="op">=</span>basis)</a>
<a class="sourceLine" id="cb580-23" title="23">    mf <span class="op">=</span> scf.RHF(mol)</a>
<a class="sourceLine" id="cb580-24" title="24">    <span class="cf">return</span> mf.kernel()</a>
<a class="sourceLine" id="cb580-25" title="25"></a>
<a class="sourceLine" id="cb580-26" title="26">my_energy <span class="op">=</span> calc_molecule_energy_test(atom_coordinates,basis)</a>
<a class="sourceLine" id="cb580-27" title="27">nlcc_energy <span class="op">=</span> calc_molecule_energy(atom_coordinates,basis)</a>
<a class="sourceLine" id="cb580-28" title="28"></a>
<a class="sourceLine" id="cb580-29" title="29"><span class="bu">print</span>(<span class="st">&quot;My result:&quot;</span>, my_energy)</a>
<a class="sourceLine" id="cb580-30" title="30"><span class="bu">print</span>(<span class="st">&quot;nlcc result:&quot;</span>, nlcc_energy)</a>
<a class="sourceLine" id="cb580-31" title="31"></a>
<a class="sourceLine" id="cb580-32" title="32">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">abs</span>( my_energy <span class="op">-</span> nlcc_energy )<span class="op">&lt;</span><span class="fl">0.1</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>&#39;NoneType&#39; object has no attribute &#39;write&#39;</code></pre>
<h4 id="run-4-52">Run 4</h4>
<div class="sourceCode" id="cb582"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb582-1" title="1"><span class="im">import</span> pyscf</a>
<a class="sourceLine" id="cb582-2" title="2"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb582-3" title="3"></a>
<a class="sourceLine" id="cb582-4" title="4"><span class="kw">def</span> calc_molecule_energy(atom,basis):</a>
<a class="sourceLine" id="cb582-5" title="5">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb582-6" title="6"><span class="co">    This function returns the ground state energy for atom using restricted Hartree-Fock in the given basis</span></a>
<a class="sourceLine" id="cb582-7" title="7"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb582-8" title="8">    mol <span class="op">=</span> pyscf.gto.M(atom<span class="op">=</span>atom,basis<span class="op">=</span>basis)</a>
<a class="sourceLine" id="cb582-9" title="9">    mf <span class="op">=</span> pyscf.scf.RHF(mol)</a>
<a class="sourceLine" id="cb582-10" title="10">    mf.scf()</a>
<a class="sourceLine" id="cb582-11" title="11">    ground_energy <span class="op">=</span> mf.e_tot</a>
<a class="sourceLine" id="cb582-12" title="12"></a>
<a class="sourceLine" id="cb582-13" title="13">    <span class="cf">return</span> ground_energy</a>
<a class="sourceLine" id="cb582-14" title="14">atom_coordinates <span class="op">=</span> <span class="st">&quot;H 0 0 0; F 0 0 1&quot;</span></a>
<a class="sourceLine" id="cb582-15" title="15">basis <span class="op">=</span> <span class="st">&quot;sto-3g&quot;</span></a>
<a class="sourceLine" id="cb582-16" title="16"></a>
<a class="sourceLine" id="cb582-17" title="17"><span class="co">#so that it doesn&#39;t fail b/c not importing these in prompt:</span></a>
<a class="sourceLine" id="cb582-18" title="18"><span class="im">from</span> pyscf <span class="im">import</span> gto, scf</a>
<a class="sourceLine" id="cb582-19" title="19"></a>
<a class="sourceLine" id="cb582-20" title="20"><span class="kw">def</span> calc_molecule_energy_test(atom_coordinates,basis):</a>
<a class="sourceLine" id="cb582-21" title="21">    mol <span class="op">=</span> gto.M(atom<span class="op">=</span>atom_coordinates,basis<span class="op">=</span>basis)</a>
<a class="sourceLine" id="cb582-22" title="22">    mf <span class="op">=</span> scf.RHF(mol)</a>
<a class="sourceLine" id="cb582-23" title="23">    <span class="cf">return</span> mf.kernel()</a>
<a class="sourceLine" id="cb582-24" title="24"></a>
<a class="sourceLine" id="cb582-25" title="25">my_energy <span class="op">=</span> calc_molecule_energy_test(atom_coordinates,basis)</a>
<a class="sourceLine" id="cb582-26" title="26">nlcc_energy <span class="op">=</span> calc_molecule_energy(atom_coordinates,basis)</a>
<a class="sourceLine" id="cb582-27" title="27"></a>
<a class="sourceLine" id="cb582-28" title="28"><span class="bu">print</span>(<span class="st">&quot;My result:&quot;</span>, my_energy)</a>
<a class="sourceLine" id="cb582-29" title="29"><span class="bu">print</span>(<span class="st">&quot;nlcc result:&quot;</span>, nlcc_energy)</a>
<a class="sourceLine" id="cb582-30" title="30"></a>
<a class="sourceLine" id="cb582-31" title="31">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">abs</span>( my_energy <span class="op">-</span> nlcc_energy )<span class="op">&lt;</span><span class="fl">0.1</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>&#39;NoneType&#39; object has no attribute &#39;write&#39;</code></pre>
</details>
<details>
<p><summary>qed</summary></p>
<h4 id="query-53">Query</h4>
<div class="sourceCode" id="cb584"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb584-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb584-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb584-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb584-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb584-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb584-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb584-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb584-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb584-9" title="9"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb584-10" title="10"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb584-11" title="11"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb584-12" title="12"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb584-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb584-14" title="14"></a>
<a class="sourceLine" id="cb584-15" title="15"><span class="kw">def</span> qed(smiles):</a>
<a class="sourceLine" id="cb584-16" title="16">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb584-17" title="17"><span class="co">    This function takes a SMILES string and returns the quantitative estimation of drug-likeness for the molecule.</span></a>
<a class="sourceLine" id="cb584-18" title="18"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb584-19" title="19">    [insert]</a>
<a class="sourceLine" id="cb584-20" title="20">    <span class="cf">return</span> result</a></code></pre></div>
<h4 id="run-0-53">Run 0</h4>
<div class="sourceCode" id="cb585"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb585-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb585-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb585-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb585-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb585-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb585-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb585-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb585-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb585-9" title="9"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb585-10" title="10"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb585-11" title="11"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb585-12" title="12"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb585-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb585-14" title="14"></a>
<a class="sourceLine" id="cb585-15" title="15"><span class="kw">def</span> qed(smiles):</a>
<a class="sourceLine" id="cb585-16" title="16">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb585-17" title="17"><span class="co">    This function takes a SMILES string and returns the quantitative estimation of drug-likeness for the molecule.</span></a>
<a class="sourceLine" id="cb585-18" title="18"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb585-19" title="19">    mol <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb585-20" title="20">    result <span class="op">=</span> Crippen.MolLogP(mol)</a>
<a class="sourceLine" id="cb585-21" title="21">    <span class="cf">return</span> result</a>
<a class="sourceLine" id="cb585-22" title="22"><span class="im">from</span> rdkit.Chem <span class="im">import</span> QED</a>
<a class="sourceLine" id="cb585-23" title="23">smiles <span class="op">=</span> <span class="st">&#39;CC1=CN=C(C(=C1OC)C)CS(=O)C2=NC3=C(N2)C=C(C=C3)OC&#39;</span> <span class="co"># omeprazole</span></a>
<a class="sourceLine" id="cb585-24" title="24">m <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb585-25" title="25">q <span class="op">=</span> QED.qed(m)</a>
<a class="sourceLine" id="cb585-26" title="26"></a>
<a class="sourceLine" id="cb585-27" title="27">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(qed(smiles), q) <span class="cf">else</span> <span class="va">False</span> </a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-53">Run 1</h4>
<div class="sourceCode" id="cb587"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb587-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb587-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb587-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb587-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb587-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb587-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb587-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb587-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb587-9" title="9"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb587-10" title="10"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb587-11" title="11"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb587-12" title="12"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb587-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb587-14" title="14"></a>
<a class="sourceLine" id="cb587-15" title="15"><span class="kw">def</span> qed(smiles):</a>
<a class="sourceLine" id="cb587-16" title="16">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb587-17" title="17"><span class="co">    This function takes a SMILES string and returns the quantitative estimation of drug-likeness for the molecule.</span></a>
<a class="sourceLine" id="cb587-18" title="18"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb587-19" title="19">    mol <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb587-20" title="20">    result <span class="op">=</span> Crippen.MolLogP(mol)</a>
<a class="sourceLine" id="cb587-21" title="21">    <span class="cf">return</span> result</a>
<a class="sourceLine" id="cb587-22" title="22"><span class="im">from</span> rdkit.Chem <span class="im">import</span> QED</a>
<a class="sourceLine" id="cb587-23" title="23">smiles <span class="op">=</span> <span class="st">&#39;CC1=CN=C(C(=C1OC)C)CS(=O)C2=NC3=C(N2)C=C(C=C3)OC&#39;</span> <span class="co"># omeprazole</span></a>
<a class="sourceLine" id="cb587-24" title="24">m <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb587-25" title="25">q <span class="op">=</span> QED.qed(m)</a>
<a class="sourceLine" id="cb587-26" title="26"></a>
<a class="sourceLine" id="cb587-27" title="27">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(qed(smiles), q) <span class="cf">else</span> <span class="va">False</span> </a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-53">Run 2</h4>
<div class="sourceCode" id="cb589"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb589-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb589-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb589-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb589-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb589-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb589-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb589-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb589-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb589-9" title="9"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb589-10" title="10"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb589-11" title="11"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb589-12" title="12"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb589-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb589-14" title="14"></a>
<a class="sourceLine" id="cb589-15" title="15"><span class="kw">def</span> qed(smiles):</a>
<a class="sourceLine" id="cb589-16" title="16">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb589-17" title="17"><span class="co">    This function takes a SMILES string and returns the quantitative estimation of drug-likeness for the molecule.</span></a>
<a class="sourceLine" id="cb589-18" title="18"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb589-19" title="19">    mol <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb589-20" title="20">    result <span class="op">=</span> Crippen.MolLogP(mol)</a>
<a class="sourceLine" id="cb589-21" title="21">    <span class="cf">return</span> result</a>
<a class="sourceLine" id="cb589-22" title="22"><span class="im">from</span> rdkit.Chem <span class="im">import</span> QED</a>
<a class="sourceLine" id="cb589-23" title="23">smiles <span class="op">=</span> <span class="st">&#39;CC1=CN=C(C(=C1OC)C)CS(=O)C2=NC3=C(N2)C=C(C=C3)OC&#39;</span> <span class="co"># omeprazole</span></a>
<a class="sourceLine" id="cb589-24" title="24">m <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb589-25" title="25">q <span class="op">=</span> QED.qed(m)</a>
<a class="sourceLine" id="cb589-26" title="26"></a>
<a class="sourceLine" id="cb589-27" title="27">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(qed(smiles), q) <span class="cf">else</span> <span class="va">False</span> </a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-53">Run 3</h4>
<div class="sourceCode" id="cb591"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb591-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb591-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb591-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb591-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb591-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb591-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb591-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb591-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb591-9" title="9"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb591-10" title="10"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb591-11" title="11"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb591-12" title="12"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb591-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb591-14" title="14"></a>
<a class="sourceLine" id="cb591-15" title="15"><span class="kw">def</span> qed(smiles):</a>
<a class="sourceLine" id="cb591-16" title="16">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb591-17" title="17"><span class="co">    This function takes a SMILES string and returns the quantitative estimation of drug-likeness for the molecule.</span></a>
<a class="sourceLine" id="cb591-18" title="18"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb591-19" title="19">    mol <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb591-20" title="20">    result <span class="op">=</span> Crippen.MolLogP(mol)</a>
<a class="sourceLine" id="cb591-21" title="21">    <span class="cf">return</span> result</a>
<a class="sourceLine" id="cb591-22" title="22"><span class="im">from</span> rdkit.Chem <span class="im">import</span> QED</a>
<a class="sourceLine" id="cb591-23" title="23">smiles <span class="op">=</span> <span class="st">&#39;CC1=CN=C(C(=C1OC)C)CS(=O)C2=NC3=C(N2)C=C(C=C3)OC&#39;</span> <span class="co"># omeprazole</span></a>
<a class="sourceLine" id="cb591-24" title="24">m <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb591-25" title="25">q <span class="op">=</span> QED.qed(m)</a>
<a class="sourceLine" id="cb591-26" title="26"></a>
<a class="sourceLine" id="cb591-27" title="27">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(qed(smiles), q) <span class="cf">else</span> <span class="va">False</span> </a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-53">Run 4</h4>
<div class="sourceCode" id="cb593"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb593-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb593-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb593-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb593-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb593-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb593-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb593-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb593-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb593-9" title="9"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb593-10" title="10"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb593-11" title="11"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb593-12" title="12"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb593-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb593-14" title="14"></a>
<a class="sourceLine" id="cb593-15" title="15"><span class="kw">def</span> qed(smiles):</a>
<a class="sourceLine" id="cb593-16" title="16">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb593-17" title="17"><span class="co">    This function takes a SMILES string and returns the quantitative estimation of drug-likeness for the molecule.</span></a>
<a class="sourceLine" id="cb593-18" title="18"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb593-19" title="19">    mol <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb593-20" title="20">    result <span class="op">=</span> Crippen.MolLogP(mol)</a>
<a class="sourceLine" id="cb593-21" title="21">    <span class="cf">return</span> result</a>
<a class="sourceLine" id="cb593-22" title="22"></a>
<a class="sourceLine" id="cb593-23" title="23"></a>
<a class="sourceLine" id="cb593-24" title="24">    <span class="cf">return</span> result</a>
<a class="sourceLine" id="cb593-25" title="25"><span class="im">from</span> rdkit.Chem <span class="im">import</span> QED</a>
<a class="sourceLine" id="cb593-26" title="26">smiles <span class="op">=</span> <span class="st">&#39;CC1=CN=C(C(=C1OC)C)CS(=O)C2=NC3=C(N2)C=C(C=C3)OC&#39;</span> <span class="co"># omeprazole</span></a>
<a class="sourceLine" id="cb593-27" title="27">m <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb593-28" title="28">q <span class="op">=</span> QED.qed(m)</a>
<a class="sourceLine" id="cb593-29" title="29"></a>
<a class="sourceLine" id="cb593-30" title="30">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(qed(smiles), q) <span class="cf">else</span> <span class="va">False</span> </a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>quantile</summary></p>
<h4 id="query-54">Query</h4>
<div class="sourceCode" id="cb595"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb595-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb595-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb595-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb595-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb595-5" title="5"></a>
<a class="sourceLine" id="cb595-6" title="6"><span class="kw">def</span> quantile(a, q):</a>
<a class="sourceLine" id="cb595-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb595-8" title="8"><span class="co">  This function computes the q-th quantile of the numpy array a. q can be a sequence of quantiles with values between 0 and 1 inclusive.</span></a>
<a class="sourceLine" id="cb595-9" title="9"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb595-10" title="10">  [insert]</a>
<a class="sourceLine" id="cb595-11" title="11">  <span class="cf">return</span> result</a></code></pre></div>
<h4 id="run-0-54">Run 0</h4>
<div class="sourceCode" id="cb596"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb596-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb596-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb596-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb596-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb596-5" title="5"></a>
<a class="sourceLine" id="cb596-6" title="6"><span class="kw">def</span> quantile(a, q):</a>
<a class="sourceLine" id="cb596-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb596-8" title="8"><span class="co">  This function computes the q-th quantile of the numpy array a. q can be a sequence of quantiles with values between 0 and 1 inclusive.</span></a>
<a class="sourceLine" id="cb596-9" title="9"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb596-10" title="10">  result <span class="op">=</span> np.percentile(a, q <span class="op">*</span> <span class="dv">100</span>)</a>
<a class="sourceLine" id="cb596-11" title="11">  <span class="cf">return</span> result</a>
<a class="sourceLine" id="cb596-12" title="12"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb596-13" title="13"></a>
<a class="sourceLine" id="cb596-14" title="14">np.random.seed(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb596-15" title="15">M <span class="op">=</span> <span class="dv">100</span></a>
<a class="sourceLine" id="cb596-16" title="16">data <span class="op">=</span> np.random.randint(<span class="dv">1</span>, M, size<span class="op">=</span>(M,))</a>
<a class="sourceLine" id="cb596-17" title="17">quantiles <span class="op">=</span> [<span class="fl">0.1</span>, <span class="fl">0.5</span>, <span class="fl">0.9</span>]</a>
<a class="sourceLine" id="cb596-18" title="18"></a>
<a class="sourceLine" id="cb596-19" title="19">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.allclose(</a>
<a class="sourceLine" id="cb596-20" title="20">    quantile(data, quantiles), np.quantile(data, q<span class="op">=</span>quantiles)) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>operands could not be broadcast together with shapes (300,) (3,) </code></pre>
<h4 id="run-1-54">Run 1</h4>
<div class="sourceCode" id="cb598"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb598-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb598-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb598-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb598-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb598-5" title="5"></a>
<a class="sourceLine" id="cb598-6" title="6"><span class="kw">def</span> quantile(a, q):</a>
<a class="sourceLine" id="cb598-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb598-8" title="8"><span class="co">  This function computes the q-th quantile of the numpy array a. q can be a sequence of quantiles with values between 0 and 1 inclusive.</span></a>
<a class="sourceLine" id="cb598-9" title="9"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb598-10" title="10">  result <span class="op">=</span> np.percentile(a, q<span class="op">*</span><span class="dv">100</span>)</a>
<a class="sourceLine" id="cb598-11" title="11">  <span class="cf">return</span> result</a>
<a class="sourceLine" id="cb598-12" title="12"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb598-13" title="13"></a>
<a class="sourceLine" id="cb598-14" title="14">np.random.seed(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb598-15" title="15">M <span class="op">=</span> <span class="dv">100</span></a>
<a class="sourceLine" id="cb598-16" title="16">data <span class="op">=</span> np.random.randint(<span class="dv">1</span>, M, size<span class="op">=</span>(M,))</a>
<a class="sourceLine" id="cb598-17" title="17">quantiles <span class="op">=</span> [<span class="fl">0.1</span>, <span class="fl">0.5</span>, <span class="fl">0.9</span>]</a>
<a class="sourceLine" id="cb598-18" title="18"></a>
<a class="sourceLine" id="cb598-19" title="19">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.allclose(</a>
<a class="sourceLine" id="cb598-20" title="20">    quantile(data, quantiles), np.quantile(data, q<span class="op">=</span>quantiles)) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>operands could not be broadcast together with shapes (300,) (3,) </code></pre>
<h4 id="run-2-54">Run 2</h4>
<div class="sourceCode" id="cb600"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb600-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb600-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb600-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb600-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb600-5" title="5"></a>
<a class="sourceLine" id="cb600-6" title="6"><span class="kw">def</span> quantile(a, q):</a>
<a class="sourceLine" id="cb600-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb600-8" title="8"><span class="co">  This function computes the q-th quantile of the numpy array a. q can be a sequence of quantiles with values between 0 and 1 inclusive.</span></a>
<a class="sourceLine" id="cb600-9" title="9"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb600-10" title="10">  a <span class="op">=</span> np.sort(a)</a>
<a class="sourceLine" id="cb600-11" title="11">  n <span class="op">=</span> <span class="bu">len</span>(a)</a>
<a class="sourceLine" id="cb600-12" title="12">  <span class="cf">if</span> <span class="bu">type</span>(q) <span class="op">==</span> <span class="bu">float</span>:</a>
<a class="sourceLine" id="cb600-13" title="13">    q <span class="op">=</span> [q]</a>
<a class="sourceLine" id="cb600-14" title="14">  result <span class="op">=</span> []</a>
<a class="sourceLine" id="cb600-15" title="15">  <span class="cf">for</span> q_i <span class="kw">in</span> q:</a>
<a class="sourceLine" id="cb600-16" title="16">    <span class="cf">if</span> q_i <span class="op">==</span> <span class="dv">0</span>:</a>
<a class="sourceLine" id="cb600-17" title="17">      result.append(a[<span class="dv">0</span>])</a>
<a class="sourceLine" id="cb600-18" title="18">    <span class="cf">elif</span> q_i <span class="op">==</span> <span class="dv">1</span>:</a>
<a class="sourceLine" id="cb600-19" title="19">      result.append(a[n<span class="dv">-1</span>])</a>
<a class="sourceLine" id="cb600-20" title="20">    <span class="cf">else</span>:</a>
<a class="sourceLine" id="cb600-21" title="21">      i <span class="op">=</span> <span class="bu">int</span>(n<span class="op">*</span>q_i)</a>
<a class="sourceLine" id="cb600-22" title="22">      result.append(a[i])</a>
<a class="sourceLine" id="cb600-23" title="23">  <span class="cf">if</span> <span class="bu">len</span>(result) <span class="op">==</span> <span class="dv">1</span>:</a>
<a class="sourceLine" id="cb600-24" title="24">    <span class="cf">return</span> result[<span class="dv">0</span>]</a>
<a class="sourceLine" id="cb600-25" title="25">  <span class="cf">else</span>:</a>
<a class="sourceLine" id="cb600-26" title="26">  <span class="cf">return</span> result</a>
<a class="sourceLine" id="cb600-27" title="27"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb600-28" title="28"></a>
<a class="sourceLine" id="cb600-29" title="29">np.random.seed(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb600-30" title="30">M <span class="op">=</span> <span class="dv">100</span></a>
<a class="sourceLine" id="cb600-31" title="31">data <span class="op">=</span> np.random.randint(<span class="dv">1</span>, M, size<span class="op">=</span>(M,))</a>
<a class="sourceLine" id="cb600-32" title="32">quantiles <span class="op">=</span> [<span class="fl">0.1</span>, <span class="fl">0.5</span>, <span class="fl">0.9</span>]</a>
<a class="sourceLine" id="cb600-33" title="33"></a>
<a class="sourceLine" id="cb600-34" title="34">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.allclose(</a>
<a class="sourceLine" id="cb600-35" title="35">    quantile(data, quantiles), np.quantile(data, q<span class="op">=</span>quantiles)) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>expected an indented block (&lt;string&gt;, line 27)</code></pre>
<h4 id="run-3-54">Run 3</h4>
<div class="sourceCode" id="cb602"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb602-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb602-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb602-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb602-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb602-5" title="5"></a>
<a class="sourceLine" id="cb602-6" title="6"><span class="kw">def</span> quantile(a, q):</a>
<a class="sourceLine" id="cb602-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb602-8" title="8"><span class="co">  This function computes the q-th quantile of the numpy array a. q can be a sequence of quantiles with values between 0 and 1 inclusive.</span></a>
<a class="sourceLine" id="cb602-9" title="9"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb602-10" title="10">  a <span class="op">=</span> np.array(a)</a>
<a class="sourceLine" id="cb602-11" title="11">  <span class="cf">if</span> <span class="bu">isinstance</span>(q, (<span class="bu">int</span>, <span class="bu">float</span>)):</a>
<a class="sourceLine" id="cb602-12" title="12">    q <span class="op">=</span> [q]</a>
<a class="sourceLine" id="cb602-13" title="13">  q <span class="op">=</span> np.array(q)</a>
<a class="sourceLine" id="cb602-14" title="14">  <span class="cf">assert</span> np.<span class="bu">all</span>(q <span class="op">&gt;=</span> <span class="dv">0</span>) <span class="kw">and</span> np.<span class="bu">all</span>(q <span class="op">&lt;=</span> <span class="dv">1</span>), <span class="st">&quot;Quantiles must be between 0 and 1 inclusive.&quot;</span></a>
<a class="sourceLine" id="cb602-15" title="15">  result <span class="op">=</span> np.empty(<span class="bu">len</span>(q))</a>
<a class="sourceLine" id="cb602-16" title="16">  <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(q)):</a>
<a class="sourceLine" id="cb602-17" title="17">    result[i] <span class="op">=</span> np.percentile(a, q[i]<span class="op">*</span><span class="dv">100</span>)</a>
<a class="sourceLine" id="cb602-18" title="18">  <span class="cf">return</span> result</a>
<a class="sourceLine" id="cb602-19" title="19"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb602-20" title="20"></a>
<a class="sourceLine" id="cb602-21" title="21">np.random.seed(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb602-22" title="22">M <span class="op">=</span> <span class="dv">100</span></a>
<a class="sourceLine" id="cb602-23" title="23">data <span class="op">=</span> np.random.randint(<span class="dv">1</span>, M, size<span class="op">=</span>(M,))</a>
<a class="sourceLine" id="cb602-24" title="24">quantiles <span class="op">=</span> [<span class="fl">0.1</span>, <span class="fl">0.5</span>, <span class="fl">0.9</span>]</a>
<a class="sourceLine" id="cb602-25" title="25"></a>
<a class="sourceLine" id="cb602-26" title="26">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.allclose(</a>
<a class="sourceLine" id="cb602-27" title="27">    quantile(data, quantiles), np.quantile(data, q<span class="op">=</span>quantiles)) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-54">Run 4</h4>
<div class="sourceCode" id="cb604"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb604-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb604-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb604-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb604-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb604-5" title="5"></a>
<a class="sourceLine" id="cb604-6" title="6"><span class="kw">def</span> quantile(a, q):</a>
<a class="sourceLine" id="cb604-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb604-8" title="8"><span class="co">  This function computes the q-th quantile of the numpy array a. q can be a sequence of quantiles with values between 0 and 1 inclusive.</span></a>
<a class="sourceLine" id="cb604-9" title="9"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb604-10" title="10">  <span class="cf">if</span> np.isscalar(q):</a>
<a class="sourceLine" id="cb604-11" title="11">    q <span class="op">=</span> [q]</a>
<a class="sourceLine" id="cb604-12" title="12">  result <span class="op">=</span> np.empty(<span class="bu">len</span>(q))</a>
<a class="sourceLine" id="cb604-13" title="13">  <span class="cf">for</span> i, qi <span class="kw">in</span> <span class="bu">enumerate</span>(q):</a>
<a class="sourceLine" id="cb604-14" title="14">    result[i] <span class="op">=</span> np.percentile(a, qi <span class="op">*</span> <span class="dv">100</span>)</a>
<a class="sourceLine" id="cb604-15" title="15">  <span class="cf">return</span> result</a>
<a class="sourceLine" id="cb604-16" title="16"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb604-17" title="17"></a>
<a class="sourceLine" id="cb604-18" title="18">np.random.seed(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb604-19" title="19">M <span class="op">=</span> <span class="dv">100</span></a>
<a class="sourceLine" id="cb604-20" title="20">data <span class="op">=</span> np.random.randint(<span class="dv">1</span>, M, size<span class="op">=</span>(M,))</a>
<a class="sourceLine" id="cb604-21" title="21">quantiles <span class="op">=</span> [<span class="fl">0.1</span>, <span class="fl">0.5</span>, <span class="fl">0.9</span>]</a>
<a class="sourceLine" id="cb604-22" title="22"></a>
<a class="sourceLine" id="cb604-23" title="23">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.allclose(</a>
<a class="sourceLine" id="cb604-24" title="24">    quantile(data, quantiles), np.quantile(data, q<span class="op">=</span>quantiles)) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>random_walk</summary></p>
<h4 id="query-55">Query</h4>
<div class="sourceCode" id="cb606"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb606-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb606-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb606-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb606-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb606-5" title="5"></a>
<a class="sourceLine" id="cb606-6" title="6"><span class="kw">def</span> random_walk(N):</a>
<a class="sourceLine" id="cb606-7" title="7">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb606-8" title="8"><span class="co">    This function returns the trajectory of an N step random walk on a one dimensional lattice</span></a>
<a class="sourceLine" id="cb606-9" title="9"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb606-10" title="10">    a <span class="op">=</span> <span class="dv">1</span> <span class="co"># lattice spacing</span></a>
<a class="sourceLine" id="cb606-11" title="11">    x0 <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb606-12" title="12">    [insert]</a>
<a class="sourceLine" id="cb606-13" title="13">    <span class="cf">return</span> traj</a></code></pre></div>
<h4 id="run-0-55">Run 0</h4>
<div class="sourceCode" id="cb607"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb607-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb607-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb607-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb607-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb607-5" title="5"></a>
<a class="sourceLine" id="cb607-6" title="6"><span class="kw">def</span> random_walk(N):</a>
<a class="sourceLine" id="cb607-7" title="7">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb607-8" title="8"><span class="co">    This function returns the trajectory of an N step random walk on a one dimensional lattice</span></a>
<a class="sourceLine" id="cb607-9" title="9"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb607-10" title="10">    a <span class="op">=</span> <span class="dv">1</span> <span class="co"># lattice spacing</span></a>
<a class="sourceLine" id="cb607-11" title="11">    x0 <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb607-12" title="12">    traj <span class="op">=</span> np.zeros(N)</a>
<a class="sourceLine" id="cb607-13" title="13">    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(N):</a>
<a class="sourceLine" id="cb607-14" title="14">        traj[i] <span class="op">=</span> x0</a>
<a class="sourceLine" id="cb607-15" title="15">        x0 <span class="op">+=</span> a<span class="op">*</span>(<span class="dv">2</span><span class="op">*</span>np.random.randint(<span class="dv">2</span>)<span class="op">-</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb607-16" title="16"></a>
<a class="sourceLine" id="cb607-17" title="17">    <span class="cf">return</span> traj</a>
<a class="sourceLine" id="cb607-18" title="18"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb607-19" title="19"><span class="im">import</span> pylab <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb607-20" title="20">nsteps <span class="op">=</span> <span class="dv">5000</span></a>
<a class="sourceLine" id="cb607-21" title="21">n_repeats <span class="op">=</span> <span class="dv">250</span></a>
<a class="sourceLine" id="cb607-22" title="22">nlcc_trj_list <span class="op">=</span> []</a>
<a class="sourceLine" id="cb607-23" title="23"><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n_repeats):</a>
<a class="sourceLine" id="cb607-24" title="24">    nlcc_trj <span class="op">=</span> random_walk(nsteps)</a>
<a class="sourceLine" id="cb607-25" title="25">    nlcc_trj_list.append(nlcc_trj)</a>
<a class="sourceLine" id="cb607-26" title="26">nlcc_trj_list <span class="op">=</span> np.array(nlcc_trj_list)</a>
<a class="sourceLine" id="cb607-27" title="27"></a>
<a class="sourceLine" id="cb607-28" title="28">msd <span class="op">=</span> (nlcc_trj_list<span class="op">*</span>nlcc_trj_list).mean(axis<span class="op">=</span><span class="dv">0</span>)</a>
<a class="sourceLine" id="cb607-29" title="29"></a>
<a class="sourceLine" id="cb607-30" title="30">a,b <span class="op">=</span> np.polyfit(np.log(np.arange(<span class="dv">1</span>,nsteps)),np.log(msd[<span class="dv">1</span>:]),<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb607-31" title="31"><span class="co">#plt.plot(np.arange(nsteps),msd)</span></a>
<a class="sourceLine" id="cb607-32" title="32"><span class="co">#plt.plot(np.arange(nsteps),np.exp(b+a*np.log(np.arange(nsteps))),linestyle=&#39;--&#39;,label=&#39;fit&#39;)</span></a>
<a class="sourceLine" id="cb607-33" title="33"><span class="co">#plt.legend()</span></a>
<a class="sourceLine" id="cb607-34" title="34"><span class="co">#plt.show()</span></a>
<a class="sourceLine" id="cb607-35" title="35"><span class="co">#print(&quot;a =&quot;,a)</span></a>
<a class="sourceLine" id="cb607-36" title="36"><span class="co">#print(&quot;b =&quot;,b)</span></a>
<a class="sourceLine" id="cb607-37" title="37"></a>
<a class="sourceLine" id="cb607-38" title="38"><span class="co">#ideal exponent for msd is 1</span></a>
<a class="sourceLine" id="cb607-39" title="39">ideal <span class="op">=</span> <span class="fl">1.0</span></a>
<a class="sourceLine" id="cb607-40" title="40">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">abs</span>((a<span class="op">-</span>ideal)<span class="op">/</span>ideal) <span class="op">&lt;</span> <span class="fl">0.1</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-55">Run 1</h4>
<div class="sourceCode" id="cb609"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb609-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb609-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb609-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb609-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb609-5" title="5"></a>
<a class="sourceLine" id="cb609-6" title="6"><span class="kw">def</span> random_walk(N):</a>
<a class="sourceLine" id="cb609-7" title="7">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb609-8" title="8"><span class="co">    This function returns the trajectory of an N step random walk on a one dimensional lattice</span></a>
<a class="sourceLine" id="cb609-9" title="9"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb609-10" title="10">    a <span class="op">=</span> <span class="dv">1</span> <span class="co"># lattice spacing</span></a>
<a class="sourceLine" id="cb609-11" title="11">    x0 <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb609-12" title="12">    traj <span class="op">=</span> np.zeros(N)</a>
<a class="sourceLine" id="cb609-13" title="13">    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(N):</a>
<a class="sourceLine" id="cb609-14" title="14">        x0 <span class="op">+=</span> a<span class="op">*</span>(np.random.randint(<span class="dv">2</span>)<span class="op">*</span><span class="dv">2-1</span>)</a>
<a class="sourceLine" id="cb609-15" title="15">        traj[i] <span class="op">=</span> x0</a>
<a class="sourceLine" id="cb609-16" title="16">    <span class="cf">return</span> traj</a>
<a class="sourceLine" id="cb609-17" title="17"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb609-18" title="18"><span class="im">import</span> pylab <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb609-19" title="19">nsteps <span class="op">=</span> <span class="dv">5000</span></a>
<a class="sourceLine" id="cb609-20" title="20">n_repeats <span class="op">=</span> <span class="dv">250</span></a>
<a class="sourceLine" id="cb609-21" title="21">nlcc_trj_list <span class="op">=</span> []</a>
<a class="sourceLine" id="cb609-22" title="22"><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n_repeats):</a>
<a class="sourceLine" id="cb609-23" title="23">    nlcc_trj <span class="op">=</span> random_walk(nsteps)</a>
<a class="sourceLine" id="cb609-24" title="24">    nlcc_trj_list.append(nlcc_trj)</a>
<a class="sourceLine" id="cb609-25" title="25">nlcc_trj_list <span class="op">=</span> np.array(nlcc_trj_list)</a>
<a class="sourceLine" id="cb609-26" title="26"></a>
<a class="sourceLine" id="cb609-27" title="27">msd <span class="op">=</span> (nlcc_trj_list<span class="op">*</span>nlcc_trj_list).mean(axis<span class="op">=</span><span class="dv">0</span>)</a>
<a class="sourceLine" id="cb609-28" title="28"></a>
<a class="sourceLine" id="cb609-29" title="29">a,b <span class="op">=</span> np.polyfit(np.log(np.arange(<span class="dv">1</span>,nsteps)),np.log(msd[<span class="dv">1</span>:]),<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb609-30" title="30"><span class="co">#plt.plot(np.arange(nsteps),msd)</span></a>
<a class="sourceLine" id="cb609-31" title="31"><span class="co">#plt.plot(np.arange(nsteps),np.exp(b+a*np.log(np.arange(nsteps))),linestyle=&#39;--&#39;,label=&#39;fit&#39;)</span></a>
<a class="sourceLine" id="cb609-32" title="32"><span class="co">#plt.legend()</span></a>
<a class="sourceLine" id="cb609-33" title="33"><span class="co">#plt.show()</span></a>
<a class="sourceLine" id="cb609-34" title="34"><span class="co">#print(&quot;a =&quot;,a)</span></a>
<a class="sourceLine" id="cb609-35" title="35"><span class="co">#print(&quot;b =&quot;,b)</span></a>
<a class="sourceLine" id="cb609-36" title="36"></a>
<a class="sourceLine" id="cb609-37" title="37"><span class="co">#ideal exponent for msd is 1</span></a>
<a class="sourceLine" id="cb609-38" title="38">ideal <span class="op">=</span> <span class="fl">1.0</span></a>
<a class="sourceLine" id="cb609-39" title="39">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">abs</span>((a<span class="op">-</span>ideal)<span class="op">/</span>ideal) <span class="op">&lt;</span> <span class="fl">0.1</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-55">Run 2</h4>
<div class="sourceCode" id="cb611"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb611-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb611-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb611-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb611-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb611-5" title="5"></a>
<a class="sourceLine" id="cb611-6" title="6"><span class="kw">def</span> random_walk(N):</a>
<a class="sourceLine" id="cb611-7" title="7">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb611-8" title="8"><span class="co">    This function returns the trajectory of an N step random walk on a one dimensional lattice</span></a>
<a class="sourceLine" id="cb611-9" title="9"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb611-10" title="10">    a <span class="op">=</span> <span class="dv">1</span> <span class="co"># lattice spacing</span></a>
<a class="sourceLine" id="cb611-11" title="11">    x0 <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb611-12" title="12">    traj <span class="op">=</span> np.zeros(N)</a>
<a class="sourceLine" id="cb611-13" title="13">    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(N):</a>
<a class="sourceLine" id="cb611-14" title="14">        traj[i] <span class="op">=</span> x0</a>
<a class="sourceLine" id="cb611-15" title="15">        x0 <span class="op">+=</span> a<span class="op">*</span>(<span class="dv">2</span><span class="op">*</span>np.random.randint(<span class="dv">2</span>)<span class="op">-</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb611-16" title="16">    <span class="cf">return</span> traj</a>
<a class="sourceLine" id="cb611-17" title="17"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb611-18" title="18"><span class="im">import</span> pylab <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb611-19" title="19">nsteps <span class="op">=</span> <span class="dv">5000</span></a>
<a class="sourceLine" id="cb611-20" title="20">n_repeats <span class="op">=</span> <span class="dv">250</span></a>
<a class="sourceLine" id="cb611-21" title="21">nlcc_trj_list <span class="op">=</span> []</a>
<a class="sourceLine" id="cb611-22" title="22"><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n_repeats):</a>
<a class="sourceLine" id="cb611-23" title="23">    nlcc_trj <span class="op">=</span> random_walk(nsteps)</a>
<a class="sourceLine" id="cb611-24" title="24">    nlcc_trj_list.append(nlcc_trj)</a>
<a class="sourceLine" id="cb611-25" title="25">nlcc_trj_list <span class="op">=</span> np.array(nlcc_trj_list)</a>
<a class="sourceLine" id="cb611-26" title="26"></a>
<a class="sourceLine" id="cb611-27" title="27">msd <span class="op">=</span> (nlcc_trj_list<span class="op">*</span>nlcc_trj_list).mean(axis<span class="op">=</span><span class="dv">0</span>)</a>
<a class="sourceLine" id="cb611-28" title="28"></a>
<a class="sourceLine" id="cb611-29" title="29">a,b <span class="op">=</span> np.polyfit(np.log(np.arange(<span class="dv">1</span>,nsteps)),np.log(msd[<span class="dv">1</span>:]),<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb611-30" title="30"><span class="co">#plt.plot(np.arange(nsteps),msd)</span></a>
<a class="sourceLine" id="cb611-31" title="31"><span class="co">#plt.plot(np.arange(nsteps),np.exp(b+a*np.log(np.arange(nsteps))),linestyle=&#39;--&#39;,label=&#39;fit&#39;)</span></a>
<a class="sourceLine" id="cb611-32" title="32"><span class="co">#plt.legend()</span></a>
<a class="sourceLine" id="cb611-33" title="33"><span class="co">#plt.show()</span></a>
<a class="sourceLine" id="cb611-34" title="34"><span class="co">#print(&quot;a =&quot;,a)</span></a>
<a class="sourceLine" id="cb611-35" title="35"><span class="co">#print(&quot;b =&quot;,b)</span></a>
<a class="sourceLine" id="cb611-36" title="36"></a>
<a class="sourceLine" id="cb611-37" title="37"><span class="co">#ideal exponent for msd is 1</span></a>
<a class="sourceLine" id="cb611-38" title="38">ideal <span class="op">=</span> <span class="fl">1.0</span></a>
<a class="sourceLine" id="cb611-39" title="39">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">abs</span>((a<span class="op">-</span>ideal)<span class="op">/</span>ideal) <span class="op">&lt;</span> <span class="fl">0.1</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-55">Run 3</h4>
<div class="sourceCode" id="cb613"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb613-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb613-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb613-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb613-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb613-5" title="5"></a>
<a class="sourceLine" id="cb613-6" title="6"><span class="kw">def</span> random_walk(N):</a>
<a class="sourceLine" id="cb613-7" title="7">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb613-8" title="8"><span class="co">    This function returns the trajectory of an N step random walk on a one dimensional lattice</span></a>
<a class="sourceLine" id="cb613-9" title="9"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb613-10" title="10">    a <span class="op">=</span> <span class="dv">1</span> <span class="co"># lattice spacing</span></a>
<a class="sourceLine" id="cb613-11" title="11">    x0 <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb613-12" title="12">    traj <span class="op">=</span> np.zeros(N)</a>
<a class="sourceLine" id="cb613-13" title="13">    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(N):</a>
<a class="sourceLine" id="cb613-14" title="14">        traj[i] <span class="op">=</span> x0</a>
<a class="sourceLine" id="cb613-15" title="15">        x0 <span class="op">+=</span> a<span class="op">*</span>np.random.choice([<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb613-16" title="16">    <span class="cf">return</span> traj</a>
<a class="sourceLine" id="cb613-17" title="17"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb613-18" title="18"><span class="im">import</span> pylab <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb613-19" title="19">nsteps <span class="op">=</span> <span class="dv">5000</span></a>
<a class="sourceLine" id="cb613-20" title="20">n_repeats <span class="op">=</span> <span class="dv">250</span></a>
<a class="sourceLine" id="cb613-21" title="21">nlcc_trj_list <span class="op">=</span> []</a>
<a class="sourceLine" id="cb613-22" title="22"><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n_repeats):</a>
<a class="sourceLine" id="cb613-23" title="23">    nlcc_trj <span class="op">=</span> random_walk(nsteps)</a>
<a class="sourceLine" id="cb613-24" title="24">    nlcc_trj_list.append(nlcc_trj)</a>
<a class="sourceLine" id="cb613-25" title="25">nlcc_trj_list <span class="op">=</span> np.array(nlcc_trj_list)</a>
<a class="sourceLine" id="cb613-26" title="26"></a>
<a class="sourceLine" id="cb613-27" title="27">msd <span class="op">=</span> (nlcc_trj_list<span class="op">*</span>nlcc_trj_list).mean(axis<span class="op">=</span><span class="dv">0</span>)</a>
<a class="sourceLine" id="cb613-28" title="28"></a>
<a class="sourceLine" id="cb613-29" title="29">a,b <span class="op">=</span> np.polyfit(np.log(np.arange(<span class="dv">1</span>,nsteps)),np.log(msd[<span class="dv">1</span>:]),<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb613-30" title="30"><span class="co">#plt.plot(np.arange(nsteps),msd)</span></a>
<a class="sourceLine" id="cb613-31" title="31"><span class="co">#plt.plot(np.arange(nsteps),np.exp(b+a*np.log(np.arange(nsteps))),linestyle=&#39;--&#39;,label=&#39;fit&#39;)</span></a>
<a class="sourceLine" id="cb613-32" title="32"><span class="co">#plt.legend()</span></a>
<a class="sourceLine" id="cb613-33" title="33"><span class="co">#plt.show()</span></a>
<a class="sourceLine" id="cb613-34" title="34"><span class="co">#print(&quot;a =&quot;,a)</span></a>
<a class="sourceLine" id="cb613-35" title="35"><span class="co">#print(&quot;b =&quot;,b)</span></a>
<a class="sourceLine" id="cb613-36" title="36"></a>
<a class="sourceLine" id="cb613-37" title="37"><span class="co">#ideal exponent for msd is 1</span></a>
<a class="sourceLine" id="cb613-38" title="38">ideal <span class="op">=</span> <span class="fl">1.0</span></a>
<a class="sourceLine" id="cb613-39" title="39">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">abs</span>((a<span class="op">-</span>ideal)<span class="op">/</span>ideal) <span class="op">&lt;</span> <span class="fl">0.1</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Timeout</code></pre>
<h4 id="run-4-55">Run 4</h4>
<div class="sourceCode" id="cb615"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb615-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb615-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb615-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb615-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb615-5" title="5"></a>
<a class="sourceLine" id="cb615-6" title="6"><span class="kw">def</span> random_walk(N):</a>
<a class="sourceLine" id="cb615-7" title="7">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb615-8" title="8"><span class="co">    This function returns the trajectory of an N step random walk on a one dimensional lattice</span></a>
<a class="sourceLine" id="cb615-9" title="9"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb615-10" title="10">    a <span class="op">=</span> <span class="dv">1</span> <span class="co"># lattice spacing</span></a>
<a class="sourceLine" id="cb615-11" title="11">    x0 <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb615-12" title="12">    traj <span class="op">=</span> np.zeros(N)</a>
<a class="sourceLine" id="cb615-13" title="13">    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(N):</a>
<a class="sourceLine" id="cb615-14" title="14">        traj[i] <span class="op">=</span> x0</a>
<a class="sourceLine" id="cb615-15" title="15">        x0 <span class="op">+=</span> a<span class="op">*</span>(np.random.randint(<span class="dv">2</span>)<span class="op">*</span><span class="dv">2-1</span>)</a>
<a class="sourceLine" id="cb615-16" title="16">    <span class="cf">return</span> traj</a>
<a class="sourceLine" id="cb615-17" title="17"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb615-18" title="18"><span class="im">import</span> pylab <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb615-19" title="19">nsteps <span class="op">=</span> <span class="dv">5000</span></a>
<a class="sourceLine" id="cb615-20" title="20">n_repeats <span class="op">=</span> <span class="dv">250</span></a>
<a class="sourceLine" id="cb615-21" title="21">nlcc_trj_list <span class="op">=</span> []</a>
<a class="sourceLine" id="cb615-22" title="22"><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n_repeats):</a>
<a class="sourceLine" id="cb615-23" title="23">    nlcc_trj <span class="op">=</span> random_walk(nsteps)</a>
<a class="sourceLine" id="cb615-24" title="24">    nlcc_trj_list.append(nlcc_trj)</a>
<a class="sourceLine" id="cb615-25" title="25">nlcc_trj_list <span class="op">=</span> np.array(nlcc_trj_list)</a>
<a class="sourceLine" id="cb615-26" title="26"></a>
<a class="sourceLine" id="cb615-27" title="27">msd <span class="op">=</span> (nlcc_trj_list<span class="op">*</span>nlcc_trj_list).mean(axis<span class="op">=</span><span class="dv">0</span>)</a>
<a class="sourceLine" id="cb615-28" title="28"></a>
<a class="sourceLine" id="cb615-29" title="29">a,b <span class="op">=</span> np.polyfit(np.log(np.arange(<span class="dv">1</span>,nsteps)),np.log(msd[<span class="dv">1</span>:]),<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb615-30" title="30"><span class="co">#plt.plot(np.arange(nsteps),msd)</span></a>
<a class="sourceLine" id="cb615-31" title="31"><span class="co">#plt.plot(np.arange(nsteps),np.exp(b+a*np.log(np.arange(nsteps))),linestyle=&#39;--&#39;,label=&#39;fit&#39;)</span></a>
<a class="sourceLine" id="cb615-32" title="32"><span class="co">#plt.legend()</span></a>
<a class="sourceLine" id="cb615-33" title="33"><span class="co">#plt.show()</span></a>
<a class="sourceLine" id="cb615-34" title="34"><span class="co">#print(&quot;a =&quot;,a)</span></a>
<a class="sourceLine" id="cb615-35" title="35"><span class="co">#print(&quot;b =&quot;,b)</span></a>
<a class="sourceLine" id="cb615-36" title="36"></a>
<a class="sourceLine" id="cb615-37" title="37"><span class="co">#ideal exponent for msd is 1</span></a>
<a class="sourceLine" id="cb615-38" title="38">ideal <span class="op">=</span> <span class="fl">1.0</span></a>
<a class="sourceLine" id="cb615-39" title="39">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">abs</span>((a<span class="op">-</span>ideal)<span class="op">/</span>ideal) <span class="op">&lt;</span> <span class="fl">0.1</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>rank</summary></p>
<h4 id="query-56">Query</h4>
<div class="sourceCode" id="cb617"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb617-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb617-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb617-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb617-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb617-5" title="5"></a>
<a class="sourceLine" id="cb617-6" title="6"><span class="kw">def</span> rank(M):</a>
<a class="sourceLine" id="cb617-7" title="7">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb617-8" title="8"><span class="co">    这个函数使用奇异值分解来计算矩阵M的秩。</span></a>
<a class="sourceLine" id="cb617-9" title="9"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb617-10" title="10">    [insert]</a>
<a class="sourceLine" id="cb617-11" title="11">    <span class="cf">return</span> r</a></code></pre></div>
<h4 id="run-0-56">Run 0</h4>
<div class="sourceCode" id="cb618"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb618-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb618-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb618-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb618-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb618-5" title="5"></a>
<a class="sourceLine" id="cb618-6" title="6"><span class="kw">def</span> rank(M):</a>
<a class="sourceLine" id="cb618-7" title="7">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb618-8" title="8"><span class="co">    这个函数使用奇异值分解来计算矩阵M的秩。</span></a>
<a class="sourceLine" id="cb618-9" title="9"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb618-10" title="10">    U, s, V <span class="op">=</span> np.linalg.svd(M)</a>
<a class="sourceLine" id="cb618-11" title="11">    r <span class="op">=</span> np.<span class="bu">sum</span>(s <span class="op">&gt;</span> <span class="fl">1e-10</span>)</a>
<a class="sourceLine" id="cb618-12" title="12">    <span class="cf">return</span> r</a>
<a class="sourceLine" id="cb618-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb618-14" title="14"></a>
<a class="sourceLine" id="cb618-15" title="15">np.random.seed(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb618-16" title="16">M <span class="op">=</span> np.random.random((<span class="dv">5</span>,<span class="dv">5</span>))</a>
<a class="sourceLine" id="cb618-17" title="17">r <span class="op">=</span> np.linalg.matrix_rank(M)</a>
<a class="sourceLine" id="cb618-18" title="18"></a>
<a class="sourceLine" id="cb618-19" title="19">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(r, rank(M)) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-56">Run 1</h4>
<div class="sourceCode" id="cb620"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb620-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb620-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb620-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb620-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb620-5" title="5"></a>
<a class="sourceLine" id="cb620-6" title="6"><span class="kw">def</span> rank(M):</a>
<a class="sourceLine" id="cb620-7" title="7">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb620-8" title="8"><span class="co">    这个函数使用奇异值分解来计算矩阵M的秩。</span></a>
<a class="sourceLine" id="cb620-9" title="9"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb620-10" title="10">    U, s, V <span class="op">=</span> np.linalg.svd(M)</a>
<a class="sourceLine" id="cb620-11" title="11">    r <span class="op">=</span> np.<span class="bu">sum</span>(s <span class="op">&gt;</span> <span class="fl">1e-10</span>)</a>
<a class="sourceLine" id="cb620-12" title="12">    <span class="cf">return</span> r</a>
<a class="sourceLine" id="cb620-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb620-14" title="14"></a>
<a class="sourceLine" id="cb620-15" title="15">np.random.seed(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb620-16" title="16">M <span class="op">=</span> np.random.random((<span class="dv">5</span>,<span class="dv">5</span>))</a>
<a class="sourceLine" id="cb620-17" title="17">r <span class="op">=</span> np.linalg.matrix_rank(M)</a>
<a class="sourceLine" id="cb620-18" title="18"></a>
<a class="sourceLine" id="cb620-19" title="19">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(r, rank(M)) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-56">Run 2</h4>
<div class="sourceCode" id="cb622"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb622-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb622-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb622-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb622-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb622-5" title="5"></a>
<a class="sourceLine" id="cb622-6" title="6"><span class="kw">def</span> rank(M):</a>
<a class="sourceLine" id="cb622-7" title="7">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb622-8" title="8"><span class="co">    这个函数使用奇异值分解来计算矩阵M的秩。</span></a>
<a class="sourceLine" id="cb622-9" title="9"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb622-10" title="10">    U, s, V <span class="op">=</span> np.linalg.svd(M)</a>
<a class="sourceLine" id="cb622-11" title="11">    r <span class="op">=</span> np.<span class="bu">sum</span>(s <span class="op">&gt;</span> <span class="fl">1e-10</span>)</a>
<a class="sourceLine" id="cb622-12" title="12">    <span class="cf">return</span> r</a>
<a class="sourceLine" id="cb622-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb622-14" title="14"></a>
<a class="sourceLine" id="cb622-15" title="15">np.random.seed(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb622-16" title="16">M <span class="op">=</span> np.random.random((<span class="dv">5</span>,<span class="dv">5</span>))</a>
<a class="sourceLine" id="cb622-17" title="17">r <span class="op">=</span> np.linalg.matrix_rank(M)</a>
<a class="sourceLine" id="cb622-18" title="18"></a>
<a class="sourceLine" id="cb622-19" title="19">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(r, rank(M)) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-56">Run 3</h4>
<div class="sourceCode" id="cb624"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb624-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb624-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb624-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb624-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb624-5" title="5"></a>
<a class="sourceLine" id="cb624-6" title="6"><span class="kw">def</span> rank(M):</a>
<a class="sourceLine" id="cb624-7" title="7">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb624-8" title="8"><span class="co">    这个函数使用奇异值分解来计算矩阵M的秩。</span></a>
<a class="sourceLine" id="cb624-9" title="9"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb624-10" title="10">    U, s, V <span class="op">=</span> np.linalg.svd(M)</a>
<a class="sourceLine" id="cb624-11" title="11">    r <span class="op">=</span> np.<span class="bu">sum</span>(s <span class="op">&gt;</span> <span class="fl">1e-10</span>)</a>
<a class="sourceLine" id="cb624-12" title="12">    <span class="cf">return</span> r</a>
<a class="sourceLine" id="cb624-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb624-14" title="14"></a>
<a class="sourceLine" id="cb624-15" title="15">np.random.seed(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb624-16" title="16">M <span class="op">=</span> np.random.random((<span class="dv">5</span>,<span class="dv">5</span>))</a>
<a class="sourceLine" id="cb624-17" title="17">r <span class="op">=</span> np.linalg.matrix_rank(M)</a>
<a class="sourceLine" id="cb624-18" title="18"></a>
<a class="sourceLine" id="cb624-19" title="19">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(r, rank(M)) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-56">Run 4</h4>
<div class="sourceCode" id="cb626"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb626-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb626-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb626-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb626-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb626-5" title="5"></a>
<a class="sourceLine" id="cb626-6" title="6"><span class="kw">def</span> rank(M):</a>
<a class="sourceLine" id="cb626-7" title="7">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb626-8" title="8"><span class="co">    这个函数使用奇异值分解来计算矩阵M的秩。</span></a>
<a class="sourceLine" id="cb626-9" title="9"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb626-10" title="10">    U, s, V <span class="op">=</span> np.linalg.svd(M)</a>
<a class="sourceLine" id="cb626-11" title="11">    r <span class="op">=</span> np.<span class="bu">sum</span>(s <span class="op">&gt;</span> <span class="fl">1e-10</span>)</a>
<a class="sourceLine" id="cb626-12" title="12">    <span class="cf">return</span> r</a>
<a class="sourceLine" id="cb626-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb626-14" title="14"></a>
<a class="sourceLine" id="cb626-15" title="15">np.random.seed(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb626-16" title="16">M <span class="op">=</span> np.random.random((<span class="dv">5</span>,<span class="dv">5</span>))</a>
<a class="sourceLine" id="cb626-17" title="17">r <span class="op">=</span> np.linalg.matrix_rank(M)</a>
<a class="sourceLine" id="cb626-18" title="18"></a>
<a class="sourceLine" id="cb626-19" title="19">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(r, rank(M)) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>rank</summary></p>
<h4 id="query-57">Query</h4>
<div class="sourceCode" id="cb628"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb628-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb628-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb628-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb628-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb628-5" title="5"></a>
<a class="sourceLine" id="cb628-6" title="6"><span class="kw">def</span> rank(M):</a>
<a class="sourceLine" id="cb628-7" title="7">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb628-8" title="8"><span class="co">    This function calculates the rank of matrix M using singular value decomposition.</span></a>
<a class="sourceLine" id="cb628-9" title="9"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb628-10" title="10">    [insert]</a>
<a class="sourceLine" id="cb628-11" title="11">    <span class="cf">return</span> r</a></code></pre></div>
<h4 id="run-0-57">Run 0</h4>
<div class="sourceCode" id="cb629"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb629-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb629-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb629-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb629-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb629-5" title="5"></a>
<a class="sourceLine" id="cb629-6" title="6"><span class="kw">def</span> rank(M):</a>
<a class="sourceLine" id="cb629-7" title="7">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb629-8" title="8"><span class="co">    This function calculates the rank of matrix M using singular value decomposition.</span></a>
<a class="sourceLine" id="cb629-9" title="9"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb629-10" title="10">    U, s, V <span class="op">=</span> np.linalg.svd(M, full_matrices<span class="op">=</span><span class="va">True</span>)</a>
<a class="sourceLine" id="cb629-11" title="11">    r <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb629-12" title="12">    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(s)):</a>
<a class="sourceLine" id="cb629-13" title="13">        <span class="cf">if</span> s[i] <span class="op">&gt;</span> <span class="fl">1e-10</span>:</a>
<a class="sourceLine" id="cb629-14" title="14">            r <span class="op">+=</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb629-15" title="15">    <span class="cf">return</span> r</a>
<a class="sourceLine" id="cb629-16" title="16"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb629-17" title="17"></a>
<a class="sourceLine" id="cb629-18" title="18">np.random.seed(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb629-19" title="19">M <span class="op">=</span> np.random.random((<span class="dv">5</span>,<span class="dv">5</span>))</a>
<a class="sourceLine" id="cb629-20" title="20">r <span class="op">=</span> np.linalg.matrix_rank(M)</a>
<a class="sourceLine" id="cb629-21" title="21"></a>
<a class="sourceLine" id="cb629-22" title="22">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(r, rank(M)) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-57">Run 1</h4>
<div class="sourceCode" id="cb631"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb631-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb631-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb631-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb631-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb631-5" title="5"></a>
<a class="sourceLine" id="cb631-6" title="6"><span class="kw">def</span> rank(M):</a>
<a class="sourceLine" id="cb631-7" title="7">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb631-8" title="8"><span class="co">    This function calculates the rank of matrix M using singular value decomposition.</span></a>
<a class="sourceLine" id="cb631-9" title="9"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb631-10" title="10">    U, s, V <span class="op">=</span> np.linalg.svd(M)</a>
<a class="sourceLine" id="cb631-11" title="11">    r <span class="op">=</span> np.<span class="bu">sum</span>(s <span class="op">&gt;</span> <span class="fl">1e-12</span>)</a>
<a class="sourceLine" id="cb631-12" title="12">    <span class="cf">return</span> r</a>
<a class="sourceLine" id="cb631-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb631-14" title="14"></a>
<a class="sourceLine" id="cb631-15" title="15">np.random.seed(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb631-16" title="16">M <span class="op">=</span> np.random.random((<span class="dv">5</span>,<span class="dv">5</span>))</a>
<a class="sourceLine" id="cb631-17" title="17">r <span class="op">=</span> np.linalg.matrix_rank(M)</a>
<a class="sourceLine" id="cb631-18" title="18"></a>
<a class="sourceLine" id="cb631-19" title="19">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(r, rank(M)) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-57">Run 2</h4>
<div class="sourceCode" id="cb633"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb633-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb633-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb633-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb633-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb633-5" title="5"></a>
<a class="sourceLine" id="cb633-6" title="6"><span class="kw">def</span> rank(M):</a>
<a class="sourceLine" id="cb633-7" title="7">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb633-8" title="8"><span class="co">    This function calculates the rank of matrix M using singular value decomposition.</span></a>
<a class="sourceLine" id="cb633-9" title="9"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb633-10" title="10">    U, s, V <span class="op">=</span> np.linalg.svd(M)</a>
<a class="sourceLine" id="cb633-11" title="11">    r <span class="op">=</span> np.<span class="bu">sum</span>(s <span class="op">&gt;</span> <span class="fl">1e-6</span>)</a>
<a class="sourceLine" id="cb633-12" title="12">    <span class="cf">return</span> r</a>
<a class="sourceLine" id="cb633-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb633-14" title="14"></a>
<a class="sourceLine" id="cb633-15" title="15">np.random.seed(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb633-16" title="16">M <span class="op">=</span> np.random.random((<span class="dv">5</span>,<span class="dv">5</span>))</a>
<a class="sourceLine" id="cb633-17" title="17">r <span class="op">=</span> np.linalg.matrix_rank(M)</a>
<a class="sourceLine" id="cb633-18" title="18"></a>
<a class="sourceLine" id="cb633-19" title="19">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(r, rank(M)) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-57">Run 3</h4>
<div class="sourceCode" id="cb635"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb635-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb635-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb635-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb635-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb635-5" title="5"></a>
<a class="sourceLine" id="cb635-6" title="6"><span class="kw">def</span> rank(M):</a>
<a class="sourceLine" id="cb635-7" title="7">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb635-8" title="8"><span class="co">    This function calculates the rank of matrix M using singular value decomposition.</span></a>
<a class="sourceLine" id="cb635-9" title="9"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb635-10" title="10">    U, s, V <span class="op">=</span> np.linalg.svd(M)</a>
<a class="sourceLine" id="cb635-11" title="11">    r <span class="op">=</span> np.<span class="bu">sum</span>(s <span class="op">&gt;</span> <span class="fl">1e-12</span>)</a>
<a class="sourceLine" id="cb635-12" title="12">    <span class="cf">return</span> r</a>
<a class="sourceLine" id="cb635-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb635-14" title="14"></a>
<a class="sourceLine" id="cb635-15" title="15">np.random.seed(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb635-16" title="16">M <span class="op">=</span> np.random.random((<span class="dv">5</span>,<span class="dv">5</span>))</a>
<a class="sourceLine" id="cb635-17" title="17">r <span class="op">=</span> np.linalg.matrix_rank(M)</a>
<a class="sourceLine" id="cb635-18" title="18"></a>
<a class="sourceLine" id="cb635-19" title="19">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(r, rank(M)) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-57">Run 4</h4>
<div class="sourceCode" id="cb637"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb637-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb637-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb637-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb637-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb637-5" title="5"></a>
<a class="sourceLine" id="cb637-6" title="6"><span class="kw">def</span> rank(M):</a>
<a class="sourceLine" id="cb637-7" title="7">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb637-8" title="8"><span class="co">    This function calculates the rank of matrix M using singular value decomposition.</span></a>
<a class="sourceLine" id="cb637-9" title="9"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb637-10" title="10">    U, s, V <span class="op">=</span> np.linalg.svd(M)</a>
<a class="sourceLine" id="cb637-11" title="11">    r <span class="op">=</span> np.<span class="bu">sum</span>(s <span class="op">&gt;</span> <span class="fl">1e-12</span>)</a>
<a class="sourceLine" id="cb637-12" title="12">    <span class="cf">return</span> r</a>
<a class="sourceLine" id="cb637-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb637-14" title="14"></a>
<a class="sourceLine" id="cb637-15" title="15">np.random.seed(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb637-16" title="16">M <span class="op">=</span> np.random.random((<span class="dv">5</span>,<span class="dv">5</span>))</a>
<a class="sourceLine" id="cb637-17" title="17">r <span class="op">=</span> np.linalg.matrix_rank(M)</a>
<a class="sourceLine" id="cb637-18" title="18"></a>
<a class="sourceLine" id="cb637-19" title="19">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(r, rank(M)) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>remove-water-ch</summary></p>
<h4 id="query-58">Query</h4>
<div class="sourceCode" id="cb639"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb639-1" title="1"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb639-2" title="2"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb639-3" title="3"></a>
<a class="sourceLine" id="cb639-4" title="4"><span class="kw">def</span> remove_water(traj_file,top_file):</a>
<a class="sourceLine" id="cb639-5" title="5">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb639-6" title="6"><span class="co">  这个函数从加载的动力学轨迹文件traj_file和拓扑文件top_file中移除溶剂分子，返回新的动力学轨迹文件</span></a>
<a class="sourceLine" id="cb639-7" title="7"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb639-8" title="8">  [insert]</a>
<a class="sourceLine" id="cb639-9" title="9">  <span class="cf">return</span> new_traj</a></code></pre></div>
<h4 id="run-0-58">Run 0</h4>
<div class="sourceCode" id="cb640"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb640-1" title="1"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb640-2" title="2"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb640-3" title="3"></a>
<a class="sourceLine" id="cb640-4" title="4"><span class="kw">def</span> remove_water(traj_file,top_file):</a>
<a class="sourceLine" id="cb640-5" title="5">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb640-6" title="6"><span class="co">  这个函数从加载的动力学轨迹文件traj_file和拓扑文件top_file中移除溶剂分子，返回新的动力学轨迹文件</span></a>
<a class="sourceLine" id="cb640-7" title="7"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb640-8" title="8">  traj <span class="op">=</span> md.load(traj_file,top<span class="op">=</span>top_file)</a>
<a class="sourceLine" id="cb640-9" title="9">  topology <span class="op">=</span> traj.topology</a>
<a class="sourceLine" id="cb640-10" title="10">  atom_indices <span class="op">=</span> topology.select(<span class="st">&#39;not water&#39;</span>)</a>
<a class="sourceLine" id="cb640-11" title="11">  new_traj <span class="op">=</span> traj.atom_slice(atom_indices)</a>
<a class="sourceLine" id="cb640-12" title="12">  <span class="cf">return</span> new_traj</a>
<a class="sourceLine" id="cb640-13" title="13"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb640-14" title="14"><span class="im">import</span> mdtraj <span class="im">as</span> md </a>
<a class="sourceLine" id="cb640-15" title="15"></a>
<a class="sourceLine" id="cb640-16" title="16">traj <span class="op">=</span> md.load(os.path.join(_FILE_DIR_,<span class="st">&#39;trp-cage-small.trr&#39;</span>), top<span class="op">=</span>os.path.join(_FILE_DIR_,<span class="st">&#39;trp-cage.pdb&#39;</span>))</a>
<a class="sourceLine" id="cb640-17" title="17">nowater <span class="op">=</span> traj.remove_solvent()</a>
<a class="sourceLine" id="cb640-18" title="18">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> remove_water(os.path.join(_FILE_DIR_,<span class="st">&#39;trp-cage-small.trr&#39;</span>),os.path.join(_FILE_DIR_,<span class="st">&#39;trp-cage.pdb&#39;</span>)).n_atoms <span class="op">==</span> nowater.n_atoms <span class="cf">else</span> <span class="va">False</span> </a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-58">Run 1</h4>
<div class="sourceCode" id="cb642"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb642-1" title="1"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb642-2" title="2"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb642-3" title="3"></a>
<a class="sourceLine" id="cb642-4" title="4"><span class="kw">def</span> remove_water(traj_file,top_file):</a>
<a class="sourceLine" id="cb642-5" title="5">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb642-6" title="6"><span class="co">  这个函数从加载的动力学轨迹文件traj_file和拓扑文件top_file中移除溶剂分子，返回新的动力学轨迹文件</span></a>
<a class="sourceLine" id="cb642-7" title="7"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb642-8" title="8">  traj <span class="op">=</span> md.load(traj_file,top<span class="op">=</span>top_file)</a>
<a class="sourceLine" id="cb642-9" title="9">  top <span class="op">=</span> traj.topology</a>
<a class="sourceLine" id="cb642-10" title="10">  new_traj <span class="op">=</span> md.Trajectory(np.zeros((traj.n_frames,top.n_atoms<span class="op">-</span>top.n_residues,<span class="dv">3</span>)),traj.topology)</a>
<a class="sourceLine" id="cb642-11" title="11">  <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(traj.n_frames):</a>
<a class="sourceLine" id="cb642-12" title="12">    new_traj[i] <span class="op">=</span> traj[i].atom_slice(top.select(<span class="st">&#39;not water&#39;</span>))</a>
<a class="sourceLine" id="cb642-13" title="13">  <span class="cf">return</span> new_traj</a>
<a class="sourceLine" id="cb642-14" title="14"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb642-15" title="15"><span class="im">import</span> mdtraj <span class="im">as</span> md </a>
<a class="sourceLine" id="cb642-16" title="16"></a>
<a class="sourceLine" id="cb642-17" title="17">traj <span class="op">=</span> md.load(os.path.join(_FILE_DIR_,<span class="st">&#39;trp-cage-small.trr&#39;</span>), top<span class="op">=</span>os.path.join(_FILE_DIR_,<span class="st">&#39;trp-cage.pdb&#39;</span>))</a>
<a class="sourceLine" id="cb642-18" title="18">nowater <span class="op">=</span> traj.remove_solvent()</a>
<a class="sourceLine" id="cb642-19" title="19">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> remove_water(os.path.join(_FILE_DIR_,<span class="st">&#39;trp-cage-small.trr&#39;</span>),os.path.join(_FILE_DIR_,<span class="st">&#39;trp-cage.pdb&#39;</span>)).n_atoms <span class="op">==</span> nowater.n_atoms <span class="cf">else</span> <span class="va">False</span> </a></code></pre></div>
<p>Output:</p>
<pre><code>xyz must be shape (Any, 9362, 3). You supplied  (200, 6316, 3)</code></pre>
<h4 id="run-2-58">Run 2</h4>
<div class="sourceCode" id="cb644"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb644-1" title="1"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb644-2" title="2"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb644-3" title="3"></a>
<a class="sourceLine" id="cb644-4" title="4"><span class="kw">def</span> remove_water(traj_file,top_file):</a>
<a class="sourceLine" id="cb644-5" title="5">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb644-6" title="6"><span class="co">  这个函数从加载的动力学轨迹文件traj_file和拓扑文件top_file中移除溶剂分子，返回新的动力学轨迹文件</span></a>
<a class="sourceLine" id="cb644-7" title="7"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb644-8" title="8">  traj <span class="op">=</span> md.load(traj_file,top<span class="op">=</span>top_file)</a>
<a class="sourceLine" id="cb644-9" title="9">  top <span class="op">=</span> traj.topology</a>
<a class="sourceLine" id="cb644-10" title="10">  new_traj <span class="op">=</span> traj.atom_slice(top.select(<span class="st">&#39;not water&#39;</span>))</a>
<a class="sourceLine" id="cb644-11" title="11">  <span class="cf">return</span> new_traj</a>
<a class="sourceLine" id="cb644-12" title="12"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb644-13" title="13"><span class="im">import</span> mdtraj <span class="im">as</span> md </a>
<a class="sourceLine" id="cb644-14" title="14"></a>
<a class="sourceLine" id="cb644-15" title="15">traj <span class="op">=</span> md.load(os.path.join(_FILE_DIR_,<span class="st">&#39;trp-cage-small.trr&#39;</span>), top<span class="op">=</span>os.path.join(_FILE_DIR_,<span class="st">&#39;trp-cage.pdb&#39;</span>))</a>
<a class="sourceLine" id="cb644-16" title="16">nowater <span class="op">=</span> traj.remove_solvent()</a>
<a class="sourceLine" id="cb644-17" title="17">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> remove_water(os.path.join(_FILE_DIR_,<span class="st">&#39;trp-cage-small.trr&#39;</span>),os.path.join(_FILE_DIR_,<span class="st">&#39;trp-cage.pdb&#39;</span>)).n_atoms <span class="op">==</span> nowater.n_atoms <span class="cf">else</span> <span class="va">False</span> </a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-58">Run 3</h4>
<div class="sourceCode" id="cb646"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb646-1" title="1"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb646-2" title="2"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb646-3" title="3"></a>
<a class="sourceLine" id="cb646-4" title="4"><span class="kw">def</span> remove_water(traj_file,top_file):</a>
<a class="sourceLine" id="cb646-5" title="5">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb646-6" title="6"><span class="co">  这个函数从加载的动力学轨迹文件traj_file和拓扑文件top_file中移除溶剂分子，返回新的动力学轨迹文件</span></a>
<a class="sourceLine" id="cb646-7" title="7"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb646-8" title="8">  traj <span class="op">=</span> md.load(traj_file,top<span class="op">=</span>top_file)</a>
<a class="sourceLine" id="cb646-9" title="9">  topology <span class="op">=</span> traj.topology</a>
<a class="sourceLine" id="cb646-10" title="10">  atom_indices <span class="op">=</span> [a.index <span class="cf">for</span> a <span class="kw">in</span> topology.atoms <span class="cf">if</span> a.residue.is_water <span class="op">==</span> <span class="va">False</span>]</a>
<a class="sourceLine" id="cb646-11" title="11">  new_traj <span class="op">=</span> traj.atom_slice(atom_indices)</a>
<a class="sourceLine" id="cb646-12" title="12">  <span class="cf">return</span> new_traj</a>
<a class="sourceLine" id="cb646-13" title="13"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb646-14" title="14"><span class="im">import</span> mdtraj <span class="im">as</span> md </a>
<a class="sourceLine" id="cb646-15" title="15"></a>
<a class="sourceLine" id="cb646-16" title="16">traj <span class="op">=</span> md.load(os.path.join(_FILE_DIR_,<span class="st">&#39;trp-cage-small.trr&#39;</span>), top<span class="op">=</span>os.path.join(_FILE_DIR_,<span class="st">&#39;trp-cage.pdb&#39;</span>))</a>
<a class="sourceLine" id="cb646-17" title="17">nowater <span class="op">=</span> traj.remove_solvent()</a>
<a class="sourceLine" id="cb646-18" title="18">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> remove_water(os.path.join(_FILE_DIR_,<span class="st">&#39;trp-cage-small.trr&#39;</span>),os.path.join(_FILE_DIR_,<span class="st">&#39;trp-cage.pdb&#39;</span>)).n_atoms <span class="op">==</span> nowater.n_atoms <span class="cf">else</span> <span class="va">False</span> </a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-58">Run 4</h4>
<div class="sourceCode" id="cb648"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb648-1" title="1"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb648-2" title="2"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb648-3" title="3"></a>
<a class="sourceLine" id="cb648-4" title="4"><span class="kw">def</span> remove_water(traj_file,top_file):</a>
<a class="sourceLine" id="cb648-5" title="5">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb648-6" title="6"><span class="co">  这个函数从加载的动力学轨迹文件traj_file和拓扑文件top_file中移除溶剂分子，返回新的动力学轨迹文件</span></a>
<a class="sourceLine" id="cb648-7" title="7"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb648-8" title="8">  traj <span class="op">=</span> md.load(traj_file,top<span class="op">=</span>top_file)</a>
<a class="sourceLine" id="cb648-9" title="9">  topology <span class="op">=</span> traj.topology</a>
<a class="sourceLine" id="cb648-10" title="10">  new_traj <span class="op">=</span> md.Trajectory(np.zeros((traj.n_frames,topology.n_atoms,<span class="dv">3</span>)),topology)</a>
<a class="sourceLine" id="cb648-11" title="11">  <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(traj.n_frames):</a>
<a class="sourceLine" id="cb648-12" title="12">    <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(topology.n_atoms):</a>
<a class="sourceLine" id="cb648-13" title="13">      <span class="cf">if</span> topology.atom(j).residue.name <span class="op">!=</span> <span class="st">&#39;HOH&#39;</span>:</a>
<a class="sourceLine" id="cb648-14" title="14">        new_traj[i,j,:] <span class="op">=</span> traj[i,j,:]</a>
<a class="sourceLine" id="cb648-15" title="15">  <span class="cf">return</span> new_traj</a>
<a class="sourceLine" id="cb648-16" title="16"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb648-17" title="17"><span class="im">import</span> mdtraj <span class="im">as</span> md </a>
<a class="sourceLine" id="cb648-18" title="18"></a>
<a class="sourceLine" id="cb648-19" title="19">traj <span class="op">=</span> md.load(os.path.join(_FILE_DIR_,<span class="st">&#39;trp-cage-small.trr&#39;</span>), top<span class="op">=</span>os.path.join(_FILE_DIR_,<span class="st">&#39;trp-cage.pdb&#39;</span>))</a>
<a class="sourceLine" id="cb648-20" title="20">nowater <span class="op">=</span> traj.remove_solvent()</a>
<a class="sourceLine" id="cb648-21" title="21">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> remove_water(os.path.join(_FILE_DIR_,<span class="st">&#39;trp-cage-small.trr&#39;</span>),os.path.join(_FILE_DIR_,<span class="st">&#39;trp-cage.pdb&#39;</span>)).n_atoms <span class="op">==</span> nowater.n_atoms <span class="cf">else</span> <span class="va">False</span> </a></code></pre></div>
<p>Output:</p>
<pre><code>too many indices for array: array is 1-dimensional, but 3 were indexed</code></pre>
</details>
<details>
<p><summary>remove-water</summary></p>
<h4 id="query-59">Query</h4>
<div class="sourceCode" id="cb650"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb650-1" title="1"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb650-2" title="2"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb650-3" title="3"></a>
<a class="sourceLine" id="cb650-4" title="4"><span class="kw">def</span> remove_water(traj_file,top_file):</a>
<a class="sourceLine" id="cb650-5" title="5">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb650-6" title="6"><span class="co">  This function removes solvent from loaded trajectory traj_file and topology in top_file to return the new trajctory</span></a>
<a class="sourceLine" id="cb650-7" title="7"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb650-8" title="8">  [insert]</a>
<a class="sourceLine" id="cb650-9" title="9">  <span class="cf">return</span> new_traj</a></code></pre></div>
<h4 id="run-0-59">Run 0</h4>
<div class="sourceCode" id="cb651"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb651-1" title="1"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb651-2" title="2"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb651-3" title="3"></a>
<a class="sourceLine" id="cb651-4" title="4"><span class="kw">def</span> remove_water(traj_file,top_file):</a>
<a class="sourceLine" id="cb651-5" title="5">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb651-6" title="6"><span class="co">  This function removes solvent from loaded trajectory traj_file and topology in top_file to return the new trajctory</span></a>
<a class="sourceLine" id="cb651-7" title="7"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb651-8" title="8">  traj <span class="op">=</span> md.load(traj_file,top<span class="op">=</span>top_file)</a>
<a class="sourceLine" id="cb651-9" title="9">  top <span class="op">=</span> traj.topology</a>
<a class="sourceLine" id="cb651-10" title="10">  new_traj <span class="op">=</span> traj.atom_slice(top.select(<span class="st">&#39;not water&#39;</span>))</a>
<a class="sourceLine" id="cb651-11" title="11">  <span class="cf">return</span> new_traj</a>
<a class="sourceLine" id="cb651-12" title="12"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb651-13" title="13"><span class="im">import</span> mdtraj <span class="im">as</span> md </a>
<a class="sourceLine" id="cb651-14" title="14"></a>
<a class="sourceLine" id="cb651-15" title="15">traj <span class="op">=</span> md.load(os.path.join(_FILE_DIR_,<span class="st">&#39;trp-cage-small.trr&#39;</span>), top<span class="op">=</span>os.path.join(_FILE_DIR_,<span class="st">&#39;trp-cage.pdb&#39;</span>))</a>
<a class="sourceLine" id="cb651-16" title="16">nowater <span class="op">=</span> traj.remove_solvent()</a>
<a class="sourceLine" id="cb651-17" title="17">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> remove_water(os.path.join(_FILE_DIR_,<span class="st">&#39;trp-cage-small.trr&#39;</span>),os.path.join(_FILE_DIR_,<span class="st">&#39;trp-cage.pdb&#39;</span>)).n_atoms <span class="op">==</span> nowater.n_atoms <span class="cf">else</span> <span class="va">False</span> </a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-59">Run 1</h4>
<div class="sourceCode" id="cb653"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb653-1" title="1"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb653-2" title="2"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb653-3" title="3"></a>
<a class="sourceLine" id="cb653-4" title="4"><span class="kw">def</span> remove_water(traj_file,top_file):</a>
<a class="sourceLine" id="cb653-5" title="5">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb653-6" title="6"><span class="co">  This function removes solvent from loaded trajectory traj_file and topology in top_file to return the new trajctory</span></a>
<a class="sourceLine" id="cb653-7" title="7"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb653-8" title="8">  traj <span class="op">=</span> md.load(traj_file,top<span class="op">=</span>top_file)</a>
<a class="sourceLine" id="cb653-9" title="9">  new_traj <span class="op">=</span> traj.atom_slice(traj.topology.select(<span class="st">&#39;not water&#39;</span>))</a>
<a class="sourceLine" id="cb653-10" title="10">  <span class="cf">return</span> new_traj</a>
<a class="sourceLine" id="cb653-11" title="11"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb653-12" title="12"><span class="im">import</span> mdtraj <span class="im">as</span> md </a>
<a class="sourceLine" id="cb653-13" title="13"></a>
<a class="sourceLine" id="cb653-14" title="14">traj <span class="op">=</span> md.load(os.path.join(_FILE_DIR_,<span class="st">&#39;trp-cage-small.trr&#39;</span>), top<span class="op">=</span>os.path.join(_FILE_DIR_,<span class="st">&#39;trp-cage.pdb&#39;</span>))</a>
<a class="sourceLine" id="cb653-15" title="15">nowater <span class="op">=</span> traj.remove_solvent()</a>
<a class="sourceLine" id="cb653-16" title="16">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> remove_water(os.path.join(_FILE_DIR_,<span class="st">&#39;trp-cage-small.trr&#39;</span>),os.path.join(_FILE_DIR_,<span class="st">&#39;trp-cage.pdb&#39;</span>)).n_atoms <span class="op">==</span> nowater.n_atoms <span class="cf">else</span> <span class="va">False</span> </a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-59">Run 2</h4>
<div class="sourceCode" id="cb655"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb655-1" title="1"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb655-2" title="2"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb655-3" title="3"></a>
<a class="sourceLine" id="cb655-4" title="4"><span class="kw">def</span> remove_water(traj_file,top_file):</a>
<a class="sourceLine" id="cb655-5" title="5">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb655-6" title="6"><span class="co">  This function removes solvent from loaded trajectory traj_file and topology in top_file to return the new trajctory</span></a>
<a class="sourceLine" id="cb655-7" title="7"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb655-8" title="8">  traj <span class="op">=</span> md.load(traj_file,top<span class="op">=</span>top_file)</a>
<a class="sourceLine" id="cb655-9" title="9">  top <span class="op">=</span> traj.topology</a>
<a class="sourceLine" id="cb655-10" title="10">  new_traj <span class="op">=</span> traj.atom_slice(top.select(<span class="st">&#39;not water&#39;</span>))</a>
<a class="sourceLine" id="cb655-11" title="11">  <span class="cf">return</span> new_traj</a>
<a class="sourceLine" id="cb655-12" title="12"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb655-13" title="13"><span class="im">import</span> mdtraj <span class="im">as</span> md </a>
<a class="sourceLine" id="cb655-14" title="14"></a>
<a class="sourceLine" id="cb655-15" title="15">traj <span class="op">=</span> md.load(os.path.join(_FILE_DIR_,<span class="st">&#39;trp-cage-small.trr&#39;</span>), top<span class="op">=</span>os.path.join(_FILE_DIR_,<span class="st">&#39;trp-cage.pdb&#39;</span>))</a>
<a class="sourceLine" id="cb655-16" title="16">nowater <span class="op">=</span> traj.remove_solvent()</a>
<a class="sourceLine" id="cb655-17" title="17">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> remove_water(os.path.join(_FILE_DIR_,<span class="st">&#39;trp-cage-small.trr&#39;</span>),os.path.join(_FILE_DIR_,<span class="st">&#39;trp-cage.pdb&#39;</span>)).n_atoms <span class="op">==</span> nowater.n_atoms <span class="cf">else</span> <span class="va">False</span> </a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-59">Run 3</h4>
<div class="sourceCode" id="cb657"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb657-1" title="1"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb657-2" title="2"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb657-3" title="3"></a>
<a class="sourceLine" id="cb657-4" title="4"><span class="kw">def</span> remove_water(traj_file,top_file):</a>
<a class="sourceLine" id="cb657-5" title="5">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb657-6" title="6"><span class="co">  This function removes solvent from loaded trajectory traj_file and topology in top_file to return the new trajctory</span></a>
<a class="sourceLine" id="cb657-7" title="7"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb657-8" title="8">  traj <span class="op">=</span> md.load(traj_file,top<span class="op">=</span>top_file)</a>
<a class="sourceLine" id="cb657-9" title="9">  top <span class="op">=</span> traj.topology</a>
<a class="sourceLine" id="cb657-10" title="10">  new_traj <span class="op">=</span> traj.atom_slice(top.select(<span class="st">&quot;not water&quot;</span>))</a>
<a class="sourceLine" id="cb657-11" title="11">  <span class="cf">return</span> new_traj</a>
<a class="sourceLine" id="cb657-12" title="12"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb657-13" title="13"><span class="im">import</span> mdtraj <span class="im">as</span> md </a>
<a class="sourceLine" id="cb657-14" title="14"></a>
<a class="sourceLine" id="cb657-15" title="15">traj <span class="op">=</span> md.load(os.path.join(_FILE_DIR_,<span class="st">&#39;trp-cage-small.trr&#39;</span>), top<span class="op">=</span>os.path.join(_FILE_DIR_,<span class="st">&#39;trp-cage.pdb&#39;</span>))</a>
<a class="sourceLine" id="cb657-16" title="16">nowater <span class="op">=</span> traj.remove_solvent()</a>
<a class="sourceLine" id="cb657-17" title="17">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> remove_water(os.path.join(_FILE_DIR_,<span class="st">&#39;trp-cage-small.trr&#39;</span>),os.path.join(_FILE_DIR_,<span class="st">&#39;trp-cage.pdb&#39;</span>)).n_atoms <span class="op">==</span> nowater.n_atoms <span class="cf">else</span> <span class="va">False</span> </a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-59">Run 4</h4>
<div class="sourceCode" id="cb659"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb659-1" title="1"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb659-2" title="2"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb659-3" title="3"></a>
<a class="sourceLine" id="cb659-4" title="4"><span class="kw">def</span> remove_water(traj_file,top_file):</a>
<a class="sourceLine" id="cb659-5" title="5">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb659-6" title="6"><span class="co">  This function removes solvent from loaded trajectory traj_file and topology in top_file to return the new trajctory</span></a>
<a class="sourceLine" id="cb659-7" title="7"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb659-8" title="8">  traj <span class="op">=</span> md.load(traj_file,top<span class="op">=</span>top_file)</a>
<a class="sourceLine" id="cb659-9" title="9">  top <span class="op">=</span> traj.topology</a>
<a class="sourceLine" id="cb659-10" title="10">  new_traj <span class="op">=</span> traj.atom_slice(top.select(<span class="st">&#39;not water&#39;</span>))</a>
<a class="sourceLine" id="cb659-11" title="11">  <span class="cf">return</span> new_traj</a>
<a class="sourceLine" id="cb659-12" title="12"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb659-13" title="13"><span class="im">import</span> mdtraj <span class="im">as</span> md </a>
<a class="sourceLine" id="cb659-14" title="14"></a>
<a class="sourceLine" id="cb659-15" title="15">traj <span class="op">=</span> md.load(os.path.join(_FILE_DIR_,<span class="st">&#39;trp-cage-small.trr&#39;</span>), top<span class="op">=</span>os.path.join(_FILE_DIR_,<span class="st">&#39;trp-cage.pdb&#39;</span>))</a>
<a class="sourceLine" id="cb659-16" title="16">nowater <span class="op">=</span> traj.remove_solvent()</a>
<a class="sourceLine" id="cb659-17" title="17">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> remove_water(os.path.join(_FILE_DIR_,<span class="st">&#39;trp-cage-small.trr&#39;</span>),os.path.join(_FILE_DIR_,<span class="st">&#39;trp-cage.pdb&#39;</span>)).n_atoms <span class="op">==</span> nowater.n_atoms <span class="cf">else</span> <span class="va">False</span> </a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>rmse-ch</summary></p>
<h4 id="query-60">Query</h4>
<div class="sourceCode" id="cb661"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb661-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb661-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb661-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb661-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb661-5" title="5"></a>
<a class="sourceLine" id="cb661-6" title="6"><span class="kw">def</span> rmse(a,b):</a>
<a class="sourceLine" id="cb661-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb661-8" title="8"><span class="co">  这个函数计算a和b之间的均方根误差</span></a>
<a class="sourceLine" id="cb661-9" title="9"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb661-10" title="10">  [insert]</a>
<a class="sourceLine" id="cb661-11" title="11">  <span class="cf">return</span> e</a></code></pre></div>
<h4 id="run-0-60">Run 0</h4>
<div class="sourceCode" id="cb662"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb662-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb662-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb662-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb662-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb662-5" title="5"></a>
<a class="sourceLine" id="cb662-6" title="6"><span class="kw">def</span> rmse(a,b):</a>
<a class="sourceLine" id="cb662-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb662-8" title="8"><span class="co">  这个函数计算a和b之间的均方根误差</span></a>
<a class="sourceLine" id="cb662-9" title="9"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb662-10" title="10">  e <span class="op">=</span> np.sqrt(np.mean((a<span class="op">-</span>b)<span class="op">**</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb662-11" title="11">  <span class="cf">return</span> e</a>
<a class="sourceLine" id="cb662-12" title="12"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb662-13" title="13"></a>
<a class="sourceLine" id="cb662-14" title="14">np.random.seed(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb662-15" title="15">M <span class="op">=</span> <span class="dv">100</span></a>
<a class="sourceLine" id="cb662-16" title="16">predictions <span class="op">=</span> np.random.normal(loc<span class="op">=</span><span class="dv">10</span>, scale<span class="op">=</span><span class="dv">3</span>, size<span class="op">=</span>(M,))</a>
<a class="sourceLine" id="cb662-17" title="17">targets <span class="op">=</span> np.random.normal(loc<span class="op">=</span><span class="dv">9</span>, scale<span class="op">=</span><span class="dv">2</span>, size<span class="op">=</span>(M,))</a>
<a class="sourceLine" id="cb662-18" title="18"></a>
<a class="sourceLine" id="cb662-19" title="19">rmse <span class="op">=</span> np.sqrt(((predictions <span class="op">-</span> targets) <span class="op">**</span> <span class="dv">2</span>).mean())</a>
<a class="sourceLine" id="cb662-20" title="20">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(rmse, <span class="fl">3.61350</span>) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-60">Run 1</h4>
<div class="sourceCode" id="cb664"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb664-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb664-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb664-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb664-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb664-5" title="5"></a>
<a class="sourceLine" id="cb664-6" title="6"><span class="kw">def</span> rmse(a,b):</a>
<a class="sourceLine" id="cb664-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb664-8" title="8"><span class="co">  这个函数计算a和b之间的均方根误差</span></a>
<a class="sourceLine" id="cb664-9" title="9"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb664-10" title="10">  e <span class="op">=</span> np.sqrt(np.mean((a<span class="op">-</span>b)<span class="op">**</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb664-11" title="11">  <span class="cf">return</span> e</a>
<a class="sourceLine" id="cb664-12" title="12"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb664-13" title="13"></a>
<a class="sourceLine" id="cb664-14" title="14">np.random.seed(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb664-15" title="15">M <span class="op">=</span> <span class="dv">100</span></a>
<a class="sourceLine" id="cb664-16" title="16">predictions <span class="op">=</span> np.random.normal(loc<span class="op">=</span><span class="dv">10</span>, scale<span class="op">=</span><span class="dv">3</span>, size<span class="op">=</span>(M,))</a>
<a class="sourceLine" id="cb664-17" title="17">targets <span class="op">=</span> np.random.normal(loc<span class="op">=</span><span class="dv">9</span>, scale<span class="op">=</span><span class="dv">2</span>, size<span class="op">=</span>(M,))</a>
<a class="sourceLine" id="cb664-18" title="18"></a>
<a class="sourceLine" id="cb664-19" title="19">rmse <span class="op">=</span> np.sqrt(((predictions <span class="op">-</span> targets) <span class="op">**</span> <span class="dv">2</span>).mean())</a>
<a class="sourceLine" id="cb664-20" title="20">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(rmse, <span class="fl">3.61350</span>) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-60">Run 2</h4>
<div class="sourceCode" id="cb666"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb666-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb666-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb666-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb666-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb666-5" title="5"></a>
<a class="sourceLine" id="cb666-6" title="6"><span class="kw">def</span> rmse(a,b):</a>
<a class="sourceLine" id="cb666-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb666-8" title="8"><span class="co">  这个函数计算a和b之间的均方根误差</span></a>
<a class="sourceLine" id="cb666-9" title="9"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb666-10" title="10">  e <span class="op">=</span> np.sqrt(np.mean((a<span class="op">-</span>b)<span class="op">**</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb666-11" title="11">  <span class="cf">return</span> e</a>
<a class="sourceLine" id="cb666-12" title="12"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb666-13" title="13"></a>
<a class="sourceLine" id="cb666-14" title="14">np.random.seed(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb666-15" title="15">M <span class="op">=</span> <span class="dv">100</span></a>
<a class="sourceLine" id="cb666-16" title="16">predictions <span class="op">=</span> np.random.normal(loc<span class="op">=</span><span class="dv">10</span>, scale<span class="op">=</span><span class="dv">3</span>, size<span class="op">=</span>(M,))</a>
<a class="sourceLine" id="cb666-17" title="17">targets <span class="op">=</span> np.random.normal(loc<span class="op">=</span><span class="dv">9</span>, scale<span class="op">=</span><span class="dv">2</span>, size<span class="op">=</span>(M,))</a>
<a class="sourceLine" id="cb666-18" title="18"></a>
<a class="sourceLine" id="cb666-19" title="19">rmse <span class="op">=</span> np.sqrt(((predictions <span class="op">-</span> targets) <span class="op">**</span> <span class="dv">2</span>).mean())</a>
<a class="sourceLine" id="cb666-20" title="20">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(rmse, <span class="fl">3.61350</span>) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-60">Run 3</h4>
<div class="sourceCode" id="cb668"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb668-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb668-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb668-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb668-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb668-5" title="5"></a>
<a class="sourceLine" id="cb668-6" title="6"><span class="kw">def</span> rmse(a,b):</a>
<a class="sourceLine" id="cb668-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb668-8" title="8"><span class="co">  这个函数计算a和b之间的均方根误差</span></a>
<a class="sourceLine" id="cb668-9" title="9"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb668-10" title="10">  e <span class="op">=</span> np.sqrt(np.mean((a<span class="op">-</span>b)<span class="op">**</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb668-11" title="11">  <span class="cf">return</span> e</a>
<a class="sourceLine" id="cb668-12" title="12"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb668-13" title="13"></a>
<a class="sourceLine" id="cb668-14" title="14">np.random.seed(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb668-15" title="15">M <span class="op">=</span> <span class="dv">100</span></a>
<a class="sourceLine" id="cb668-16" title="16">predictions <span class="op">=</span> np.random.normal(loc<span class="op">=</span><span class="dv">10</span>, scale<span class="op">=</span><span class="dv">3</span>, size<span class="op">=</span>(M,))</a>
<a class="sourceLine" id="cb668-17" title="17">targets <span class="op">=</span> np.random.normal(loc<span class="op">=</span><span class="dv">9</span>, scale<span class="op">=</span><span class="dv">2</span>, size<span class="op">=</span>(M,))</a>
<a class="sourceLine" id="cb668-18" title="18"></a>
<a class="sourceLine" id="cb668-19" title="19">rmse <span class="op">=</span> np.sqrt(((predictions <span class="op">-</span> targets) <span class="op">**</span> <span class="dv">2</span>).mean())</a>
<a class="sourceLine" id="cb668-20" title="20">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(rmse, <span class="fl">3.61350</span>) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-60">Run 4</h4>
<div class="sourceCode" id="cb670"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb670-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb670-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb670-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb670-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb670-5" title="5"></a>
<a class="sourceLine" id="cb670-6" title="6"><span class="kw">def</span> rmse(a,b):</a>
<a class="sourceLine" id="cb670-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb670-8" title="8"><span class="co">  这个函数计算a和b之间的均方根误差</span></a>
<a class="sourceLine" id="cb670-9" title="9"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb670-10" title="10">  e <span class="op">=</span> np.sqrt(np.mean((a<span class="op">-</span>b)<span class="op">**</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb670-11" title="11">  <span class="cf">return</span> e</a>
<a class="sourceLine" id="cb670-12" title="12"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb670-13" title="13"></a>
<a class="sourceLine" id="cb670-14" title="14">np.random.seed(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb670-15" title="15">M <span class="op">=</span> <span class="dv">100</span></a>
<a class="sourceLine" id="cb670-16" title="16">predictions <span class="op">=</span> np.random.normal(loc<span class="op">=</span><span class="dv">10</span>, scale<span class="op">=</span><span class="dv">3</span>, size<span class="op">=</span>(M,))</a>
<a class="sourceLine" id="cb670-17" title="17">targets <span class="op">=</span> np.random.normal(loc<span class="op">=</span><span class="dv">9</span>, scale<span class="op">=</span><span class="dv">2</span>, size<span class="op">=</span>(M,))</a>
<a class="sourceLine" id="cb670-18" title="18"></a>
<a class="sourceLine" id="cb670-19" title="19">rmse <span class="op">=</span> np.sqrt(((predictions <span class="op">-</span> targets) <span class="op">**</span> <span class="dv">2</span>).mean())</a>
<a class="sourceLine" id="cb670-20" title="20">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(rmse, <span class="fl">3.61350</span>) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>rmse</summary></p>
<h4 id="query-61">Query</h4>
<div class="sourceCode" id="cb672"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb672-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb672-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb672-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb672-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb672-5" title="5"></a>
<a class="sourceLine" id="cb672-6" title="6"><span class="kw">def</span> rmse(a,b):</a>
<a class="sourceLine" id="cb672-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb672-8" title="8"><span class="co">  This function evaluates the root mean square error (rmse) between a and b.</span></a>
<a class="sourceLine" id="cb672-9" title="9"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb672-10" title="10">  [insert]</a>
<a class="sourceLine" id="cb672-11" title="11">  <span class="cf">return</span> e</a></code></pre></div>
<h4 id="run-0-61">Run 0</h4>
<div class="sourceCode" id="cb673"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb673-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb673-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb673-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb673-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb673-5" title="5"></a>
<a class="sourceLine" id="cb673-6" title="6"><span class="kw">def</span> rmse(a,b):</a>
<a class="sourceLine" id="cb673-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb673-8" title="8"><span class="co">  This function evaluates the root mean square error (rmse) between a and b.</span></a>
<a class="sourceLine" id="cb673-9" title="9"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb673-10" title="10">  e <span class="op">=</span> np.sqrt(np.mean((a<span class="op">-</span>b)<span class="op">**</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb673-11" title="11">  <span class="cf">return</span> e</a>
<a class="sourceLine" id="cb673-12" title="12"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb673-13" title="13"></a>
<a class="sourceLine" id="cb673-14" title="14">np.random.seed(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb673-15" title="15">M <span class="op">=</span> <span class="dv">100</span></a>
<a class="sourceLine" id="cb673-16" title="16">predictions <span class="op">=</span> np.random.normal(loc<span class="op">=</span><span class="dv">10</span>, scale<span class="op">=</span><span class="dv">3</span>, size<span class="op">=</span>(M,))</a>
<a class="sourceLine" id="cb673-17" title="17">targets <span class="op">=</span> np.random.normal(loc<span class="op">=</span><span class="dv">9</span>, scale<span class="op">=</span><span class="dv">2</span>, size<span class="op">=</span>(M,))</a>
<a class="sourceLine" id="cb673-18" title="18"></a>
<a class="sourceLine" id="cb673-19" title="19">test_rmse <span class="op">=</span> np.sqrt(((predictions <span class="op">-</span> targets) <span class="op">**</span> <span class="dv">2</span>).mean())</a>
<a class="sourceLine" id="cb673-20" title="20">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(rmse(predictions, targets), test_rmse) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-61">Run 1</h4>
<div class="sourceCode" id="cb675"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb675-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb675-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb675-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb675-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb675-5" title="5"></a>
<a class="sourceLine" id="cb675-6" title="6"><span class="kw">def</span> rmse(a,b):</a>
<a class="sourceLine" id="cb675-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb675-8" title="8"><span class="co">  This function evaluates the root mean square error (rmse) between a and b.</span></a>
<a class="sourceLine" id="cb675-9" title="9"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb675-10" title="10">  e <span class="op">=</span> np.sqrt(np.mean((a<span class="op">-</span>b)<span class="op">**</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb675-11" title="11">  <span class="cf">return</span> e</a>
<a class="sourceLine" id="cb675-12" title="12"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb675-13" title="13"></a>
<a class="sourceLine" id="cb675-14" title="14">np.random.seed(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb675-15" title="15">M <span class="op">=</span> <span class="dv">100</span></a>
<a class="sourceLine" id="cb675-16" title="16">predictions <span class="op">=</span> np.random.normal(loc<span class="op">=</span><span class="dv">10</span>, scale<span class="op">=</span><span class="dv">3</span>, size<span class="op">=</span>(M,))</a>
<a class="sourceLine" id="cb675-17" title="17">targets <span class="op">=</span> np.random.normal(loc<span class="op">=</span><span class="dv">9</span>, scale<span class="op">=</span><span class="dv">2</span>, size<span class="op">=</span>(M,))</a>
<a class="sourceLine" id="cb675-18" title="18"></a>
<a class="sourceLine" id="cb675-19" title="19">test_rmse <span class="op">=</span> np.sqrt(((predictions <span class="op">-</span> targets) <span class="op">**</span> <span class="dv">2</span>).mean())</a>
<a class="sourceLine" id="cb675-20" title="20">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(rmse(predictions, targets), test_rmse) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-61">Run 2</h4>
<div class="sourceCode" id="cb677"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb677-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb677-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb677-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb677-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb677-5" title="5"></a>
<a class="sourceLine" id="cb677-6" title="6"><span class="kw">def</span> rmse(a,b):</a>
<a class="sourceLine" id="cb677-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb677-8" title="8"><span class="co">  This function evaluates the root mean square error (rmse) between a and b.</span></a>
<a class="sourceLine" id="cb677-9" title="9"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb677-10" title="10">  e <span class="op">=</span> np.sqrt(np.<span class="bu">sum</span>((a<span class="op">-</span>b)<span class="op">**</span><span class="dv">2</span>)<span class="op">/</span>a.size)</a>
<a class="sourceLine" id="cb677-11" title="11">  <span class="cf">return</span> e</a>
<a class="sourceLine" id="cb677-12" title="12"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb677-13" title="13"></a>
<a class="sourceLine" id="cb677-14" title="14">np.random.seed(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb677-15" title="15">M <span class="op">=</span> <span class="dv">100</span></a>
<a class="sourceLine" id="cb677-16" title="16">predictions <span class="op">=</span> np.random.normal(loc<span class="op">=</span><span class="dv">10</span>, scale<span class="op">=</span><span class="dv">3</span>, size<span class="op">=</span>(M,))</a>
<a class="sourceLine" id="cb677-17" title="17">targets <span class="op">=</span> np.random.normal(loc<span class="op">=</span><span class="dv">9</span>, scale<span class="op">=</span><span class="dv">2</span>, size<span class="op">=</span>(M,))</a>
<a class="sourceLine" id="cb677-18" title="18"></a>
<a class="sourceLine" id="cb677-19" title="19">test_rmse <span class="op">=</span> np.sqrt(((predictions <span class="op">-</span> targets) <span class="op">**</span> <span class="dv">2</span>).mean())</a>
<a class="sourceLine" id="cb677-20" title="20">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(rmse(predictions, targets), test_rmse) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-61">Run 3</h4>
<div class="sourceCode" id="cb679"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb679-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb679-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb679-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb679-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb679-5" title="5"></a>
<a class="sourceLine" id="cb679-6" title="6"><span class="kw">def</span> rmse(a,b):</a>
<a class="sourceLine" id="cb679-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb679-8" title="8"><span class="co">  This function evaluates the root mean square error (rmse) between a and b.</span></a>
<a class="sourceLine" id="cb679-9" title="9"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb679-10" title="10">  e <span class="op">=</span> np.sqrt(np.mean((a<span class="op">-</span>b)<span class="op">**</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb679-11" title="11">  <span class="cf">return</span> e</a>
<a class="sourceLine" id="cb679-12" title="12"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb679-13" title="13"></a>
<a class="sourceLine" id="cb679-14" title="14">np.random.seed(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb679-15" title="15">M <span class="op">=</span> <span class="dv">100</span></a>
<a class="sourceLine" id="cb679-16" title="16">predictions <span class="op">=</span> np.random.normal(loc<span class="op">=</span><span class="dv">10</span>, scale<span class="op">=</span><span class="dv">3</span>, size<span class="op">=</span>(M,))</a>
<a class="sourceLine" id="cb679-17" title="17">targets <span class="op">=</span> np.random.normal(loc<span class="op">=</span><span class="dv">9</span>, scale<span class="op">=</span><span class="dv">2</span>, size<span class="op">=</span>(M,))</a>
<a class="sourceLine" id="cb679-18" title="18"></a>
<a class="sourceLine" id="cb679-19" title="19">test_rmse <span class="op">=</span> np.sqrt(((predictions <span class="op">-</span> targets) <span class="op">**</span> <span class="dv">2</span>).mean())</a>
<a class="sourceLine" id="cb679-20" title="20">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(rmse(predictions, targets), test_rmse) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-61">Run 4</h4>
<div class="sourceCode" id="cb681"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb681-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb681-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb681-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb681-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb681-5" title="5"></a>
<a class="sourceLine" id="cb681-6" title="6"><span class="kw">def</span> rmse(a,b):</a>
<a class="sourceLine" id="cb681-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb681-8" title="8"><span class="co">  This function evaluates the root mean square error (rmse) between a and b.</span></a>
<a class="sourceLine" id="cb681-9" title="9"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb681-10" title="10">  e <span class="op">=</span> np.sqrt(np.mean((a<span class="op">-</span>b)<span class="op">**</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb681-11" title="11">  <span class="cf">return</span> e</a>
<a class="sourceLine" id="cb681-12" title="12"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb681-13" title="13"></a>
<a class="sourceLine" id="cb681-14" title="14">np.random.seed(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb681-15" title="15">M <span class="op">=</span> <span class="dv">100</span></a>
<a class="sourceLine" id="cb681-16" title="16">predictions <span class="op">=</span> np.random.normal(loc<span class="op">=</span><span class="dv">10</span>, scale<span class="op">=</span><span class="dv">3</span>, size<span class="op">=</span>(M,))</a>
<a class="sourceLine" id="cb681-17" title="17">targets <span class="op">=</span> np.random.normal(loc<span class="op">=</span><span class="dv">9</span>, scale<span class="op">=</span><span class="dv">2</span>, size<span class="op">=</span>(M,))</a>
<a class="sourceLine" id="cb681-18" title="18"></a>
<a class="sourceLine" id="cb681-19" title="19">test_rmse <span class="op">=</span> np.sqrt(((predictions <span class="op">-</span> targets) <span class="op">**</span> <span class="dv">2</span>).mean())</a>
<a class="sourceLine" id="cb681-20" title="20">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(rmse(predictions, targets), test_rmse) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>rog</summary></p>
<h4 id="query-62">Query</h4>
<div class="sourceCode" id="cb683"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb683-1" title="1"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb683-2" title="2"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb683-3" title="3"></a>
<a class="sourceLine" id="cb683-4" title="4"><span class="kw">def</span> protein_radius_of_gyration(pdb_file):</a>
<a class="sourceLine" id="cb683-5" title="5">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb683-6" title="6"><span class="co">  1. This function loads a pdb</span></a>
<a class="sourceLine" id="cb683-7" title="7"><span class="co">  2. Calculates the radius of gyration</span></a>
<a class="sourceLine" id="cb683-8" title="8"><span class="co">  3. Returns it</span></a>
<a class="sourceLine" id="cb683-9" title="9"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb683-10" title="10">  [insert]</a>
<a class="sourceLine" id="cb683-11" title="11">  <span class="cf">return</span> rg</a></code></pre></div>
<h4 id="run-0-62">Run 0</h4>
<div class="sourceCode" id="cb684"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb684-1" title="1"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb684-2" title="2"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb684-3" title="3"></a>
<a class="sourceLine" id="cb684-4" title="4"><span class="kw">def</span> protein_radius_of_gyration(pdb_file):</a>
<a class="sourceLine" id="cb684-5" title="5">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb684-6" title="6"><span class="co">  1. This function loads a pdb</span></a>
<a class="sourceLine" id="cb684-7" title="7"><span class="co">  2. Calculates the radius of gyration</span></a>
<a class="sourceLine" id="cb684-8" title="8"><span class="co">  3. Returns it</span></a>
<a class="sourceLine" id="cb684-9" title="9"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb684-10" title="10">  traj <span class="op">=</span> md.load(pdb_file)</a>
<a class="sourceLine" id="cb684-11" title="11">  rg <span class="op">=</span> md.compute_rg(traj)</a>
<a class="sourceLine" id="cb684-12" title="12">  rg <span class="op">=</span> np.mean(rg)</a>
<a class="sourceLine" id="cb684-13" title="13">  <span class="cf">return</span> rg</a>
<a class="sourceLine" id="cb684-14" title="14"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb684-15" title="15"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb684-16" title="16"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb684-17" title="17"></a>
<a class="sourceLine" id="cb684-18" title="18">pdb_file <span class="op">=</span> os.path.join(_FILE_DIR_,<span class="st">&quot;1VII.pdb&quot;</span>)</a>
<a class="sourceLine" id="cb684-19" title="19"></a>
<a class="sourceLine" id="cb684-20" title="20"><span class="kw">def</span> compute_rg_mdtraj(pdb_file):</a>
<a class="sourceLine" id="cb684-21" title="21">    <span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb684-22" title="22">    pdb <span class="op">=</span> md.load(pdb_file)</a>
<a class="sourceLine" id="cb684-23" title="23">    rg <span class="op">=</span> md.compute_rg(pdb)</a>
<a class="sourceLine" id="cb684-24" title="24">    <span class="cf">return</span> rg</a>
<a class="sourceLine" id="cb684-25" title="25"></a>
<a class="sourceLine" id="cb684-26" title="26">my_rg <span class="op">=</span> compute_rg_mdtraj(pdb_file)</a>
<a class="sourceLine" id="cb684-27" title="27">nlcc_rg <span class="op">=</span> protein_radius_of_gyration(pdb_file)</a>
<a class="sourceLine" id="cb684-28" title="28"></a>
<a class="sourceLine" id="cb684-29" title="29"><span class="co">#print(&quot;My result:&quot;, my_rg)</span></a>
<a class="sourceLine" id="cb684-30" title="30"><span class="co">#print(&quot;nlcc result&quot;, nlcc_rg)</span></a>
<a class="sourceLine" id="cb684-31" title="31"></a>
<a class="sourceLine" id="cb684-32" title="32">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">abs</span>( my_rg <span class="op">-</span> nlcc_rg )<span class="op">&lt;</span><span class="fl">0.1</span> <span class="cf">else</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb684-33" title="33"></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-62">Run 1</h4>
<div class="sourceCode" id="cb686"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb686-1" title="1"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb686-2" title="2"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb686-3" title="3"></a>
<a class="sourceLine" id="cb686-4" title="4"><span class="kw">def</span> protein_radius_of_gyration(pdb_file):</a>
<a class="sourceLine" id="cb686-5" title="5">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb686-6" title="6"><span class="co">  1. This function loads a pdb</span></a>
<a class="sourceLine" id="cb686-7" title="7"><span class="co">  2. Calculates the radius of gyration</span></a>
<a class="sourceLine" id="cb686-8" title="8"><span class="co">  3. Returns it</span></a>
<a class="sourceLine" id="cb686-9" title="9"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb686-10" title="10">  traj <span class="op">=</span> md.load(pdb_file)</a>
<a class="sourceLine" id="cb686-11" title="11">  rg <span class="op">=</span> md.compute_rg(traj)</a>
<a class="sourceLine" id="cb686-12" title="12">  <span class="cf">return</span> rg</a>
<a class="sourceLine" id="cb686-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb686-14" title="14"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb686-15" title="15"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb686-16" title="16"></a>
<a class="sourceLine" id="cb686-17" title="17">pdb_file <span class="op">=</span> os.path.join(_FILE_DIR_,<span class="st">&quot;1VII.pdb&quot;</span>)</a>
<a class="sourceLine" id="cb686-18" title="18"></a>
<a class="sourceLine" id="cb686-19" title="19"><span class="kw">def</span> compute_rg_mdtraj(pdb_file):</a>
<a class="sourceLine" id="cb686-20" title="20">    <span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb686-21" title="21">    pdb <span class="op">=</span> md.load(pdb_file)</a>
<a class="sourceLine" id="cb686-22" title="22">    rg <span class="op">=</span> md.compute_rg(pdb)</a>
<a class="sourceLine" id="cb686-23" title="23">    <span class="cf">return</span> rg</a>
<a class="sourceLine" id="cb686-24" title="24"></a>
<a class="sourceLine" id="cb686-25" title="25">my_rg <span class="op">=</span> compute_rg_mdtraj(pdb_file)</a>
<a class="sourceLine" id="cb686-26" title="26">nlcc_rg <span class="op">=</span> protein_radius_of_gyration(pdb_file)</a>
<a class="sourceLine" id="cb686-27" title="27"></a>
<a class="sourceLine" id="cb686-28" title="28"><span class="co">#print(&quot;My result:&quot;, my_rg)</span></a>
<a class="sourceLine" id="cb686-29" title="29"><span class="co">#print(&quot;nlcc result&quot;, nlcc_rg)</span></a>
<a class="sourceLine" id="cb686-30" title="30"></a>
<a class="sourceLine" id="cb686-31" title="31">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">abs</span>( my_rg <span class="op">-</span> nlcc_rg )<span class="op">&lt;</span><span class="fl">0.1</span> <span class="cf">else</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb686-32" title="32"></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-62">Run 2</h4>
<div class="sourceCode" id="cb688"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb688-1" title="1"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb688-2" title="2"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb688-3" title="3"></a>
<a class="sourceLine" id="cb688-4" title="4"><span class="kw">def</span> protein_radius_of_gyration(pdb_file):</a>
<a class="sourceLine" id="cb688-5" title="5">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb688-6" title="6"><span class="co">  1. This function loads a pdb</span></a>
<a class="sourceLine" id="cb688-7" title="7"><span class="co">  2. Calculates the radius of gyration</span></a>
<a class="sourceLine" id="cb688-8" title="8"><span class="co">  3. Returns it</span></a>
<a class="sourceLine" id="cb688-9" title="9"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb688-10" title="10">  traj <span class="op">=</span> md.load(pdb_file)</a>
<a class="sourceLine" id="cb688-11" title="11">  rg <span class="op">=</span> md.compute_rg(traj)</a>
<a class="sourceLine" id="cb688-12" title="12"></a>
<a class="sourceLine" id="cb688-13" title="13">  <span class="cf">return</span> rg</a>
<a class="sourceLine" id="cb688-14" title="14"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb688-15" title="15"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb688-16" title="16"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb688-17" title="17"></a>
<a class="sourceLine" id="cb688-18" title="18">pdb_file <span class="op">=</span> os.path.join(_FILE_DIR_,<span class="st">&quot;1VII.pdb&quot;</span>)</a>
<a class="sourceLine" id="cb688-19" title="19"></a>
<a class="sourceLine" id="cb688-20" title="20"><span class="kw">def</span> compute_rg_mdtraj(pdb_file):</a>
<a class="sourceLine" id="cb688-21" title="21">    <span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb688-22" title="22">    pdb <span class="op">=</span> md.load(pdb_file)</a>
<a class="sourceLine" id="cb688-23" title="23">    rg <span class="op">=</span> md.compute_rg(pdb)</a>
<a class="sourceLine" id="cb688-24" title="24">    <span class="cf">return</span> rg</a>
<a class="sourceLine" id="cb688-25" title="25"></a>
<a class="sourceLine" id="cb688-26" title="26">my_rg <span class="op">=</span> compute_rg_mdtraj(pdb_file)</a>
<a class="sourceLine" id="cb688-27" title="27">nlcc_rg <span class="op">=</span> protein_radius_of_gyration(pdb_file)</a>
<a class="sourceLine" id="cb688-28" title="28"></a>
<a class="sourceLine" id="cb688-29" title="29"><span class="co">#print(&quot;My result:&quot;, my_rg)</span></a>
<a class="sourceLine" id="cb688-30" title="30"><span class="co">#print(&quot;nlcc result&quot;, nlcc_rg)</span></a>
<a class="sourceLine" id="cb688-31" title="31"></a>
<a class="sourceLine" id="cb688-32" title="32">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">abs</span>( my_rg <span class="op">-</span> nlcc_rg )<span class="op">&lt;</span><span class="fl">0.1</span> <span class="cf">else</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb688-33" title="33"></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-62">Run 3</h4>
<div class="sourceCode" id="cb690"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb690-1" title="1"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb690-2" title="2"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb690-3" title="3"></a>
<a class="sourceLine" id="cb690-4" title="4"><span class="kw">def</span> protein_radius_of_gyration(pdb_file):</a>
<a class="sourceLine" id="cb690-5" title="5">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb690-6" title="6"><span class="co">  1. This function loads a pdb</span></a>
<a class="sourceLine" id="cb690-7" title="7"><span class="co">  2. Calculates the radius of gyration</span></a>
<a class="sourceLine" id="cb690-8" title="8"><span class="co">  3. Returns it</span></a>
<a class="sourceLine" id="cb690-9" title="9"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb690-10" title="10">  traj <span class="op">=</span> md.load(pdb_file)</a>
<a class="sourceLine" id="cb690-11" title="11">  rg <span class="op">=</span> md.compute_rg(traj)</a>
<a class="sourceLine" id="cb690-12" title="12">  rg <span class="op">=</span> np.mean(rg)</a>
<a class="sourceLine" id="cb690-13" title="13">  <span class="cf">return</span> rg</a>
<a class="sourceLine" id="cb690-14" title="14"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb690-15" title="15"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb690-16" title="16"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb690-17" title="17"></a>
<a class="sourceLine" id="cb690-18" title="18">pdb_file <span class="op">=</span> os.path.join(_FILE_DIR_,<span class="st">&quot;1VII.pdb&quot;</span>)</a>
<a class="sourceLine" id="cb690-19" title="19"></a>
<a class="sourceLine" id="cb690-20" title="20"><span class="kw">def</span> compute_rg_mdtraj(pdb_file):</a>
<a class="sourceLine" id="cb690-21" title="21">    <span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb690-22" title="22">    pdb <span class="op">=</span> md.load(pdb_file)</a>
<a class="sourceLine" id="cb690-23" title="23">    rg <span class="op">=</span> md.compute_rg(pdb)</a>
<a class="sourceLine" id="cb690-24" title="24">    <span class="cf">return</span> rg</a>
<a class="sourceLine" id="cb690-25" title="25"></a>
<a class="sourceLine" id="cb690-26" title="26">my_rg <span class="op">=</span> compute_rg_mdtraj(pdb_file)</a>
<a class="sourceLine" id="cb690-27" title="27">nlcc_rg <span class="op">=</span> protein_radius_of_gyration(pdb_file)</a>
<a class="sourceLine" id="cb690-28" title="28"></a>
<a class="sourceLine" id="cb690-29" title="29"><span class="co">#print(&quot;My result:&quot;, my_rg)</span></a>
<a class="sourceLine" id="cb690-30" title="30"><span class="co">#print(&quot;nlcc result&quot;, nlcc_rg)</span></a>
<a class="sourceLine" id="cb690-31" title="31"></a>
<a class="sourceLine" id="cb690-32" title="32">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">abs</span>( my_rg <span class="op">-</span> nlcc_rg )<span class="op">&lt;</span><span class="fl">0.1</span> <span class="cf">else</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb690-33" title="33"></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-62">Run 4</h4>
<div class="sourceCode" id="cb692"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb692-1" title="1"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb692-2" title="2"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb692-3" title="3"></a>
<a class="sourceLine" id="cb692-4" title="4"><span class="kw">def</span> protein_radius_of_gyration(pdb_file):</a>
<a class="sourceLine" id="cb692-5" title="5">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb692-6" title="6"><span class="co">  1. This function loads a pdb</span></a>
<a class="sourceLine" id="cb692-7" title="7"><span class="co">  2. Calculates the radius of gyration</span></a>
<a class="sourceLine" id="cb692-8" title="8"><span class="co">  3. Returns it</span></a>
<a class="sourceLine" id="cb692-9" title="9"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb692-10" title="10">  traj <span class="op">=</span> md.load(pdb_file)</a>
<a class="sourceLine" id="cb692-11" title="11">  rg <span class="op">=</span> md.compute_rg(traj)</a>
<a class="sourceLine" id="cb692-12" title="12"></a>
<a class="sourceLine" id="cb692-13" title="13">  <span class="cf">return</span> rg</a>
<a class="sourceLine" id="cb692-14" title="14"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb692-15" title="15"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb692-16" title="16"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb692-17" title="17"></a>
<a class="sourceLine" id="cb692-18" title="18">pdb_file <span class="op">=</span> os.path.join(_FILE_DIR_,<span class="st">&quot;1VII.pdb&quot;</span>)</a>
<a class="sourceLine" id="cb692-19" title="19"></a>
<a class="sourceLine" id="cb692-20" title="20"><span class="kw">def</span> compute_rg_mdtraj(pdb_file):</a>
<a class="sourceLine" id="cb692-21" title="21">    <span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb692-22" title="22">    pdb <span class="op">=</span> md.load(pdb_file)</a>
<a class="sourceLine" id="cb692-23" title="23">    rg <span class="op">=</span> md.compute_rg(pdb)</a>
<a class="sourceLine" id="cb692-24" title="24">    <span class="cf">return</span> rg</a>
<a class="sourceLine" id="cb692-25" title="25"></a>
<a class="sourceLine" id="cb692-26" title="26">my_rg <span class="op">=</span> compute_rg_mdtraj(pdb_file)</a>
<a class="sourceLine" id="cb692-27" title="27">nlcc_rg <span class="op">=</span> protein_radius_of_gyration(pdb_file)</a>
<a class="sourceLine" id="cb692-28" title="28"></a>
<a class="sourceLine" id="cb692-29" title="29"><span class="co">#print(&quot;My result:&quot;, my_rg)</span></a>
<a class="sourceLine" id="cb692-30" title="30"><span class="co">#print(&quot;nlcc result&quot;, nlcc_rg)</span></a>
<a class="sourceLine" id="cb692-31" title="31"></a>
<a class="sourceLine" id="cb692-32" title="32">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">abs</span>( my_rg <span class="op">-</span> nlcc_rg )<span class="op">&lt;</span><span class="fl">0.1</span> <span class="cf">else</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb692-33" title="33"></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>sasa</summary></p>
<h4 id="query-63">Query</h4>
<div class="sourceCode" id="cb694"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb694-1" title="1"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb694-2" title="2"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb694-3" title="3"></a>
<a class="sourceLine" id="cb694-4" title="4"><span class="kw">def</span> protein_surface_area(pdb_file):</a>
<a class="sourceLine" id="cb694-5" title="5">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb694-6" title="6"><span class="co">  1. This function loads a pdb</span></a>
<a class="sourceLine" id="cb694-7" title="7"><span class="co">  2. Calculates the Solvent Accessible Surface Area (sasa) per residue</span></a>
<a class="sourceLine" id="cb694-8" title="8"><span class="co">  3. Returns it</span></a>
<a class="sourceLine" id="cb694-9" title="9"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb694-10" title="10">  [insert]</a>
<a class="sourceLine" id="cb694-11" title="11">  <span class="cf">return</span> sasa</a></code></pre></div>
<h4 id="run-0-63">Run 0</h4>
<div class="sourceCode" id="cb695"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb695-1" title="1"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb695-2" title="2"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb695-3" title="3"></a>
<a class="sourceLine" id="cb695-4" title="4"><span class="kw">def</span> protein_surface_area(pdb_file):</a>
<a class="sourceLine" id="cb695-5" title="5">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb695-6" title="6"><span class="co">  1. This function loads a pdb</span></a>
<a class="sourceLine" id="cb695-7" title="7"><span class="co">  2. Calculates the Solvent Accessible Surface Area (sasa) per residue</span></a>
<a class="sourceLine" id="cb695-8" title="8"><span class="co">  3. Returns it</span></a>
<a class="sourceLine" id="cb695-9" title="9"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb695-10" title="10">  traj <span class="op">=</span> md.load(pdb_file)</a>
<a class="sourceLine" id="cb695-11" title="11">  sasa <span class="op">=</span> md.shrake_rupley(traj)</a>
<a class="sourceLine" id="cb695-12" title="12">  <span class="cf">return</span> sasa</a>
<a class="sourceLine" id="cb695-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb695-14" title="14"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb695-15" title="15"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb695-16" title="16"></a>
<a class="sourceLine" id="cb695-17" title="17">pdb_file <span class="op">=</span> os.path.join(_FILE_DIR_,<span class="st">&quot;1VII.pdb&quot;</span>)</a>
<a class="sourceLine" id="cb695-18" title="18"></a>
<a class="sourceLine" id="cb695-19" title="19"><span class="kw">def</span> compute_sasa_mdtraj(pdb_file):</a>
<a class="sourceLine" id="cb695-20" title="20">    <span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb695-21" title="21">    pdb <span class="op">=</span> md.load(pdb_file)</a>
<a class="sourceLine" id="cb695-22" title="22">    </a>
<a class="sourceLine" id="cb695-23" title="23">    sasa <span class="op">=</span> md.shrake_rupley(pdb,mode<span class="op">=</span><span class="st">&#39;residue&#39;</span>)</a>
<a class="sourceLine" id="cb695-24" title="24">    <span class="cf">return</span> sasa</a>
<a class="sourceLine" id="cb695-25" title="25"></a>
<a class="sourceLine" id="cb695-26" title="26">my_sasa <span class="op">=</span> compute_sasa_mdtraj(pdb_file)</a>
<a class="sourceLine" id="cb695-27" title="27">nlcc_sasa <span class="op">=</span> protein_surface_area(pdb_file)</a>
<a class="sourceLine" id="cb695-28" title="28"></a>
<a class="sourceLine" id="cb695-29" title="29"><span class="co">#print(&quot;My result:&quot;, my_sasa)</span></a>
<a class="sourceLine" id="cb695-30" title="30"><span class="co">#print(&quot;nlcc result&quot;, nlcc_sasa)</span></a>
<a class="sourceLine" id="cb695-31" title="31"></a>
<a class="sourceLine" id="cb695-32" title="32">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">abs</span>( my_sasa.mean() <span class="op">-</span> nlcc_sasa.mean() )<span class="op">&lt;</span><span class="fl">0.1</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-63">Run 1</h4>
<div class="sourceCode" id="cb697"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb697-1" title="1"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb697-2" title="2"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb697-3" title="3"></a>
<a class="sourceLine" id="cb697-4" title="4"><span class="kw">def</span> protein_surface_area(pdb_file):</a>
<a class="sourceLine" id="cb697-5" title="5">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb697-6" title="6"><span class="co">  1. This function loads a pdb</span></a>
<a class="sourceLine" id="cb697-7" title="7"><span class="co">  2. Calculates the Solvent Accessible Surface Area (sasa) per residue</span></a>
<a class="sourceLine" id="cb697-8" title="8"><span class="co">  3. Returns it</span></a>
<a class="sourceLine" id="cb697-9" title="9"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb697-10" title="10">  traj <span class="op">=</span> md.load(pdb_file)</a>
<a class="sourceLine" id="cb697-11" title="11">  sasa <span class="op">=</span> md.shrake_rupley(traj)</a>
<a class="sourceLine" id="cb697-12" title="12">  sasa <span class="op">=</span> np.<span class="bu">sum</span>(sasa, axis<span class="op">=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb697-13" title="13">  <span class="cf">return</span> sasa</a>
<a class="sourceLine" id="cb697-14" title="14"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb697-15" title="15"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb697-16" title="16"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb697-17" title="17"></a>
<a class="sourceLine" id="cb697-18" title="18">pdb_file <span class="op">=</span> os.path.join(_FILE_DIR_,<span class="st">&quot;1VII.pdb&quot;</span>)</a>
<a class="sourceLine" id="cb697-19" title="19"></a>
<a class="sourceLine" id="cb697-20" title="20"><span class="kw">def</span> compute_sasa_mdtraj(pdb_file):</a>
<a class="sourceLine" id="cb697-21" title="21">    <span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb697-22" title="22">    pdb <span class="op">=</span> md.load(pdb_file)</a>
<a class="sourceLine" id="cb697-23" title="23">    </a>
<a class="sourceLine" id="cb697-24" title="24">    sasa <span class="op">=</span> md.shrake_rupley(pdb,mode<span class="op">=</span><span class="st">&#39;residue&#39;</span>)</a>
<a class="sourceLine" id="cb697-25" title="25">    <span class="cf">return</span> sasa</a>
<a class="sourceLine" id="cb697-26" title="26"></a>
<a class="sourceLine" id="cb697-27" title="27">my_sasa <span class="op">=</span> compute_sasa_mdtraj(pdb_file)</a>
<a class="sourceLine" id="cb697-28" title="28">nlcc_sasa <span class="op">=</span> protein_surface_area(pdb_file)</a>
<a class="sourceLine" id="cb697-29" title="29"></a>
<a class="sourceLine" id="cb697-30" title="30"><span class="co">#print(&quot;My result:&quot;, my_sasa)</span></a>
<a class="sourceLine" id="cb697-31" title="31"><span class="co">#print(&quot;nlcc result&quot;, nlcc_sasa)</span></a>
<a class="sourceLine" id="cb697-32" title="32"></a>
<a class="sourceLine" id="cb697-33" title="33">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">abs</span>( my_sasa.mean() <span class="op">-</span> nlcc_sasa.mean() )<span class="op">&lt;</span><span class="fl">0.1</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-63">Run 2</h4>
<div class="sourceCode" id="cb699"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb699-1" title="1"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb699-2" title="2"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb699-3" title="3"></a>
<a class="sourceLine" id="cb699-4" title="4"><span class="kw">def</span> protein_surface_area(pdb_file):</a>
<a class="sourceLine" id="cb699-5" title="5">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb699-6" title="6"><span class="co">  1. This function loads a pdb</span></a>
<a class="sourceLine" id="cb699-7" title="7"><span class="co">  2. Calculates the Solvent Accessible Surface Area (sasa) per residue</span></a>
<a class="sourceLine" id="cb699-8" title="8"><span class="co">  3. Returns it</span></a>
<a class="sourceLine" id="cb699-9" title="9"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb699-10" title="10">  traj <span class="op">=</span> md.load(pdb_file)</a>
<a class="sourceLine" id="cb699-11" title="11">  sasa <span class="op">=</span> md.shrake_rupley(traj)</a>
<a class="sourceLine" id="cb699-12" title="12">  sasa <span class="op">=</span> np.<span class="bu">sum</span>(sasa, axis<span class="op">=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb699-13" title="13">  <span class="cf">return</span> sasa</a>
<a class="sourceLine" id="cb699-14" title="14"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb699-15" title="15"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb699-16" title="16"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb699-17" title="17"></a>
<a class="sourceLine" id="cb699-18" title="18">pdb_file <span class="op">=</span> os.path.join(_FILE_DIR_,<span class="st">&quot;1VII.pdb&quot;</span>)</a>
<a class="sourceLine" id="cb699-19" title="19"></a>
<a class="sourceLine" id="cb699-20" title="20"><span class="kw">def</span> compute_sasa_mdtraj(pdb_file):</a>
<a class="sourceLine" id="cb699-21" title="21">    <span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb699-22" title="22">    pdb <span class="op">=</span> md.load(pdb_file)</a>
<a class="sourceLine" id="cb699-23" title="23">    </a>
<a class="sourceLine" id="cb699-24" title="24">    sasa <span class="op">=</span> md.shrake_rupley(pdb,mode<span class="op">=</span><span class="st">&#39;residue&#39;</span>)</a>
<a class="sourceLine" id="cb699-25" title="25">    <span class="cf">return</span> sasa</a>
<a class="sourceLine" id="cb699-26" title="26"></a>
<a class="sourceLine" id="cb699-27" title="27">my_sasa <span class="op">=</span> compute_sasa_mdtraj(pdb_file)</a>
<a class="sourceLine" id="cb699-28" title="28">nlcc_sasa <span class="op">=</span> protein_surface_area(pdb_file)</a>
<a class="sourceLine" id="cb699-29" title="29"></a>
<a class="sourceLine" id="cb699-30" title="30"><span class="co">#print(&quot;My result:&quot;, my_sasa)</span></a>
<a class="sourceLine" id="cb699-31" title="31"><span class="co">#print(&quot;nlcc result&quot;, nlcc_sasa)</span></a>
<a class="sourceLine" id="cb699-32" title="32"></a>
<a class="sourceLine" id="cb699-33" title="33">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">abs</span>( my_sasa.mean() <span class="op">-</span> nlcc_sasa.mean() )<span class="op">&lt;</span><span class="fl">0.1</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-63">Run 3</h4>
<div class="sourceCode" id="cb701"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb701-1" title="1"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb701-2" title="2"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb701-3" title="3"></a>
<a class="sourceLine" id="cb701-4" title="4"><span class="kw">def</span> protein_surface_area(pdb_file):</a>
<a class="sourceLine" id="cb701-5" title="5">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb701-6" title="6"><span class="co">  1. This function loads a pdb</span></a>
<a class="sourceLine" id="cb701-7" title="7"><span class="co">  2. Calculates the Solvent Accessible Surface Area (sasa) per residue</span></a>
<a class="sourceLine" id="cb701-8" title="8"><span class="co">  3. Returns it</span></a>
<a class="sourceLine" id="cb701-9" title="9"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb701-10" title="10">  traj <span class="op">=</span> md.load(pdb_file)</a>
<a class="sourceLine" id="cb701-11" title="11">  sasa <span class="op">=</span> md.shrake_rupley(traj)</a>
<a class="sourceLine" id="cb701-12" title="12">  sasa <span class="op">=</span> np.<span class="bu">sum</span>(sasa, axis<span class="op">=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb701-13" title="13">  sasa <span class="op">=</span> np.mean(sasa, axis<span class="op">=</span><span class="dv">0</span>)</a>
<a class="sourceLine" id="cb701-14" title="14">  <span class="cf">return</span> sasa</a>
<a class="sourceLine" id="cb701-15" title="15"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb701-16" title="16"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb701-17" title="17"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb701-18" title="18"></a>
<a class="sourceLine" id="cb701-19" title="19">pdb_file <span class="op">=</span> os.path.join(_FILE_DIR_,<span class="st">&quot;1VII.pdb&quot;</span>)</a>
<a class="sourceLine" id="cb701-20" title="20"></a>
<a class="sourceLine" id="cb701-21" title="21"><span class="kw">def</span> compute_sasa_mdtraj(pdb_file):</a>
<a class="sourceLine" id="cb701-22" title="22">    <span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb701-23" title="23">    pdb <span class="op">=</span> md.load(pdb_file)</a>
<a class="sourceLine" id="cb701-24" title="24">    </a>
<a class="sourceLine" id="cb701-25" title="25">    sasa <span class="op">=</span> md.shrake_rupley(pdb,mode<span class="op">=</span><span class="st">&#39;residue&#39;</span>)</a>
<a class="sourceLine" id="cb701-26" title="26">    <span class="cf">return</span> sasa</a>
<a class="sourceLine" id="cb701-27" title="27"></a>
<a class="sourceLine" id="cb701-28" title="28">my_sasa <span class="op">=</span> compute_sasa_mdtraj(pdb_file)</a>
<a class="sourceLine" id="cb701-29" title="29">nlcc_sasa <span class="op">=</span> protein_surface_area(pdb_file)</a>
<a class="sourceLine" id="cb701-30" title="30"></a>
<a class="sourceLine" id="cb701-31" title="31"><span class="co">#print(&quot;My result:&quot;, my_sasa)</span></a>
<a class="sourceLine" id="cb701-32" title="32"><span class="co">#print(&quot;nlcc result&quot;, nlcc_sasa)</span></a>
<a class="sourceLine" id="cb701-33" title="33"></a>
<a class="sourceLine" id="cb701-34" title="34">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">abs</span>( my_sasa.mean() <span class="op">-</span> nlcc_sasa.mean() )<span class="op">&lt;</span><span class="fl">0.1</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-63">Run 4</h4>
<div class="sourceCode" id="cb703"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb703-1" title="1"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb703-2" title="2"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb703-3" title="3"></a>
<a class="sourceLine" id="cb703-4" title="4"><span class="kw">def</span> protein_surface_area(pdb_file):</a>
<a class="sourceLine" id="cb703-5" title="5">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb703-6" title="6"><span class="co">  1. This function loads a pdb</span></a>
<a class="sourceLine" id="cb703-7" title="7"><span class="co">  2. Calculates the Solvent Accessible Surface Area (sasa) per residue</span></a>
<a class="sourceLine" id="cb703-8" title="8"><span class="co">  3. Returns it</span></a>
<a class="sourceLine" id="cb703-9" title="9"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb703-10" title="10">  traj <span class="op">=</span> md.load(pdb_file)</a>
<a class="sourceLine" id="cb703-11" title="11">  sasa <span class="op">=</span> md.shrake_rupley(traj)</a>
<a class="sourceLine" id="cb703-12" title="12">  <span class="cf">return</span> sasa</a>
<a class="sourceLine" id="cb703-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb703-14" title="14"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb703-15" title="15"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb703-16" title="16"></a>
<a class="sourceLine" id="cb703-17" title="17">pdb_file <span class="op">=</span> os.path.join(_FILE_DIR_,<span class="st">&quot;1VII.pdb&quot;</span>)</a>
<a class="sourceLine" id="cb703-18" title="18"></a>
<a class="sourceLine" id="cb703-19" title="19"><span class="kw">def</span> compute_sasa_mdtraj(pdb_file):</a>
<a class="sourceLine" id="cb703-20" title="20">    <span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb703-21" title="21">    pdb <span class="op">=</span> md.load(pdb_file)</a>
<a class="sourceLine" id="cb703-22" title="22">    </a>
<a class="sourceLine" id="cb703-23" title="23">    sasa <span class="op">=</span> md.shrake_rupley(pdb,mode<span class="op">=</span><span class="st">&#39;residue&#39;</span>)</a>
<a class="sourceLine" id="cb703-24" title="24">    <span class="cf">return</span> sasa</a>
<a class="sourceLine" id="cb703-25" title="25"></a>
<a class="sourceLine" id="cb703-26" title="26">my_sasa <span class="op">=</span> compute_sasa_mdtraj(pdb_file)</a>
<a class="sourceLine" id="cb703-27" title="27">nlcc_sasa <span class="op">=</span> protein_surface_area(pdb_file)</a>
<a class="sourceLine" id="cb703-28" title="28"></a>
<a class="sourceLine" id="cb703-29" title="29"><span class="co">#print(&quot;My result:&quot;, my_sasa)</span></a>
<a class="sourceLine" id="cb703-30" title="30"><span class="co">#print(&quot;nlcc result&quot;, nlcc_sasa)</span></a>
<a class="sourceLine" id="cb703-31" title="31"></a>
<a class="sourceLine" id="cb703-32" title="32">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">abs</span>( my_sasa.mean() <span class="op">-</span> nlcc_sasa.mean() )<span class="op">&lt;</span><span class="fl">0.1</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>scaffold</summary></p>
<h4 id="query-64">Query</h4>
<div class="sourceCode" id="cb705"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb705-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb705-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb705-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb705-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb705-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb705-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb705-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb705-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb705-9" title="9"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb705-10" title="10"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb705-11" title="11"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb705-12" title="12"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb705-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb705-14" title="14"></a>
<a class="sourceLine" id="cb705-15" title="15"><span class="kw">def</span> scaffold(smiles):</a>
<a class="sourceLine" id="cb705-16" title="16">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb705-17" title="17"><span class="co">    Returns Murcko scaffold of given molecule</span></a>
<a class="sourceLine" id="cb705-18" title="18"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb705-19" title="19">    [insert]</a>
<a class="sourceLine" id="cb705-20" title="20">    <span class="cf">return</span> scaffold_smiles</a></code></pre></div>
<h4 id="run-0-64">Run 0</h4>
<div class="sourceCode" id="cb706"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb706-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb706-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb706-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb706-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb706-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb706-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb706-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb706-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb706-9" title="9"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb706-10" title="10"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb706-11" title="11"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb706-12" title="12"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb706-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb706-14" title="14"></a>
<a class="sourceLine" id="cb706-15" title="15"><span class="kw">def</span> scaffold(smiles):</a>
<a class="sourceLine" id="cb706-16" title="16">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb706-17" title="17"><span class="co">    Returns Murcko scaffold of given molecule</span></a>
<a class="sourceLine" id="cb706-18" title="18"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb706-19" title="19">    scaffold_smiles <span class="op">=</span> Scaffolds.MurckoScaffoldSmiles(smiles)</a>
<a class="sourceLine" id="cb706-20" title="20">    <span class="cf">return</span> scaffold_smiles</a>
<a class="sourceLine" id="cb706-21" title="21">smiles <span class="op">=</span> <span class="st">&#39;C1([O-])C=CC=C1NCC[NH+]&#39;</span></a>
<a class="sourceLine" id="cb706-22" title="22">mol <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb706-23" title="23">sc <span class="op">=</span> rdkit.Chem.rdMolHash.MolHash(</a>
<a class="sourceLine" id="cb706-24" title="24">    mol, rdkit.Chem.rdMolHash.HashFunction.MurckoScaffold)</a>
<a class="sourceLine" id="cb706-25" title="25">result <span class="op">=</span> scaffold(smiles) <span class="op">==</span> sc</a></code></pre></div>
<p>Output:</p>
<pre><code>module &#39;rdkit.Chem.Scaffolds&#39; has no attribute &#39;MurckoScaffoldSmiles&#39;</code></pre>
<h4 id="run-1-64">Run 1</h4>
<div class="sourceCode" id="cb708"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb708-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb708-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb708-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb708-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb708-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb708-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb708-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb708-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb708-9" title="9"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb708-10" title="10"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb708-11" title="11"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb708-12" title="12"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb708-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb708-14" title="14"></a>
<a class="sourceLine" id="cb708-15" title="15"><span class="kw">def</span> scaffold(smiles):</a>
<a class="sourceLine" id="cb708-16" title="16">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb708-17" title="17"><span class="co">    Returns Murcko scaffold of given molecule</span></a>
<a class="sourceLine" id="cb708-18" title="18"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb708-19" title="19">    mol <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb708-20" title="20">    scaffold_smiles <span class="op">=</span> Scaffolds.MurckoScaffoldSmiles(mol)</a>
<a class="sourceLine" id="cb708-21" title="21">    <span class="cf">return</span> scaffold_smiles</a>
<a class="sourceLine" id="cb708-22" title="22">smiles <span class="op">=</span> <span class="st">&#39;C1([O-])C=CC=C1NCC[NH+]&#39;</span></a>
<a class="sourceLine" id="cb708-23" title="23">mol <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb708-24" title="24">sc <span class="op">=</span> rdkit.Chem.rdMolHash.MolHash(</a>
<a class="sourceLine" id="cb708-25" title="25">    mol, rdkit.Chem.rdMolHash.HashFunction.MurckoScaffold)</a>
<a class="sourceLine" id="cb708-26" title="26">result <span class="op">=</span> scaffold(smiles) <span class="op">==</span> sc</a></code></pre></div>
<p>Output:</p>
<pre><code>module &#39;rdkit.Chem.Scaffolds&#39; has no attribute &#39;MurckoScaffoldSmiles&#39;</code></pre>
<h4 id="run-2-64">Run 2</h4>
<div class="sourceCode" id="cb710"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb710-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb710-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb710-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb710-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb710-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb710-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb710-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb710-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb710-9" title="9"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb710-10" title="10"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb710-11" title="11"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb710-12" title="12"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb710-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb710-14" title="14"></a>
<a class="sourceLine" id="cb710-15" title="15"><span class="kw">def</span> scaffold(smiles):</a>
<a class="sourceLine" id="cb710-16" title="16">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb710-17" title="17"><span class="co">    Returns Murcko scaffold of given molecule</span></a>
<a class="sourceLine" id="cb710-18" title="18"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb710-19" title="19">    scaffold_smiles <span class="op">=</span> Scaffolds.MurckoScaffoldSmiles(smiles)</a>
<a class="sourceLine" id="cb710-20" title="20">    <span class="cf">return</span> scaffold_smiles</a>
<a class="sourceLine" id="cb710-21" title="21">smiles <span class="op">=</span> <span class="st">&#39;C1([O-])C=CC=C1NCC[NH+]&#39;</span></a>
<a class="sourceLine" id="cb710-22" title="22">mol <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb710-23" title="23">sc <span class="op">=</span> rdkit.Chem.rdMolHash.MolHash(</a>
<a class="sourceLine" id="cb710-24" title="24">    mol, rdkit.Chem.rdMolHash.HashFunction.MurckoScaffold)</a>
<a class="sourceLine" id="cb710-25" title="25">result <span class="op">=</span> scaffold(smiles) <span class="op">==</span> sc</a></code></pre></div>
<p>Output:</p>
<pre><code>module &#39;rdkit.Chem.Scaffolds&#39; has no attribute &#39;MurckoScaffoldSmiles&#39;</code></pre>
<h4 id="run-3-64">Run 3</h4>
<div class="sourceCode" id="cb712"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb712-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb712-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb712-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb712-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb712-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb712-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb712-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb712-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb712-9" title="9"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb712-10" title="10"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb712-11" title="11"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb712-12" title="12"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb712-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb712-14" title="14"></a>
<a class="sourceLine" id="cb712-15" title="15"><span class="kw">def</span> scaffold(smiles):</a>
<a class="sourceLine" id="cb712-16" title="16">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb712-17" title="17"><span class="co">    Returns Murcko scaffold of given molecule</span></a>
<a class="sourceLine" id="cb712-18" title="18"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb712-19" title="19">    scaffold_smiles <span class="op">=</span> Scaffolds.MurckoScaffoldSmiles(smiles)</a>
<a class="sourceLine" id="cb712-20" title="20">    <span class="cf">return</span> scaffold_smiles</a>
<a class="sourceLine" id="cb712-21" title="21">smiles <span class="op">=</span> <span class="st">&#39;C1([O-])C=CC=C1NCC[NH+]&#39;</span></a>
<a class="sourceLine" id="cb712-22" title="22">mol <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb712-23" title="23">sc <span class="op">=</span> rdkit.Chem.rdMolHash.MolHash(</a>
<a class="sourceLine" id="cb712-24" title="24">    mol, rdkit.Chem.rdMolHash.HashFunction.MurckoScaffold)</a>
<a class="sourceLine" id="cb712-25" title="25">result <span class="op">=</span> scaffold(smiles) <span class="op">==</span> sc</a></code></pre></div>
<p>Output:</p>
<pre><code>module &#39;rdkit.Chem.Scaffolds&#39; has no attribute &#39;MurckoScaffoldSmiles&#39;</code></pre>
<h4 id="run-4-64">Run 4</h4>
<div class="sourceCode" id="cb714"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb714-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb714-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb714-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb714-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb714-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb714-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb714-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb714-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb714-9" title="9"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb714-10" title="10"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb714-11" title="11"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb714-12" title="12"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb714-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb714-14" title="14"></a>
<a class="sourceLine" id="cb714-15" title="15"><span class="kw">def</span> scaffold(smiles):</a>
<a class="sourceLine" id="cb714-16" title="16">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb714-17" title="17"><span class="co">    Returns Murcko scaffold of given molecule</span></a>
<a class="sourceLine" id="cb714-18" title="18"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb714-19" title="19">    mol <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb714-20" title="20">    scaffold_smiles <span class="op">=</span> Scaffolds.MurckoScaffoldSmiles(mol)</a>
<a class="sourceLine" id="cb714-21" title="21">    <span class="cf">return</span> scaffold_smiles</a>
<a class="sourceLine" id="cb714-22" title="22">smiles <span class="op">=</span> <span class="st">&#39;C1([O-])C=CC=C1NCC[NH+]&#39;</span></a>
<a class="sourceLine" id="cb714-23" title="23">mol <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb714-24" title="24">sc <span class="op">=</span> rdkit.Chem.rdMolHash.MolHash(</a>
<a class="sourceLine" id="cb714-25" title="25">    mol, rdkit.Chem.rdMolHash.HashFunction.MurckoScaffold)</a>
<a class="sourceLine" id="cb714-26" title="26">result <span class="op">=</span> scaffold(smiles) <span class="op">==</span> sc</a></code></pre></div>
<p>Output:</p>
<pre><code>module &#39;rdkit.Chem.Scaffolds&#39; has no attribute &#39;MurckoScaffoldSmiles&#39;</code></pre>
</details>
<details>
<p><summary>seq-align</summary></p>
<h4 id="query-65">Query</h4>
<div class="sourceCode" id="cb716"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb716-1" title="1"><span class="im">from</span> Bio <span class="im">import</span> SeqIO</a>
<a class="sourceLine" id="cb716-2" title="2"><span class="im">from</span> Bio <span class="im">import</span> Align</a>
<a class="sourceLine" id="cb716-3" title="3"><span class="im">from</span> Bio <span class="im">import</span> PopGen</a>
<a class="sourceLine" id="cb716-4" title="4"><span class="im">from</span> Bio.PDB <span class="im">import</span> <span class="op">*</span></a>
<a class="sourceLine" id="cb716-5" title="5"><span class="im">from</span> Bio.Seq <span class="im">import</span> Seq</a>
<a class="sourceLine" id="cb716-6" title="6"><span class="im">import</span> Bio</a>
<a class="sourceLine" id="cb716-7" title="7"><span class="im">from</span> Bio <span class="im">import</span> pairwise2</a>
<a class="sourceLine" id="cb716-8" title="8"><span class="im">from</span> Bio.Blast <span class="im">import</span> NCBIWWW, NCBIXML</a>
<a class="sourceLine" id="cb716-9" title="9"><span class="im">from</span> Bio.SubsMat <span class="im">import</span> MatrixInfo <span class="im">as</span> matlist</a>
<a class="sourceLine" id="cb716-10" title="10"></a>
<a class="sourceLine" id="cb716-11" title="11"><span class="kw">def</span> align(seq1, seq2):</a>
<a class="sourceLine" id="cb716-12" title="12">    <span class="co">&#39;&#39;&#39;</span></a>
<a class="sourceLine" id="cb716-13" title="13"><span class="co">    Align the two amino acid sequences with BLOSUM62 and return aligned sequences</span></a>
<a class="sourceLine" id="cb716-14" title="14"><span class="co">    &#39;&#39;&#39;</span></a>
<a class="sourceLine" id="cb716-15" title="15">    [insert]</a>
<a class="sourceLine" id="cb716-16" title="16">    <span class="cf">return</span> aligned</a></code></pre></div>
<h4 id="run-0-65">Run 0</h4>
<div class="sourceCode" id="cb717"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb717-1" title="1"><span class="im">from</span> Bio <span class="im">import</span> SeqIO</a>
<a class="sourceLine" id="cb717-2" title="2"><span class="im">from</span> Bio <span class="im">import</span> Align</a>
<a class="sourceLine" id="cb717-3" title="3"><span class="im">from</span> Bio <span class="im">import</span> PopGen</a>
<a class="sourceLine" id="cb717-4" title="4"><span class="im">from</span> Bio.PDB <span class="im">import</span> <span class="op">*</span></a>
<a class="sourceLine" id="cb717-5" title="5"><span class="im">from</span> Bio.Seq <span class="im">import</span> Seq</a>
<a class="sourceLine" id="cb717-6" title="6"><span class="im">import</span> Bio</a>
<a class="sourceLine" id="cb717-7" title="7"><span class="im">from</span> Bio <span class="im">import</span> pairwise2</a>
<a class="sourceLine" id="cb717-8" title="8"><span class="im">from</span> Bio.Blast <span class="im">import</span> NCBIWWW, NCBIXML</a>
<a class="sourceLine" id="cb717-9" title="9"><span class="im">from</span> Bio.SubsMat <span class="im">import</span> MatrixInfo <span class="im">as</span> matlist</a>
<a class="sourceLine" id="cb717-10" title="10"></a>
<a class="sourceLine" id="cb717-11" title="11"><span class="kw">def</span> align(seq1, seq2):</a>
<a class="sourceLine" id="cb717-12" title="12">    <span class="co">&#39;&#39;&#39;</span></a>
<a class="sourceLine" id="cb717-13" title="13"><span class="co">    Align the two amino acid sequences with BLOSUM62 and return aligned sequences</span></a>
<a class="sourceLine" id="cb717-14" title="14"><span class="co">    &#39;&#39;&#39;</span></a>
<a class="sourceLine" id="cb717-15" title="15">    matrix <span class="op">=</span> matlist.blosum62</a>
<a class="sourceLine" id="cb717-16" title="16">    gap_open <span class="op">=</span> <span class="dv">-10</span></a>
<a class="sourceLine" id="cb717-17" title="17">    gap_extend <span class="op">=</span> <span class="fl">-0.5</span></a>
<a class="sourceLine" id="cb717-18" title="18">    alns <span class="op">=</span> pairwise2.align.globalds(seq1, seq2, matrix, gap_open, gap_extend)</a>
<a class="sourceLine" id="cb717-19" title="19">    aligned <span class="op">=</span> pairwise2.format_alignment(<span class="op">*</span>alns[<span class="dv">0</span>])</a>
<a class="sourceLine" id="cb717-20" title="20">    <span class="cf">return</span> aligned</a>
<a class="sourceLine" id="cb717-21" title="21">seq1 <span class="op">=</span> Seq(<span class="st">&#39;EEKG&#39;</span>)</a>
<a class="sourceLine" id="cb717-22" title="22">seq2 <span class="op">=</span> Seq(<span class="st">&#39;SSSDEKA&#39;</span>)</a>
<a class="sourceLine" id="cb717-23" title="23">a <span class="op">=</span> align(seq1, seq2)</a>
<a class="sourceLine" id="cb717-24" title="24">result <span class="op">=</span> a[<span class="dv">0</span>] <span class="op">==</span> <span class="st">&#39;---EEKG&#39;</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-65">Run 1</h4>
<div class="sourceCode" id="cb719"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb719-1" title="1"><span class="im">from</span> Bio <span class="im">import</span> SeqIO</a>
<a class="sourceLine" id="cb719-2" title="2"><span class="im">from</span> Bio <span class="im">import</span> Align</a>
<a class="sourceLine" id="cb719-3" title="3"><span class="im">from</span> Bio <span class="im">import</span> PopGen</a>
<a class="sourceLine" id="cb719-4" title="4"><span class="im">from</span> Bio.PDB <span class="im">import</span> <span class="op">*</span></a>
<a class="sourceLine" id="cb719-5" title="5"><span class="im">from</span> Bio.Seq <span class="im">import</span> Seq</a>
<a class="sourceLine" id="cb719-6" title="6"><span class="im">import</span> Bio</a>
<a class="sourceLine" id="cb719-7" title="7"><span class="im">from</span> Bio <span class="im">import</span> pairwise2</a>
<a class="sourceLine" id="cb719-8" title="8"><span class="im">from</span> Bio.Blast <span class="im">import</span> NCBIWWW, NCBIXML</a>
<a class="sourceLine" id="cb719-9" title="9"><span class="im">from</span> Bio.SubsMat <span class="im">import</span> MatrixInfo <span class="im">as</span> matlist</a>
<a class="sourceLine" id="cb719-10" title="10"></a>
<a class="sourceLine" id="cb719-11" title="11"><span class="kw">def</span> align(seq1, seq2):</a>
<a class="sourceLine" id="cb719-12" title="12">    <span class="co">&#39;&#39;&#39;</span></a>
<a class="sourceLine" id="cb719-13" title="13"><span class="co">    Align the two amino acid sequences with BLOSUM62 and return aligned sequences</span></a>
<a class="sourceLine" id="cb719-14" title="14"><span class="co">    &#39;&#39;&#39;</span></a>
<a class="sourceLine" id="cb719-15" title="15">    matrix <span class="op">=</span> matlist.blosum62</a>
<a class="sourceLine" id="cb719-16" title="16">    gap_open <span class="op">=</span> <span class="dv">-10</span></a>
<a class="sourceLine" id="cb719-17" title="17">    gap_extend <span class="op">=</span> <span class="fl">-0.5</span></a>
<a class="sourceLine" id="cb719-18" title="18">    alns <span class="op">=</span> pairwise2.align.globalds(seq1, seq2, matrix, gap_open, gap_extend)</a>
<a class="sourceLine" id="cb719-19" title="19">    aligned <span class="op">=</span> pairwise2.format_alignment(<span class="op">*</span>alns[<span class="dv">0</span>])</a>
<a class="sourceLine" id="cb719-20" title="20">    <span class="cf">return</span> aligned</a>
<a class="sourceLine" id="cb719-21" title="21">seq1 <span class="op">=</span> Seq(<span class="st">&#39;EEKG&#39;</span>)</a>
<a class="sourceLine" id="cb719-22" title="22">seq2 <span class="op">=</span> Seq(<span class="st">&#39;SSSDEKA&#39;</span>)</a>
<a class="sourceLine" id="cb719-23" title="23">a <span class="op">=</span> align(seq1, seq2)</a>
<a class="sourceLine" id="cb719-24" title="24">result <span class="op">=</span> a[<span class="dv">0</span>] <span class="op">==</span> <span class="st">&#39;---EEKG&#39;</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-65">Run 2</h4>
<div class="sourceCode" id="cb721"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb721-1" title="1"><span class="im">from</span> Bio <span class="im">import</span> SeqIO</a>
<a class="sourceLine" id="cb721-2" title="2"><span class="im">from</span> Bio <span class="im">import</span> Align</a>
<a class="sourceLine" id="cb721-3" title="3"><span class="im">from</span> Bio <span class="im">import</span> PopGen</a>
<a class="sourceLine" id="cb721-4" title="4"><span class="im">from</span> Bio.PDB <span class="im">import</span> <span class="op">*</span></a>
<a class="sourceLine" id="cb721-5" title="5"><span class="im">from</span> Bio.Seq <span class="im">import</span> Seq</a>
<a class="sourceLine" id="cb721-6" title="6"><span class="im">import</span> Bio</a>
<a class="sourceLine" id="cb721-7" title="7"><span class="im">from</span> Bio <span class="im">import</span> pairwise2</a>
<a class="sourceLine" id="cb721-8" title="8"><span class="im">from</span> Bio.Blast <span class="im">import</span> NCBIWWW, NCBIXML</a>
<a class="sourceLine" id="cb721-9" title="9"><span class="im">from</span> Bio.SubsMat <span class="im">import</span> MatrixInfo <span class="im">as</span> matlist</a>
<a class="sourceLine" id="cb721-10" title="10"></a>
<a class="sourceLine" id="cb721-11" title="11"><span class="kw">def</span> align(seq1, seq2):</a>
<a class="sourceLine" id="cb721-12" title="12">    <span class="co">&#39;&#39;&#39;</span></a>
<a class="sourceLine" id="cb721-13" title="13"><span class="co">    Align the two amino acid sequences with BLOSUM62 and return aligned sequences</span></a>
<a class="sourceLine" id="cb721-14" title="14"><span class="co">    &#39;&#39;&#39;</span></a>
<a class="sourceLine" id="cb721-15" title="15">    matrix <span class="op">=</span> matlist.blosum62</a>
<a class="sourceLine" id="cb721-16" title="16">    gap_open <span class="op">=</span> <span class="dv">-10</span></a>
<a class="sourceLine" id="cb721-17" title="17">    gap_extend <span class="op">=</span> <span class="fl">-0.5</span></a>
<a class="sourceLine" id="cb721-18" title="18">    alns <span class="op">=</span> pairwise2.align.globalds(seq1, seq2, matrix, gap_open, gap_extend)</a>
<a class="sourceLine" id="cb721-19" title="19">    aligned <span class="op">=</span> pairwise2.format_alignment(<span class="op">*</span>alns[<span class="dv">0</span>])</a>
<a class="sourceLine" id="cb721-20" title="20">    <span class="cf">return</span> aligned</a>
<a class="sourceLine" id="cb721-21" title="21">seq1 <span class="op">=</span> Seq(<span class="st">&#39;EEKG&#39;</span>)</a>
<a class="sourceLine" id="cb721-22" title="22">seq2 <span class="op">=</span> Seq(<span class="st">&#39;SSSDEKA&#39;</span>)</a>
<a class="sourceLine" id="cb721-23" title="23">a <span class="op">=</span> align(seq1, seq2)</a>
<a class="sourceLine" id="cb721-24" title="24">result <span class="op">=</span> a[<span class="dv">0</span>] <span class="op">==</span> <span class="st">&#39;---EEKG&#39;</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-65">Run 3</h4>
<div class="sourceCode" id="cb723"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb723-1" title="1"><span class="im">from</span> Bio <span class="im">import</span> SeqIO</a>
<a class="sourceLine" id="cb723-2" title="2"><span class="im">from</span> Bio <span class="im">import</span> Align</a>
<a class="sourceLine" id="cb723-3" title="3"><span class="im">from</span> Bio <span class="im">import</span> PopGen</a>
<a class="sourceLine" id="cb723-4" title="4"><span class="im">from</span> Bio.PDB <span class="im">import</span> <span class="op">*</span></a>
<a class="sourceLine" id="cb723-5" title="5"><span class="im">from</span> Bio.Seq <span class="im">import</span> Seq</a>
<a class="sourceLine" id="cb723-6" title="6"><span class="im">import</span> Bio</a>
<a class="sourceLine" id="cb723-7" title="7"><span class="im">from</span> Bio <span class="im">import</span> pairwise2</a>
<a class="sourceLine" id="cb723-8" title="8"><span class="im">from</span> Bio.Blast <span class="im">import</span> NCBIWWW, NCBIXML</a>
<a class="sourceLine" id="cb723-9" title="9"><span class="im">from</span> Bio.SubsMat <span class="im">import</span> MatrixInfo <span class="im">as</span> matlist</a>
<a class="sourceLine" id="cb723-10" title="10"></a>
<a class="sourceLine" id="cb723-11" title="11"><span class="kw">def</span> align(seq1, seq2):</a>
<a class="sourceLine" id="cb723-12" title="12">    <span class="co">&#39;&#39;&#39;</span></a>
<a class="sourceLine" id="cb723-13" title="13"><span class="co">    Align the two amino acid sequences with BLOSUM62 and return aligned sequences</span></a>
<a class="sourceLine" id="cb723-14" title="14"><span class="co">    &#39;&#39;&#39;</span></a>
<a class="sourceLine" id="cb723-15" title="15">    matrix <span class="op">=</span> matlist.blosum62</a>
<a class="sourceLine" id="cb723-16" title="16">    gap_open <span class="op">=</span> <span class="dv">-10</span></a>
<a class="sourceLine" id="cb723-17" title="17">    gap_extend <span class="op">=</span> <span class="fl">-0.5</span></a>
<a class="sourceLine" id="cb723-18" title="18">    alns <span class="op">=</span> pairwise2.align.globalds(seq1, seq2, matrix, gap_open, gap_extend)</a>
<a class="sourceLine" id="cb723-19" title="19">    aligned <span class="op">=</span> pairwise2.format_alignment(<span class="op">*</span>alns[<span class="dv">0</span>])</a>
<a class="sourceLine" id="cb723-20" title="20">    <span class="cf">return</span> aligned</a>
<a class="sourceLine" id="cb723-21" title="21">seq1 <span class="op">=</span> Seq(<span class="st">&#39;EEKG&#39;</span>)</a>
<a class="sourceLine" id="cb723-22" title="22">seq2 <span class="op">=</span> Seq(<span class="st">&#39;SSSDEKA&#39;</span>)</a>
<a class="sourceLine" id="cb723-23" title="23">a <span class="op">=</span> align(seq1, seq2)</a>
<a class="sourceLine" id="cb723-24" title="24">result <span class="op">=</span> a[<span class="dv">0</span>] <span class="op">==</span> <span class="st">&#39;---EEKG&#39;</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-65">Run 4</h4>
<div class="sourceCode" id="cb725"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb725-1" title="1"><span class="im">from</span> Bio <span class="im">import</span> SeqIO</a>
<a class="sourceLine" id="cb725-2" title="2"><span class="im">from</span> Bio <span class="im">import</span> Align</a>
<a class="sourceLine" id="cb725-3" title="3"><span class="im">from</span> Bio <span class="im">import</span> PopGen</a>
<a class="sourceLine" id="cb725-4" title="4"><span class="im">from</span> Bio.PDB <span class="im">import</span> <span class="op">*</span></a>
<a class="sourceLine" id="cb725-5" title="5"><span class="im">from</span> Bio.Seq <span class="im">import</span> Seq</a>
<a class="sourceLine" id="cb725-6" title="6"><span class="im">import</span> Bio</a>
<a class="sourceLine" id="cb725-7" title="7"><span class="im">from</span> Bio <span class="im">import</span> pairwise2</a>
<a class="sourceLine" id="cb725-8" title="8"><span class="im">from</span> Bio.Blast <span class="im">import</span> NCBIWWW, NCBIXML</a>
<a class="sourceLine" id="cb725-9" title="9"><span class="im">from</span> Bio.SubsMat <span class="im">import</span> MatrixInfo <span class="im">as</span> matlist</a>
<a class="sourceLine" id="cb725-10" title="10"></a>
<a class="sourceLine" id="cb725-11" title="11"><span class="kw">def</span> align(seq1, seq2):</a>
<a class="sourceLine" id="cb725-12" title="12">    <span class="co">&#39;&#39;&#39;</span></a>
<a class="sourceLine" id="cb725-13" title="13"><span class="co">    Align the two amino acid sequences with BLOSUM62 and return aligned sequences</span></a>
<a class="sourceLine" id="cb725-14" title="14"><span class="co">    &#39;&#39;&#39;</span></a>
<a class="sourceLine" id="cb725-15" title="15">    matrix <span class="op">=</span> matlist.blosum62</a>
<a class="sourceLine" id="cb725-16" title="16">    gap_open <span class="op">=</span> <span class="dv">-10</span></a>
<a class="sourceLine" id="cb725-17" title="17">    gap_extend <span class="op">=</span> <span class="fl">-0.5</span></a>
<a class="sourceLine" id="cb725-18" title="18">    alns <span class="op">=</span> pairwise2.align.globalds(seq1, seq2, matrix, gap_open, gap_extend)</a>
<a class="sourceLine" id="cb725-19" title="19">    aligned <span class="op">=</span> pairwise2.format_alignment(<span class="op">*</span>alns[<span class="dv">0</span>])</a>
<a class="sourceLine" id="cb725-20" title="20">    <span class="cf">return</span> aligned</a>
<a class="sourceLine" id="cb725-21" title="21">seq1 <span class="op">=</span> Seq(<span class="st">&#39;EEKG&#39;</span>)</a>
<a class="sourceLine" id="cb725-22" title="22">seq2 <span class="op">=</span> Seq(<span class="st">&#39;SSSDEKA&#39;</span>)</a>
<a class="sourceLine" id="cb725-23" title="23">a <span class="op">=</span> align(seq1, seq2)</a>
<a class="sourceLine" id="cb725-24" title="24">result <span class="op">=</span> a[<span class="dv">0</span>] <span class="op">==</span> <span class="st">&#39;---EEKG&#39;</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>seq-trans</summary></p>
<h4 id="query-66">Query</h4>
<div class="sourceCode" id="cb727"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb727-1" title="1"><span class="im">from</span> Bio <span class="im">import</span> SeqIO</a>
<a class="sourceLine" id="cb727-2" title="2"><span class="im">from</span> Bio <span class="im">import</span> Align</a>
<a class="sourceLine" id="cb727-3" title="3"><span class="im">from</span> Bio <span class="im">import</span> PopGen</a>
<a class="sourceLine" id="cb727-4" title="4"><span class="im">from</span> Bio.PDB <span class="im">import</span> <span class="op">*</span></a>
<a class="sourceLine" id="cb727-5" title="5"><span class="im">from</span> Bio.Seq <span class="im">import</span> Seq</a>
<a class="sourceLine" id="cb727-6" title="6"><span class="im">import</span> Bio</a>
<a class="sourceLine" id="cb727-7" title="7"><span class="im">from</span> Bio <span class="im">import</span> pairwise2</a>
<a class="sourceLine" id="cb727-8" title="8"><span class="im">from</span> Bio.Blast <span class="im">import</span> NCBIWWW, NCBIXML</a>
<a class="sourceLine" id="cb727-9" title="9"><span class="im">from</span> Bio.SubsMat <span class="im">import</span> MatrixInfo <span class="im">as</span> matlist</a>
<a class="sourceLine" id="cb727-10" title="10"></a>
<a class="sourceLine" id="cb727-11" title="11"><span class="kw">def</span> nucleotide_translate(gene_seq):</a>
<a class="sourceLine" id="cb727-12" title="12">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb727-13" title="13"><span class="co">  Converts nucleotide sequence to amino acids. Returns a string</span></a>
<a class="sourceLine" id="cb727-14" title="14"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb727-15" title="15">  [insert]</a>
<a class="sourceLine" id="cb727-16" title="16">  <span class="cf">return</span> prot_seq</a></code></pre></div>
<h4 id="run-0-66">Run 0</h4>
<div class="sourceCode" id="cb728"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb728-1" title="1"><span class="im">from</span> Bio <span class="im">import</span> SeqIO</a>
<a class="sourceLine" id="cb728-2" title="2"><span class="im">from</span> Bio <span class="im">import</span> Align</a>
<a class="sourceLine" id="cb728-3" title="3"><span class="im">from</span> Bio <span class="im">import</span> PopGen</a>
<a class="sourceLine" id="cb728-4" title="4"><span class="im">from</span> Bio.PDB <span class="im">import</span> <span class="op">*</span></a>
<a class="sourceLine" id="cb728-5" title="5"><span class="im">from</span> Bio.Seq <span class="im">import</span> Seq</a>
<a class="sourceLine" id="cb728-6" title="6"><span class="im">import</span> Bio</a>
<a class="sourceLine" id="cb728-7" title="7"><span class="im">from</span> Bio <span class="im">import</span> pairwise2</a>
<a class="sourceLine" id="cb728-8" title="8"><span class="im">from</span> Bio.Blast <span class="im">import</span> NCBIWWW, NCBIXML</a>
<a class="sourceLine" id="cb728-9" title="9"><span class="im">from</span> Bio.SubsMat <span class="im">import</span> MatrixInfo <span class="im">as</span> matlist</a>
<a class="sourceLine" id="cb728-10" title="10"></a>
<a class="sourceLine" id="cb728-11" title="11"><span class="kw">def</span> nucleotide_translate(gene_seq):</a>
<a class="sourceLine" id="cb728-12" title="12">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb728-13" title="13"><span class="co">  Converts nucleotide sequence to amino acids. Returns a string</span></a>
<a class="sourceLine" id="cb728-14" title="14"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb728-15" title="15">  prot_seq <span class="op">=</span> Seq(gene_seq).translate()</a>
<a class="sourceLine" id="cb728-16" title="16">  <span class="cf">return</span> prot_seq</a>
<a class="sourceLine" id="cb728-17" title="17">ns <span class="op">=</span> <span class="st">&#39;atgaggtctttgctaatcttggtgctttgcttcctgcccctggctgctctggggaaagtctttggacgatgtgagctggcagcggctatgaagcgtcacggacttgataactatcggggatacagcctgggaaactgggtgtgtgctgcaaaattcgagagtaacttcaacacccaggctacaaaccgtaacaccgatgggagtaccgactacggaatcctacagatcaacagccgctggtggtgcaacgatggcaggaccccaggctccaggaacctgtgcaacatcccgtgctcagccctgctgagctcagacataacagcgagcgtgaactgcgcgaagaagatcgtcagcgatggaaacggcatgaacgcgtgggtcgcctggcgcaaccgctgcaagggcaccgacgtccaggcgtggatcagaggctgccggctgtga&#39;</span></a>
<a class="sourceLine" id="cb728-18" title="18">ps <span class="op">=</span> <span class="st">&#39;MRSLLILVLCFLPLAALGKVFGRCELAAAMKRHGLDNYRGYSLGNWVCAAKFESNFNTQATNRNTDGSTDYGILQINSRWWCNDGRTPGSRNLCNIPCSALLSSDITASVNCAKKIVSDGNGMNAWVAWRNRCKGTDVQAWIRGCRL&#39;</span></a>
<a class="sourceLine" id="cb728-19" title="19">tps <span class="op">=</span> nucleotide_translate(ns)</a>
<a class="sourceLine" id="cb728-20" title="20">result <span class="op">=</span> ps <span class="kw">in</span> tps</a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-66">Run 1</h4>
<div class="sourceCode" id="cb730"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb730-1" title="1"><span class="im">from</span> Bio <span class="im">import</span> SeqIO</a>
<a class="sourceLine" id="cb730-2" title="2"><span class="im">from</span> Bio <span class="im">import</span> Align</a>
<a class="sourceLine" id="cb730-3" title="3"><span class="im">from</span> Bio <span class="im">import</span> PopGen</a>
<a class="sourceLine" id="cb730-4" title="4"><span class="im">from</span> Bio.PDB <span class="im">import</span> <span class="op">*</span></a>
<a class="sourceLine" id="cb730-5" title="5"><span class="im">from</span> Bio.Seq <span class="im">import</span> Seq</a>
<a class="sourceLine" id="cb730-6" title="6"><span class="im">import</span> Bio</a>
<a class="sourceLine" id="cb730-7" title="7"><span class="im">from</span> Bio <span class="im">import</span> pairwise2</a>
<a class="sourceLine" id="cb730-8" title="8"><span class="im">from</span> Bio.Blast <span class="im">import</span> NCBIWWW, NCBIXML</a>
<a class="sourceLine" id="cb730-9" title="9"><span class="im">from</span> Bio.SubsMat <span class="im">import</span> MatrixInfo <span class="im">as</span> matlist</a>
<a class="sourceLine" id="cb730-10" title="10"></a>
<a class="sourceLine" id="cb730-11" title="11"><span class="kw">def</span> nucleotide_translate(gene_seq):</a>
<a class="sourceLine" id="cb730-12" title="12">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb730-13" title="13"><span class="co">  Converts nucleotide sequence to amino acids. Returns a string</span></a>
<a class="sourceLine" id="cb730-14" title="14"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb730-15" title="15">  prot_seq <span class="op">=</span> Seq(gene_seq).translate()</a>
<a class="sourceLine" id="cb730-16" title="16">  <span class="cf">return</span> prot_seq</a>
<a class="sourceLine" id="cb730-17" title="17">ns <span class="op">=</span> <span class="st">&#39;atgaggtctttgctaatcttggtgctttgcttcctgcccctggctgctctggggaaagtctttggacgatgtgagctggcagcggctatgaagcgtcacggacttgataactatcggggatacagcctgggaaactgggtgtgtgctgcaaaattcgagagtaacttcaacacccaggctacaaaccgtaacaccgatgggagtaccgactacggaatcctacagatcaacagccgctggtggtgcaacgatggcaggaccccaggctccaggaacctgtgcaacatcccgtgctcagccctgctgagctcagacataacagcgagcgtgaactgcgcgaagaagatcgtcagcgatggaaacggcatgaacgcgtgggtcgcctggcgcaaccgctgcaagggcaccgacgtccaggcgtggatcagaggctgccggctgtga&#39;</span></a>
<a class="sourceLine" id="cb730-18" title="18">ps <span class="op">=</span> <span class="st">&#39;MRSLLILVLCFLPLAALGKVFGRCELAAAMKRHGLDNYRGYSLGNWVCAAKFESNFNTQATNRNTDGSTDYGILQINSRWWCNDGRTPGSRNLCNIPCSALLSSDITASVNCAKKIVSDGNGMNAWVAWRNRCKGTDVQAWIRGCRL&#39;</span></a>
<a class="sourceLine" id="cb730-19" title="19">tps <span class="op">=</span> nucleotide_translate(ns)</a>
<a class="sourceLine" id="cb730-20" title="20">result <span class="op">=</span> ps <span class="kw">in</span> tps</a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-66">Run 2</h4>
<div class="sourceCode" id="cb732"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb732-1" title="1"><span class="im">from</span> Bio <span class="im">import</span> SeqIO</a>
<a class="sourceLine" id="cb732-2" title="2"><span class="im">from</span> Bio <span class="im">import</span> Align</a>
<a class="sourceLine" id="cb732-3" title="3"><span class="im">from</span> Bio <span class="im">import</span> PopGen</a>
<a class="sourceLine" id="cb732-4" title="4"><span class="im">from</span> Bio.PDB <span class="im">import</span> <span class="op">*</span></a>
<a class="sourceLine" id="cb732-5" title="5"><span class="im">from</span> Bio.Seq <span class="im">import</span> Seq</a>
<a class="sourceLine" id="cb732-6" title="6"><span class="im">import</span> Bio</a>
<a class="sourceLine" id="cb732-7" title="7"><span class="im">from</span> Bio <span class="im">import</span> pairwise2</a>
<a class="sourceLine" id="cb732-8" title="8"><span class="im">from</span> Bio.Blast <span class="im">import</span> NCBIWWW, NCBIXML</a>
<a class="sourceLine" id="cb732-9" title="9"><span class="im">from</span> Bio.SubsMat <span class="im">import</span> MatrixInfo <span class="im">as</span> matlist</a>
<a class="sourceLine" id="cb732-10" title="10"></a>
<a class="sourceLine" id="cb732-11" title="11"><span class="kw">def</span> nucleotide_translate(gene_seq):</a>
<a class="sourceLine" id="cb732-12" title="12">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb732-13" title="13"><span class="co">  Converts nucleotide sequence to amino acids. Returns a string</span></a>
<a class="sourceLine" id="cb732-14" title="14"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb732-15" title="15">  prot_seq <span class="op">=</span> Seq(gene_seq).translate()</a>
<a class="sourceLine" id="cb732-16" title="16">  <span class="cf">return</span> prot_seq</a>
<a class="sourceLine" id="cb732-17" title="17">ns <span class="op">=</span> <span class="st">&#39;atgaggtctttgctaatcttggtgctttgcttcctgcccctggctgctctggggaaagtctttggacgatgtgagctggcagcggctatgaagcgtcacggacttgataactatcggggatacagcctgggaaactgggtgtgtgctgcaaaattcgagagtaacttcaacacccaggctacaaaccgtaacaccgatgggagtaccgactacggaatcctacagatcaacagccgctggtggtgcaacgatggcaggaccccaggctccaggaacctgtgcaacatcccgtgctcagccctgctgagctcagacataacagcgagcgtgaactgcgcgaagaagatcgtcagcgatggaaacggcatgaacgcgtgggtcgcctggcgcaaccgctgcaagggcaccgacgtccaggcgtggatcagaggctgccggctgtga&#39;</span></a>
<a class="sourceLine" id="cb732-18" title="18">ps <span class="op">=</span> <span class="st">&#39;MRSLLILVLCFLPLAALGKVFGRCELAAAMKRHGLDNYRGYSLGNWVCAAKFESNFNTQATNRNTDGSTDYGILQINSRWWCNDGRTPGSRNLCNIPCSALLSSDITASVNCAKKIVSDGNGMNAWVAWRNRCKGTDVQAWIRGCRL&#39;</span></a>
<a class="sourceLine" id="cb732-19" title="19">tps <span class="op">=</span> nucleotide_translate(ns)</a>
<a class="sourceLine" id="cb732-20" title="20">result <span class="op">=</span> ps <span class="kw">in</span> tps</a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-66">Run 3</h4>
<div class="sourceCode" id="cb734"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb734-1" title="1"><span class="im">from</span> Bio <span class="im">import</span> SeqIO</a>
<a class="sourceLine" id="cb734-2" title="2"><span class="im">from</span> Bio <span class="im">import</span> Align</a>
<a class="sourceLine" id="cb734-3" title="3"><span class="im">from</span> Bio <span class="im">import</span> PopGen</a>
<a class="sourceLine" id="cb734-4" title="4"><span class="im">from</span> Bio.PDB <span class="im">import</span> <span class="op">*</span></a>
<a class="sourceLine" id="cb734-5" title="5"><span class="im">from</span> Bio.Seq <span class="im">import</span> Seq</a>
<a class="sourceLine" id="cb734-6" title="6"><span class="im">import</span> Bio</a>
<a class="sourceLine" id="cb734-7" title="7"><span class="im">from</span> Bio <span class="im">import</span> pairwise2</a>
<a class="sourceLine" id="cb734-8" title="8"><span class="im">from</span> Bio.Blast <span class="im">import</span> NCBIWWW, NCBIXML</a>
<a class="sourceLine" id="cb734-9" title="9"><span class="im">from</span> Bio.SubsMat <span class="im">import</span> MatrixInfo <span class="im">as</span> matlist</a>
<a class="sourceLine" id="cb734-10" title="10"></a>
<a class="sourceLine" id="cb734-11" title="11"><span class="kw">def</span> nucleotide_translate(gene_seq):</a>
<a class="sourceLine" id="cb734-12" title="12">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb734-13" title="13"><span class="co">  Converts nucleotide sequence to amino acids. Returns a string</span></a>
<a class="sourceLine" id="cb734-14" title="14"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb734-15" title="15">  prot_seq <span class="op">=</span> Seq(gene_seq).translate()</a>
<a class="sourceLine" id="cb734-16" title="16">  <span class="cf">return</span> prot_seq</a>
<a class="sourceLine" id="cb734-17" title="17">ns <span class="op">=</span> <span class="st">&#39;atgaggtctttgctaatcttggtgctttgcttcctgcccctggctgctctggggaaagtctttggacgatgtgagctggcagcggctatgaagcgtcacggacttgataactatcggggatacagcctgggaaactgggtgtgtgctgcaaaattcgagagtaacttcaacacccaggctacaaaccgtaacaccgatgggagtaccgactacggaatcctacagatcaacagccgctggtggtgcaacgatggcaggaccccaggctccaggaacctgtgcaacatcccgtgctcagccctgctgagctcagacataacagcgagcgtgaactgcgcgaagaagatcgtcagcgatggaaacggcatgaacgcgtgggtcgcctggcgcaaccgctgcaagggcaccgacgtccaggcgtggatcagaggctgccggctgtga&#39;</span></a>
<a class="sourceLine" id="cb734-18" title="18">ps <span class="op">=</span> <span class="st">&#39;MRSLLILVLCFLPLAALGKVFGRCELAAAMKRHGLDNYRGYSLGNWVCAAKFESNFNTQATNRNTDGSTDYGILQINSRWWCNDGRTPGSRNLCNIPCSALLSSDITASVNCAKKIVSDGNGMNAWVAWRNRCKGTDVQAWIRGCRL&#39;</span></a>
<a class="sourceLine" id="cb734-19" title="19">tps <span class="op">=</span> nucleotide_translate(ns)</a>
<a class="sourceLine" id="cb734-20" title="20">result <span class="op">=</span> ps <span class="kw">in</span> tps</a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-66">Run 4</h4>
<div class="sourceCode" id="cb736"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb736-1" title="1"><span class="im">from</span> Bio <span class="im">import</span> SeqIO</a>
<a class="sourceLine" id="cb736-2" title="2"><span class="im">from</span> Bio <span class="im">import</span> Align</a>
<a class="sourceLine" id="cb736-3" title="3"><span class="im">from</span> Bio <span class="im">import</span> PopGen</a>
<a class="sourceLine" id="cb736-4" title="4"><span class="im">from</span> Bio.PDB <span class="im">import</span> <span class="op">*</span></a>
<a class="sourceLine" id="cb736-5" title="5"><span class="im">from</span> Bio.Seq <span class="im">import</span> Seq</a>
<a class="sourceLine" id="cb736-6" title="6"><span class="im">import</span> Bio</a>
<a class="sourceLine" id="cb736-7" title="7"><span class="im">from</span> Bio <span class="im">import</span> pairwise2</a>
<a class="sourceLine" id="cb736-8" title="8"><span class="im">from</span> Bio.Blast <span class="im">import</span> NCBIWWW, NCBIXML</a>
<a class="sourceLine" id="cb736-9" title="9"><span class="im">from</span> Bio.SubsMat <span class="im">import</span> MatrixInfo <span class="im">as</span> matlist</a>
<a class="sourceLine" id="cb736-10" title="10"></a>
<a class="sourceLine" id="cb736-11" title="11"><span class="kw">def</span> nucleotide_translate(gene_seq):</a>
<a class="sourceLine" id="cb736-12" title="12">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb736-13" title="13"><span class="co">  Converts nucleotide sequence to amino acids. Returns a string</span></a>
<a class="sourceLine" id="cb736-14" title="14"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb736-15" title="15">  prot_seq <span class="op">=</span> Seq(gene_seq).translate()</a>
<a class="sourceLine" id="cb736-16" title="16">  <span class="cf">return</span> prot_seq</a>
<a class="sourceLine" id="cb736-17" title="17">ns <span class="op">=</span> <span class="st">&#39;atgaggtctttgctaatcttggtgctttgcttcctgcccctggctgctctggggaaagtctttggacgatgtgagctggcagcggctatgaagcgtcacggacttgataactatcggggatacagcctgggaaactgggtgtgtgctgcaaaattcgagagtaacttcaacacccaggctacaaaccgtaacaccgatgggagtaccgactacggaatcctacagatcaacagccgctggtggtgcaacgatggcaggaccccaggctccaggaacctgtgcaacatcccgtgctcagccctgctgagctcagacataacagcgagcgtgaactgcgcgaagaagatcgtcagcgatggaaacggcatgaacgcgtgggtcgcctggcgcaaccgctgcaagggcaccgacgtccaggcgtggatcagaggctgccggctgtga&#39;</span></a>
<a class="sourceLine" id="cb736-18" title="18">ps <span class="op">=</span> <span class="st">&#39;MRSLLILVLCFLPLAALGKVFGRCELAAAMKRHGLDNYRGYSLGNWVCAAKFESNFNTQATNRNTDGSTDYGILQINSRWWCNDGRTPGSRNLCNIPCSALLSSDITASVNCAKKIVSDGNGMNAWVAWRNRCKGTDVQAWIRGCRL&#39;</span></a>
<a class="sourceLine" id="cb736-19" title="19">tps <span class="op">=</span> nucleotide_translate(ns)</a>
<a class="sourceLine" id="cb736-20" title="20">result <span class="op">=</span> ps <span class="kw">in</span> tps</a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>sequence</summary></p>
<h4 id="query-67">Query</h4>
<div class="sourceCode" id="cb738"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb738-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb738-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb738-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb738-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb738-5" title="5"></a>
<a class="sourceLine" id="cb738-6" title="6"><span class="kw">def</span> gen_geometric_sequence(s,e,l):</a>
<a class="sourceLine" id="cb738-7" title="7">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb738-8" title="8"><span class="co">    This function return a geometric sequence that starts at s, ends at e with length l</span></a>
<a class="sourceLine" id="cb738-9" title="9"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb738-10" title="10">    [insert]</a>
<a class="sourceLine" id="cb738-11" title="11">    <span class="cf">return</span> x</a></code></pre></div>
<h4 id="run-0-67">Run 0</h4>
<div class="sourceCode" id="cb739"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb739-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb739-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb739-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb739-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb739-5" title="5"></a>
<a class="sourceLine" id="cb739-6" title="6"><span class="kw">def</span> gen_geometric_sequence(s,e,l):</a>
<a class="sourceLine" id="cb739-7" title="7">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb739-8" title="8"><span class="co">    This function return a geometric sequence that starts at s, ends at e with length l</span></a>
<a class="sourceLine" id="cb739-9" title="9"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb739-10" title="10">    x <span class="op">=</span> np.logspace(np.log10(s),np.log10(e),l)</a>
<a class="sourceLine" id="cb739-11" title="11">    <span class="cf">return</span> x</a>
<a class="sourceLine" id="cb739-12" title="12">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">all</span>(gen_geometric_sequence(<span class="dv">1</span>,<span class="dv">100</span>,<span class="dv">3</span>)<span class="op">==</span> [<span class="dv">1</span>,<span class="dv">10</span>,<span class="dv">100</span>]) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-67">Run 1</h4>
<div class="sourceCode" id="cb741"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb741-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb741-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb741-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb741-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb741-5" title="5"></a>
<a class="sourceLine" id="cb741-6" title="6"><span class="kw">def</span> gen_geometric_sequence(s,e,l):</a>
<a class="sourceLine" id="cb741-7" title="7">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb741-8" title="8"><span class="co">    This function return a geometric sequence that starts at s, ends at e with length l</span></a>
<a class="sourceLine" id="cb741-9" title="9"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb741-10" title="10">    x <span class="op">=</span> np.zeros(l)</a>
<a class="sourceLine" id="cb741-11" title="11">    x[<span class="dv">0</span>] <span class="op">=</span> s</a>
<a class="sourceLine" id="cb741-12" title="12">    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>,l):</a>
<a class="sourceLine" id="cb741-13" title="13">        x[i] <span class="op">=</span> x[i<span class="dv">-1</span>]<span class="op">*</span>e</a>
<a class="sourceLine" id="cb741-14" title="14">    <span class="cf">return</span> x</a>
<a class="sourceLine" id="cb741-15" title="15">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">all</span>(gen_geometric_sequence(<span class="dv">1</span>,<span class="dv">100</span>,<span class="dv">3</span>)<span class="op">==</span> [<span class="dv">1</span>,<span class="dv">10</span>,<span class="dv">100</span>]) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-67">Run 2</h4>
<div class="sourceCode" id="cb743"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb743-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb743-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb743-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb743-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb743-5" title="5"></a>
<a class="sourceLine" id="cb743-6" title="6"><span class="kw">def</span> gen_geometric_sequence(s,e,l):</a>
<a class="sourceLine" id="cb743-7" title="7">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb743-8" title="8"><span class="co">    This function return a geometric sequence that starts at s, ends at e with length l</span></a>
<a class="sourceLine" id="cb743-9" title="9"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb743-10" title="10">    x <span class="op">=</span> np.logspace(np.log10(s),np.log10(e),l)</a>
<a class="sourceLine" id="cb743-11" title="11">    <span class="cf">return</span> x</a>
<a class="sourceLine" id="cb743-12" title="12">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">all</span>(gen_geometric_sequence(<span class="dv">1</span>,<span class="dv">100</span>,<span class="dv">3</span>)<span class="op">==</span> [<span class="dv">1</span>,<span class="dv">10</span>,<span class="dv">100</span>]) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-67">Run 3</h4>
<div class="sourceCode" id="cb745"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb745-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb745-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb745-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb745-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb745-5" title="5"></a>
<a class="sourceLine" id="cb745-6" title="6"><span class="kw">def</span> gen_geometric_sequence(s,e,l):</a>
<a class="sourceLine" id="cb745-7" title="7">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb745-8" title="8"><span class="co">    This function return a geometric sequence that starts at s, ends at e with length l</span></a>
<a class="sourceLine" id="cb745-9" title="9"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb745-10" title="10">    x <span class="op">=</span> np.zeros(l)</a>
<a class="sourceLine" id="cb745-11" title="11">    x[<span class="dv">0</span>] <span class="op">=</span> s</a>
<a class="sourceLine" id="cb745-12" title="12">    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>,l):</a>
<a class="sourceLine" id="cb745-13" title="13">        x[i] <span class="op">=</span> x[i<span class="dv">-1</span>]<span class="op">*</span>e</a>
<a class="sourceLine" id="cb745-14" title="14"></a>
<a class="sourceLine" id="cb745-15" title="15">    <span class="cf">return</span> x</a>
<a class="sourceLine" id="cb745-16" title="16">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">all</span>(gen_geometric_sequence(<span class="dv">1</span>,<span class="dv">100</span>,<span class="dv">3</span>)<span class="op">==</span> [<span class="dv">1</span>,<span class="dv">10</span>,<span class="dv">100</span>]) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-67">Run 4</h4>
<div class="sourceCode" id="cb747"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb747-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb747-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb747-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb747-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb747-5" title="5"></a>
<a class="sourceLine" id="cb747-6" title="6"><span class="kw">def</span> gen_geometric_sequence(s,e,l):</a>
<a class="sourceLine" id="cb747-7" title="7">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb747-8" title="8"><span class="co">    This function return a geometric sequence that starts at s, ends at e with length l</span></a>
<a class="sourceLine" id="cb747-9" title="9"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb747-10" title="10">    x <span class="op">=</span> np.logspace(np.log10(s),np.log10(e),l)</a>
<a class="sourceLine" id="cb747-11" title="11">    <span class="cf">return</span> x</a>
<a class="sourceLine" id="cb747-12" title="12">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">all</span>(gen_geometric_sequence(<span class="dv">1</span>,<span class="dv">100</span>,<span class="dv">3</span>)<span class="op">==</span> [<span class="dv">1</span>,<span class="dv">10</span>,<span class="dv">100</span>]) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>sle</summary></p>
<h4 id="query-68">Query</h4>
<div class="sourceCode" id="cb749"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb749-1" title="1"><span class="im">import</span> sympy</a>
<a class="sourceLine" id="cb749-2" title="2"></a>
<a class="sourceLine" id="cb749-3" title="3"><span class="kw">def</span> sle(eqns):</a>
<a class="sourceLine" id="cb749-4" title="4">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb749-5" title="5"><span class="co">  This function solves a system of linear equations {[&#39;a_0x_0 + b_0x_1 = c0&#39;,&#39;a_1x_0 + b_1x_1 = c1&#39;]}.</span></a>
<a class="sourceLine" id="cb749-6" title="6"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb749-7" title="7">  [insert]</a>
<a class="sourceLine" id="cb749-8" title="8">  <span class="cf">return</span> x</a></code></pre></div>
<h4 id="run-0-68">Run 0</h4>
<div class="sourceCode" id="cb750"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb750-1" title="1"><span class="im">import</span> sympy</a>
<a class="sourceLine" id="cb750-2" title="2"></a>
<a class="sourceLine" id="cb750-3" title="3"><span class="kw">def</span> sle(eqns):</a>
<a class="sourceLine" id="cb750-4" title="4">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb750-5" title="5"><span class="co">  This function solves a system of linear equations {[&#39;a_0x_0 + b_0x_1 = c0&#39;,&#39;a_1x_0 + b_1x_1 = c1&#39;]}.</span></a>
<a class="sourceLine" id="cb750-6" title="6"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb750-7" title="7">  x <span class="op">=</span> sympy.solve(eqns)</a>
<a class="sourceLine" id="cb750-8" title="8">  <span class="cf">return</span> x</a>
<a class="sourceLine" id="cb750-9" title="9"><span class="im">from</span> sympy <span class="im">import</span> solve, Eq</a>
<a class="sourceLine" id="cb750-10" title="10"><span class="im">from</span> sympy.parsing.sympy_parser <span class="im">import</span> parse_expr</a>
<a class="sourceLine" id="cb750-11" title="11"><span class="im">from</span> sympy.parsing.sympy_parser <span class="im">import</span> standard_transformations, implicit_multiplication_application</a>
<a class="sourceLine" id="cb750-12" title="12"></a>
<a class="sourceLine" id="cb750-13" title="13">eqns <span class="op">=</span> [<span class="st">&#39;4x + 3y = 20&#39;</span>, <span class="st">&#39;-5x + 9y = 26&#39;</span>]</a>
<a class="sourceLine" id="cb750-14" title="14">transformations <span class="op">=</span> (standard_transformations <span class="op">+</span></a>
<a class="sourceLine" id="cb750-15" title="15">                   (implicit_multiplication_application,))</a>
<a class="sourceLine" id="cb750-16" title="16">parsed_eqs <span class="op">=</span> []</a>
<a class="sourceLine" id="cb750-17" title="17"><span class="cf">for</span> eq <span class="kw">in</span> eqns:</a>
<a class="sourceLine" id="cb750-18" title="18">        sides <span class="op">=</span> [parse_expr(s, transformations<span class="op">=</span>transformations)</a>
<a class="sourceLine" id="cb750-19" title="19">                <span class="cf">for</span> s <span class="kw">in</span> eq.split(<span class="st">&#39;=&#39;</span>)]</a>
<a class="sourceLine" id="cb750-20" title="20">        parsed_eqs.append(Eq(sides[<span class="dv">0</span>], sides[<span class="dv">1</span>]))</a>
<a class="sourceLine" id="cb750-21" title="21">soln <span class="op">=</span> solve(parsed_eqs)</a>
<a class="sourceLine" id="cb750-22" title="22">test_sol_values <span class="op">=</span> [soln.get(<span class="bu">list</span>(soln.keys())[<span class="dv">0</span>]), soln.get(<span class="bu">list</span>(soln.keys())[<span class="dv">1</span>])]</a>
<a class="sourceLine" id="cb750-23" title="23"></a>
<a class="sourceLine" id="cb750-24" title="24">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> <span class="bu">list</span>(sle(eqns).values()) <span class="op">==</span> test_sol_values <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Sympify of expression &#39;could not parse &#39;4x + 3y = 20&#39;&#39; failed, because of exception being raised:
SyntaxError: invalid syntax (&lt;string&gt;, line 1)</code></pre>
<h4 id="run-1-68">Run 1</h4>
<div class="sourceCode" id="cb752"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb752-1" title="1"><span class="im">import</span> sympy</a>
<a class="sourceLine" id="cb752-2" title="2"></a>
<a class="sourceLine" id="cb752-3" title="3"><span class="kw">def</span> sle(eqns):</a>
<a class="sourceLine" id="cb752-4" title="4">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb752-5" title="5"><span class="co">  This function solves a system of linear equations {[&#39;a_0x_0 + b_0x_1 = c0&#39;,&#39;a_1x_0 + b_1x_1 = c1&#39;]}.</span></a>
<a class="sourceLine" id="cb752-6" title="6"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb752-7" title="7">  x <span class="op">=</span> sympy.solve(eqns)</a>
<a class="sourceLine" id="cb752-8" title="8">  <span class="cf">return</span> x</a>
<a class="sourceLine" id="cb752-9" title="9"><span class="im">from</span> sympy <span class="im">import</span> solve, Eq</a>
<a class="sourceLine" id="cb752-10" title="10"><span class="im">from</span> sympy.parsing.sympy_parser <span class="im">import</span> parse_expr</a>
<a class="sourceLine" id="cb752-11" title="11"><span class="im">from</span> sympy.parsing.sympy_parser <span class="im">import</span> standard_transformations, implicit_multiplication_application</a>
<a class="sourceLine" id="cb752-12" title="12"></a>
<a class="sourceLine" id="cb752-13" title="13">eqns <span class="op">=</span> [<span class="st">&#39;4x + 3y = 20&#39;</span>, <span class="st">&#39;-5x + 9y = 26&#39;</span>]</a>
<a class="sourceLine" id="cb752-14" title="14">transformations <span class="op">=</span> (standard_transformations <span class="op">+</span></a>
<a class="sourceLine" id="cb752-15" title="15">                   (implicit_multiplication_application,))</a>
<a class="sourceLine" id="cb752-16" title="16">parsed_eqs <span class="op">=</span> []</a>
<a class="sourceLine" id="cb752-17" title="17"><span class="cf">for</span> eq <span class="kw">in</span> eqns:</a>
<a class="sourceLine" id="cb752-18" title="18">        sides <span class="op">=</span> [parse_expr(s, transformations<span class="op">=</span>transformations)</a>
<a class="sourceLine" id="cb752-19" title="19">                <span class="cf">for</span> s <span class="kw">in</span> eq.split(<span class="st">&#39;=&#39;</span>)]</a>
<a class="sourceLine" id="cb752-20" title="20">        parsed_eqs.append(Eq(sides[<span class="dv">0</span>], sides[<span class="dv">1</span>]))</a>
<a class="sourceLine" id="cb752-21" title="21">soln <span class="op">=</span> solve(parsed_eqs)</a>
<a class="sourceLine" id="cb752-22" title="22">test_sol_values <span class="op">=</span> [soln.get(<span class="bu">list</span>(soln.keys())[<span class="dv">0</span>]), soln.get(<span class="bu">list</span>(soln.keys())[<span class="dv">1</span>])]</a>
<a class="sourceLine" id="cb752-23" title="23"></a>
<a class="sourceLine" id="cb752-24" title="24">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> <span class="bu">list</span>(sle(eqns).values()) <span class="op">==</span> test_sol_values <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Sympify of expression &#39;could not parse &#39;4x + 3y = 20&#39;&#39; failed, because of exception being raised:
SyntaxError: invalid syntax (&lt;string&gt;, line 1)</code></pre>
<h4 id="run-2-68">Run 2</h4>
<div class="sourceCode" id="cb754"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb754-1" title="1"><span class="im">import</span> sympy</a>
<a class="sourceLine" id="cb754-2" title="2"></a>
<a class="sourceLine" id="cb754-3" title="3"><span class="kw">def</span> sle(eqns):</a>
<a class="sourceLine" id="cb754-4" title="4">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb754-5" title="5"><span class="co">  This function solves a system of linear equations {[&#39;a_0x_0 + b_0x_1 = c0&#39;,&#39;a_1x_0 + b_1x_1 = c1&#39;]}.</span></a>
<a class="sourceLine" id="cb754-6" title="6"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb754-7" title="7">  x <span class="op">=</span> sympy.solve(eqns)</a>
<a class="sourceLine" id="cb754-8" title="8">  <span class="cf">return</span> x</a>
<a class="sourceLine" id="cb754-9" title="9"><span class="im">from</span> sympy <span class="im">import</span> solve, Eq</a>
<a class="sourceLine" id="cb754-10" title="10"><span class="im">from</span> sympy.parsing.sympy_parser <span class="im">import</span> parse_expr</a>
<a class="sourceLine" id="cb754-11" title="11"><span class="im">from</span> sympy.parsing.sympy_parser <span class="im">import</span> standard_transformations, implicit_multiplication_application</a>
<a class="sourceLine" id="cb754-12" title="12"></a>
<a class="sourceLine" id="cb754-13" title="13">eqns <span class="op">=</span> [<span class="st">&#39;4x + 3y = 20&#39;</span>, <span class="st">&#39;-5x + 9y = 26&#39;</span>]</a>
<a class="sourceLine" id="cb754-14" title="14">transformations <span class="op">=</span> (standard_transformations <span class="op">+</span></a>
<a class="sourceLine" id="cb754-15" title="15">                   (implicit_multiplication_application,))</a>
<a class="sourceLine" id="cb754-16" title="16">parsed_eqs <span class="op">=</span> []</a>
<a class="sourceLine" id="cb754-17" title="17"><span class="cf">for</span> eq <span class="kw">in</span> eqns:</a>
<a class="sourceLine" id="cb754-18" title="18">        sides <span class="op">=</span> [parse_expr(s, transformations<span class="op">=</span>transformations)</a>
<a class="sourceLine" id="cb754-19" title="19">                <span class="cf">for</span> s <span class="kw">in</span> eq.split(<span class="st">&#39;=&#39;</span>)]</a>
<a class="sourceLine" id="cb754-20" title="20">        parsed_eqs.append(Eq(sides[<span class="dv">0</span>], sides[<span class="dv">1</span>]))</a>
<a class="sourceLine" id="cb754-21" title="21">soln <span class="op">=</span> solve(parsed_eqs)</a>
<a class="sourceLine" id="cb754-22" title="22">test_sol_values <span class="op">=</span> [soln.get(<span class="bu">list</span>(soln.keys())[<span class="dv">0</span>]), soln.get(<span class="bu">list</span>(soln.keys())[<span class="dv">1</span>])]</a>
<a class="sourceLine" id="cb754-23" title="23"></a>
<a class="sourceLine" id="cb754-24" title="24">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> <span class="bu">list</span>(sle(eqns).values()) <span class="op">==</span> test_sol_values <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Sympify of expression &#39;could not parse &#39;4x + 3y = 20&#39;&#39; failed, because of exception being raised:
SyntaxError: invalid syntax (&lt;string&gt;, line 1)</code></pre>
<h4 id="run-3-68">Run 3</h4>
<div class="sourceCode" id="cb756"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb756-1" title="1"><span class="im">import</span> sympy</a>
<a class="sourceLine" id="cb756-2" title="2"></a>
<a class="sourceLine" id="cb756-3" title="3"><span class="kw">def</span> sle(eqns):</a>
<a class="sourceLine" id="cb756-4" title="4">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb756-5" title="5"><span class="co">  This function solves a system of linear equations {[&#39;a_0x_0 + b_0x_1 = c0&#39;,&#39;a_1x_0 + b_1x_1 = c1&#39;]}.</span></a>
<a class="sourceLine" id="cb756-6" title="6"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb756-7" title="7">  x <span class="op">=</span> sympy.solve(eqns)</a>
<a class="sourceLine" id="cb756-8" title="8">  <span class="cf">return</span> x</a>
<a class="sourceLine" id="cb756-9" title="9"><span class="im">from</span> sympy <span class="im">import</span> solve, Eq</a>
<a class="sourceLine" id="cb756-10" title="10"><span class="im">from</span> sympy.parsing.sympy_parser <span class="im">import</span> parse_expr</a>
<a class="sourceLine" id="cb756-11" title="11"><span class="im">from</span> sympy.parsing.sympy_parser <span class="im">import</span> standard_transformations, implicit_multiplication_application</a>
<a class="sourceLine" id="cb756-12" title="12"></a>
<a class="sourceLine" id="cb756-13" title="13">eqns <span class="op">=</span> [<span class="st">&#39;4x + 3y = 20&#39;</span>, <span class="st">&#39;-5x + 9y = 26&#39;</span>]</a>
<a class="sourceLine" id="cb756-14" title="14">transformations <span class="op">=</span> (standard_transformations <span class="op">+</span></a>
<a class="sourceLine" id="cb756-15" title="15">                   (implicit_multiplication_application,))</a>
<a class="sourceLine" id="cb756-16" title="16">parsed_eqs <span class="op">=</span> []</a>
<a class="sourceLine" id="cb756-17" title="17"><span class="cf">for</span> eq <span class="kw">in</span> eqns:</a>
<a class="sourceLine" id="cb756-18" title="18">        sides <span class="op">=</span> [parse_expr(s, transformations<span class="op">=</span>transformations)</a>
<a class="sourceLine" id="cb756-19" title="19">                <span class="cf">for</span> s <span class="kw">in</span> eq.split(<span class="st">&#39;=&#39;</span>)]</a>
<a class="sourceLine" id="cb756-20" title="20">        parsed_eqs.append(Eq(sides[<span class="dv">0</span>], sides[<span class="dv">1</span>]))</a>
<a class="sourceLine" id="cb756-21" title="21">soln <span class="op">=</span> solve(parsed_eqs)</a>
<a class="sourceLine" id="cb756-22" title="22">test_sol_values <span class="op">=</span> [soln.get(<span class="bu">list</span>(soln.keys())[<span class="dv">0</span>]), soln.get(<span class="bu">list</span>(soln.keys())[<span class="dv">1</span>])]</a>
<a class="sourceLine" id="cb756-23" title="23"></a>
<a class="sourceLine" id="cb756-24" title="24">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> <span class="bu">list</span>(sle(eqns).values()) <span class="op">==</span> test_sol_values <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Sympify of expression &#39;could not parse &#39;4x + 3y = 20&#39;&#39; failed, because of exception being raised:
SyntaxError: invalid syntax (&lt;string&gt;, line 1)</code></pre>
<h4 id="run-4-68">Run 4</h4>
<div class="sourceCode" id="cb758"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb758-1" title="1"><span class="im">import</span> sympy</a>
<a class="sourceLine" id="cb758-2" title="2"></a>
<a class="sourceLine" id="cb758-3" title="3"><span class="kw">def</span> sle(eqns):</a>
<a class="sourceLine" id="cb758-4" title="4">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb758-5" title="5"><span class="co">  This function solves a system of linear equations {[&#39;a_0x_0 + b_0x_1 = c0&#39;,&#39;a_1x_0 + b_1x_1 = c1&#39;]}.</span></a>
<a class="sourceLine" id="cb758-6" title="6"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb758-7" title="7">  x <span class="op">=</span> sympy.solve(eqns)</a>
<a class="sourceLine" id="cb758-8" title="8">  <span class="cf">return</span> x</a>
<a class="sourceLine" id="cb758-9" title="9"><span class="im">from</span> sympy <span class="im">import</span> solve, Eq</a>
<a class="sourceLine" id="cb758-10" title="10"><span class="im">from</span> sympy.parsing.sympy_parser <span class="im">import</span> parse_expr</a>
<a class="sourceLine" id="cb758-11" title="11"><span class="im">from</span> sympy.parsing.sympy_parser <span class="im">import</span> standard_transformations, implicit_multiplication_application</a>
<a class="sourceLine" id="cb758-12" title="12"></a>
<a class="sourceLine" id="cb758-13" title="13">eqns <span class="op">=</span> [<span class="st">&#39;4x + 3y = 20&#39;</span>, <span class="st">&#39;-5x + 9y = 26&#39;</span>]</a>
<a class="sourceLine" id="cb758-14" title="14">transformations <span class="op">=</span> (standard_transformations <span class="op">+</span></a>
<a class="sourceLine" id="cb758-15" title="15">                   (implicit_multiplication_application,))</a>
<a class="sourceLine" id="cb758-16" title="16">parsed_eqs <span class="op">=</span> []</a>
<a class="sourceLine" id="cb758-17" title="17"><span class="cf">for</span> eq <span class="kw">in</span> eqns:</a>
<a class="sourceLine" id="cb758-18" title="18">        sides <span class="op">=</span> [parse_expr(s, transformations<span class="op">=</span>transformations)</a>
<a class="sourceLine" id="cb758-19" title="19">                <span class="cf">for</span> s <span class="kw">in</span> eq.split(<span class="st">&#39;=&#39;</span>)]</a>
<a class="sourceLine" id="cb758-20" title="20">        parsed_eqs.append(Eq(sides[<span class="dv">0</span>], sides[<span class="dv">1</span>]))</a>
<a class="sourceLine" id="cb758-21" title="21">soln <span class="op">=</span> solve(parsed_eqs)</a>
<a class="sourceLine" id="cb758-22" title="22">test_sol_values <span class="op">=</span> [soln.get(<span class="bu">list</span>(soln.keys())[<span class="dv">0</span>]), soln.get(<span class="bu">list</span>(soln.keys())[<span class="dv">1</span>])]</a>
<a class="sourceLine" id="cb758-23" title="23"></a>
<a class="sourceLine" id="cb758-24" title="24">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> <span class="bu">list</span>(sle(eqns).values()) <span class="op">==</span> test_sol_values <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Sympify of expression &#39;could not parse &#39;4x + 3y = 20&#39;&#39; failed, because of exception being raised:
SyntaxError: invalid syntax (&lt;string&gt;, line 1)</code></pre>
</details>
<details>
<p><summary>spectral_r</summary></p>
<h4 id="query-69">Query</h4>
<div class="sourceCode" id="cb760"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb760-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb760-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb760-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb760-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb760-5" title="5"></a>
<a class="sourceLine" id="cb760-6" title="6"><span class="kw">def</span> spectral_r(a):</a>
<a class="sourceLine" id="cb760-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb760-8" title="8"><span class="co">  This function calculates the spectral radius of the input square matrix a.</span></a>
<a class="sourceLine" id="cb760-9" title="9"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb760-10" title="10">  [insert]</a>
<a class="sourceLine" id="cb760-11" title="11">  <span class="cf">return</span> sradius</a></code></pre></div>
<h4 id="run-0-69">Run 0</h4>
<div class="sourceCode" id="cb761"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb761-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb761-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb761-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb761-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb761-5" title="5"></a>
<a class="sourceLine" id="cb761-6" title="6"><span class="kw">def</span> spectral_r(a):</a>
<a class="sourceLine" id="cb761-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb761-8" title="8"><span class="co">  This function calculates the spectral radius of the input square matrix a.</span></a>
<a class="sourceLine" id="cb761-9" title="9"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb761-10" title="10">  eigval <span class="op">=</span> np.linalg.eigvals(a)</a>
<a class="sourceLine" id="cb761-11" title="11">  sradius <span class="op">=</span> np.<span class="bu">max</span>(np.<span class="bu">abs</span>(eigval))</a>
<a class="sourceLine" id="cb761-12" title="12">  <span class="cf">return</span> sradius</a>
<a class="sourceLine" id="cb761-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb761-14" title="14"></a>
<a class="sourceLine" id="cb761-15" title="15">np.random.seed(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb761-16" title="16">M <span class="op">=</span> <span class="dv">100</span></a>
<a class="sourceLine" id="cb761-17" title="17">a <span class="op">=</span> np.random.normal(loc<span class="op">=</span><span class="dv">10</span>, scale<span class="op">=</span><span class="dv">3</span>, size<span class="op">=</span>(M,M))</a>
<a class="sourceLine" id="cb761-18" title="18">eig <span class="op">=</span> np.linalg.eigvals(a)</a>
<a class="sourceLine" id="cb761-19" title="19">s_r <span class="op">=</span> np.amax(np.absolute(eig))</a>
<a class="sourceLine" id="cb761-20" title="20"></a>
<a class="sourceLine" id="cb761-21" title="21">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(spectral_r(a), s_r) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-69">Run 1</h4>
<div class="sourceCode" id="cb763"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb763-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb763-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb763-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb763-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb763-5" title="5"></a>
<a class="sourceLine" id="cb763-6" title="6"><span class="kw">def</span> spectral_r(a):</a>
<a class="sourceLine" id="cb763-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb763-8" title="8"><span class="co">  This function calculates the spectral radius of the input square matrix a.</span></a>
<a class="sourceLine" id="cb763-9" title="9"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb763-10" title="10">  eigvals <span class="op">=</span> np.linalg.eigvals(a)</a>
<a class="sourceLine" id="cb763-11" title="11">  sradius <span class="op">=</span> np.<span class="bu">max</span>(np.<span class="bu">abs</span>(eigvals))</a>
<a class="sourceLine" id="cb763-12" title="12">  <span class="cf">return</span> sradius</a>
<a class="sourceLine" id="cb763-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb763-14" title="14"></a>
<a class="sourceLine" id="cb763-15" title="15">np.random.seed(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb763-16" title="16">M <span class="op">=</span> <span class="dv">100</span></a>
<a class="sourceLine" id="cb763-17" title="17">a <span class="op">=</span> np.random.normal(loc<span class="op">=</span><span class="dv">10</span>, scale<span class="op">=</span><span class="dv">3</span>, size<span class="op">=</span>(M,M))</a>
<a class="sourceLine" id="cb763-18" title="18">eig <span class="op">=</span> np.linalg.eigvals(a)</a>
<a class="sourceLine" id="cb763-19" title="19">s_r <span class="op">=</span> np.amax(np.absolute(eig))</a>
<a class="sourceLine" id="cb763-20" title="20"></a>
<a class="sourceLine" id="cb763-21" title="21">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(spectral_r(a), s_r) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-69">Run 2</h4>
<div class="sourceCode" id="cb765"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb765-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb765-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb765-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb765-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb765-5" title="5"></a>
<a class="sourceLine" id="cb765-6" title="6"><span class="kw">def</span> spectral_r(a):</a>
<a class="sourceLine" id="cb765-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb765-8" title="8"><span class="co">  This function calculates the spectral radius of the input square matrix a.</span></a>
<a class="sourceLine" id="cb765-9" title="9"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb765-10" title="10">  eigval <span class="op">=</span> np.linalg.eigvals(a)</a>
<a class="sourceLine" id="cb765-11" title="11">  sradius <span class="op">=</span> np.<span class="bu">max</span>(np.<span class="bu">abs</span>(eigval))</a>
<a class="sourceLine" id="cb765-12" title="12">  <span class="cf">return</span> sradius</a>
<a class="sourceLine" id="cb765-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb765-14" title="14"></a>
<a class="sourceLine" id="cb765-15" title="15">np.random.seed(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb765-16" title="16">M <span class="op">=</span> <span class="dv">100</span></a>
<a class="sourceLine" id="cb765-17" title="17">a <span class="op">=</span> np.random.normal(loc<span class="op">=</span><span class="dv">10</span>, scale<span class="op">=</span><span class="dv">3</span>, size<span class="op">=</span>(M,M))</a>
<a class="sourceLine" id="cb765-18" title="18">eig <span class="op">=</span> np.linalg.eigvals(a)</a>
<a class="sourceLine" id="cb765-19" title="19">s_r <span class="op">=</span> np.amax(np.absolute(eig))</a>
<a class="sourceLine" id="cb765-20" title="20"></a>
<a class="sourceLine" id="cb765-21" title="21">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(spectral_r(a), s_r) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-69">Run 3</h4>
<div class="sourceCode" id="cb767"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb767-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb767-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb767-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb767-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb767-5" title="5"></a>
<a class="sourceLine" id="cb767-6" title="6"><span class="kw">def</span> spectral_r(a):</a>
<a class="sourceLine" id="cb767-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb767-8" title="8"><span class="co">  This function calculates the spectral radius of the input square matrix a.</span></a>
<a class="sourceLine" id="cb767-9" title="9"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb767-10" title="10">  eigvals <span class="op">=</span> np.linalg.eigvals(a)</a>
<a class="sourceLine" id="cb767-11" title="11">  sradius <span class="op">=</span> np.<span class="bu">max</span>(np.<span class="bu">abs</span>(eigvals))</a>
<a class="sourceLine" id="cb767-12" title="12">  <span class="cf">return</span> sradius</a>
<a class="sourceLine" id="cb767-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb767-14" title="14"></a>
<a class="sourceLine" id="cb767-15" title="15">np.random.seed(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb767-16" title="16">M <span class="op">=</span> <span class="dv">100</span></a>
<a class="sourceLine" id="cb767-17" title="17">a <span class="op">=</span> np.random.normal(loc<span class="op">=</span><span class="dv">10</span>, scale<span class="op">=</span><span class="dv">3</span>, size<span class="op">=</span>(M,M))</a>
<a class="sourceLine" id="cb767-18" title="18">eig <span class="op">=</span> np.linalg.eigvals(a)</a>
<a class="sourceLine" id="cb767-19" title="19">s_r <span class="op">=</span> np.amax(np.absolute(eig))</a>
<a class="sourceLine" id="cb767-20" title="20"></a>
<a class="sourceLine" id="cb767-21" title="21">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(spectral_r(a), s_r) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-69">Run 4</h4>
<div class="sourceCode" id="cb769"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb769-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb769-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb769-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb769-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb769-5" title="5"></a>
<a class="sourceLine" id="cb769-6" title="6"><span class="kw">def</span> spectral_r(a):</a>
<a class="sourceLine" id="cb769-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb769-8" title="8"><span class="co">  This function calculates the spectral radius of the input square matrix a.</span></a>
<a class="sourceLine" id="cb769-9" title="9"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb769-10" title="10">  w, v <span class="op">=</span> np.linalg.eig(a)</a>
<a class="sourceLine" id="cb769-11" title="11">  sradius <span class="op">=</span> np.<span class="bu">max</span>(np.<span class="bu">abs</span>(w))</a>
<a class="sourceLine" id="cb769-12" title="12">  <span class="cf">return</span> sradius</a>
<a class="sourceLine" id="cb769-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb769-14" title="14"></a>
<a class="sourceLine" id="cb769-15" title="15">np.random.seed(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb769-16" title="16">M <span class="op">=</span> <span class="dv">100</span></a>
<a class="sourceLine" id="cb769-17" title="17">a <span class="op">=</span> np.random.normal(loc<span class="op">=</span><span class="dv">10</span>, scale<span class="op">=</span><span class="dv">3</span>, size<span class="op">=</span>(M,M))</a>
<a class="sourceLine" id="cb769-18" title="18">eig <span class="op">=</span> np.linalg.eigvals(a)</a>
<a class="sourceLine" id="cb769-19" title="19">s_r <span class="op">=</span> np.amax(np.absolute(eig))</a>
<a class="sourceLine" id="cb769-20" title="20"></a>
<a class="sourceLine" id="cb769-21" title="21">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(spectral_r(a), s_r) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>substructure</summary></p>
<h4 id="query-70">Query</h4>
<div class="sourceCode" id="cb771"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb771-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb771-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb771-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb771-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb771-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb771-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb771-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb771-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb771-9" title="9"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb771-10" title="10"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb771-11" title="11"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb771-12" title="12"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb771-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb771-14" title="14"></a>
<a class="sourceLine" id="cb771-15" title="15"><span class="kw">def</span> substructure(smiles, mol_list):</a>
<a class="sourceLine" id="cb771-16" title="16">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb771-17" title="17"><span class="co">    This function takes a smiles string and searches mol_list to find entries that contain the substructure. It returns the indices of these entries.</span></a>
<a class="sourceLine" id="cb771-18" title="18"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb771-19" title="19">    [insert]</a>
<a class="sourceLine" id="cb771-20" title="20">    <span class="cf">return</span> idx</a></code></pre></div>
<h4 id="run-0-70">Run 0</h4>
<div class="sourceCode" id="cb772"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb772-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb772-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb772-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb772-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb772-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb772-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb772-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb772-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb772-9" title="9"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb772-10" title="10"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb772-11" title="11"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb772-12" title="12"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb772-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb772-14" title="14"></a>
<a class="sourceLine" id="cb772-15" title="15"><span class="kw">def</span> substructure(smiles, mol_list):</a>
<a class="sourceLine" id="cb772-16" title="16">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb772-17" title="17"><span class="co">    This function takes a smiles string and searches mol_list to find entries that contain the substructure. It returns the indices of these entries.</span></a>
<a class="sourceLine" id="cb772-18" title="18"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb772-19" title="19">    idx <span class="op">=</span> []</a>
<a class="sourceLine" id="cb772-20" title="20">    <span class="cf">for</span> i, mol <span class="kw">in</span> <span class="bu">enumerate</span>(mol_list):</a>
<a class="sourceLine" id="cb772-21" title="21">        <span class="cf">if</span> mol.HasSubstructMatch(Chem.MolFromSmiles(smiles)):</a>
<a class="sourceLine" id="cb772-22" title="22">            idx.append(i)</a>
<a class="sourceLine" id="cb772-23" title="23">    <span class="cf">return</span> idx</a>
<a class="sourceLine" id="cb772-24" title="24"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb772-25" title="25"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb772-26" title="26"><span class="co"># Taken from rdkit Docs</span></a>
<a class="sourceLine" id="cb772-27" title="27"><span class="im">from</span> rdkit <span class="im">import</span> RDConfig, Chem</a>
<a class="sourceLine" id="cb772-28" title="28"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdSubstructLibrary</a>
<a class="sourceLine" id="cb772-29" title="29">library <span class="op">=</span> rdSubstructLibrary.SubstructLibrary()</a>
<a class="sourceLine" id="cb772-30" title="30">llibrary <span class="op">=</span> []</a>
<a class="sourceLine" id="cb772-31" title="31"><span class="cf">for</span> mol <span class="kw">in</span> Chem.SDMolSupplier(os.path.join(RDConfig.RDDataDir,</a>
<a class="sourceLine" id="cb772-32" title="32">                                           <span class="st">&#39;NCI&#39;</span>, <span class="st">&#39;first_200.props.sdf&#39;</span>)):</a>
<a class="sourceLine" id="cb772-33" title="33">    idx <span class="op">=</span> library.AddMol(mol)</a>
<a class="sourceLine" id="cb772-34" title="34">    llibrary.append(mol)</a>
<a class="sourceLine" id="cb772-35" title="35">smiles <span class="op">=</span> <span class="st">&#39;CCCCOC&#39;</span></a>
<a class="sourceLine" id="cb772-36" title="36">core <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb772-37" title="37">indices <span class="op">=</span> library.GetMatches(core)</a>
<a class="sourceLine" id="cb772-38" title="38"></a>
<a class="sourceLine" id="cb772-39" title="39">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(<span class="bu">len</span>(substructure(</a>
<a class="sourceLine" id="cb772-40" title="40">    smiles, llibrary)), <span class="bu">len</span>(indices)) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>File error: Bad input file /tmp/pip-req-build-p3aa6g65/build/temp.linux-x86_64-3.8/rdkit_install/share/RDKit/Data/NCI/first_200.props.sdf</code></pre>
<h4 id="run-1-70">Run 1</h4>
<div class="sourceCode" id="cb774"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb774-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb774-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb774-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb774-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb774-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb774-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb774-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb774-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb774-9" title="9"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb774-10" title="10"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb774-11" title="11"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb774-12" title="12"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb774-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb774-14" title="14"></a>
<a class="sourceLine" id="cb774-15" title="15"><span class="kw">def</span> substructure(smiles, mol_list):</a>
<a class="sourceLine" id="cb774-16" title="16">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb774-17" title="17"><span class="co">    This function takes a smiles string and searches mol_list to find entries that contain the substructure. It returns the indices of these entries.</span></a>
<a class="sourceLine" id="cb774-18" title="18"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb774-19" title="19">    idx <span class="op">=</span> []</a>
<a class="sourceLine" id="cb774-20" title="20">    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(mol_list)):</a>
<a class="sourceLine" id="cb774-21" title="21">        <span class="cf">if</span> mol_list[i].HasSubstructMatch(Chem.MolFromSmiles(smiles)):</a>
<a class="sourceLine" id="cb774-22" title="22">            idx.append(i)</a>
<a class="sourceLine" id="cb774-23" title="23">    <span class="cf">return</span> idx</a>
<a class="sourceLine" id="cb774-24" title="24"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb774-25" title="25"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb774-26" title="26"><span class="co"># Taken from rdkit Docs</span></a>
<a class="sourceLine" id="cb774-27" title="27"><span class="im">from</span> rdkit <span class="im">import</span> RDConfig, Chem</a>
<a class="sourceLine" id="cb774-28" title="28"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdSubstructLibrary</a>
<a class="sourceLine" id="cb774-29" title="29">library <span class="op">=</span> rdSubstructLibrary.SubstructLibrary()</a>
<a class="sourceLine" id="cb774-30" title="30">llibrary <span class="op">=</span> []</a>
<a class="sourceLine" id="cb774-31" title="31"><span class="cf">for</span> mol <span class="kw">in</span> Chem.SDMolSupplier(os.path.join(RDConfig.RDDataDir,</a>
<a class="sourceLine" id="cb774-32" title="32">                                           <span class="st">&#39;NCI&#39;</span>, <span class="st">&#39;first_200.props.sdf&#39;</span>)):</a>
<a class="sourceLine" id="cb774-33" title="33">    idx <span class="op">=</span> library.AddMol(mol)</a>
<a class="sourceLine" id="cb774-34" title="34">    llibrary.append(mol)</a>
<a class="sourceLine" id="cb774-35" title="35">smiles <span class="op">=</span> <span class="st">&#39;CCCCOC&#39;</span></a>
<a class="sourceLine" id="cb774-36" title="36">core <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb774-37" title="37">indices <span class="op">=</span> library.GetMatches(core)</a>
<a class="sourceLine" id="cb774-38" title="38"></a>
<a class="sourceLine" id="cb774-39" title="39">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(<span class="bu">len</span>(substructure(</a>
<a class="sourceLine" id="cb774-40" title="40">    smiles, llibrary)), <span class="bu">len</span>(indices)) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>File error: Bad input file /tmp/pip-req-build-p3aa6g65/build/temp.linux-x86_64-3.8/rdkit_install/share/RDKit/Data/NCI/first_200.props.sdf</code></pre>
<h4 id="run-2-70">Run 2</h4>
<div class="sourceCode" id="cb776"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb776-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb776-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb776-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb776-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb776-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb776-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb776-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb776-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb776-9" title="9"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb776-10" title="10"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb776-11" title="11"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb776-12" title="12"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb776-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb776-14" title="14"></a>
<a class="sourceLine" id="cb776-15" title="15"><span class="kw">def</span> substructure(smiles, mol_list):</a>
<a class="sourceLine" id="cb776-16" title="16">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb776-17" title="17"><span class="co">    This function takes a smiles string and searches mol_list to find entries that contain the substructure. It returns the indices of these entries.</span></a>
<a class="sourceLine" id="cb776-18" title="18"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb776-19" title="19">    idx <span class="op">=</span> []</a>
<a class="sourceLine" id="cb776-20" title="20">    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(mol_list)):</a>
<a class="sourceLine" id="cb776-21" title="21">        <span class="cf">if</span> mol_list[i].HasSubstructMatch(Chem.MolFromSmiles(smiles)):</a>
<a class="sourceLine" id="cb776-22" title="22">            idx.append(i)</a>
<a class="sourceLine" id="cb776-23" title="23">    <span class="cf">return</span> idx</a>
<a class="sourceLine" id="cb776-24" title="24"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb776-25" title="25"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb776-26" title="26"><span class="co"># Taken from rdkit Docs</span></a>
<a class="sourceLine" id="cb776-27" title="27"><span class="im">from</span> rdkit <span class="im">import</span> RDConfig, Chem</a>
<a class="sourceLine" id="cb776-28" title="28"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdSubstructLibrary</a>
<a class="sourceLine" id="cb776-29" title="29">library <span class="op">=</span> rdSubstructLibrary.SubstructLibrary()</a>
<a class="sourceLine" id="cb776-30" title="30">llibrary <span class="op">=</span> []</a>
<a class="sourceLine" id="cb776-31" title="31"><span class="cf">for</span> mol <span class="kw">in</span> Chem.SDMolSupplier(os.path.join(RDConfig.RDDataDir,</a>
<a class="sourceLine" id="cb776-32" title="32">                                           <span class="st">&#39;NCI&#39;</span>, <span class="st">&#39;first_200.props.sdf&#39;</span>)):</a>
<a class="sourceLine" id="cb776-33" title="33">    idx <span class="op">=</span> library.AddMol(mol)</a>
<a class="sourceLine" id="cb776-34" title="34">    llibrary.append(mol)</a>
<a class="sourceLine" id="cb776-35" title="35">smiles <span class="op">=</span> <span class="st">&#39;CCCCOC&#39;</span></a>
<a class="sourceLine" id="cb776-36" title="36">core <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb776-37" title="37">indices <span class="op">=</span> library.GetMatches(core)</a>
<a class="sourceLine" id="cb776-38" title="38"></a>
<a class="sourceLine" id="cb776-39" title="39">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(<span class="bu">len</span>(substructure(</a>
<a class="sourceLine" id="cb776-40" title="40">    smiles, llibrary)), <span class="bu">len</span>(indices)) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>File error: Bad input file /tmp/pip-req-build-p3aa6g65/build/temp.linux-x86_64-3.8/rdkit_install/share/RDKit/Data/NCI/first_200.props.sdf</code></pre>
<h4 id="run-3-70">Run 3</h4>
<div class="sourceCode" id="cb778"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb778-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb778-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb778-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb778-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb778-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb778-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb778-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb778-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb778-9" title="9"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb778-10" title="10"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb778-11" title="11"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb778-12" title="12"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb778-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb778-14" title="14"></a>
<a class="sourceLine" id="cb778-15" title="15"><span class="kw">def</span> substructure(smiles, mol_list):</a>
<a class="sourceLine" id="cb778-16" title="16">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb778-17" title="17"><span class="co">    This function takes a smiles string and searches mol_list to find entries that contain the substructure. It returns the indices of these entries.</span></a>
<a class="sourceLine" id="cb778-18" title="18"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb778-19" title="19">    idx <span class="op">=</span> []</a>
<a class="sourceLine" id="cb778-20" title="20">    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(mol_list)):</a>
<a class="sourceLine" id="cb778-21" title="21">        <span class="cf">if</span> mol_list[i].HasSubstructMatch(Chem.MolFromSmiles(smiles)):</a>
<a class="sourceLine" id="cb778-22" title="22">            idx.append(i)</a>
<a class="sourceLine" id="cb778-23" title="23">    <span class="cf">return</span> idx</a>
<a class="sourceLine" id="cb778-24" title="24"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb778-25" title="25"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb778-26" title="26"><span class="co"># Taken from rdkit Docs</span></a>
<a class="sourceLine" id="cb778-27" title="27"><span class="im">from</span> rdkit <span class="im">import</span> RDConfig, Chem</a>
<a class="sourceLine" id="cb778-28" title="28"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdSubstructLibrary</a>
<a class="sourceLine" id="cb778-29" title="29">library <span class="op">=</span> rdSubstructLibrary.SubstructLibrary()</a>
<a class="sourceLine" id="cb778-30" title="30">llibrary <span class="op">=</span> []</a>
<a class="sourceLine" id="cb778-31" title="31"><span class="cf">for</span> mol <span class="kw">in</span> Chem.SDMolSupplier(os.path.join(RDConfig.RDDataDir,</a>
<a class="sourceLine" id="cb778-32" title="32">                                           <span class="st">&#39;NCI&#39;</span>, <span class="st">&#39;first_200.props.sdf&#39;</span>)):</a>
<a class="sourceLine" id="cb778-33" title="33">    idx <span class="op">=</span> library.AddMol(mol)</a>
<a class="sourceLine" id="cb778-34" title="34">    llibrary.append(mol)</a>
<a class="sourceLine" id="cb778-35" title="35">smiles <span class="op">=</span> <span class="st">&#39;CCCCOC&#39;</span></a>
<a class="sourceLine" id="cb778-36" title="36">core <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb778-37" title="37">indices <span class="op">=</span> library.GetMatches(core)</a>
<a class="sourceLine" id="cb778-38" title="38"></a>
<a class="sourceLine" id="cb778-39" title="39">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(<span class="bu">len</span>(substructure(</a>
<a class="sourceLine" id="cb778-40" title="40">    smiles, llibrary)), <span class="bu">len</span>(indices)) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>File error: Bad input file /tmp/pip-req-build-p3aa6g65/build/temp.linux-x86_64-3.8/rdkit_install/share/RDKit/Data/NCI/first_200.props.sdf</code></pre>
<h4 id="run-4-70">Run 4</h4>
<div class="sourceCode" id="cb780"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb780-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb780-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb780-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb780-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb780-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb780-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb780-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb780-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb780-9" title="9"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb780-10" title="10"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb780-11" title="11"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb780-12" title="12"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb780-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb780-14" title="14"></a>
<a class="sourceLine" id="cb780-15" title="15"><span class="kw">def</span> substructure(smiles, mol_list):</a>
<a class="sourceLine" id="cb780-16" title="16">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb780-17" title="17"><span class="co">    This function takes a smiles string and searches mol_list to find entries that contain the substructure. It returns the indices of these entries.</span></a>
<a class="sourceLine" id="cb780-18" title="18"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb780-19" title="19">    idx <span class="op">=</span> []</a>
<a class="sourceLine" id="cb780-20" title="20">    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(mol_list)):</a>
<a class="sourceLine" id="cb780-21" title="21">        <span class="cf">if</span> mol_list[i].HasSubstructMatch(Chem.MolFromSmiles(smiles)):</a>
<a class="sourceLine" id="cb780-22" title="22">            idx.append(i)</a>
<a class="sourceLine" id="cb780-23" title="23">    <span class="cf">return</span> idx</a>
<a class="sourceLine" id="cb780-24" title="24"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb780-25" title="25"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb780-26" title="26"><span class="co"># Taken from rdkit Docs</span></a>
<a class="sourceLine" id="cb780-27" title="27"><span class="im">from</span> rdkit <span class="im">import</span> RDConfig, Chem</a>
<a class="sourceLine" id="cb780-28" title="28"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdSubstructLibrary</a>
<a class="sourceLine" id="cb780-29" title="29">library <span class="op">=</span> rdSubstructLibrary.SubstructLibrary()</a>
<a class="sourceLine" id="cb780-30" title="30">llibrary <span class="op">=</span> []</a>
<a class="sourceLine" id="cb780-31" title="31"><span class="cf">for</span> mol <span class="kw">in</span> Chem.SDMolSupplier(os.path.join(RDConfig.RDDataDir,</a>
<a class="sourceLine" id="cb780-32" title="32">                                           <span class="st">&#39;NCI&#39;</span>, <span class="st">&#39;first_200.props.sdf&#39;</span>)):</a>
<a class="sourceLine" id="cb780-33" title="33">    idx <span class="op">=</span> library.AddMol(mol)</a>
<a class="sourceLine" id="cb780-34" title="34">    llibrary.append(mol)</a>
<a class="sourceLine" id="cb780-35" title="35">smiles <span class="op">=</span> <span class="st">&#39;CCCCOC&#39;</span></a>
<a class="sourceLine" id="cb780-36" title="36">core <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb780-37" title="37">indices <span class="op">=</span> library.GetMatches(core)</a>
<a class="sourceLine" id="cb780-38" title="38"></a>
<a class="sourceLine" id="cb780-39" title="39">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(<span class="bu">len</span>(substructure(</a>
<a class="sourceLine" id="cb780-40" title="40">    smiles, llibrary)), <span class="bu">len</span>(indices)) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>File error: Bad input file /tmp/pip-req-build-p3aa6g65/build/temp.linux-x86_64-3.8/rdkit_install/share/RDKit/Data/NCI/first_200.props.sdf</code></pre>
</details>
<details>
<p><summary>tanimoto</summary></p>
<h4 id="query-71">Query</h4>
<div class="sourceCode" id="cb782"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb782-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb782-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb782-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb782-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb782-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb782-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb782-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb782-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb782-9" title="9"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb782-10" title="10"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb782-11" title="11"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb782-12" title="12"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb782-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb782-14" title="14"></a>
<a class="sourceLine" id="cb782-15" title="15"><span class="kw">def</span> tanimoto_matrix(smiles_list, bits<span class="op">=</span><span class="dv">256</span>):</a>
<a class="sourceLine" id="cb782-16" title="16">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb782-17" title="17"><span class="co">  Returns pairwise Tanimoto similarity matrix with ECFP4 fingerprints</span></a>
<a class="sourceLine" id="cb782-18" title="18"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb782-19" title="19">  [insert]</a>
<a class="sourceLine" id="cb782-20" title="20">  <span class="cf">return</span> s</a></code></pre></div>
<h4 id="run-0-71">Run 0</h4>
<div class="sourceCode" id="cb783"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb783-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb783-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb783-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb783-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb783-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb783-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb783-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb783-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb783-9" title="9"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb783-10" title="10"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb783-11" title="11"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb783-12" title="12"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb783-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb783-14" title="14"></a>
<a class="sourceLine" id="cb783-15" title="15"><span class="kw">def</span> tanimoto_matrix(smiles_list, bits<span class="op">=</span><span class="dv">256</span>):</a>
<a class="sourceLine" id="cb783-16" title="16">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb783-17" title="17"><span class="co">  Returns pairwise Tanimoto similarity matrix with ECFP4 fingerprints</span></a>
<a class="sourceLine" id="cb783-18" title="18"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb783-19" title="19">  mols <span class="op">=</span> [Chem.MolFromSmiles(smiles) <span class="cf">for</span> smiles <span class="kw">in</span> smiles_list]</a>
<a class="sourceLine" id="cb783-20" title="20">  fps <span class="op">=</span> [rdMolDescriptors.GetMorganFingerprintAsBitVect(mol, <span class="dv">2</span>, nBits<span class="op">=</span>bits) <span class="cf">for</span> mol <span class="kw">in</span> mols]</a>
<a class="sourceLine" id="cb783-21" title="21">  tanimoto_matrix <span class="op">=</span> np.zeros((<span class="bu">len</span>(fps), <span class="bu">len</span>(fps)))</a>
<a class="sourceLine" id="cb783-22" title="22">  <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(fps)):</a>
<a class="sourceLine" id="cb783-23" title="23">    <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(fps)):</a>
<a class="sourceLine" id="cb783-24" title="24">      tanimoto_matrix[i,j] <span class="op">=</span> DataStructs.TanimotoSimilarity(fps[i], fps[j])</a>
<a class="sourceLine" id="cb783-25" title="25">  <span class="cf">return</span> tanimoto_matrix</a>
<a class="sourceLine" id="cb783-26" title="26"></a>
<a class="sourceLine" id="cb783-27" title="27"></a>
<a class="sourceLine" id="cb783-28" title="28">  <span class="cf">return</span> s</a>
<a class="sourceLine" id="cb783-29" title="29"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb783-30" title="30"><span class="im">from</span> rdkit.DataStructs.cDataStructs <span class="im">import</span> TanimotoSimilarity</a>
<a class="sourceLine" id="cb783-31" title="31"><span class="im">from</span> rdkit.Chem <span class="im">import</span> AllChem</a>
<a class="sourceLine" id="cb783-32" title="32"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb783-33" title="33"><span class="im">import</span> itertools</a>
<a class="sourceLine" id="cb783-34" title="34"></a>
<a class="sourceLine" id="cb783-35" title="35"></a>
<a class="sourceLine" id="cb783-36" title="36"><span class="kw">def</span> ref_tan_matrix(slist):</a>
<a class="sourceLine" id="cb783-37" title="37">    fp <span class="op">=</span> [AllChem.GetMorganFingerprintAsBitVect(</a>
<a class="sourceLine" id="cb783-38" title="38">        Chem.MolFromSmiles(s), <span class="dv">2</span>, nBits<span class="op">=</span><span class="dv">256</span>) <span class="cf">for</span> s <span class="kw">in</span> slist]</a>
<a class="sourceLine" id="cb783-39" title="39">    ts <span class="op">=</span> <span class="bu">list</span>(</a>
<a class="sourceLine" id="cb783-40" title="40">        TanimotoSimilarity(x, y) <span class="cf">for</span> x, y <span class="kw">in</span> itertools.product(fp, repeat<span class="op">=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb783-41" title="41">    )</a>
<a class="sourceLine" id="cb783-42" title="42">    <span class="cf">return</span> np.array(ts).reshape(<span class="bu">len</span>(fp), <span class="bu">len</span>(fp))</a>
<a class="sourceLine" id="cb783-43" title="43"></a>
<a class="sourceLine" id="cb783-44" title="44"></a>
<a class="sourceLine" id="cb783-45" title="45">mols <span class="op">=</span> [<span class="st">&#39;C1C=C(C=NC=C(C(F)(F)F)CCCCCC)C=C1C=CC=CC&#39;</span>,</a>
<a class="sourceLine" id="cb783-46" title="46">        <span class="st">&#39;CC=C=C(C(=O)N)&#39;</span>, <span class="st">&#39;C1([O-])C=CC=C1NC=CC=C&#39;</span>]</a>
<a class="sourceLine" id="cb783-47" title="47"><span class="co"># turned down tolerance because CODEX wants to compute</span></a>
<a class="sourceLine" id="cb783-48" title="48"><span class="co"># fingerprint with slightly different implementation (can&#39;t tell diff?)</span></a>
<a class="sourceLine" id="cb783-49" title="49">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.allclose(ref_tan_matrix(</a>
<a class="sourceLine" id="cb783-50" title="50">    mols), tanimoto_matrix(mols), rtol<span class="op">=</span><span class="fl">0.1</span>, atol<span class="op">=</span><span class="fl">1e-2</span>) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-71">Run 1</h4>
<div class="sourceCode" id="cb785"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb785-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb785-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb785-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb785-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb785-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb785-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb785-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb785-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb785-9" title="9"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb785-10" title="10"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb785-11" title="11"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb785-12" title="12"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb785-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb785-14" title="14"></a>
<a class="sourceLine" id="cb785-15" title="15"><span class="kw">def</span> tanimoto_matrix(smiles_list, bits<span class="op">=</span><span class="dv">256</span>):</a>
<a class="sourceLine" id="cb785-16" title="16">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb785-17" title="17"><span class="co">  Returns pairwise Tanimoto similarity matrix with ECFP4 fingerprints</span></a>
<a class="sourceLine" id="cb785-18" title="18"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb785-19" title="19">  mols <span class="op">=</span> [Chem.MolFromSmiles(smiles) <span class="cf">for</span> smiles <span class="kw">in</span> smiles_list]</a>
<a class="sourceLine" id="cb785-20" title="20">  fps <span class="op">=</span> [rdMolDescriptors.GetMorganFingerprintAsBitVect(mol, <span class="dv">2</span>, nBits<span class="op">=</span>bits) <span class="cf">for</span> mol <span class="kw">in</span> mols]</a>
<a class="sourceLine" id="cb785-21" title="21">  tanimoto_matrix <span class="op">=</span> np.zeros((<span class="bu">len</span>(fps), <span class="bu">len</span>(fps)))</a>
<a class="sourceLine" id="cb785-22" title="22">  <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(fps)):</a>
<a class="sourceLine" id="cb785-23" title="23">    <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(fps)):</a>
<a class="sourceLine" id="cb785-24" title="24">      tanimoto_matrix[i, j] <span class="op">=</span> DataStructs.TanimotoSimilarity(fps[i], fps[j])</a>
<a class="sourceLine" id="cb785-25" title="25">  <span class="cf">return</span> tanimoto_matrix</a>
<a class="sourceLine" id="cb785-26" title="26"></a>
<a class="sourceLine" id="cb785-27" title="27"></a>
<a class="sourceLine" id="cb785-28" title="28">  <span class="cf">return</span> s</a>
<a class="sourceLine" id="cb785-29" title="29"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb785-30" title="30"><span class="im">from</span> rdkit.DataStructs.cDataStructs <span class="im">import</span> TanimotoSimilarity</a>
<a class="sourceLine" id="cb785-31" title="31"><span class="im">from</span> rdkit.Chem <span class="im">import</span> AllChem</a>
<a class="sourceLine" id="cb785-32" title="32"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb785-33" title="33"><span class="im">import</span> itertools</a>
<a class="sourceLine" id="cb785-34" title="34"></a>
<a class="sourceLine" id="cb785-35" title="35"></a>
<a class="sourceLine" id="cb785-36" title="36"><span class="kw">def</span> ref_tan_matrix(slist):</a>
<a class="sourceLine" id="cb785-37" title="37">    fp <span class="op">=</span> [AllChem.GetMorganFingerprintAsBitVect(</a>
<a class="sourceLine" id="cb785-38" title="38">        Chem.MolFromSmiles(s), <span class="dv">2</span>, nBits<span class="op">=</span><span class="dv">256</span>) <span class="cf">for</span> s <span class="kw">in</span> slist]</a>
<a class="sourceLine" id="cb785-39" title="39">    ts <span class="op">=</span> <span class="bu">list</span>(</a>
<a class="sourceLine" id="cb785-40" title="40">        TanimotoSimilarity(x, y) <span class="cf">for</span> x, y <span class="kw">in</span> itertools.product(fp, repeat<span class="op">=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb785-41" title="41">    )</a>
<a class="sourceLine" id="cb785-42" title="42">    <span class="cf">return</span> np.array(ts).reshape(<span class="bu">len</span>(fp), <span class="bu">len</span>(fp))</a>
<a class="sourceLine" id="cb785-43" title="43"></a>
<a class="sourceLine" id="cb785-44" title="44"></a>
<a class="sourceLine" id="cb785-45" title="45">mols <span class="op">=</span> [<span class="st">&#39;C1C=C(C=NC=C(C(F)(F)F)CCCCCC)C=C1C=CC=CC&#39;</span>,</a>
<a class="sourceLine" id="cb785-46" title="46">        <span class="st">&#39;CC=C=C(C(=O)N)&#39;</span>, <span class="st">&#39;C1([O-])C=CC=C1NC=CC=C&#39;</span>]</a>
<a class="sourceLine" id="cb785-47" title="47"><span class="co"># turned down tolerance because CODEX wants to compute</span></a>
<a class="sourceLine" id="cb785-48" title="48"><span class="co"># fingerprint with slightly different implementation (can&#39;t tell diff?)</span></a>
<a class="sourceLine" id="cb785-49" title="49">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.allclose(ref_tan_matrix(</a>
<a class="sourceLine" id="cb785-50" title="50">    mols), tanimoto_matrix(mols), rtol<span class="op">=</span><span class="fl">0.1</span>, atol<span class="op">=</span><span class="fl">1e-2</span>) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-71">Run 2</h4>
<div class="sourceCode" id="cb787"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb787-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb787-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb787-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb787-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb787-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb787-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb787-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb787-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb787-9" title="9"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb787-10" title="10"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb787-11" title="11"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb787-12" title="12"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb787-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb787-14" title="14"></a>
<a class="sourceLine" id="cb787-15" title="15"><span class="kw">def</span> tanimoto_matrix(smiles_list, bits<span class="op">=</span><span class="dv">256</span>):</a>
<a class="sourceLine" id="cb787-16" title="16">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb787-17" title="17"><span class="co">  Returns pairwise Tanimoto similarity matrix with ECFP4 fingerprints</span></a>
<a class="sourceLine" id="cb787-18" title="18"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb787-19" title="19">  mols <span class="op">=</span> [Chem.MolFromSmiles(smiles) <span class="cf">for</span> smiles <span class="kw">in</span> smiles_list]</a>
<a class="sourceLine" id="cb787-20" title="20">  fps <span class="op">=</span> [rdMolDescriptors.GetMorganFingerprintAsBitVect(mol, <span class="dv">2</span>, nBits<span class="op">=</span>bits) <span class="cf">for</span> mol <span class="kw">in</span> mols]</a>
<a class="sourceLine" id="cb787-21" title="21">  s <span class="op">=</span> np.zeros((<span class="bu">len</span>(fps), <span class="bu">len</span>(fps)))</a>
<a class="sourceLine" id="cb787-22" title="22">  <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(fps)):</a>
<a class="sourceLine" id="cb787-23" title="23">    <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(fps)):</a>
<a class="sourceLine" id="cb787-24" title="24">      s[i,j] <span class="op">=</span> DataStructs.TanimotoSimilarity(fps[i], fps[j])</a>
<a class="sourceLine" id="cb787-25" title="25">  <span class="cf">return</span> s</a>
<a class="sourceLine" id="cb787-26" title="26"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb787-27" title="27"><span class="im">from</span> rdkit.DataStructs.cDataStructs <span class="im">import</span> TanimotoSimilarity</a>
<a class="sourceLine" id="cb787-28" title="28"><span class="im">from</span> rdkit.Chem <span class="im">import</span> AllChem</a>
<a class="sourceLine" id="cb787-29" title="29"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb787-30" title="30"><span class="im">import</span> itertools</a>
<a class="sourceLine" id="cb787-31" title="31"></a>
<a class="sourceLine" id="cb787-32" title="32"></a>
<a class="sourceLine" id="cb787-33" title="33"><span class="kw">def</span> ref_tan_matrix(slist):</a>
<a class="sourceLine" id="cb787-34" title="34">    fp <span class="op">=</span> [AllChem.GetMorganFingerprintAsBitVect(</a>
<a class="sourceLine" id="cb787-35" title="35">        Chem.MolFromSmiles(s), <span class="dv">2</span>, nBits<span class="op">=</span><span class="dv">256</span>) <span class="cf">for</span> s <span class="kw">in</span> slist]</a>
<a class="sourceLine" id="cb787-36" title="36">    ts <span class="op">=</span> <span class="bu">list</span>(</a>
<a class="sourceLine" id="cb787-37" title="37">        TanimotoSimilarity(x, y) <span class="cf">for</span> x, y <span class="kw">in</span> itertools.product(fp, repeat<span class="op">=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb787-38" title="38">    )</a>
<a class="sourceLine" id="cb787-39" title="39">    <span class="cf">return</span> np.array(ts).reshape(<span class="bu">len</span>(fp), <span class="bu">len</span>(fp))</a>
<a class="sourceLine" id="cb787-40" title="40"></a>
<a class="sourceLine" id="cb787-41" title="41"></a>
<a class="sourceLine" id="cb787-42" title="42">mols <span class="op">=</span> [<span class="st">&#39;C1C=C(C=NC=C(C(F)(F)F)CCCCCC)C=C1C=CC=CC&#39;</span>,</a>
<a class="sourceLine" id="cb787-43" title="43">        <span class="st">&#39;CC=C=C(C(=O)N)&#39;</span>, <span class="st">&#39;C1([O-])C=CC=C1NC=CC=C&#39;</span>]</a>
<a class="sourceLine" id="cb787-44" title="44"><span class="co"># turned down tolerance because CODEX wants to compute</span></a>
<a class="sourceLine" id="cb787-45" title="45"><span class="co"># fingerprint with slightly different implementation (can&#39;t tell diff?)</span></a>
<a class="sourceLine" id="cb787-46" title="46">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.allclose(ref_tan_matrix(</a>
<a class="sourceLine" id="cb787-47" title="47">    mols), tanimoto_matrix(mols), rtol<span class="op">=</span><span class="fl">0.1</span>, atol<span class="op">=</span><span class="fl">1e-2</span>) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-71">Run 3</h4>
<div class="sourceCode" id="cb789"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb789-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb789-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb789-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb789-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb789-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb789-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb789-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb789-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb789-9" title="9"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb789-10" title="10"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb789-11" title="11"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb789-12" title="12"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb789-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb789-14" title="14"></a>
<a class="sourceLine" id="cb789-15" title="15"><span class="kw">def</span> tanimoto_matrix(smiles_list, bits<span class="op">=</span><span class="dv">256</span>):</a>
<a class="sourceLine" id="cb789-16" title="16">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb789-17" title="17"><span class="co">  Returns pairwise Tanimoto similarity matrix with ECFP4 fingerprints</span></a>
<a class="sourceLine" id="cb789-18" title="18"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb789-19" title="19">  mols <span class="op">=</span> [Chem.MolFromSmiles(smiles) <span class="cf">for</span> smiles <span class="kw">in</span> smiles_list]</a>
<a class="sourceLine" id="cb789-20" title="20">  fps <span class="op">=</span> [rdMolDescriptors.GetMorganFingerprintAsBitVect(mol, <span class="dv">2</span>, nBits<span class="op">=</span>bits) <span class="cf">for</span> mol <span class="kw">in</span> mols]</a>
<a class="sourceLine" id="cb789-21" title="21">  tanimoto_matrix <span class="op">=</span> np.zeros((<span class="bu">len</span>(fps), <span class="bu">len</span>(fps)))</a>
<a class="sourceLine" id="cb789-22" title="22">  <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(fps)):</a>
<a class="sourceLine" id="cb789-23" title="23">    <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(fps)):</a>
<a class="sourceLine" id="cb789-24" title="24">      tanimoto_matrix[i, j] <span class="op">=</span> DataStructs.TanimotoSimilarity(fps[i], fps[j])</a>
<a class="sourceLine" id="cb789-25" title="25">  <span class="cf">return</span> tanimoto_matrix</a>
<a class="sourceLine" id="cb789-26" title="26"></a>
<a class="sourceLine" id="cb789-27" title="27"></a>
<a class="sourceLine" id="cb789-28" title="28">  <span class="cf">return</span> s</a>
<a class="sourceLine" id="cb789-29" title="29"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb789-30" title="30"><span class="im">from</span> rdkit.DataStructs.cDataStructs <span class="im">import</span> TanimotoSimilarity</a>
<a class="sourceLine" id="cb789-31" title="31"><span class="im">from</span> rdkit.Chem <span class="im">import</span> AllChem</a>
<a class="sourceLine" id="cb789-32" title="32"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb789-33" title="33"><span class="im">import</span> itertools</a>
<a class="sourceLine" id="cb789-34" title="34"></a>
<a class="sourceLine" id="cb789-35" title="35"></a>
<a class="sourceLine" id="cb789-36" title="36"><span class="kw">def</span> ref_tan_matrix(slist):</a>
<a class="sourceLine" id="cb789-37" title="37">    fp <span class="op">=</span> [AllChem.GetMorganFingerprintAsBitVect(</a>
<a class="sourceLine" id="cb789-38" title="38">        Chem.MolFromSmiles(s), <span class="dv">2</span>, nBits<span class="op">=</span><span class="dv">256</span>) <span class="cf">for</span> s <span class="kw">in</span> slist]</a>
<a class="sourceLine" id="cb789-39" title="39">    ts <span class="op">=</span> <span class="bu">list</span>(</a>
<a class="sourceLine" id="cb789-40" title="40">        TanimotoSimilarity(x, y) <span class="cf">for</span> x, y <span class="kw">in</span> itertools.product(fp, repeat<span class="op">=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb789-41" title="41">    )</a>
<a class="sourceLine" id="cb789-42" title="42">    <span class="cf">return</span> np.array(ts).reshape(<span class="bu">len</span>(fp), <span class="bu">len</span>(fp))</a>
<a class="sourceLine" id="cb789-43" title="43"></a>
<a class="sourceLine" id="cb789-44" title="44"></a>
<a class="sourceLine" id="cb789-45" title="45">mols <span class="op">=</span> [<span class="st">&#39;C1C=C(C=NC=C(C(F)(F)F)CCCCCC)C=C1C=CC=CC&#39;</span>,</a>
<a class="sourceLine" id="cb789-46" title="46">        <span class="st">&#39;CC=C=C(C(=O)N)&#39;</span>, <span class="st">&#39;C1([O-])C=CC=C1NC=CC=C&#39;</span>]</a>
<a class="sourceLine" id="cb789-47" title="47"><span class="co"># turned down tolerance because CODEX wants to compute</span></a>
<a class="sourceLine" id="cb789-48" title="48"><span class="co"># fingerprint with slightly different implementation (can&#39;t tell diff?)</span></a>
<a class="sourceLine" id="cb789-49" title="49">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.allclose(ref_tan_matrix(</a>
<a class="sourceLine" id="cb789-50" title="50">    mols), tanimoto_matrix(mols), rtol<span class="op">=</span><span class="fl">0.1</span>, atol<span class="op">=</span><span class="fl">1e-2</span>) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-71">Run 4</h4>
<div class="sourceCode" id="cb791"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb791-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb791-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb791-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb791-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb791-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb791-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb791-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb791-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb791-9" title="9"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb791-10" title="10"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb791-11" title="11"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb791-12" title="12"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb791-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb791-14" title="14"></a>
<a class="sourceLine" id="cb791-15" title="15"><span class="kw">def</span> tanimoto_matrix(smiles_list, bits<span class="op">=</span><span class="dv">256</span>):</a>
<a class="sourceLine" id="cb791-16" title="16">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb791-17" title="17"><span class="co">  Returns pairwise Tanimoto similarity matrix with ECFP4 fingerprints</span></a>
<a class="sourceLine" id="cb791-18" title="18"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb791-19" title="19">  mols <span class="op">=</span> [Chem.MolFromSmiles(smiles) <span class="cf">for</span> smiles <span class="kw">in</span> smiles_list]</a>
<a class="sourceLine" id="cb791-20" title="20">  fps <span class="op">=</span> [rdMolDescriptors.GetMorganFingerprintAsBitVect(mol, <span class="dv">2</span>, nBits<span class="op">=</span>bits) <span class="cf">for</span> mol <span class="kw">in</span> mols]</a>
<a class="sourceLine" id="cb791-21" title="21">  nfps <span class="op">=</span> <span class="bu">len</span>(fps)</a>
<a class="sourceLine" id="cb791-22" title="22">  s <span class="op">=</span> np.zeros((nfps, nfps))</a>
<a class="sourceLine" id="cb791-23" title="23">  <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(nfps):</a>
<a class="sourceLine" id="cb791-24" title="24">    <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(i<span class="op">+</span><span class="dv">1</span>, nfps):</a>
<a class="sourceLine" id="cb791-25" title="25">      s[i,j] <span class="op">=</span> DataStructs.TanimotoSimilarity(fps[i], fps[j])</a>
<a class="sourceLine" id="cb791-26" title="26">      s[j,i] <span class="op">=</span> s[i,j]</a>
<a class="sourceLine" id="cb791-27" title="27">  <span class="cf">return</span> s</a>
<a class="sourceLine" id="cb791-28" title="28"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb791-29" title="29"><span class="im">from</span> rdkit.DataStructs.cDataStructs <span class="im">import</span> TanimotoSimilarity</a>
<a class="sourceLine" id="cb791-30" title="30"><span class="im">from</span> rdkit.Chem <span class="im">import</span> AllChem</a>
<a class="sourceLine" id="cb791-31" title="31"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb791-32" title="32"><span class="im">import</span> itertools</a>
<a class="sourceLine" id="cb791-33" title="33"></a>
<a class="sourceLine" id="cb791-34" title="34"></a>
<a class="sourceLine" id="cb791-35" title="35"><span class="kw">def</span> ref_tan_matrix(slist):</a>
<a class="sourceLine" id="cb791-36" title="36">    fp <span class="op">=</span> [AllChem.GetMorganFingerprintAsBitVect(</a>
<a class="sourceLine" id="cb791-37" title="37">        Chem.MolFromSmiles(s), <span class="dv">2</span>, nBits<span class="op">=</span><span class="dv">256</span>) <span class="cf">for</span> s <span class="kw">in</span> slist]</a>
<a class="sourceLine" id="cb791-38" title="38">    ts <span class="op">=</span> <span class="bu">list</span>(</a>
<a class="sourceLine" id="cb791-39" title="39">        TanimotoSimilarity(x, y) <span class="cf">for</span> x, y <span class="kw">in</span> itertools.product(fp, repeat<span class="op">=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb791-40" title="40">    )</a>
<a class="sourceLine" id="cb791-41" title="41">    <span class="cf">return</span> np.array(ts).reshape(<span class="bu">len</span>(fp), <span class="bu">len</span>(fp))</a>
<a class="sourceLine" id="cb791-42" title="42"></a>
<a class="sourceLine" id="cb791-43" title="43"></a>
<a class="sourceLine" id="cb791-44" title="44">mols <span class="op">=</span> [<span class="st">&#39;C1C=C(C=NC=C(C(F)(F)F)CCCCCC)C=C1C=CC=CC&#39;</span>,</a>
<a class="sourceLine" id="cb791-45" title="45">        <span class="st">&#39;CC=C=C(C(=O)N)&#39;</span>, <span class="st">&#39;C1([O-])C=CC=C1NC=CC=C&#39;</span>]</a>
<a class="sourceLine" id="cb791-46" title="46"><span class="co"># turned down tolerance because CODEX wants to compute</span></a>
<a class="sourceLine" id="cb791-47" title="47"><span class="co"># fingerprint with slightly different implementation (can&#39;t tell diff?)</span></a>
<a class="sourceLine" id="cb791-48" title="48">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.allclose(ref_tan_matrix(</a>
<a class="sourceLine" id="cb791-49" title="49">    mols), tanimoto_matrix(mols), rtol<span class="op">=</span><span class="fl">0.1</span>, atol<span class="op">=</span><span class="fl">1e-2</span>) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>unbdistance</summary></p>
<h4 id="query-72">Query</h4>
<div class="sourceCode" id="cb793"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb793-1" title="1"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb793-2" title="2"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb793-3" title="3"></a>
<a class="sourceLine" id="cb793-4" title="4"><span class="kw">def</span> unbdistance(traj,lig_str):</a>
<a class="sourceLine" id="cb793-5" title="5">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb793-6" title="6"><span class="co">    This function returns a list of distances between center of mass of</span></a>
<a class="sourceLine" id="cb793-7" title="7"><span class="co">    protein and center of mass of lig_str in every frame of trajectory</span></a>
<a class="sourceLine" id="cb793-8" title="8"><span class="co">    traj</span></a>
<a class="sourceLine" id="cb793-9" title="9"></a>
<a class="sourceLine" id="cb793-10" title="10"><span class="co">    traj is an mdtraj trajectory object</span></a>
<a class="sourceLine" id="cb793-11" title="11"><span class="co">    lig_str is a string with the residue name of the ligand</span></a>
<a class="sourceLine" id="cb793-12" title="12"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb793-13" title="13">    [insert]</a>
<a class="sourceLine" id="cb793-14" title="14">    <span class="cf">return</span> result</a></code></pre></div>
<h4 id="run-0-72">Run 0</h4>
<div class="sourceCode" id="cb794"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb794-1" title="1"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb794-2" title="2"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb794-3" title="3"></a>
<a class="sourceLine" id="cb794-4" title="4"><span class="kw">def</span> unbdistance(traj,lig_str):</a>
<a class="sourceLine" id="cb794-5" title="5">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb794-6" title="6"><span class="co">    This function returns a list of distances between center of mass of</span></a>
<a class="sourceLine" id="cb794-7" title="7"><span class="co">    protein and center of mass of lig_str in every frame of trajectory</span></a>
<a class="sourceLine" id="cb794-8" title="8"><span class="co">    traj</span></a>
<a class="sourceLine" id="cb794-9" title="9"></a>
<a class="sourceLine" id="cb794-10" title="10"><span class="co">    traj is an mdtraj trajectory object</span></a>
<a class="sourceLine" id="cb794-11" title="11"><span class="co">    lig_str is a string with the residue name of the ligand</span></a>
<a class="sourceLine" id="cb794-12" title="12"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb794-13" title="13">    lig_ind <span class="op">=</span> traj.topology.select(<span class="st">&#39;resname &#39;</span><span class="op">+</span>lig_str)</a>
<a class="sourceLine" id="cb794-14" title="14">    protein_ind <span class="op">=</span> traj.topology.select(<span class="st">&#39;protein&#39;</span>)</a>
<a class="sourceLine" id="cb794-15" title="15">    result <span class="op">=</span> md.compute_distances(traj,np.array([[<span class="dv">0</span>,<span class="bu">len</span>(protein_ind)]]),</a>
<a class="sourceLine" id="cb794-16" title="16">                                  periodic<span class="op">=</span><span class="va">False</span>)</a>
<a class="sourceLine" id="cb794-17" title="17">    <span class="cf">return</span> result</a>
<a class="sourceLine" id="cb794-18" title="18"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb794-19" title="19"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb794-20" title="20"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb794-21" title="21"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb794-22" title="22"></a>
<a class="sourceLine" id="cb794-23" title="23"></a>
<a class="sourceLine" id="cb794-24" title="24"><span class="co">#_FILE_DIR_ = &#39;.&#39;</span></a>
<a class="sourceLine" id="cb794-25" title="25">lig_str <span class="op">=</span> <span class="st">&#39;TMP&#39;</span></a>
<a class="sourceLine" id="cb794-26" title="26">traj_path <span class="op">=</span> os.path.join(_FILE_DIR_, <span class="st">&#39;traj.dcd&#39;</span>) </a>
<a class="sourceLine" id="cb794-27" title="27">top_path <span class="op">=</span> os.path.join(_FILE_DIR_, <span class="st">&#39;top.pdb&#39;</span>)</a>
<a class="sourceLine" id="cb794-28" title="28">traj <span class="op">=</span> md.load(traj_path, top<span class="op">=</span>top_path)</a>
<a class="sourceLine" id="cb794-29" title="29">top <span class="op">=</span> traj.topology</a>
<a class="sourceLine" id="cb794-30" title="30">prot_idxs <span class="op">=</span> top.select(<span class="st">&#39;protein&#39;</span>)</a>
<a class="sourceLine" id="cb794-31" title="31">lig_idxs <span class="op">=</span> top.select(<span class="ss">F&#39;resname == </span><span class="sc">{</span>lig_str<span class="sc">}</span><span class="ss">&#39;</span>)</a>
<a class="sourceLine" id="cb794-32" title="32">traj2 <span class="op">=</span> md.load(traj_path, atom_indices<span class="op">=</span>prot_idxs, top<span class="op">=</span>top_path)</a>
<a class="sourceLine" id="cb794-33" title="33">traj3 <span class="op">=</span> md.load(traj_path, atom_indices<span class="op">=</span>lig_idxs, top<span class="op">=</span>top_path)</a>
<a class="sourceLine" id="cb794-34" title="34"></a>
<a class="sourceLine" id="cb794-35" title="35">dist <span class="op">=</span> []</a>
<a class="sourceLine" id="cb794-36" title="36"><span class="cf">for</span> i,j <span class="kw">in</span> <span class="bu">zip</span>(traj2,traj3):</a>
<a class="sourceLine" id="cb794-37" title="37">    com_a <span class="op">=</span> md.compute_center_of_mass(i)[<span class="dv">0</span>]</a>
<a class="sourceLine" id="cb794-38" title="38">    com_b <span class="op">=</span> md.compute_center_of_mass(j)[<span class="dv">0</span>]</a>
<a class="sourceLine" id="cb794-39" title="39">    dist.append(((com_a[<span class="dv">0</span>]<span class="op">-</span>com_b[<span class="dv">0</span>])<span class="op">**</span><span class="dv">2</span><span class="op">+</span>(com_a[<span class="dv">1</span>]<span class="op">-</span>com_b[<span class="dv">1</span>])<span class="op">**</span><span class="dv">2</span><span class="op">+</span>(com_a[<span class="dv">2</span>]<span class="op">-</span>com_b[<span class="dv">2</span>])<span class="op">**</span><span class="dv">2</span>)<span class="op">**</span><span class="fl">0.5</span>)</a>
<a class="sourceLine" id="cb794-40" title="40"></a>
<a class="sourceLine" id="cb794-41" title="41"><span class="co"># assert</span></a>
<a class="sourceLine" id="cb794-42" title="42"></a>
<a class="sourceLine" id="cb794-43" title="43">distances <span class="op">=</span> unbdistance(traj,lig_str)</a>
<a class="sourceLine" id="cb794-44" title="44"></a>
<a class="sourceLine" id="cb794-45" title="45">check <span class="op">=</span> math.isclose(dist[<span class="dv">0</span>],distances[<span class="dv">0</span>])</a>
<a class="sourceLine" id="cb794-46" title="46">check2 <span class="op">=</span> math.isclose(dist[<span class="op">-</span><span class="dv">1</span>],distances[<span class="op">-</span><span class="dv">1</span>])</a>
<a class="sourceLine" id="cb794-47" title="47">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> check <span class="kw">and</span> check2 <span class="cf">else</span> <span class="va">False</span> </a></code></pre></div>
<p>Output:</p>
<pre><code>&#39;Constant&#39; object has no attribute &#39;kind&#39;</code></pre>
<h4 id="run-1-72">Run 1</h4>
<div class="sourceCode" id="cb796"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb796-1" title="1"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb796-2" title="2"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb796-3" title="3"></a>
<a class="sourceLine" id="cb796-4" title="4"><span class="kw">def</span> unbdistance(traj,lig_str):</a>
<a class="sourceLine" id="cb796-5" title="5">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb796-6" title="6"><span class="co">    This function returns a list of distances between center of mass of</span></a>
<a class="sourceLine" id="cb796-7" title="7"><span class="co">    protein and center of mass of lig_str in every frame of trajectory</span></a>
<a class="sourceLine" id="cb796-8" title="8"><span class="co">    traj</span></a>
<a class="sourceLine" id="cb796-9" title="9"></a>
<a class="sourceLine" id="cb796-10" title="10"><span class="co">    traj is an mdtraj trajectory object</span></a>
<a class="sourceLine" id="cb796-11" title="11"><span class="co">    lig_str is a string with the residue name of the ligand</span></a>
<a class="sourceLine" id="cb796-12" title="12"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb796-13" title="13">    lig_idx <span class="op">=</span> traj.topology.select(<span class="st">&#39;resname &#39;</span> <span class="op">+</span> lig_str)</a>
<a class="sourceLine" id="cb796-14" title="14">    protein_idx <span class="op">=</span> traj.topology.select(<span class="st">&#39;protein&#39;</span>)</a>
<a class="sourceLine" id="cb796-15" title="15">    protein_com <span class="op">=</span> md.compute_center_of_mass(traj.atom_slice(protein_idx))</a>
<a class="sourceLine" id="cb796-16" title="16">    lig_com <span class="op">=</span> md.compute_center_of_mass(traj.atom_slice(lig_idx))</a>
<a class="sourceLine" id="cb796-17" title="17">    result <span class="op">=</span> md.compute_distances(traj,np.array([protein_com,lig_com]))</a>
<a class="sourceLine" id="cb796-18" title="18">    <span class="cf">return</span> result</a>
<a class="sourceLine" id="cb796-19" title="19"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb796-20" title="20"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb796-21" title="21"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb796-22" title="22"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb796-23" title="23"></a>
<a class="sourceLine" id="cb796-24" title="24"></a>
<a class="sourceLine" id="cb796-25" title="25"><span class="co">#_FILE_DIR_ = &#39;.&#39;</span></a>
<a class="sourceLine" id="cb796-26" title="26">lig_str <span class="op">=</span> <span class="st">&#39;TMP&#39;</span></a>
<a class="sourceLine" id="cb796-27" title="27">traj_path <span class="op">=</span> os.path.join(_FILE_DIR_, <span class="st">&#39;traj.dcd&#39;</span>) </a>
<a class="sourceLine" id="cb796-28" title="28">top_path <span class="op">=</span> os.path.join(_FILE_DIR_, <span class="st">&#39;top.pdb&#39;</span>)</a>
<a class="sourceLine" id="cb796-29" title="29">traj <span class="op">=</span> md.load(traj_path, top<span class="op">=</span>top_path)</a>
<a class="sourceLine" id="cb796-30" title="30">top <span class="op">=</span> traj.topology</a>
<a class="sourceLine" id="cb796-31" title="31">prot_idxs <span class="op">=</span> top.select(<span class="st">&#39;protein&#39;</span>)</a>
<a class="sourceLine" id="cb796-32" title="32">lig_idxs <span class="op">=</span> top.select(<span class="ss">F&#39;resname == </span><span class="sc">{</span>lig_str<span class="sc">}</span><span class="ss">&#39;</span>)</a>
<a class="sourceLine" id="cb796-33" title="33">traj2 <span class="op">=</span> md.load(traj_path, atom_indices<span class="op">=</span>prot_idxs, top<span class="op">=</span>top_path)</a>
<a class="sourceLine" id="cb796-34" title="34">traj3 <span class="op">=</span> md.load(traj_path, atom_indices<span class="op">=</span>lig_idxs, top<span class="op">=</span>top_path)</a>
<a class="sourceLine" id="cb796-35" title="35"></a>
<a class="sourceLine" id="cb796-36" title="36">dist <span class="op">=</span> []</a>
<a class="sourceLine" id="cb796-37" title="37"><span class="cf">for</span> i,j <span class="kw">in</span> <span class="bu">zip</span>(traj2,traj3):</a>
<a class="sourceLine" id="cb796-38" title="38">    com_a <span class="op">=</span> md.compute_center_of_mass(i)[<span class="dv">0</span>]</a>
<a class="sourceLine" id="cb796-39" title="39">    com_b <span class="op">=</span> md.compute_center_of_mass(j)[<span class="dv">0</span>]</a>
<a class="sourceLine" id="cb796-40" title="40">    dist.append(((com_a[<span class="dv">0</span>]<span class="op">-</span>com_b[<span class="dv">0</span>])<span class="op">**</span><span class="dv">2</span><span class="op">+</span>(com_a[<span class="dv">1</span>]<span class="op">-</span>com_b[<span class="dv">1</span>])<span class="op">**</span><span class="dv">2</span><span class="op">+</span>(com_a[<span class="dv">2</span>]<span class="op">-</span>com_b[<span class="dv">2</span>])<span class="op">**</span><span class="dv">2</span>)<span class="op">**</span><span class="fl">0.5</span>)</a>
<a class="sourceLine" id="cb796-41" title="41"></a>
<a class="sourceLine" id="cb796-42" title="42"><span class="co"># assert</span></a>
<a class="sourceLine" id="cb796-43" title="43"></a>
<a class="sourceLine" id="cb796-44" title="44">distances <span class="op">=</span> unbdistance(traj,lig_str)</a>
<a class="sourceLine" id="cb796-45" title="45"></a>
<a class="sourceLine" id="cb796-46" title="46">check <span class="op">=</span> math.isclose(dist[<span class="dv">0</span>],distances[<span class="dv">0</span>])</a>
<a class="sourceLine" id="cb796-47" title="47">check2 <span class="op">=</span> math.isclose(dist[<span class="op">-</span><span class="dv">1</span>],distances[<span class="op">-</span><span class="dv">1</span>])</a>
<a class="sourceLine" id="cb796-48" title="48">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> check <span class="kw">and</span> check2 <span class="cf">else</span> <span class="va">False</span> </a></code></pre></div>
<p>Output:</p>
<pre><code>&#39;Constant&#39; object has no attribute &#39;kind&#39;</code></pre>
<h4 id="run-2-72">Run 2</h4>
<div class="sourceCode" id="cb798"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb798-1" title="1"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb798-2" title="2"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb798-3" title="3"></a>
<a class="sourceLine" id="cb798-4" title="4"><span class="kw">def</span> unbdistance(traj,lig_str):</a>
<a class="sourceLine" id="cb798-5" title="5">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb798-6" title="6"><span class="co">    This function returns a list of distances between center of mass of</span></a>
<a class="sourceLine" id="cb798-7" title="7"><span class="co">    protein and center of mass of lig_str in every frame of trajectory</span></a>
<a class="sourceLine" id="cb798-8" title="8"><span class="co">    traj</span></a>
<a class="sourceLine" id="cb798-9" title="9"></a>
<a class="sourceLine" id="cb798-10" title="10"><span class="co">    traj is an mdtraj trajectory object</span></a>
<a class="sourceLine" id="cb798-11" title="11"><span class="co">    lig_str is a string with the residue name of the ligand</span></a>
<a class="sourceLine" id="cb798-12" title="12"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb798-13" title="13">    lig_ind <span class="op">=</span> traj.topology.select(<span class="st">&#39;resname &#39;</span><span class="op">+</span>lig_str)</a>
<a class="sourceLine" id="cb798-14" title="14">    protein_ind <span class="op">=</span> traj.topology.select(<span class="st">&#39;protein&#39;</span>)</a>
<a class="sourceLine" id="cb798-15" title="15">    result <span class="op">=</span> []</a>
<a class="sourceLine" id="cb798-16" title="16">    <span class="cf">for</span> frame <span class="kw">in</span> traj:</a>
<a class="sourceLine" id="cb798-17" title="17">        lig_com <span class="op">=</span> md.compute_center_of_mass(frame,lig_ind)</a>
<a class="sourceLine" id="cb798-18" title="18">        protein_com <span class="op">=</span> md.compute_center_of_mass(frame,protein_ind)</a>
<a class="sourceLine" id="cb798-19" title="19">        result.append(np.linalg.norm(lig_com<span class="op">-</span>protein_com))</a>
<a class="sourceLine" id="cb798-20" title="20">    <span class="cf">return</span> result</a>
<a class="sourceLine" id="cb798-21" title="21"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb798-22" title="22"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb798-23" title="23"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb798-24" title="24"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb798-25" title="25"></a>
<a class="sourceLine" id="cb798-26" title="26"></a>
<a class="sourceLine" id="cb798-27" title="27"><span class="co">#_FILE_DIR_ = &#39;.&#39;</span></a>
<a class="sourceLine" id="cb798-28" title="28">lig_str <span class="op">=</span> <span class="st">&#39;TMP&#39;</span></a>
<a class="sourceLine" id="cb798-29" title="29">traj_path <span class="op">=</span> os.path.join(_FILE_DIR_, <span class="st">&#39;traj.dcd&#39;</span>) </a>
<a class="sourceLine" id="cb798-30" title="30">top_path <span class="op">=</span> os.path.join(_FILE_DIR_, <span class="st">&#39;top.pdb&#39;</span>)</a>
<a class="sourceLine" id="cb798-31" title="31">traj <span class="op">=</span> md.load(traj_path, top<span class="op">=</span>top_path)</a>
<a class="sourceLine" id="cb798-32" title="32">top <span class="op">=</span> traj.topology</a>
<a class="sourceLine" id="cb798-33" title="33">prot_idxs <span class="op">=</span> top.select(<span class="st">&#39;protein&#39;</span>)</a>
<a class="sourceLine" id="cb798-34" title="34">lig_idxs <span class="op">=</span> top.select(<span class="ss">F&#39;resname == </span><span class="sc">{</span>lig_str<span class="sc">}</span><span class="ss">&#39;</span>)</a>
<a class="sourceLine" id="cb798-35" title="35">traj2 <span class="op">=</span> md.load(traj_path, atom_indices<span class="op">=</span>prot_idxs, top<span class="op">=</span>top_path)</a>
<a class="sourceLine" id="cb798-36" title="36">traj3 <span class="op">=</span> md.load(traj_path, atom_indices<span class="op">=</span>lig_idxs, top<span class="op">=</span>top_path)</a>
<a class="sourceLine" id="cb798-37" title="37"></a>
<a class="sourceLine" id="cb798-38" title="38">dist <span class="op">=</span> []</a>
<a class="sourceLine" id="cb798-39" title="39"><span class="cf">for</span> i,j <span class="kw">in</span> <span class="bu">zip</span>(traj2,traj3):</a>
<a class="sourceLine" id="cb798-40" title="40">    com_a <span class="op">=</span> md.compute_center_of_mass(i)[<span class="dv">0</span>]</a>
<a class="sourceLine" id="cb798-41" title="41">    com_b <span class="op">=</span> md.compute_center_of_mass(j)[<span class="dv">0</span>]</a>
<a class="sourceLine" id="cb798-42" title="42">    dist.append(((com_a[<span class="dv">0</span>]<span class="op">-</span>com_b[<span class="dv">0</span>])<span class="op">**</span><span class="dv">2</span><span class="op">+</span>(com_a[<span class="dv">1</span>]<span class="op">-</span>com_b[<span class="dv">1</span>])<span class="op">**</span><span class="dv">2</span><span class="op">+</span>(com_a[<span class="dv">2</span>]<span class="op">-</span>com_b[<span class="dv">2</span>])<span class="op">**</span><span class="dv">2</span>)<span class="op">**</span><span class="fl">0.5</span>)</a>
<a class="sourceLine" id="cb798-43" title="43"></a>
<a class="sourceLine" id="cb798-44" title="44"><span class="co"># assert</span></a>
<a class="sourceLine" id="cb798-45" title="45"></a>
<a class="sourceLine" id="cb798-46" title="46">distances <span class="op">=</span> unbdistance(traj,lig_str)</a>
<a class="sourceLine" id="cb798-47" title="47"></a>
<a class="sourceLine" id="cb798-48" title="48">check <span class="op">=</span> math.isclose(dist[<span class="dv">0</span>],distances[<span class="dv">0</span>])</a>
<a class="sourceLine" id="cb798-49" title="49">check2 <span class="op">=</span> math.isclose(dist[<span class="op">-</span><span class="dv">1</span>],distances[<span class="op">-</span><span class="dv">1</span>])</a>
<a class="sourceLine" id="cb798-50" title="50">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> check <span class="kw">and</span> check2 <span class="cf">else</span> <span class="va">False</span> </a></code></pre></div>
<p>Output:</p>
<pre><code>&#39;Constant&#39; object has no attribute &#39;kind&#39;</code></pre>
<h4 id="run-3-72">Run 3</h4>
<div class="sourceCode" id="cb800"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb800-1" title="1"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb800-2" title="2"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb800-3" title="3"></a>
<a class="sourceLine" id="cb800-4" title="4"><span class="kw">def</span> unbdistance(traj,lig_str):</a>
<a class="sourceLine" id="cb800-5" title="5">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb800-6" title="6"><span class="co">    This function returns a list of distances between center of mass of</span></a>
<a class="sourceLine" id="cb800-7" title="7"><span class="co">    protein and center of mass of lig_str in every frame of trajectory</span></a>
<a class="sourceLine" id="cb800-8" title="8"><span class="co">    traj</span></a>
<a class="sourceLine" id="cb800-9" title="9"></a>
<a class="sourceLine" id="cb800-10" title="10"><span class="co">    traj is an mdtraj trajectory object</span></a>
<a class="sourceLine" id="cb800-11" title="11"><span class="co">    lig_str is a string with the residue name of the ligand</span></a>
<a class="sourceLine" id="cb800-12" title="12"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb800-13" title="13">    lig_ind <span class="op">=</span> traj.topology.select(<span class="st">&#39;resname &#39;</span> <span class="op">+</span> lig_str)</a>
<a class="sourceLine" id="cb800-14" title="14">    protein_ind <span class="op">=</span> traj.topology.select(<span class="st">&#39;protein&#39;</span>)</a>
<a class="sourceLine" id="cb800-15" title="15">    lig_com <span class="op">=</span> md.compute_center_of_mass(traj.atom_slice(lig_ind))</a>
<a class="sourceLine" id="cb800-16" title="16">    protein_com <span class="op">=</span> md.compute_center_of_mass(traj.atom_slice(protein_ind))</a>
<a class="sourceLine" id="cb800-17" title="17">    result <span class="op">=</span> np.sqrt(np.<span class="bu">sum</span>((lig_com <span class="op">-</span> protein_com)<span class="op">**</span><span class="dv">2</span>,axis<span class="op">=</span><span class="dv">1</span>))</a>
<a class="sourceLine" id="cb800-18" title="18">    <span class="cf">return</span> result</a>
<a class="sourceLine" id="cb800-19" title="19"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb800-20" title="20"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb800-21" title="21"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb800-22" title="22"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb800-23" title="23"></a>
<a class="sourceLine" id="cb800-24" title="24"></a>
<a class="sourceLine" id="cb800-25" title="25"><span class="co">#_FILE_DIR_ = &#39;.&#39;</span></a>
<a class="sourceLine" id="cb800-26" title="26">lig_str <span class="op">=</span> <span class="st">&#39;TMP&#39;</span></a>
<a class="sourceLine" id="cb800-27" title="27">traj_path <span class="op">=</span> os.path.join(_FILE_DIR_, <span class="st">&#39;traj.dcd&#39;</span>) </a>
<a class="sourceLine" id="cb800-28" title="28">top_path <span class="op">=</span> os.path.join(_FILE_DIR_, <span class="st">&#39;top.pdb&#39;</span>)</a>
<a class="sourceLine" id="cb800-29" title="29">traj <span class="op">=</span> md.load(traj_path, top<span class="op">=</span>top_path)</a>
<a class="sourceLine" id="cb800-30" title="30">top <span class="op">=</span> traj.topology</a>
<a class="sourceLine" id="cb800-31" title="31">prot_idxs <span class="op">=</span> top.select(<span class="st">&#39;protein&#39;</span>)</a>
<a class="sourceLine" id="cb800-32" title="32">lig_idxs <span class="op">=</span> top.select(<span class="ss">F&#39;resname == </span><span class="sc">{</span>lig_str<span class="sc">}</span><span class="ss">&#39;</span>)</a>
<a class="sourceLine" id="cb800-33" title="33">traj2 <span class="op">=</span> md.load(traj_path, atom_indices<span class="op">=</span>prot_idxs, top<span class="op">=</span>top_path)</a>
<a class="sourceLine" id="cb800-34" title="34">traj3 <span class="op">=</span> md.load(traj_path, atom_indices<span class="op">=</span>lig_idxs, top<span class="op">=</span>top_path)</a>
<a class="sourceLine" id="cb800-35" title="35"></a>
<a class="sourceLine" id="cb800-36" title="36">dist <span class="op">=</span> []</a>
<a class="sourceLine" id="cb800-37" title="37"><span class="cf">for</span> i,j <span class="kw">in</span> <span class="bu">zip</span>(traj2,traj3):</a>
<a class="sourceLine" id="cb800-38" title="38">    com_a <span class="op">=</span> md.compute_center_of_mass(i)[<span class="dv">0</span>]</a>
<a class="sourceLine" id="cb800-39" title="39">    com_b <span class="op">=</span> md.compute_center_of_mass(j)[<span class="dv">0</span>]</a>
<a class="sourceLine" id="cb800-40" title="40">    dist.append(((com_a[<span class="dv">0</span>]<span class="op">-</span>com_b[<span class="dv">0</span>])<span class="op">**</span><span class="dv">2</span><span class="op">+</span>(com_a[<span class="dv">1</span>]<span class="op">-</span>com_b[<span class="dv">1</span>])<span class="op">**</span><span class="dv">2</span><span class="op">+</span>(com_a[<span class="dv">2</span>]<span class="op">-</span>com_b[<span class="dv">2</span>])<span class="op">**</span><span class="dv">2</span>)<span class="op">**</span><span class="fl">0.5</span>)</a>
<a class="sourceLine" id="cb800-41" title="41"></a>
<a class="sourceLine" id="cb800-42" title="42"><span class="co"># assert</span></a>
<a class="sourceLine" id="cb800-43" title="43"></a>
<a class="sourceLine" id="cb800-44" title="44">distances <span class="op">=</span> unbdistance(traj,lig_str)</a>
<a class="sourceLine" id="cb800-45" title="45"></a>
<a class="sourceLine" id="cb800-46" title="46">check <span class="op">=</span> math.isclose(dist[<span class="dv">0</span>],distances[<span class="dv">0</span>])</a>
<a class="sourceLine" id="cb800-47" title="47">check2 <span class="op">=</span> math.isclose(dist[<span class="op">-</span><span class="dv">1</span>],distances[<span class="op">-</span><span class="dv">1</span>])</a>
<a class="sourceLine" id="cb800-48" title="48">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> check <span class="kw">and</span> check2 <span class="cf">else</span> <span class="va">False</span> </a></code></pre></div>
<p>Output:</p>
<pre><code>&#39;Constant&#39; object has no attribute &#39;kind&#39;</code></pre>
<h4 id="run-4-72">Run 4</h4>
<div class="sourceCode" id="cb802"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb802-1" title="1"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb802-2" title="2"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb802-3" title="3"></a>
<a class="sourceLine" id="cb802-4" title="4"><span class="kw">def</span> unbdistance(traj,lig_str):</a>
<a class="sourceLine" id="cb802-5" title="5">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb802-6" title="6"><span class="co">    This function returns a list of distances between center of mass of</span></a>
<a class="sourceLine" id="cb802-7" title="7"><span class="co">    protein and center of mass of lig_str in every frame of trajectory</span></a>
<a class="sourceLine" id="cb802-8" title="8"><span class="co">    traj</span></a>
<a class="sourceLine" id="cb802-9" title="9"></a>
<a class="sourceLine" id="cb802-10" title="10"><span class="co">    traj is an mdtraj trajectory object</span></a>
<a class="sourceLine" id="cb802-11" title="11"><span class="co">    lig_str is a string with the residue name of the ligand</span></a>
<a class="sourceLine" id="cb802-12" title="12"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb802-13" title="13">    lig_res <span class="op">=</span> traj.topology.select(<span class="st">&#39;resname &#39;</span><span class="op">+</span>lig_str)</a>
<a class="sourceLine" id="cb802-14" title="14">    lig_com <span class="op">=</span> md.compute_center_of_mass(traj.atom_slice(lig_res))</a>
<a class="sourceLine" id="cb802-15" title="15">    prot_com <span class="op">=</span> md.compute_center_of_mass(traj.atom_slice(traj.topology.select(<span class="st">&#39;protein&#39;</span>)))</a>
<a class="sourceLine" id="cb802-16" title="16">    result <span class="op">=</span> np.linalg.norm(lig_com<span class="op">-</span>prot_com,axis<span class="op">=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb802-17" title="17">    <span class="cf">return</span> result</a>
<a class="sourceLine" id="cb802-18" title="18"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb802-19" title="19"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb802-20" title="20"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb802-21" title="21"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb802-22" title="22"></a>
<a class="sourceLine" id="cb802-23" title="23"></a>
<a class="sourceLine" id="cb802-24" title="24"><span class="co">#_FILE_DIR_ = &#39;.&#39;</span></a>
<a class="sourceLine" id="cb802-25" title="25">lig_str <span class="op">=</span> <span class="st">&#39;TMP&#39;</span></a>
<a class="sourceLine" id="cb802-26" title="26">traj_path <span class="op">=</span> os.path.join(_FILE_DIR_, <span class="st">&#39;traj.dcd&#39;</span>) </a>
<a class="sourceLine" id="cb802-27" title="27">top_path <span class="op">=</span> os.path.join(_FILE_DIR_, <span class="st">&#39;top.pdb&#39;</span>)</a>
<a class="sourceLine" id="cb802-28" title="28">traj <span class="op">=</span> md.load(traj_path, top<span class="op">=</span>top_path)</a>
<a class="sourceLine" id="cb802-29" title="29">top <span class="op">=</span> traj.topology</a>
<a class="sourceLine" id="cb802-30" title="30">prot_idxs <span class="op">=</span> top.select(<span class="st">&#39;protein&#39;</span>)</a>
<a class="sourceLine" id="cb802-31" title="31">lig_idxs <span class="op">=</span> top.select(<span class="ss">F&#39;resname == </span><span class="sc">{</span>lig_str<span class="sc">}</span><span class="ss">&#39;</span>)</a>
<a class="sourceLine" id="cb802-32" title="32">traj2 <span class="op">=</span> md.load(traj_path, atom_indices<span class="op">=</span>prot_idxs, top<span class="op">=</span>top_path)</a>
<a class="sourceLine" id="cb802-33" title="33">traj3 <span class="op">=</span> md.load(traj_path, atom_indices<span class="op">=</span>lig_idxs, top<span class="op">=</span>top_path)</a>
<a class="sourceLine" id="cb802-34" title="34"></a>
<a class="sourceLine" id="cb802-35" title="35">dist <span class="op">=</span> []</a>
<a class="sourceLine" id="cb802-36" title="36"><span class="cf">for</span> i,j <span class="kw">in</span> <span class="bu">zip</span>(traj2,traj3):</a>
<a class="sourceLine" id="cb802-37" title="37">    com_a <span class="op">=</span> md.compute_center_of_mass(i)[<span class="dv">0</span>]</a>
<a class="sourceLine" id="cb802-38" title="38">    com_b <span class="op">=</span> md.compute_center_of_mass(j)[<span class="dv">0</span>]</a>
<a class="sourceLine" id="cb802-39" title="39">    dist.append(((com_a[<span class="dv">0</span>]<span class="op">-</span>com_b[<span class="dv">0</span>])<span class="op">**</span><span class="dv">2</span><span class="op">+</span>(com_a[<span class="dv">1</span>]<span class="op">-</span>com_b[<span class="dv">1</span>])<span class="op">**</span><span class="dv">2</span><span class="op">+</span>(com_a[<span class="dv">2</span>]<span class="op">-</span>com_b[<span class="dv">2</span>])<span class="op">**</span><span class="dv">2</span>)<span class="op">**</span><span class="fl">0.5</span>)</a>
<a class="sourceLine" id="cb802-40" title="40"></a>
<a class="sourceLine" id="cb802-41" title="41"><span class="co"># assert</span></a>
<a class="sourceLine" id="cb802-42" title="42"></a>
<a class="sourceLine" id="cb802-43" title="43">distances <span class="op">=</span> unbdistance(traj,lig_str)</a>
<a class="sourceLine" id="cb802-44" title="44"></a>
<a class="sourceLine" id="cb802-45" title="45">check <span class="op">=</span> math.isclose(dist[<span class="dv">0</span>],distances[<span class="dv">0</span>])</a>
<a class="sourceLine" id="cb802-46" title="46">check2 <span class="op">=</span> math.isclose(dist[<span class="op">-</span><span class="dv">1</span>],distances[<span class="op">-</span><span class="dv">1</span>])</a>
<a class="sourceLine" id="cb802-47" title="47">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> check <span class="kw">and</span> check2 <span class="cf">else</span> <span class="va">False</span> </a></code></pre></div>
<p>Output:</p>
<pre><code>&#39;Constant&#39; object has no attribute &#39;kind&#39;</code></pre>
</details>
<h2 id="human-evaluations">Human Evaluations</h2>
<p>Follow links to add evaluation to evaluate</p>
<h3 id="gaussian_input_emin">gaussian_input_emin</h3>
<ul class="incremental">
<li><a href="human/result_gaussian_input_emin_d29Apr2022_T0.2_r0.html">Reponse 0</a></li>
<li><a href="human/result_gaussian_input_emin_d29Apr2022_T0.2_r1.html">Reponse 1</a></li>
<li><a href="human/result_gaussian_input_emin_d29Apr2022_T0.2_r2.html">Reponse 2</a></li>
</ul>
<h3 id="mc_harmonic">mc_harmonic</h3>
<ul class="incremental">
<li><a href="human/result_mc_harmonic_d29Apr2022_T0.2_r0.html">Reponse 0</a></li>
<li><a href="human/result_mc_harmonic_d29Apr2022_T0.2_r1.html">Reponse 1</a></li>
<li><a href="human/result_mc_harmonic_d29Apr2022_T0.2_r2.html">Reponse 2</a></li>
</ul>
<h3 id="mc_ising">mc_ising</h3>
<ul class="incremental">
<li><a href="human/result_mc_ising_d29Apr2022_T0.2_r0.html">Reponse 0</a></li>
<li><a href="human/result_mc_ising_d29Apr2022_T0.2_r1.html">Reponse 1</a></li>
<li><a href="human/result_mc_ising_d29Apr2022_T0.2_r2.html">Reponse 2</a></li>
</ul>
<p>EOF while scanning triple-quoted string literal (<string>, line 104) ### nwchem_input_emin</p>
<ul class="incremental">
<li><a href="human/result_nwchem_input_emin_d29Apr2022_T0.2_r0.html">Reponse 0</a></li>
<li><a href="human/result_nwchem_input_emin_d29Apr2022_T0.2_r1.html">Reponse 1</a></li>
<li><a href="human/result_nwchem_input_emin_d29Apr2022_T0.2_r2.html">Reponse 2</a></li>
</ul>
<h3 id="plot_3d_sin">plot_3d_sin</h3>
<ul class="incremental">
<li><a href="human/result_plot_3d_sin_d29Apr2022_T0.2_r0.html">Reponse 0</a></li>
<li><a href="human/result_plot_3d_sin_d29Apr2022_T0.2_r1.html">Reponse 1</a></li>
<li><a href="human/result_plot_3d_sin_d29Apr2022_T0.2_r2.html">Reponse 2</a></li>
</ul>
<h3 id="plot_bar">plot_bar</h3>
<ul class="incremental">
<li><a href="human/result_plot_bar_d29Apr2022_T0.2_r0.html">Reponse 0</a></li>
<li><a href="human/result_plot_bar_d29Apr2022_T0.2_r1.html">Reponse 1</a></li>
<li><a href="human/result_plot_bar_d29Apr2022_T0.2_r2.html">Reponse 2</a></li>
</ul>
<h3 id="plot_contour">plot_contour</h3>
<ul class="incremental">
<li><a href="human/result_plot_contour_d29Apr2022_T0.2_r0.html">Reponse 0</a></li>
<li><a href="human/result_plot_contour_d29Apr2022_T0.2_r1.html">Reponse 1</a></li>
<li><a href="human/result_plot_contour_d29Apr2022_T0.2_r2.html">Reponse 2</a></li>
</ul>
<p>s must be a scalar, or float array-like with the same size as x and y s must be a scalar, or float array-like with the same size as x and y ### plot_correlation</p>
<ul class="incremental">
<li><a href="human/result_plot_correlation_d29Apr2022_T0.2_r0.html">Reponse 0</a></li>
<li><a href="human/result_plot_correlation_d29Apr2022_T0.2_r1.html">Reponse 1</a></li>
<li><a href="human/result_plot_correlation_d29Apr2022_T0.2_r2.html">Reponse 2</a></li>
</ul>
<h3 id="plot_dual_axis">plot_dual_axis</h3>
<ul class="incremental">
<li><a href="human/result_plot_dual_axis_d29Apr2022_T0.2_r0.html">Reponse 0</a></li>
<li><a href="human/result_plot_dual_axis_d29Apr2022_T0.2_r1.html">Reponse 1</a></li>
<li><a href="human/result_plot_dual_axis_d29Apr2022_T0.2_r2.html">Reponse 2</a></li>
</ul>
<p>Unrecognized marker style ‘😀’ Unrecognized marker style ‘😀’ Unrecognized marker style ‘😀’ ### plot_emoji</p>
<ul class="incremental">
<li><a href="human/result_plot_emoji_d29Apr2022_T0.2_r0.html">Reponse 0</a></li>
<li><a href="human/result_plot_emoji_d29Apr2022_T0.2_r1.html">Reponse 1</a></li>
<li><a href="human/result_plot_emoji_d29Apr2022_T0.2_r2.html">Reponse 2</a></li>
</ul>
<p>‘Polygon’ object has no property ‘normed’ ### plot_outside_legend</p>
<ul class="incremental">
<li><a href="human/result_plot_outside_legend_d29Apr2022_T0.2_r0.html">Reponse 0</a></li>
<li><a href="human/result_plot_outside_legend_d29Apr2022_T0.2_r1.html">Reponse 1</a></li>
<li><a href="human/result_plot_outside_legend_d29Apr2022_T0.2_r2.html">Reponse 2</a></li>
</ul>
<p>Adjustable ‘box’ is not allowed in a twinned Axes; use ‘datalim’ instead Adjustable ‘box’ is not allowed in a twinned Axes; use ‘datalim’ instead ### plot_pointsize</p>
<ul class="incremental">
<li><a href="human/result_plot_pointsize_d29Apr2022_T0.2_r0.html">Reponse 0</a></li>
<li><a href="human/result_plot_pointsize_d29Apr2022_T0.2_r1.html">Reponse 1</a></li>
<li><a href="human/result_plot_pointsize_d29Apr2022_T0.2_r2.html">Reponse 2</a></li>
</ul>
<p>Adjustable ‘box’ is not allowed in a twinned Axes; use ‘datalim’ instead Adjustable ‘box’ is not allowed in a twinned Axes; use ‘datalim’ instead Adjustable ‘box’ is not allowed in a twinned Axes; use ‘datalim’ instead ### plot_sin</p>
<ul class="incremental">
<li><a href="human/result_plot_sin_d29Apr2022_T0.2_r0.html">Reponse 0</a></li>
<li><a href="human/result_plot_sin_d29Apr2022_T0.2_r1.html">Reponse 1</a></li>
<li><a href="human/result_plot_sin_d29Apr2022_T0.2_r2.html">Reponse 2</a></li>
</ul>
<h3 id="plot_sin_polar">plot_sin_polar</h3>
<ul class="incremental">
<li><a href="human/result_plot_sin_polar_d29Apr2022_T0.2_r0.html">Reponse 0</a></li>
<li><a href="human/result_plot_sin_polar_d29Apr2022_T0.2_r1.html">Reponse 1</a></li>
<li><a href="human/result_plot_sin_polar_d29Apr2022_T0.2_r2.html">Reponse 2</a></li>
</ul>
<h3 id="protein-render">protein-render</h3>
<ul class="incremental">
<li><a href="human/result_protein-render_d29Apr2022_T0.2_r0.html">Reponse 0</a></li>
<li><a href="human/result_protein-render_d29Apr2022_T0.2_r1.html">Reponse 1</a></li>
<li><a href="human/result_protein-render_d29Apr2022_T0.2_r2.html">Reponse 2</a></li>
</ul>
</body>
</html>
