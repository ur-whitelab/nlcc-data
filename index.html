<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>nlcc report</title>
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
  <style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
</head>
<body>
<header id="title-block-header">
<h1 class="title">nlcc report</h1>
</header>
<nav id="TOC">
<ul class="incremental">
<li><a href="#human-evaluations">Human Evaluations</a><ul class="incremental">
<li><a href="#gaussian_input_emin">gaussian_input_emin</a></li>
<li><a href="#mc_harmonic">mc_harmonic</a></li>
<li><a href="#mc_ising">mc_ising</a></li>
<li><a href="#nwchem_input_emin">nwchem_input_emin</a></li>
<li><a href="#plot_3d_sin">plot_3d_sin</a></li>
<li><a href="#plot_bar">plot_bar</a></li>
<li><a href="#plot_contour">plot_contour</a></li>
<li><a href="#plot_correlation">plot_correlation</a></li>
<li><a href="#plot_dual_axis">plot_dual_axis</a></li>
<li><a href="#plot_emoji">plot_emoji</a></li>
<li><a href="#plot_outside_legend">plot_outside_legend</a></li>
<li><a href="#plot_pointsize">plot_pointsize</a></li>
<li><a href="#plot_sin">plot_sin</a></li>
<li><a href="#plot_sin_polar">plot_sin_polar</a></li>
<li><a href="#protein-render">protein-render</a></li>
</ul></li>
<li><a href="#test-report">Test Report</a><ul class="incremental">
<li><a href="#global-parameters">Global Parameters</a></li>
<li><a href="#code-results">Code Results</a></li>
<li><a href="#details">Details</a></li>
</ul></li>
<li><a href="#test-report-1">Test Report</a><ul class="incremental">
<li><a href="#global-parameters-1">Global Parameters</a></li>
<li><a href="#code-results-1">Code Results</a></li>
<li><a href="#details-1">Details</a></li>
</ul></li>
<li><a href="#test-report-2">Test Report</a><ul class="incremental">
<li><a href="#global-parameters-2">Global Parameters</a></li>
<li><a href="#code-results-2">Code Results</a></li>
<li><a href="#details-2">Details</a></li>
</ul></li>
</ul>
</nav>
<h2 id="human-evaluations">Human Evaluations</h2>
<p>Follow links to add evaluation to evaluate</p>
<h3 id="gaussian_input_emin">gaussian_input_emin</h3>
<ul class="incremental">
<li><a href="human/result_gaussian_input_emin_d08May2022_T0.2_r0.html">Reponse 0</a></li>
<li><a href="human/result_gaussian_input_emin_d08May2022_T0.2_r1.html">Reponse 1</a></li>
<li><a href="human/result_gaussian_input_emin_d08May2022_T0.2_r2.html">Reponse 2</a></li>
</ul>
<h3 id="mc_harmonic">mc_harmonic</h3>
<ul class="incremental">
<li><a href="human/result_mc_harmonic_d08May2022_T0.2_r0.html">Reponse 0</a></li>
<li><a href="human/result_mc_harmonic_d08May2022_T0.2_r1.html">Reponse 1</a></li>
<li><a href="human/result_mc_harmonic_d08May2022_T0.2_r2.html">Reponse 2</a></li>
</ul>
<h3 id="mc_ising">mc_ising</h3>
<ul class="incremental">
<li><a href="human/result_mc_ising_d08May2022_T0.2_r0.html">Reponse 0</a></li>
<li><a href="human/result_mc_ising_d08May2022_T0.2_r1.html">Reponse 1</a></li>
<li><a href="human/result_mc_ising_d08May2022_T0.2_r2.html">Reponse 2</a></li>
</ul>
<h3 id="nwchem_input_emin">nwchem_input_emin</h3>
<ul class="incremental">
<li><a href="human/result_nwchem_input_emin_d08May2022_T0.2_r0.html">Reponse 0</a></li>
<li><a href="human/result_nwchem_input_emin_d08May2022_T0.2_r1.html">Reponse 1</a></li>
<li><a href="human/result_nwchem_input_emin_d08May2022_T0.2_r2.html">Reponse 2</a></li>
</ul>
<h3 id="plot_3d_sin">plot_3d_sin</h3>
<ul class="incremental">
<li><a href="human/result_plot_3d_sin_d08May2022_T0.2_r0.html">Reponse 0</a></li>
<li><a href="human/result_plot_3d_sin_d08May2022_T0.2_r1.html">Reponse 1</a></li>
<li><a href="human/result_plot_3d_sin_d08May2022_T0.2_r2.html">Reponse 2</a></li>
</ul>
<h3 id="plot_bar">plot_bar</h3>
<ul class="incremental">
<li><a href="human/result_plot_bar_d08May2022_T0.2_r0.html">Reponse 0</a></li>
<li><a href="human/result_plot_bar_d08May2022_T0.2_r1.html">Reponse 1</a></li>
<li><a href="human/result_plot_bar_d08May2022_T0.2_r2.html">Reponse 2</a></li>
</ul>
<h3 id="plot_contour">plot_contour</h3>
<ul class="incremental">
<li><a href="human/result_plot_contour_d08May2022_T0.2_r0.html">Reponse 0</a></li>
<li><a href="human/result_plot_contour_d08May2022_T0.2_r1.html">Reponse 1</a></li>
<li><a href="human/result_plot_contour_d08May2022_T0.2_r2.html">Reponse 2</a></li>
</ul>
<h3 id="plot_correlation">plot_correlation</h3>
<ul class="incremental">
<li><a href="human/result_plot_correlation_d08May2022_T0.2_r0.html">Reponse 0</a></li>
<li><a href="human/result_plot_correlation_d08May2022_T0.2_r1.html">Reponse 1</a></li>
<li><a href="human/result_plot_correlation_d08May2022_T0.2_r2.html">Reponse 2</a></li>
</ul>
<h3 id="plot_dual_axis">plot_dual_axis</h3>
<ul class="incremental">
<li><a href="human/result_plot_dual_axis_d08May2022_T0.2_r0.html">Reponse 0</a></li>
<li><a href="human/result_plot_dual_axis_d08May2022_T0.2_r1.html">Reponse 1</a></li>
<li><a href="human/result_plot_dual_axis_d08May2022_T0.2_r2.html">Reponse 2</a></li>
</ul>
<h3 id="plot_emoji">plot_emoji</h3>
<ul class="incremental">
<li><a href="human/result_plot_emoji_d08May2022_T0.2_r0.html">Reponse 0</a></li>
<li><a href="human/result_plot_emoji_d08May2022_T0.2_r1.html">Reponse 1</a></li>
<li><a href="human/result_plot_emoji_d08May2022_T0.2_r2.html">Reponse 2</a></li>
</ul>
<h3 id="plot_outside_legend">plot_outside_legend</h3>
<ul class="incremental">
<li><a href="human/result_plot_outside_legend_d08May2022_T0.2_r0.html">Reponse 0</a></li>
<li><a href="human/result_plot_outside_legend_d08May2022_T0.2_r1.html">Reponse 1</a></li>
<li><a href="human/result_plot_outside_legend_d08May2022_T0.2_r2.html">Reponse 2</a></li>
</ul>
<h3 id="plot_pointsize">plot_pointsize</h3>
<ul class="incremental">
<li><a href="human/result_plot_pointsize_d08May2022_T0.2_r0.html">Reponse 0</a></li>
<li><a href="human/result_plot_pointsize_d08May2022_T0.2_r1.html">Reponse 1</a></li>
<li><a href="human/result_plot_pointsize_d08May2022_T0.2_r2.html">Reponse 2</a></li>
</ul>
<h3 id="plot_sin">plot_sin</h3>
<ul class="incremental">
<li><a href="human/result_plot_sin_d08May2022_T0.2_r0.html">Reponse 0</a></li>
<li><a href="human/result_plot_sin_d08May2022_T0.2_r1.html">Reponse 1</a></li>
<li><a href="human/result_plot_sin_d08May2022_T0.2_r2.html">Reponse 2</a></li>
</ul>
<h3 id="plot_sin_polar">plot_sin_polar</h3>
<ul class="incremental">
<li><a href="human/result_plot_sin_polar_d08May2022_T0.2_r0.html">Reponse 0</a></li>
<li><a href="human/result_plot_sin_polar_d08May2022_T0.2_r1.html">Reponse 1</a></li>
<li><a href="human/result_plot_sin_polar_d08May2022_T0.2_r2.html">Reponse 2</a></li>
</ul>
<h3 id="protein-render">protein-render</h3>
<ul class="incremental">
<li><a href="human/result_protein-render_d08May2022_T0.2_r0.html">Reponse 0</a></li>
<li><a href="human/result_protein-render_d08May2022_T0.2_r1.html">Reponse 1</a></li>
<li><a href="human/result_protein-render_d08May2022_T0.2_r2.html">Reponse 2</a></li>
</ul>
<h2 id="test-report">Test Report</h2>
<h3 id="global-parameters">Global Parameters</h3>
<ul class="incremental">
<li>Engine = openai</li>
<li><p>T = 0.2</p></li>
<li><p>Prompt Override = insert</p></li>
</ul>
<h3 id="code-results">Code Results</h3>
<table>
<thead>
<tr class="header">
<th>Test</th>
<th>Run 0</th>
<th>Run 1</th>
<th>Run 2</th>
<th>Run 3</th>
<th>Run 4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>aa_polarity</td>
<td>Pass</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Pass</td>
</tr>
<tr class="even">
<td>adiabatic_expansion</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
</tr>
<tr class="odd">
<td>alignment</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
</tr>
<tr class="even">
<td>angle</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
</tr>
<tr class="odd">
<td>aromatic_aa</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
</tr>
<tr class="even">
<td>arrhenius</td>
<td>Pass</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Pass</td>
</tr>
<tr class="odd">
<td>bimolecular</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
</tr>
<tr class="even">
<td>bb_rad</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
</tr>
<tr class="odd">
<td>blast</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
</tr>
<tr class="even">
<td>bravais</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
</tr>
<tr class="odd">
<td>canonicalize</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
</tr>
<tr class="even">
<td>carnot_efficiency</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
</tr>
<tr class="odd">
<td>claussius</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Fail</td>
</tr>
<tr class="even">
<td>compare_electronegativity</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
</tr>
<tr class="odd">
<td>condiff_1d</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
</tr>
<tr class="even">
<td>cubes</td>
<td>Pass</td>
<td>Fail</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
</tr>
<tr class="odd">
<td>de_broglie</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
</tr>
<tr class="even">
<td>derivative1d-ch</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
</tr>
<tr class="odd">
<td>derivative_2deg</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
</tr>
<tr class="even">
<td>descriptors</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Pass</td>
</tr>
<tr class="odd">
<td>dipole</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
</tr>
<tr class="even">
<td>dou</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
</tr>
<tr class="odd">
<td>eigen-ch</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
</tr>
<tr class="even">
<td>eigen</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Fail</td>
<td>Pass</td>
</tr>
<tr class="odd">
<td>element_mass</td>
<td>Pass</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
</tr>
<tr class="even">
<td>element_name</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
</tr>
<tr class="odd">
<td>energy_of_e</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
</tr>
<tr class="even">
<td>find_indices</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
</tr>
<tr class="odd">
<td>force_constant</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
</tr>
<tr class="even">
<td>fourier_1d</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
</tr>
<tr class="odd">
<td>freezing_depression</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
</tr>
<tr class="even">
<td>genpos</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
</tr>
<tr class="odd">
<td>heating_water</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
</tr>
<tr class="even">
<td>hydrophobic_res</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Pass</td>
<td>Fail</td>
</tr>
<tr class="odd">
<td>ideal_gas</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
</tr>
<tr class="even">
<td>integral</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
</tr>
<tr class="odd">
<td>trap</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
</tr>
<tr class="even">
<td>invert_matrix</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
</tr>
<tr class="odd">
<td>iupac2smiles</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
</tr>
<tr class="even">
<td>kld</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
</tr>
<tr class="odd">
<td>langevin_dynamics</td>
<td>Pass</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Pass</td>
</tr>
<tr class="even">
<td>lipinski_rule_of_five</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
</tr>
<tr class="odd">
<td>mape</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
</tr>
<tr class="even">
<td>mapping_operator</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
</tr>
<tr class="odd">
<td>matpow</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
</tr>
<tr class="even">
<td>matrix_factorial</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
</tr>
<tr class="odd">
<td>max-boltz</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
</tr>
<tr class="even">
<td>michaelis</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
</tr>
<tr class="odd">
<td>mol_charge</td>
<td>Fail</td>
<td>Pass</td>
<td>Fail</td>
<td>Pass</td>
<td>Fail</td>
</tr>
<tr class="even">
<td>net_charge</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
</tr>
<tr class="odd">
<td>solve_ode</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
</tr>
<tr class="even">
<td>ohe</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
</tr>
<tr class="odd">
<td>osmotic_pressure</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
</tr>
<tr class="even">
<td>pair_wise</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
</tr>
<tr class="odd">
<td>pi</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
</tr>
<tr class="even">
<td>pib_1d</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
</tr>
<tr class="odd">
<td>pred_interval</td>
<td>Fail</td>
<td>Pass</td>
<td>Pass</td>
<td>Fail</td>
<td>Fail</td>
</tr>
<tr class="even">
<td>pubchem</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
</tr>
<tr class="odd">
<td>pyscf_energy</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
</tr>
<tr class="even">
<td>qed</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
</tr>
<tr class="odd">
<td>quantile</td>
<td>Fail</td>
<td>Fail</td>
<td>Pass</td>
<td>Fail</td>
<td>Pass</td>
</tr>
<tr class="even">
<td>random_walk</td>
<td>Pass</td>
<td>Pass</td>
<td>Fail</td>
<td>Pass</td>
<td>Fail</td>
</tr>
<tr class="odd">
<td>rank</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
</tr>
<tr class="even">
<td>rank</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
</tr>
<tr class="odd">
<td>remove-water</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
</tr>
<tr class="even">
<td>rms_velocity</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Pass</td>
</tr>
<tr class="odd">
<td>rmse</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
</tr>
<tr class="even">
<td>rog</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
</tr>
<tr class="odd">
<td>sasa</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
</tr>
<tr class="even">
<td>scaffold</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
</tr>
<tr class="odd">
<td>seq-align</td>
<td>Fail</td>
<td>Pass</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
</tr>
<tr class="even">
<td>seq-trans</td>
<td>Pass</td>
<td>Fail</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
</tr>
<tr class="odd">
<td>sequence</td>
<td>Fail</td>
<td>Fail</td>
<td>Pass</td>
<td>Fail</td>
<td>Fail</td>
</tr>
<tr class="even">
<td>sle</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
</tr>
<tr class="odd">
<td>spectral_r</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
</tr>
<tr class="even">
<td>find_peaks</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
</tr>
<tr class="odd">
<td>speed_of_sound</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
</tr>
<tr class="even">
<td>substructure</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
</tr>
<tr class="odd">
<td>tanimoto</td>
<td>Pass</td>
<td>Fail</td>
<td>Pass</td>
<td>Pass</td>
<td>Fail</td>
</tr>
<tr class="even">
<td>unbdistance</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
</tr>
</tbody>
</table>
<h3 id="details">Details</h3>
<details>
<p><summary>aa_polarity</summary></p>
<h4 id="query">Query</h4>
<div class="sourceCode" id="cb1"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb1-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb1-3" title="3"></a>
<a class="sourceLine" id="cb1-4" title="4"><span class="kw">def</span> polar_count(sequence):</a>
<a class="sourceLine" id="cb1-5" title="5">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1-6" title="6"><span class="co">    This function counts the number of polar uncharged amino acids in the given sequence</span></a>
<a class="sourceLine" id="cb1-7" title="7"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1-8" title="8">    [insert]</a>
<a class="sourceLine" id="cb1-9" title="9">    <span class="cf">return</span> count</a></code></pre></div>
<h4 id="run-0">Run 0</h4>
<div class="sourceCode" id="cb2"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb2-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb2-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb2-3" title="3"></a>
<a class="sourceLine" id="cb2-4" title="4"><span class="kw">def</span> polar_count(sequence):</a>
<a class="sourceLine" id="cb2-5" title="5">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb2-6" title="6"><span class="co">    This function counts the number of polar uncharged amino acids in the given sequence</span></a>
<a class="sourceLine" id="cb2-7" title="7"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb2-8" title="8">    count <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb2-9" title="9">    <span class="cf">for</span> amino <span class="kw">in</span> sequence:</a>
<a class="sourceLine" id="cb2-10" title="10">        <span class="cf">if</span> amino <span class="kw">in</span> [<span class="st">&quot;Q&quot;</span>, <span class="st">&quot;N&quot;</span>, <span class="st">&quot;H&quot;</span>, <span class="st">&quot;S&quot;</span>, <span class="st">&quot;T&quot;</span>, <span class="st">&quot;Y&quot;</span>, <span class="st">&quot;C&quot;</span>]:</a>
<a class="sourceLine" id="cb2-11" title="11">            count <span class="op">+=</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb2-12" title="12">    <span class="cf">return</span> count</a>
<a class="sourceLine" id="cb2-13" title="13"></a>
<a class="sourceLine" id="cb2-14" title="14">sample_sequence <span class="op">=</span> <span class="st">&quot;AAAATTVVVVPPPSREREPPII&quot;</span></a>
<a class="sourceLine" id="cb2-15" title="15"></a>
<a class="sourceLine" id="cb2-16" title="16">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> polar_count(sample_sequence) <span class="op">==</span> <span class="dv">3</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1">Run 1</h4>
<div class="sourceCode" id="cb4"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb4-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb4-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb4-3" title="3"></a>
<a class="sourceLine" id="cb4-4" title="4"><span class="kw">def</span> polar_count(sequence):</a>
<a class="sourceLine" id="cb4-5" title="5">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb4-6" title="6"><span class="co">    This function counts the number of polar uncharged amino acids in the given sequence</span></a>
<a class="sourceLine" id="cb4-7" title="7"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb4-8" title="8">    count <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb4-9" title="9">    <span class="cf">for</span> i <span class="kw">in</span> sequence:</a>
<a class="sourceLine" id="cb4-10" title="10">        <span class="cf">if</span> i <span class="op">==</span> <span class="st">&#39;R&#39;</span> <span class="kw">or</span> i <span class="op">==</span> <span class="st">&#39;K&#39;</span> <span class="kw">or</span> i <span class="op">==</span> <span class="st">&#39;D&#39;</span> <span class="kw">or</span> i <span class="op">==</span> <span class="st">&#39;E&#39;</span> <span class="kw">or</span> i <span class="op">==</span> <span class="st">&#39;Q&#39;</span> <span class="kw">or</span> i <span class="op">==</span> <span class="st">&#39;N&#39;</span> <span class="kw">or</span> i <span class="op">==</span> <span class="st">&#39;H&#39;</span> <span class="kw">or</span> i <span class="op">==</span> <span class="st">&#39;S&#39;</span> <span class="kw">or</span> i <span class="op">==</span> <span class="st">&#39;T&#39;</span> <span class="kw">or</span> i <span class="op">==</span> <span class="st">&#39;Y&#39;</span> <span class="kw">or</span> i <span class="op">==</span> <span class="st">&#39;C&#39;</span> <span class="kw">or</span> i <span class="op">==</span> <span class="st">&#39;M&#39;</span> <span class="kw">or</span> i <span class="op">==</span> <span class="st">&#39;W&#39;</span>:</a>
<a class="sourceLine" id="cb4-11" title="11">            count <span class="op">+=</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb4-12" title="12">    <span class="cf">return</span> count</a>
<a class="sourceLine" id="cb4-13" title="13"></a>
<a class="sourceLine" id="cb4-14" title="14">sample_sequence <span class="op">=</span> <span class="st">&quot;AAAATTVVVVPPPSREREPPII&quot;</span></a>
<a class="sourceLine" id="cb4-15" title="15"></a>
<a class="sourceLine" id="cb4-16" title="16">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> polar_count(sample_sequence) <span class="op">==</span> <span class="dv">3</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2">Run 2</h4>
<div class="sourceCode" id="cb6"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb6-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb6-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb6-3" title="3"></a>
<a class="sourceLine" id="cb6-4" title="4"><span class="kw">def</span> polar_count(sequence):</a>
<a class="sourceLine" id="cb6-5" title="5">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb6-6" title="6"><span class="co">    This function counts the number of polar uncharged amino acids in the given sequence</span></a>
<a class="sourceLine" id="cb6-7" title="7"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb6-8" title="8">    count <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb6-9" title="9">    <span class="cf">for</span> aa <span class="kw">in</span> sequence:</a>
<a class="sourceLine" id="cb6-10" title="10">        <span class="cf">if</span> aa <span class="kw">in</span> [<span class="st">&#39;R&#39;</span>, <span class="st">&#39;K&#39;</span>, <span class="st">&#39;D&#39;</span>, <span class="st">&#39;E&#39;</span>, <span class="st">&#39;H&#39;</span>, <span class="st">&#39;Q&#39;</span>, <span class="st">&#39;N&#39;</span>, <span class="st">&#39;S&#39;</span>, <span class="st">&#39;T&#39;</span>, <span class="st">&#39;Y&#39;</span>, <span class="st">&#39;C&#39;</span>, <span class="st">&#39;M&#39;</span>, <span class="st">&#39;W&#39;</span>]:</a>
<a class="sourceLine" id="cb6-11" title="11">            count <span class="op">+=</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb6-12" title="12">    <span class="cf">return</span> count</a>
<a class="sourceLine" id="cb6-13" title="13"></a>
<a class="sourceLine" id="cb6-14" title="14">sample_sequence <span class="op">=</span> <span class="st">&quot;AAAATTVVVVPPPSREREPPII&quot;</span></a>
<a class="sourceLine" id="cb6-15" title="15"></a>
<a class="sourceLine" id="cb6-16" title="16">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> polar_count(sample_sequence) <span class="op">==</span> <span class="dv">3</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3">Run 3</h4>
<div class="sourceCode" id="cb8"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb8-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb8-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb8-3" title="3"></a>
<a class="sourceLine" id="cb8-4" title="4"><span class="kw">def</span> polar_count(sequence):</a>
<a class="sourceLine" id="cb8-5" title="5">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb8-6" title="6"><span class="co">    This function counts the number of polar uncharged amino acids in the given sequence</span></a>
<a class="sourceLine" id="cb8-7" title="7"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb8-8" title="8">    count <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb8-9" title="9">    <span class="cf">for</span> aa <span class="kw">in</span> sequence:</a>
<a class="sourceLine" id="cb8-10" title="10">        <span class="cf">if</span> aa <span class="kw">in</span> [<span class="st">&#39;R&#39;</span>, <span class="st">&#39;K&#39;</span>, <span class="st">&#39;H&#39;</span>, <span class="st">&#39;D&#39;</span>, <span class="st">&#39;E&#39;</span>, <span class="st">&#39;S&#39;</span>, <span class="st">&#39;T&#39;</span>, <span class="st">&#39;N&#39;</span>, <span class="st">&#39;Q&#39;</span>, <span class="st">&#39;C&#39;</span>, <span class="st">&#39;Y&#39;</span>, <span class="st">&#39;W&#39;</span>]:</a>
<a class="sourceLine" id="cb8-11" title="11">            count <span class="op">+=</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb8-12" title="12">    <span class="cf">return</span> count</a>
<a class="sourceLine" id="cb8-13" title="13"></a>
<a class="sourceLine" id="cb8-14" title="14">sample_sequence <span class="op">=</span> <span class="st">&quot;AAAATTVVVVPPPSREREPPII&quot;</span></a>
<a class="sourceLine" id="cb8-15" title="15"></a>
<a class="sourceLine" id="cb8-16" title="16">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> polar_count(sample_sequence) <span class="op">==</span> <span class="dv">3</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4">Run 4</h4>
<div class="sourceCode" id="cb10"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb10-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb10-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb10-3" title="3"></a>
<a class="sourceLine" id="cb10-4" title="4"><span class="kw">def</span> polar_count(sequence):</a>
<a class="sourceLine" id="cb10-5" title="5">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb10-6" title="6"><span class="co">    This function counts the number of polar uncharged amino acids in the given sequence</span></a>
<a class="sourceLine" id="cb10-7" title="7"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb10-8" title="8">    count <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb10-9" title="9">    <span class="cf">for</span> i <span class="kw">in</span> sequence:</a>
<a class="sourceLine" id="cb10-10" title="10">        <span class="cf">if</span> i <span class="op">==</span> <span class="st">&#39;S&#39;</span> <span class="kw">or</span> i <span class="op">==</span> <span class="st">&#39;T&#39;</span> <span class="kw">or</span> i <span class="op">==</span> <span class="st">&#39;N&#39;</span> <span class="kw">or</span> i <span class="op">==</span> <span class="st">&#39;Q&#39;</span> <span class="kw">or</span> i <span class="op">==</span> <span class="st">&#39;Y&#39;</span> <span class="kw">or</span> i <span class="op">==</span> <span class="st">&#39;C&#39;</span> <span class="kw">or</span> i <span class="op">==</span> <span class="st">&#39;M&#39;</span>:</a>
<a class="sourceLine" id="cb10-11" title="11">            count <span class="op">+=</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb10-12" title="12">    <span class="cf">return</span> count</a>
<a class="sourceLine" id="cb10-13" title="13"></a>
<a class="sourceLine" id="cb10-14" title="14">sample_sequence <span class="op">=</span> <span class="st">&quot;AAAATTVVVVPPPSREREPPII&quot;</span></a>
<a class="sourceLine" id="cb10-15" title="15"></a>
<a class="sourceLine" id="cb10-16" title="16">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> polar_count(sample_sequence) <span class="op">==</span> <span class="dv">3</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>adiabatic_expansion</summary></p>
<h4 id="query-1">Query</h4>
<div class="sourceCode" id="cb12"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb12-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb12-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb12-3" title="3"></a>
<a class="sourceLine" id="cb12-4" title="4"><span class="kw">def</span> cooling(T1,P1,P2,gamma):</a>
<a class="sourceLine" id="cb12-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb12-6" title="6"><span class="co">   This function returns the temperature of an ideal gas expanding adiabatically from P1 to P2</span></a>
<a class="sourceLine" id="cb12-7" title="7"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb12-8" title="8">   [insert]</a>
<a class="sourceLine" id="cb12-9" title="9">   <span class="cf">return</span> T2</a>
<a class="sourceLine" id="cb12-10" title="10"></a></code></pre></div>
<h4 id="run-0-1">Run 0</h4>
<div class="sourceCode" id="cb13"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb13-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb13-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb13-3" title="3"></a>
<a class="sourceLine" id="cb13-4" title="4"><span class="kw">def</span> cooling(T1,P1,P2,gamma):</a>
<a class="sourceLine" id="cb13-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb13-6" title="6"><span class="co">   This function returns the temperature of an ideal gas expanding adiabatically from P1 to P2</span></a>
<a class="sourceLine" id="cb13-7" title="7"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb13-8" title="8">   T2 <span class="op">=</span> T1<span class="op">*</span>(P2<span class="op">/</span>P1)<span class="op">**</span>((gamma<span class="dv">-1</span>)<span class="op">/</span>gamma)</a>
<a class="sourceLine" id="cb13-9" title="9">   <span class="cf">return</span> T2</a>
<a class="sourceLine" id="cb13-10" title="10"></a>
<a class="sourceLine" id="cb13-11" title="11"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb13-12" title="12">P1 <span class="op">=</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb13-13" title="13">P2 <span class="op">=</span> <span class="dv">2</span></a>
<a class="sourceLine" id="cb13-14" title="14">T1 <span class="op">=</span> <span class="dv">300</span></a>
<a class="sourceLine" id="cb13-15" title="15">gamma <span class="op">=</span> <span class="dv">5</span><span class="op">/</span><span class="dv">3</span></a>
<a class="sourceLine" id="cb13-16" title="16"></a>
<a class="sourceLine" id="cb13-17" title="17">T2 <span class="op">=</span> T1<span class="op">*</span>((P2<span class="op">/</span>P1)<span class="op">**</span>((gamma<span class="dv">-1</span>)<span class="op">/</span>gamma))</a>
<a class="sourceLine" id="cb13-18" title="18"></a>
<a class="sourceLine" id="cb13-19" title="19">T2_codex <span class="op">=</span> cooling(T1, P1, P2, gamma)</a>
<a class="sourceLine" id="cb13-20" title="20"></a>
<a class="sourceLine" id="cb13-21" title="21"><span class="co"># check </span></a>
<a class="sourceLine" id="cb13-22" title="22"><span class="cf">if</span> np.isclose(T2, T2_codex, rtol<span class="op">=</span><span class="fl">0.01</span>) <span class="op">==</span> <span class="va">True</span>:</a>
<a class="sourceLine" id="cb13-23" title="23">    result <span class="op">=</span> <span class="va">True</span> </a>
<a class="sourceLine" id="cb13-24" title="24"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb13-25" title="25">    result <span class="op">=</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-1">Run 1</h4>
<div class="sourceCode" id="cb15"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb15-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb15-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb15-3" title="3"></a>
<a class="sourceLine" id="cb15-4" title="4"><span class="kw">def</span> cooling(T1,P1,P2,gamma):</a>
<a class="sourceLine" id="cb15-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb15-6" title="6"><span class="co">   This function returns the temperature of an ideal gas expanding adiabatically from P1 to P2</span></a>
<a class="sourceLine" id="cb15-7" title="7"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb15-8" title="8">   T2 <span class="op">=</span> T1<span class="op">*</span>(P2<span class="op">/</span>P1)<span class="op">**</span>((gamma<span class="dv">-1</span>)<span class="op">/</span>gamma)</a>
<a class="sourceLine" id="cb15-9" title="9">   <span class="cf">return</span> T2</a>
<a class="sourceLine" id="cb15-10" title="10"></a>
<a class="sourceLine" id="cb15-11" title="11"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb15-12" title="12">P1 <span class="op">=</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb15-13" title="13">P2 <span class="op">=</span> <span class="dv">2</span></a>
<a class="sourceLine" id="cb15-14" title="14">T1 <span class="op">=</span> <span class="dv">300</span></a>
<a class="sourceLine" id="cb15-15" title="15">gamma <span class="op">=</span> <span class="dv">5</span><span class="op">/</span><span class="dv">3</span></a>
<a class="sourceLine" id="cb15-16" title="16"></a>
<a class="sourceLine" id="cb15-17" title="17">T2 <span class="op">=</span> T1<span class="op">*</span>((P2<span class="op">/</span>P1)<span class="op">**</span>((gamma<span class="dv">-1</span>)<span class="op">/</span>gamma))</a>
<a class="sourceLine" id="cb15-18" title="18"></a>
<a class="sourceLine" id="cb15-19" title="19">T2_codex <span class="op">=</span> cooling(T1, P1, P2, gamma)</a>
<a class="sourceLine" id="cb15-20" title="20"></a>
<a class="sourceLine" id="cb15-21" title="21"><span class="co"># check </span></a>
<a class="sourceLine" id="cb15-22" title="22"><span class="cf">if</span> np.isclose(T2, T2_codex, rtol<span class="op">=</span><span class="fl">0.01</span>) <span class="op">==</span> <span class="va">True</span>:</a>
<a class="sourceLine" id="cb15-23" title="23">    result <span class="op">=</span> <span class="va">True</span> </a>
<a class="sourceLine" id="cb15-24" title="24"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb15-25" title="25">    result <span class="op">=</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-1">Run 2</h4>
<div class="sourceCode" id="cb17"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb17-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb17-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb17-3" title="3"></a>
<a class="sourceLine" id="cb17-4" title="4"><span class="kw">def</span> cooling(T1,P1,P2,gamma):</a>
<a class="sourceLine" id="cb17-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb17-6" title="6"><span class="co">   This function returns the temperature of an ideal gas expanding adiabatically from P1 to P2</span></a>
<a class="sourceLine" id="cb17-7" title="7"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb17-8" title="8">   T2 <span class="op">=</span> T1<span class="op">*</span>(P2<span class="op">/</span>P1)<span class="op">**</span>((gamma<span class="dv">-1</span>)<span class="op">/</span>gamma)</a>
<a class="sourceLine" id="cb17-9" title="9">   <span class="cf">return</span> T2</a>
<a class="sourceLine" id="cb17-10" title="10"></a>
<a class="sourceLine" id="cb17-11" title="11"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb17-12" title="12">P1 <span class="op">=</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb17-13" title="13">P2 <span class="op">=</span> <span class="dv">2</span></a>
<a class="sourceLine" id="cb17-14" title="14">T1 <span class="op">=</span> <span class="dv">300</span></a>
<a class="sourceLine" id="cb17-15" title="15">gamma <span class="op">=</span> <span class="dv">5</span><span class="op">/</span><span class="dv">3</span></a>
<a class="sourceLine" id="cb17-16" title="16"></a>
<a class="sourceLine" id="cb17-17" title="17">T2 <span class="op">=</span> T1<span class="op">*</span>((P2<span class="op">/</span>P1)<span class="op">**</span>((gamma<span class="dv">-1</span>)<span class="op">/</span>gamma))</a>
<a class="sourceLine" id="cb17-18" title="18"></a>
<a class="sourceLine" id="cb17-19" title="19">T2_codex <span class="op">=</span> cooling(T1, P1, P2, gamma)</a>
<a class="sourceLine" id="cb17-20" title="20"></a>
<a class="sourceLine" id="cb17-21" title="21"><span class="co"># check </span></a>
<a class="sourceLine" id="cb17-22" title="22"><span class="cf">if</span> np.isclose(T2, T2_codex, rtol<span class="op">=</span><span class="fl">0.01</span>) <span class="op">==</span> <span class="va">True</span>:</a>
<a class="sourceLine" id="cb17-23" title="23">    result <span class="op">=</span> <span class="va">True</span> </a>
<a class="sourceLine" id="cb17-24" title="24"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb17-25" title="25">    result <span class="op">=</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-1">Run 3</h4>
<div class="sourceCode" id="cb19"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb19-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb19-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb19-3" title="3"></a>
<a class="sourceLine" id="cb19-4" title="4"><span class="kw">def</span> cooling(T1,P1,P2,gamma):</a>
<a class="sourceLine" id="cb19-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb19-6" title="6"><span class="co">   This function returns the temperature of an ideal gas expanding adiabatically from P1 to P2</span></a>
<a class="sourceLine" id="cb19-7" title="7"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb19-8" title="8">   T2 <span class="op">=</span> T1<span class="op">*</span>(P2<span class="op">/</span>P1)<span class="op">**</span>((gamma<span class="dv">-1</span>)<span class="op">/</span>gamma)</a>
<a class="sourceLine" id="cb19-9" title="9">   <span class="cf">return</span> T2</a>
<a class="sourceLine" id="cb19-10" title="10"></a>
<a class="sourceLine" id="cb19-11" title="11"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb19-12" title="12">P1 <span class="op">=</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb19-13" title="13">P2 <span class="op">=</span> <span class="dv">2</span></a>
<a class="sourceLine" id="cb19-14" title="14">T1 <span class="op">=</span> <span class="dv">300</span></a>
<a class="sourceLine" id="cb19-15" title="15">gamma <span class="op">=</span> <span class="dv">5</span><span class="op">/</span><span class="dv">3</span></a>
<a class="sourceLine" id="cb19-16" title="16"></a>
<a class="sourceLine" id="cb19-17" title="17">T2 <span class="op">=</span> T1<span class="op">*</span>((P2<span class="op">/</span>P1)<span class="op">**</span>((gamma<span class="dv">-1</span>)<span class="op">/</span>gamma))</a>
<a class="sourceLine" id="cb19-18" title="18"></a>
<a class="sourceLine" id="cb19-19" title="19">T2_codex <span class="op">=</span> cooling(T1, P1, P2, gamma)</a>
<a class="sourceLine" id="cb19-20" title="20"></a>
<a class="sourceLine" id="cb19-21" title="21"><span class="co"># check </span></a>
<a class="sourceLine" id="cb19-22" title="22"><span class="cf">if</span> np.isclose(T2, T2_codex, rtol<span class="op">=</span><span class="fl">0.01</span>) <span class="op">==</span> <span class="va">True</span>:</a>
<a class="sourceLine" id="cb19-23" title="23">    result <span class="op">=</span> <span class="va">True</span> </a>
<a class="sourceLine" id="cb19-24" title="24"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb19-25" title="25">    result <span class="op">=</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-1">Run 4</h4>
<div class="sourceCode" id="cb21"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb21-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb21-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb21-3" title="3"></a>
<a class="sourceLine" id="cb21-4" title="4"><span class="kw">def</span> cooling(T1,P1,P2,gamma):</a>
<a class="sourceLine" id="cb21-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb21-6" title="6"><span class="co">   This function returns the temperature of an ideal gas expanding adiabatically from P1 to P2</span></a>
<a class="sourceLine" id="cb21-7" title="7"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb21-8" title="8">   T2 <span class="op">=</span> T1<span class="op">*</span>(P2<span class="op">/</span>P1)<span class="op">**</span>((gamma<span class="dv">-1</span>)<span class="op">/</span>gamma)</a>
<a class="sourceLine" id="cb21-9" title="9">   <span class="cf">return</span> T2</a>
<a class="sourceLine" id="cb21-10" title="10"></a>
<a class="sourceLine" id="cb21-11" title="11"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb21-12" title="12">P1 <span class="op">=</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb21-13" title="13">P2 <span class="op">=</span> <span class="dv">2</span></a>
<a class="sourceLine" id="cb21-14" title="14">T1 <span class="op">=</span> <span class="dv">300</span></a>
<a class="sourceLine" id="cb21-15" title="15">gamma <span class="op">=</span> <span class="dv">5</span><span class="op">/</span><span class="dv">3</span></a>
<a class="sourceLine" id="cb21-16" title="16"></a>
<a class="sourceLine" id="cb21-17" title="17">T2 <span class="op">=</span> T1<span class="op">*</span>((P2<span class="op">/</span>P1)<span class="op">**</span>((gamma<span class="dv">-1</span>)<span class="op">/</span>gamma))</a>
<a class="sourceLine" id="cb21-18" title="18"></a>
<a class="sourceLine" id="cb21-19" title="19">T2_codex <span class="op">=</span> cooling(T1, P1, P2, gamma)</a>
<a class="sourceLine" id="cb21-20" title="20"></a>
<a class="sourceLine" id="cb21-21" title="21"><span class="co"># check </span></a>
<a class="sourceLine" id="cb21-22" title="22"><span class="cf">if</span> np.isclose(T2, T2_codex, rtol<span class="op">=</span><span class="fl">0.01</span>) <span class="op">==</span> <span class="va">True</span>:</a>
<a class="sourceLine" id="cb21-23" title="23">    result <span class="op">=</span> <span class="va">True</span> </a>
<a class="sourceLine" id="cb21-24" title="24"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb21-25" title="25">    result <span class="op">=</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>alignment</summary></p>
<h4 id="query-2">Query</h4>
<div class="sourceCode" id="cb23"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb23-1" title="1"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb23-2" title="2"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb23-3" title="3"></a>
<a class="sourceLine" id="cb23-4" title="4"><span class="kw">def</span> align_traj(traj, frame_index):</a>
<a class="sourceLine" id="cb23-5" title="5">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb23-6" title="6"><span class="co">  This function aligns the given mdtraj trajectory to a specific frame</span></a>
<a class="sourceLine" id="cb23-7" title="7"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb23-8" title="8">  [insert]</a>
<a class="sourceLine" id="cb23-9" title="9">  <span class="cf">return</span> traj</a></code></pre></div>
<h4 id="run-0-2">Run 0</h4>
<div class="sourceCode" id="cb24"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb24-1" title="1"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb24-2" title="2"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb24-3" title="3"></a>
<a class="sourceLine" id="cb24-4" title="4"><span class="kw">def</span> align_traj(traj, frame_index):</a>
<a class="sourceLine" id="cb24-5" title="5">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb24-6" title="6"><span class="co">  This function aligns the given mdtraj trajectory to a specific frame</span></a>
<a class="sourceLine" id="cb24-7" title="7"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb24-8" title="8">  traj.superpose(traj, frame<span class="op">=</span>frame_index)</a>
<a class="sourceLine" id="cb24-9" title="9">  <span class="cf">return</span> traj</a>
<a class="sourceLine" id="cb24-10" title="10"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb24-11" title="11"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb24-12" title="12"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb24-13" title="13"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb24-14" title="14"></a>
<a class="sourceLine" id="cb24-15" title="15">pdb_file <span class="op">=</span> os.path.join(_FILE_DIR_, <span class="st">&quot;1VII_twoframe_shifted.pdb&quot;</span>)</a>
<a class="sourceLine" id="cb24-16" title="16">trj <span class="op">=</span> md.load(pdb_file)</a>
<a class="sourceLine" id="cb24-17" title="17"></a>
<a class="sourceLine" id="cb24-18" title="18"></a>
<a class="sourceLine" id="cb24-19" title="19"><span class="kw">def</span> myrmsd(trj, frame):</a>
<a class="sourceLine" id="cb24-20" title="20">    xyz <span class="op">=</span> trj.xyz</a>
<a class="sourceLine" id="cb24-21" title="21">    xyz0 <span class="op">=</span> trj.xyz[frame]</a>
<a class="sourceLine" id="cb24-22" title="22">    dx <span class="op">=</span> xyz<span class="op">-</span>xyz0</a>
<a class="sourceLine" id="cb24-23" title="23">    dx2 <span class="op">=</span> (dx<span class="op">*</span>dx).<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb24-24" title="24">    rmsd <span class="op">=</span> np.sqrt(dx2.mean(axis<span class="op">=</span><span class="dv">1</span>))</a>
<a class="sourceLine" id="cb24-25" title="25">    <span class="cf">return</span> rmsd</a>
<a class="sourceLine" id="cb24-26" title="26"></a>
<a class="sourceLine" id="cb24-27" title="27"></a>
<a class="sourceLine" id="cb24-28" title="28"><span class="co">#print(&quot;Starting rmsd:&quot;, myrmsd(trj, 0))</span></a>
<a class="sourceLine" id="cb24-29" title="29">aligned_trj <span class="op">=</span> trj.superpose(trj, <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb24-30" title="30"></a>
<a class="sourceLine" id="cb24-31" title="31">my_rmsd <span class="op">=</span> myrmsd(aligned_trj, <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb24-32" title="32"><span class="co">#print(&quot;Aligned rmsd:&quot;, my_rmsd)</span></a>
<a class="sourceLine" id="cb24-33" title="33"></a>
<a class="sourceLine" id="cb24-34" title="34">nlcc_trj <span class="op">=</span> align_traj(trj, <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb24-35" title="35">nlcc_rmsd <span class="op">=</span> myrmsd(nlcc_trj, <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb24-36" title="36"></a>
<a class="sourceLine" id="cb24-37" title="37"><span class="co">#print(&quot;nlcc rmsd&quot;, nlcc_rmsd)</span></a>
<a class="sourceLine" id="cb24-38" title="38"></a>
<a class="sourceLine" id="cb24-39" title="39">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">all</span>(np.<span class="bu">abs</span>(my_rmsd <span class="op">-</span> nlcc_rmsd)) <span class="op">&lt;</span> <span class="fl">0.01</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-2">Run 1</h4>
<div class="sourceCode" id="cb26"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb26-1" title="1"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb26-2" title="2"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb26-3" title="3"></a>
<a class="sourceLine" id="cb26-4" title="4"><span class="kw">def</span> align_traj(traj, frame_index):</a>
<a class="sourceLine" id="cb26-5" title="5">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb26-6" title="6"><span class="co">  This function aligns the given mdtraj trajectory to a specific frame</span></a>
<a class="sourceLine" id="cb26-7" title="7"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb26-8" title="8">  traj.superpose(traj, frame<span class="op">=</span>frame_index)</a>
<a class="sourceLine" id="cb26-9" title="9">  <span class="cf">return</span> traj</a>
<a class="sourceLine" id="cb26-10" title="10"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb26-11" title="11"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb26-12" title="12"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb26-13" title="13"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb26-14" title="14"></a>
<a class="sourceLine" id="cb26-15" title="15">pdb_file <span class="op">=</span> os.path.join(_FILE_DIR_, <span class="st">&quot;1VII_twoframe_shifted.pdb&quot;</span>)</a>
<a class="sourceLine" id="cb26-16" title="16">trj <span class="op">=</span> md.load(pdb_file)</a>
<a class="sourceLine" id="cb26-17" title="17"></a>
<a class="sourceLine" id="cb26-18" title="18"></a>
<a class="sourceLine" id="cb26-19" title="19"><span class="kw">def</span> myrmsd(trj, frame):</a>
<a class="sourceLine" id="cb26-20" title="20">    xyz <span class="op">=</span> trj.xyz</a>
<a class="sourceLine" id="cb26-21" title="21">    xyz0 <span class="op">=</span> trj.xyz[frame]</a>
<a class="sourceLine" id="cb26-22" title="22">    dx <span class="op">=</span> xyz<span class="op">-</span>xyz0</a>
<a class="sourceLine" id="cb26-23" title="23">    dx2 <span class="op">=</span> (dx<span class="op">*</span>dx).<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb26-24" title="24">    rmsd <span class="op">=</span> np.sqrt(dx2.mean(axis<span class="op">=</span><span class="dv">1</span>))</a>
<a class="sourceLine" id="cb26-25" title="25">    <span class="cf">return</span> rmsd</a>
<a class="sourceLine" id="cb26-26" title="26"></a>
<a class="sourceLine" id="cb26-27" title="27"></a>
<a class="sourceLine" id="cb26-28" title="28"><span class="co">#print(&quot;Starting rmsd:&quot;, myrmsd(trj, 0))</span></a>
<a class="sourceLine" id="cb26-29" title="29">aligned_trj <span class="op">=</span> trj.superpose(trj, <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb26-30" title="30"></a>
<a class="sourceLine" id="cb26-31" title="31">my_rmsd <span class="op">=</span> myrmsd(aligned_trj, <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb26-32" title="32"><span class="co">#print(&quot;Aligned rmsd:&quot;, my_rmsd)</span></a>
<a class="sourceLine" id="cb26-33" title="33"></a>
<a class="sourceLine" id="cb26-34" title="34">nlcc_trj <span class="op">=</span> align_traj(trj, <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb26-35" title="35">nlcc_rmsd <span class="op">=</span> myrmsd(nlcc_trj, <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb26-36" title="36"></a>
<a class="sourceLine" id="cb26-37" title="37"><span class="co">#print(&quot;nlcc rmsd&quot;, nlcc_rmsd)</span></a>
<a class="sourceLine" id="cb26-38" title="38"></a>
<a class="sourceLine" id="cb26-39" title="39">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">all</span>(np.<span class="bu">abs</span>(my_rmsd <span class="op">-</span> nlcc_rmsd)) <span class="op">&lt;</span> <span class="fl">0.01</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-2">Run 2</h4>
<div class="sourceCode" id="cb28"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb28-1" title="1"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb28-2" title="2"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb28-3" title="3"></a>
<a class="sourceLine" id="cb28-4" title="4"><span class="kw">def</span> align_traj(traj, frame_index):</a>
<a class="sourceLine" id="cb28-5" title="5">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb28-6" title="6"><span class="co">  This function aligns the given mdtraj trajectory to a specific frame</span></a>
<a class="sourceLine" id="cb28-7" title="7"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb28-8" title="8">  traj.superpose(traj, frame<span class="op">=</span>frame_index)</a>
<a class="sourceLine" id="cb28-9" title="9">  <span class="cf">return</span> traj</a>
<a class="sourceLine" id="cb28-10" title="10"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb28-11" title="11"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb28-12" title="12"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb28-13" title="13"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb28-14" title="14"></a>
<a class="sourceLine" id="cb28-15" title="15">pdb_file <span class="op">=</span> os.path.join(_FILE_DIR_, <span class="st">&quot;1VII_twoframe_shifted.pdb&quot;</span>)</a>
<a class="sourceLine" id="cb28-16" title="16">trj <span class="op">=</span> md.load(pdb_file)</a>
<a class="sourceLine" id="cb28-17" title="17"></a>
<a class="sourceLine" id="cb28-18" title="18"></a>
<a class="sourceLine" id="cb28-19" title="19"><span class="kw">def</span> myrmsd(trj, frame):</a>
<a class="sourceLine" id="cb28-20" title="20">    xyz <span class="op">=</span> trj.xyz</a>
<a class="sourceLine" id="cb28-21" title="21">    xyz0 <span class="op">=</span> trj.xyz[frame]</a>
<a class="sourceLine" id="cb28-22" title="22">    dx <span class="op">=</span> xyz<span class="op">-</span>xyz0</a>
<a class="sourceLine" id="cb28-23" title="23">    dx2 <span class="op">=</span> (dx<span class="op">*</span>dx).<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb28-24" title="24">    rmsd <span class="op">=</span> np.sqrt(dx2.mean(axis<span class="op">=</span><span class="dv">1</span>))</a>
<a class="sourceLine" id="cb28-25" title="25">    <span class="cf">return</span> rmsd</a>
<a class="sourceLine" id="cb28-26" title="26"></a>
<a class="sourceLine" id="cb28-27" title="27"></a>
<a class="sourceLine" id="cb28-28" title="28"><span class="co">#print(&quot;Starting rmsd:&quot;, myrmsd(trj, 0))</span></a>
<a class="sourceLine" id="cb28-29" title="29">aligned_trj <span class="op">=</span> trj.superpose(trj, <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb28-30" title="30"></a>
<a class="sourceLine" id="cb28-31" title="31">my_rmsd <span class="op">=</span> myrmsd(aligned_trj, <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb28-32" title="32"><span class="co">#print(&quot;Aligned rmsd:&quot;, my_rmsd)</span></a>
<a class="sourceLine" id="cb28-33" title="33"></a>
<a class="sourceLine" id="cb28-34" title="34">nlcc_trj <span class="op">=</span> align_traj(trj, <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb28-35" title="35">nlcc_rmsd <span class="op">=</span> myrmsd(nlcc_trj, <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb28-36" title="36"></a>
<a class="sourceLine" id="cb28-37" title="37"><span class="co">#print(&quot;nlcc rmsd&quot;, nlcc_rmsd)</span></a>
<a class="sourceLine" id="cb28-38" title="38"></a>
<a class="sourceLine" id="cb28-39" title="39">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">all</span>(np.<span class="bu">abs</span>(my_rmsd <span class="op">-</span> nlcc_rmsd)) <span class="op">&lt;</span> <span class="fl">0.01</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-2">Run 3</h4>
<div class="sourceCode" id="cb30"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb30-1" title="1"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb30-2" title="2"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb30-3" title="3"></a>
<a class="sourceLine" id="cb30-4" title="4"><span class="kw">def</span> align_traj(traj, frame_index):</a>
<a class="sourceLine" id="cb30-5" title="5">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb30-6" title="6"><span class="co">  This function aligns the given mdtraj trajectory to a specific frame</span></a>
<a class="sourceLine" id="cb30-7" title="7"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb30-8" title="8">  traj.superpose(traj, frame<span class="op">=</span>frame_index)</a>
<a class="sourceLine" id="cb30-9" title="9">  <span class="cf">return</span> traj</a>
<a class="sourceLine" id="cb30-10" title="10"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb30-11" title="11"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb30-12" title="12"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb30-13" title="13"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb30-14" title="14"></a>
<a class="sourceLine" id="cb30-15" title="15">pdb_file <span class="op">=</span> os.path.join(_FILE_DIR_, <span class="st">&quot;1VII_twoframe_shifted.pdb&quot;</span>)</a>
<a class="sourceLine" id="cb30-16" title="16">trj <span class="op">=</span> md.load(pdb_file)</a>
<a class="sourceLine" id="cb30-17" title="17"></a>
<a class="sourceLine" id="cb30-18" title="18"></a>
<a class="sourceLine" id="cb30-19" title="19"><span class="kw">def</span> myrmsd(trj, frame):</a>
<a class="sourceLine" id="cb30-20" title="20">    xyz <span class="op">=</span> trj.xyz</a>
<a class="sourceLine" id="cb30-21" title="21">    xyz0 <span class="op">=</span> trj.xyz[frame]</a>
<a class="sourceLine" id="cb30-22" title="22">    dx <span class="op">=</span> xyz<span class="op">-</span>xyz0</a>
<a class="sourceLine" id="cb30-23" title="23">    dx2 <span class="op">=</span> (dx<span class="op">*</span>dx).<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb30-24" title="24">    rmsd <span class="op">=</span> np.sqrt(dx2.mean(axis<span class="op">=</span><span class="dv">1</span>))</a>
<a class="sourceLine" id="cb30-25" title="25">    <span class="cf">return</span> rmsd</a>
<a class="sourceLine" id="cb30-26" title="26"></a>
<a class="sourceLine" id="cb30-27" title="27"></a>
<a class="sourceLine" id="cb30-28" title="28"><span class="co">#print(&quot;Starting rmsd:&quot;, myrmsd(trj, 0))</span></a>
<a class="sourceLine" id="cb30-29" title="29">aligned_trj <span class="op">=</span> trj.superpose(trj, <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb30-30" title="30"></a>
<a class="sourceLine" id="cb30-31" title="31">my_rmsd <span class="op">=</span> myrmsd(aligned_trj, <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb30-32" title="32"><span class="co">#print(&quot;Aligned rmsd:&quot;, my_rmsd)</span></a>
<a class="sourceLine" id="cb30-33" title="33"></a>
<a class="sourceLine" id="cb30-34" title="34">nlcc_trj <span class="op">=</span> align_traj(trj, <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb30-35" title="35">nlcc_rmsd <span class="op">=</span> myrmsd(nlcc_trj, <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb30-36" title="36"></a>
<a class="sourceLine" id="cb30-37" title="37"><span class="co">#print(&quot;nlcc rmsd&quot;, nlcc_rmsd)</span></a>
<a class="sourceLine" id="cb30-38" title="38"></a>
<a class="sourceLine" id="cb30-39" title="39">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">all</span>(np.<span class="bu">abs</span>(my_rmsd <span class="op">-</span> nlcc_rmsd)) <span class="op">&lt;</span> <span class="fl">0.01</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-2">Run 4</h4>
<div class="sourceCode" id="cb32"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb32-1" title="1"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb32-2" title="2"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb32-3" title="3"></a>
<a class="sourceLine" id="cb32-4" title="4"><span class="kw">def</span> align_traj(traj, frame_index):</a>
<a class="sourceLine" id="cb32-5" title="5">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb32-6" title="6"><span class="co">  This function aligns the given mdtraj trajectory to a specific frame</span></a>
<a class="sourceLine" id="cb32-7" title="7"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb32-8" title="8">  traj.superpose(traj, frame<span class="op">=</span>frame_index)</a>
<a class="sourceLine" id="cb32-9" title="9">  <span class="cf">return</span> traj</a>
<a class="sourceLine" id="cb32-10" title="10"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb32-11" title="11"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb32-12" title="12"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb32-13" title="13"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb32-14" title="14"></a>
<a class="sourceLine" id="cb32-15" title="15">pdb_file <span class="op">=</span> os.path.join(_FILE_DIR_, <span class="st">&quot;1VII_twoframe_shifted.pdb&quot;</span>)</a>
<a class="sourceLine" id="cb32-16" title="16">trj <span class="op">=</span> md.load(pdb_file)</a>
<a class="sourceLine" id="cb32-17" title="17"></a>
<a class="sourceLine" id="cb32-18" title="18"></a>
<a class="sourceLine" id="cb32-19" title="19"><span class="kw">def</span> myrmsd(trj, frame):</a>
<a class="sourceLine" id="cb32-20" title="20">    xyz <span class="op">=</span> trj.xyz</a>
<a class="sourceLine" id="cb32-21" title="21">    xyz0 <span class="op">=</span> trj.xyz[frame]</a>
<a class="sourceLine" id="cb32-22" title="22">    dx <span class="op">=</span> xyz<span class="op">-</span>xyz0</a>
<a class="sourceLine" id="cb32-23" title="23">    dx2 <span class="op">=</span> (dx<span class="op">*</span>dx).<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb32-24" title="24">    rmsd <span class="op">=</span> np.sqrt(dx2.mean(axis<span class="op">=</span><span class="dv">1</span>))</a>
<a class="sourceLine" id="cb32-25" title="25">    <span class="cf">return</span> rmsd</a>
<a class="sourceLine" id="cb32-26" title="26"></a>
<a class="sourceLine" id="cb32-27" title="27"></a>
<a class="sourceLine" id="cb32-28" title="28"><span class="co">#print(&quot;Starting rmsd:&quot;, myrmsd(trj, 0))</span></a>
<a class="sourceLine" id="cb32-29" title="29">aligned_trj <span class="op">=</span> trj.superpose(trj, <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb32-30" title="30"></a>
<a class="sourceLine" id="cb32-31" title="31">my_rmsd <span class="op">=</span> myrmsd(aligned_trj, <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb32-32" title="32"><span class="co">#print(&quot;Aligned rmsd:&quot;, my_rmsd)</span></a>
<a class="sourceLine" id="cb32-33" title="33"></a>
<a class="sourceLine" id="cb32-34" title="34">nlcc_trj <span class="op">=</span> align_traj(trj, <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb32-35" title="35">nlcc_rmsd <span class="op">=</span> myrmsd(nlcc_trj, <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb32-36" title="36"></a>
<a class="sourceLine" id="cb32-37" title="37"><span class="co">#print(&quot;nlcc rmsd&quot;, nlcc_rmsd)</span></a>
<a class="sourceLine" id="cb32-38" title="38"></a>
<a class="sourceLine" id="cb32-39" title="39">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">all</span>(np.<span class="bu">abs</span>(my_rmsd <span class="op">-</span> nlcc_rmsd)) <span class="op">&lt;</span> <span class="fl">0.01</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>angle</summary></p>
<h4 id="query-3">Query</h4>
<div class="sourceCode" id="cb34"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb34-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb34-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb34-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb34-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb34-5" title="5"></a>
<a class="sourceLine" id="cb34-6" title="6"><span class="kw">def</span> vector_angle(v1,v2):</a>
<a class="sourceLine" id="cb34-7" title="7">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb34-8" title="8"><span class="co">    This function returns the angle between vector v1 and vector v2.</span></a>
<a class="sourceLine" id="cb34-9" title="9"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb34-10" title="10">    [insert]</a>
<a class="sourceLine" id="cb34-11" title="11">    <span class="cf">return</span> angle</a></code></pre></div>
<h4 id="run-0-3">Run 0</h4>
<div class="sourceCode" id="cb35"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb35-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb35-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb35-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb35-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb35-5" title="5"></a>
<a class="sourceLine" id="cb35-6" title="6"><span class="kw">def</span> vector_angle(v1,v2):</a>
<a class="sourceLine" id="cb35-7" title="7">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb35-8" title="8"><span class="co">    This function returns the angle between vector v1 and vector v2.</span></a>
<a class="sourceLine" id="cb35-9" title="9"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb35-10" title="10">    v1_u <span class="op">=</span> v1<span class="op">/</span>np.linalg.norm(v1)</a>
<a class="sourceLine" id="cb35-11" title="11">    v2_u <span class="op">=</span> v2<span class="op">/</span>np.linalg.norm(v2)</a>
<a class="sourceLine" id="cb35-12" title="12">    angle <span class="op">=</span> np.arccos(np.clip(np.dot(v1_u, v2_u), <span class="fl">-1.0</span>, <span class="fl">1.0</span>))</a>
<a class="sourceLine" id="cb35-13" title="13">    <span class="cf">return</span> angle</a>
<a class="sourceLine" id="cb35-14" title="14"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb35-15" title="15"></a>
<a class="sourceLine" id="cb35-16" title="16"><span class="kw">def</span> unit_vec(vector):</a>
<a class="sourceLine" id="cb35-17" title="17">    <span class="cf">return</span> vector <span class="op">/</span> np.linalg.norm(vector)</a>
<a class="sourceLine" id="cb35-18" title="18"></a>
<a class="sourceLine" id="cb35-19" title="19">v1 <span class="op">=</span>  [<span class="fl">1.2</span>,<span class="fl">0.5</span>,<span class="fl">0.5</span>]</a>
<a class="sourceLine" id="cb35-20" title="20">v2 <span class="op">=</span>  [<span class="op">-</span><span class="fl">1.5</span>,<span class="fl">2.0</span>,<span class="fl">0.0</span>]</a>
<a class="sourceLine" id="cb35-21" title="21"></a>
<a class="sourceLine" id="cb35-22" title="22">v1_u <span class="op">=</span> unit_vec(v1)</a>
<a class="sourceLine" id="cb35-23" title="23">v2_u <span class="op">=</span> unit_vec(v2)</a>
<a class="sourceLine" id="cb35-24" title="24"></a>
<a class="sourceLine" id="cb35-25" title="25">angle <span class="op">=</span> np.arccos(np.clip(np.dot(v1_u, v2_u), <span class="fl">-1.0</span>, <span class="fl">1.0</span>))</a>
<a class="sourceLine" id="cb35-26" title="26"></a>
<a class="sourceLine" id="cb35-27" title="27">angle_codex <span class="op">=</span>  vector_angle(v1,v2)</a>
<a class="sourceLine" id="cb35-28" title="28"></a>
<a class="sourceLine" id="cb35-29" title="29"><span class="cf">if</span> np.isclose(angle, angle_codex) <span class="op">==</span> <span class="va">True</span>:</a>
<a class="sourceLine" id="cb35-30" title="30">    result <span class="op">=</span> <span class="va">True</span></a>
<a class="sourceLine" id="cb35-31" title="31"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb35-32" title="32">    result <span class="op">=</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-3">Run 1</h4>
<div class="sourceCode" id="cb37"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb37-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb37-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb37-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb37-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb37-5" title="5"></a>
<a class="sourceLine" id="cb37-6" title="6"><span class="kw">def</span> vector_angle(v1,v2):</a>
<a class="sourceLine" id="cb37-7" title="7">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb37-8" title="8"><span class="co">    This function returns the angle between vector v1 and vector v2.</span></a>
<a class="sourceLine" id="cb37-9" title="9"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb37-10" title="10">    v1_u <span class="op">=</span> v1 <span class="op">/</span> np.linalg.norm(v1)</a>
<a class="sourceLine" id="cb37-11" title="11">    v2_u <span class="op">=</span> v2 <span class="op">/</span> np.linalg.norm(v2)</a>
<a class="sourceLine" id="cb37-12" title="12">    angle <span class="op">=</span> np.arccos(np.clip(np.dot(v1_u, v2_u), <span class="fl">-1.0</span>, <span class="fl">1.0</span>))</a>
<a class="sourceLine" id="cb37-13" title="13">    <span class="cf">return</span> angle</a>
<a class="sourceLine" id="cb37-14" title="14"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb37-15" title="15"></a>
<a class="sourceLine" id="cb37-16" title="16"><span class="kw">def</span> unit_vec(vector):</a>
<a class="sourceLine" id="cb37-17" title="17">    <span class="cf">return</span> vector <span class="op">/</span> np.linalg.norm(vector)</a>
<a class="sourceLine" id="cb37-18" title="18"></a>
<a class="sourceLine" id="cb37-19" title="19">v1 <span class="op">=</span>  [<span class="fl">1.2</span>,<span class="fl">0.5</span>,<span class="fl">0.5</span>]</a>
<a class="sourceLine" id="cb37-20" title="20">v2 <span class="op">=</span>  [<span class="op">-</span><span class="fl">1.5</span>,<span class="fl">2.0</span>,<span class="fl">0.0</span>]</a>
<a class="sourceLine" id="cb37-21" title="21"></a>
<a class="sourceLine" id="cb37-22" title="22">v1_u <span class="op">=</span> unit_vec(v1)</a>
<a class="sourceLine" id="cb37-23" title="23">v2_u <span class="op">=</span> unit_vec(v2)</a>
<a class="sourceLine" id="cb37-24" title="24"></a>
<a class="sourceLine" id="cb37-25" title="25">angle <span class="op">=</span> np.arccos(np.clip(np.dot(v1_u, v2_u), <span class="fl">-1.0</span>, <span class="fl">1.0</span>))</a>
<a class="sourceLine" id="cb37-26" title="26"></a>
<a class="sourceLine" id="cb37-27" title="27">angle_codex <span class="op">=</span>  vector_angle(v1,v2)</a>
<a class="sourceLine" id="cb37-28" title="28"></a>
<a class="sourceLine" id="cb37-29" title="29"><span class="cf">if</span> np.isclose(angle, angle_codex) <span class="op">==</span> <span class="va">True</span>:</a>
<a class="sourceLine" id="cb37-30" title="30">    result <span class="op">=</span> <span class="va">True</span></a>
<a class="sourceLine" id="cb37-31" title="31"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb37-32" title="32">    result <span class="op">=</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-3">Run 2</h4>
<div class="sourceCode" id="cb39"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb39-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb39-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb39-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb39-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb39-5" title="5"></a>
<a class="sourceLine" id="cb39-6" title="6"><span class="kw">def</span> vector_angle(v1,v2):</a>
<a class="sourceLine" id="cb39-7" title="7">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb39-8" title="8"><span class="co">    This function returns the angle between vector v1 and vector v2.</span></a>
<a class="sourceLine" id="cb39-9" title="9"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb39-10" title="10">    cosang <span class="op">=</span> np.dot(v1, v2)</a>
<a class="sourceLine" id="cb39-11" title="11">    sinang <span class="op">=</span> np.linalg.norm(np.cross(v1, v2))</a>
<a class="sourceLine" id="cb39-12" title="12">    angle <span class="op">=</span> np.arctan2(sinang, cosang)</a>
<a class="sourceLine" id="cb39-13" title="13">    <span class="cf">return</span> angle</a>
<a class="sourceLine" id="cb39-14" title="14"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb39-15" title="15"></a>
<a class="sourceLine" id="cb39-16" title="16"><span class="kw">def</span> unit_vec(vector):</a>
<a class="sourceLine" id="cb39-17" title="17">    <span class="cf">return</span> vector <span class="op">/</span> np.linalg.norm(vector)</a>
<a class="sourceLine" id="cb39-18" title="18"></a>
<a class="sourceLine" id="cb39-19" title="19">v1 <span class="op">=</span>  [<span class="fl">1.2</span>,<span class="fl">0.5</span>,<span class="fl">0.5</span>]</a>
<a class="sourceLine" id="cb39-20" title="20">v2 <span class="op">=</span>  [<span class="op">-</span><span class="fl">1.5</span>,<span class="fl">2.0</span>,<span class="fl">0.0</span>]</a>
<a class="sourceLine" id="cb39-21" title="21"></a>
<a class="sourceLine" id="cb39-22" title="22">v1_u <span class="op">=</span> unit_vec(v1)</a>
<a class="sourceLine" id="cb39-23" title="23">v2_u <span class="op">=</span> unit_vec(v2)</a>
<a class="sourceLine" id="cb39-24" title="24"></a>
<a class="sourceLine" id="cb39-25" title="25">angle <span class="op">=</span> np.arccos(np.clip(np.dot(v1_u, v2_u), <span class="fl">-1.0</span>, <span class="fl">1.0</span>))</a>
<a class="sourceLine" id="cb39-26" title="26"></a>
<a class="sourceLine" id="cb39-27" title="27">angle_codex <span class="op">=</span>  vector_angle(v1,v2)</a>
<a class="sourceLine" id="cb39-28" title="28"></a>
<a class="sourceLine" id="cb39-29" title="29"><span class="cf">if</span> np.isclose(angle, angle_codex) <span class="op">==</span> <span class="va">True</span>:</a>
<a class="sourceLine" id="cb39-30" title="30">    result <span class="op">=</span> <span class="va">True</span></a>
<a class="sourceLine" id="cb39-31" title="31"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb39-32" title="32">    result <span class="op">=</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-3">Run 3</h4>
<div class="sourceCode" id="cb41"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb41-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb41-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb41-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb41-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb41-5" title="5"></a>
<a class="sourceLine" id="cb41-6" title="6"><span class="kw">def</span> vector_angle(v1,v2):</a>
<a class="sourceLine" id="cb41-7" title="7">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb41-8" title="8"><span class="co">    This function returns the angle between vector v1 and vector v2.</span></a>
<a class="sourceLine" id="cb41-9" title="9"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb41-10" title="10">    cosang <span class="op">=</span> np.dot(v1, v2)</a>
<a class="sourceLine" id="cb41-11" title="11">    sinang <span class="op">=</span> np.linalg.norm(np.cross(v1, v2))</a>
<a class="sourceLine" id="cb41-12" title="12">    angle <span class="op">=</span> np.arctan2(sinang, cosang)</a>
<a class="sourceLine" id="cb41-13" title="13">    <span class="cf">return</span> angle</a>
<a class="sourceLine" id="cb41-14" title="14"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb41-15" title="15"></a>
<a class="sourceLine" id="cb41-16" title="16"><span class="kw">def</span> unit_vec(vector):</a>
<a class="sourceLine" id="cb41-17" title="17">    <span class="cf">return</span> vector <span class="op">/</span> np.linalg.norm(vector)</a>
<a class="sourceLine" id="cb41-18" title="18"></a>
<a class="sourceLine" id="cb41-19" title="19">v1 <span class="op">=</span>  [<span class="fl">1.2</span>,<span class="fl">0.5</span>,<span class="fl">0.5</span>]</a>
<a class="sourceLine" id="cb41-20" title="20">v2 <span class="op">=</span>  [<span class="op">-</span><span class="fl">1.5</span>,<span class="fl">2.0</span>,<span class="fl">0.0</span>]</a>
<a class="sourceLine" id="cb41-21" title="21"></a>
<a class="sourceLine" id="cb41-22" title="22">v1_u <span class="op">=</span> unit_vec(v1)</a>
<a class="sourceLine" id="cb41-23" title="23">v2_u <span class="op">=</span> unit_vec(v2)</a>
<a class="sourceLine" id="cb41-24" title="24"></a>
<a class="sourceLine" id="cb41-25" title="25">angle <span class="op">=</span> np.arccos(np.clip(np.dot(v1_u, v2_u), <span class="fl">-1.0</span>, <span class="fl">1.0</span>))</a>
<a class="sourceLine" id="cb41-26" title="26"></a>
<a class="sourceLine" id="cb41-27" title="27">angle_codex <span class="op">=</span>  vector_angle(v1,v2)</a>
<a class="sourceLine" id="cb41-28" title="28"></a>
<a class="sourceLine" id="cb41-29" title="29"><span class="cf">if</span> np.isclose(angle, angle_codex) <span class="op">==</span> <span class="va">True</span>:</a>
<a class="sourceLine" id="cb41-30" title="30">    result <span class="op">=</span> <span class="va">True</span></a>
<a class="sourceLine" id="cb41-31" title="31"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb41-32" title="32">    result <span class="op">=</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-3">Run 4</h4>
<div class="sourceCode" id="cb43"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb43-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb43-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb43-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb43-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb43-5" title="5"></a>
<a class="sourceLine" id="cb43-6" title="6"><span class="kw">def</span> vector_angle(v1,v2):</a>
<a class="sourceLine" id="cb43-7" title="7">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb43-8" title="8"><span class="co">    This function returns the angle between vector v1 and vector v2.</span></a>
<a class="sourceLine" id="cb43-9" title="9"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb43-10" title="10">    cosang <span class="op">=</span> np.dot(v1, v2)</a>
<a class="sourceLine" id="cb43-11" title="11">    sinang <span class="op">=</span> np.linalg.norm(np.cross(v1, v2))</a>
<a class="sourceLine" id="cb43-12" title="12">    angle <span class="op">=</span> np.arctan2(sinang, cosang)</a>
<a class="sourceLine" id="cb43-13" title="13">    <span class="cf">return</span> angle</a>
<a class="sourceLine" id="cb43-14" title="14"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb43-15" title="15"></a>
<a class="sourceLine" id="cb43-16" title="16"><span class="kw">def</span> unit_vec(vector):</a>
<a class="sourceLine" id="cb43-17" title="17">    <span class="cf">return</span> vector <span class="op">/</span> np.linalg.norm(vector)</a>
<a class="sourceLine" id="cb43-18" title="18"></a>
<a class="sourceLine" id="cb43-19" title="19">v1 <span class="op">=</span>  [<span class="fl">1.2</span>,<span class="fl">0.5</span>,<span class="fl">0.5</span>]</a>
<a class="sourceLine" id="cb43-20" title="20">v2 <span class="op">=</span>  [<span class="op">-</span><span class="fl">1.5</span>,<span class="fl">2.0</span>,<span class="fl">0.0</span>]</a>
<a class="sourceLine" id="cb43-21" title="21"></a>
<a class="sourceLine" id="cb43-22" title="22">v1_u <span class="op">=</span> unit_vec(v1)</a>
<a class="sourceLine" id="cb43-23" title="23">v2_u <span class="op">=</span> unit_vec(v2)</a>
<a class="sourceLine" id="cb43-24" title="24"></a>
<a class="sourceLine" id="cb43-25" title="25">angle <span class="op">=</span> np.arccos(np.clip(np.dot(v1_u, v2_u), <span class="fl">-1.0</span>, <span class="fl">1.0</span>))</a>
<a class="sourceLine" id="cb43-26" title="26"></a>
<a class="sourceLine" id="cb43-27" title="27">angle_codex <span class="op">=</span>  vector_angle(v1,v2)</a>
<a class="sourceLine" id="cb43-28" title="28"></a>
<a class="sourceLine" id="cb43-29" title="29"><span class="cf">if</span> np.isclose(angle, angle_codex) <span class="op">==</span> <span class="va">True</span>:</a>
<a class="sourceLine" id="cb43-30" title="30">    result <span class="op">=</span> <span class="va">True</span></a>
<a class="sourceLine" id="cb43-31" title="31"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb43-32" title="32">    result <span class="op">=</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>aromatic_aa</summary></p>
<h4 id="query-4">Query</h4>
<div class="sourceCode" id="cb45"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb45-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb45-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb45-3" title="3"></a>
<a class="sourceLine" id="cb45-4" title="4"><span class="kw">def</span> aromatic_aa(sequence):</a>
<a class="sourceLine" id="cb45-5" title="5">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb45-6" title="6"><span class="co">    This function takes in an amino acid sequence and returns the number of aromatic residues there are</span></a>
<a class="sourceLine" id="cb45-7" title="7"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb45-8" title="8">    [insert]</a>
<a class="sourceLine" id="cb45-9" title="9">    <span class="cf">return</span> count</a></code></pre></div>
<h4 id="run-0-4">Run 0</h4>
<div class="sourceCode" id="cb46"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb46-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb46-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb46-3" title="3"></a>
<a class="sourceLine" id="cb46-4" title="4"><span class="kw">def</span> aromatic_aa(sequence):</a>
<a class="sourceLine" id="cb46-5" title="5">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb46-6" title="6"><span class="co">    This function takes in an amino acid sequence and returns the number of aromatic residues there are</span></a>
<a class="sourceLine" id="cb46-7" title="7"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb46-8" title="8">    aromatic_residues <span class="op">=</span> [<span class="st">&#39;F&#39;</span>, <span class="st">&#39;Y&#39;</span>, <span class="st">&#39;W&#39;</span>]</a>
<a class="sourceLine" id="cb46-9" title="9">    count <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb46-10" title="10">    <span class="cf">for</span> aa <span class="kw">in</span> sequence:</a>
<a class="sourceLine" id="cb46-11" title="11">        <span class="cf">if</span> aa <span class="kw">in</span> aromatic_residues:</a>
<a class="sourceLine" id="cb46-12" title="12">            count <span class="op">+=</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb46-13" title="13">    <span class="cf">return</span> count</a>
<a class="sourceLine" id="cb46-14" title="14"></a>
<a class="sourceLine" id="cb46-15" title="15">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> aromatic_aa(<span class="st">&quot;FLRYSCV&quot;</span>)<span class="op">==</span><span class="dv">2</span> <span class="cf">else</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb46-16" title="16"></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-4">Run 1</h4>
<div class="sourceCode" id="cb48"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb48-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb48-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb48-3" title="3"></a>
<a class="sourceLine" id="cb48-4" title="4"><span class="kw">def</span> aromatic_aa(sequence):</a>
<a class="sourceLine" id="cb48-5" title="5">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb48-6" title="6"><span class="co">    This function takes in an amino acid sequence and returns the number of aromatic residues there are</span></a>
<a class="sourceLine" id="cb48-7" title="7"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb48-8" title="8">    count <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb48-9" title="9">    <span class="cf">for</span> aa <span class="kw">in</span> sequence:</a>
<a class="sourceLine" id="cb48-10" title="10">        <span class="cf">if</span> aa <span class="op">==</span> <span class="st">&#39;F&#39;</span> <span class="kw">or</span> aa <span class="op">==</span> <span class="st">&#39;Y&#39;</span> <span class="kw">or</span> aa <span class="op">==</span> <span class="st">&#39;W&#39;</span>:</a>
<a class="sourceLine" id="cb48-11" title="11">            count <span class="op">+=</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb48-12" title="12">    <span class="cf">return</span> count</a>
<a class="sourceLine" id="cb48-13" title="13"></a>
<a class="sourceLine" id="cb48-14" title="14">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> aromatic_aa(<span class="st">&quot;FLRYSCV&quot;</span>)<span class="op">==</span><span class="dv">2</span> <span class="cf">else</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb48-15" title="15"></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-4">Run 2</h4>
<div class="sourceCode" id="cb50"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb50-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb50-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb50-3" title="3"></a>
<a class="sourceLine" id="cb50-4" title="4"><span class="kw">def</span> aromatic_aa(sequence):</a>
<a class="sourceLine" id="cb50-5" title="5">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb50-6" title="6"><span class="co">    This function takes in an amino acid sequence and returns the number of aromatic residues there are</span></a>
<a class="sourceLine" id="cb50-7" title="7"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb50-8" title="8">    aromatic_residues <span class="op">=</span> [<span class="st">&#39;F&#39;</span>, <span class="st">&#39;Y&#39;</span>, <span class="st">&#39;W&#39;</span>]</a>
<a class="sourceLine" id="cb50-9" title="9">    count <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb50-10" title="10">    <span class="cf">for</span> i <span class="kw">in</span> sequence:</a>
<a class="sourceLine" id="cb50-11" title="11">        <span class="cf">if</span> i <span class="kw">in</span> aromatic_residues:</a>
<a class="sourceLine" id="cb50-12" title="12">            count <span class="op">+=</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb50-13" title="13">    <span class="cf">return</span> count</a>
<a class="sourceLine" id="cb50-14" title="14"></a>
<a class="sourceLine" id="cb50-15" title="15">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> aromatic_aa(<span class="st">&quot;FLRYSCV&quot;</span>)<span class="op">==</span><span class="dv">2</span> <span class="cf">else</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb50-16" title="16"></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-4">Run 3</h4>
<div class="sourceCode" id="cb52"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb52-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb52-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb52-3" title="3"></a>
<a class="sourceLine" id="cb52-4" title="4"><span class="kw">def</span> aromatic_aa(sequence):</a>
<a class="sourceLine" id="cb52-5" title="5">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb52-6" title="6"><span class="co">    This function takes in an amino acid sequence and returns the number of aromatic residues there are</span></a>
<a class="sourceLine" id="cb52-7" title="7"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb52-8" title="8">    aromatic_residues <span class="op">=</span> [<span class="st">&#39;F&#39;</span>, <span class="st">&#39;W&#39;</span>, <span class="st">&#39;Y&#39;</span>]</a>
<a class="sourceLine" id="cb52-9" title="9">    count <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb52-10" title="10">    <span class="cf">for</span> residue <span class="kw">in</span> sequence:</a>
<a class="sourceLine" id="cb52-11" title="11">        <span class="cf">if</span> residue <span class="kw">in</span> aromatic_residues:</a>
<a class="sourceLine" id="cb52-12" title="12">            count <span class="op">+=</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb52-13" title="13">    <span class="cf">return</span> count</a>
<a class="sourceLine" id="cb52-14" title="14"></a>
<a class="sourceLine" id="cb52-15" title="15">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> aromatic_aa(<span class="st">&quot;FLRYSCV&quot;</span>)<span class="op">==</span><span class="dv">2</span> <span class="cf">else</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb52-16" title="16"></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-4">Run 4</h4>
<div class="sourceCode" id="cb54"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb54-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb54-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb54-3" title="3"></a>
<a class="sourceLine" id="cb54-4" title="4"><span class="kw">def</span> aromatic_aa(sequence):</a>
<a class="sourceLine" id="cb54-5" title="5">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb54-6" title="6"><span class="co">    This function takes in an amino acid sequence and returns the number of aromatic residues there are</span></a>
<a class="sourceLine" id="cb54-7" title="7"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb54-8" title="8">    count <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb54-9" title="9">    <span class="cf">for</span> aa <span class="kw">in</span> sequence:</a>
<a class="sourceLine" id="cb54-10" title="10">        <span class="cf">if</span> aa <span class="op">==</span> <span class="st">&#39;F&#39;</span> <span class="kw">or</span> aa <span class="op">==</span> <span class="st">&#39;Y&#39;</span> <span class="kw">or</span> aa <span class="op">==</span> <span class="st">&#39;W&#39;</span>:</a>
<a class="sourceLine" id="cb54-11" title="11">            count <span class="op">+=</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb54-12" title="12">    <span class="cf">return</span> count</a>
<a class="sourceLine" id="cb54-13" title="13"></a>
<a class="sourceLine" id="cb54-14" title="14">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> aromatic_aa(<span class="st">&quot;FLRYSCV&quot;</span>)<span class="op">==</span><span class="dv">2</span> <span class="cf">else</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb54-15" title="15"></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>arrhenius</summary></p>
<h4 id="query-5">Query</h4>
<div class="sourceCode" id="cb56"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb56-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb56-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb56-3" title="3"></a>
<a class="sourceLine" id="cb56-4" title="4"><span class="kw">def</span> arrhenius(k2,T2,T1,Ea):</a>
<a class="sourceLine" id="cb56-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb56-6" title="6"><span class="co">   This function returns the value of the rate constant at temperature T1 using the Arrhenius equation</span></a>
<a class="sourceLine" id="cb56-7" title="7"><span class="co">   k2 is the rate constant at temperature T2.</span></a>
<a class="sourceLine" id="cb56-8" title="8"><span class="co">   Ea is the activation energy in J/mol.</span></a>
<a class="sourceLine" id="cb56-9" title="9"><span class="co">   Temperatures are given in Kelvin</span></a>
<a class="sourceLine" id="cb56-10" title="10"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb56-11" title="11">   [insert]</a>
<a class="sourceLine" id="cb56-12" title="12">   <span class="cf">return</span> k1</a></code></pre></div>
<h4 id="run-0-5">Run 0</h4>
<div class="sourceCode" id="cb57"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb57-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb57-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb57-3" title="3"></a>
<a class="sourceLine" id="cb57-4" title="4"><span class="kw">def</span> arrhenius(k2,T2,T1,Ea):</a>
<a class="sourceLine" id="cb57-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb57-6" title="6"><span class="co">   This function returns the value of the rate constant at temperature T1 using the Arrhenius equation</span></a>
<a class="sourceLine" id="cb57-7" title="7"><span class="co">   k2 is the rate constant at temperature T2.</span></a>
<a class="sourceLine" id="cb57-8" title="8"><span class="co">   Ea is the activation energy in J/mol.</span></a>
<a class="sourceLine" id="cb57-9" title="9"><span class="co">   Temperatures are given in Kelvin</span></a>
<a class="sourceLine" id="cb57-10" title="10"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb57-11" title="11">   k1 <span class="op">=</span> k2 <span class="op">*</span> math.exp((Ea<span class="op">/</span><span class="fl">8.314</span>)<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>T2 <span class="op">-</span> <span class="dv">1</span><span class="op">/</span>T1))</a>
<a class="sourceLine" id="cb57-12" title="12">   <span class="cf">return</span> k1</a>
<a class="sourceLine" id="cb57-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb57-14" title="14"></a>
<a class="sourceLine" id="cb57-15" title="15"><span class="co"># inputs</span></a>
<a class="sourceLine" id="cb57-16" title="16">T1 <span class="op">=</span> <span class="fl">308.18</span>   <span class="co"># in K</span></a>
<a class="sourceLine" id="cb57-17" title="17">T2 <span class="op">=</span> <span class="fl">333.18</span>   <span class="co"># in K</span></a>
<a class="sourceLine" id="cb57-18" title="18">R <span class="op">=</span> <span class="fl">8.314</span>     <span class="co"># J/mol.K</span></a>
<a class="sourceLine" id="cb57-19" title="19">Ea <span class="op">=</span> <span class="dv">108000</span>   <span class="co"># J/mol</span></a>
<a class="sourceLine" id="cb57-20" title="20">k2 <span class="op">=</span> <span class="fl">1e-3</span>     <span class="co"># M-1 s-1 </span></a>
<a class="sourceLine" id="cb57-21" title="21"></a>
<a class="sourceLine" id="cb57-22" title="22">k1 <span class="op">=</span> k2<span class="op">*</span>np.exp((<span class="op">-</span>Ea<span class="op">/</span>R) <span class="op">*</span> (<span class="dv">1</span><span class="op">/</span>T1 <span class="op">-</span> <span class="dv">1</span><span class="op">/</span>T2))</a>
<a class="sourceLine" id="cb57-23" title="23">k1_codex <span class="op">=</span> arrhenius(k2,T2,T1,Ea)</a>
<a class="sourceLine" id="cb57-24" title="24"><span class="co">#print(k1,k1_codex)</span></a>
<a class="sourceLine" id="cb57-25" title="25"></a>
<a class="sourceLine" id="cb57-26" title="26"><span class="cf">if</span> np.isclose(k1,k1_codex) <span class="op">==</span> <span class="va">True</span>:</a>
<a class="sourceLine" id="cb57-27" title="27">    result <span class="op">=</span> <span class="va">True</span></a>
<a class="sourceLine" id="cb57-28" title="28"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb57-29" title="29">    result <span class="op">=</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb57-30" title="30"></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-5">Run 1</h4>
<div class="sourceCode" id="cb59"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb59-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb59-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb59-3" title="3"></a>
<a class="sourceLine" id="cb59-4" title="4"><span class="kw">def</span> arrhenius(k2,T2,T1,Ea):</a>
<a class="sourceLine" id="cb59-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb59-6" title="6"><span class="co">   This function returns the value of the rate constant at temperature T1 using the Arrhenius equation</span></a>
<a class="sourceLine" id="cb59-7" title="7"><span class="co">   k2 is the rate constant at temperature T2.</span></a>
<a class="sourceLine" id="cb59-8" title="8"><span class="co">   Ea is the activation energy in J/mol.</span></a>
<a class="sourceLine" id="cb59-9" title="9"><span class="co">   Temperatures are given in Kelvin</span></a>
<a class="sourceLine" id="cb59-10" title="10"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb59-11" title="11">   k1 <span class="op">=</span> k2<span class="op">*</span>math.exp((Ea<span class="op">/</span><span class="fl">8.314</span>)<span class="op">*</span>((<span class="dv">1</span><span class="op">/</span>T1)<span class="op">-</span>(<span class="dv">1</span><span class="op">/</span>T2)))</a>
<a class="sourceLine" id="cb59-12" title="12">   <span class="cf">return</span> k1</a>
<a class="sourceLine" id="cb59-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb59-14" title="14"></a>
<a class="sourceLine" id="cb59-15" title="15"><span class="co"># inputs</span></a>
<a class="sourceLine" id="cb59-16" title="16">T1 <span class="op">=</span> <span class="fl">308.18</span>   <span class="co"># in K</span></a>
<a class="sourceLine" id="cb59-17" title="17">T2 <span class="op">=</span> <span class="fl">333.18</span>   <span class="co"># in K</span></a>
<a class="sourceLine" id="cb59-18" title="18">R <span class="op">=</span> <span class="fl">8.314</span>     <span class="co"># J/mol.K</span></a>
<a class="sourceLine" id="cb59-19" title="19">Ea <span class="op">=</span> <span class="dv">108000</span>   <span class="co"># J/mol</span></a>
<a class="sourceLine" id="cb59-20" title="20">k2 <span class="op">=</span> <span class="fl">1e-3</span>     <span class="co"># M-1 s-1 </span></a>
<a class="sourceLine" id="cb59-21" title="21"></a>
<a class="sourceLine" id="cb59-22" title="22">k1 <span class="op">=</span> k2<span class="op">*</span>np.exp((<span class="op">-</span>Ea<span class="op">/</span>R) <span class="op">*</span> (<span class="dv">1</span><span class="op">/</span>T1 <span class="op">-</span> <span class="dv">1</span><span class="op">/</span>T2))</a>
<a class="sourceLine" id="cb59-23" title="23">k1_codex <span class="op">=</span> arrhenius(k2,T2,T1,Ea)</a>
<a class="sourceLine" id="cb59-24" title="24"><span class="co">#print(k1,k1_codex)</span></a>
<a class="sourceLine" id="cb59-25" title="25"></a>
<a class="sourceLine" id="cb59-26" title="26"><span class="cf">if</span> np.isclose(k1,k1_codex) <span class="op">==</span> <span class="va">True</span>:</a>
<a class="sourceLine" id="cb59-27" title="27">    result <span class="op">=</span> <span class="va">True</span></a>
<a class="sourceLine" id="cb59-28" title="28"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb59-29" title="29">    result <span class="op">=</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb59-30" title="30"></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-5">Run 2</h4>
<div class="sourceCode" id="cb61"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb61-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb61-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb61-3" title="3"></a>
<a class="sourceLine" id="cb61-4" title="4"><span class="kw">def</span> arrhenius(k2,T2,T1,Ea):</a>
<a class="sourceLine" id="cb61-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb61-6" title="6"><span class="co">   This function returns the value of the rate constant at temperature T1 using the Arrhenius equation</span></a>
<a class="sourceLine" id="cb61-7" title="7"><span class="co">   k2 is the rate constant at temperature T2.</span></a>
<a class="sourceLine" id="cb61-8" title="8"><span class="co">   Ea is the activation energy in J/mol.</span></a>
<a class="sourceLine" id="cb61-9" title="9"><span class="co">   Temperatures are given in Kelvin</span></a>
<a class="sourceLine" id="cb61-10" title="10"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb61-11" title="11">   R <span class="op">=</span> <span class="fl">8.314</span></a>
<a class="sourceLine" id="cb61-12" title="12">   k1 <span class="op">=</span> k2 <span class="op">*</span> math.exp((<span class="op">-</span>Ea)<span class="op">/</span>(R<span class="op">*</span>T1))</a>
<a class="sourceLine" id="cb61-13" title="13">   <span class="cf">return</span> k1</a>
<a class="sourceLine" id="cb61-14" title="14"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb61-15" title="15"></a>
<a class="sourceLine" id="cb61-16" title="16"><span class="co"># inputs</span></a>
<a class="sourceLine" id="cb61-17" title="17">T1 <span class="op">=</span> <span class="fl">308.18</span>   <span class="co"># in K</span></a>
<a class="sourceLine" id="cb61-18" title="18">T2 <span class="op">=</span> <span class="fl">333.18</span>   <span class="co"># in K</span></a>
<a class="sourceLine" id="cb61-19" title="19">R <span class="op">=</span> <span class="fl">8.314</span>     <span class="co"># J/mol.K</span></a>
<a class="sourceLine" id="cb61-20" title="20">Ea <span class="op">=</span> <span class="dv">108000</span>   <span class="co"># J/mol</span></a>
<a class="sourceLine" id="cb61-21" title="21">k2 <span class="op">=</span> <span class="fl">1e-3</span>     <span class="co"># M-1 s-1 </span></a>
<a class="sourceLine" id="cb61-22" title="22"></a>
<a class="sourceLine" id="cb61-23" title="23">k1 <span class="op">=</span> k2<span class="op">*</span>np.exp((<span class="op">-</span>Ea<span class="op">/</span>R) <span class="op">*</span> (<span class="dv">1</span><span class="op">/</span>T1 <span class="op">-</span> <span class="dv">1</span><span class="op">/</span>T2))</a>
<a class="sourceLine" id="cb61-24" title="24">k1_codex <span class="op">=</span> arrhenius(k2,T2,T1,Ea)</a>
<a class="sourceLine" id="cb61-25" title="25"><span class="co">#print(k1,k1_codex)</span></a>
<a class="sourceLine" id="cb61-26" title="26"></a>
<a class="sourceLine" id="cb61-27" title="27"><span class="cf">if</span> np.isclose(k1,k1_codex) <span class="op">==</span> <span class="va">True</span>:</a>
<a class="sourceLine" id="cb61-28" title="28">    result <span class="op">=</span> <span class="va">True</span></a>
<a class="sourceLine" id="cb61-29" title="29"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb61-30" title="30">    result <span class="op">=</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb61-31" title="31"></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-5">Run 3</h4>
<div class="sourceCode" id="cb63"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb63-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb63-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb63-3" title="3"></a>
<a class="sourceLine" id="cb63-4" title="4"><span class="kw">def</span> arrhenius(k2,T2,T1,Ea):</a>
<a class="sourceLine" id="cb63-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb63-6" title="6"><span class="co">   This function returns the value of the rate constant at temperature T1 using the Arrhenius equation</span></a>
<a class="sourceLine" id="cb63-7" title="7"><span class="co">   k2 is the rate constant at temperature T2.</span></a>
<a class="sourceLine" id="cb63-8" title="8"><span class="co">   Ea is the activation energy in J/mol.</span></a>
<a class="sourceLine" id="cb63-9" title="9"><span class="co">   Temperatures are given in Kelvin</span></a>
<a class="sourceLine" id="cb63-10" title="10"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb63-11" title="11">   k1 <span class="op">=</span> k2<span class="op">*</span>math.exp((Ea<span class="op">/</span><span class="fl">8.314</span>)<span class="op">*</span>((<span class="dv">1</span><span class="op">/</span>T1)<span class="op">-</span>(<span class="dv">1</span><span class="op">/</span>T2)))</a>
<a class="sourceLine" id="cb63-12" title="12">   <span class="cf">return</span> k1</a>
<a class="sourceLine" id="cb63-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb63-14" title="14"></a>
<a class="sourceLine" id="cb63-15" title="15"><span class="co"># inputs</span></a>
<a class="sourceLine" id="cb63-16" title="16">T1 <span class="op">=</span> <span class="fl">308.18</span>   <span class="co"># in K</span></a>
<a class="sourceLine" id="cb63-17" title="17">T2 <span class="op">=</span> <span class="fl">333.18</span>   <span class="co"># in K</span></a>
<a class="sourceLine" id="cb63-18" title="18">R <span class="op">=</span> <span class="fl">8.314</span>     <span class="co"># J/mol.K</span></a>
<a class="sourceLine" id="cb63-19" title="19">Ea <span class="op">=</span> <span class="dv">108000</span>   <span class="co"># J/mol</span></a>
<a class="sourceLine" id="cb63-20" title="20">k2 <span class="op">=</span> <span class="fl">1e-3</span>     <span class="co"># M-1 s-1 </span></a>
<a class="sourceLine" id="cb63-21" title="21"></a>
<a class="sourceLine" id="cb63-22" title="22">k1 <span class="op">=</span> k2<span class="op">*</span>np.exp((<span class="op">-</span>Ea<span class="op">/</span>R) <span class="op">*</span> (<span class="dv">1</span><span class="op">/</span>T1 <span class="op">-</span> <span class="dv">1</span><span class="op">/</span>T2))</a>
<a class="sourceLine" id="cb63-23" title="23">k1_codex <span class="op">=</span> arrhenius(k2,T2,T1,Ea)</a>
<a class="sourceLine" id="cb63-24" title="24"><span class="co">#print(k1,k1_codex)</span></a>
<a class="sourceLine" id="cb63-25" title="25"></a>
<a class="sourceLine" id="cb63-26" title="26"><span class="cf">if</span> np.isclose(k1,k1_codex) <span class="op">==</span> <span class="va">True</span>:</a>
<a class="sourceLine" id="cb63-27" title="27">    result <span class="op">=</span> <span class="va">True</span></a>
<a class="sourceLine" id="cb63-28" title="28"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb63-29" title="29">    result <span class="op">=</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb63-30" title="30"></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-5">Run 4</h4>
<div class="sourceCode" id="cb65"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb65-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb65-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb65-3" title="3"></a>
<a class="sourceLine" id="cb65-4" title="4"><span class="kw">def</span> arrhenius(k2,T2,T1,Ea):</a>
<a class="sourceLine" id="cb65-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb65-6" title="6"><span class="co">   This function returns the value of the rate constant at temperature T1 using the Arrhenius equation</span></a>
<a class="sourceLine" id="cb65-7" title="7"><span class="co">   k2 is the rate constant at temperature T2.</span></a>
<a class="sourceLine" id="cb65-8" title="8"><span class="co">   Ea is the activation energy in J/mol.</span></a>
<a class="sourceLine" id="cb65-9" title="9"><span class="co">   Temperatures are given in Kelvin</span></a>
<a class="sourceLine" id="cb65-10" title="10"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb65-11" title="11">   k1 <span class="op">=</span> k2 <span class="op">*</span> math.exp((<span class="op">-</span>Ea<span class="op">/</span><span class="fl">8.314</span>)<span class="op">*</span>((<span class="dv">1</span><span class="op">/</span>T1)<span class="op">-</span>(<span class="dv">1</span><span class="op">/</span>T2)))</a>
<a class="sourceLine" id="cb65-12" title="12">   <span class="cf">return</span> k1</a>
<a class="sourceLine" id="cb65-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb65-14" title="14"></a>
<a class="sourceLine" id="cb65-15" title="15"><span class="co"># inputs</span></a>
<a class="sourceLine" id="cb65-16" title="16">T1 <span class="op">=</span> <span class="fl">308.18</span>   <span class="co"># in K</span></a>
<a class="sourceLine" id="cb65-17" title="17">T2 <span class="op">=</span> <span class="fl">333.18</span>   <span class="co"># in K</span></a>
<a class="sourceLine" id="cb65-18" title="18">R <span class="op">=</span> <span class="fl">8.314</span>     <span class="co"># J/mol.K</span></a>
<a class="sourceLine" id="cb65-19" title="19">Ea <span class="op">=</span> <span class="dv">108000</span>   <span class="co"># J/mol</span></a>
<a class="sourceLine" id="cb65-20" title="20">k2 <span class="op">=</span> <span class="fl">1e-3</span>     <span class="co"># M-1 s-1 </span></a>
<a class="sourceLine" id="cb65-21" title="21"></a>
<a class="sourceLine" id="cb65-22" title="22">k1 <span class="op">=</span> k2<span class="op">*</span>np.exp((<span class="op">-</span>Ea<span class="op">/</span>R) <span class="op">*</span> (<span class="dv">1</span><span class="op">/</span>T1 <span class="op">-</span> <span class="dv">1</span><span class="op">/</span>T2))</a>
<a class="sourceLine" id="cb65-23" title="23">k1_codex <span class="op">=</span> arrhenius(k2,T2,T1,Ea)</a>
<a class="sourceLine" id="cb65-24" title="24"><span class="co">#print(k1,k1_codex)</span></a>
<a class="sourceLine" id="cb65-25" title="25"></a>
<a class="sourceLine" id="cb65-26" title="26"><span class="cf">if</span> np.isclose(k1,k1_codex) <span class="op">==</span> <span class="va">True</span>:</a>
<a class="sourceLine" id="cb65-27" title="27">    result <span class="op">=</span> <span class="va">True</span></a>
<a class="sourceLine" id="cb65-28" title="28"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb65-29" title="29">    result <span class="op">=</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb65-30" title="30"></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>bimolecular</summary></p>
<h4 id="query-6">Query</h4>
<div class="sourceCode" id="cb67"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb67-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb67-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb67-3" title="3"></a>
<a class="sourceLine" id="cb67-4" title="4"><span class="kw">def</span> bimolecular_rate(k,A,B):</a>
<a class="sourceLine" id="cb67-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb67-6" title="6"><span class="co">   This function returns the rate of reaction given the rate constant k and concentrations of species A and B</span></a>
<a class="sourceLine" id="cb67-7" title="7"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb67-8" title="8">   [insert]</a>
<a class="sourceLine" id="cb67-9" title="9">   <span class="cf">return</span> rate</a></code></pre></div>
<h4 id="run-0-6">Run 0</h4>
<div class="sourceCode" id="cb68"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb68-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb68-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb68-3" title="3"></a>
<a class="sourceLine" id="cb68-4" title="4"><span class="kw">def</span> bimolecular_rate(k,A,B):</a>
<a class="sourceLine" id="cb68-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb68-6" title="6"><span class="co">   This function returns the rate of reaction given the rate constant k and concentrations of species A and B</span></a>
<a class="sourceLine" id="cb68-7" title="7"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb68-8" title="8">   rate <span class="op">=</span> k<span class="op">*</span>A<span class="op">*</span>B</a>
<a class="sourceLine" id="cb68-9" title="9">   <span class="cf">return</span> rate</a>
<a class="sourceLine" id="cb68-10" title="10"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb68-11" title="11"></a>
<a class="sourceLine" id="cb68-12" title="12">k <span class="op">=</span> <span class="dv">2</span></a>
<a class="sourceLine" id="cb68-13" title="13">A <span class="op">=</span> <span class="fl">0.1</span></a>
<a class="sourceLine" id="cb68-14" title="14">B <span class="op">=</span> <span class="fl">0.2</span></a>
<a class="sourceLine" id="cb68-15" title="15">rate <span class="op">=</span> k<span class="op">*</span>A<span class="op">*</span>B</a>
<a class="sourceLine" id="cb68-16" title="16"></a>
<a class="sourceLine" id="cb68-17" title="17">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(rate,bimolecular_rate(k,A,B)) <span class="cf">else</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb68-18" title="18"></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-6">Run 1</h4>
<div class="sourceCode" id="cb70"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb70-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb70-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb70-3" title="3"></a>
<a class="sourceLine" id="cb70-4" title="4"><span class="kw">def</span> bimolecular_rate(k,A,B):</a>
<a class="sourceLine" id="cb70-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb70-6" title="6"><span class="co">   This function returns the rate of reaction given the rate constant k and concentrations of species A and B</span></a>
<a class="sourceLine" id="cb70-7" title="7"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb70-8" title="8">   rate <span class="op">=</span> k<span class="op">*</span>A<span class="op">*</span>B</a>
<a class="sourceLine" id="cb70-9" title="9">   <span class="cf">return</span> rate</a>
<a class="sourceLine" id="cb70-10" title="10"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb70-11" title="11"></a>
<a class="sourceLine" id="cb70-12" title="12">k <span class="op">=</span> <span class="dv">2</span></a>
<a class="sourceLine" id="cb70-13" title="13">A <span class="op">=</span> <span class="fl">0.1</span></a>
<a class="sourceLine" id="cb70-14" title="14">B <span class="op">=</span> <span class="fl">0.2</span></a>
<a class="sourceLine" id="cb70-15" title="15">rate <span class="op">=</span> k<span class="op">*</span>A<span class="op">*</span>B</a>
<a class="sourceLine" id="cb70-16" title="16"></a>
<a class="sourceLine" id="cb70-17" title="17">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(rate,bimolecular_rate(k,A,B)) <span class="cf">else</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb70-18" title="18"></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-6">Run 2</h4>
<div class="sourceCode" id="cb72"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb72-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb72-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb72-3" title="3"></a>
<a class="sourceLine" id="cb72-4" title="4"><span class="kw">def</span> bimolecular_rate(k,A,B):</a>
<a class="sourceLine" id="cb72-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb72-6" title="6"><span class="co">   This function returns the rate of reaction given the rate constant k and concentrations of species A and B</span></a>
<a class="sourceLine" id="cb72-7" title="7"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb72-8" title="8">   rate <span class="op">=</span> k<span class="op">*</span>A<span class="op">*</span>B</a>
<a class="sourceLine" id="cb72-9" title="9">   <span class="cf">return</span> rate</a>
<a class="sourceLine" id="cb72-10" title="10"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb72-11" title="11"></a>
<a class="sourceLine" id="cb72-12" title="12">k <span class="op">=</span> <span class="dv">2</span></a>
<a class="sourceLine" id="cb72-13" title="13">A <span class="op">=</span> <span class="fl">0.1</span></a>
<a class="sourceLine" id="cb72-14" title="14">B <span class="op">=</span> <span class="fl">0.2</span></a>
<a class="sourceLine" id="cb72-15" title="15">rate <span class="op">=</span> k<span class="op">*</span>A<span class="op">*</span>B</a>
<a class="sourceLine" id="cb72-16" title="16"></a>
<a class="sourceLine" id="cb72-17" title="17">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(rate,bimolecular_rate(k,A,B)) <span class="cf">else</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb72-18" title="18"></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-6">Run 3</h4>
<div class="sourceCode" id="cb74"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb74-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb74-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb74-3" title="3"></a>
<a class="sourceLine" id="cb74-4" title="4"><span class="kw">def</span> bimolecular_rate(k,A,B):</a>
<a class="sourceLine" id="cb74-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb74-6" title="6"><span class="co">   This function returns the rate of reaction given the rate constant k and concentrations of species A and B</span></a>
<a class="sourceLine" id="cb74-7" title="7"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb74-8" title="8">   rate <span class="op">=</span> k<span class="op">*</span>A<span class="op">*</span>B</a>
<a class="sourceLine" id="cb74-9" title="9"></a>
<a class="sourceLine" id="cb74-10" title="10">   <span class="cf">return</span> rate</a>
<a class="sourceLine" id="cb74-11" title="11"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb74-12" title="12"></a>
<a class="sourceLine" id="cb74-13" title="13">k <span class="op">=</span> <span class="dv">2</span></a>
<a class="sourceLine" id="cb74-14" title="14">A <span class="op">=</span> <span class="fl">0.1</span></a>
<a class="sourceLine" id="cb74-15" title="15">B <span class="op">=</span> <span class="fl">0.2</span></a>
<a class="sourceLine" id="cb74-16" title="16">rate <span class="op">=</span> k<span class="op">*</span>A<span class="op">*</span>B</a>
<a class="sourceLine" id="cb74-17" title="17"></a>
<a class="sourceLine" id="cb74-18" title="18">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(rate,bimolecular_rate(k,A,B)) <span class="cf">else</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb74-19" title="19"></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-6">Run 4</h4>
<div class="sourceCode" id="cb76"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb76-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb76-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb76-3" title="3"></a>
<a class="sourceLine" id="cb76-4" title="4"><span class="kw">def</span> bimolecular_rate(k,A,B):</a>
<a class="sourceLine" id="cb76-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb76-6" title="6"><span class="co">   This function returns the rate of reaction given the rate constant k and concentrations of species A and B</span></a>
<a class="sourceLine" id="cb76-7" title="7"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb76-8" title="8">   rate <span class="op">=</span> k<span class="op">*</span>A<span class="op">*</span>B</a>
<a class="sourceLine" id="cb76-9" title="9"></a>
<a class="sourceLine" id="cb76-10" title="10">   <span class="cf">return</span> rate</a>
<a class="sourceLine" id="cb76-11" title="11"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb76-12" title="12"></a>
<a class="sourceLine" id="cb76-13" title="13">k <span class="op">=</span> <span class="dv">2</span></a>
<a class="sourceLine" id="cb76-14" title="14">A <span class="op">=</span> <span class="fl">0.1</span></a>
<a class="sourceLine" id="cb76-15" title="15">B <span class="op">=</span> <span class="fl">0.2</span></a>
<a class="sourceLine" id="cb76-16" title="16">rate <span class="op">=</span> k<span class="op">*</span>A<span class="op">*</span>B</a>
<a class="sourceLine" id="cb76-17" title="17"></a>
<a class="sourceLine" id="cb76-18" title="18">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(rate,bimolecular_rate(k,A,B)) <span class="cf">else</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb76-19" title="19"></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>bb_rad</summary></p>
<h4 id="query-7">Query</h4>
<div class="sourceCode" id="cb78"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb78-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb78-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb78-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb78-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb78-5" title="5"></a>
<a class="sourceLine" id="cb78-6" title="6"><span class="kw">def</span> bb_radiation(lam, T):</a>
<a class="sourceLine" id="cb78-7" title="7">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb78-8" title="8"><span class="co">   This function calculates and returns the spectral radiance value in SI unit for wavelength lam at temperature T, using planck&#39;s law of black body radiation.</span></a>
<a class="sourceLine" id="cb78-9" title="9"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb78-10" title="10">   [insert]</a>
<a class="sourceLine" id="cb78-11" title="11">   <span class="cf">return</span> B</a></code></pre></div>
<h4 id="run-0-7">Run 0</h4>
<div class="sourceCode" id="cb79"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb79-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb79-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb79-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb79-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb79-5" title="5"></a>
<a class="sourceLine" id="cb79-6" title="6"><span class="kw">def</span> bb_radiation(lam, T):</a>
<a class="sourceLine" id="cb79-7" title="7">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb79-8" title="8"><span class="co">   This function calculates and returns the spectral radiance value in SI unit for wavelength lam at temperature T, using planck&#39;s law of black body radiation.</span></a>
<a class="sourceLine" id="cb79-9" title="9"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb79-10" title="10">   c <span class="op">=</span> <span class="fl">3e8</span></a>
<a class="sourceLine" id="cb79-11" title="11">   h <span class="op">=</span> <span class="fl">6.626e-34</span></a>
<a class="sourceLine" id="cb79-12" title="12">   k <span class="op">=</span> <span class="fl">1.38e-23</span></a>
<a class="sourceLine" id="cb79-13" title="13">   B <span class="op">=</span> <span class="dv">2</span><span class="op">*</span>h<span class="op">*</span>c<span class="op">**</span><span class="dv">2</span><span class="op">/</span>lam<span class="op">**</span><span class="dv">5</span><span class="op">/</span>(np.exp(h<span class="op">*</span>c<span class="op">/</span>(lam<span class="op">*</span>k<span class="op">*</span>T))<span class="op">-</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb79-14" title="14">   <span class="cf">return</span> B</a>
<a class="sourceLine" id="cb79-15" title="15"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb79-16" title="16"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb79-17" title="17"></a>
<a class="sourceLine" id="cb79-18" title="18"><span class="co"># input params</span></a>
<a class="sourceLine" id="cb79-19" title="19">h <span class="op">=</span> <span class="fl">6.634e-34</span>       <span class="co"># J.s</span></a>
<a class="sourceLine" id="cb79-20" title="20">c <span class="op">=</span> <span class="fl">3.0e8</span>           <span class="co"># m/s</span></a>
<a class="sourceLine" id="cb79-21" title="21">k <span class="op">=</span> <span class="fl">1.381e-23</span>       <span class="co"># J.K-1</span></a>
<a class="sourceLine" id="cb79-22" title="22">T <span class="op">=</span> <span class="dv">5000</span>            <span class="co"># in K</span></a>
<a class="sourceLine" id="cb79-23" title="23">lamb_val <span class="op">=</span> <span class="fl">1.0e-6</span>   <span class="co"># in m</span></a>
<a class="sourceLine" id="cb79-24" title="24"></a>
<a class="sourceLine" id="cb79-25" title="25"></a>
<a class="sourceLine" id="cb79-26" title="26"><span class="co"># spectral radiance</span></a>
<a class="sourceLine" id="cb79-27" title="27">B <span class="op">=</span> (<span class="dv">2</span><span class="op">*</span>h<span class="op">*</span>c<span class="op">**</span><span class="dv">2</span><span class="op">/</span>lamb_val<span class="op">**</span><span class="dv">5</span>) <span class="op">*</span> (<span class="dv">1</span><span class="op">/</span>(np.exp(h<span class="op">*</span>c<span class="op">/</span>(lamb_val<span class="op">*</span>k<span class="op">*</span>T)) <span class="op">-</span> <span class="dv">1</span>))</a>
<a class="sourceLine" id="cb79-28" title="28"><span class="bu">print</span>(<span class="st">&quot;spectral radiance =&quot;</span>, B)</a>
<a class="sourceLine" id="cb79-29" title="29"></a>
<a class="sourceLine" id="cb79-30" title="30">B_codex <span class="op">=</span> bb_radiation(lamb_val, T)</a>
<a class="sourceLine" id="cb79-31" title="31"><span class="bu">print</span>(<span class="st">&quot;spectral radiance from codex =&quot;</span>, B_codex)</a>
<a class="sourceLine" id="cb79-32" title="32"></a>
<a class="sourceLine" id="cb79-33" title="33"></a>
<a class="sourceLine" id="cb79-34" title="34"><span class="co"># check</span></a>
<a class="sourceLine" id="cb79-35" title="35"><span class="cf">if</span> <span class="bu">abs</span>((B <span class="op">-</span> B_codex) <span class="op">/</span> B) <span class="op">&lt;=</span> <span class="fl">1e-2</span>:</a>
<a class="sourceLine" id="cb79-36" title="36">    result <span class="op">=</span> <span class="va">True</span></a>
<a class="sourceLine" id="cb79-37" title="37"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb79-38" title="38">    result <span class="op">=</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-7">Run 1</h4>
<div class="sourceCode" id="cb81"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb81-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb81-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb81-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb81-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb81-5" title="5"></a>
<a class="sourceLine" id="cb81-6" title="6"><span class="kw">def</span> bb_radiation(lam, T):</a>
<a class="sourceLine" id="cb81-7" title="7">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb81-8" title="8"><span class="co">   This function calculates and returns the spectral radiance value in SI unit for wavelength lam at temperature T, using planck&#39;s law of black body radiation.</span></a>
<a class="sourceLine" id="cb81-9" title="9"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb81-10" title="10">   h <span class="op">=</span> <span class="fl">6.626e-34</span></a>
<a class="sourceLine" id="cb81-11" title="11">   c <span class="op">=</span> <span class="fl">3.0e+8</span></a>
<a class="sourceLine" id="cb81-12" title="12">   k <span class="op">=</span> <span class="fl">1.38e-23</span></a>
<a class="sourceLine" id="cb81-13" title="13">   B <span class="op">=</span> <span class="fl">2.0</span><span class="op">*</span>h<span class="op">*</span>c<span class="op">**</span><span class="dv">2</span><span class="op">/</span>lam<span class="op">**</span><span class="dv">5</span><span class="op">/</span>(np.exp(h<span class="op">*</span>c<span class="op">/</span>(lam<span class="op">*</span>k<span class="op">*</span>T))<span class="op">-</span><span class="fl">1.0</span>)</a>
<a class="sourceLine" id="cb81-14" title="14">   <span class="cf">return</span> B</a>
<a class="sourceLine" id="cb81-15" title="15"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb81-16" title="16"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb81-17" title="17"></a>
<a class="sourceLine" id="cb81-18" title="18"><span class="co"># input params</span></a>
<a class="sourceLine" id="cb81-19" title="19">h <span class="op">=</span> <span class="fl">6.634e-34</span>       <span class="co"># J.s</span></a>
<a class="sourceLine" id="cb81-20" title="20">c <span class="op">=</span> <span class="fl">3.0e8</span>           <span class="co"># m/s</span></a>
<a class="sourceLine" id="cb81-21" title="21">k <span class="op">=</span> <span class="fl">1.381e-23</span>       <span class="co"># J.K-1</span></a>
<a class="sourceLine" id="cb81-22" title="22">T <span class="op">=</span> <span class="dv">5000</span>            <span class="co"># in K</span></a>
<a class="sourceLine" id="cb81-23" title="23">lamb_val <span class="op">=</span> <span class="fl">1.0e-6</span>   <span class="co"># in m</span></a>
<a class="sourceLine" id="cb81-24" title="24"></a>
<a class="sourceLine" id="cb81-25" title="25"></a>
<a class="sourceLine" id="cb81-26" title="26"><span class="co"># spectral radiance</span></a>
<a class="sourceLine" id="cb81-27" title="27">B <span class="op">=</span> (<span class="dv">2</span><span class="op">*</span>h<span class="op">*</span>c<span class="op">**</span><span class="dv">2</span><span class="op">/</span>lamb_val<span class="op">**</span><span class="dv">5</span>) <span class="op">*</span> (<span class="dv">1</span><span class="op">/</span>(np.exp(h<span class="op">*</span>c<span class="op">/</span>(lamb_val<span class="op">*</span>k<span class="op">*</span>T)) <span class="op">-</span> <span class="dv">1</span>))</a>
<a class="sourceLine" id="cb81-28" title="28"><span class="bu">print</span>(<span class="st">&quot;spectral radiance =&quot;</span>, B)</a>
<a class="sourceLine" id="cb81-29" title="29"></a>
<a class="sourceLine" id="cb81-30" title="30">B_codex <span class="op">=</span> bb_radiation(lamb_val, T)</a>
<a class="sourceLine" id="cb81-31" title="31"><span class="bu">print</span>(<span class="st">&quot;spectral radiance from codex =&quot;</span>, B_codex)</a>
<a class="sourceLine" id="cb81-32" title="32"></a>
<a class="sourceLine" id="cb81-33" title="33"></a>
<a class="sourceLine" id="cb81-34" title="34"><span class="co"># check</span></a>
<a class="sourceLine" id="cb81-35" title="35"><span class="cf">if</span> <span class="bu">abs</span>((B <span class="op">-</span> B_codex) <span class="op">/</span> B) <span class="op">&lt;=</span> <span class="fl">1e-2</span>:</a>
<a class="sourceLine" id="cb81-36" title="36">    result <span class="op">=</span> <span class="va">True</span></a>
<a class="sourceLine" id="cb81-37" title="37"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb81-38" title="38">    result <span class="op">=</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-7">Run 2</h4>
<div class="sourceCode" id="cb83"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb83-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb83-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb83-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb83-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb83-5" title="5"></a>
<a class="sourceLine" id="cb83-6" title="6"><span class="kw">def</span> bb_radiation(lam, T):</a>
<a class="sourceLine" id="cb83-7" title="7">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb83-8" title="8"><span class="co">   This function calculates and returns the spectral radiance value in SI unit for wavelength lam at temperature T, using planck&#39;s law of black body radiation.</span></a>
<a class="sourceLine" id="cb83-9" title="9"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb83-10" title="10">   h <span class="op">=</span> <span class="fl">6.626e-34</span></a>
<a class="sourceLine" id="cb83-11" title="11">   c <span class="op">=</span> <span class="fl">3.0e+8</span></a>
<a class="sourceLine" id="cb83-12" title="12">   k <span class="op">=</span> <span class="fl">1.38e-23</span></a>
<a class="sourceLine" id="cb83-13" title="13">   B <span class="op">=</span> <span class="dv">2</span><span class="op">*</span>h<span class="op">*</span>c<span class="op">**</span><span class="dv">2</span><span class="op">/</span>lam<span class="op">**</span><span class="dv">5</span><span class="op">/</span>(np.exp(h<span class="op">*</span>c<span class="op">/</span>(lam<span class="op">*</span>k<span class="op">*</span>T))<span class="op">-</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb83-14" title="14">   <span class="cf">return</span> B</a>
<a class="sourceLine" id="cb83-15" title="15"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb83-16" title="16"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb83-17" title="17"></a>
<a class="sourceLine" id="cb83-18" title="18"><span class="co"># input params</span></a>
<a class="sourceLine" id="cb83-19" title="19">h <span class="op">=</span> <span class="fl">6.634e-34</span>       <span class="co"># J.s</span></a>
<a class="sourceLine" id="cb83-20" title="20">c <span class="op">=</span> <span class="fl">3.0e8</span>           <span class="co"># m/s</span></a>
<a class="sourceLine" id="cb83-21" title="21">k <span class="op">=</span> <span class="fl">1.381e-23</span>       <span class="co"># J.K-1</span></a>
<a class="sourceLine" id="cb83-22" title="22">T <span class="op">=</span> <span class="dv">5000</span>            <span class="co"># in K</span></a>
<a class="sourceLine" id="cb83-23" title="23">lamb_val <span class="op">=</span> <span class="fl">1.0e-6</span>   <span class="co"># in m</span></a>
<a class="sourceLine" id="cb83-24" title="24"></a>
<a class="sourceLine" id="cb83-25" title="25"></a>
<a class="sourceLine" id="cb83-26" title="26"><span class="co"># spectral radiance</span></a>
<a class="sourceLine" id="cb83-27" title="27">B <span class="op">=</span> (<span class="dv">2</span><span class="op">*</span>h<span class="op">*</span>c<span class="op">**</span><span class="dv">2</span><span class="op">/</span>lamb_val<span class="op">**</span><span class="dv">5</span>) <span class="op">*</span> (<span class="dv">1</span><span class="op">/</span>(np.exp(h<span class="op">*</span>c<span class="op">/</span>(lamb_val<span class="op">*</span>k<span class="op">*</span>T)) <span class="op">-</span> <span class="dv">1</span>))</a>
<a class="sourceLine" id="cb83-28" title="28"><span class="bu">print</span>(<span class="st">&quot;spectral radiance =&quot;</span>, B)</a>
<a class="sourceLine" id="cb83-29" title="29"></a>
<a class="sourceLine" id="cb83-30" title="30">B_codex <span class="op">=</span> bb_radiation(lamb_val, T)</a>
<a class="sourceLine" id="cb83-31" title="31"><span class="bu">print</span>(<span class="st">&quot;spectral radiance from codex =&quot;</span>, B_codex)</a>
<a class="sourceLine" id="cb83-32" title="32"></a>
<a class="sourceLine" id="cb83-33" title="33"></a>
<a class="sourceLine" id="cb83-34" title="34"><span class="co"># check</span></a>
<a class="sourceLine" id="cb83-35" title="35"><span class="cf">if</span> <span class="bu">abs</span>((B <span class="op">-</span> B_codex) <span class="op">/</span> B) <span class="op">&lt;=</span> <span class="fl">1e-2</span>:</a>
<a class="sourceLine" id="cb83-36" title="36">    result <span class="op">=</span> <span class="va">True</span></a>
<a class="sourceLine" id="cb83-37" title="37"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb83-38" title="38">    result <span class="op">=</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-7">Run 3</h4>
<div class="sourceCode" id="cb85"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb85-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb85-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb85-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb85-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb85-5" title="5"></a>
<a class="sourceLine" id="cb85-6" title="6"><span class="kw">def</span> bb_radiation(lam, T):</a>
<a class="sourceLine" id="cb85-7" title="7">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb85-8" title="8"><span class="co">   This function calculates and returns the spectral radiance value in SI unit for wavelength lam at temperature T, using planck&#39;s law of black body radiation.</span></a>
<a class="sourceLine" id="cb85-9" title="9"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb85-10" title="10">   h <span class="op">=</span> <span class="fl">6.62607004e-34</span> <span class="co"># Planck&#39;s constant</span></a>
<a class="sourceLine" id="cb85-11" title="11">   c <span class="op">=</span> <span class="fl">299792458.0</span> <span class="co"># Speed of light</span></a>
<a class="sourceLine" id="cb85-12" title="12">   k <span class="op">=</span> <span class="fl">1.38064852e-23</span> <span class="co"># Boltzmann&#39;s constant</span></a>
<a class="sourceLine" id="cb85-13" title="13">   B <span class="op">=</span> <span class="dv">2</span><span class="op">*</span>h<span class="op">*</span>c<span class="op">**</span><span class="dv">2</span><span class="op">/</span>lam<span class="op">**</span><span class="dv">5</span><span class="op">/</span>(np.exp(h<span class="op">*</span>c<span class="op">/</span>(lam<span class="op">*</span>k<span class="op">*</span>T))<span class="op">-</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb85-14" title="14">   <span class="cf">return</span> B</a>
<a class="sourceLine" id="cb85-15" title="15"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb85-16" title="16"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb85-17" title="17"></a>
<a class="sourceLine" id="cb85-18" title="18"><span class="co"># input params</span></a>
<a class="sourceLine" id="cb85-19" title="19">h <span class="op">=</span> <span class="fl">6.634e-34</span>       <span class="co"># J.s</span></a>
<a class="sourceLine" id="cb85-20" title="20">c <span class="op">=</span> <span class="fl">3.0e8</span>           <span class="co"># m/s</span></a>
<a class="sourceLine" id="cb85-21" title="21">k <span class="op">=</span> <span class="fl">1.381e-23</span>       <span class="co"># J.K-1</span></a>
<a class="sourceLine" id="cb85-22" title="22">T <span class="op">=</span> <span class="dv">5000</span>            <span class="co"># in K</span></a>
<a class="sourceLine" id="cb85-23" title="23">lamb_val <span class="op">=</span> <span class="fl">1.0e-6</span>   <span class="co"># in m</span></a>
<a class="sourceLine" id="cb85-24" title="24"></a>
<a class="sourceLine" id="cb85-25" title="25"></a>
<a class="sourceLine" id="cb85-26" title="26"><span class="co"># spectral radiance</span></a>
<a class="sourceLine" id="cb85-27" title="27">B <span class="op">=</span> (<span class="dv">2</span><span class="op">*</span>h<span class="op">*</span>c<span class="op">**</span><span class="dv">2</span><span class="op">/</span>lamb_val<span class="op">**</span><span class="dv">5</span>) <span class="op">*</span> (<span class="dv">1</span><span class="op">/</span>(np.exp(h<span class="op">*</span>c<span class="op">/</span>(lamb_val<span class="op">*</span>k<span class="op">*</span>T)) <span class="op">-</span> <span class="dv">1</span>))</a>
<a class="sourceLine" id="cb85-28" title="28"><span class="bu">print</span>(<span class="st">&quot;spectral radiance =&quot;</span>, B)</a>
<a class="sourceLine" id="cb85-29" title="29"></a>
<a class="sourceLine" id="cb85-30" title="30">B_codex <span class="op">=</span> bb_radiation(lamb_val, T)</a>
<a class="sourceLine" id="cb85-31" title="31"><span class="bu">print</span>(<span class="st">&quot;spectral radiance from codex =&quot;</span>, B_codex)</a>
<a class="sourceLine" id="cb85-32" title="32"></a>
<a class="sourceLine" id="cb85-33" title="33"></a>
<a class="sourceLine" id="cb85-34" title="34"><span class="co"># check</span></a>
<a class="sourceLine" id="cb85-35" title="35"><span class="cf">if</span> <span class="bu">abs</span>((B <span class="op">-</span> B_codex) <span class="op">/</span> B) <span class="op">&lt;=</span> <span class="fl">1e-2</span>:</a>
<a class="sourceLine" id="cb85-36" title="36">    result <span class="op">=</span> <span class="va">True</span></a>
<a class="sourceLine" id="cb85-37" title="37"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb85-38" title="38">    result <span class="op">=</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-7">Run 4</h4>
<div class="sourceCode" id="cb87"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb87-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb87-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb87-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb87-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb87-5" title="5"></a>
<a class="sourceLine" id="cb87-6" title="6"><span class="kw">def</span> bb_radiation(lam, T):</a>
<a class="sourceLine" id="cb87-7" title="7">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb87-8" title="8"><span class="co">   This function calculates and returns the spectral radiance value in SI unit for wavelength lam at temperature T, using planck&#39;s law of black body radiation.</span></a>
<a class="sourceLine" id="cb87-9" title="9"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb87-10" title="10">   h <span class="op">=</span> <span class="fl">6.626e-34</span></a>
<a class="sourceLine" id="cb87-11" title="11">   c <span class="op">=</span> <span class="fl">3e8</span></a>
<a class="sourceLine" id="cb87-12" title="12">   k <span class="op">=</span> <span class="fl">1.38e-23</span></a>
<a class="sourceLine" id="cb87-13" title="13">   B <span class="op">=</span> <span class="dv">2</span><span class="op">*</span>h<span class="op">*</span>c<span class="op">**</span><span class="dv">2</span><span class="op">/</span>lam<span class="op">**</span><span class="dv">5</span><span class="op">/</span>(np.exp(h<span class="op">*</span>c<span class="op">/</span>(lam<span class="op">*</span>k<span class="op">*</span>T))<span class="op">-</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb87-14" title="14">   <span class="cf">return</span> B</a>
<a class="sourceLine" id="cb87-15" title="15"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb87-16" title="16"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb87-17" title="17"></a>
<a class="sourceLine" id="cb87-18" title="18"><span class="co"># input params</span></a>
<a class="sourceLine" id="cb87-19" title="19">h <span class="op">=</span> <span class="fl">6.634e-34</span>       <span class="co"># J.s</span></a>
<a class="sourceLine" id="cb87-20" title="20">c <span class="op">=</span> <span class="fl">3.0e8</span>           <span class="co"># m/s</span></a>
<a class="sourceLine" id="cb87-21" title="21">k <span class="op">=</span> <span class="fl">1.381e-23</span>       <span class="co"># J.K-1</span></a>
<a class="sourceLine" id="cb87-22" title="22">T <span class="op">=</span> <span class="dv">5000</span>            <span class="co"># in K</span></a>
<a class="sourceLine" id="cb87-23" title="23">lamb_val <span class="op">=</span> <span class="fl">1.0e-6</span>   <span class="co"># in m</span></a>
<a class="sourceLine" id="cb87-24" title="24"></a>
<a class="sourceLine" id="cb87-25" title="25"></a>
<a class="sourceLine" id="cb87-26" title="26"><span class="co"># spectral radiance</span></a>
<a class="sourceLine" id="cb87-27" title="27">B <span class="op">=</span> (<span class="dv">2</span><span class="op">*</span>h<span class="op">*</span>c<span class="op">**</span><span class="dv">2</span><span class="op">/</span>lamb_val<span class="op">**</span><span class="dv">5</span>) <span class="op">*</span> (<span class="dv">1</span><span class="op">/</span>(np.exp(h<span class="op">*</span>c<span class="op">/</span>(lamb_val<span class="op">*</span>k<span class="op">*</span>T)) <span class="op">-</span> <span class="dv">1</span>))</a>
<a class="sourceLine" id="cb87-28" title="28"><span class="bu">print</span>(<span class="st">&quot;spectral radiance =&quot;</span>, B)</a>
<a class="sourceLine" id="cb87-29" title="29"></a>
<a class="sourceLine" id="cb87-30" title="30">B_codex <span class="op">=</span> bb_radiation(lamb_val, T)</a>
<a class="sourceLine" id="cb87-31" title="31"><span class="bu">print</span>(<span class="st">&quot;spectral radiance from codex =&quot;</span>, B_codex)</a>
<a class="sourceLine" id="cb87-32" title="32"></a>
<a class="sourceLine" id="cb87-33" title="33"></a>
<a class="sourceLine" id="cb87-34" title="34"><span class="co"># check</span></a>
<a class="sourceLine" id="cb87-35" title="35"><span class="cf">if</span> <span class="bu">abs</span>((B <span class="op">-</span> B_codex) <span class="op">/</span> B) <span class="op">&lt;=</span> <span class="fl">1e-2</span>:</a>
<a class="sourceLine" id="cb87-36" title="36">    result <span class="op">=</span> <span class="va">True</span></a>
<a class="sourceLine" id="cb87-37" title="37"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb87-38" title="38">    result <span class="op">=</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>blast</summary></p>
<h4 id="query-8">Query</h4>
<div class="sourceCode" id="cb89"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb89-1" title="1"><span class="im">import</span> requests</a>
<a class="sourceLine" id="cb89-2" title="2"><span class="im">from</span> bs4 <span class="im">import</span> BeautifulSoup</a>
<a class="sourceLine" id="cb89-3" title="3"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb89-4" title="4"></a>
<a class="sourceLine" id="cb89-5" title="5"><span class="kw">def</span> blast(seq):</a>
<a class="sourceLine" id="cb89-6" title="6">    <span class="co">&#39;&#39;&#39;</span></a>
<a class="sourceLine" id="cb89-7" title="7"><span class="co">    Returns MSA with a BLAST search. Uses beautiful soup</span></a>
<a class="sourceLine" id="cb89-8" title="8"><span class="co">    to parse result.</span></a>
<a class="sourceLine" id="cb89-9" title="9"></a>
<a class="sourceLine" id="cb89-10" title="10"><span class="co">    1. import packages</span></a>
<a class="sourceLine" id="cb89-11" title="11"><span class="co">    2. Submit BLAST search with sequences</span></a>
<a class="sourceLine" id="cb89-12" title="12"><span class="co">    3. Get result</span></a>
<a class="sourceLine" id="cb89-13" title="13"><span class="co">    4. Parse MSA</span></a>
<a class="sourceLine" id="cb89-14" title="14"><span class="co">    5. Return a tuple of e score, id of top match</span></a>
<a class="sourceLine" id="cb89-15" title="15"><span class="co">    &#39;&#39;&#39;</span></a>
<a class="sourceLine" id="cb89-16" title="16">    [insert]</a>
<a class="sourceLine" id="cb89-17" title="17">    <span class="cf">return</span> e, <span class="bu">id</span></a></code></pre></div>
<h4 id="run-0-8">Run 0</h4>
<div class="sourceCode" id="cb90"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb90-1" title="1"><span class="im">import</span> requests</a>
<a class="sourceLine" id="cb90-2" title="2"><span class="im">from</span> bs4 <span class="im">import</span> BeautifulSoup</a>
<a class="sourceLine" id="cb90-3" title="3"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb90-4" title="4"></a>
<a class="sourceLine" id="cb90-5" title="5"><span class="kw">def</span> blast(seq):</a>
<a class="sourceLine" id="cb90-6" title="6">    <span class="co">&#39;&#39;&#39;</span></a>
<a class="sourceLine" id="cb90-7" title="7"><span class="co">    Returns MSA with a BLAST search. Uses beautiful soup</span></a>
<a class="sourceLine" id="cb90-8" title="8"><span class="co">    to parse result.</span></a>
<a class="sourceLine" id="cb90-9" title="9"></a>
<a class="sourceLine" id="cb90-10" title="10"><span class="co">    1. import packages</span></a>
<a class="sourceLine" id="cb90-11" title="11"><span class="co">    2. Submit BLAST search with sequences</span></a>
<a class="sourceLine" id="cb90-12" title="12"><span class="co">    3. Get result</span></a>
<a class="sourceLine" id="cb90-13" title="13"><span class="co">    4. Parse MSA</span></a>
<a class="sourceLine" id="cb90-14" title="14"><span class="co">    5. Return a tuple of e score, id of top match</span></a>
<a class="sourceLine" id="cb90-15" title="15"><span class="co">    &#39;&#39;&#39;</span></a>
<a class="sourceLine" id="cb90-16" title="16">    <span class="co"># 1. import packages</span></a>
<a class="sourceLine" id="cb90-17" title="17">    <span class="im">import</span> requests</a>
<a class="sourceLine" id="cb90-18" title="18">    <span class="im">from</span> bs4 <span class="im">import</span> BeautifulSoup</a>
<a class="sourceLine" id="cb90-19" title="19">    <span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb90-20" title="20"></a>
<a class="sourceLine" id="cb90-21" title="21">    <span class="co"># 2. Submit BLAST search with sequences</span></a>
<a class="sourceLine" id="cb90-22" title="22">    url <span class="op">=</span> <span class="st">&#39;https://blast.ncbi.nlm.nih.gov/Blast.cgi&#39;</span></a>
<a class="sourceLine" id="cb90-23" title="23">    params <span class="op">=</span> {<span class="st">&#39;QUERY&#39;</span>: seq,</a>
<a class="sourceLine" id="cb90-24" title="24">              <span class="st">&#39;DATABASE&#39;</span>: <span class="st">&#39;nr&#39;</span>,</a>
<a class="sourceLine" id="cb90-25" title="25">              <span class="st">&#39;PROGRAM&#39;</span>: <span class="st">&#39;blastp&#39;</span>,</a>
<a class="sourceLine" id="cb90-26" title="26">              <span class="st">&#39;CMD&#39;</span>: <span class="st">&#39;Put&#39;</span>,</a>
<a class="sourceLine" id="cb90-27" title="27">              <span class="st">&#39;PAGE&#39;</span>: <span class="st">&#39;Nucleotides&#39;</span>}</a>
<a class="sourceLine" id="cb90-28" title="28">    r <span class="op">=</span> requests.post(url, data<span class="op">=</span>params)</a>
<a class="sourceLine" id="cb90-29" title="29"></a>
<a class="sourceLine" id="cb90-30" title="30">    <span class="co"># 3. Get result</span></a>
<a class="sourceLine" id="cb90-31" title="31">    soup <span class="op">=</span> BeautifulSoup(r.text, <span class="st">&#39;html.parser&#39;</span>)</a>
<a class="sourceLine" id="cb90-32" title="32">    result <span class="op">=</span> soup.find(<span class="st">&#39;pre&#39;</span>).text</a>
<a class="sourceLine" id="cb90-33" title="33"></a>
<a class="sourceLine" id="cb90-34" title="34">    <span class="co"># 4. Parse MSA</span></a>
<a class="sourceLine" id="cb90-35" title="35">    lines <span class="op">=</span> result.split(<span class="st">&#39;</span><span class="ch">\n</span><span class="st">&#39;</span>)</a>
<a class="sourceLine" id="cb90-36" title="36">    msa <span class="op">=</span> []</a>
<a class="sourceLine" id="cb90-37" title="37">    <span class="cf">for</span> line <span class="kw">in</span> lines:</a>
<a class="sourceLine" id="cb90-38" title="38">        <span class="cf">if</span> line.startswith(<span class="st">&#39;&gt;&#39;</span>):</a>
<a class="sourceLine" id="cb90-39" title="39">            msa.append(line)</a>
<a class="sourceLine" id="cb90-40" title="40">    msa <span class="op">=</span> np.array(msa)</a>
<a class="sourceLine" id="cb90-41" title="41"></a>
<a class="sourceLine" id="cb90-42" title="42">    <span class="co"># 5. Return a tuple of e score, id of top match</span></a>
<a class="sourceLine" id="cb90-43" title="43">    e <span class="op">=</span> <span class="bu">float</span>(msa[<span class="dv">0</span>].split(<span class="st">&#39; &#39;</span>)[<span class="op">-</span><span class="dv">1</span>])</a>
<a class="sourceLine" id="cb90-44" title="44">    <span class="bu">id</span> <span class="op">=</span> msa[<span class="dv">0</span>].split(<span class="st">&#39; &#39;</span>)[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb90-45" title="45">    <span class="cf">return</span> e, <span class="bu">id</span></a>
<a class="sourceLine" id="cb90-46" title="46">e, <span class="bu">id</span> <span class="op">=</span> blast(<span class="st">&#39;&gt;seq1</span><span class="ch">\n</span><span class="st">&#39;</span></a>
<a class="sourceLine" id="cb90-47" title="47">              <span class="st">&#39;PNFYVPFSNATGVVRSPFEYPQYYLAEPWQFSMLAAYMFLLIVLGFPINFLTLYVTVQ&#39;</span>)</a>
<a class="sourceLine" id="cb90-48" title="48">result <span class="op">=</span> <span class="bu">float</span>(e) <span class="op">&lt;</span> <span class="fl">1e-30</span></a></code></pre></div>
<p>Output:</p>
<pre><code>&#39;NoneType&#39; object has no attribute &#39;text&#39;</code></pre>
<h4 id="run-1-8">Run 1</h4>
<div class="sourceCode" id="cb92"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb92-1" title="1"><span class="im">import</span> requests</a>
<a class="sourceLine" id="cb92-2" title="2"><span class="im">from</span> bs4 <span class="im">import</span> BeautifulSoup</a>
<a class="sourceLine" id="cb92-3" title="3"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb92-4" title="4"></a>
<a class="sourceLine" id="cb92-5" title="5"><span class="kw">def</span> blast(seq):</a>
<a class="sourceLine" id="cb92-6" title="6">    <span class="co">&#39;&#39;&#39;</span></a>
<a class="sourceLine" id="cb92-7" title="7"><span class="co">    Returns MSA with a BLAST search. Uses beautiful soup</span></a>
<a class="sourceLine" id="cb92-8" title="8"><span class="co">    to parse result.</span></a>
<a class="sourceLine" id="cb92-9" title="9"></a>
<a class="sourceLine" id="cb92-10" title="10"><span class="co">    1. import packages</span></a>
<a class="sourceLine" id="cb92-11" title="11"><span class="co">    2. Submit BLAST search with sequences</span></a>
<a class="sourceLine" id="cb92-12" title="12"><span class="co">    3. Get result</span></a>
<a class="sourceLine" id="cb92-13" title="13"><span class="co">    4. Parse MSA</span></a>
<a class="sourceLine" id="cb92-14" title="14"><span class="co">    5. Return a tuple of e score, id of top match</span></a>
<a class="sourceLine" id="cb92-15" title="15"><span class="co">    &#39;&#39;&#39;</span></a>
<a class="sourceLine" id="cb92-16" title="16">    <span class="co"># 1. import packages</span></a>
<a class="sourceLine" id="cb92-17" title="17">    <span class="im">import</span> requests</a>
<a class="sourceLine" id="cb92-18" title="18">    <span class="im">from</span> bs4 <span class="im">import</span> BeautifulSoup</a>
<a class="sourceLine" id="cb92-19" title="19"></a>
<a class="sourceLine" id="cb92-20" title="20">    <span class="co"># 2. Submit BLAST search with sequences</span></a>
<a class="sourceLine" id="cb92-21" title="21">    url <span class="op">=</span> <span class="st">&#39;https://blast.ncbi.nlm.nih.gov/Blast.cgi&#39;</span></a>
<a class="sourceLine" id="cb92-22" title="22">    params <span class="op">=</span> {<span class="st">&#39;QUERY&#39;</span>: seq, <span class="st">&#39;PROGRAM&#39;</span>: <span class="st">&#39;blastn&#39;</span>, <span class="st">&#39;DATABASE&#39;</span>: <span class="st">&#39;nr&#39;</span>, <span class="st">&#39;CMD&#39;</span>: <span class="st">&#39;Put&#39;</span>}</a>
<a class="sourceLine" id="cb92-23" title="23">    r <span class="op">=</span> requests.get(url, params<span class="op">=</span>params)</a>
<a class="sourceLine" id="cb92-24" title="24"></a>
<a class="sourceLine" id="cb92-25" title="25">    <span class="co"># 3. Get result</span></a>
<a class="sourceLine" id="cb92-26" title="26">    soup <span class="op">=</span> BeautifulSoup(r.text, <span class="st">&#39;html.parser&#39;</span>)</a>
<a class="sourceLine" id="cb92-27" title="27">    result <span class="op">=</span> soup.find(<span class="st">&#39;pre&#39;</span>).text</a>
<a class="sourceLine" id="cb92-28" title="28"></a>
<a class="sourceLine" id="cb92-29" title="29">    <span class="co"># 4. Parse MSA</span></a>
<a class="sourceLine" id="cb92-30" title="30">    result <span class="op">=</span> result.split(<span class="st">&#39;</span><span class="ch">\n</span><span class="st">&#39;</span>)</a>
<a class="sourceLine" id="cb92-31" title="31">    result <span class="op">=</span> [i <span class="cf">for</span> i <span class="kw">in</span> result <span class="cf">if</span> i.startswith(<span class="st">&#39;&gt;&#39;</span>)]</a>
<a class="sourceLine" id="cb92-32" title="32">    result <span class="op">=</span> [i.split(<span class="st">&#39;|&#39;</span>)[<span class="dv">3</span>] <span class="cf">for</span> i <span class="kw">in</span> result]</a>
<a class="sourceLine" id="cb92-33" title="33">    result <span class="op">=</span> [i.split(<span class="st">&#39; &#39;</span>)[<span class="dv">0</span>] <span class="cf">for</span> i <span class="kw">in</span> result]</a>
<a class="sourceLine" id="cb92-34" title="34"></a>
<a class="sourceLine" id="cb92-35" title="35">    <span class="co"># 5. Return a tuple of e score, id of top match</span></a>
<a class="sourceLine" id="cb92-36" title="36">    e <span class="op">=</span> <span class="bu">float</span>(soup.find(<span class="st">&#39;td&#39;</span>, text<span class="op">=</span><span class="st">&#39;Expect&#39;</span>).find_next_sibling(<span class="st">&#39;td&#39;</span>).text)</a>
<a class="sourceLine" id="cb92-37" title="37">    <span class="bu">id</span> <span class="op">=</span> result[<span class="dv">0</span>]</a>
<a class="sourceLine" id="cb92-38" title="38">    <span class="cf">return</span> e, <span class="bu">id</span></a>
<a class="sourceLine" id="cb92-39" title="39">e, <span class="bu">id</span> <span class="op">=</span> blast(<span class="st">&#39;&gt;seq1</span><span class="ch">\n</span><span class="st">&#39;</span></a>
<a class="sourceLine" id="cb92-40" title="40">              <span class="st">&#39;PNFYVPFSNATGVVRSPFEYPQYYLAEPWQFSMLAAYMFLLIVLGFPINFLTLYVTVQ&#39;</span>)</a>
<a class="sourceLine" id="cb92-41" title="41">result <span class="op">=</span> <span class="bu">float</span>(e) <span class="op">&lt;</span> <span class="fl">1e-30</span></a></code></pre></div>
<p>Output:</p>
<pre><code>&#39;NoneType&#39; object has no attribute &#39;text&#39;</code></pre>
<h4 id="run-2-8">Run 2</h4>
<div class="sourceCode" id="cb94"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb94-1" title="1"><span class="im">import</span> requests</a>
<a class="sourceLine" id="cb94-2" title="2"><span class="im">from</span> bs4 <span class="im">import</span> BeautifulSoup</a>
<a class="sourceLine" id="cb94-3" title="3"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb94-4" title="4"></a>
<a class="sourceLine" id="cb94-5" title="5"><span class="kw">def</span> blast(seq):</a>
<a class="sourceLine" id="cb94-6" title="6">    <span class="co">&#39;&#39;&#39;</span></a>
<a class="sourceLine" id="cb94-7" title="7"><span class="co">    Returns MSA with a BLAST search. Uses beautiful soup</span></a>
<a class="sourceLine" id="cb94-8" title="8"><span class="co">    to parse result.</span></a>
<a class="sourceLine" id="cb94-9" title="9"></a>
<a class="sourceLine" id="cb94-10" title="10"><span class="co">    1. import packages</span></a>
<a class="sourceLine" id="cb94-11" title="11"><span class="co">    2. Submit BLAST search with sequences</span></a>
<a class="sourceLine" id="cb94-12" title="12"><span class="co">    3. Get result</span></a>
<a class="sourceLine" id="cb94-13" title="13"><span class="co">    4. Parse MSA</span></a>
<a class="sourceLine" id="cb94-14" title="14"><span class="co">    5. Return a tuple of e score, id of top match</span></a>
<a class="sourceLine" id="cb94-15" title="15"><span class="co">    &#39;&#39;&#39;</span></a>
<a class="sourceLine" id="cb94-16" title="16">    <span class="co"># 1.</span></a>
<a class="sourceLine" id="cb94-17" title="17">    <span class="im">from</span> Bio.Blast <span class="im">import</span> NCBIWWW</a>
<a class="sourceLine" id="cb94-18" title="18">    <span class="im">from</span> Bio <span class="im">import</span> SeqIO</a>
<a class="sourceLine" id="cb94-19" title="19">    <span class="im">from</span> Bio.Seq <span class="im">import</span> Seq</a>
<a class="sourceLine" id="cb94-20" title="20">    <span class="im">from</span> Bio.Alphabet <span class="im">import</span> IUPAC</a>
<a class="sourceLine" id="cb94-21" title="21">    <span class="im">from</span> Bio.Blast <span class="im">import</span> NCBIXML</a>
<a class="sourceLine" id="cb94-22" title="22">    <span class="im">import</span> pandas <span class="im">as</span> pd</a>
<a class="sourceLine" id="cb94-23" title="23">    <span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb94-24" title="24">    <span class="im">import</span> re</a>
<a class="sourceLine" id="cb94-25" title="25">    <span class="im">import</span> requests</a>
<a class="sourceLine" id="cb94-26" title="26">    <span class="im">from</span> bs4 <span class="im">import</span> BeautifulSoup</a>
<a class="sourceLine" id="cb94-27" title="27">    <span class="im">import</span> time</a>
<a class="sourceLine" id="cb94-28" title="28"></a>
<a class="sourceLine" id="cb94-29" title="29">    <span class="co"># 2.</span></a>
<a class="sourceLine" id="cb94-30" title="30">    result_handle <span class="op">=</span> NCBIWWW.qblast(<span class="st">&quot;blastn&quot;</span>, <span class="st">&quot;nt&quot;</span>, seq)</a>
<a class="sourceLine" id="cb94-31" title="31"></a>
<a class="sourceLine" id="cb94-32" title="32">    <span class="co"># 3.</span></a>
<a class="sourceLine" id="cb94-33" title="33">    blast_records <span class="op">=</span> NCBIXML.parse(result_handle)</a>
<a class="sourceLine" id="cb94-34" title="34"></a>
<a class="sourceLine" id="cb94-35" title="35">    <span class="co"># 4.</span></a>
<a class="sourceLine" id="cb94-36" title="36">    e_scores <span class="op">=</span> []</a>
<a class="sourceLine" id="cb94-37" title="37">    ids <span class="op">=</span> []</a>
<a class="sourceLine" id="cb94-38" title="38">    <span class="cf">for</span> blast_record <span class="kw">in</span> blast_records:</a>
<a class="sourceLine" id="cb94-39" title="39">        <span class="cf">for</span> alignment <span class="kw">in</span> blast_record.alignments:</a>
<a class="sourceLine" id="cb94-40" title="40">            <span class="cf">for</span> hsp <span class="kw">in</span> alignment.hsps:</a>
<a class="sourceLine" id="cb94-41" title="41">                e_scores.append(hsp.expect)</a>
<a class="sourceLine" id="cb94-42" title="42">                ids.append(alignment.title)</a>
<a class="sourceLine" id="cb94-43" title="43"></a>
<a class="sourceLine" id="cb94-44" title="44">    <span class="co"># 5.</span></a>
<a class="sourceLine" id="cb94-45" title="45">    e <span class="op">=</span> e_scores[<span class="dv">0</span>]</a>
<a class="sourceLine" id="cb94-46" title="46">    <span class="bu">id</span> <span class="op">=</span> ids[<span class="dv">0</span>]</a>
<a class="sourceLine" id="cb94-47" title="47"></a>
<a class="sourceLine" id="cb94-48" title="48">    <span class="cf">return</span> e, <span class="bu">id</span></a>
<a class="sourceLine" id="cb94-49" title="49">e, <span class="bu">id</span> <span class="op">=</span> blast(<span class="st">&#39;&gt;seq1</span><span class="ch">\n</span><span class="st">&#39;</span></a>
<a class="sourceLine" id="cb94-50" title="50">              <span class="st">&#39;PNFYVPFSNATGVVRSPFEYPQYYLAEPWQFSMLAAYMFLLIVLGFPINFLTLYVTVQ&#39;</span>)</a>
<a class="sourceLine" id="cb94-51" title="51">result <span class="op">=</span> <span class="bu">float</span>(e) <span class="op">&lt;</span> <span class="fl">1e-30</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Error message from NCBI: Message ID#24 Error: Failed to read the Blast query: Protein FASTA provided for nucleotide sequence</code></pre>
<h4 id="run-3-8">Run 3</h4>
<div class="sourceCode" id="cb96"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb96-1" title="1"><span class="im">import</span> requests</a>
<a class="sourceLine" id="cb96-2" title="2"><span class="im">from</span> bs4 <span class="im">import</span> BeautifulSoup</a>
<a class="sourceLine" id="cb96-3" title="3"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb96-4" title="4"></a>
<a class="sourceLine" id="cb96-5" title="5"><span class="kw">def</span> blast(seq):</a>
<a class="sourceLine" id="cb96-6" title="6">    <span class="co">&#39;&#39;&#39;</span></a>
<a class="sourceLine" id="cb96-7" title="7"><span class="co">    Returns MSA with a BLAST search. Uses beautiful soup</span></a>
<a class="sourceLine" id="cb96-8" title="8"><span class="co">    to parse result.</span></a>
<a class="sourceLine" id="cb96-9" title="9"></a>
<a class="sourceLine" id="cb96-10" title="10"><span class="co">    1. import packages</span></a>
<a class="sourceLine" id="cb96-11" title="11"><span class="co">    2. Submit BLAST search with sequences</span></a>
<a class="sourceLine" id="cb96-12" title="12"><span class="co">    3. Get result</span></a>
<a class="sourceLine" id="cb96-13" title="13"><span class="co">    4. Parse MSA</span></a>
<a class="sourceLine" id="cb96-14" title="14"><span class="co">    5. Return a tuple of e score, id of top match</span></a>
<a class="sourceLine" id="cb96-15" title="15"><span class="co">    &#39;&#39;&#39;</span></a>
<a class="sourceLine" id="cb96-16" title="16">    <span class="co"># 1.</span></a>
<a class="sourceLine" id="cb96-17" title="17">    <span class="im">import</span> requests</a>
<a class="sourceLine" id="cb96-18" title="18">    <span class="im">from</span> bs4 <span class="im">import</span> BeautifulSoup</a>
<a class="sourceLine" id="cb96-19" title="19">    <span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb96-20" title="20"></a>
<a class="sourceLine" id="cb96-21" title="21">    <span class="co"># 2.</span></a>
<a class="sourceLine" id="cb96-22" title="22">    url <span class="op">=</span> <span class="st">&#39;https://blast.ncbi.nlm.nih.gov/Blast.cgi&#39;</span></a>
<a class="sourceLine" id="cb96-23" title="23">    params <span class="op">=</span> {<span class="st">&#39;QUERY&#39;</span>: seq,</a>
<a class="sourceLine" id="cb96-24" title="24">              <span class="st">&#39;DATABASE&#39;</span>: <span class="st">&#39;nr&#39;</span>,</a>
<a class="sourceLine" id="cb96-25" title="25">              <span class="st">&#39;PROGRAM&#39;</span>: <span class="st">&#39;blastp&#39;</span>,</a>
<a class="sourceLine" id="cb96-26" title="26">              <span class="st">&#39;CMD&#39;</span>: <span class="st">&#39;Put&#39;</span>}</a>
<a class="sourceLine" id="cb96-27" title="27">    r <span class="op">=</span> requests.get(url, params<span class="op">=</span>params)</a>
<a class="sourceLine" id="cb96-28" title="28"></a>
<a class="sourceLine" id="cb96-29" title="29">    <span class="co"># 3.</span></a>
<a class="sourceLine" id="cb96-30" title="30">    soup <span class="op">=</span> BeautifulSoup(r.text, <span class="st">&#39;html.parser&#39;</span>)</a>
<a class="sourceLine" id="cb96-31" title="31">    result <span class="op">=</span> soup.find(<span class="st">&#39;pre&#39;</span>)</a>
<a class="sourceLine" id="cb96-32" title="32"></a>
<a class="sourceLine" id="cb96-33" title="33">    <span class="co"># 4.</span></a>
<a class="sourceLine" id="cb96-34" title="34">    msa <span class="op">=</span> result.text.split(<span class="st">&#39;</span><span class="ch">\n</span><span class="st">&#39;</span>)</a>
<a class="sourceLine" id="cb96-35" title="35">    msa <span class="op">=</span> [i <span class="cf">for</span> i <span class="kw">in</span> msa <span class="cf">if</span> i <span class="op">!=</span> <span class="st">&#39;&#39;</span>]</a>
<a class="sourceLine" id="cb96-36" title="36">    msa <span class="op">=</span> [i <span class="cf">for</span> i <span class="kw">in</span> msa <span class="cf">if</span> i[<span class="dv">0</span>] <span class="op">!=</span> <span class="st">&#39;&gt;&#39;</span>]</a>
<a class="sourceLine" id="cb96-37" title="37">    msa <span class="op">=</span> [i <span class="cf">for</span> i <span class="kw">in</span> msa <span class="cf">if</span> i[<span class="dv">0</span>] <span class="op">!=</span> <span class="st">&#39; &#39;</span>]</a>
<a class="sourceLine" id="cb96-38" title="38">    msa <span class="op">=</span> [i <span class="cf">for</span> i <span class="kw">in</span> msa <span class="cf">if</span> i[<span class="dv">0</span>] <span class="op">!=</span> <span class="st">&#39;#&#39;</span>]</a>
<a class="sourceLine" id="cb96-39" title="39">    msa <span class="op">=</span> [i <span class="cf">for</span> i <span class="kw">in</span> msa <span class="cf">if</span> i[<span class="dv">0</span>] <span class="op">!=</span> <span class="st">&#39;</span><span class="ch">\n</span><span class="st">&#39;</span>]</a>
<a class="sourceLine" id="cb96-40" title="40">    msa <span class="op">=</span> [i <span class="cf">for</span> i <span class="kw">in</span> msa <span class="cf">if</span> i[<span class="dv">0</span>] <span class="op">!=</span> <span class="st">&#39;</span><span class="ch">\r</span><span class="st">&#39;</span>]</a>
<a class="sourceLine" id="cb96-41" title="41">    msa <span class="op">=</span> [i <span class="cf">for</span> i <span class="kw">in</span> msa <span class="cf">if</span> i[<span class="dv">0</span>] <span class="op">!=</span> <span class="st">&#39;</span><span class="ch">\t</span><span class="st">&#39;</span>]</a>
<a class="sourceLine" id="cb96-42" title="42">    msa <span class="op">=</span> [i <span class="cf">for</span> i <span class="kw">in</span> msa <span class="cf">if</span> i[<span class="dv">0</span>] <span class="op">!=</span> <span class="st">&#39;</span><span class="ch">\v</span><span class="st">&#39;</span>]</a>
<a class="sourceLine" id="cb96-43" title="43">    msa <span class="op">=</span> [i <span class="cf">for</span> i <span class="kw">in</span> msa <span class="cf">if</span> i[<span class="dv">0</span>] <span class="op">!=</span> <span class="st">&#39;</span><span class="ch">\f</span><span class="st">&#39;</span>]</a>
<a class="sourceLine" id="cb96-44" title="44">    msa <span class="op">=</span> [i <span class="cf">for</span> i <span class="kw">in</span> msa <span class="cf">if</span> i[<span class="dv">0</span>] <span class="op">!=</span> <span class="st">&#39;</span><span class="ch">\a</span><span class="st">&#39;</span>]</a>
<a class="sourceLine" id="cb96-45" title="45">    msa <span class="op">=</span> [i <span class="cf">for</span> i <span class="kw">in</span> msa <span class="cf">if</span> i[<span class="dv">0</span>] <span class="op">!=</span> <span class="st">&#39;</span><span class="ch">\b</span><span class="st">&#39;</span>]</a>
<a class="sourceLine" id="cb96-46" title="46">    msa <span class="op">=</span> [i <span class="cf">for</span> i <span class="kw">in</span> msa <span class="cf">if</span> i[<span class="dv">0</span>] <span class="op">!=</span> <span class="st">&#39;</span><span class="ch">\0</span><span class="st">&#39;</span>]</a>
<a class="sourceLine" id="cb96-47" title="47">    msa <span class="op">=</span> [i <span class="cf">for</span> i <span class="kw">in</span> msa <span class="cf">if</span> i[<span class="dv">0</span>] <span class="op">!=</span> <span class="st">&#39;</span><span class="ch">\x0b</span><span class="st">&#39;</span>]</a>
<a class="sourceLine" id="cb96-48" title="48">    msa <span class="op">=</span> [i <span class="cf">for</span> i <span class="kw">in</span> msa <span class="cf">if</span> i[<span class="dv">0</span>] <span class="op">!=</span> <span class="st">&#39;</span><span class="ch">\x1a</span><span class="st">&#39;</span>]</a>
<a class="sourceLine" id="cb96-49" title="49">    msa <span class="op">=</span> [i <span class="cf">for</span> i <span class="kw">in</span> msa <span class="cf">if</span> i[<span class="dv">0</span>] <span class="op">!=</span> <span class="st">&#39;</span><span class="ch">\x0c</span><span class="st">&#39;</span>]</a>
<a class="sourceLine" id="cb96-50" title="50">    msa <span class="op">=</span> [i <span class="cf">for</span> i <span class="kw">in</span> msa <span class="cf">if</span> i[<span class="dv">0</span>] <span class="op">!=</span> <span class="st">&#39;</span><span class="ch">\x1c</span><span class="st">&#39;</span>]</a>
<a class="sourceLine" id="cb96-51" title="51">    msa <span class="op">=</span> [i <span class="cf">for</span> i <span class="kw">in</span> msa <span class="cf">if</span> i[<span class="dv">0</span>] <span class="op">!=</span> <span class="st">&#39;</span><span class="ch">\x1d</span><span class="st">&#39;</span>]</a>
<a class="sourceLine" id="cb96-52" title="52">    msa <span class="op">=</span> [i <span class="cf">for</span> i <span class="kw">in</span> msa <span class="cf">if</span> i[<span class="dv">0</span>] <span class="op">!=</span> <span class="st">&#39;</span><span class="ch">\x1e</span><span class="st">&#39;</span>]</a>
<a class="sourceLine" id="cb96-53" title="53">    msa <span class="op">=</span> [i <span class="cf">for</span> i <span class="kw">in</span> msa <span class="cf">if</span> i[<span class="dv">0</span>] <span class="op">!=</span> <span class="st">&#39;</span><span class="ch">\x85</span><span class="st">&#39;</span>]</a>
<a class="sourceLine" id="cb96-54" title="54">    msa <span class="op">=</span> [i <span class="cf">for</span> i <span class="kw">in</span> msa <span class="cf">if</span> i[<span class="dv">0</span>] <span class="op">!=</span> <span class="st">&#39;</span><span class="ch">\x1f</span><span class="st">&#39;</span>]</a>
<a class="sourceLine" id="cb96-55" title="55">    msa <span class="op">=</span> [i <span class="cf">for</span> i <span class="kw">in</span> msa <span class="cf">if</span> i[<span class="dv">0</span>] <span class="op">!=</span> <span class="st">&#39;</span><span class="ch">\x7f</span><span class="st">&#39;</span>]</a>
<a class="sourceLine" id="cb96-56" title="56">    msa <span class="op">=</span> [i <span class="cf">for</span> i <span class="kw">in</span> msa <span class="cf">if</span> i[<span class="dv">0</span>] <span class="op">!=</span> <span class="st">&#39;</span><span class="ch">\x9c</span><span class="st">&#39;</span>]</a>
<a class="sourceLine" id="cb96-57" title="57">    msa <span class="op">=</span> [i <span class="cf">for</span> i <span class="kw">in</span> msa <span class="cf">if</span> i[<span class="dv">0</span>] <span class="op">!=</span> <span class="st">&#39;</span><span class="ch">\x9d</span><span class="st">&#39;</span>]</a>
<a class="sourceLine" id="cb96-58" title="58">    msa <span class="op">=</span> [i <span class="cf">for</span> i <span class="kw">in</span> msa <span class="cf">if</span> i[<span class="dv">0</span>] <span class="op">!=</span> <span class="st">&#39;</span><span class="ch">\x9e</span><span class="st">&#39;</span>]</a>
<a class="sourceLine" id="cb96-59" title="59">    msa <span class="op">=</span> [i <span class="cf">for</span> i <span class="kw">in</span> msa <span class="cf">if</span> i[<span class="dv">0</span>] <span class="op">!=</span> <span class="st">&#39;</span><span class="ch">\x9f</span><span class="st">&#39;</span>]</a>
<a class="sourceLine" id="cb96-60" title="60">    msa <span class="op">=</span> [i <span class="cf">for</span> i <span class="kw">in</span> msa <span class="cf">if</span> i[<span class="dv">0</span>] <span class="op">!=</span> <span class="st">&#39;</span><span class="ch">\xad</span><span class="st">&#39;</span>]</a>
<a class="sourceLine" id="cb96-61" title="61">    msa <span class="op">=</span> [i <span class="cf">for</span> i <span class="kw">in</span> msa <span class="cf">if</span> i[<span class="dv">0</span>] <span class="op">!=</span> <span class="st">&#39;</span><span class="ch">\xae</span><span class="st">&#39;</span>]</a>
<a class="sourceLine" id="cb96-62" title="62">    msa <span class="op">=</span> [i <span class="cf">for</span> i <span class="kw">in</span> msa <span class="cf">if</span> i[<span class="dv">0</span>] <span class="op">!=</span> <span class="st">&#39;</span><span class="ch">\xaf</span><span class="st">&#39;</span>]</a>
<a class="sourceLine" id="cb96-63" title="63">    msa <span class="op">=</span> [i <span class="cf">for</span> i <span class="kw">in</span> msa <span class="cf">if</span> i[<span class="dv">0</span>] <span class="op">!=</span> <span class="st">&#39;</span><span class="ch">\xef</span><span class="st">&#39;</span>]</a>
<a class="sourceLine" id="cb96-64" title="64">    msa <span class="op">=</span> [i <span class="cf">for</span> i <span class="kw">in</span> msa <span class="cf">if</span> i[<span class="dv">0</span>] <span class="op">!=</span> <span class="st">&#39;</span><span class="ch">\xbb</span><span class="st">&#39;</span>]</a>
<a class="sourceLine" id="cb96-65" title="65">    msa <span class="op">=</span> [i <span class="cf">for</span> i <span class="kw">in</span> msa <span class="cf">if</span> i[<span class="dv">0</span>] <span class="op">!=</span> <span class="st">&#39;</span><span class="ch">\xbf</span><span class="st">&#39;</span>]</a>
<a class="sourceLine" id="cb96-66" title="66">    msa <span class="op">=</span> [i <span class="cf">for</span> i <span class="kw">in</span> msa <span class="cf">if</span> i[<span class="dv">0</span>] <span class="op">!=</span> <span class="st">&#39;</span><span class="ch">\x80</span><span class="st">&#39;</span>]</a>
<a class="sourceLine" id="cb96-67" title="67">    msa <span class="op">=</span> [</a>
<a class="sourceLine" id="cb96-68" title="68">    <span class="cf">return</span> e, <span class="bu">id</span></a>
<a class="sourceLine" id="cb96-69" title="69">e, <span class="bu">id</span> <span class="op">=</span> blast(<span class="st">&#39;&gt;seq1</span><span class="ch">\n</span><span class="st">&#39;</span></a>
<a class="sourceLine" id="cb96-70" title="70">              <span class="st">&#39;PNFYVPFSNATGVVRSPFEYPQYYLAEPWQFSMLAAYMFLLIVLGFPINFLTLYVTVQ&#39;</span>)</a>
<a class="sourceLine" id="cb96-71" title="71">result <span class="op">=</span> <span class="bu">float</span>(e) <span class="op">&lt;</span> <span class="fl">1e-30</span></a></code></pre></div>
<p>Output:</p>
<pre><code>invalid syntax (&lt;string&gt;, line 69)</code></pre>
<h4 id="run-4-8">Run 4</h4>
<div class="sourceCode" id="cb98"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb98-1" title="1"><span class="im">import</span> requests</a>
<a class="sourceLine" id="cb98-2" title="2"><span class="im">from</span> bs4 <span class="im">import</span> BeautifulSoup</a>
<a class="sourceLine" id="cb98-3" title="3"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb98-4" title="4"></a>
<a class="sourceLine" id="cb98-5" title="5"><span class="kw">def</span> blast(seq):</a>
<a class="sourceLine" id="cb98-6" title="6">    <span class="co">&#39;&#39;&#39;</span></a>
<a class="sourceLine" id="cb98-7" title="7"><span class="co">    Returns MSA with a BLAST search. Uses beautiful soup</span></a>
<a class="sourceLine" id="cb98-8" title="8"><span class="co">    to parse result.</span></a>
<a class="sourceLine" id="cb98-9" title="9"></a>
<a class="sourceLine" id="cb98-10" title="10"><span class="co">    1. import packages</span></a>
<a class="sourceLine" id="cb98-11" title="11"><span class="co">    2. Submit BLAST search with sequences</span></a>
<a class="sourceLine" id="cb98-12" title="12"><span class="co">    3. Get result</span></a>
<a class="sourceLine" id="cb98-13" title="13"><span class="co">    4. Parse MSA</span></a>
<a class="sourceLine" id="cb98-14" title="14"><span class="co">    5. Return a tuple of e score, id of top match</span></a>
<a class="sourceLine" id="cb98-15" title="15"><span class="co">    &#39;&#39;&#39;</span></a>
<a class="sourceLine" id="cb98-16" title="16">    <span class="co"># 1.</span></a>
<a class="sourceLine" id="cb98-17" title="17">    <span class="im">import</span> requests</a>
<a class="sourceLine" id="cb98-18" title="18">    <span class="im">from</span> bs4 <span class="im">import</span> BeautifulSoup</a>
<a class="sourceLine" id="cb98-19" title="19">    <span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb98-20" title="20"></a>
<a class="sourceLine" id="cb98-21" title="21">    <span class="co"># 2.</span></a>
<a class="sourceLine" id="cb98-22" title="22">    url <span class="op">=</span> <span class="st">&#39;https://blast.ncbi.nlm.nih.gov/Blast.cgi&#39;</span></a>
<a class="sourceLine" id="cb98-23" title="23">    params <span class="op">=</span> {<span class="st">&#39;QUERY&#39;</span>: seq, <span class="st">&#39;DATABASE&#39;</span>: <span class="st">&#39;nr&#39;</span>, <span class="st">&#39;PROGRAM&#39;</span>: <span class="st">&#39;blastp&#39;</span>, <span class="st">&#39;CMD&#39;</span>: <span class="st">&#39;Put&#39;</span>}</a>
<a class="sourceLine" id="cb98-24" title="24">    r <span class="op">=</span> requests.post(url, data<span class="op">=</span>params)</a>
<a class="sourceLine" id="cb98-25" title="25"></a>
<a class="sourceLine" id="cb98-26" title="26">    <span class="co"># 3.</span></a>
<a class="sourceLine" id="cb98-27" title="27">    soup <span class="op">=</span> BeautifulSoup(r.text, <span class="st">&#39;html.parser&#39;</span>)</a>
<a class="sourceLine" id="cb98-28" title="28">    result <span class="op">=</span> soup.find(<span class="st">&#39;pre&#39;</span>).text</a>
<a class="sourceLine" id="cb98-29" title="29"></a>
<a class="sourceLine" id="cb98-30" title="30">    <span class="co"># 4.</span></a>
<a class="sourceLine" id="cb98-31" title="31">    lines <span class="op">=</span> result.split(<span class="st">&#39;</span><span class="ch">\n</span><span class="st">&#39;</span>)</a>
<a class="sourceLine" id="cb98-32" title="32">    lines <span class="op">=</span> [line <span class="cf">for</span> line <span class="kw">in</span> lines <span class="cf">if</span> line.startswith(<span class="st">&#39;&gt;&#39;</span>)]</a>
<a class="sourceLine" id="cb98-33" title="33">    lines <span class="op">=</span> [line.split(<span class="st">&#39;|&#39;</span>)[<span class="dv">3</span>] <span class="cf">for</span> line <span class="kw">in</span> lines]</a>
<a class="sourceLine" id="cb98-34" title="34">    lines <span class="op">=</span> [line.split(<span class="st">&#39; &#39;</span>)[<span class="dv">0</span>] <span class="cf">for</span> line <span class="kw">in</span> lines]</a>
<a class="sourceLine" id="cb98-35" title="35">    lines <span class="op">=</span> [line.split(<span class="st">&#39;</span><span class="ch">\t</span><span class="st">&#39;</span>)[<span class="dv">0</span>] <span class="cf">for</span> line <span class="kw">in</span> lines]</a>
<a class="sourceLine" id="cb98-36" title="36">    lines <span class="op">=</span> [line <span class="cf">for</span> line <span class="kw">in</span> lines <span class="cf">if</span> line <span class="op">!=</span> <span class="st">&#39;&#39;</span>]</a>
<a class="sourceLine" id="cb98-37" title="37"></a>
<a class="sourceLine" id="cb98-38" title="38">    <span class="co"># 5.</span></a>
<a class="sourceLine" id="cb98-39" title="39">    e <span class="op">=</span> <span class="bu">float</span>(lines[<span class="dv">0</span>].split(<span class="st">&#39;e&#39;</span>)[<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb98-40" title="40">    <span class="bu">id</span> <span class="op">=</span> lines[<span class="dv">0</span>].split(<span class="st">&#39;e&#39;</span>)[<span class="dv">0</span>]</a>
<a class="sourceLine" id="cb98-41" title="41"></a>
<a class="sourceLine" id="cb98-42" title="42">    <span class="cf">return</span> e, <span class="bu">id</span></a>
<a class="sourceLine" id="cb98-43" title="43">e, <span class="bu">id</span> <span class="op">=</span> blast(<span class="st">&#39;&gt;seq1</span><span class="ch">\n</span><span class="st">&#39;</span></a>
<a class="sourceLine" id="cb98-44" title="44">              <span class="st">&#39;PNFYVPFSNATGVVRSPFEYPQYYLAEPWQFSMLAAYMFLLIVLGFPINFLTLYVTVQ&#39;</span>)</a>
<a class="sourceLine" id="cb98-45" title="45">result <span class="op">=</span> <span class="bu">float</span>(e) <span class="op">&lt;</span> <span class="fl">1e-30</span></a></code></pre></div>
<p>Output:</p>
<pre><code>&#39;NoneType&#39; object has no attribute &#39;text&#39;</code></pre>
</details>
<details>
<p><summary>bravais</summary></p>
<h4 id="query-9">Query</h4>
<div class="sourceCode" id="cb100"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb100-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb100-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb100-3" title="3"></a>
<a class="sourceLine" id="cb100-4" title="4"></a>
<a class="sourceLine" id="cb100-5" title="5"><span class="kw">def</span> bravais_lattice(group_number):</a>
<a class="sourceLine" id="cb100-6" title="6">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb100-7" title="7"><span class="co">    Return bravais lattice name given space group number</span></a>
<a class="sourceLine" id="cb100-8" title="8"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb100-9" title="9">    [insert]</a>
<a class="sourceLine" id="cb100-10" title="10">    <span class="cf">return</span> name</a></code></pre></div>
<h4 id="run-0-9">Run 0</h4>
<div class="sourceCode" id="cb101"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb101-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb101-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb101-3" title="3"></a>
<a class="sourceLine" id="cb101-4" title="4"></a>
<a class="sourceLine" id="cb101-5" title="5"><span class="kw">def</span> bravais_lattice(group_number):</a>
<a class="sourceLine" id="cb101-6" title="6">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb101-7" title="7"><span class="co">    Return bravais lattice name given space group number</span></a>
<a class="sourceLine" id="cb101-8" title="8"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb101-9" title="9">    name <span class="op">=</span> <span class="st">&#39;&#39;</span></a>
<a class="sourceLine" id="cb101-10" title="10">    <span class="cf">if</span> group_number <span class="op">&lt;</span> <span class="dv">3</span>:</a>
<a class="sourceLine" id="cb101-11" title="11">        name <span class="op">=</span> <span class="st">&#39;triclinic&#39;</span></a>
<a class="sourceLine" id="cb101-12" title="12">    <span class="cf">elif</span> group_number <span class="op">&lt;</span> <span class="dv">16</span>:</a>
<a class="sourceLine" id="cb101-13" title="13">        name <span class="op">=</span> <span class="st">&#39;monoclinic&#39;</span></a>
<a class="sourceLine" id="cb101-14" title="14">    <span class="cf">elif</span> group_number <span class="op">&lt;</span> <span class="dv">75</span>:</a>
<a class="sourceLine" id="cb101-15" title="15">        name <span class="op">=</span> <span class="st">&#39;orthorhombic&#39;</span></a>
<a class="sourceLine" id="cb101-16" title="16">    <span class="cf">elif</span> group_number <span class="op">&lt;</span> <span class="dv">143</span>:</a>
<a class="sourceLine" id="cb101-17" title="17">        name <span class="op">=</span> <span class="st">&#39;tetragonal&#39;</span></a>
<a class="sourceLine" id="cb101-18" title="18">    <span class="cf">elif</span> group_number <span class="op">&lt;</span> <span class="dv">168</span>:</a>
<a class="sourceLine" id="cb101-19" title="19">        name <span class="op">=</span> <span class="st">&#39;trigonal&#39;</span></a>
<a class="sourceLine" id="cb101-20" title="20">    <span class="cf">elif</span> group_number <span class="op">&lt;</span> <span class="dv">195</span>:</a>
<a class="sourceLine" id="cb101-21" title="21">        name <span class="op">=</span> <span class="st">&#39;hexagonal&#39;</span></a>
<a class="sourceLine" id="cb101-22" title="22">    <span class="cf">elif</span> group_number <span class="op">&lt;</span> <span class="dv">231</span>:</a>
<a class="sourceLine" id="cb101-23" title="23">        name <span class="op">=</span> <span class="st">&#39;cubic&#39;</span></a>
<a class="sourceLine" id="cb101-24" title="24">    <span class="cf">else</span>:</a>
<a class="sourceLine" id="cb101-25" title="25">        name <span class="op">=</span> <span class="st">&#39;unknown&#39;</span></a>
<a class="sourceLine" id="cb101-26" title="26">    <span class="cf">return</span> name</a>
<a class="sourceLine" id="cb101-27" title="27">m <span class="op">=</span> bravais_lattice(<span class="dv">47</span>)</a>
<a class="sourceLine" id="cb101-28" title="28">result <span class="op">=</span> m.lower() <span class="op">==</span> <span class="st">&#39;orthorhombic&#39;</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-9">Run 1</h4>
<div class="sourceCode" id="cb103"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb103-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb103-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb103-3" title="3"></a>
<a class="sourceLine" id="cb103-4" title="4"></a>
<a class="sourceLine" id="cb103-5" title="5"><span class="kw">def</span> bravais_lattice(group_number):</a>
<a class="sourceLine" id="cb103-6" title="6">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb103-7" title="7"><span class="co">    Return bravais lattice name given space group number</span></a>
<a class="sourceLine" id="cb103-8" title="8"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb103-9" title="9">    <span class="cf">if</span> group_number <span class="op">&lt;</span> <span class="dv">1</span> <span class="kw">or</span> group_number <span class="op">&gt;</span> <span class="dv">230</span>:</a>
<a class="sourceLine" id="cb103-10" title="10">        <span class="cf">raise</span> <span class="pp">ValueError</span>(<span class="st">&quot;Invalid space group number&quot;</span>)</a>
<a class="sourceLine" id="cb103-11" title="11">    name <span class="op">=</span> <span class="st">&quot;&quot;</span></a>
<a class="sourceLine" id="cb103-12" title="12">    <span class="cf">if</span> group_number <span class="op">&lt;</span> <span class="dv">3</span>:</a>
<a class="sourceLine" id="cb103-13" title="13">        name <span class="op">=</span> <span class="st">&quot;triclinic&quot;</span></a>
<a class="sourceLine" id="cb103-14" title="14">    <span class="cf">elif</span> group_number <span class="op">&lt;</span> <span class="dv">16</span>:</a>
<a class="sourceLine" id="cb103-15" title="15">        name <span class="op">=</span> <span class="st">&quot;monoclinic&quot;</span></a>
<a class="sourceLine" id="cb103-16" title="16">    <span class="cf">elif</span> group_number <span class="op">&lt;</span> <span class="dv">75</span>:</a>
<a class="sourceLine" id="cb103-17" title="17">        name <span class="op">=</span> <span class="st">&quot;orthorhombic&quot;</span></a>
<a class="sourceLine" id="cb103-18" title="18">    <span class="cf">elif</span> group_number <span class="op">&lt;</span> <span class="dv">143</span>:</a>
<a class="sourceLine" id="cb103-19" title="19">        name <span class="op">=</span> <span class="st">&quot;tetragonal&quot;</span></a>
<a class="sourceLine" id="cb103-20" title="20">    <span class="cf">elif</span> group_number <span class="op">&lt;</span> <span class="dv">168</span>:</a>
<a class="sourceLine" id="cb103-21" title="21">        name <span class="op">=</span> <span class="st">&quot;trigonal&quot;</span></a>
<a class="sourceLine" id="cb103-22" title="22">    <span class="cf">elif</span> group_number <span class="op">&lt;</span> <span class="dv">195</span>:</a>
<a class="sourceLine" id="cb103-23" title="23">        name <span class="op">=</span> <span class="st">&quot;hexagonal&quot;</span></a>
<a class="sourceLine" id="cb103-24" title="24">    <span class="cf">else</span>:</a>
<a class="sourceLine" id="cb103-25" title="25">        name <span class="op">=</span> <span class="st">&quot;cubic&quot;</span></a>
<a class="sourceLine" id="cb103-26" title="26">    <span class="cf">return</span> name</a>
<a class="sourceLine" id="cb103-27" title="27">m <span class="op">=</span> bravais_lattice(<span class="dv">47</span>)</a>
<a class="sourceLine" id="cb103-28" title="28">result <span class="op">=</span> m.lower() <span class="op">==</span> <span class="st">&#39;orthorhombic&#39;</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-9">Run 2</h4>
<div class="sourceCode" id="cb105"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb105-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb105-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb105-3" title="3"></a>
<a class="sourceLine" id="cb105-4" title="4"></a>
<a class="sourceLine" id="cb105-5" title="5"><span class="kw">def</span> bravais_lattice(group_number):</a>
<a class="sourceLine" id="cb105-6" title="6">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb105-7" title="7"><span class="co">    Return bravais lattice name given space group number</span></a>
<a class="sourceLine" id="cb105-8" title="8"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb105-9" title="9">    <span class="cf">if</span> group_number <span class="op">&lt;</span> <span class="dv">3</span>:</a>
<a class="sourceLine" id="cb105-10" title="10">        name <span class="op">=</span> <span class="st">&quot;triclinic&quot;</span></a>
<a class="sourceLine" id="cb105-11" title="11">    <span class="cf">elif</span> group_number <span class="op">&lt;</span> <span class="dv">16</span>:</a>
<a class="sourceLine" id="cb105-12" title="12">        name <span class="op">=</span> <span class="st">&quot;monoclinic&quot;</span></a>
<a class="sourceLine" id="cb105-13" title="13">    <span class="cf">elif</span> group_number <span class="op">&lt;</span> <span class="dv">75</span>:</a>
<a class="sourceLine" id="cb105-14" title="14">        name <span class="op">=</span> <span class="st">&quot;orthorhombic&quot;</span></a>
<a class="sourceLine" id="cb105-15" title="15">    <span class="cf">elif</span> group_number <span class="op">&lt;</span> <span class="dv">143</span>:</a>
<a class="sourceLine" id="cb105-16" title="16">        name <span class="op">=</span> <span class="st">&quot;tetragonal&quot;</span></a>
<a class="sourceLine" id="cb105-17" title="17">    <span class="cf">elif</span> group_number <span class="op">&lt;</span> <span class="dv">168</span>:</a>
<a class="sourceLine" id="cb105-18" title="18">        name <span class="op">=</span> <span class="st">&quot;trigonal&quot;</span></a>
<a class="sourceLine" id="cb105-19" title="19">    <span class="cf">elif</span> group_number <span class="op">&lt;</span> <span class="dv">195</span>:</a>
<a class="sourceLine" id="cb105-20" title="20">        name <span class="op">=</span> <span class="st">&quot;hexagonal&quot;</span></a>
<a class="sourceLine" id="cb105-21" title="21">    <span class="cf">else</span>:</a>
<a class="sourceLine" id="cb105-22" title="22">        name <span class="op">=</span> <span class="st">&quot;cubic&quot;</span></a>
<a class="sourceLine" id="cb105-23" title="23">    <span class="cf">return</span> name</a>
<a class="sourceLine" id="cb105-24" title="24">m <span class="op">=</span> bravais_lattice(<span class="dv">47</span>)</a>
<a class="sourceLine" id="cb105-25" title="25">result <span class="op">=</span> m.lower() <span class="op">==</span> <span class="st">&#39;orthorhombic&#39;</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-9">Run 3</h4>
<div class="sourceCode" id="cb107"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb107-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb107-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb107-3" title="3"></a>
<a class="sourceLine" id="cb107-4" title="4"></a>
<a class="sourceLine" id="cb107-5" title="5"><span class="kw">def</span> bravais_lattice(group_number):</a>
<a class="sourceLine" id="cb107-6" title="6">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb107-7" title="7"><span class="co">    Return bravais lattice name given space group number</span></a>
<a class="sourceLine" id="cb107-8" title="8"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb107-9" title="9">    name <span class="op">=</span> <span class="st">&quot;&quot;</span></a>
<a class="sourceLine" id="cb107-10" title="10">    <span class="cf">if</span> group_number <span class="op">&lt;</span> <span class="dv">3</span>:</a>
<a class="sourceLine" id="cb107-11" title="11">        name <span class="op">=</span> <span class="st">&quot;triclinic&quot;</span></a>
<a class="sourceLine" id="cb107-12" title="12">    <span class="cf">elif</span> group_number <span class="op">&lt;</span> <span class="dv">16</span>:</a>
<a class="sourceLine" id="cb107-13" title="13">        name <span class="op">=</span> <span class="st">&quot;monoclinic&quot;</span></a>
<a class="sourceLine" id="cb107-14" title="14">    <span class="cf">elif</span> group_number <span class="op">&lt;</span> <span class="dv">75</span>:</a>
<a class="sourceLine" id="cb107-15" title="15">        name <span class="op">=</span> <span class="st">&quot;orthorhombic&quot;</span></a>
<a class="sourceLine" id="cb107-16" title="16">    <span class="cf">elif</span> group_number <span class="op">&lt;</span> <span class="dv">143</span>:</a>
<a class="sourceLine" id="cb107-17" title="17">        name <span class="op">=</span> <span class="st">&quot;tetragonal&quot;</span></a>
<a class="sourceLine" id="cb107-18" title="18">    <span class="cf">elif</span> group_number <span class="op">&lt;</span> <span class="dv">168</span>:</a>
<a class="sourceLine" id="cb107-19" title="19">        name <span class="op">=</span> <span class="st">&quot;trigonal&quot;</span></a>
<a class="sourceLine" id="cb107-20" title="20">    <span class="cf">elif</span> group_number <span class="op">&lt;</span> <span class="dv">195</span>:</a>
<a class="sourceLine" id="cb107-21" title="21">        name <span class="op">=</span> <span class="st">&quot;hexagonal&quot;</span></a>
<a class="sourceLine" id="cb107-22" title="22">    <span class="cf">elif</span> group_number <span class="op">&lt;</span> <span class="dv">231</span>:</a>
<a class="sourceLine" id="cb107-23" title="23">        name <span class="op">=</span> <span class="st">&quot;cubic&quot;</span></a>
<a class="sourceLine" id="cb107-24" title="24">    <span class="cf">else</span>:</a>
<a class="sourceLine" id="cb107-25" title="25">        name <span class="op">=</span> <span class="st">&quot;unknown&quot;</span></a>
<a class="sourceLine" id="cb107-26" title="26">    <span class="cf">return</span> name</a>
<a class="sourceLine" id="cb107-27" title="27">m <span class="op">=</span> bravais_lattice(<span class="dv">47</span>)</a>
<a class="sourceLine" id="cb107-28" title="28">result <span class="op">=</span> m.lower() <span class="op">==</span> <span class="st">&#39;orthorhombic&#39;</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-9">Run 4</h4>
<div class="sourceCode" id="cb109"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb109-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb109-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb109-3" title="3"></a>
<a class="sourceLine" id="cb109-4" title="4"></a>
<a class="sourceLine" id="cb109-5" title="5"><span class="kw">def</span> bravais_lattice(group_number):</a>
<a class="sourceLine" id="cb109-6" title="6">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb109-7" title="7"><span class="co">    Return bravais lattice name given space group number</span></a>
<a class="sourceLine" id="cb109-8" title="8"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb109-9" title="9">    name <span class="op">=</span> <span class="va">None</span></a>
<a class="sourceLine" id="cb109-10" title="10">    <span class="cf">if</span> group_number <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="dv">3</span>):</a>
<a class="sourceLine" id="cb109-11" title="11">        name <span class="op">=</span> <span class="st">&#39;triclinic&#39;</span></a>
<a class="sourceLine" id="cb109-12" title="12">    <span class="cf">elif</span> group_number <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">3</span>, <span class="dv">16</span>):</a>
<a class="sourceLine" id="cb109-13" title="13">        name <span class="op">=</span> <span class="st">&#39;monoclinic&#39;</span></a>
<a class="sourceLine" id="cb109-14" title="14">    <span class="cf">elif</span> group_number <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">16</span>, <span class="dv">75</span>):</a>
<a class="sourceLine" id="cb109-15" title="15">        name <span class="op">=</span> <span class="st">&#39;orthorhombic&#39;</span></a>
<a class="sourceLine" id="cb109-16" title="16">    <span class="cf">elif</span> group_number <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">75</span>, <span class="dv">143</span>):</a>
<a class="sourceLine" id="cb109-17" title="17">        name <span class="op">=</span> <span class="st">&#39;tetragonal&#39;</span></a>
<a class="sourceLine" id="cb109-18" title="18">    <span class="cf">elif</span> group_number <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">143</span>, <span class="dv">168</span>):</a>
<a class="sourceLine" id="cb109-19" title="19">        name <span class="op">=</span> <span class="st">&#39;trigonal&#39;</span></a>
<a class="sourceLine" id="cb109-20" title="20">    <span class="cf">elif</span> group_number <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">168</span>, <span class="dv">195</span>):</a>
<a class="sourceLine" id="cb109-21" title="21">        name <span class="op">=</span> <span class="st">&#39;hexagonal&#39;</span></a>
<a class="sourceLine" id="cb109-22" title="22">    <span class="cf">elif</span> group_number <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">195</span>, <span class="dv">231</span>):</a>
<a class="sourceLine" id="cb109-23" title="23">        name <span class="op">=</span> <span class="st">&#39;cubic&#39;</span></a>
<a class="sourceLine" id="cb109-24" title="24">    <span class="cf">else</span>:</a>
<a class="sourceLine" id="cb109-25" title="25">        <span class="bu">print</span>(<span class="st">&#39;Space group number not in range&#39;</span>)</a>
<a class="sourceLine" id="cb109-26" title="26">        sys.exit()</a>
<a class="sourceLine" id="cb109-27" title="27"></a>
<a class="sourceLine" id="cb109-28" title="28">    <span class="cf">return</span> name</a>
<a class="sourceLine" id="cb109-29" title="29">m <span class="op">=</span> bravais_lattice(<span class="dv">47</span>)</a>
<a class="sourceLine" id="cb109-30" title="30">result <span class="op">=</span> m.lower() <span class="op">==</span> <span class="st">&#39;orthorhombic&#39;</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>canonicalize</summary></p>
<h4 id="query-10">Query</h4>
<div class="sourceCode" id="cb111"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb111-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb111-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb111-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb111-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb111-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb111-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb111-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb111-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb111-9" title="9"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb111-10" title="10"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb111-11" title="11"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb111-12" title="12"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb111-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb111-14" title="14"></a>
<a class="sourceLine" id="cb111-15" title="15"><span class="kw">def</span> canonical(smiles_list):</a>
<a class="sourceLine" id="cb111-16" title="16">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb111-17" title="17"><span class="co">    Returns list of canonical forms of given molecules</span></a>
<a class="sourceLine" id="cb111-18" title="18"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb111-19" title="19">    [insert]</a>
<a class="sourceLine" id="cb111-20" title="20">    <span class="cf">return</span> canon_list</a></code></pre></div>
<h4 id="run-0-10">Run 0</h4>
<div class="sourceCode" id="cb112"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb112-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb112-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb112-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb112-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb112-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb112-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb112-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb112-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb112-9" title="9"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb112-10" title="10"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb112-11" title="11"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb112-12" title="12"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb112-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb112-14" title="14"></a>
<a class="sourceLine" id="cb112-15" title="15"><span class="kw">def</span> canonical(smiles_list):</a>
<a class="sourceLine" id="cb112-16" title="16">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb112-17" title="17"><span class="co">    Returns list of canonical forms of given molecules</span></a>
<a class="sourceLine" id="cb112-18" title="18"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb112-19" title="19">    canon_list <span class="op">=</span> []</a>
<a class="sourceLine" id="cb112-20" title="20">    <span class="cf">for</span> smiles <span class="kw">in</span> smiles_list:</a>
<a class="sourceLine" id="cb112-21" title="21">        mol <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb112-22" title="22">        canon_list.append(Chem.MolToSmiles(mol, isomericSmiles<span class="op">=</span><span class="va">True</span>))</a>
<a class="sourceLine" id="cb112-23" title="23">    <span class="cf">return</span> canon_list</a>
<a class="sourceLine" id="cb112-24" title="24">smiles <span class="op">=</span> [</a>
<a class="sourceLine" id="cb112-25" title="25">    <span class="st">&#39;C1=CC=CN=C1&#39;</span>,</a>
<a class="sourceLine" id="cb112-26" title="26">    <span class="st">&#39;c1cccnc1&#39;</span>,</a>
<a class="sourceLine" id="cb112-27" title="27">    <span class="st">&#39;C([H])C&#39;</span></a>
<a class="sourceLine" id="cb112-28" title="28">]</a>
<a class="sourceLine" id="cb112-29" title="29"></a>
<a class="sourceLine" id="cb112-30" title="30">ref_csmiles <span class="op">=</span> [</a>
<a class="sourceLine" id="cb112-31" title="31">    <span class="st">&#39;c1ccncc1&#39;</span>,</a>
<a class="sourceLine" id="cb112-32" title="32">    <span class="st">&#39;c1ccncc1&#39;</span>,</a>
<a class="sourceLine" id="cb112-33" title="33">    <span class="st">&#39;CC&#39;</span></a>
<a class="sourceLine" id="cb112-34" title="34">]</a>
<a class="sourceLine" id="cb112-35" title="35"></a>
<a class="sourceLine" id="cb112-36" title="36">csmiles <span class="op">=</span> canonical(smiles)</a>
<a class="sourceLine" id="cb112-37" title="37"></a>
<a class="sourceLine" id="cb112-38" title="38"><span class="bu">print</span>(csmiles)</a>
<a class="sourceLine" id="cb112-39" title="39"><span class="bu">print</span>(ref_csmiles)</a>
<a class="sourceLine" id="cb112-40" title="40"></a>
<a class="sourceLine" id="cb112-41" title="41">result <span class="op">=</span> <span class="va">True</span></a>
<a class="sourceLine" id="cb112-42" title="42"><span class="cf">for</span> r, c <span class="kw">in</span> <span class="bu">zip</span>(ref_csmiles, csmiles):</a>
<a class="sourceLine" id="cb112-43" title="43">    result <span class="op">=</span> result <span class="kw">and</span> r <span class="op">==</span> c</a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-10">Run 1</h4>
<div class="sourceCode" id="cb114"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb114-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb114-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb114-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb114-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb114-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb114-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb114-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb114-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb114-9" title="9"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb114-10" title="10"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb114-11" title="11"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb114-12" title="12"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb114-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb114-14" title="14"></a>
<a class="sourceLine" id="cb114-15" title="15"><span class="kw">def</span> canonical(smiles_list):</a>
<a class="sourceLine" id="cb114-16" title="16">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb114-17" title="17"><span class="co">    Returns list of canonical forms of given molecules</span></a>
<a class="sourceLine" id="cb114-18" title="18"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb114-19" title="19">    canon_list <span class="op">=</span> []</a>
<a class="sourceLine" id="cb114-20" title="20">    <span class="cf">for</span> smiles <span class="kw">in</span> smiles_list:</a>
<a class="sourceLine" id="cb114-21" title="21">        mol <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb114-22" title="22">        canon_list.append(Chem.MolToSmiles(mol, isomericSmiles<span class="op">=</span><span class="va">True</span>))</a>
<a class="sourceLine" id="cb114-23" title="23">    <span class="cf">return</span> canon_list</a>
<a class="sourceLine" id="cb114-24" title="24">smiles <span class="op">=</span> [</a>
<a class="sourceLine" id="cb114-25" title="25">    <span class="st">&#39;C1=CC=CN=C1&#39;</span>,</a>
<a class="sourceLine" id="cb114-26" title="26">    <span class="st">&#39;c1cccnc1&#39;</span>,</a>
<a class="sourceLine" id="cb114-27" title="27">    <span class="st">&#39;C([H])C&#39;</span></a>
<a class="sourceLine" id="cb114-28" title="28">]</a>
<a class="sourceLine" id="cb114-29" title="29"></a>
<a class="sourceLine" id="cb114-30" title="30">ref_csmiles <span class="op">=</span> [</a>
<a class="sourceLine" id="cb114-31" title="31">    <span class="st">&#39;c1ccncc1&#39;</span>,</a>
<a class="sourceLine" id="cb114-32" title="32">    <span class="st">&#39;c1ccncc1&#39;</span>,</a>
<a class="sourceLine" id="cb114-33" title="33">    <span class="st">&#39;CC&#39;</span></a>
<a class="sourceLine" id="cb114-34" title="34">]</a>
<a class="sourceLine" id="cb114-35" title="35"></a>
<a class="sourceLine" id="cb114-36" title="36">csmiles <span class="op">=</span> canonical(smiles)</a>
<a class="sourceLine" id="cb114-37" title="37"></a>
<a class="sourceLine" id="cb114-38" title="38"><span class="bu">print</span>(csmiles)</a>
<a class="sourceLine" id="cb114-39" title="39"><span class="bu">print</span>(ref_csmiles)</a>
<a class="sourceLine" id="cb114-40" title="40"></a>
<a class="sourceLine" id="cb114-41" title="41">result <span class="op">=</span> <span class="va">True</span></a>
<a class="sourceLine" id="cb114-42" title="42"><span class="cf">for</span> r, c <span class="kw">in</span> <span class="bu">zip</span>(ref_csmiles, csmiles):</a>
<a class="sourceLine" id="cb114-43" title="43">    result <span class="op">=</span> result <span class="kw">and</span> r <span class="op">==</span> c</a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-10">Run 2</h4>
<div class="sourceCode" id="cb116"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb116-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb116-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb116-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb116-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb116-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb116-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb116-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb116-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb116-9" title="9"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb116-10" title="10"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb116-11" title="11"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb116-12" title="12"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb116-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb116-14" title="14"></a>
<a class="sourceLine" id="cb116-15" title="15"><span class="kw">def</span> canonical(smiles_list):</a>
<a class="sourceLine" id="cb116-16" title="16">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb116-17" title="17"><span class="co">    Returns list of canonical forms of given molecules</span></a>
<a class="sourceLine" id="cb116-18" title="18"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb116-19" title="19">    canon_list <span class="op">=</span> []</a>
<a class="sourceLine" id="cb116-20" title="20">    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(smiles_list)):</a>
<a class="sourceLine" id="cb116-21" title="21">        mol <span class="op">=</span> Chem.MolFromSmiles(smiles_list[i])</a>
<a class="sourceLine" id="cb116-22" title="22">        canon_list.append(Chem.MolToSmiles(mol))</a>
<a class="sourceLine" id="cb116-23" title="23">    <span class="cf">return</span> canon_list</a>
<a class="sourceLine" id="cb116-24" title="24">smiles <span class="op">=</span> [</a>
<a class="sourceLine" id="cb116-25" title="25">    <span class="st">&#39;C1=CC=CN=C1&#39;</span>,</a>
<a class="sourceLine" id="cb116-26" title="26">    <span class="st">&#39;c1cccnc1&#39;</span>,</a>
<a class="sourceLine" id="cb116-27" title="27">    <span class="st">&#39;C([H])C&#39;</span></a>
<a class="sourceLine" id="cb116-28" title="28">]</a>
<a class="sourceLine" id="cb116-29" title="29"></a>
<a class="sourceLine" id="cb116-30" title="30">ref_csmiles <span class="op">=</span> [</a>
<a class="sourceLine" id="cb116-31" title="31">    <span class="st">&#39;c1ccncc1&#39;</span>,</a>
<a class="sourceLine" id="cb116-32" title="32">    <span class="st">&#39;c1ccncc1&#39;</span>,</a>
<a class="sourceLine" id="cb116-33" title="33">    <span class="st">&#39;CC&#39;</span></a>
<a class="sourceLine" id="cb116-34" title="34">]</a>
<a class="sourceLine" id="cb116-35" title="35"></a>
<a class="sourceLine" id="cb116-36" title="36">csmiles <span class="op">=</span> canonical(smiles)</a>
<a class="sourceLine" id="cb116-37" title="37"></a>
<a class="sourceLine" id="cb116-38" title="38"><span class="bu">print</span>(csmiles)</a>
<a class="sourceLine" id="cb116-39" title="39"><span class="bu">print</span>(ref_csmiles)</a>
<a class="sourceLine" id="cb116-40" title="40"></a>
<a class="sourceLine" id="cb116-41" title="41">result <span class="op">=</span> <span class="va">True</span></a>
<a class="sourceLine" id="cb116-42" title="42"><span class="cf">for</span> r, c <span class="kw">in</span> <span class="bu">zip</span>(ref_csmiles, csmiles):</a>
<a class="sourceLine" id="cb116-43" title="43">    result <span class="op">=</span> result <span class="kw">and</span> r <span class="op">==</span> c</a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-10">Run 3</h4>
<div class="sourceCode" id="cb118"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb118-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb118-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb118-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb118-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb118-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb118-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb118-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb118-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb118-9" title="9"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb118-10" title="10"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb118-11" title="11"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb118-12" title="12"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb118-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb118-14" title="14"></a>
<a class="sourceLine" id="cb118-15" title="15"><span class="kw">def</span> canonical(smiles_list):</a>
<a class="sourceLine" id="cb118-16" title="16">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb118-17" title="17"><span class="co">    Returns list of canonical forms of given molecules</span></a>
<a class="sourceLine" id="cb118-18" title="18"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb118-19" title="19">    canon_list <span class="op">=</span> []</a>
<a class="sourceLine" id="cb118-20" title="20">    <span class="cf">for</span> smiles <span class="kw">in</span> smiles_list:</a>
<a class="sourceLine" id="cb118-21" title="21">        mol <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb118-22" title="22">        canon_list.append(Chem.MolToSmiles(mol, isomericSmiles<span class="op">=</span><span class="va">True</span>))</a>
<a class="sourceLine" id="cb118-23" title="23">    <span class="cf">return</span> canon_list</a>
<a class="sourceLine" id="cb118-24" title="24">smiles <span class="op">=</span> [</a>
<a class="sourceLine" id="cb118-25" title="25">    <span class="st">&#39;C1=CC=CN=C1&#39;</span>,</a>
<a class="sourceLine" id="cb118-26" title="26">    <span class="st">&#39;c1cccnc1&#39;</span>,</a>
<a class="sourceLine" id="cb118-27" title="27">    <span class="st">&#39;C([H])C&#39;</span></a>
<a class="sourceLine" id="cb118-28" title="28">]</a>
<a class="sourceLine" id="cb118-29" title="29"></a>
<a class="sourceLine" id="cb118-30" title="30">ref_csmiles <span class="op">=</span> [</a>
<a class="sourceLine" id="cb118-31" title="31">    <span class="st">&#39;c1ccncc1&#39;</span>,</a>
<a class="sourceLine" id="cb118-32" title="32">    <span class="st">&#39;c1ccncc1&#39;</span>,</a>
<a class="sourceLine" id="cb118-33" title="33">    <span class="st">&#39;CC&#39;</span></a>
<a class="sourceLine" id="cb118-34" title="34">]</a>
<a class="sourceLine" id="cb118-35" title="35"></a>
<a class="sourceLine" id="cb118-36" title="36">csmiles <span class="op">=</span> canonical(smiles)</a>
<a class="sourceLine" id="cb118-37" title="37"></a>
<a class="sourceLine" id="cb118-38" title="38"><span class="bu">print</span>(csmiles)</a>
<a class="sourceLine" id="cb118-39" title="39"><span class="bu">print</span>(ref_csmiles)</a>
<a class="sourceLine" id="cb118-40" title="40"></a>
<a class="sourceLine" id="cb118-41" title="41">result <span class="op">=</span> <span class="va">True</span></a>
<a class="sourceLine" id="cb118-42" title="42"><span class="cf">for</span> r, c <span class="kw">in</span> <span class="bu">zip</span>(ref_csmiles, csmiles):</a>
<a class="sourceLine" id="cb118-43" title="43">    result <span class="op">=</span> result <span class="kw">and</span> r <span class="op">==</span> c</a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-10">Run 4</h4>
<div class="sourceCode" id="cb120"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb120-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb120-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb120-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb120-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb120-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb120-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb120-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb120-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb120-9" title="9"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb120-10" title="10"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb120-11" title="11"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb120-12" title="12"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb120-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb120-14" title="14"></a>
<a class="sourceLine" id="cb120-15" title="15"><span class="kw">def</span> canonical(smiles_list):</a>
<a class="sourceLine" id="cb120-16" title="16">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb120-17" title="17"><span class="co">    Returns list of canonical forms of given molecules</span></a>
<a class="sourceLine" id="cb120-18" title="18"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb120-19" title="19">    canon_list <span class="op">=</span> []</a>
<a class="sourceLine" id="cb120-20" title="20">    <span class="cf">for</span> smiles <span class="kw">in</span> smiles_list:</a>
<a class="sourceLine" id="cb120-21" title="21">        mol <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb120-22" title="22">        canon_list.append(Chem.MolToSmiles(mol))</a>
<a class="sourceLine" id="cb120-23" title="23">    <span class="cf">return</span> canon_list</a>
<a class="sourceLine" id="cb120-24" title="24">smiles <span class="op">=</span> [</a>
<a class="sourceLine" id="cb120-25" title="25">    <span class="st">&#39;C1=CC=CN=C1&#39;</span>,</a>
<a class="sourceLine" id="cb120-26" title="26">    <span class="st">&#39;c1cccnc1&#39;</span>,</a>
<a class="sourceLine" id="cb120-27" title="27">    <span class="st">&#39;C([H])C&#39;</span></a>
<a class="sourceLine" id="cb120-28" title="28">]</a>
<a class="sourceLine" id="cb120-29" title="29"></a>
<a class="sourceLine" id="cb120-30" title="30">ref_csmiles <span class="op">=</span> [</a>
<a class="sourceLine" id="cb120-31" title="31">    <span class="st">&#39;c1ccncc1&#39;</span>,</a>
<a class="sourceLine" id="cb120-32" title="32">    <span class="st">&#39;c1ccncc1&#39;</span>,</a>
<a class="sourceLine" id="cb120-33" title="33">    <span class="st">&#39;CC&#39;</span></a>
<a class="sourceLine" id="cb120-34" title="34">]</a>
<a class="sourceLine" id="cb120-35" title="35"></a>
<a class="sourceLine" id="cb120-36" title="36">csmiles <span class="op">=</span> canonical(smiles)</a>
<a class="sourceLine" id="cb120-37" title="37"></a>
<a class="sourceLine" id="cb120-38" title="38"><span class="bu">print</span>(csmiles)</a>
<a class="sourceLine" id="cb120-39" title="39"><span class="bu">print</span>(ref_csmiles)</a>
<a class="sourceLine" id="cb120-40" title="40"></a>
<a class="sourceLine" id="cb120-41" title="41">result <span class="op">=</span> <span class="va">True</span></a>
<a class="sourceLine" id="cb120-42" title="42"><span class="cf">for</span> r, c <span class="kw">in</span> <span class="bu">zip</span>(ref_csmiles, csmiles):</a>
<a class="sourceLine" id="cb120-43" title="43">    result <span class="op">=</span> result <span class="kw">and</span> r <span class="op">==</span> c</a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>carnot_efficiency</summary></p>
<h4 id="query-11">Query</h4>
<div class="sourceCode" id="cb122"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb122-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb122-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb122-3" title="3"></a>
<a class="sourceLine" id="cb122-4" title="4"><span class="kw">def</span> carnot_efficiency(T_hot, T_cold):</a>
<a class="sourceLine" id="cb122-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb122-6" title="6"><span class="co">   This function returns the efficiency of a carnot efficiency operating between two temperatures</span></a>
<a class="sourceLine" id="cb122-7" title="7"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb122-8" title="8">   [insert]</a>
<a class="sourceLine" id="cb122-9" title="9">   <span class="cf">return</span> eps</a>
<a class="sourceLine" id="cb122-10" title="10"></a></code></pre></div>
<h4 id="run-0-11">Run 0</h4>
<div class="sourceCode" id="cb123"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb123-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb123-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb123-3" title="3"></a>
<a class="sourceLine" id="cb123-4" title="4"><span class="kw">def</span> carnot_efficiency(T_hot, T_cold):</a>
<a class="sourceLine" id="cb123-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb123-6" title="6"><span class="co">   This function returns the efficiency of a carnot efficiency operating between two temperatures</span></a>
<a class="sourceLine" id="cb123-7" title="7"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb123-8" title="8">   eps <span class="op">=</span> <span class="dv">1</span> <span class="op">-</span> T_cold<span class="op">/</span>T_hot</a>
<a class="sourceLine" id="cb123-9" title="9">   <span class="cf">return</span> eps</a>
<a class="sourceLine" id="cb123-10" title="10"></a>
<a class="sourceLine" id="cb123-11" title="11"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb123-12" title="12"></a>
<a class="sourceLine" id="cb123-13" title="13">T_cold <span class="op">=</span> <span class="dv">300</span></a>
<a class="sourceLine" id="cb123-14" title="14">T_hot <span class="op">=</span> <span class="dv">600</span></a>
<a class="sourceLine" id="cb123-15" title="15"></a>
<a class="sourceLine" id="cb123-16" title="16">eps <span class="op">=</span> <span class="dv">1</span> <span class="op">-</span> T_cold<span class="op">/</span>T_hot</a>
<a class="sourceLine" id="cb123-17" title="17"></a>
<a class="sourceLine" id="cb123-18" title="18">eps_codex <span class="op">=</span> carnot_efficiency(T_hot, T_cold)</a>
<a class="sourceLine" id="cb123-19" title="19"></a>
<a class="sourceLine" id="cb123-20" title="20"><span class="co"># check </span></a>
<a class="sourceLine" id="cb123-21" title="21"><span class="cf">if</span> np.isclose(eps, eps_codex, rtol<span class="op">=</span><span class="fl">0.01</span>) <span class="op">==</span> <span class="va">True</span>:</a>
<a class="sourceLine" id="cb123-22" title="22">    result <span class="op">=</span> <span class="va">True</span> </a>
<a class="sourceLine" id="cb123-23" title="23"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb123-24" title="24">    result <span class="op">=</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-11">Run 1</h4>
<div class="sourceCode" id="cb125"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb125-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb125-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb125-3" title="3"></a>
<a class="sourceLine" id="cb125-4" title="4"><span class="kw">def</span> carnot_efficiency(T_hot, T_cold):</a>
<a class="sourceLine" id="cb125-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb125-6" title="6"><span class="co">   This function returns the efficiency of a carnot efficiency operating between two temperatures</span></a>
<a class="sourceLine" id="cb125-7" title="7"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb125-8" title="8">   eps <span class="op">=</span> <span class="dv">1</span> <span class="op">-</span> (T_cold<span class="op">/</span>T_hot)</a>
<a class="sourceLine" id="cb125-9" title="9">   <span class="cf">return</span> eps</a>
<a class="sourceLine" id="cb125-10" title="10"></a>
<a class="sourceLine" id="cb125-11" title="11"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb125-12" title="12"></a>
<a class="sourceLine" id="cb125-13" title="13">T_cold <span class="op">=</span> <span class="dv">300</span></a>
<a class="sourceLine" id="cb125-14" title="14">T_hot <span class="op">=</span> <span class="dv">600</span></a>
<a class="sourceLine" id="cb125-15" title="15"></a>
<a class="sourceLine" id="cb125-16" title="16">eps <span class="op">=</span> <span class="dv">1</span> <span class="op">-</span> T_cold<span class="op">/</span>T_hot</a>
<a class="sourceLine" id="cb125-17" title="17"></a>
<a class="sourceLine" id="cb125-18" title="18">eps_codex <span class="op">=</span> carnot_efficiency(T_hot, T_cold)</a>
<a class="sourceLine" id="cb125-19" title="19"></a>
<a class="sourceLine" id="cb125-20" title="20"><span class="co"># check </span></a>
<a class="sourceLine" id="cb125-21" title="21"><span class="cf">if</span> np.isclose(eps, eps_codex, rtol<span class="op">=</span><span class="fl">0.01</span>) <span class="op">==</span> <span class="va">True</span>:</a>
<a class="sourceLine" id="cb125-22" title="22">    result <span class="op">=</span> <span class="va">True</span> </a>
<a class="sourceLine" id="cb125-23" title="23"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb125-24" title="24">    result <span class="op">=</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-11">Run 2</h4>
<div class="sourceCode" id="cb127"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb127-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb127-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb127-3" title="3"></a>
<a class="sourceLine" id="cb127-4" title="4"><span class="kw">def</span> carnot_efficiency(T_hot, T_cold):</a>
<a class="sourceLine" id="cb127-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb127-6" title="6"><span class="co">   This function returns the efficiency of a carnot efficiency operating between two temperatures</span></a>
<a class="sourceLine" id="cb127-7" title="7"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb127-8" title="8">   eps <span class="op">=</span> <span class="dv">1</span> <span class="op">-</span> (T_cold<span class="op">/</span>T_hot)</a>
<a class="sourceLine" id="cb127-9" title="9">   <span class="cf">return</span> eps</a>
<a class="sourceLine" id="cb127-10" title="10"></a>
<a class="sourceLine" id="cb127-11" title="11"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb127-12" title="12"></a>
<a class="sourceLine" id="cb127-13" title="13">T_cold <span class="op">=</span> <span class="dv">300</span></a>
<a class="sourceLine" id="cb127-14" title="14">T_hot <span class="op">=</span> <span class="dv">600</span></a>
<a class="sourceLine" id="cb127-15" title="15"></a>
<a class="sourceLine" id="cb127-16" title="16">eps <span class="op">=</span> <span class="dv">1</span> <span class="op">-</span> T_cold<span class="op">/</span>T_hot</a>
<a class="sourceLine" id="cb127-17" title="17"></a>
<a class="sourceLine" id="cb127-18" title="18">eps_codex <span class="op">=</span> carnot_efficiency(T_hot, T_cold)</a>
<a class="sourceLine" id="cb127-19" title="19"></a>
<a class="sourceLine" id="cb127-20" title="20"><span class="co"># check </span></a>
<a class="sourceLine" id="cb127-21" title="21"><span class="cf">if</span> np.isclose(eps, eps_codex, rtol<span class="op">=</span><span class="fl">0.01</span>) <span class="op">==</span> <span class="va">True</span>:</a>
<a class="sourceLine" id="cb127-22" title="22">    result <span class="op">=</span> <span class="va">True</span> </a>
<a class="sourceLine" id="cb127-23" title="23"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb127-24" title="24">    result <span class="op">=</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-11">Run 3</h4>
<div class="sourceCode" id="cb129"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb129-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb129-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb129-3" title="3"></a>
<a class="sourceLine" id="cb129-4" title="4"><span class="kw">def</span> carnot_efficiency(T_hot, T_cold):</a>
<a class="sourceLine" id="cb129-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb129-6" title="6"><span class="co">   This function returns the efficiency of a carnot efficiency operating between two temperatures</span></a>
<a class="sourceLine" id="cb129-7" title="7"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb129-8" title="8">   eps <span class="op">=</span> <span class="dv">1</span> <span class="op">-</span> (T_cold<span class="op">/</span>T_hot)</a>
<a class="sourceLine" id="cb129-9" title="9">   <span class="cf">return</span> eps</a>
<a class="sourceLine" id="cb129-10" title="10"></a>
<a class="sourceLine" id="cb129-11" title="11"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb129-12" title="12"></a>
<a class="sourceLine" id="cb129-13" title="13">T_cold <span class="op">=</span> <span class="dv">300</span></a>
<a class="sourceLine" id="cb129-14" title="14">T_hot <span class="op">=</span> <span class="dv">600</span></a>
<a class="sourceLine" id="cb129-15" title="15"></a>
<a class="sourceLine" id="cb129-16" title="16">eps <span class="op">=</span> <span class="dv">1</span> <span class="op">-</span> T_cold<span class="op">/</span>T_hot</a>
<a class="sourceLine" id="cb129-17" title="17"></a>
<a class="sourceLine" id="cb129-18" title="18">eps_codex <span class="op">=</span> carnot_efficiency(T_hot, T_cold)</a>
<a class="sourceLine" id="cb129-19" title="19"></a>
<a class="sourceLine" id="cb129-20" title="20"><span class="co"># check </span></a>
<a class="sourceLine" id="cb129-21" title="21"><span class="cf">if</span> np.isclose(eps, eps_codex, rtol<span class="op">=</span><span class="fl">0.01</span>) <span class="op">==</span> <span class="va">True</span>:</a>
<a class="sourceLine" id="cb129-22" title="22">    result <span class="op">=</span> <span class="va">True</span> </a>
<a class="sourceLine" id="cb129-23" title="23"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb129-24" title="24">    result <span class="op">=</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-11">Run 4</h4>
<div class="sourceCode" id="cb131"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb131-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb131-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb131-3" title="3"></a>
<a class="sourceLine" id="cb131-4" title="4"><span class="kw">def</span> carnot_efficiency(T_hot, T_cold):</a>
<a class="sourceLine" id="cb131-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb131-6" title="6"><span class="co">   This function returns the efficiency of a carnot efficiency operating between two temperatures</span></a>
<a class="sourceLine" id="cb131-7" title="7"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb131-8" title="8">   eps <span class="op">=</span> <span class="dv">1</span> <span class="op">-</span> (T_cold<span class="op">/</span>T_hot)</a>
<a class="sourceLine" id="cb131-9" title="9">   <span class="cf">return</span> eps</a>
<a class="sourceLine" id="cb131-10" title="10"></a>
<a class="sourceLine" id="cb131-11" title="11"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb131-12" title="12"></a>
<a class="sourceLine" id="cb131-13" title="13">T_cold <span class="op">=</span> <span class="dv">300</span></a>
<a class="sourceLine" id="cb131-14" title="14">T_hot <span class="op">=</span> <span class="dv">600</span></a>
<a class="sourceLine" id="cb131-15" title="15"></a>
<a class="sourceLine" id="cb131-16" title="16">eps <span class="op">=</span> <span class="dv">1</span> <span class="op">-</span> T_cold<span class="op">/</span>T_hot</a>
<a class="sourceLine" id="cb131-17" title="17"></a>
<a class="sourceLine" id="cb131-18" title="18">eps_codex <span class="op">=</span> carnot_efficiency(T_hot, T_cold)</a>
<a class="sourceLine" id="cb131-19" title="19"></a>
<a class="sourceLine" id="cb131-20" title="20"><span class="co"># check </span></a>
<a class="sourceLine" id="cb131-21" title="21"><span class="cf">if</span> np.isclose(eps, eps_codex, rtol<span class="op">=</span><span class="fl">0.01</span>) <span class="op">==</span> <span class="va">True</span>:</a>
<a class="sourceLine" id="cb131-22" title="22">    result <span class="op">=</span> <span class="va">True</span> </a>
<a class="sourceLine" id="cb131-23" title="23"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb131-24" title="24">    result <span class="op">=</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>claussius</summary></p>
<h4 id="query-12">Query</h4>
<div class="sourceCode" id="cb133"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb133-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb133-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb133-3" title="3"></a>
<a class="sourceLine" id="cb133-4" title="4"><span class="kw">def</span> claussius(HVap, T1, P1, T2):</a>
<a class="sourceLine" id="cb133-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb133-6" title="6"><span class="co">   This function returns the phase transition pressure at temperature T2 given a heat of vaporization HVap, and and reference temperature and pressure T1 and P1</span></a>
<a class="sourceLine" id="cb133-7" title="7"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb133-8" title="8">   [insert]</a>
<a class="sourceLine" id="cb133-9" title="9">   <span class="cf">return</span> P2</a>
<a class="sourceLine" id="cb133-10" title="10"></a></code></pre></div>
<h4 id="run-0-12">Run 0</h4>
<div class="sourceCode" id="cb134"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb134-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb134-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb134-3" title="3"></a>
<a class="sourceLine" id="cb134-4" title="4"><span class="kw">def</span> claussius(HVap, T1, P1, T2):</a>
<a class="sourceLine" id="cb134-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb134-6" title="6"><span class="co">   This function returns the phase transition pressure at temperature T2 given a heat of vaporization HVap, and and reference temperature and pressure T1 and P1</span></a>
<a class="sourceLine" id="cb134-7" title="7"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb134-8" title="8">   P2 <span class="op">=</span> P1<span class="op">*</span>math.exp((HVap<span class="op">/</span><span class="fl">8.314</span>)<span class="op">*</span>((<span class="dv">1</span><span class="op">/</span>T1)<span class="op">-</span>(<span class="dv">1</span><span class="op">/</span>T2)))</a>
<a class="sourceLine" id="cb134-9" title="9">   <span class="cf">return</span> P2</a>
<a class="sourceLine" id="cb134-10" title="10"></a>
<a class="sourceLine" id="cb134-11" title="11"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb134-12" title="12"></a>
<a class="sourceLine" id="cb134-13" title="13"><span class="co"># input</span></a>
<a class="sourceLine" id="cb134-14" title="14">hvap <span class="op">=</span> <span class="dv">5000</span> <span class="co">#J/mol</span></a>
<a class="sourceLine" id="cb134-15" title="15">P1 <span class="op">=</span> <span class="dv">1</span> <span class="co"># atm</span></a>
<a class="sourceLine" id="cb134-16" title="16">R <span class="op">=</span> <span class="fl">8.314</span> <span class="co"># 8.314 J/k mol</span></a>
<a class="sourceLine" id="cb134-17" title="17">T1 <span class="op">=</span> <span class="dv">300</span>     <span class="co"># in K </span></a>
<a class="sourceLine" id="cb134-18" title="18">T2 <span class="op">=</span> <span class="dv">350</span> </a>
<a class="sourceLine" id="cb134-19" title="19"></a>
<a class="sourceLine" id="cb134-20" title="20">P2_codex <span class="op">=</span> claussius(hvap, T1, P1, T2)</a>
<a class="sourceLine" id="cb134-21" title="21">P2 <span class="op">=</span> P1<span class="op">*</span>np.exp(<span class="op">-</span>hvap<span class="op">/</span>R<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>T2<span class="dv">-1</span><span class="op">/</span>T1))</a>
<a class="sourceLine" id="cb134-22" title="22"></a>
<a class="sourceLine" id="cb134-23" title="23"><span class="co"># check </span></a>
<a class="sourceLine" id="cb134-24" title="24"><span class="cf">if</span> np.isclose(P2, P2_codex, rtol<span class="op">=</span><span class="fl">0.01</span>) <span class="op">==</span> <span class="va">True</span>:</a>
<a class="sourceLine" id="cb134-25" title="25">    result <span class="op">=</span> <span class="va">True</span> </a>
<a class="sourceLine" id="cb134-26" title="26"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb134-27" title="27">    result <span class="op">=</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-12">Run 1</h4>
<div class="sourceCode" id="cb136"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb136-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb136-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb136-3" title="3"></a>
<a class="sourceLine" id="cb136-4" title="4"><span class="kw">def</span> claussius(HVap, T1, P1, T2):</a>
<a class="sourceLine" id="cb136-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb136-6" title="6"><span class="co">   This function returns the phase transition pressure at temperature T2 given a heat of vaporization HVap, and and reference temperature and pressure T1 and P1</span></a>
<a class="sourceLine" id="cb136-7" title="7"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb136-8" title="8">   P2 <span class="op">=</span> P1<span class="op">*</span>math.exp((HVap<span class="op">/</span><span class="fl">8.314</span>)<span class="op">*</span>((<span class="dv">1</span><span class="op">/</span>T1)<span class="op">-</span>(<span class="dv">1</span><span class="op">/</span>T2)))</a>
<a class="sourceLine" id="cb136-9" title="9">   <span class="cf">return</span> P2</a>
<a class="sourceLine" id="cb136-10" title="10"></a>
<a class="sourceLine" id="cb136-11" title="11"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb136-12" title="12"></a>
<a class="sourceLine" id="cb136-13" title="13"><span class="co"># input</span></a>
<a class="sourceLine" id="cb136-14" title="14">hvap <span class="op">=</span> <span class="dv">5000</span> <span class="co">#J/mol</span></a>
<a class="sourceLine" id="cb136-15" title="15">P1 <span class="op">=</span> <span class="dv">1</span> <span class="co"># atm</span></a>
<a class="sourceLine" id="cb136-16" title="16">R <span class="op">=</span> <span class="fl">8.314</span> <span class="co"># 8.314 J/k mol</span></a>
<a class="sourceLine" id="cb136-17" title="17">T1 <span class="op">=</span> <span class="dv">300</span>     <span class="co"># in K </span></a>
<a class="sourceLine" id="cb136-18" title="18">T2 <span class="op">=</span> <span class="dv">350</span> </a>
<a class="sourceLine" id="cb136-19" title="19"></a>
<a class="sourceLine" id="cb136-20" title="20">P2_codex <span class="op">=</span> claussius(hvap, T1, P1, T2)</a>
<a class="sourceLine" id="cb136-21" title="21">P2 <span class="op">=</span> P1<span class="op">*</span>np.exp(<span class="op">-</span>hvap<span class="op">/</span>R<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>T2<span class="dv">-1</span><span class="op">/</span>T1))</a>
<a class="sourceLine" id="cb136-22" title="22"></a>
<a class="sourceLine" id="cb136-23" title="23"><span class="co"># check </span></a>
<a class="sourceLine" id="cb136-24" title="24"><span class="cf">if</span> np.isclose(P2, P2_codex, rtol<span class="op">=</span><span class="fl">0.01</span>) <span class="op">==</span> <span class="va">True</span>:</a>
<a class="sourceLine" id="cb136-25" title="25">    result <span class="op">=</span> <span class="va">True</span> </a>
<a class="sourceLine" id="cb136-26" title="26"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb136-27" title="27">    result <span class="op">=</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-12">Run 2</h4>
<div class="sourceCode" id="cb138"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb138-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb138-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb138-3" title="3"></a>
<a class="sourceLine" id="cb138-4" title="4"><span class="kw">def</span> claussius(HVap, T1, P1, T2):</a>
<a class="sourceLine" id="cb138-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb138-6" title="6"><span class="co">   This function returns the phase transition pressure at temperature T2 given a heat of vaporization HVap, and and reference temperature and pressure T1 and P1</span></a>
<a class="sourceLine" id="cb138-7" title="7"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb138-8" title="8">   P2 <span class="op">=</span> P1 <span class="op">*</span> math.exp((HVap <span class="op">*</span> (<span class="dv">1</span><span class="op">/</span>T1 <span class="op">-</span> <span class="dv">1</span><span class="op">/</span>T2)) <span class="op">/</span> <span class="fl">8.314</span>)</a>
<a class="sourceLine" id="cb138-9" title="9">   <span class="cf">return</span> P2</a>
<a class="sourceLine" id="cb138-10" title="10"></a>
<a class="sourceLine" id="cb138-11" title="11"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb138-12" title="12"></a>
<a class="sourceLine" id="cb138-13" title="13"><span class="co"># input</span></a>
<a class="sourceLine" id="cb138-14" title="14">hvap <span class="op">=</span> <span class="dv">5000</span> <span class="co">#J/mol</span></a>
<a class="sourceLine" id="cb138-15" title="15">P1 <span class="op">=</span> <span class="dv">1</span> <span class="co"># atm</span></a>
<a class="sourceLine" id="cb138-16" title="16">R <span class="op">=</span> <span class="fl">8.314</span> <span class="co"># 8.314 J/k mol</span></a>
<a class="sourceLine" id="cb138-17" title="17">T1 <span class="op">=</span> <span class="dv">300</span>     <span class="co"># in K </span></a>
<a class="sourceLine" id="cb138-18" title="18">T2 <span class="op">=</span> <span class="dv">350</span> </a>
<a class="sourceLine" id="cb138-19" title="19"></a>
<a class="sourceLine" id="cb138-20" title="20">P2_codex <span class="op">=</span> claussius(hvap, T1, P1, T2)</a>
<a class="sourceLine" id="cb138-21" title="21">P2 <span class="op">=</span> P1<span class="op">*</span>np.exp(<span class="op">-</span>hvap<span class="op">/</span>R<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>T2<span class="dv">-1</span><span class="op">/</span>T1))</a>
<a class="sourceLine" id="cb138-22" title="22"></a>
<a class="sourceLine" id="cb138-23" title="23"><span class="co"># check </span></a>
<a class="sourceLine" id="cb138-24" title="24"><span class="cf">if</span> np.isclose(P2, P2_codex, rtol<span class="op">=</span><span class="fl">0.01</span>) <span class="op">==</span> <span class="va">True</span>:</a>
<a class="sourceLine" id="cb138-25" title="25">    result <span class="op">=</span> <span class="va">True</span> </a>
<a class="sourceLine" id="cb138-26" title="26"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb138-27" title="27">    result <span class="op">=</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-12">Run 3</h4>
<div class="sourceCode" id="cb140"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb140-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb140-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb140-3" title="3"></a>
<a class="sourceLine" id="cb140-4" title="4"><span class="kw">def</span> claussius(HVap, T1, P1, T2):</a>
<a class="sourceLine" id="cb140-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb140-6" title="6"><span class="co">   This function returns the phase transition pressure at temperature T2 given a heat of vaporization HVap, and and reference temperature and pressure T1 and P1</span></a>
<a class="sourceLine" id="cb140-7" title="7"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb140-8" title="8">   P2 <span class="op">=</span> P1<span class="op">*</span>math.exp((HVap<span class="op">/</span><span class="fl">8.314</span>)<span class="op">*</span>((<span class="dv">1</span><span class="op">/</span>T1)<span class="op">-</span>(<span class="dv">1</span><span class="op">/</span>T2)))</a>
<a class="sourceLine" id="cb140-9" title="9">   <span class="cf">return</span> P2</a>
<a class="sourceLine" id="cb140-10" title="10"></a>
<a class="sourceLine" id="cb140-11" title="11"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb140-12" title="12"></a>
<a class="sourceLine" id="cb140-13" title="13"><span class="co"># input</span></a>
<a class="sourceLine" id="cb140-14" title="14">hvap <span class="op">=</span> <span class="dv">5000</span> <span class="co">#J/mol</span></a>
<a class="sourceLine" id="cb140-15" title="15">P1 <span class="op">=</span> <span class="dv">1</span> <span class="co"># atm</span></a>
<a class="sourceLine" id="cb140-16" title="16">R <span class="op">=</span> <span class="fl">8.314</span> <span class="co"># 8.314 J/k mol</span></a>
<a class="sourceLine" id="cb140-17" title="17">T1 <span class="op">=</span> <span class="dv">300</span>     <span class="co"># in K </span></a>
<a class="sourceLine" id="cb140-18" title="18">T2 <span class="op">=</span> <span class="dv">350</span> </a>
<a class="sourceLine" id="cb140-19" title="19"></a>
<a class="sourceLine" id="cb140-20" title="20">P2_codex <span class="op">=</span> claussius(hvap, T1, P1, T2)</a>
<a class="sourceLine" id="cb140-21" title="21">P2 <span class="op">=</span> P1<span class="op">*</span>np.exp(<span class="op">-</span>hvap<span class="op">/</span>R<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>T2<span class="dv">-1</span><span class="op">/</span>T1))</a>
<a class="sourceLine" id="cb140-22" title="22"></a>
<a class="sourceLine" id="cb140-23" title="23"><span class="co"># check </span></a>
<a class="sourceLine" id="cb140-24" title="24"><span class="cf">if</span> np.isclose(P2, P2_codex, rtol<span class="op">=</span><span class="fl">0.01</span>) <span class="op">==</span> <span class="va">True</span>:</a>
<a class="sourceLine" id="cb140-25" title="25">    result <span class="op">=</span> <span class="va">True</span> </a>
<a class="sourceLine" id="cb140-26" title="26"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb140-27" title="27">    result <span class="op">=</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-12">Run 4</h4>
<div class="sourceCode" id="cb142"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb142-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb142-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb142-3" title="3"></a>
<a class="sourceLine" id="cb142-4" title="4"><span class="kw">def</span> claussius(HVap, T1, P1, T2):</a>
<a class="sourceLine" id="cb142-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb142-6" title="6"><span class="co">   This function returns the phase transition pressure at temperature T2 given a heat of vaporization HVap, and and reference temperature and pressure T1 and P1</span></a>
<a class="sourceLine" id="cb142-7" title="7"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb142-8" title="8">   P2 <span class="op">=</span> P1<span class="op">*</span>math.exp(HVap<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>T1 <span class="op">-</span> <span class="dv">1</span><span class="op">/</span>T2))</a>
<a class="sourceLine" id="cb142-9" title="9">   <span class="cf">return</span> P2</a>
<a class="sourceLine" id="cb142-10" title="10"></a>
<a class="sourceLine" id="cb142-11" title="11"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb142-12" title="12"></a>
<a class="sourceLine" id="cb142-13" title="13"><span class="co"># input</span></a>
<a class="sourceLine" id="cb142-14" title="14">hvap <span class="op">=</span> <span class="dv">5000</span> <span class="co">#J/mol</span></a>
<a class="sourceLine" id="cb142-15" title="15">P1 <span class="op">=</span> <span class="dv">1</span> <span class="co"># atm</span></a>
<a class="sourceLine" id="cb142-16" title="16">R <span class="op">=</span> <span class="fl">8.314</span> <span class="co"># 8.314 J/k mol</span></a>
<a class="sourceLine" id="cb142-17" title="17">T1 <span class="op">=</span> <span class="dv">300</span>     <span class="co"># in K </span></a>
<a class="sourceLine" id="cb142-18" title="18">T2 <span class="op">=</span> <span class="dv">350</span> </a>
<a class="sourceLine" id="cb142-19" title="19"></a>
<a class="sourceLine" id="cb142-20" title="20">P2_codex <span class="op">=</span> claussius(hvap, T1, P1, T2)</a>
<a class="sourceLine" id="cb142-21" title="21">P2 <span class="op">=</span> P1<span class="op">*</span>np.exp(<span class="op">-</span>hvap<span class="op">/</span>R<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>T2<span class="dv">-1</span><span class="op">/</span>T1))</a>
<a class="sourceLine" id="cb142-22" title="22"></a>
<a class="sourceLine" id="cb142-23" title="23"><span class="co"># check </span></a>
<a class="sourceLine" id="cb142-24" title="24"><span class="cf">if</span> np.isclose(P2, P2_codex, rtol<span class="op">=</span><span class="fl">0.01</span>) <span class="op">==</span> <span class="va">True</span>:</a>
<a class="sourceLine" id="cb142-25" title="25">    result <span class="op">=</span> <span class="va">True</span> </a>
<a class="sourceLine" id="cb142-26" title="26"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb142-27" title="27">    result <span class="op">=</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>compare_electronegativity</summary></p>
<h4 id="query-13">Query</h4>
<div class="sourceCode" id="cb144"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb144-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb144-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb144-3" title="3"></a>
<a class="sourceLine" id="cb144-4" title="4"><span class="kw">def</span> compare_electronegativity(element1,element2):</a>
<a class="sourceLine" id="cb144-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb144-6" title="6"><span class="co">   This function returns True if element1 has a larger Pauling electronegativity than element2</span></a>
<a class="sourceLine" id="cb144-7" title="7"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb144-8" title="8">   <span class="im">import</span> mendeleev</a>
<a class="sourceLine" id="cb144-9" title="9">   [insert]</a>
<a class="sourceLine" id="cb144-10" title="10">   <span class="cf">return</span> result</a></code></pre></div>
<h4 id="run-0-13">Run 0</h4>
<div class="sourceCode" id="cb145"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb145-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb145-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb145-3" title="3"></a>
<a class="sourceLine" id="cb145-4" title="4"><span class="kw">def</span> compare_electronegativity(element1,element2):</a>
<a class="sourceLine" id="cb145-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb145-6" title="6"><span class="co">   This function returns True if element1 has a larger Pauling electronegativity than element2</span></a>
<a class="sourceLine" id="cb145-7" title="7"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb145-8" title="8">   <span class="im">import</span> mendeleev</a>
<a class="sourceLine" id="cb145-9" title="9">   result <span class="op">=</span> mendeleev.element(element1).pauling_electronegativity <span class="op">&gt;</span> mendeleev.element(element2).pauling_electronegativity</a>
<a class="sourceLine" id="cb145-10" title="10">   <span class="cf">return</span> result</a>
<a class="sourceLine" id="cb145-11" title="11">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> compare_electronegativity(<span class="st">&quot;O&quot;</span>,<span class="st">&quot;C&quot;</span>) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>&#39;Element&#39; object has no attribute &#39;pauling_electronegativity&#39;</code></pre>
<h4 id="run-1-13">Run 1</h4>
<div class="sourceCode" id="cb147"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb147-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb147-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb147-3" title="3"></a>
<a class="sourceLine" id="cb147-4" title="4"><span class="kw">def</span> compare_electronegativity(element1,element2):</a>
<a class="sourceLine" id="cb147-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb147-6" title="6"><span class="co">   This function returns True if element1 has a larger Pauling electronegativity than element2</span></a>
<a class="sourceLine" id="cb147-7" title="7"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb147-8" title="8">   <span class="im">import</span> mendeleev</a>
<a class="sourceLine" id="cb147-9" title="9">   result <span class="op">=</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb147-10" title="10">   <span class="cf">if</span> mendeleev.element(element1).pauling_electronegativity <span class="op">&gt;</span> mendeleev.element(element2).pauling_electronegativity:</a>
<a class="sourceLine" id="cb147-11" title="11">      result <span class="op">=</span> <span class="va">True</span></a>
<a class="sourceLine" id="cb147-12" title="12">   <span class="cf">return</span> result</a>
<a class="sourceLine" id="cb147-13" title="13">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> compare_electronegativity(<span class="st">&quot;O&quot;</span>,<span class="st">&quot;C&quot;</span>) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>&#39;Element&#39; object has no attribute &#39;pauling_electronegativity&#39;</code></pre>
<h4 id="run-2-13">Run 2</h4>
<div class="sourceCode" id="cb149"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb149-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb149-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb149-3" title="3"></a>
<a class="sourceLine" id="cb149-4" title="4"><span class="kw">def</span> compare_electronegativity(element1,element2):</a>
<a class="sourceLine" id="cb149-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb149-6" title="6"><span class="co">   This function returns True if element1 has a larger Pauling electronegativity than element2</span></a>
<a class="sourceLine" id="cb149-7" title="7"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb149-8" title="8">   <span class="im">import</span> mendeleev</a>
<a class="sourceLine" id="cb149-9" title="9">   result <span class="op">=</span> mendeleev.element(element1).electronegativity <span class="op">&gt;</span> mendeleev.element(element2).electronegativity</a>
<a class="sourceLine" id="cb149-10" title="10">   <span class="cf">return</span> result</a>
<a class="sourceLine" id="cb149-11" title="11">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> compare_electronegativity(<span class="st">&quot;O&quot;</span>,<span class="st">&quot;C&quot;</span>) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>&#39;&gt;&#39; not supported between instances of &#39;method&#39; and &#39;method&#39;</code></pre>
<h4 id="run-3-13">Run 3</h4>
<div class="sourceCode" id="cb151"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb151-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb151-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb151-3" title="3"></a>
<a class="sourceLine" id="cb151-4" title="4"><span class="kw">def</span> compare_electronegativity(element1,element2):</a>
<a class="sourceLine" id="cb151-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb151-6" title="6"><span class="co">   This function returns True if element1 has a larger Pauling electronegativity than element2</span></a>
<a class="sourceLine" id="cb151-7" title="7"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb151-8" title="8">   <span class="im">import</span> mendeleev</a>
<a class="sourceLine" id="cb151-9" title="9">   result <span class="op">=</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb151-10" title="10">   <span class="cf">if</span> mendeleev.element(element1).pauling <span class="op">&gt;</span> mendeleev.element(element2).pauling:</a>
<a class="sourceLine" id="cb151-11" title="11">      result <span class="op">=</span> <span class="va">True</span></a>
<a class="sourceLine" id="cb151-12" title="12">   <span class="cf">return</span> result</a>
<a class="sourceLine" id="cb151-13" title="13">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> compare_electronegativity(<span class="st">&quot;O&quot;</span>,<span class="st">&quot;C&quot;</span>) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>&#39;Element&#39; object has no attribute &#39;pauling&#39;</code></pre>
<h4 id="run-4-13">Run 4</h4>
<div class="sourceCode" id="cb153"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb153-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb153-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb153-3" title="3"></a>
<a class="sourceLine" id="cb153-4" title="4"><span class="kw">def</span> compare_electronegativity(element1,element2):</a>
<a class="sourceLine" id="cb153-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb153-6" title="6"><span class="co">   This function returns True if element1 has a larger Pauling electronegativity than element2</span></a>
<a class="sourceLine" id="cb153-7" title="7"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb153-8" title="8">   <span class="im">import</span> mendeleev</a>
<a class="sourceLine" id="cb153-9" title="9">   <span class="cf">try</span>:</a>
<a class="sourceLine" id="cb153-10" title="10">      electronegativity1 <span class="op">=</span> mendeleev.element(element1).electronegativity</a>
<a class="sourceLine" id="cb153-11" title="11">   <span class="cf">except</span>:</a>
<a class="sourceLine" id="cb153-12" title="12">      <span class="bu">print</span>(<span class="st">&quot;Error: Element </span><span class="sc">%s</span><span class="st"> not found in Mendeleev database&quot;</span> <span class="op">%</span> element1)</a>
<a class="sourceLine" id="cb153-13" title="13">      sys.exit(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb153-14" title="14">   <span class="cf">try</span>:</a>
<a class="sourceLine" id="cb153-15" title="15">      electronegativity2 <span class="op">=</span> mendeleev.element(element2).electronegativity</a>
<a class="sourceLine" id="cb153-16" title="16">   <span class="cf">except</span>:</a>
<a class="sourceLine" id="cb153-17" title="17">      <span class="bu">print</span>(<span class="st">&quot;Error: Element </span><span class="sc">%s</span><span class="st"> not found in Mendeleev database&quot;</span> <span class="op">%</span> element2)</a>
<a class="sourceLine" id="cb153-18" title="18">      sys.exit(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb153-19" title="19">   <span class="cf">if</span> electronegativity1 <span class="op">&gt;</span> electronegativity2:</a>
<a class="sourceLine" id="cb153-20" title="20">      result <span class="op">=</span> <span class="va">True</span></a>
<a class="sourceLine" id="cb153-21" title="21">   <span class="cf">else</span>:</a>
<a class="sourceLine" id="cb153-22" title="22">      result <span class="op">=</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb153-23" title="23">   <span class="cf">return</span> result</a>
<a class="sourceLine" id="cb153-24" title="24">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> compare_electronegativity(<span class="st">&quot;O&quot;</span>,<span class="st">&quot;C&quot;</span>) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>&#39;&gt;&#39; not supported between instances of &#39;method&#39; and &#39;method&#39;</code></pre>
</details>
<details>
<p><summary>condiff_1d</summary></p>
<h4 id="query-14">Query</h4>
<div class="sourceCode" id="cb155"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb155-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb155-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb155-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb155-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb155-5" title="5"></a>
<a class="sourceLine" id="cb155-6" title="6"><span class="kw">def</span> condiff_1d(x):</a>
<a class="sourceLine" id="cb155-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb155-8" title="8"><span class="co">  This function computes the difference between consecutive elements in array x.</span></a>
<a class="sourceLine" id="cb155-9" title="9"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb155-10" title="10">  [insert]</a>
<a class="sourceLine" id="cb155-11" title="11">  <span class="cf">return</span> diff</a></code></pre></div>
<h4 id="run-0-14">Run 0</h4>
<div class="sourceCode" id="cb156"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb156-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb156-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb156-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb156-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb156-5" title="5"></a>
<a class="sourceLine" id="cb156-6" title="6"><span class="kw">def</span> condiff_1d(x):</a>
<a class="sourceLine" id="cb156-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb156-8" title="8"><span class="co">  This function computes the difference between consecutive elements in array x.</span></a>
<a class="sourceLine" id="cb156-9" title="9"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb156-10" title="10">  diff <span class="op">=</span> np.zeros(<span class="bu">len</span>(x)<span class="op">-</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb156-11" title="11">  <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(x)<span class="op">-</span><span class="dv">1</span>):</a>
<a class="sourceLine" id="cb156-12" title="12">    diff[i] <span class="op">=</span> x[i<span class="op">+</span><span class="dv">1</span>] <span class="op">-</span> x[i]</a>
<a class="sourceLine" id="cb156-13" title="13">  <span class="cf">return</span> diff</a>
<a class="sourceLine" id="cb156-14" title="14"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb156-15" title="15"></a>
<a class="sourceLine" id="cb156-16" title="16">x <span class="op">=</span> np.array([<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">7</span>, <span class="dv">0</span>])</a>
<a class="sourceLine" id="cb156-17" title="17"></a>
<a class="sourceLine" id="cb156-18" title="18">true_y <span class="op">=</span> np.ediff1d(x)</a>
<a class="sourceLine" id="cb156-19" title="19"></a>
<a class="sourceLine" id="cb156-20" title="20">pred_y <span class="op">=</span> condiff_1d(x)</a>
<a class="sourceLine" id="cb156-21" title="21"></a>
<a class="sourceLine" id="cb156-22" title="22">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.allclose(true_y,pred_y) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-14">Run 1</h4>
<div class="sourceCode" id="cb158"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb158-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb158-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb158-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb158-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb158-5" title="5"></a>
<a class="sourceLine" id="cb158-6" title="6"><span class="kw">def</span> condiff_1d(x):</a>
<a class="sourceLine" id="cb158-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb158-8" title="8"><span class="co">  This function computes the difference between consecutive elements in array x.</span></a>
<a class="sourceLine" id="cb158-9" title="9"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb158-10" title="10">  diff <span class="op">=</span> np.zeros(<span class="bu">len</span>(x)<span class="op">-</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb158-11" title="11">  <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(x)<span class="op">-</span><span class="dv">1</span>):</a>
<a class="sourceLine" id="cb158-12" title="12">    diff[i] <span class="op">=</span> x[i<span class="op">+</span><span class="dv">1</span>] <span class="op">-</span> x[i]</a>
<a class="sourceLine" id="cb158-13" title="13">  <span class="cf">return</span> diff</a>
<a class="sourceLine" id="cb158-14" title="14"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb158-15" title="15"></a>
<a class="sourceLine" id="cb158-16" title="16">x <span class="op">=</span> np.array([<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">7</span>, <span class="dv">0</span>])</a>
<a class="sourceLine" id="cb158-17" title="17"></a>
<a class="sourceLine" id="cb158-18" title="18">true_y <span class="op">=</span> np.ediff1d(x)</a>
<a class="sourceLine" id="cb158-19" title="19"></a>
<a class="sourceLine" id="cb158-20" title="20">pred_y <span class="op">=</span> condiff_1d(x)</a>
<a class="sourceLine" id="cb158-21" title="21"></a>
<a class="sourceLine" id="cb158-22" title="22">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.allclose(true_y,pred_y) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-14">Run 2</h4>
<div class="sourceCode" id="cb160"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb160-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb160-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb160-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb160-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb160-5" title="5"></a>
<a class="sourceLine" id="cb160-6" title="6"><span class="kw">def</span> condiff_1d(x):</a>
<a class="sourceLine" id="cb160-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb160-8" title="8"><span class="co">  This function computes the difference between consecutive elements in array x.</span></a>
<a class="sourceLine" id="cb160-9" title="9"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb160-10" title="10">  diff <span class="op">=</span> np.diff(x)</a>
<a class="sourceLine" id="cb160-11" title="11">  <span class="cf">return</span> diff</a>
<a class="sourceLine" id="cb160-12" title="12"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb160-13" title="13"></a>
<a class="sourceLine" id="cb160-14" title="14">x <span class="op">=</span> np.array([<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">7</span>, <span class="dv">0</span>])</a>
<a class="sourceLine" id="cb160-15" title="15"></a>
<a class="sourceLine" id="cb160-16" title="16">true_y <span class="op">=</span> np.ediff1d(x)</a>
<a class="sourceLine" id="cb160-17" title="17"></a>
<a class="sourceLine" id="cb160-18" title="18">pred_y <span class="op">=</span> condiff_1d(x)</a>
<a class="sourceLine" id="cb160-19" title="19"></a>
<a class="sourceLine" id="cb160-20" title="20">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.allclose(true_y,pred_y) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-14">Run 3</h4>
<div class="sourceCode" id="cb162"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb162-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb162-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb162-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb162-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb162-5" title="5"></a>
<a class="sourceLine" id="cb162-6" title="6"><span class="kw">def</span> condiff_1d(x):</a>
<a class="sourceLine" id="cb162-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb162-8" title="8"><span class="co">  This function computes the difference between consecutive elements in array x.</span></a>
<a class="sourceLine" id="cb162-9" title="9"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb162-10" title="10">  diff <span class="op">=</span> np.zeros(<span class="bu">len</span>(x)<span class="op">-</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb162-11" title="11">  <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(x)<span class="op">-</span><span class="dv">1</span>):</a>
<a class="sourceLine" id="cb162-12" title="12">    diff[i] <span class="op">=</span> x[i<span class="op">+</span><span class="dv">1</span>] <span class="op">-</span> x[i]</a>
<a class="sourceLine" id="cb162-13" title="13">  <span class="cf">return</span> diff</a>
<a class="sourceLine" id="cb162-14" title="14"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb162-15" title="15"></a>
<a class="sourceLine" id="cb162-16" title="16">x <span class="op">=</span> np.array([<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">7</span>, <span class="dv">0</span>])</a>
<a class="sourceLine" id="cb162-17" title="17"></a>
<a class="sourceLine" id="cb162-18" title="18">true_y <span class="op">=</span> np.ediff1d(x)</a>
<a class="sourceLine" id="cb162-19" title="19"></a>
<a class="sourceLine" id="cb162-20" title="20">pred_y <span class="op">=</span> condiff_1d(x)</a>
<a class="sourceLine" id="cb162-21" title="21"></a>
<a class="sourceLine" id="cb162-22" title="22">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.allclose(true_y,pred_y) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-14">Run 4</h4>
<div class="sourceCode" id="cb164"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb164-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb164-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb164-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb164-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb164-5" title="5"></a>
<a class="sourceLine" id="cb164-6" title="6"><span class="kw">def</span> condiff_1d(x):</a>
<a class="sourceLine" id="cb164-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb164-8" title="8"><span class="co">  This function computes the difference between consecutive elements in array x.</span></a>
<a class="sourceLine" id="cb164-9" title="9"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb164-10" title="10">  diff <span class="op">=</span> np.zeros(<span class="bu">len</span>(x)<span class="op">-</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb164-11" title="11">  <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(x)<span class="op">-</span><span class="dv">1</span>):</a>
<a class="sourceLine" id="cb164-12" title="12">    diff[i] <span class="op">=</span> x[i<span class="op">+</span><span class="dv">1</span>] <span class="op">-</span> x[i]</a>
<a class="sourceLine" id="cb164-13" title="13">  <span class="cf">return</span> diff</a>
<a class="sourceLine" id="cb164-14" title="14"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb164-15" title="15"></a>
<a class="sourceLine" id="cb164-16" title="16">x <span class="op">=</span> np.array([<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">7</span>, <span class="dv">0</span>])</a>
<a class="sourceLine" id="cb164-17" title="17"></a>
<a class="sourceLine" id="cb164-18" title="18">true_y <span class="op">=</span> np.ediff1d(x)</a>
<a class="sourceLine" id="cb164-19" title="19"></a>
<a class="sourceLine" id="cb164-20" title="20">pred_y <span class="op">=</span> condiff_1d(x)</a>
<a class="sourceLine" id="cb164-21" title="21"></a>
<a class="sourceLine" id="cb164-22" title="22">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.allclose(true_y,pred_y) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>cubes</summary></p>
<h4 id="query-15">Query</h4>
<div class="sourceCode" id="cb166"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb166-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb166-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb166-3" title="3"></a>
<a class="sourceLine" id="cb166-4" title="4"><span class="kw">def</span> sum_of_cubes(n):</a>
<a class="sourceLine" id="cb166-5" title="5">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb166-6" title="6"><span class="co">  This function returns the sum of the first n cubes</span></a>
<a class="sourceLine" id="cb166-7" title="7"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb166-8" title="8">  [insert]</a>
<a class="sourceLine" id="cb166-9" title="9">  <span class="cf">return</span> s</a></code></pre></div>
<h4 id="run-0-15">Run 0</h4>
<div class="sourceCode" id="cb167"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb167-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb167-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb167-3" title="3"></a>
<a class="sourceLine" id="cb167-4" title="4"><span class="kw">def</span> sum_of_cubes(n):</a>
<a class="sourceLine" id="cb167-5" title="5">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb167-6" title="6"><span class="co">  This function returns the sum of the first n cubes</span></a>
<a class="sourceLine" id="cb167-7" title="7"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb167-8" title="8">  s <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb167-9" title="9">  <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, n<span class="op">+</span><span class="dv">1</span>):</a>
<a class="sourceLine" id="cb167-10" title="10">    s <span class="op">+=</span> i<span class="op">**</span><span class="dv">3</span></a>
<a class="sourceLine" id="cb167-11" title="11">  <span class="cf">return</span> s</a>
<a class="sourceLine" id="cb167-12" title="12">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> sum_of_cubes(<span class="dv">5</span>) <span class="op">==</span> <span class="dv">225</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-15">Run 1</h4>
<div class="sourceCode" id="cb169"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb169-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb169-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb169-3" title="3"></a>
<a class="sourceLine" id="cb169-4" title="4"><span class="kw">def</span> sum_of_cubes(n):</a>
<a class="sourceLine" id="cb169-5" title="5">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb169-6" title="6"><span class="co">  This function returns the sum of the first n cubes</span></a>
<a class="sourceLine" id="cb169-7" title="7"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb169-8" title="8">  s <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb169-9" title="9">  <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n):</a>
<a class="sourceLine" id="cb169-10" title="10">    s <span class="op">+=</span> i<span class="op">**</span><span class="dv">3</span></a>
<a class="sourceLine" id="cb169-11" title="11">  <span class="cf">return</span> s</a>
<a class="sourceLine" id="cb169-12" title="12">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> sum_of_cubes(<span class="dv">5</span>) <span class="op">==</span> <span class="dv">225</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-15">Run 2</h4>
<div class="sourceCode" id="cb171"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb171-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb171-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb171-3" title="3"></a>
<a class="sourceLine" id="cb171-4" title="4"><span class="kw">def</span> sum_of_cubes(n):</a>
<a class="sourceLine" id="cb171-5" title="5">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb171-6" title="6"><span class="co">  This function returns the sum of the first n cubes</span></a>
<a class="sourceLine" id="cb171-7" title="7"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb171-8" title="8">  s <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb171-9" title="9">  <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>,n<span class="op">+</span><span class="dv">1</span>):</a>
<a class="sourceLine" id="cb171-10" title="10">    s <span class="op">+=</span> i<span class="op">**</span><span class="dv">3</span></a>
<a class="sourceLine" id="cb171-11" title="11">  <span class="cf">return</span> s</a>
<a class="sourceLine" id="cb171-12" title="12">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> sum_of_cubes(<span class="dv">5</span>) <span class="op">==</span> <span class="dv">225</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-15">Run 3</h4>
<div class="sourceCode" id="cb173"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb173-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb173-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb173-3" title="3"></a>
<a class="sourceLine" id="cb173-4" title="4"><span class="kw">def</span> sum_of_cubes(n):</a>
<a class="sourceLine" id="cb173-5" title="5">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb173-6" title="6"><span class="co">  This function returns the sum of the first n cubes</span></a>
<a class="sourceLine" id="cb173-7" title="7"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb173-8" title="8">  s <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb173-9" title="9">  <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, n<span class="op">+</span><span class="dv">1</span>):</a>
<a class="sourceLine" id="cb173-10" title="10">    s <span class="op">+=</span> i<span class="op">**</span><span class="dv">3</span></a>
<a class="sourceLine" id="cb173-11" title="11">  <span class="cf">return</span> s</a>
<a class="sourceLine" id="cb173-12" title="12">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> sum_of_cubes(<span class="dv">5</span>) <span class="op">==</span> <span class="dv">225</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-15">Run 4</h4>
<div class="sourceCode" id="cb175"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb175-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb175-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb175-3" title="3"></a>
<a class="sourceLine" id="cb175-4" title="4"><span class="kw">def</span> sum_of_cubes(n):</a>
<a class="sourceLine" id="cb175-5" title="5">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb175-6" title="6"><span class="co">  This function returns the sum of the first n cubes</span></a>
<a class="sourceLine" id="cb175-7" title="7"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb175-8" title="8">  s <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb175-9" title="9">  <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, n<span class="op">+</span><span class="dv">1</span>):</a>
<a class="sourceLine" id="cb175-10" title="10">    s <span class="op">+=</span> i<span class="op">**</span><span class="dv">3</span></a>
<a class="sourceLine" id="cb175-11" title="11">  <span class="cf">return</span> s</a>
<a class="sourceLine" id="cb175-12" title="12">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> sum_of_cubes(<span class="dv">5</span>) <span class="op">==</span> <span class="dv">225</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>de_broglie</summary></p>
<h4 id="query-16">Query</h4>
<div class="sourceCode" id="cb177"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb177-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb177-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb177-3" title="3"></a>
<a class="sourceLine" id="cb177-4" title="4"><span class="kw">def</span> de_broglie(m,v):</a>
<a class="sourceLine" id="cb177-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb177-6" title="6"><span class="co">   This function returns the de Broglie wavelength for a particle of mass m with speed v.</span></a>
<a class="sourceLine" id="cb177-7" title="7"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb177-8" title="8">   [insert]</a>
<a class="sourceLine" id="cb177-9" title="9">   <span class="cf">return</span> l</a></code></pre></div>
<h4 id="run-0-16">Run 0</h4>
<div class="sourceCode" id="cb178"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb178-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb178-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb178-3" title="3"></a>
<a class="sourceLine" id="cb178-4" title="4"><span class="kw">def</span> de_broglie(m,v):</a>
<a class="sourceLine" id="cb178-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb178-6" title="6"><span class="co">   This function returns the de Broglie wavelength for a particle of mass m with speed v.</span></a>
<a class="sourceLine" id="cb178-7" title="7"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb178-8" title="8">   h <span class="op">=</span> <span class="fl">6.626068e-34</span></a>
<a class="sourceLine" id="cb178-9" title="9">   l <span class="op">=</span> h<span class="op">/</span>(m<span class="op">*</span>v)</a>
<a class="sourceLine" id="cb178-10" title="10">   <span class="cf">return</span> l</a>
<a class="sourceLine" id="cb178-11" title="11"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb178-12" title="12"></a>
<a class="sourceLine" id="cb178-13" title="13"><span class="co"># input params</span></a>
<a class="sourceLine" id="cb178-14" title="14">h <span class="op">=</span> <span class="fl">6.626e-34</span> </a>
<a class="sourceLine" id="cb178-15" title="15">v <span class="op">=</span> <span class="fl">1.00e6</span></a>
<a class="sourceLine" id="cb178-16" title="16">m <span class="op">=</span> <span class="fl">9.11e-31</span></a>
<a class="sourceLine" id="cb178-17" title="17"></a>
<a class="sourceLine" id="cb178-18" title="18">lam  <span class="op">=</span> h<span class="op">/</span>(m<span class="op">*</span>v)</a>
<a class="sourceLine" id="cb178-19" title="19"><span class="bu">print</span>(<span class="st">&quot;lam =&quot;</span>, lam)</a>
<a class="sourceLine" id="cb178-20" title="20"></a>
<a class="sourceLine" id="cb178-21" title="21">lam_codex <span class="op">=</span> de_broglie(m,v)</a>
<a class="sourceLine" id="cb178-22" title="22"></a>
<a class="sourceLine" id="cb178-23" title="23"><span class="co"># check </span></a>
<a class="sourceLine" id="cb178-24" title="24"><span class="cf">if</span> np.isclose(lam, lam_codex) <span class="op">==</span>  <span class="va">True</span>:</a>
<a class="sourceLine" id="cb178-25" title="25">    result <span class="op">=</span> <span class="va">True</span></a>
<a class="sourceLine" id="cb178-26" title="26"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb178-27" title="27">    result <span class="op">=</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb178-28" title="28"></a>
<a class="sourceLine" id="cb178-29" title="29"></a>
<a class="sourceLine" id="cb178-30" title="30"></a>
<a class="sourceLine" id="cb178-31" title="31"></a>
<a class="sourceLine" id="cb178-32" title="32"></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-16">Run 1</h4>
<div class="sourceCode" id="cb180"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb180-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb180-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb180-3" title="3"></a>
<a class="sourceLine" id="cb180-4" title="4"><span class="kw">def</span> de_broglie(m,v):</a>
<a class="sourceLine" id="cb180-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb180-6" title="6"><span class="co">   This function returns the de Broglie wavelength for a particle of mass m with speed v.</span></a>
<a class="sourceLine" id="cb180-7" title="7"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb180-8" title="8">   h <span class="op">=</span> <span class="fl">6.626e-34</span></a>
<a class="sourceLine" id="cb180-9" title="9">   l <span class="op">=</span> h<span class="op">/</span>(m<span class="op">*</span>v)</a>
<a class="sourceLine" id="cb180-10" title="10">   <span class="cf">return</span> l</a>
<a class="sourceLine" id="cb180-11" title="11"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb180-12" title="12"></a>
<a class="sourceLine" id="cb180-13" title="13"><span class="co"># input params</span></a>
<a class="sourceLine" id="cb180-14" title="14">h <span class="op">=</span> <span class="fl">6.626e-34</span> </a>
<a class="sourceLine" id="cb180-15" title="15">v <span class="op">=</span> <span class="fl">1.00e6</span></a>
<a class="sourceLine" id="cb180-16" title="16">m <span class="op">=</span> <span class="fl">9.11e-31</span></a>
<a class="sourceLine" id="cb180-17" title="17"></a>
<a class="sourceLine" id="cb180-18" title="18">lam  <span class="op">=</span> h<span class="op">/</span>(m<span class="op">*</span>v)</a>
<a class="sourceLine" id="cb180-19" title="19"><span class="bu">print</span>(<span class="st">&quot;lam =&quot;</span>, lam)</a>
<a class="sourceLine" id="cb180-20" title="20"></a>
<a class="sourceLine" id="cb180-21" title="21">lam_codex <span class="op">=</span> de_broglie(m,v)</a>
<a class="sourceLine" id="cb180-22" title="22"></a>
<a class="sourceLine" id="cb180-23" title="23"><span class="co"># check </span></a>
<a class="sourceLine" id="cb180-24" title="24"><span class="cf">if</span> np.isclose(lam, lam_codex) <span class="op">==</span>  <span class="va">True</span>:</a>
<a class="sourceLine" id="cb180-25" title="25">    result <span class="op">=</span> <span class="va">True</span></a>
<a class="sourceLine" id="cb180-26" title="26"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb180-27" title="27">    result <span class="op">=</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb180-28" title="28"></a>
<a class="sourceLine" id="cb180-29" title="29"></a>
<a class="sourceLine" id="cb180-30" title="30"></a>
<a class="sourceLine" id="cb180-31" title="31"></a>
<a class="sourceLine" id="cb180-32" title="32"></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-16">Run 2</h4>
<div class="sourceCode" id="cb182"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb182-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb182-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb182-3" title="3"></a>
<a class="sourceLine" id="cb182-4" title="4"><span class="kw">def</span> de_broglie(m,v):</a>
<a class="sourceLine" id="cb182-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb182-6" title="6"><span class="co">   This function returns the de Broglie wavelength for a particle of mass m with speed v.</span></a>
<a class="sourceLine" id="cb182-7" title="7"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb182-8" title="8">   h <span class="op">=</span> <span class="fl">6.62606896e-34</span></a>
<a class="sourceLine" id="cb182-9" title="9">   l <span class="op">=</span> h <span class="op">/</span> (m <span class="op">*</span> v)</a>
<a class="sourceLine" id="cb182-10" title="10">   <span class="cf">return</span> l</a>
<a class="sourceLine" id="cb182-11" title="11"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb182-12" title="12"></a>
<a class="sourceLine" id="cb182-13" title="13"><span class="co"># input params</span></a>
<a class="sourceLine" id="cb182-14" title="14">h <span class="op">=</span> <span class="fl">6.626e-34</span> </a>
<a class="sourceLine" id="cb182-15" title="15">v <span class="op">=</span> <span class="fl">1.00e6</span></a>
<a class="sourceLine" id="cb182-16" title="16">m <span class="op">=</span> <span class="fl">9.11e-31</span></a>
<a class="sourceLine" id="cb182-17" title="17"></a>
<a class="sourceLine" id="cb182-18" title="18">lam  <span class="op">=</span> h<span class="op">/</span>(m<span class="op">*</span>v)</a>
<a class="sourceLine" id="cb182-19" title="19"><span class="bu">print</span>(<span class="st">&quot;lam =&quot;</span>, lam)</a>
<a class="sourceLine" id="cb182-20" title="20"></a>
<a class="sourceLine" id="cb182-21" title="21">lam_codex <span class="op">=</span> de_broglie(m,v)</a>
<a class="sourceLine" id="cb182-22" title="22"></a>
<a class="sourceLine" id="cb182-23" title="23"><span class="co"># check </span></a>
<a class="sourceLine" id="cb182-24" title="24"><span class="cf">if</span> np.isclose(lam, lam_codex) <span class="op">==</span>  <span class="va">True</span>:</a>
<a class="sourceLine" id="cb182-25" title="25">    result <span class="op">=</span> <span class="va">True</span></a>
<a class="sourceLine" id="cb182-26" title="26"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb182-27" title="27">    result <span class="op">=</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb182-28" title="28"></a>
<a class="sourceLine" id="cb182-29" title="29"></a>
<a class="sourceLine" id="cb182-30" title="30"></a>
<a class="sourceLine" id="cb182-31" title="31"></a>
<a class="sourceLine" id="cb182-32" title="32"></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-16">Run 3</h4>
<div class="sourceCode" id="cb184"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb184-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb184-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb184-3" title="3"></a>
<a class="sourceLine" id="cb184-4" title="4"><span class="kw">def</span> de_broglie(m,v):</a>
<a class="sourceLine" id="cb184-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb184-6" title="6"><span class="co">   This function returns the de Broglie wavelength for a particle of mass m with speed v.</span></a>
<a class="sourceLine" id="cb184-7" title="7"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb184-8" title="8">   h <span class="op">=</span> <span class="fl">6.626e-34</span> <span class="co"># Planck&#39;s constant</span></a>
<a class="sourceLine" id="cb184-9" title="9">   l <span class="op">=</span> h <span class="op">/</span> (m <span class="op">*</span> v)</a>
<a class="sourceLine" id="cb184-10" title="10">   <span class="cf">return</span> l</a>
<a class="sourceLine" id="cb184-11" title="11"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb184-12" title="12"></a>
<a class="sourceLine" id="cb184-13" title="13"><span class="co"># input params</span></a>
<a class="sourceLine" id="cb184-14" title="14">h <span class="op">=</span> <span class="fl">6.626e-34</span> </a>
<a class="sourceLine" id="cb184-15" title="15">v <span class="op">=</span> <span class="fl">1.00e6</span></a>
<a class="sourceLine" id="cb184-16" title="16">m <span class="op">=</span> <span class="fl">9.11e-31</span></a>
<a class="sourceLine" id="cb184-17" title="17"></a>
<a class="sourceLine" id="cb184-18" title="18">lam  <span class="op">=</span> h<span class="op">/</span>(m<span class="op">*</span>v)</a>
<a class="sourceLine" id="cb184-19" title="19"><span class="bu">print</span>(<span class="st">&quot;lam =&quot;</span>, lam)</a>
<a class="sourceLine" id="cb184-20" title="20"></a>
<a class="sourceLine" id="cb184-21" title="21">lam_codex <span class="op">=</span> de_broglie(m,v)</a>
<a class="sourceLine" id="cb184-22" title="22"></a>
<a class="sourceLine" id="cb184-23" title="23"><span class="co"># check </span></a>
<a class="sourceLine" id="cb184-24" title="24"><span class="cf">if</span> np.isclose(lam, lam_codex) <span class="op">==</span>  <span class="va">True</span>:</a>
<a class="sourceLine" id="cb184-25" title="25">    result <span class="op">=</span> <span class="va">True</span></a>
<a class="sourceLine" id="cb184-26" title="26"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb184-27" title="27">    result <span class="op">=</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb184-28" title="28"></a>
<a class="sourceLine" id="cb184-29" title="29"></a>
<a class="sourceLine" id="cb184-30" title="30"></a>
<a class="sourceLine" id="cb184-31" title="31"></a>
<a class="sourceLine" id="cb184-32" title="32"></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-16">Run 4</h4>
<div class="sourceCode" id="cb186"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb186-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb186-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb186-3" title="3"></a>
<a class="sourceLine" id="cb186-4" title="4"><span class="kw">def</span> de_broglie(m,v):</a>
<a class="sourceLine" id="cb186-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb186-6" title="6"><span class="co">   This function returns the de Broglie wavelength for a particle of mass m with speed v.</span></a>
<a class="sourceLine" id="cb186-7" title="7"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb186-8" title="8">   h <span class="op">=</span> <span class="fl">6.626e-34</span></a>
<a class="sourceLine" id="cb186-9" title="9">   l <span class="op">=</span> h<span class="op">/</span>(m<span class="op">*</span>v)</a>
<a class="sourceLine" id="cb186-10" title="10">   <span class="cf">return</span> l</a>
<a class="sourceLine" id="cb186-11" title="11"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb186-12" title="12"></a>
<a class="sourceLine" id="cb186-13" title="13"><span class="co"># input params</span></a>
<a class="sourceLine" id="cb186-14" title="14">h <span class="op">=</span> <span class="fl">6.626e-34</span> </a>
<a class="sourceLine" id="cb186-15" title="15">v <span class="op">=</span> <span class="fl">1.00e6</span></a>
<a class="sourceLine" id="cb186-16" title="16">m <span class="op">=</span> <span class="fl">9.11e-31</span></a>
<a class="sourceLine" id="cb186-17" title="17"></a>
<a class="sourceLine" id="cb186-18" title="18">lam  <span class="op">=</span> h<span class="op">/</span>(m<span class="op">*</span>v)</a>
<a class="sourceLine" id="cb186-19" title="19"><span class="bu">print</span>(<span class="st">&quot;lam =&quot;</span>, lam)</a>
<a class="sourceLine" id="cb186-20" title="20"></a>
<a class="sourceLine" id="cb186-21" title="21">lam_codex <span class="op">=</span> de_broglie(m,v)</a>
<a class="sourceLine" id="cb186-22" title="22"></a>
<a class="sourceLine" id="cb186-23" title="23"><span class="co"># check </span></a>
<a class="sourceLine" id="cb186-24" title="24"><span class="cf">if</span> np.isclose(lam, lam_codex) <span class="op">==</span>  <span class="va">True</span>:</a>
<a class="sourceLine" id="cb186-25" title="25">    result <span class="op">=</span> <span class="va">True</span></a>
<a class="sourceLine" id="cb186-26" title="26"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb186-27" title="27">    result <span class="op">=</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb186-28" title="28"></a>
<a class="sourceLine" id="cb186-29" title="29"></a>
<a class="sourceLine" id="cb186-30" title="30"></a>
<a class="sourceLine" id="cb186-31" title="31"></a>
<a class="sourceLine" id="cb186-32" title="32"></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>derivative1d-ch</summary></p>
<h4 id="query-17">Query</h4>
<div class="sourceCode" id="cb188"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb188-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb188-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb188-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb188-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb188-5" title="5"></a>
<a class="sourceLine" id="cb188-6" title="6"><span class="kw">def</span> find_derivative(a,b,c,x):</a>
<a class="sourceLine" id="cb188-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb188-8" title="8"><span class="co">  这个函数通过生成含有参数a，b，c的二阶多項式来计算x处的一阶导数。</span></a>
<a class="sourceLine" id="cb188-9" title="9"></a>
<a class="sourceLine" id="cb188-10" title="10"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb188-11" title="11">  [insert]</a>
<a class="sourceLine" id="cb188-12" title="12">  <span class="cf">return</span> d</a></code></pre></div>
<h4 id="run-0-17">Run 0</h4>
<div class="sourceCode" id="cb189"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb189-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb189-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb189-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb189-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb189-5" title="5"></a>
<a class="sourceLine" id="cb189-6" title="6"><span class="kw">def</span> find_derivative(a,b,c,x):</a>
<a class="sourceLine" id="cb189-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb189-8" title="8"><span class="co">  这个函数通过生成含有参数a，b，c的二阶多項式来计算x处的一阶导数。</span></a>
<a class="sourceLine" id="cb189-9" title="9"></a>
<a class="sourceLine" id="cb189-10" title="10"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb189-11" title="11">  d <span class="op">=</span> <span class="dv">2</span><span class="op">*</span>a<span class="op">*</span>x <span class="op">+</span> b</a>
<a class="sourceLine" id="cb189-12" title="12">  <span class="cf">return</span> d</a>
<a class="sourceLine" id="cb189-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb189-14" title="14"></a>
<a class="sourceLine" id="cb189-15" title="15">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> find_derivative(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">2</span>) <span class="op">==</span> <span class="dv">6</span> <span class="cf">else</span> <span class="va">False</span> </a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-17">Run 1</h4>
<div class="sourceCode" id="cb191"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb191-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb191-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb191-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb191-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb191-5" title="5"></a>
<a class="sourceLine" id="cb191-6" title="6"><span class="kw">def</span> find_derivative(a,b,c,x):</a>
<a class="sourceLine" id="cb191-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb191-8" title="8"><span class="co">  这个函数通过生成含有参数a，b，c的二阶多項式来计算x处的一阶导数。</span></a>
<a class="sourceLine" id="cb191-9" title="9"></a>
<a class="sourceLine" id="cb191-10" title="10"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb191-11" title="11">  d <span class="op">=</span> <span class="dv">2</span><span class="op">*</span>a<span class="op">*</span>x <span class="op">+</span> b</a>
<a class="sourceLine" id="cb191-12" title="12">  <span class="cf">return</span> d</a>
<a class="sourceLine" id="cb191-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb191-14" title="14"></a>
<a class="sourceLine" id="cb191-15" title="15">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> find_derivative(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">2</span>) <span class="op">==</span> <span class="dv">6</span> <span class="cf">else</span> <span class="va">False</span> </a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-17">Run 2</h4>
<div class="sourceCode" id="cb193"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb193-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb193-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb193-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb193-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb193-5" title="5"></a>
<a class="sourceLine" id="cb193-6" title="6"><span class="kw">def</span> find_derivative(a,b,c,x):</a>
<a class="sourceLine" id="cb193-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb193-8" title="8"><span class="co">  这个函数通过生成含有参数a，b，c的二阶多項式来计算x处的一阶导数。</span></a>
<a class="sourceLine" id="cb193-9" title="9"></a>
<a class="sourceLine" id="cb193-10" title="10"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb193-11" title="11">  d <span class="op">=</span> <span class="dv">2</span><span class="op">*</span>a<span class="op">*</span>x <span class="op">+</span> b</a>
<a class="sourceLine" id="cb193-12" title="12">  <span class="cf">return</span> d</a>
<a class="sourceLine" id="cb193-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb193-14" title="14"></a>
<a class="sourceLine" id="cb193-15" title="15">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> find_derivative(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">2</span>) <span class="op">==</span> <span class="dv">6</span> <span class="cf">else</span> <span class="va">False</span> </a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-17">Run 3</h4>
<div class="sourceCode" id="cb195"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb195-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb195-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb195-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb195-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb195-5" title="5"></a>
<a class="sourceLine" id="cb195-6" title="6"><span class="kw">def</span> find_derivative(a,b,c,x):</a>
<a class="sourceLine" id="cb195-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb195-8" title="8"><span class="co">  这个函数通过生成含有参数a，b，c的二阶多項式来计算x处的一阶导数。</span></a>
<a class="sourceLine" id="cb195-9" title="9"></a>
<a class="sourceLine" id="cb195-10" title="10"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb195-11" title="11">  d <span class="op">=</span> <span class="dv">2</span><span class="op">*</span>a<span class="op">*</span>x <span class="op">+</span> b</a>
<a class="sourceLine" id="cb195-12" title="12">  <span class="cf">return</span> d</a>
<a class="sourceLine" id="cb195-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb195-14" title="14"></a>
<a class="sourceLine" id="cb195-15" title="15">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> find_derivative(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">2</span>) <span class="op">==</span> <span class="dv">6</span> <span class="cf">else</span> <span class="va">False</span> </a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-17">Run 4</h4>
<div class="sourceCode" id="cb197"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb197-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb197-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb197-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb197-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb197-5" title="5"></a>
<a class="sourceLine" id="cb197-6" title="6"><span class="kw">def</span> find_derivative(a,b,c,x):</a>
<a class="sourceLine" id="cb197-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb197-8" title="8"><span class="co">  这个函数通过生成含有参数a，b，c的二阶多項式来计算x处的一阶导数。</span></a>
<a class="sourceLine" id="cb197-9" title="9"></a>
<a class="sourceLine" id="cb197-10" title="10"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb197-11" title="11">  d <span class="op">=</span> <span class="dv">2</span><span class="op">*</span>a<span class="op">*</span>x <span class="op">+</span> b</a>
<a class="sourceLine" id="cb197-12" title="12">  <span class="cf">return</span> d</a>
<a class="sourceLine" id="cb197-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb197-14" title="14"></a>
<a class="sourceLine" id="cb197-15" title="15">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> find_derivative(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">2</span>) <span class="op">==</span> <span class="dv">6</span> <span class="cf">else</span> <span class="va">False</span> </a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>derivative_2deg</summary></p>
<h4 id="query-18">Query</h4>
<div class="sourceCode" id="cb199"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb199-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb199-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb199-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb199-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb199-5" title="5"></a>
<a class="sourceLine" id="cb199-6" title="6"><span class="kw">def</span> find_derivative(a,b,c,x):</a>
<a class="sourceLine" id="cb199-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb199-8" title="8"><span class="co">  This function generates a 2nd degree polynomial with coefficients a,b,c and return derivative at x</span></a>
<a class="sourceLine" id="cb199-9" title="9"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb199-10" title="10">  [insert]</a>
<a class="sourceLine" id="cb199-11" title="11">  <span class="cf">return</span> deriv</a></code></pre></div>
<h4 id="run-0-18">Run 0</h4>
<div class="sourceCode" id="cb200"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb200-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb200-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb200-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb200-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb200-5" title="5"></a>
<a class="sourceLine" id="cb200-6" title="6"><span class="kw">def</span> find_derivative(a,b,c,x):</a>
<a class="sourceLine" id="cb200-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb200-8" title="8"><span class="co">  This function generates a 2nd degree polynomial with coefficients a,b,c and return derivative at x</span></a>
<a class="sourceLine" id="cb200-9" title="9"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb200-10" title="10">  deriv <span class="op">=</span> <span class="dv">2</span><span class="op">*</span>a<span class="op">*</span>x <span class="op">+</span> b</a>
<a class="sourceLine" id="cb200-11" title="11">  <span class="cf">return</span> deriv</a>
<a class="sourceLine" id="cb200-12" title="12"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb200-13" title="13"></a>
<a class="sourceLine" id="cb200-14" title="14">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> find_derivative(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">2</span>) <span class="op">==</span> <span class="dv">6</span> <span class="cf">else</span> <span class="va">False</span> </a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-18">Run 1</h4>
<div class="sourceCode" id="cb202"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb202-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb202-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb202-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb202-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb202-5" title="5"></a>
<a class="sourceLine" id="cb202-6" title="6"><span class="kw">def</span> find_derivative(a,b,c,x):</a>
<a class="sourceLine" id="cb202-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb202-8" title="8"><span class="co">  This function generates a 2nd degree polynomial with coefficients a,b,c and return derivative at x</span></a>
<a class="sourceLine" id="cb202-9" title="9"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb202-10" title="10">  deriv <span class="op">=</span> <span class="dv">2</span><span class="op">*</span>a<span class="op">*</span>x <span class="op">+</span> b</a>
<a class="sourceLine" id="cb202-11" title="11">  <span class="cf">return</span> deriv</a>
<a class="sourceLine" id="cb202-12" title="12"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb202-13" title="13"></a>
<a class="sourceLine" id="cb202-14" title="14">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> find_derivative(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">2</span>) <span class="op">==</span> <span class="dv">6</span> <span class="cf">else</span> <span class="va">False</span> </a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-18">Run 2</h4>
<div class="sourceCode" id="cb204"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb204-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb204-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb204-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb204-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb204-5" title="5"></a>
<a class="sourceLine" id="cb204-6" title="6"><span class="kw">def</span> find_derivative(a,b,c,x):</a>
<a class="sourceLine" id="cb204-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb204-8" title="8"><span class="co">  This function generates a 2nd degree polynomial with coefficients a,b,c and return derivative at x</span></a>
<a class="sourceLine" id="cb204-9" title="9"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb204-10" title="10">  deriv <span class="op">=</span> <span class="dv">2</span><span class="op">*</span>a<span class="op">*</span>x <span class="op">+</span> b</a>
<a class="sourceLine" id="cb204-11" title="11">  <span class="cf">return</span> deriv</a>
<a class="sourceLine" id="cb204-12" title="12"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb204-13" title="13"></a>
<a class="sourceLine" id="cb204-14" title="14">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> find_derivative(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">2</span>) <span class="op">==</span> <span class="dv">6</span> <span class="cf">else</span> <span class="va">False</span> </a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-18">Run 3</h4>
<div class="sourceCode" id="cb206"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb206-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb206-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb206-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb206-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb206-5" title="5"></a>
<a class="sourceLine" id="cb206-6" title="6"><span class="kw">def</span> find_derivative(a,b,c,x):</a>
<a class="sourceLine" id="cb206-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb206-8" title="8"><span class="co">  This function generates a 2nd degree polynomial with coefficients a,b,c and return derivative at x</span></a>
<a class="sourceLine" id="cb206-9" title="9"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb206-10" title="10">  deriv <span class="op">=</span> <span class="dv">2</span><span class="op">*</span>a<span class="op">*</span>x <span class="op">+</span> b</a>
<a class="sourceLine" id="cb206-11" title="11">  <span class="cf">return</span> deriv</a>
<a class="sourceLine" id="cb206-12" title="12"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb206-13" title="13"></a>
<a class="sourceLine" id="cb206-14" title="14">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> find_derivative(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">2</span>) <span class="op">==</span> <span class="dv">6</span> <span class="cf">else</span> <span class="va">False</span> </a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-18">Run 4</h4>
<div class="sourceCode" id="cb208"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb208-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb208-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb208-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb208-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb208-5" title="5"></a>
<a class="sourceLine" id="cb208-6" title="6"><span class="kw">def</span> find_derivative(a,b,c,x):</a>
<a class="sourceLine" id="cb208-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb208-8" title="8"><span class="co">  This function generates a 2nd degree polynomial with coefficients a,b,c and return derivative at x</span></a>
<a class="sourceLine" id="cb208-9" title="9"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb208-10" title="10">  deriv <span class="op">=</span> <span class="dv">2</span><span class="op">*</span>a<span class="op">*</span>x <span class="op">+</span> b</a>
<a class="sourceLine" id="cb208-11" title="11">  <span class="cf">return</span> deriv</a>
<a class="sourceLine" id="cb208-12" title="12"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb208-13" title="13"></a>
<a class="sourceLine" id="cb208-14" title="14">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> find_derivative(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">2</span>) <span class="op">==</span> <span class="dv">6</span> <span class="cf">else</span> <span class="va">False</span> </a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>descriptors</summary></p>
<h4 id="query-19">Query</h4>
<div class="sourceCode" id="cb210"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb210-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb210-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb210-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb210-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb210-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb210-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb210-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb210-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb210-9" title="9"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb210-10" title="10"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb210-11" title="11"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb210-12" title="12"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb210-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb210-14" title="14"></a>
<a class="sourceLine" id="cb210-15" title="15"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb210-16" title="16"></a>
<a class="sourceLine" id="cb210-17" title="17"><span class="kw">def</span> get_descriptors(smiles_list):</a>
<a class="sourceLine" id="cb210-18" title="18">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb210-19" title="19"><span class="co">    Returns an N x 8 matrix of descriptors for given SMILEs</span></a>
<a class="sourceLine" id="cb210-20" title="20"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb210-21" title="21">    [insert]</a>
<a class="sourceLine" id="cb210-22" title="22">    <span class="cf">return</span> descriptors</a></code></pre></div>
<h4 id="run-0-19">Run 0</h4>
<div class="sourceCode" id="cb211"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb211-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb211-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb211-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb211-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb211-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb211-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb211-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb211-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb211-9" title="9"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb211-10" title="10"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb211-11" title="11"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb211-12" title="12"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb211-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb211-14" title="14"></a>
<a class="sourceLine" id="cb211-15" title="15"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb211-16" title="16"></a>
<a class="sourceLine" id="cb211-17" title="17"><span class="kw">def</span> get_descriptors(smiles_list):</a>
<a class="sourceLine" id="cb211-18" title="18">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb211-19" title="19"><span class="co">    Returns an N x 8 matrix of descriptors for given SMILEs</span></a>
<a class="sourceLine" id="cb211-20" title="20"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb211-21" title="21">    descriptors <span class="op">=</span> []</a>
<a class="sourceLine" id="cb211-22" title="22">    <span class="cf">for</span> smiles <span class="kw">in</span> smiles_list:</a>
<a class="sourceLine" id="cb211-23" title="23">        mol <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb211-24" title="24">        descriptors.append(np.array(MoleculeDescriptors.MolecularDescriptorCalculator([x[<span class="dv">0</span>] <span class="cf">for</span> x <span class="kw">in</span> Descriptors._descList]).CalcDescriptors(mol)))</a>
<a class="sourceLine" id="cb211-25" title="25">    descriptors <span class="op">=</span> np.array(descriptors)</a>
<a class="sourceLine" id="cb211-26" title="26">    <span class="cf">return</span> descriptors</a>
<a class="sourceLine" id="cb211-27" title="27">s <span class="op">=</span> [<span class="st">&#39;CC=O&#39;</span>, <span class="st">&#39;CC=C=C(C(=O)N)&#39;</span>]</a>
<a class="sourceLine" id="cb211-28" title="28">v <span class="op">=</span> get_descriptors(s)</a>
<a class="sourceLine" id="cb211-29" title="29">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.shape(v) <span class="op">==</span> (<span class="dv">2</span>, <span class="dv">8</span>) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-19">Run 1</h4>
<div class="sourceCode" id="cb213"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb213-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb213-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb213-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb213-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb213-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb213-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb213-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb213-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb213-9" title="9"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb213-10" title="10"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb213-11" title="11"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb213-12" title="12"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb213-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb213-14" title="14"></a>
<a class="sourceLine" id="cb213-15" title="15"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb213-16" title="16"></a>
<a class="sourceLine" id="cb213-17" title="17"><span class="kw">def</span> get_descriptors(smiles_list):</a>
<a class="sourceLine" id="cb213-18" title="18">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb213-19" title="19"><span class="co">    Returns an N x 8 matrix of descriptors for given SMILEs</span></a>
<a class="sourceLine" id="cb213-20" title="20"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb213-21" title="21">    descriptors <span class="op">=</span> []</a>
<a class="sourceLine" id="cb213-22" title="22">    <span class="cf">for</span> smiles <span class="kw">in</span> smiles_list:</a>
<a class="sourceLine" id="cb213-23" title="23">        mol <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb213-24" title="24">        descriptors.append(MoleculeDescriptors.MolecularDescriptorCalculator([x[<span class="dv">0</span>] <span class="cf">for</span> x <span class="kw">in</span> Descriptors._descList]).CalcDescriptors(mol))</a>
<a class="sourceLine" id="cb213-25" title="25">    descriptors <span class="op">=</span> np.array(descriptors)</a>
<a class="sourceLine" id="cb213-26" title="26">    <span class="cf">return</span> descriptors</a>
<a class="sourceLine" id="cb213-27" title="27">s <span class="op">=</span> [<span class="st">&#39;CC=O&#39;</span>, <span class="st">&#39;CC=C=C(C(=O)N)&#39;</span>]</a>
<a class="sourceLine" id="cb213-28" title="28">v <span class="op">=</span> get_descriptors(s)</a>
<a class="sourceLine" id="cb213-29" title="29">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.shape(v) <span class="op">==</span> (<span class="dv">2</span>, <span class="dv">8</span>) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-19">Run 2</h4>
<div class="sourceCode" id="cb215"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb215-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb215-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb215-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb215-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb215-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb215-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb215-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb215-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb215-9" title="9"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb215-10" title="10"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb215-11" title="11"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb215-12" title="12"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb215-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb215-14" title="14"></a>
<a class="sourceLine" id="cb215-15" title="15"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb215-16" title="16"></a>
<a class="sourceLine" id="cb215-17" title="17"><span class="kw">def</span> get_descriptors(smiles_list):</a>
<a class="sourceLine" id="cb215-18" title="18">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb215-19" title="19"><span class="co">    Returns an N x 8 matrix of descriptors for given SMILEs</span></a>
<a class="sourceLine" id="cb215-20" title="20"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb215-21" title="21">    descriptors <span class="op">=</span> []</a>
<a class="sourceLine" id="cb215-22" title="22">    <span class="cf">for</span> smiles <span class="kw">in</span> smiles_list:</a>
<a class="sourceLine" id="cb215-23" title="23">        mol <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb215-24" title="24">        descriptors.append(np.array(MoleculeDescriptors.MolecularDescriptorCalculator([x[<span class="dv">0</span>] <span class="cf">for</span> x <span class="kw">in</span> Descriptors._descList]).CalcDescriptors(mol)))</a>
<a class="sourceLine" id="cb215-25" title="25">    descriptors <span class="op">=</span> np.array(descriptors)</a>
<a class="sourceLine" id="cb215-26" title="26">    <span class="cf">return</span> descriptors</a>
<a class="sourceLine" id="cb215-27" title="27">s <span class="op">=</span> [<span class="st">&#39;CC=O&#39;</span>, <span class="st">&#39;CC=C=C(C(=O)N)&#39;</span>]</a>
<a class="sourceLine" id="cb215-28" title="28">v <span class="op">=</span> get_descriptors(s)</a>
<a class="sourceLine" id="cb215-29" title="29">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.shape(v) <span class="op">==</span> (<span class="dv">2</span>, <span class="dv">8</span>) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-19">Run 3</h4>
<div class="sourceCode" id="cb217"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb217-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb217-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb217-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb217-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb217-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb217-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb217-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb217-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb217-9" title="9"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb217-10" title="10"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb217-11" title="11"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb217-12" title="12"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb217-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb217-14" title="14"></a>
<a class="sourceLine" id="cb217-15" title="15"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb217-16" title="16"></a>
<a class="sourceLine" id="cb217-17" title="17"><span class="kw">def</span> get_descriptors(smiles_list):</a>
<a class="sourceLine" id="cb217-18" title="18">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb217-19" title="19"><span class="co">    Returns an N x 8 matrix of descriptors for given SMILEs</span></a>
<a class="sourceLine" id="cb217-20" title="20"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb217-21" title="21">    descriptors <span class="op">=</span> []</a>
<a class="sourceLine" id="cb217-22" title="22">    <span class="cf">for</span> smiles <span class="kw">in</span> smiles_list:</a>
<a class="sourceLine" id="cb217-23" title="23">        mol <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb217-24" title="24">        descriptors.append(np.array(MoleculeDescriptors.MolecularDescriptorCalculator([x[<span class="dv">0</span>] <span class="cf">for</span> x <span class="kw">in</span> Descriptors._descList]).CalcDescriptors(mol)))</a>
<a class="sourceLine" id="cb217-25" title="25">    descriptors <span class="op">=</span> np.array(descriptors)</a>
<a class="sourceLine" id="cb217-26" title="26">    <span class="cf">return</span> descriptors</a>
<a class="sourceLine" id="cb217-27" title="27">s <span class="op">=</span> [<span class="st">&#39;CC=O&#39;</span>, <span class="st">&#39;CC=C=C(C(=O)N)&#39;</span>]</a>
<a class="sourceLine" id="cb217-28" title="28">v <span class="op">=</span> get_descriptors(s)</a>
<a class="sourceLine" id="cb217-29" title="29">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.shape(v) <span class="op">==</span> (<span class="dv">2</span>, <span class="dv">8</span>) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-19">Run 4</h4>
<div class="sourceCode" id="cb219"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb219-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb219-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb219-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb219-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb219-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb219-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb219-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb219-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb219-9" title="9"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb219-10" title="10"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb219-11" title="11"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb219-12" title="12"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb219-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb219-14" title="14"></a>
<a class="sourceLine" id="cb219-15" title="15"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb219-16" title="16"></a>
<a class="sourceLine" id="cb219-17" title="17"><span class="kw">def</span> get_descriptors(smiles_list):</a>
<a class="sourceLine" id="cb219-18" title="18">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb219-19" title="19"><span class="co">    Returns an N x 8 matrix of descriptors for given SMILEs</span></a>
<a class="sourceLine" id="cb219-20" title="20"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb219-21" title="21">    descriptors <span class="op">=</span> []</a>
<a class="sourceLine" id="cb219-22" title="22">    <span class="cf">for</span> smiles <span class="kw">in</span> smiles_list:</a>
<a class="sourceLine" id="cb219-23" title="23">        mol <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb219-24" title="24">        descriptors.append([</a>
<a class="sourceLine" id="cb219-25" title="25">            Descriptors.MolWt(mol),</a>
<a class="sourceLine" id="cb219-26" title="26">            Descriptors.MolLogP(mol),</a>
<a class="sourceLine" id="cb219-27" title="27">            Descriptors.TPSA(mol),</a>
<a class="sourceLine" id="cb219-28" title="28">            Descriptors.NumHDonors(mol),</a>
<a class="sourceLine" id="cb219-29" title="29">            Descriptors.NumHAcceptors(mol),</a>
<a class="sourceLine" id="cb219-30" title="30">            Descriptors.NumRotatableBonds(mol),</a>
<a class="sourceLine" id="cb219-31" title="31">            Descriptors.NumAromaticRings(mol),</a>
<a class="sourceLine" id="cb219-32" title="32">            Descriptors.NumSaturatedRings(mol)</a>
<a class="sourceLine" id="cb219-33" title="33">        ])</a>
<a class="sourceLine" id="cb219-34" title="34">    descriptors <span class="op">=</span> np.array(descriptors)</a>
<a class="sourceLine" id="cb219-35" title="35">    <span class="cf">return</span> descriptors</a>
<a class="sourceLine" id="cb219-36" title="36">s <span class="op">=</span> [<span class="st">&#39;CC=O&#39;</span>, <span class="st">&#39;CC=C=C(C(=O)N)&#39;</span>]</a>
<a class="sourceLine" id="cb219-37" title="37">v <span class="op">=</span> get_descriptors(s)</a>
<a class="sourceLine" id="cb219-38" title="38">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.shape(v) <span class="op">==</span> (<span class="dv">2</span>, <span class="dv">8</span>) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>dipole</summary></p>
<h4 id="query-20">Query</h4>
<div class="sourceCode" id="cb221"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb221-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb221-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb221-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb221-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb221-5" title="5"></a>
<a class="sourceLine" id="cb221-6" title="6"><span class="kw">def</span> dipole_moment(coordinates, charges):</a>
<a class="sourceLine" id="cb221-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb221-8" title="8"><span class="co">  This function returns the dipole moment of a molecule</span></a>
<a class="sourceLine" id="cb221-9" title="9"></a>
<a class="sourceLine" id="cb221-10" title="10"><span class="co">  Coordinates is a numpy array of size Nx3</span></a>
<a class="sourceLine" id="cb221-11" title="11"><span class="co">  Charges is a numpy array of size N</span></a>
<a class="sourceLine" id="cb221-12" title="12"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb221-13" title="13">  [insert]</a>
<a class="sourceLine" id="cb221-14" title="14">  <span class="cf">return</span> dipole_moment</a></code></pre></div>
<h4 id="run-0-20">Run 0</h4>
<div class="sourceCode" id="cb222"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb222-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb222-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb222-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb222-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb222-5" title="5"></a>
<a class="sourceLine" id="cb222-6" title="6"><span class="kw">def</span> dipole_moment(coordinates, charges):</a>
<a class="sourceLine" id="cb222-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb222-8" title="8"><span class="co">  This function returns the dipole moment of a molecule</span></a>
<a class="sourceLine" id="cb222-9" title="9"></a>
<a class="sourceLine" id="cb222-10" title="10"><span class="co">  Coordinates is a numpy array of size Nx3</span></a>
<a class="sourceLine" id="cb222-11" title="11"><span class="co">  Charges is a numpy array of size N</span></a>
<a class="sourceLine" id="cb222-12" title="12"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb222-13" title="13">  dipole_moment <span class="op">=</span> np.<span class="bu">sum</span>(coordinates<span class="op">*</span>charges[:,np.newaxis], axis<span class="op">=</span><span class="dv">0</span>)</a>
<a class="sourceLine" id="cb222-14" title="14">  <span class="cf">return</span> dipole_moment</a>
<a class="sourceLine" id="cb222-15" title="15"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb222-16" title="16"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb222-17" title="17">coordinates <span class="op">=</span> np.loadtxt(os.path.join(_FILE_DIR_,<span class="st">&quot;water.xyz&quot;</span>),usecols<span class="op">=</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>))</a>
<a class="sourceLine" id="cb222-18" title="18"><span class="co">#note, these are fake</span></a>
<a class="sourceLine" id="cb222-19" title="19">charges <span class="op">=</span> np.loadtxt(os.path.join(_FILE_DIR_,<span class="st">&quot;charges.txt&quot;</span>))</a>
<a class="sourceLine" id="cb222-20" title="20">my_dipole <span class="op">=</span> (coordinates.T<span class="op">*</span>charges).<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb222-21" title="21">nl_dipole <span class="op">=</span> dipole_moment(coordinates,charges) </a>
<a class="sourceLine" id="cb222-22" title="22"></a>
<a class="sourceLine" id="cb222-23" title="23"><span class="co">#print(&quot;My result:&quot;,my_dipole)</span></a>
<a class="sourceLine" id="cb222-24" title="24"><span class="co">#print(&quot;NL result:&quot;,nl_dipole)</span></a>
<a class="sourceLine" id="cb222-25" title="25">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">all</span>(np.<span class="bu">abs</span>( my_dipole <span class="op">-</span> nl_dipole )<span class="op">&lt;</span><span class="fl">0.01</span>) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-20">Run 1</h4>
<div class="sourceCode" id="cb224"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb224-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb224-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb224-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb224-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb224-5" title="5"></a>
<a class="sourceLine" id="cb224-6" title="6"><span class="kw">def</span> dipole_moment(coordinates, charges):</a>
<a class="sourceLine" id="cb224-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb224-8" title="8"><span class="co">  This function returns the dipole moment of a molecule</span></a>
<a class="sourceLine" id="cb224-9" title="9"></a>
<a class="sourceLine" id="cb224-10" title="10"><span class="co">  Coordinates is a numpy array of size Nx3</span></a>
<a class="sourceLine" id="cb224-11" title="11"><span class="co">  Charges is a numpy array of size N</span></a>
<a class="sourceLine" id="cb224-12" title="12"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb224-13" title="13">  dipole_moment <span class="op">=</span> np.zeros(<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb224-14" title="14">  <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(charges)):</a>
<a class="sourceLine" id="cb224-15" title="15">    dipole_moment <span class="op">+=</span> charges[i] <span class="op">*</span> coordinates[i]</a>
<a class="sourceLine" id="cb224-16" title="16">  <span class="cf">return</span> dipole_moment</a>
<a class="sourceLine" id="cb224-17" title="17"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb224-18" title="18"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb224-19" title="19">coordinates <span class="op">=</span> np.loadtxt(os.path.join(_FILE_DIR_,<span class="st">&quot;water.xyz&quot;</span>),usecols<span class="op">=</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>))</a>
<a class="sourceLine" id="cb224-20" title="20"><span class="co">#note, these are fake</span></a>
<a class="sourceLine" id="cb224-21" title="21">charges <span class="op">=</span> np.loadtxt(os.path.join(_FILE_DIR_,<span class="st">&quot;charges.txt&quot;</span>))</a>
<a class="sourceLine" id="cb224-22" title="22">my_dipole <span class="op">=</span> (coordinates.T<span class="op">*</span>charges).<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb224-23" title="23">nl_dipole <span class="op">=</span> dipole_moment(coordinates,charges) </a>
<a class="sourceLine" id="cb224-24" title="24"></a>
<a class="sourceLine" id="cb224-25" title="25"><span class="co">#print(&quot;My result:&quot;,my_dipole)</span></a>
<a class="sourceLine" id="cb224-26" title="26"><span class="co">#print(&quot;NL result:&quot;,nl_dipole)</span></a>
<a class="sourceLine" id="cb224-27" title="27">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">all</span>(np.<span class="bu">abs</span>( my_dipole <span class="op">-</span> nl_dipole )<span class="op">&lt;</span><span class="fl">0.01</span>) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-20">Run 2</h4>
<div class="sourceCode" id="cb226"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb226-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb226-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb226-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb226-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb226-5" title="5"></a>
<a class="sourceLine" id="cb226-6" title="6"><span class="kw">def</span> dipole_moment(coordinates, charges):</a>
<a class="sourceLine" id="cb226-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb226-8" title="8"><span class="co">  This function returns the dipole moment of a molecule</span></a>
<a class="sourceLine" id="cb226-9" title="9"></a>
<a class="sourceLine" id="cb226-10" title="10"><span class="co">  Coordinates is a numpy array of size Nx3</span></a>
<a class="sourceLine" id="cb226-11" title="11"><span class="co">  Charges is a numpy array of size N</span></a>
<a class="sourceLine" id="cb226-12" title="12"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb226-13" title="13">  dipole_moment <span class="op">=</span> np.zeros(<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb226-14" title="14">  <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(charges)):</a>
<a class="sourceLine" id="cb226-15" title="15">    dipole_moment <span class="op">+=</span> charges[i] <span class="op">*</span> coordinates[i]</a>
<a class="sourceLine" id="cb226-16" title="16"></a>
<a class="sourceLine" id="cb226-17" title="17">  <span class="cf">return</span> dipole_moment</a>
<a class="sourceLine" id="cb226-18" title="18"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb226-19" title="19"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb226-20" title="20">coordinates <span class="op">=</span> np.loadtxt(os.path.join(_FILE_DIR_,<span class="st">&quot;water.xyz&quot;</span>),usecols<span class="op">=</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>))</a>
<a class="sourceLine" id="cb226-21" title="21"><span class="co">#note, these are fake</span></a>
<a class="sourceLine" id="cb226-22" title="22">charges <span class="op">=</span> np.loadtxt(os.path.join(_FILE_DIR_,<span class="st">&quot;charges.txt&quot;</span>))</a>
<a class="sourceLine" id="cb226-23" title="23">my_dipole <span class="op">=</span> (coordinates.T<span class="op">*</span>charges).<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb226-24" title="24">nl_dipole <span class="op">=</span> dipole_moment(coordinates,charges) </a>
<a class="sourceLine" id="cb226-25" title="25"></a>
<a class="sourceLine" id="cb226-26" title="26"><span class="co">#print(&quot;My result:&quot;,my_dipole)</span></a>
<a class="sourceLine" id="cb226-27" title="27"><span class="co">#print(&quot;NL result:&quot;,nl_dipole)</span></a>
<a class="sourceLine" id="cb226-28" title="28">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">all</span>(np.<span class="bu">abs</span>( my_dipole <span class="op">-</span> nl_dipole )<span class="op">&lt;</span><span class="fl">0.01</span>) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-20">Run 3</h4>
<div class="sourceCode" id="cb228"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb228-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb228-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb228-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb228-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb228-5" title="5"></a>
<a class="sourceLine" id="cb228-6" title="6"><span class="kw">def</span> dipole_moment(coordinates, charges):</a>
<a class="sourceLine" id="cb228-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb228-8" title="8"><span class="co">  This function returns the dipole moment of a molecule</span></a>
<a class="sourceLine" id="cb228-9" title="9"></a>
<a class="sourceLine" id="cb228-10" title="10"><span class="co">  Coordinates is a numpy array of size Nx3</span></a>
<a class="sourceLine" id="cb228-11" title="11"><span class="co">  Charges is a numpy array of size N</span></a>
<a class="sourceLine" id="cb228-12" title="12"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb228-13" title="13">  dipole_moment <span class="op">=</span> np.zeros(<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb228-14" title="14">  <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(charges)):</a>
<a class="sourceLine" id="cb228-15" title="15">    dipole_moment <span class="op">+=</span> charges[i] <span class="op">*</span> coordinates[i]</a>
<a class="sourceLine" id="cb228-16" title="16"></a>
<a class="sourceLine" id="cb228-17" title="17">  <span class="cf">return</span> dipole_moment</a>
<a class="sourceLine" id="cb228-18" title="18"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb228-19" title="19"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb228-20" title="20">coordinates <span class="op">=</span> np.loadtxt(os.path.join(_FILE_DIR_,<span class="st">&quot;water.xyz&quot;</span>),usecols<span class="op">=</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>))</a>
<a class="sourceLine" id="cb228-21" title="21"><span class="co">#note, these are fake</span></a>
<a class="sourceLine" id="cb228-22" title="22">charges <span class="op">=</span> np.loadtxt(os.path.join(_FILE_DIR_,<span class="st">&quot;charges.txt&quot;</span>))</a>
<a class="sourceLine" id="cb228-23" title="23">my_dipole <span class="op">=</span> (coordinates.T<span class="op">*</span>charges).<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb228-24" title="24">nl_dipole <span class="op">=</span> dipole_moment(coordinates,charges) </a>
<a class="sourceLine" id="cb228-25" title="25"></a>
<a class="sourceLine" id="cb228-26" title="26"><span class="co">#print(&quot;My result:&quot;,my_dipole)</span></a>
<a class="sourceLine" id="cb228-27" title="27"><span class="co">#print(&quot;NL result:&quot;,nl_dipole)</span></a>
<a class="sourceLine" id="cb228-28" title="28">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">all</span>(np.<span class="bu">abs</span>( my_dipole <span class="op">-</span> nl_dipole )<span class="op">&lt;</span><span class="fl">0.01</span>) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-20">Run 4</h4>
<div class="sourceCode" id="cb230"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb230-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb230-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb230-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb230-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb230-5" title="5"></a>
<a class="sourceLine" id="cb230-6" title="6"><span class="kw">def</span> dipole_moment(coordinates, charges):</a>
<a class="sourceLine" id="cb230-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb230-8" title="8"><span class="co">  This function returns the dipole moment of a molecule</span></a>
<a class="sourceLine" id="cb230-9" title="9"></a>
<a class="sourceLine" id="cb230-10" title="10"><span class="co">  Coordinates is a numpy array of size Nx3</span></a>
<a class="sourceLine" id="cb230-11" title="11"><span class="co">  Charges is a numpy array of size N</span></a>
<a class="sourceLine" id="cb230-12" title="12"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb230-13" title="13">  dipole_moment <span class="op">=</span> np.zeros(<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb230-14" title="14">  <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(charges)):</a>
<a class="sourceLine" id="cb230-15" title="15">    dipole_moment <span class="op">+=</span> charges[i]<span class="op">*</span>coordinates[i]</a>
<a class="sourceLine" id="cb230-16" title="16"></a>
<a class="sourceLine" id="cb230-17" title="17">  <span class="cf">return</span> dipole_moment</a>
<a class="sourceLine" id="cb230-18" title="18"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb230-19" title="19"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb230-20" title="20">coordinates <span class="op">=</span> np.loadtxt(os.path.join(_FILE_DIR_,<span class="st">&quot;water.xyz&quot;</span>),usecols<span class="op">=</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>))</a>
<a class="sourceLine" id="cb230-21" title="21"><span class="co">#note, these are fake</span></a>
<a class="sourceLine" id="cb230-22" title="22">charges <span class="op">=</span> np.loadtxt(os.path.join(_FILE_DIR_,<span class="st">&quot;charges.txt&quot;</span>))</a>
<a class="sourceLine" id="cb230-23" title="23">my_dipole <span class="op">=</span> (coordinates.T<span class="op">*</span>charges).<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb230-24" title="24">nl_dipole <span class="op">=</span> dipole_moment(coordinates,charges) </a>
<a class="sourceLine" id="cb230-25" title="25"></a>
<a class="sourceLine" id="cb230-26" title="26"><span class="co">#print(&quot;My result:&quot;,my_dipole)</span></a>
<a class="sourceLine" id="cb230-27" title="27"><span class="co">#print(&quot;NL result:&quot;,nl_dipole)</span></a>
<a class="sourceLine" id="cb230-28" title="28">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">all</span>(np.<span class="bu">abs</span>( my_dipole <span class="op">-</span> nl_dipole )<span class="op">&lt;</span><span class="fl">0.01</span>) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>dou</summary></p>
<h4 id="query-21">Query</h4>
<div class="sourceCode" id="cb232"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb232-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb232-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb232-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb232-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb232-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb232-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb232-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb232-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb232-9" title="9"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb232-10" title="10"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb232-11" title="11"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb232-12" title="12"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb232-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb232-14" title="14"></a>
<a class="sourceLine" id="cb232-15" title="15"><span class="kw">def</span> calc_rdbs(smiles):</a>
<a class="sourceLine" id="cb232-16" title="16">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb232-17" title="17"><span class="co">    Return degrees of unsaturation (Double Bond Equivalent) from C, N, H, Halogen count.</span></a>
<a class="sourceLine" id="cb232-18" title="18"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb232-19" title="19">    [insert]</a>
<a class="sourceLine" id="cb232-20" title="20">    <span class="cf">return</span> d</a></code></pre></div>
<h4 id="run-0-21">Run 0</h4>
<div class="sourceCode" id="cb233"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb233-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb233-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb233-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb233-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb233-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb233-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb233-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb233-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb233-9" title="9"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb233-10" title="10"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb233-11" title="11"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb233-12" title="12"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb233-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb233-14" title="14"></a>
<a class="sourceLine" id="cb233-15" title="15"><span class="kw">def</span> calc_rdbs(smiles):</a>
<a class="sourceLine" id="cb233-16" title="16">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb233-17" title="17"><span class="co">    Return degrees of unsaturation (Double Bond Equivalent) from C, N, H, Halogen count.</span></a>
<a class="sourceLine" id="cb233-18" title="18"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb233-19" title="19">    mol <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb233-20" title="20">    <span class="cf">if</span> mol <span class="kw">is</span> <span class="va">None</span>:</a>
<a class="sourceLine" id="cb233-21" title="21">        <span class="cf">return</span> <span class="va">None</span></a>
<a class="sourceLine" id="cb233-22" title="22">    d <span class="op">=</span> Descriptors.NumRadicalElectrons(mol)</a>
<a class="sourceLine" id="cb233-23" title="23">    d <span class="op">+=</span> Descriptors.NumValenceElectrons(mol)</a>
<a class="sourceLine" id="cb233-24" title="24">    d <span class="op">-=</span> Descriptors.ExactMolWt(mol)</a>
<a class="sourceLine" id="cb233-25" title="25">    d <span class="op">-=</span> Descriptors.MolLogP(mol)</a>
<a class="sourceLine" id="cb233-26" title="26">    d <span class="op">-=</span> Descriptors.NumHDonors(mol)</a>
<a class="sourceLine" id="cb233-27" title="27">    d <span class="op">-=</span> Descriptors.NumHAcceptors(mol)</a>
<a class="sourceLine" id="cb233-28" title="28">    d <span class="op">-=</span> Descriptors.NumHeteroatoms(mol)</a>
<a class="sourceLine" id="cb233-29" title="29">    d <span class="op">-=</span> Descriptors.NumRotatableBonds(mol)</a>
<a class="sourceLine" id="cb233-30" title="30">    d <span class="op">-=</span> Descriptors.NumAromaticRings(mol)</a>
<a class="sourceLine" id="cb233-31" title="31">    d <span class="op">-=</span> Descriptors.NumAliphaticRings(mol)</a>
<a class="sourceLine" id="cb233-32" title="32">    d <span class="op">-=</span> Descriptors.NumSaturatedRings(mol)</a>
<a class="sourceLine" id="cb233-33" title="33">    d <span class="op">-=</span> Descriptors.NumAliphaticHeterocycles(mol)</a>
<a class="sourceLine" id="cb233-34" title="34">    d <span class="op">-=</span> Descriptors.NumAliphaticCarbocycles(mol)</a>
<a class="sourceLine" id="cb233-35" title="35">    d <span class="op">-=</span> Descriptors.NumAromaticHeterocycles(mol)</a>
<a class="sourceLine" id="cb233-36" title="36">    d <span class="op">-=</span> Descriptors.NumAromaticCarbocycles(mol)</a>
<a class="sourceLine" id="cb233-37" title="37">    d <span class="op">-=</span> Descriptors.NumHeterocycles(mol)</a>
<a class="sourceLine" id="cb233-38" title="38">    d <span class="op">-=</span> Descriptors.NumCarbocycles(mol)</a>
<a class="sourceLine" id="cb233-39" title="39">    d <span class="op">-=</span> Descriptors.NumAromaticAtoms(mol)</a>
<a class="sourceLine" id="cb233-40" title="40">    d <span class="op">-=</span> Descriptors.NumAliphaticAtoms(mol)</a>
<a class="sourceLine" id="cb233-41" title="41">    d <span class="op">-=</span> Descriptors.NumSaturatedAtoms(mol)</a>
<a class="sourceLine" id="cb233-42" title="42">    d <span class="op">-=</span> Descriptors.NumAliphaticHeteroatoms(mol)</a>
<a class="sourceLine" id="cb233-43" title="43">    d <span class="op">-=</span> Descriptors.NumAliphaticCarboAtoms(mol)</a>
<a class="sourceLine" id="cb233-44" title="44">    d <span class="op">-=</span> Descriptors.NumAromaticHeteroatoms(mol)</a>
<a class="sourceLine" id="cb233-45" title="45">    d <span class="op">-=</span> Descriptors.NumAromaticCarboAtoms(mol)</a>
<a class="sourceLine" id="cb233-46" title="46">    d <span class="op">-=</span> Descriptors.NumHeteroatoms(mol)</a>
<a class="sourceLine" id="cb233-47" title="47">    d <span class="op">-=</span> Descriptors.NumCarboAtoms(mol)</a>
<a class="sourceLine" id="cb233-48" title="48">    d <span class="op">-=</span> Descriptors.NumSpiroAtoms(mol)</a>
<a class="sourceLine" id="cb233-49" title="49">    d <span class="op">-=</span> Descriptors.NumBridgeheadAtoms(mol)</a>
<a class="sourceLine" id="cb233-50" title="50">    d <span class="op">-=</span> Descriptors.NumAtoms(mol)</a>
<a class="sourceLine" id="cb233-51" title="51">    d <span class="op">-=</span> Descriptors.NumHeavyAtoms(mol)</a>
<a class="sourceLine" id="cb233-52" title="52">    d <span class="op">-=</span> Descriptors.NumAmideBonds(mol)</a>
<a class="sourceLine" id="cb233-53" title="53">    d <span class="op">-=</span> Descriptors.NumLipinskiHBA(mol)</a>
<a class="sourceLine" id="cb233-54" title="54">    d <span class="op">-=</span> Descriptors.NumLipinskiHBD(mol)</a>
<a class="sourceLine" id="cb233-55" title="55">    d <span class="op">-=</span> Descriptors.NumLipinskiHBA(mol)</a>
<a class="sourceLine" id="cb233-56" title="56">    d <span class="op">-=</span> Descriptors.NumLipinskiHBD(mol)</a>
<a class="sourceLine" id="cb233-57" title="57">    d <span class="op">-=</span> Descriptors.NumLipinskiHBA(mol)</a>
<a class="sourceLine" id="cb233-58" title="58">    d <span class="op">-=</span> Descriptors.NumLipinskiHBD(mol)</a>
<a class="sourceLine" id="cb233-59" title="59">    d <span class="op">-=</span> Descriptors.NumLipinskiHBA(mol)</a>
<a class="sourceLine" id="cb233-60" title="60">    d <span class="op">-=</span> Descriptors.NumLipinskiHBD(mol)</a>
<a class="sourceLine" id="cb233-61" title="61">    d <span class="op">-=</span> Descriptors.NumLipinskiHBA(mol)</a>
<a class="sourceLine" id="cb233-62" title="62">    d <span class="op">-=</span> Descriptors.NumLipinskiHBD(mol)</a>
<a class="sourceLine" id="cb233-63" title="63">    d <span class="op">-=</span> Descriptors.NumLipinskiHBA(mol)</a>
<a class="sourceLine" id="cb233-64" title="64">    d <span class="op">-=</span> Descriptors.NumLipinskiHBD(mol)</a>
<a class="sourceLine" id="cb233-65" title="65">    d <span class="op">-=</span> Descriptors.NumLipinskiHBA(mol)</a>
<a class="sourceLine" id="cb233-66" title="66">    d <span class="op">-=</span> Descriptors.NumLipinskiHBD(mol)</a>
<a class="sourceLine" id="cb233-67" title="67">    d <span class="op">-=</span> Descriptors.NumLipinskiHBA(mol)</a>
<a class="sourceLine" id="cb233-68" title="68">    d <span class="op">-=</span> Descriptors.NumLipinskiHBD(mol)</a>
<a class="sourceLine" id="cb233-69" title="69">    d <span class="op">-=</span> Descriptors.NumLipinskiHBA(mol)</a>
<a class="sourceLine" id="cb233-70" title="70">    d <span class="op">-=</span> Descriptors.NumLipinskiHBD(mol)</a>
<a class="sourceLine" id="cb233-71" title="71">    d <span class="op">-=</span> Descriptors.NumLipinskiHBA(mol)</a>
<a class="sourceLine" id="cb233-72" title="72">    d <span class="op">-=</span> Descriptors.NumLipinskiHBD(mol)</a>
<a class="sourceLine" id="cb233-73" title="73">    d <span class="op">-=</span> Descriptors.NumLip</a>
<a class="sourceLine" id="cb233-74" title="74">    <span class="cf">return</span> d</a>
<a class="sourceLine" id="cb233-75" title="75">d <span class="op">=</span> calc_rdbs(<span class="st">&#39;c1ccccc1&#39;</span>)</a>
<a class="sourceLine" id="cb233-76" title="76"><span class="bu">print</span>(<span class="st">&#39;d = &#39;</span>, d)</a>
<a class="sourceLine" id="cb233-77" title="77">result <span class="op">=</span> d <span class="op">==</span> <span class="dv">4</span></a></code></pre></div>
<p>Output:</p>
<pre><code>module &#39;rdkit.Chem.Descriptors&#39; has no attribute &#39;NumHeterocycles&#39;</code></pre>
<h4 id="run-1-21">Run 1</h4>
<div class="sourceCode" id="cb235"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb235-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb235-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb235-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb235-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb235-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb235-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb235-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb235-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb235-9" title="9"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb235-10" title="10"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb235-11" title="11"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb235-12" title="12"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb235-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb235-14" title="14"></a>
<a class="sourceLine" id="cb235-15" title="15"><span class="kw">def</span> calc_rdbs(smiles):</a>
<a class="sourceLine" id="cb235-16" title="16">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb235-17" title="17"><span class="co">    Return degrees of unsaturation (Double Bond Equivalent) from C, N, H, Halogen count.</span></a>
<a class="sourceLine" id="cb235-18" title="18"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb235-19" title="19">    mol <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb235-20" title="20">    <span class="cf">if</span> mol <span class="kw">is</span> <span class="va">None</span>:</a>
<a class="sourceLine" id="cb235-21" title="21">        <span class="cf">return</span> <span class="va">None</span></a>
<a class="sourceLine" id="cb235-22" title="22">    <span class="cf">else</span>:</a>
<a class="sourceLine" id="cb235-23" title="23">        <span class="cf">return</span> Descriptors.NumRotatableBonds(mol)</a>
<a class="sourceLine" id="cb235-24" title="24"></a>
<a class="sourceLine" id="cb235-25" title="25"></a>
<a class="sourceLine" id="cb235-26" title="26">    <span class="cf">return</span> d</a>
<a class="sourceLine" id="cb235-27" title="27">d <span class="op">=</span> calc_rdbs(<span class="st">&#39;c1ccccc1&#39;</span>)</a>
<a class="sourceLine" id="cb235-28" title="28"><span class="bu">print</span>(<span class="st">&#39;d = &#39;</span>, d)</a>
<a class="sourceLine" id="cb235-29" title="29">result <span class="op">=</span> d <span class="op">==</span> <span class="dv">4</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-21">Run 2</h4>
<div class="sourceCode" id="cb237"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb237-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb237-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb237-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb237-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb237-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb237-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb237-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb237-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb237-9" title="9"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb237-10" title="10"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb237-11" title="11"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb237-12" title="12"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb237-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb237-14" title="14"></a>
<a class="sourceLine" id="cb237-15" title="15"><span class="kw">def</span> calc_rdbs(smiles):</a>
<a class="sourceLine" id="cb237-16" title="16">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb237-17" title="17"><span class="co">    Return degrees of unsaturation (Double Bond Equivalent) from C, N, H, Halogen count.</span></a>
<a class="sourceLine" id="cb237-18" title="18"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb237-19" title="19">    mol <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb237-20" title="20">    <span class="cf">if</span> mol <span class="kw">is</span> <span class="va">None</span>:</a>
<a class="sourceLine" id="cb237-21" title="21">        <span class="cf">return</span> <span class="va">None</span></a>
<a class="sourceLine" id="cb237-22" title="22">    <span class="cf">else</span>:</a>
<a class="sourceLine" id="cb237-23" title="23">        <span class="cf">return</span> Descriptors.NumRotatableBonds(mol)</a>
<a class="sourceLine" id="cb237-24" title="24"></a>
<a class="sourceLine" id="cb237-25" title="25"></a>
<a class="sourceLine" id="cb237-26" title="26">    <span class="cf">return</span> d</a>
<a class="sourceLine" id="cb237-27" title="27">d <span class="op">=</span> calc_rdbs(<span class="st">&#39;c1ccccc1&#39;</span>)</a>
<a class="sourceLine" id="cb237-28" title="28"><span class="bu">print</span>(<span class="st">&#39;d = &#39;</span>, d)</a>
<a class="sourceLine" id="cb237-29" title="29">result <span class="op">=</span> d <span class="op">==</span> <span class="dv">4</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-21">Run 3</h4>
<div class="sourceCode" id="cb239"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb239-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb239-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb239-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb239-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb239-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb239-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb239-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb239-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb239-9" title="9"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb239-10" title="10"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb239-11" title="11"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb239-12" title="12"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb239-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb239-14" title="14"></a>
<a class="sourceLine" id="cb239-15" title="15"><span class="kw">def</span> calc_rdbs(smiles):</a>
<a class="sourceLine" id="cb239-16" title="16">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb239-17" title="17"><span class="co">    Return degrees of unsaturation (Double Bond Equivalent) from C, N, H, Halogen count.</span></a>
<a class="sourceLine" id="cb239-18" title="18"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb239-19" title="19">    mol <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb239-20" title="20">    d <span class="op">=</span> Descriptors.NumRadicalElectrons(mol)</a>
<a class="sourceLine" id="cb239-21" title="21">    <span class="cf">return</span> d</a>
<a class="sourceLine" id="cb239-22" title="22">d <span class="op">=</span> calc_rdbs(<span class="st">&#39;c1ccccc1&#39;</span>)</a>
<a class="sourceLine" id="cb239-23" title="23"><span class="bu">print</span>(<span class="st">&#39;d = &#39;</span>, d)</a>
<a class="sourceLine" id="cb239-24" title="24">result <span class="op">=</span> d <span class="op">==</span> <span class="dv">4</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-21">Run 4</h4>
<div class="sourceCode" id="cb241"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb241-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb241-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb241-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb241-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb241-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb241-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb241-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb241-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb241-9" title="9"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb241-10" title="10"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb241-11" title="11"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb241-12" title="12"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb241-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb241-14" title="14"></a>
<a class="sourceLine" id="cb241-15" title="15"><span class="kw">def</span> calc_rdbs(smiles):</a>
<a class="sourceLine" id="cb241-16" title="16">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb241-17" title="17"><span class="co">    Return degrees of unsaturation (Double Bond Equivalent) from C, N, H, Halogen count.</span></a>
<a class="sourceLine" id="cb241-18" title="18"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb241-19" title="19">    m <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb241-20" title="20">    c <span class="op">=</span> m.GetNumAtoms()</a>
<a class="sourceLine" id="cb241-21" title="21">    n <span class="op">=</span> m.GetNumAtoms(onlyExplicit<span class="op">=</span><span class="va">True</span>, element<span class="op">=</span><span class="dv">7</span>)</a>
<a class="sourceLine" id="cb241-22" title="22">    h <span class="op">=</span> m.GetNumAtoms(onlyExplicit<span class="op">=</span><span class="va">True</span>, element<span class="op">=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb241-23" title="23">    hal <span class="op">=</span> m.GetNumAtoms(onlyExplicit<span class="op">=</span><span class="va">True</span>, element<span class="op">=</span><span class="dv">9</span>) <span class="op">+</span> m.GetNumAtoms(onlyExplicit<span class="op">=</span><span class="va">True</span>, element<span class="op">=</span><span class="dv">17</span>) <span class="op">+</span> m.GetNumAtoms(onlyExplicit<span class="op">=</span><span class="va">True</span>, element<span class="op">=</span><span class="dv">35</span>) <span class="op">+</span> m.GetNumAtoms(onlyExplicit<span class="op">=</span><span class="va">True</span>, element<span class="op">=</span><span class="dv">53</span>)</a>
<a class="sourceLine" id="cb241-24" title="24">    d <span class="op">=</span> (<span class="dv">2</span><span class="op">*</span>n <span class="op">+</span> <span class="dv">2</span> <span class="op">-</span> h <span class="op">+</span> hal)<span class="op">/</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb241-25" title="25">    <span class="cf">return</span> d</a>
<a class="sourceLine" id="cb241-26" title="26">d <span class="op">=</span> calc_rdbs(<span class="st">&#39;c1ccccc1&#39;</span>)</a>
<a class="sourceLine" id="cb241-27" title="27"><span class="bu">print</span>(<span class="st">&#39;d = &#39;</span>, d)</a>
<a class="sourceLine" id="cb241-28" title="28">result <span class="op">=</span> d <span class="op">==</span> <span class="dv">4</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Python argument types in
    Mol.GetNumAtoms(Mol)
did not match C++ signature:
    GetNumAtoms(RDKit::ROMol, int onlyHeavy=-1, bool onlyExplicit=True)</code></pre>
</details>
<details>
<p><summary>eigen-ch</summary></p>
<h4 id="query-22">Query</h4>
<div class="sourceCode" id="cb243"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb243-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb243-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb243-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb243-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb243-5" title="5"></a>
<a class="sourceLine" id="cb243-6" title="6"><span class="kw">def</span> eigen(M):</a>
<a class="sourceLine" id="cb243-7" title="7">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb243-8" title="8"><span class="co">    该函数返回矩阵M的特征值和特征向量。</span></a>
<a class="sourceLine" id="cb243-9" title="9"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb243-10" title="10">    [insert]</a>
<a class="sourceLine" id="cb243-11" title="11">    <span class="cf">return</span> w,v</a></code></pre></div>
<h4 id="run-0-22">Run 0</h4>
<div class="sourceCode" id="cb244"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb244-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb244-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb244-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb244-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb244-5" title="5"></a>
<a class="sourceLine" id="cb244-6" title="6"><span class="kw">def</span> eigen(M):</a>
<a class="sourceLine" id="cb244-7" title="7">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb244-8" title="8"><span class="co">    该函数返回矩阵M的特征值和特征向量。</span></a>
<a class="sourceLine" id="cb244-9" title="9"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb244-10" title="10">    w,v <span class="op">=</span> np.linalg.eig(M)</a>
<a class="sourceLine" id="cb244-11" title="11">    <span class="cf">return</span> w,v</a>
<a class="sourceLine" id="cb244-12" title="12"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb244-13" title="13"></a>
<a class="sourceLine" id="cb244-14" title="14">np.random.seed(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb244-15" title="15">M <span class="op">=</span> np.random.random((<span class="dv">5</span>,<span class="dv">5</span>))</a>
<a class="sourceLine" id="cb244-16" title="16">w, v <span class="op">=</span> np.linalg.eig(M)</a>
<a class="sourceLine" id="cb244-17" title="17">w1, v1 <span class="op">=</span> eigen(M)</a>
<a class="sourceLine" id="cb244-18" title="18">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.allclose(w, w1) <span class="kw">and</span> np.allclose(v,v1) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-22">Run 1</h4>
<div class="sourceCode" id="cb246"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb246-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb246-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb246-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb246-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb246-5" title="5"></a>
<a class="sourceLine" id="cb246-6" title="6"><span class="kw">def</span> eigen(M):</a>
<a class="sourceLine" id="cb246-7" title="7">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb246-8" title="8"><span class="co">    该函数返回矩阵M的特征值和特征向量。</span></a>
<a class="sourceLine" id="cb246-9" title="9"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb246-10" title="10">    w,v <span class="op">=</span> np.linalg.eig(M)</a>
<a class="sourceLine" id="cb246-11" title="11">    <span class="cf">return</span> w,v</a>
<a class="sourceLine" id="cb246-12" title="12"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb246-13" title="13"></a>
<a class="sourceLine" id="cb246-14" title="14">np.random.seed(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb246-15" title="15">M <span class="op">=</span> np.random.random((<span class="dv">5</span>,<span class="dv">5</span>))</a>
<a class="sourceLine" id="cb246-16" title="16">w, v <span class="op">=</span> np.linalg.eig(M)</a>
<a class="sourceLine" id="cb246-17" title="17">w1, v1 <span class="op">=</span> eigen(M)</a>
<a class="sourceLine" id="cb246-18" title="18">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.allclose(w, w1) <span class="kw">and</span> np.allclose(v,v1) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-22">Run 2</h4>
<div class="sourceCode" id="cb248"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb248-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb248-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb248-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb248-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb248-5" title="5"></a>
<a class="sourceLine" id="cb248-6" title="6"><span class="kw">def</span> eigen(M):</a>
<a class="sourceLine" id="cb248-7" title="7">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb248-8" title="8"><span class="co">    该函数返回矩阵M的特征值和特征向量。</span></a>
<a class="sourceLine" id="cb248-9" title="9"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb248-10" title="10">    w,v <span class="op">=</span> np.linalg.eig(M)</a>
<a class="sourceLine" id="cb248-11" title="11">    <span class="cf">return</span> w,v</a>
<a class="sourceLine" id="cb248-12" title="12"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb248-13" title="13"></a>
<a class="sourceLine" id="cb248-14" title="14">np.random.seed(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb248-15" title="15">M <span class="op">=</span> np.random.random((<span class="dv">5</span>,<span class="dv">5</span>))</a>
<a class="sourceLine" id="cb248-16" title="16">w, v <span class="op">=</span> np.linalg.eig(M)</a>
<a class="sourceLine" id="cb248-17" title="17">w1, v1 <span class="op">=</span> eigen(M)</a>
<a class="sourceLine" id="cb248-18" title="18">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.allclose(w, w1) <span class="kw">and</span> np.allclose(v,v1) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-22">Run 3</h4>
<div class="sourceCode" id="cb250"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb250-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb250-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb250-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb250-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb250-5" title="5"></a>
<a class="sourceLine" id="cb250-6" title="6"><span class="kw">def</span> eigen(M):</a>
<a class="sourceLine" id="cb250-7" title="7">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb250-8" title="8"><span class="co">    该函数返回矩阵M的特征值和特征向量。</span></a>
<a class="sourceLine" id="cb250-9" title="9"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb250-10" title="10">    w,v <span class="op">=</span> np.linalg.eig(M)</a>
<a class="sourceLine" id="cb250-11" title="11">    <span class="cf">return</span> w,v</a>
<a class="sourceLine" id="cb250-12" title="12"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb250-13" title="13"></a>
<a class="sourceLine" id="cb250-14" title="14">np.random.seed(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb250-15" title="15">M <span class="op">=</span> np.random.random((<span class="dv">5</span>,<span class="dv">5</span>))</a>
<a class="sourceLine" id="cb250-16" title="16">w, v <span class="op">=</span> np.linalg.eig(M)</a>
<a class="sourceLine" id="cb250-17" title="17">w1, v1 <span class="op">=</span> eigen(M)</a>
<a class="sourceLine" id="cb250-18" title="18">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.allclose(w, w1) <span class="kw">and</span> np.allclose(v,v1) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-22">Run 4</h4>
<div class="sourceCode" id="cb252"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb252-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb252-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb252-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb252-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb252-5" title="5"></a>
<a class="sourceLine" id="cb252-6" title="6"><span class="kw">def</span> eigen(M):</a>
<a class="sourceLine" id="cb252-7" title="7">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb252-8" title="8"><span class="co">    该函数返回矩阵M的特征值和特征向量。</span></a>
<a class="sourceLine" id="cb252-9" title="9"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb252-10" title="10">    w,v <span class="op">=</span> np.linalg.eig(M)</a>
<a class="sourceLine" id="cb252-11" title="11">    <span class="cf">return</span> w,v</a>
<a class="sourceLine" id="cb252-12" title="12"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb252-13" title="13"></a>
<a class="sourceLine" id="cb252-14" title="14">np.random.seed(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb252-15" title="15">M <span class="op">=</span> np.random.random((<span class="dv">5</span>,<span class="dv">5</span>))</a>
<a class="sourceLine" id="cb252-16" title="16">w, v <span class="op">=</span> np.linalg.eig(M)</a>
<a class="sourceLine" id="cb252-17" title="17">w1, v1 <span class="op">=</span> eigen(M)</a>
<a class="sourceLine" id="cb252-18" title="18">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.allclose(w, w1) <span class="kw">and</span> np.allclose(v,v1) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>eigen</summary></p>
<h4 id="query-23">Query</h4>
<div class="sourceCode" id="cb254"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb254-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb254-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb254-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb254-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb254-5" title="5"></a>
<a class="sourceLine" id="cb254-6" title="6"><span class="kw">def</span> eigen(M):</a>
<a class="sourceLine" id="cb254-7" title="7">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb254-8" title="8"><span class="co">    Return eigenvalues and eigenvectors for a square matrix M</span></a>
<a class="sourceLine" id="cb254-9" title="9"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb254-10" title="10">    [insert]</a>
<a class="sourceLine" id="cb254-11" title="11">    <span class="cf">return</span> w,v</a></code></pre></div>
<h4 id="run-0-23">Run 0</h4>
<div class="sourceCode" id="cb255"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb255-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb255-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb255-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb255-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb255-5" title="5"></a>
<a class="sourceLine" id="cb255-6" title="6"><span class="kw">def</span> eigen(M):</a>
<a class="sourceLine" id="cb255-7" title="7">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb255-8" title="8"><span class="co">    Return eigenvalues and eigenvectors for a square matrix M</span></a>
<a class="sourceLine" id="cb255-9" title="9"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb255-10" title="10">    w,v <span class="op">=</span> np.linalg.eig(M)</a>
<a class="sourceLine" id="cb255-11" title="11">    <span class="cf">return</span> w,v</a>
<a class="sourceLine" id="cb255-12" title="12"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb255-13" title="13"></a>
<a class="sourceLine" id="cb255-14" title="14">np.random.seed(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb255-15" title="15">M <span class="op">=</span> np.random.random((<span class="dv">5</span>,<span class="dv">5</span>))</a>
<a class="sourceLine" id="cb255-16" title="16">w, v <span class="op">=</span> np.linalg.eig(M)</a>
<a class="sourceLine" id="cb255-17" title="17">w1, v1 <span class="op">=</span> eigen(M)</a>
<a class="sourceLine" id="cb255-18" title="18">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.allclose(w, w1) <span class="kw">and</span> np.allclose(v,v1) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-23">Run 1</h4>
<div class="sourceCode" id="cb257"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb257-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb257-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb257-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb257-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb257-5" title="5"></a>
<a class="sourceLine" id="cb257-6" title="6"><span class="kw">def</span> eigen(M):</a>
<a class="sourceLine" id="cb257-7" title="7">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb257-8" title="8"><span class="co">    Return eigenvalues and eigenvectors for a square matrix M</span></a>
<a class="sourceLine" id="cb257-9" title="9"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb257-10" title="10">    w,v <span class="op">=</span> np.linalg.eig(M)</a>
<a class="sourceLine" id="cb257-11" title="11">    <span class="cf">return</span> w,v</a>
<a class="sourceLine" id="cb257-12" title="12"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb257-13" title="13"></a>
<a class="sourceLine" id="cb257-14" title="14">np.random.seed(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb257-15" title="15">M <span class="op">=</span> np.random.random((<span class="dv">5</span>,<span class="dv">5</span>))</a>
<a class="sourceLine" id="cb257-16" title="16">w, v <span class="op">=</span> np.linalg.eig(M)</a>
<a class="sourceLine" id="cb257-17" title="17">w1, v1 <span class="op">=</span> eigen(M)</a>
<a class="sourceLine" id="cb257-18" title="18">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.allclose(w, w1) <span class="kw">and</span> np.allclose(v,v1) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-23">Run 2</h4>
<div class="sourceCode" id="cb259"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb259-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb259-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb259-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb259-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb259-5" title="5"></a>
<a class="sourceLine" id="cb259-6" title="6"><span class="kw">def</span> eigen(M):</a>
<a class="sourceLine" id="cb259-7" title="7">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb259-8" title="8"><span class="co">    Return eigenvalues and eigenvectors for a square matrix M</span></a>
<a class="sourceLine" id="cb259-9" title="9"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb259-10" title="10">    w,v <span class="op">=</span> np.linalg.eig(M)</a>
<a class="sourceLine" id="cb259-11" title="11">    <span class="cf">return</span> w,v</a>
<a class="sourceLine" id="cb259-12" title="12"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb259-13" title="13"></a>
<a class="sourceLine" id="cb259-14" title="14">np.random.seed(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb259-15" title="15">M <span class="op">=</span> np.random.random((<span class="dv">5</span>,<span class="dv">5</span>))</a>
<a class="sourceLine" id="cb259-16" title="16">w, v <span class="op">=</span> np.linalg.eig(M)</a>
<a class="sourceLine" id="cb259-17" title="17">w1, v1 <span class="op">=</span> eigen(M)</a>
<a class="sourceLine" id="cb259-18" title="18">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.allclose(w, w1) <span class="kw">and</span> np.allclose(v,v1) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-23">Run 3</h4>
<div class="sourceCode" id="cb261"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb261-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb261-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb261-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb261-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb261-5" title="5"></a>
<a class="sourceLine" id="cb261-6" title="6"><span class="kw">def</span> eigen(M):</a>
<a class="sourceLine" id="cb261-7" title="7">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb261-8" title="8"><span class="co">    Return eigenvalues and eigenvectors for a square matrix M</span></a>
<a class="sourceLine" id="cb261-9" title="9"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb261-10" title="10">    w,v <span class="op">=</span> np.linalg.eig(M)</a>
<a class="sourceLine" id="cb261-11" title="11">    w <span class="op">=</span> np.real(w)</a>
<a class="sourceLine" id="cb261-12" title="12">    v <span class="op">=</span> np.real(v)</a>
<a class="sourceLine" id="cb261-13" title="13">    <span class="cf">return</span> w,v</a>
<a class="sourceLine" id="cb261-14" title="14"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb261-15" title="15"></a>
<a class="sourceLine" id="cb261-16" title="16">np.random.seed(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb261-17" title="17">M <span class="op">=</span> np.random.random((<span class="dv">5</span>,<span class="dv">5</span>))</a>
<a class="sourceLine" id="cb261-18" title="18">w, v <span class="op">=</span> np.linalg.eig(M)</a>
<a class="sourceLine" id="cb261-19" title="19">w1, v1 <span class="op">=</span> eigen(M)</a>
<a class="sourceLine" id="cb261-20" title="20">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.allclose(w, w1) <span class="kw">and</span> np.allclose(v,v1) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-23">Run 4</h4>
<div class="sourceCode" id="cb263"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb263-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb263-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb263-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb263-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb263-5" title="5"></a>
<a class="sourceLine" id="cb263-6" title="6"><span class="kw">def</span> eigen(M):</a>
<a class="sourceLine" id="cb263-7" title="7">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb263-8" title="8"><span class="co">    Return eigenvalues and eigenvectors for a square matrix M</span></a>
<a class="sourceLine" id="cb263-9" title="9"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb263-10" title="10">    w,v <span class="op">=</span> np.linalg.eig(M)</a>
<a class="sourceLine" id="cb263-11" title="11">    <span class="cf">return</span> w,v</a>
<a class="sourceLine" id="cb263-12" title="12"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb263-13" title="13"></a>
<a class="sourceLine" id="cb263-14" title="14">np.random.seed(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb263-15" title="15">M <span class="op">=</span> np.random.random((<span class="dv">5</span>,<span class="dv">5</span>))</a>
<a class="sourceLine" id="cb263-16" title="16">w, v <span class="op">=</span> np.linalg.eig(M)</a>
<a class="sourceLine" id="cb263-17" title="17">w1, v1 <span class="op">=</span> eigen(M)</a>
<a class="sourceLine" id="cb263-18" title="18">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.allclose(w, w1) <span class="kw">and</span> np.allclose(v,v1) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>element_mass</summary></p>
<h4 id="query-24">Query</h4>
<div class="sourceCode" id="cb265"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb265-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb265-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb265-3" title="3"></a>
<a class="sourceLine" id="cb265-4" title="4"><span class="kw">def</span> element_mass(element_symbol):</a>
<a class="sourceLine" id="cb265-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb265-6" title="6"><span class="co">   This function returns the mass of the chemical element given by its symbol</span></a>
<a class="sourceLine" id="cb265-7" title="7"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb265-8" title="8">   <span class="im">import</span> mendeleev</a>
<a class="sourceLine" id="cb265-9" title="9">   [insert]</a>
<a class="sourceLine" id="cb265-10" title="10">   <span class="cf">return</span> mass</a></code></pre></div>
<h4 id="run-0-24">Run 0</h4>
<div class="sourceCode" id="cb266"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb266-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb266-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb266-3" title="3"></a>
<a class="sourceLine" id="cb266-4" title="4"><span class="kw">def</span> element_mass(element_symbol):</a>
<a class="sourceLine" id="cb266-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb266-6" title="6"><span class="co">   This function returns the mass of the chemical element given by its symbol</span></a>
<a class="sourceLine" id="cb266-7" title="7"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb266-8" title="8">   <span class="im">import</span> mendeleev</a>
<a class="sourceLine" id="cb266-9" title="9">   mass <span class="op">=</span> mendeleev.element(element_symbol).mass</a>
<a class="sourceLine" id="cb266-10" title="10">   <span class="cf">if</span> mass <span class="op">==</span> <span class="va">None</span>:</a>
<a class="sourceLine" id="cb266-11" title="11">      <span class="bu">print</span>(<span class="st">&quot;Element mass not found for element &quot;</span> <span class="op">+</span> element_symbol)</a>
<a class="sourceLine" id="cb266-12" title="12">      sys.exit()</a>
<a class="sourceLine" id="cb266-13" title="13">   <span class="cf">return</span> mass</a>
<a class="sourceLine" id="cb266-14" title="14"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb266-15" title="15">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">abs</span>(element_mass(<span class="st">&quot;U&quot;</span>)<span class="op">-</span><span class="fl">238.03</span>)<span class="op">&lt;</span><span class="fl">0.01</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-24">Run 1</h4>
<div class="sourceCode" id="cb268"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb268-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb268-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb268-3" title="3"></a>
<a class="sourceLine" id="cb268-4" title="4"><span class="kw">def</span> element_mass(element_symbol):</a>
<a class="sourceLine" id="cb268-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb268-6" title="6"><span class="co">   This function returns the mass of the chemical element given by its symbol</span></a>
<a class="sourceLine" id="cb268-7" title="7"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb268-8" title="8">   <span class="im">import</span> mendeleev</a>
<a class="sourceLine" id="cb268-9" title="9">   mass <span class="op">=</span> mendeleev.element(element_symbol).mass</a>
<a class="sourceLine" id="cb268-10" title="10">   <span class="cf">if</span> mass <span class="op">==</span> <span class="va">None</span>:</a>
<a class="sourceLine" id="cb268-11" title="11">      <span class="bu">print</span> <span class="st">&quot;Error: element symbol not found&quot;</span></a>
<a class="sourceLine" id="cb268-12" title="12">      sys.exit(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb268-13" title="13">   <span class="cf">return</span> mass</a>
<a class="sourceLine" id="cb268-14" title="14"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb268-15" title="15">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">abs</span>(element_mass(<span class="st">&quot;U&quot;</span>)<span class="op">-</span><span class="fl">238.03</span>)<span class="op">&lt;</span><span class="fl">0.01</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Missing parentheses in call to &#39;print&#39;. Did you mean print(&quot;Error: element symbol not found&quot;)? (&lt;string&gt;, line 12)</code></pre>
<h4 id="run-2-24">Run 2</h4>
<div class="sourceCode" id="cb270"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb270-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb270-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb270-3" title="3"></a>
<a class="sourceLine" id="cb270-4" title="4"><span class="kw">def</span> element_mass(element_symbol):</a>
<a class="sourceLine" id="cb270-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb270-6" title="6"><span class="co">   This function returns the mass of the chemical element given by its symbol</span></a>
<a class="sourceLine" id="cb270-7" title="7"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb270-8" title="8">   <span class="im">import</span> mendeleev</a>
<a class="sourceLine" id="cb270-9" title="9">   mass <span class="op">=</span> mendeleev.element(element_symbol).mass</a>
<a class="sourceLine" id="cb270-10" title="10">   <span class="cf">if</span> mass <span class="op">==</span> <span class="va">None</span>:</a>
<a class="sourceLine" id="cb270-11" title="11">      <span class="bu">print</span> <span class="st">&quot;Error: element mass not found for element symbol: &quot;</span> <span class="op">+</span> element_symbol</a>
<a class="sourceLine" id="cb270-12" title="12">      sys.exit(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb270-13" title="13">   <span class="cf">return</span> mass</a>
<a class="sourceLine" id="cb270-14" title="14"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb270-15" title="15">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">abs</span>(element_mass(<span class="st">&quot;U&quot;</span>)<span class="op">-</span><span class="fl">238.03</span>)<span class="op">&lt;</span><span class="fl">0.01</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Missing parentheses in call to &#39;print&#39;. Did you mean print(&quot;Error: element mass not found for element symbol: &quot; + element_symbol)? (&lt;string&gt;, line 12)</code></pre>
<h4 id="run-3-24">Run 3</h4>
<div class="sourceCode" id="cb272"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb272-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb272-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb272-3" title="3"></a>
<a class="sourceLine" id="cb272-4" title="4"><span class="kw">def</span> element_mass(element_symbol):</a>
<a class="sourceLine" id="cb272-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb272-6" title="6"><span class="co">   This function returns the mass of the chemical element given by its symbol</span></a>
<a class="sourceLine" id="cb272-7" title="7"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb272-8" title="8">   <span class="im">import</span> mendeleev</a>
<a class="sourceLine" id="cb272-9" title="9">   mass <span class="op">=</span> mendeleev.element(element_symbol).mass</a>
<a class="sourceLine" id="cb272-10" title="10">   <span class="cf">if</span> mass <span class="op">==</span> <span class="va">None</span>:</a>
<a class="sourceLine" id="cb272-11" title="11">      <span class="bu">print</span> <span class="st">&quot;Error: element mass not found for element&quot;</span>, element_symbol</a>
<a class="sourceLine" id="cb272-12" title="12">      sys.exit(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb272-13" title="13">   <span class="cf">return</span> mass</a>
<a class="sourceLine" id="cb272-14" title="14"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb272-15" title="15">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">abs</span>(element_mass(<span class="st">&quot;U&quot;</span>)<span class="op">-</span><span class="fl">238.03</span>)<span class="op">&lt;</span><span class="fl">0.01</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Missing parentheses in call to &#39;print&#39;. Did you mean print(&quot;Error: element mass not found for element&quot;, element_symbol)? (&lt;string&gt;, line 12)</code></pre>
<h4 id="run-4-24">Run 4</h4>
<div class="sourceCode" id="cb274"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb274-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb274-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb274-3" title="3"></a>
<a class="sourceLine" id="cb274-4" title="4"><span class="kw">def</span> element_mass(element_symbol):</a>
<a class="sourceLine" id="cb274-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb274-6" title="6"><span class="co">   This function returns the mass of the chemical element given by its symbol</span></a>
<a class="sourceLine" id="cb274-7" title="7"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb274-8" title="8">   <span class="im">import</span> mendeleev</a>
<a class="sourceLine" id="cb274-9" title="9">   mass <span class="op">=</span> mendeleev.element(element_symbol).mass</a>
<a class="sourceLine" id="cb274-10" title="10">   <span class="cf">if</span> mass <span class="op">==</span> <span class="va">None</span>:</a>
<a class="sourceLine" id="cb274-11" title="11">      <span class="bu">print</span> <span class="st">&quot;ERROR: Element mass not found for element: &quot;</span>, element_symbol</a>
<a class="sourceLine" id="cb274-12" title="12">      sys.exit()</a>
<a class="sourceLine" id="cb274-13" title="13">   <span class="cf">return</span> mass</a>
<a class="sourceLine" id="cb274-14" title="14"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb274-15" title="15">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">abs</span>(element_mass(<span class="st">&quot;U&quot;</span>)<span class="op">-</span><span class="fl">238.03</span>)<span class="op">&lt;</span><span class="fl">0.01</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Missing parentheses in call to &#39;print&#39;. Did you mean print(&quot;ERROR: Element mass not found for element: &quot;, element_symbol)? (&lt;string&gt;, line 12)</code></pre>
</details>
<details>
<p><summary>element_name</summary></p>
<h4 id="query-25">Query</h4>
<div class="sourceCode" id="cb276"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb276-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb276-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb276-3" title="3"></a>
<a class="sourceLine" id="cb276-4" title="4"><span class="kw">def</span> symbol(element_number):</a>
<a class="sourceLine" id="cb276-5" title="5">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb276-6" title="6"><span class="co">  This function returns the two letter symbol for the chemical element given by element_number</span></a>
<a class="sourceLine" id="cb276-7" title="7"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb276-8" title="8">  <span class="im">import</span> mendeleev</a>
<a class="sourceLine" id="cb276-9" title="9">  [insert]</a>
<a class="sourceLine" id="cb276-10" title="10">  <span class="cf">return</span> s</a></code></pre></div>
<h4 id="run-0-25">Run 0</h4>
<div class="sourceCode" id="cb277"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb277-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb277-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb277-3" title="3"></a>
<a class="sourceLine" id="cb277-4" title="4"><span class="kw">def</span> symbol(element_number):</a>
<a class="sourceLine" id="cb277-5" title="5">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb277-6" title="6"><span class="co">  This function returns the two letter symbol for the chemical element given by element_number</span></a>
<a class="sourceLine" id="cb277-7" title="7"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb277-8" title="8">  <span class="im">import</span> mendeleev</a>
<a class="sourceLine" id="cb277-9" title="9">  s <span class="op">=</span> mendeleev.element(element_number).symbol</a>
<a class="sourceLine" id="cb277-10" title="10">  <span class="cf">return</span> s</a>
<a class="sourceLine" id="cb277-11" title="11">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> symbol(<span class="dv">26</span>).lower()<span class="op">==</span><span class="st">&quot;fe&quot;</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-25">Run 1</h4>
<div class="sourceCode" id="cb279"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb279-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb279-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb279-3" title="3"></a>
<a class="sourceLine" id="cb279-4" title="4"><span class="kw">def</span> symbol(element_number):</a>
<a class="sourceLine" id="cb279-5" title="5">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb279-6" title="6"><span class="co">  This function returns the two letter symbol for the chemical element given by element_number</span></a>
<a class="sourceLine" id="cb279-7" title="7"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb279-8" title="8">  <span class="im">import</span> mendeleev</a>
<a class="sourceLine" id="cb279-9" title="9">  s <span class="op">=</span> mendeleev.element(element_number).symbol</a>
<a class="sourceLine" id="cb279-10" title="10">  <span class="cf">return</span> s</a>
<a class="sourceLine" id="cb279-11" title="11">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> symbol(<span class="dv">26</span>).lower()<span class="op">==</span><span class="st">&quot;fe&quot;</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-25">Run 2</h4>
<div class="sourceCode" id="cb281"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb281-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb281-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb281-3" title="3"></a>
<a class="sourceLine" id="cb281-4" title="4"><span class="kw">def</span> symbol(element_number):</a>
<a class="sourceLine" id="cb281-5" title="5">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb281-6" title="6"><span class="co">  This function returns the two letter symbol for the chemical element given by element_number</span></a>
<a class="sourceLine" id="cb281-7" title="7"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb281-8" title="8">  <span class="im">import</span> mendeleev</a>
<a class="sourceLine" id="cb281-9" title="9">  s <span class="op">=</span> mendeleev.element(element_number).symbol</a>
<a class="sourceLine" id="cb281-10" title="10">  <span class="cf">return</span> s</a>
<a class="sourceLine" id="cb281-11" title="11">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> symbol(<span class="dv">26</span>).lower()<span class="op">==</span><span class="st">&quot;fe&quot;</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-25">Run 3</h4>
<div class="sourceCode" id="cb283"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb283-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb283-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb283-3" title="3"></a>
<a class="sourceLine" id="cb283-4" title="4"><span class="kw">def</span> symbol(element_number):</a>
<a class="sourceLine" id="cb283-5" title="5">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb283-6" title="6"><span class="co">  This function returns the two letter symbol for the chemical element given by element_number</span></a>
<a class="sourceLine" id="cb283-7" title="7"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb283-8" title="8">  <span class="im">import</span> mendeleev</a>
<a class="sourceLine" id="cb283-9" title="9">  s <span class="op">=</span> mendeleev.element(element_number).symbol</a>
<a class="sourceLine" id="cb283-10" title="10">  <span class="cf">return</span> s</a>
<a class="sourceLine" id="cb283-11" title="11">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> symbol(<span class="dv">26</span>).lower()<span class="op">==</span><span class="st">&quot;fe&quot;</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-25">Run 4</h4>
<div class="sourceCode" id="cb285"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb285-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb285-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb285-3" title="3"></a>
<a class="sourceLine" id="cb285-4" title="4"><span class="kw">def</span> symbol(element_number):</a>
<a class="sourceLine" id="cb285-5" title="5">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb285-6" title="6"><span class="co">  This function returns the two letter symbol for the chemical element given by element_number</span></a>
<a class="sourceLine" id="cb285-7" title="7"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb285-8" title="8">  <span class="im">import</span> mendeleev</a>
<a class="sourceLine" id="cb285-9" title="9">  s <span class="op">=</span> mendeleev.element(element_number).symbol</a>
<a class="sourceLine" id="cb285-10" title="10">  <span class="cf">return</span> s</a>
<a class="sourceLine" id="cb285-11" title="11">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> symbol(<span class="dv">26</span>).lower()<span class="op">==</span><span class="st">&quot;fe&quot;</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>energy_of_e</summary></p>
<h4 id="query-26">Query</h4>
<div class="sourceCode" id="cb287"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb287-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb287-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb287-3" title="3"></a>
<a class="sourceLine" id="cb287-4" title="4"><span class="kw">def</span> energy_of_e(n):</a>
<a class="sourceLine" id="cb287-5" title="5">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb287-6" title="6"><span class="co">    This function calculates the energy in electron Volts of an electron in state n in a hydrogen atom</span></a>
<a class="sourceLine" id="cb287-7" title="7"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb287-8" title="8">    [insert]</a>
<a class="sourceLine" id="cb287-9" title="9">    <span class="cf">return</span> energy</a></code></pre></div>
<h4 id="run-0-26">Run 0</h4>
<div class="sourceCode" id="cb288"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb288-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb288-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb288-3" title="3"></a>
<a class="sourceLine" id="cb288-4" title="4"><span class="kw">def</span> energy_of_e(n):</a>
<a class="sourceLine" id="cb288-5" title="5">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb288-6" title="6"><span class="co">    This function calculates the energy in electron Volts of an electron in state n in a hydrogen atom</span></a>
<a class="sourceLine" id="cb288-7" title="7"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb288-8" title="8">    energy <span class="op">=</span> <span class="fl">-13.6</span><span class="op">/</span>n<span class="op">**</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb288-9" title="9">    <span class="cf">return</span> energy</a>
<a class="sourceLine" id="cb288-10" title="10"></a>
<a class="sourceLine" id="cb288-11" title="11"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb288-12" title="12">Rh <span class="op">=</span> <span class="fl">13.60648962</span></a>
<a class="sourceLine" id="cb288-13" title="13">n <span class="op">=</span> <span class="dv">3</span></a>
<a class="sourceLine" id="cb288-14" title="14">energy_true <span class="op">=</span> (<span class="op">-</span>Rh<span class="op">/</span>(n<span class="op">**</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb288-15" title="15">energy_nlcc <span class="op">=</span> energy_of_e(n)</a>
<a class="sourceLine" id="cb288-16" title="16"></a>
<a class="sourceLine" id="cb288-17" title="17">result <span class="op">=</span> math.isclose(energy_true, energy_nlcc, rel_tol <span class="op">=</span><span class="fl">1e-3</span>)</a>
<a class="sourceLine" id="cb288-18" title="18"></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-26">Run 1</h4>
<div class="sourceCode" id="cb290"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb290-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb290-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb290-3" title="3"></a>
<a class="sourceLine" id="cb290-4" title="4"><span class="kw">def</span> energy_of_e(n):</a>
<a class="sourceLine" id="cb290-5" title="5">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb290-6" title="6"><span class="co">    This function calculates the energy in electron Volts of an electron in state n in a hydrogen atom</span></a>
<a class="sourceLine" id="cb290-7" title="7"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb290-8" title="8">    energy <span class="op">=</span> <span class="fl">-13.6</span><span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>n<span class="op">**</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb290-9" title="9">    <span class="cf">return</span> energy</a>
<a class="sourceLine" id="cb290-10" title="10"></a>
<a class="sourceLine" id="cb290-11" title="11"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb290-12" title="12">Rh <span class="op">=</span> <span class="fl">13.60648962</span></a>
<a class="sourceLine" id="cb290-13" title="13">n <span class="op">=</span> <span class="dv">3</span></a>
<a class="sourceLine" id="cb290-14" title="14">energy_true <span class="op">=</span> (<span class="op">-</span>Rh<span class="op">/</span>(n<span class="op">**</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb290-15" title="15">energy_nlcc <span class="op">=</span> energy_of_e(n)</a>
<a class="sourceLine" id="cb290-16" title="16"></a>
<a class="sourceLine" id="cb290-17" title="17">result <span class="op">=</span> math.isclose(energy_true, energy_nlcc, rel_tol <span class="op">=</span><span class="fl">1e-3</span>)</a>
<a class="sourceLine" id="cb290-18" title="18"></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-26">Run 2</h4>
<div class="sourceCode" id="cb292"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb292-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb292-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb292-3" title="3"></a>
<a class="sourceLine" id="cb292-4" title="4"><span class="kw">def</span> energy_of_e(n):</a>
<a class="sourceLine" id="cb292-5" title="5">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb292-6" title="6"><span class="co">    This function calculates the energy in electron Volts of an electron in state n in a hydrogen atom</span></a>
<a class="sourceLine" id="cb292-7" title="7"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb292-8" title="8">    energy <span class="op">=</span> <span class="fl">-13.6</span> <span class="op">*</span> (<span class="dv">1</span> <span class="op">/</span> (n <span class="op">**</span> <span class="dv">2</span>))</a>
<a class="sourceLine" id="cb292-9" title="9">    <span class="cf">return</span> energy</a>
<a class="sourceLine" id="cb292-10" title="10"></a>
<a class="sourceLine" id="cb292-11" title="11"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb292-12" title="12">Rh <span class="op">=</span> <span class="fl">13.60648962</span></a>
<a class="sourceLine" id="cb292-13" title="13">n <span class="op">=</span> <span class="dv">3</span></a>
<a class="sourceLine" id="cb292-14" title="14">energy_true <span class="op">=</span> (<span class="op">-</span>Rh<span class="op">/</span>(n<span class="op">**</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb292-15" title="15">energy_nlcc <span class="op">=</span> energy_of_e(n)</a>
<a class="sourceLine" id="cb292-16" title="16"></a>
<a class="sourceLine" id="cb292-17" title="17">result <span class="op">=</span> math.isclose(energy_true, energy_nlcc, rel_tol <span class="op">=</span><span class="fl">1e-3</span>)</a>
<a class="sourceLine" id="cb292-18" title="18"></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-26">Run 3</h4>
<div class="sourceCode" id="cb294"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb294-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb294-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb294-3" title="3"></a>
<a class="sourceLine" id="cb294-4" title="4"><span class="kw">def</span> energy_of_e(n):</a>
<a class="sourceLine" id="cb294-5" title="5">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb294-6" title="6"><span class="co">    This function calculates the energy in electron Volts of an electron in state n in a hydrogen atom</span></a>
<a class="sourceLine" id="cb294-7" title="7"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb294-8" title="8">    energy <span class="op">=</span> <span class="fl">-13.6</span><span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>n<span class="op">**</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb294-9" title="9">    <span class="cf">return</span> energy</a>
<a class="sourceLine" id="cb294-10" title="10"></a>
<a class="sourceLine" id="cb294-11" title="11"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb294-12" title="12">Rh <span class="op">=</span> <span class="fl">13.60648962</span></a>
<a class="sourceLine" id="cb294-13" title="13">n <span class="op">=</span> <span class="dv">3</span></a>
<a class="sourceLine" id="cb294-14" title="14">energy_true <span class="op">=</span> (<span class="op">-</span>Rh<span class="op">/</span>(n<span class="op">**</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb294-15" title="15">energy_nlcc <span class="op">=</span> energy_of_e(n)</a>
<a class="sourceLine" id="cb294-16" title="16"></a>
<a class="sourceLine" id="cb294-17" title="17">result <span class="op">=</span> math.isclose(energy_true, energy_nlcc, rel_tol <span class="op">=</span><span class="fl">1e-3</span>)</a>
<a class="sourceLine" id="cb294-18" title="18"></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-26">Run 4</h4>
<div class="sourceCode" id="cb296"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb296-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb296-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb296-3" title="3"></a>
<a class="sourceLine" id="cb296-4" title="4"><span class="kw">def</span> energy_of_e(n):</a>
<a class="sourceLine" id="cb296-5" title="5">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb296-6" title="6"><span class="co">    This function calculates the energy in electron Volts of an electron in state n in a hydrogen atom</span></a>
<a class="sourceLine" id="cb296-7" title="7"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb296-8" title="8">    energy <span class="op">=</span> <span class="fl">-13.6</span><span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>n<span class="op">**</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb296-9" title="9">    <span class="cf">return</span> energy</a>
<a class="sourceLine" id="cb296-10" title="10"></a>
<a class="sourceLine" id="cb296-11" title="11"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb296-12" title="12">Rh <span class="op">=</span> <span class="fl">13.60648962</span></a>
<a class="sourceLine" id="cb296-13" title="13">n <span class="op">=</span> <span class="dv">3</span></a>
<a class="sourceLine" id="cb296-14" title="14">energy_true <span class="op">=</span> (<span class="op">-</span>Rh<span class="op">/</span>(n<span class="op">**</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb296-15" title="15">energy_nlcc <span class="op">=</span> energy_of_e(n)</a>
<a class="sourceLine" id="cb296-16" title="16"></a>
<a class="sourceLine" id="cb296-17" title="17">result <span class="op">=</span> math.isclose(energy_true, energy_nlcc, rel_tol <span class="op">=</span><span class="fl">1e-3</span>)</a>
<a class="sourceLine" id="cb296-18" title="18"></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>find_indices</summary></p>
<h4 id="query-27">Query</h4>
<div class="sourceCode" id="cb298"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb298-1" title="1"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb298-2" title="2"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb298-3" title="3"></a>
<a class="sourceLine" id="cb298-4" title="4"><span class="kw">def</span> get_ca_indices(pdb_file):</a>
<a class="sourceLine" id="cb298-5" title="5">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb298-6" title="6"><span class="co">  This function uploads a pdb file and find out the indices of first two alpha carbon atoms.</span></a>
<a class="sourceLine" id="cb298-7" title="7"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb298-8" title="8">  [insert]</a>
<a class="sourceLine" id="cb298-9" title="9">  <span class="cf">return</span> idx</a></code></pre></div>
<h4 id="run-0-27">Run 0</h4>
<div class="sourceCode" id="cb299"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb299-1" title="1"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb299-2" title="2"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb299-3" title="3"></a>
<a class="sourceLine" id="cb299-4" title="4"><span class="kw">def</span> get_ca_indices(pdb_file):</a>
<a class="sourceLine" id="cb299-5" title="5">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb299-6" title="6"><span class="co">  This function uploads a pdb file and find out the indices of first two alpha carbon atoms.</span></a>
<a class="sourceLine" id="cb299-7" title="7"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb299-8" title="8">  traj <span class="op">=</span> md.load(pdb_file)</a>
<a class="sourceLine" id="cb299-9" title="9">  idx <span class="op">=</span> []</a>
<a class="sourceLine" id="cb299-10" title="10">  <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">2</span>):</a>
<a class="sourceLine" id="cb299-11" title="11">    idx.append(traj.topology.select(<span class="st">&#39;name CA and resid &#39;</span><span class="op">+</span><span class="bu">str</span>(i<span class="op">+</span><span class="dv">1</span>)))</a>
<a class="sourceLine" id="cb299-12" title="12">  <span class="cf">return</span> idx</a>
<a class="sourceLine" id="cb299-13" title="13"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb299-14" title="14"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb299-15" title="15"></a>
<a class="sourceLine" id="cb299-16" title="16">pdb_file <span class="op">=</span> os.path.join(_FILE_DIR_,<span class="st">&quot;1l2y.pdb&quot;</span>)</a>
<a class="sourceLine" id="cb299-17" title="17"></a>
<a class="sourceLine" id="cb299-18" title="18"><span class="kw">def</span> get_pair_indices(pdb_file):</a>
<a class="sourceLine" id="cb299-19" title="19">    <span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb299-20" title="20">    pdb <span class="op">=</span> md.load(pdb_file)</a>
<a class="sourceLine" id="cb299-21" title="21">    top <span class="op">=</span> pdb.topology</a>
<a class="sourceLine" id="cb299-22" title="22">    CAs <span class="op">=</span> [atom.index <span class="cf">for</span> atom <span class="kw">in</span> top.atoms <span class="cf">if</span> atom.name <span class="op">==</span> <span class="st">&#39;CA&#39;</span>]</a>
<a class="sourceLine" id="cb299-23" title="23">    indices_pair <span class="op">=</span> np.array([CAs[<span class="dv">0</span>], CAs[<span class="dv">1</span>]])</a>
<a class="sourceLine" id="cb299-24" title="24">    <span class="cf">return</span> indices_pair</a>
<a class="sourceLine" id="cb299-25" title="25"></a>
<a class="sourceLine" id="cb299-26" title="26">my_indices_pair <span class="op">=</span> get_pair_indices(pdb_file)</a>
<a class="sourceLine" id="cb299-27" title="27">prompt_indices_pair <span class="op">=</span> get_ca_indices(pdb_file)</a>
<a class="sourceLine" id="cb299-28" title="28"></a>
<a class="sourceLine" id="cb299-29" title="29">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">all</span>(my_indices_pair <span class="op">==</span> prompt_indices_pair) <span class="cf">else</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb299-30" title="30"></a>
<a class="sourceLine" id="cb299-31" title="31"></a></code></pre></div>
<p>Output:</p>
<pre><code>&#39;Constant&#39; object has no attribute &#39;kind&#39;</code></pre>
<h4 id="run-1-27">Run 1</h4>
<div class="sourceCode" id="cb301"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb301-1" title="1"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb301-2" title="2"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb301-3" title="3"></a>
<a class="sourceLine" id="cb301-4" title="4"><span class="kw">def</span> get_ca_indices(pdb_file):</a>
<a class="sourceLine" id="cb301-5" title="5">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb301-6" title="6"><span class="co">  This function uploads a pdb file and find out the indices of first two alpha carbon atoms.</span></a>
<a class="sourceLine" id="cb301-7" title="7"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb301-8" title="8">  traj <span class="op">=</span> md.load(pdb_file)</a>
<a class="sourceLine" id="cb301-9" title="9">  top <span class="op">=</span> traj.topology</a>
<a class="sourceLine" id="cb301-10" title="10">  idx <span class="op">=</span> top.select(<span class="st">&#39;name CA&#39;</span>)</a>
<a class="sourceLine" id="cb301-11" title="11">  <span class="cf">if</span> <span class="bu">len</span>(idx) <span class="op">&gt;</span> <span class="dv">2</span>:</a>
<a class="sourceLine" id="cb301-12" title="12">    idx <span class="op">=</span> idx[:<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb301-13" title="13">  <span class="cf">return</span> idx</a>
<a class="sourceLine" id="cb301-14" title="14"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb301-15" title="15"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb301-16" title="16"></a>
<a class="sourceLine" id="cb301-17" title="17">pdb_file <span class="op">=</span> os.path.join(_FILE_DIR_,<span class="st">&quot;1l2y.pdb&quot;</span>)</a>
<a class="sourceLine" id="cb301-18" title="18"></a>
<a class="sourceLine" id="cb301-19" title="19"><span class="kw">def</span> get_pair_indices(pdb_file):</a>
<a class="sourceLine" id="cb301-20" title="20">    <span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb301-21" title="21">    pdb <span class="op">=</span> md.load(pdb_file)</a>
<a class="sourceLine" id="cb301-22" title="22">    top <span class="op">=</span> pdb.topology</a>
<a class="sourceLine" id="cb301-23" title="23">    CAs <span class="op">=</span> [atom.index <span class="cf">for</span> atom <span class="kw">in</span> top.atoms <span class="cf">if</span> atom.name <span class="op">==</span> <span class="st">&#39;CA&#39;</span>]</a>
<a class="sourceLine" id="cb301-24" title="24">    indices_pair <span class="op">=</span> np.array([CAs[<span class="dv">0</span>], CAs[<span class="dv">1</span>]])</a>
<a class="sourceLine" id="cb301-25" title="25">    <span class="cf">return</span> indices_pair</a>
<a class="sourceLine" id="cb301-26" title="26"></a>
<a class="sourceLine" id="cb301-27" title="27">my_indices_pair <span class="op">=</span> get_pair_indices(pdb_file)</a>
<a class="sourceLine" id="cb301-28" title="28">prompt_indices_pair <span class="op">=</span> get_ca_indices(pdb_file)</a>
<a class="sourceLine" id="cb301-29" title="29"></a>
<a class="sourceLine" id="cb301-30" title="30">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">all</span>(my_indices_pair <span class="op">==</span> prompt_indices_pair) <span class="cf">else</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb301-31" title="31"></a>
<a class="sourceLine" id="cb301-32" title="32"></a></code></pre></div>
<p>Output:</p>
<pre><code>&#39;Constant&#39; object has no attribute &#39;kind&#39;</code></pre>
<h4 id="run-2-27">Run 2</h4>
<div class="sourceCode" id="cb303"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb303-1" title="1"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb303-2" title="2"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb303-3" title="3"></a>
<a class="sourceLine" id="cb303-4" title="4"><span class="kw">def</span> get_ca_indices(pdb_file):</a>
<a class="sourceLine" id="cb303-5" title="5">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb303-6" title="6"><span class="co">  This function uploads a pdb file and find out the indices of first two alpha carbon atoms.</span></a>
<a class="sourceLine" id="cb303-7" title="7"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb303-8" title="8">  traj <span class="op">=</span> md.load(pdb_file)</a>
<a class="sourceLine" id="cb303-9" title="9">  topology <span class="op">=</span> traj.topology</a>
<a class="sourceLine" id="cb303-10" title="10">  idx <span class="op">=</span> topology.select(<span class="st">&#39;name CA&#39;</span>)</a>
<a class="sourceLine" id="cb303-11" title="11">  idx <span class="op">=</span> idx[<span class="dv">0</span>:<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb303-12" title="12">  <span class="cf">return</span> idx</a>
<a class="sourceLine" id="cb303-13" title="13"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb303-14" title="14"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb303-15" title="15"></a>
<a class="sourceLine" id="cb303-16" title="16">pdb_file <span class="op">=</span> os.path.join(_FILE_DIR_,<span class="st">&quot;1l2y.pdb&quot;</span>)</a>
<a class="sourceLine" id="cb303-17" title="17"></a>
<a class="sourceLine" id="cb303-18" title="18"><span class="kw">def</span> get_pair_indices(pdb_file):</a>
<a class="sourceLine" id="cb303-19" title="19">    <span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb303-20" title="20">    pdb <span class="op">=</span> md.load(pdb_file)</a>
<a class="sourceLine" id="cb303-21" title="21">    top <span class="op">=</span> pdb.topology</a>
<a class="sourceLine" id="cb303-22" title="22">    CAs <span class="op">=</span> [atom.index <span class="cf">for</span> atom <span class="kw">in</span> top.atoms <span class="cf">if</span> atom.name <span class="op">==</span> <span class="st">&#39;CA&#39;</span>]</a>
<a class="sourceLine" id="cb303-23" title="23">    indices_pair <span class="op">=</span> np.array([CAs[<span class="dv">0</span>], CAs[<span class="dv">1</span>]])</a>
<a class="sourceLine" id="cb303-24" title="24">    <span class="cf">return</span> indices_pair</a>
<a class="sourceLine" id="cb303-25" title="25"></a>
<a class="sourceLine" id="cb303-26" title="26">my_indices_pair <span class="op">=</span> get_pair_indices(pdb_file)</a>
<a class="sourceLine" id="cb303-27" title="27">prompt_indices_pair <span class="op">=</span> get_ca_indices(pdb_file)</a>
<a class="sourceLine" id="cb303-28" title="28"></a>
<a class="sourceLine" id="cb303-29" title="29">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">all</span>(my_indices_pair <span class="op">==</span> prompt_indices_pair) <span class="cf">else</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb303-30" title="30"></a>
<a class="sourceLine" id="cb303-31" title="31"></a></code></pre></div>
<p>Output:</p>
<pre><code>&#39;Constant&#39; object has no attribute &#39;kind&#39;</code></pre>
<h4 id="run-3-27">Run 3</h4>
<div class="sourceCode" id="cb305"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb305-1" title="1"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb305-2" title="2"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb305-3" title="3"></a>
<a class="sourceLine" id="cb305-4" title="4"><span class="kw">def</span> get_ca_indices(pdb_file):</a>
<a class="sourceLine" id="cb305-5" title="5">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb305-6" title="6"><span class="co">  This function uploads a pdb file and find out the indices of first two alpha carbon atoms.</span></a>
<a class="sourceLine" id="cb305-7" title="7"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb305-8" title="8">  traj <span class="op">=</span> md.load(pdb_file)</a>
<a class="sourceLine" id="cb305-9" title="9">  topology <span class="op">=</span> traj.topology</a>
<a class="sourceLine" id="cb305-10" title="10">  idx <span class="op">=</span> topology.select(<span class="st">&#39;name CA&#39;</span>)</a>
<a class="sourceLine" id="cb305-11" title="11">  idx <span class="op">=</span> idx[:<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb305-12" title="12">  <span class="cf">return</span> idx</a>
<a class="sourceLine" id="cb305-13" title="13"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb305-14" title="14"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb305-15" title="15"></a>
<a class="sourceLine" id="cb305-16" title="16">pdb_file <span class="op">=</span> os.path.join(_FILE_DIR_,<span class="st">&quot;1l2y.pdb&quot;</span>)</a>
<a class="sourceLine" id="cb305-17" title="17"></a>
<a class="sourceLine" id="cb305-18" title="18"><span class="kw">def</span> get_pair_indices(pdb_file):</a>
<a class="sourceLine" id="cb305-19" title="19">    <span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb305-20" title="20">    pdb <span class="op">=</span> md.load(pdb_file)</a>
<a class="sourceLine" id="cb305-21" title="21">    top <span class="op">=</span> pdb.topology</a>
<a class="sourceLine" id="cb305-22" title="22">    CAs <span class="op">=</span> [atom.index <span class="cf">for</span> atom <span class="kw">in</span> top.atoms <span class="cf">if</span> atom.name <span class="op">==</span> <span class="st">&#39;CA&#39;</span>]</a>
<a class="sourceLine" id="cb305-23" title="23">    indices_pair <span class="op">=</span> np.array([CAs[<span class="dv">0</span>], CAs[<span class="dv">1</span>]])</a>
<a class="sourceLine" id="cb305-24" title="24">    <span class="cf">return</span> indices_pair</a>
<a class="sourceLine" id="cb305-25" title="25"></a>
<a class="sourceLine" id="cb305-26" title="26">my_indices_pair <span class="op">=</span> get_pair_indices(pdb_file)</a>
<a class="sourceLine" id="cb305-27" title="27">prompt_indices_pair <span class="op">=</span> get_ca_indices(pdb_file)</a>
<a class="sourceLine" id="cb305-28" title="28"></a>
<a class="sourceLine" id="cb305-29" title="29">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">all</span>(my_indices_pair <span class="op">==</span> prompt_indices_pair) <span class="cf">else</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb305-30" title="30"></a>
<a class="sourceLine" id="cb305-31" title="31"></a></code></pre></div>
<p>Output:</p>
<pre><code>&#39;Constant&#39; object has no attribute &#39;kind&#39;</code></pre>
<h4 id="run-4-27">Run 4</h4>
<div class="sourceCode" id="cb307"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb307-1" title="1"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb307-2" title="2"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb307-3" title="3"></a>
<a class="sourceLine" id="cb307-4" title="4"><span class="kw">def</span> get_ca_indices(pdb_file):</a>
<a class="sourceLine" id="cb307-5" title="5">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb307-6" title="6"><span class="co">  This function uploads a pdb file and find out the indices of first two alpha carbon atoms.</span></a>
<a class="sourceLine" id="cb307-7" title="7"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb307-8" title="8">  traj <span class="op">=</span> md.load(pdb_file)</a>
<a class="sourceLine" id="cb307-9" title="9">  top <span class="op">=</span> traj.topology</a>
<a class="sourceLine" id="cb307-10" title="10">  idx <span class="op">=</span> top.select(<span class="st">&#39;name CA&#39;</span>)</a>
<a class="sourceLine" id="cb307-11" title="11">  idx <span class="op">=</span> idx[<span class="dv">0</span>:<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb307-12" title="12">  <span class="cf">return</span> idx</a>
<a class="sourceLine" id="cb307-13" title="13"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb307-14" title="14"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb307-15" title="15"></a>
<a class="sourceLine" id="cb307-16" title="16">pdb_file <span class="op">=</span> os.path.join(_FILE_DIR_,<span class="st">&quot;1l2y.pdb&quot;</span>)</a>
<a class="sourceLine" id="cb307-17" title="17"></a>
<a class="sourceLine" id="cb307-18" title="18"><span class="kw">def</span> get_pair_indices(pdb_file):</a>
<a class="sourceLine" id="cb307-19" title="19">    <span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb307-20" title="20">    pdb <span class="op">=</span> md.load(pdb_file)</a>
<a class="sourceLine" id="cb307-21" title="21">    top <span class="op">=</span> pdb.topology</a>
<a class="sourceLine" id="cb307-22" title="22">    CAs <span class="op">=</span> [atom.index <span class="cf">for</span> atom <span class="kw">in</span> top.atoms <span class="cf">if</span> atom.name <span class="op">==</span> <span class="st">&#39;CA&#39;</span>]</a>
<a class="sourceLine" id="cb307-23" title="23">    indices_pair <span class="op">=</span> np.array([CAs[<span class="dv">0</span>], CAs[<span class="dv">1</span>]])</a>
<a class="sourceLine" id="cb307-24" title="24">    <span class="cf">return</span> indices_pair</a>
<a class="sourceLine" id="cb307-25" title="25"></a>
<a class="sourceLine" id="cb307-26" title="26">my_indices_pair <span class="op">=</span> get_pair_indices(pdb_file)</a>
<a class="sourceLine" id="cb307-27" title="27">prompt_indices_pair <span class="op">=</span> get_ca_indices(pdb_file)</a>
<a class="sourceLine" id="cb307-28" title="28"></a>
<a class="sourceLine" id="cb307-29" title="29">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">all</span>(my_indices_pair <span class="op">==</span> prompt_indices_pair) <span class="cf">else</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb307-30" title="30"></a>
<a class="sourceLine" id="cb307-31" title="31"></a></code></pre></div>
<p>Output:</p>
<pre><code>&#39;Constant&#39; object has no attribute &#39;kind&#39;</code></pre>
</details>
<details>
<p><summary>force_constant</summary></p>
<h4 id="query-28">Query</h4>
<div class="sourceCode" id="cb309"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb309-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb309-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb309-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb309-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb309-5" title="5"></a>
<a class="sourceLine" id="cb309-6" title="6"><span class="kw">def</span> compute_k(m1,m2,wave_len):</a>
<a class="sourceLine" id="cb309-7" title="7">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb309-8" title="8"><span class="co">    Two atom harmonic oscillator.</span></a>
<a class="sourceLine" id="cb309-9" title="9"><span class="co">    Returns force constant in kg/s**2 units given masses m1,m2 and wave length</span></a>
<a class="sourceLine" id="cb309-10" title="10"><span class="co">    wave_len. Masses are in kg units and wave length in cm^-1 units. Use reduced mass.</span></a>
<a class="sourceLine" id="cb309-11" title="11"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb309-12" title="12">    [insert]</a>
<a class="sourceLine" id="cb309-13" title="13">    <span class="cf">return</span> k</a></code></pre></div>
<h4 id="run-0-28">Run 0</h4>
<div class="sourceCode" id="cb310"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb310-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb310-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb310-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb310-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb310-5" title="5"></a>
<a class="sourceLine" id="cb310-6" title="6"><span class="kw">def</span> compute_k(m1,m2,wave_len):</a>
<a class="sourceLine" id="cb310-7" title="7">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb310-8" title="8"><span class="co">    Two atom harmonic oscillator.</span></a>
<a class="sourceLine" id="cb310-9" title="9"><span class="co">    Returns force constant in kg/s**2 units given masses m1,m2 and wave length</span></a>
<a class="sourceLine" id="cb310-10" title="10"><span class="co">    wave_len. Masses are in kg units and wave length in cm^-1 units. Use reduced mass.</span></a>
<a class="sourceLine" id="cb310-11" title="11"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb310-12" title="12">    k <span class="op">=</span> (m1<span class="op">*</span>m2)<span class="op">/</span>(m1<span class="op">+</span>m2)<span class="op">*</span>(wave_len<span class="op">*</span><span class="dv">100</span>)<span class="op">**</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb310-13" title="13">    <span class="cf">return</span> k</a>
<a class="sourceLine" id="cb310-14" title="14"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb310-15" title="15"></a>
<a class="sourceLine" id="cb310-16" title="16">m1 <span class="op">=</span> <span class="fl">12.0</span> <span class="co">#amu</span></a>
<a class="sourceLine" id="cb310-17" title="17">m2 <span class="op">=</span> <span class="fl">16.0</span> <span class="co">#amu</span></a>
<a class="sourceLine" id="cb310-18" title="18">wave_len <span class="op">=</span> <span class="dv">2100</span> <span class="co">#1/cm</span></a>
<a class="sourceLine" id="cb310-19" title="19">mass_fac <span class="op">=</span> <span class="fl">1.677e-27</span> <span class="co">#kg/amu</span></a>
<a class="sourceLine" id="cb310-20" title="20">velocity <span class="op">=</span> <span class="fl">2.99e10</span> <span class="co">#cm/s</span></a>
<a class="sourceLine" id="cb310-21" title="21">pi <span class="op">=</span> np.pi</a>
<a class="sourceLine" id="cb310-22" title="22"></a>
<a class="sourceLine" id="cb310-23" title="23">mu <span class="op">=</span> (m1<span class="op">*</span>m2)<span class="op">/</span>(m1<span class="op">+</span>m2)<span class="op">*</span>mass_fac </a>
<a class="sourceLine" id="cb310-24" title="24">omega <span class="op">=</span> <span class="dv">2</span><span class="op">*</span>pi<span class="op">*</span>wave_len<span class="op">*</span>velocity </a>
<a class="sourceLine" id="cb310-25" title="25">force_const <span class="op">=</span> mu<span class="op">*</span>omega<span class="op">**</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb310-26" title="26"></a>
<a class="sourceLine" id="cb310-27" title="27">force_const_codex <span class="op">=</span> compute_k(m1,m2,wave_len)</a>
<a class="sourceLine" id="cb310-28" title="28"></a>
<a class="sourceLine" id="cb310-29" title="29"><span class="cf">if</span> np.isclose(force_const, force_const_codex) <span class="op">==</span>  <span class="va">True</span>:</a>
<a class="sourceLine" id="cb310-30" title="30">    result <span class="op">=</span> <span class="va">True</span></a>
<a class="sourceLine" id="cb310-31" title="31"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb310-32" title="32">    result <span class="op">=</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-28">Run 1</h4>
<div class="sourceCode" id="cb312"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb312-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb312-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb312-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb312-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb312-5" title="5"></a>
<a class="sourceLine" id="cb312-6" title="6"><span class="kw">def</span> compute_k(m1,m2,wave_len):</a>
<a class="sourceLine" id="cb312-7" title="7">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb312-8" title="8"><span class="co">    Two atom harmonic oscillator.</span></a>
<a class="sourceLine" id="cb312-9" title="9"><span class="co">    Returns force constant in kg/s**2 units given masses m1,m2 and wave length</span></a>
<a class="sourceLine" id="cb312-10" title="10"><span class="co">    wave_len. Masses are in kg units and wave length in cm^-1 units. Use reduced mass.</span></a>
<a class="sourceLine" id="cb312-11" title="11"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb312-12" title="12">    k <span class="op">=</span> (<span class="fl">1.0</span><span class="op">/</span><span class="fl">2.0</span>)<span class="op">*</span>(m1<span class="op">*</span>m2)<span class="op">/</span>(m1<span class="op">+</span>m2)<span class="op">*</span>(wave_len<span class="op">*</span><span class="fl">1.0e-2</span>)<span class="op">**</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb312-13" title="13">    <span class="cf">return</span> k</a>
<a class="sourceLine" id="cb312-14" title="14"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb312-15" title="15"></a>
<a class="sourceLine" id="cb312-16" title="16">m1 <span class="op">=</span> <span class="fl">12.0</span> <span class="co">#amu</span></a>
<a class="sourceLine" id="cb312-17" title="17">m2 <span class="op">=</span> <span class="fl">16.0</span> <span class="co">#amu</span></a>
<a class="sourceLine" id="cb312-18" title="18">wave_len <span class="op">=</span> <span class="dv">2100</span> <span class="co">#1/cm</span></a>
<a class="sourceLine" id="cb312-19" title="19">mass_fac <span class="op">=</span> <span class="fl">1.677e-27</span> <span class="co">#kg/amu</span></a>
<a class="sourceLine" id="cb312-20" title="20">velocity <span class="op">=</span> <span class="fl">2.99e10</span> <span class="co">#cm/s</span></a>
<a class="sourceLine" id="cb312-21" title="21">pi <span class="op">=</span> np.pi</a>
<a class="sourceLine" id="cb312-22" title="22"></a>
<a class="sourceLine" id="cb312-23" title="23">mu <span class="op">=</span> (m1<span class="op">*</span>m2)<span class="op">/</span>(m1<span class="op">+</span>m2)<span class="op">*</span>mass_fac </a>
<a class="sourceLine" id="cb312-24" title="24">omega <span class="op">=</span> <span class="dv">2</span><span class="op">*</span>pi<span class="op">*</span>wave_len<span class="op">*</span>velocity </a>
<a class="sourceLine" id="cb312-25" title="25">force_const <span class="op">=</span> mu<span class="op">*</span>omega<span class="op">**</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb312-26" title="26"></a>
<a class="sourceLine" id="cb312-27" title="27">force_const_codex <span class="op">=</span> compute_k(m1,m2,wave_len)</a>
<a class="sourceLine" id="cb312-28" title="28"></a>
<a class="sourceLine" id="cb312-29" title="29"><span class="cf">if</span> np.isclose(force_const, force_const_codex) <span class="op">==</span>  <span class="va">True</span>:</a>
<a class="sourceLine" id="cb312-30" title="30">    result <span class="op">=</span> <span class="va">True</span></a>
<a class="sourceLine" id="cb312-31" title="31"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb312-32" title="32">    result <span class="op">=</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-28">Run 2</h4>
<div class="sourceCode" id="cb314"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb314-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb314-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb314-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb314-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb314-5" title="5"></a>
<a class="sourceLine" id="cb314-6" title="6"><span class="kw">def</span> compute_k(m1,m2,wave_len):</a>
<a class="sourceLine" id="cb314-7" title="7">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb314-8" title="8"><span class="co">    Two atom harmonic oscillator.</span></a>
<a class="sourceLine" id="cb314-9" title="9"><span class="co">    Returns force constant in kg/s**2 units given masses m1,m2 and wave length</span></a>
<a class="sourceLine" id="cb314-10" title="10"><span class="co">    wave_len. Masses are in kg units and wave length in cm^-1 units. Use reduced mass.</span></a>
<a class="sourceLine" id="cb314-11" title="11"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb314-12" title="12">    k <span class="op">=</span> (<span class="fl">1.98644568e-23</span><span class="op">*</span>(<span class="fl">1.0e8</span>)<span class="op">**</span><span class="dv">2</span>)<span class="op">/</span>(wave_len<span class="op">*</span>(m1<span class="op">*</span>m2<span class="op">/</span>(m1<span class="op">+</span>m2))<span class="op">*</span><span class="fl">1.0e-8</span>)</a>
<a class="sourceLine" id="cb314-13" title="13">    <span class="cf">return</span> k</a>
<a class="sourceLine" id="cb314-14" title="14"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb314-15" title="15"></a>
<a class="sourceLine" id="cb314-16" title="16">m1 <span class="op">=</span> <span class="fl">12.0</span> <span class="co">#amu</span></a>
<a class="sourceLine" id="cb314-17" title="17">m2 <span class="op">=</span> <span class="fl">16.0</span> <span class="co">#amu</span></a>
<a class="sourceLine" id="cb314-18" title="18">wave_len <span class="op">=</span> <span class="dv">2100</span> <span class="co">#1/cm</span></a>
<a class="sourceLine" id="cb314-19" title="19">mass_fac <span class="op">=</span> <span class="fl">1.677e-27</span> <span class="co">#kg/amu</span></a>
<a class="sourceLine" id="cb314-20" title="20">velocity <span class="op">=</span> <span class="fl">2.99e10</span> <span class="co">#cm/s</span></a>
<a class="sourceLine" id="cb314-21" title="21">pi <span class="op">=</span> np.pi</a>
<a class="sourceLine" id="cb314-22" title="22"></a>
<a class="sourceLine" id="cb314-23" title="23">mu <span class="op">=</span> (m1<span class="op">*</span>m2)<span class="op">/</span>(m1<span class="op">+</span>m2)<span class="op">*</span>mass_fac </a>
<a class="sourceLine" id="cb314-24" title="24">omega <span class="op">=</span> <span class="dv">2</span><span class="op">*</span>pi<span class="op">*</span>wave_len<span class="op">*</span>velocity </a>
<a class="sourceLine" id="cb314-25" title="25">force_const <span class="op">=</span> mu<span class="op">*</span>omega<span class="op">**</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb314-26" title="26"></a>
<a class="sourceLine" id="cb314-27" title="27">force_const_codex <span class="op">=</span> compute_k(m1,m2,wave_len)</a>
<a class="sourceLine" id="cb314-28" title="28"></a>
<a class="sourceLine" id="cb314-29" title="29"><span class="cf">if</span> np.isclose(force_const, force_const_codex) <span class="op">==</span>  <span class="va">True</span>:</a>
<a class="sourceLine" id="cb314-30" title="30">    result <span class="op">=</span> <span class="va">True</span></a>
<a class="sourceLine" id="cb314-31" title="31"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb314-32" title="32">    result <span class="op">=</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-28">Run 3</h4>
<div class="sourceCode" id="cb316"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb316-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb316-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb316-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb316-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb316-5" title="5"></a>
<a class="sourceLine" id="cb316-6" title="6"><span class="kw">def</span> compute_k(m1,m2,wave_len):</a>
<a class="sourceLine" id="cb316-7" title="7">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb316-8" title="8"><span class="co">    Two atom harmonic oscillator.</span></a>
<a class="sourceLine" id="cb316-9" title="9"><span class="co">    Returns force constant in kg/s**2 units given masses m1,m2 and wave length</span></a>
<a class="sourceLine" id="cb316-10" title="10"><span class="co">    wave_len. Masses are in kg units and wave length in cm^-1 units. Use reduced mass.</span></a>
<a class="sourceLine" id="cb316-11" title="11"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb316-12" title="12">    k <span class="op">=</span> (m1<span class="op">*</span>m2)<span class="op">/</span>(m1<span class="op">+</span>m2)<span class="op">*</span>(wave_len<span class="op">*</span><span class="fl">1.0e-2</span>)<span class="op">**</span><span class="dv">2</span><span class="op">*</span><span class="fl">1.0e-8</span></a>
<a class="sourceLine" id="cb316-13" title="13">    <span class="cf">return</span> k</a>
<a class="sourceLine" id="cb316-14" title="14"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb316-15" title="15"></a>
<a class="sourceLine" id="cb316-16" title="16">m1 <span class="op">=</span> <span class="fl">12.0</span> <span class="co">#amu</span></a>
<a class="sourceLine" id="cb316-17" title="17">m2 <span class="op">=</span> <span class="fl">16.0</span> <span class="co">#amu</span></a>
<a class="sourceLine" id="cb316-18" title="18">wave_len <span class="op">=</span> <span class="dv">2100</span> <span class="co">#1/cm</span></a>
<a class="sourceLine" id="cb316-19" title="19">mass_fac <span class="op">=</span> <span class="fl">1.677e-27</span> <span class="co">#kg/amu</span></a>
<a class="sourceLine" id="cb316-20" title="20">velocity <span class="op">=</span> <span class="fl">2.99e10</span> <span class="co">#cm/s</span></a>
<a class="sourceLine" id="cb316-21" title="21">pi <span class="op">=</span> np.pi</a>
<a class="sourceLine" id="cb316-22" title="22"></a>
<a class="sourceLine" id="cb316-23" title="23">mu <span class="op">=</span> (m1<span class="op">*</span>m2)<span class="op">/</span>(m1<span class="op">+</span>m2)<span class="op">*</span>mass_fac </a>
<a class="sourceLine" id="cb316-24" title="24">omega <span class="op">=</span> <span class="dv">2</span><span class="op">*</span>pi<span class="op">*</span>wave_len<span class="op">*</span>velocity </a>
<a class="sourceLine" id="cb316-25" title="25">force_const <span class="op">=</span> mu<span class="op">*</span>omega<span class="op">**</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb316-26" title="26"></a>
<a class="sourceLine" id="cb316-27" title="27">force_const_codex <span class="op">=</span> compute_k(m1,m2,wave_len)</a>
<a class="sourceLine" id="cb316-28" title="28"></a>
<a class="sourceLine" id="cb316-29" title="29"><span class="cf">if</span> np.isclose(force_const, force_const_codex) <span class="op">==</span>  <span class="va">True</span>:</a>
<a class="sourceLine" id="cb316-30" title="30">    result <span class="op">=</span> <span class="va">True</span></a>
<a class="sourceLine" id="cb316-31" title="31"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb316-32" title="32">    result <span class="op">=</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-28">Run 4</h4>
<div class="sourceCode" id="cb318"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb318-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb318-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb318-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb318-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb318-5" title="5"></a>
<a class="sourceLine" id="cb318-6" title="6"><span class="kw">def</span> compute_k(m1,m2,wave_len):</a>
<a class="sourceLine" id="cb318-7" title="7">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb318-8" title="8"><span class="co">    Two atom harmonic oscillator.</span></a>
<a class="sourceLine" id="cb318-9" title="9"><span class="co">    Returns force constant in kg/s**2 units given masses m1,m2 and wave length</span></a>
<a class="sourceLine" id="cb318-10" title="10"><span class="co">    wave_len. Masses are in kg units and wave length in cm^-1 units. Use reduced mass.</span></a>
<a class="sourceLine" id="cb318-11" title="11"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb318-12" title="12">    k <span class="op">=</span> (m1<span class="op">*</span>m2)<span class="op">/</span>(m1<span class="op">+</span>m2)<span class="op">*</span>(<span class="dv">2</span><span class="op">*</span>np.pi<span class="op">*</span><span class="fl">1.98644568e-23</span><span class="op">*</span><span class="fl">6.022140857e23</span><span class="op">*</span>wave_len<span class="op">*</span><span class="fl">1e-2</span>)<span class="op">**</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb318-13" title="13">    <span class="cf">return</span> k</a>
<a class="sourceLine" id="cb318-14" title="14"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb318-15" title="15"></a>
<a class="sourceLine" id="cb318-16" title="16">m1 <span class="op">=</span> <span class="fl">12.0</span> <span class="co">#amu</span></a>
<a class="sourceLine" id="cb318-17" title="17">m2 <span class="op">=</span> <span class="fl">16.0</span> <span class="co">#amu</span></a>
<a class="sourceLine" id="cb318-18" title="18">wave_len <span class="op">=</span> <span class="dv">2100</span> <span class="co">#1/cm</span></a>
<a class="sourceLine" id="cb318-19" title="19">mass_fac <span class="op">=</span> <span class="fl">1.677e-27</span> <span class="co">#kg/amu</span></a>
<a class="sourceLine" id="cb318-20" title="20">velocity <span class="op">=</span> <span class="fl">2.99e10</span> <span class="co">#cm/s</span></a>
<a class="sourceLine" id="cb318-21" title="21">pi <span class="op">=</span> np.pi</a>
<a class="sourceLine" id="cb318-22" title="22"></a>
<a class="sourceLine" id="cb318-23" title="23">mu <span class="op">=</span> (m1<span class="op">*</span>m2)<span class="op">/</span>(m1<span class="op">+</span>m2)<span class="op">*</span>mass_fac </a>
<a class="sourceLine" id="cb318-24" title="24">omega <span class="op">=</span> <span class="dv">2</span><span class="op">*</span>pi<span class="op">*</span>wave_len<span class="op">*</span>velocity </a>
<a class="sourceLine" id="cb318-25" title="25">force_const <span class="op">=</span> mu<span class="op">*</span>omega<span class="op">**</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb318-26" title="26"></a>
<a class="sourceLine" id="cb318-27" title="27">force_const_codex <span class="op">=</span> compute_k(m1,m2,wave_len)</a>
<a class="sourceLine" id="cb318-28" title="28"></a>
<a class="sourceLine" id="cb318-29" title="29"><span class="cf">if</span> np.isclose(force_const, force_const_codex) <span class="op">==</span>  <span class="va">True</span>:</a>
<a class="sourceLine" id="cb318-30" title="30">    result <span class="op">=</span> <span class="va">True</span></a>
<a class="sourceLine" id="cb318-31" title="31"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb318-32" title="32">    result <span class="op">=</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>fourier_1d</summary></p>
<h4 id="query-29">Query</h4>
<div class="sourceCode" id="cb320"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb320-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb320-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb320-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb320-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb320-5" title="5"></a>
<a class="sourceLine" id="cb320-6" title="6"><span class="kw">def</span> fourier_1d(x):</a>
<a class="sourceLine" id="cb320-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb320-8" title="8"><span class="co">  This function returns the one dimensional fourier transform of array x.</span></a>
<a class="sourceLine" id="cb320-9" title="9"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb320-10" title="10">  [insert]</a>
<a class="sourceLine" id="cb320-11" title="11">  <span class="cf">return</span> w</a></code></pre></div>
<h4 id="run-0-29">Run 0</h4>
<div class="sourceCode" id="cb321"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb321-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb321-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb321-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb321-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb321-5" title="5"></a>
<a class="sourceLine" id="cb321-6" title="6"><span class="kw">def</span> fourier_1d(x):</a>
<a class="sourceLine" id="cb321-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb321-8" title="8"><span class="co">  This function returns the one dimensional fourier transform of array x.</span></a>
<a class="sourceLine" id="cb321-9" title="9"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb321-10" title="10">  N <span class="op">=</span> <span class="bu">len</span>(x)</a>
<a class="sourceLine" id="cb321-11" title="11">  w <span class="op">=</span> np.zeros(N, dtype<span class="op">=</span><span class="bu">complex</span>)</a>
<a class="sourceLine" id="cb321-12" title="12">  <span class="cf">for</span> k <span class="kw">in</span> <span class="bu">range</span>(N):</a>
<a class="sourceLine" id="cb321-13" title="13">    <span class="cf">for</span> n <span class="kw">in</span> <span class="bu">range</span>(N):</a>
<a class="sourceLine" id="cb321-14" title="14">      w[k] <span class="op">+=</span> x[n]<span class="op">*</span>np.exp(<span class="op">-</span>2j<span class="op">*</span>np.pi<span class="op">*</span>k<span class="op">*</span>n<span class="op">/</span>N)</a>
<a class="sourceLine" id="cb321-15" title="15"></a>
<a class="sourceLine" id="cb321-16" title="16">  <span class="cf">return</span> w</a>
<a class="sourceLine" id="cb321-17" title="17"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb321-18" title="18"><span class="im">from</span> numpy.fft <span class="im">import</span> fft</a>
<a class="sourceLine" id="cb321-19" title="19"></a>
<a class="sourceLine" id="cb321-20" title="20">x <span class="op">=</span> np.array([<span class="fl">1.0</span>, <span class="fl">2.0</span>, <span class="fl">1.0</span>, <span class="fl">-1.0</span>, <span class="fl">1.5</span>])</a>
<a class="sourceLine" id="cb321-21" title="21"></a>
<a class="sourceLine" id="cb321-22" title="22">true_y <span class="op">=</span> fft(x)</a>
<a class="sourceLine" id="cb321-23" title="23"></a>
<a class="sourceLine" id="cb321-24" title="24">test_y <span class="op">=</span> fourier_1d(x)</a>
<a class="sourceLine" id="cb321-25" title="25"></a>
<a class="sourceLine" id="cb321-26" title="26">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.allclose(true_y, test_y) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-29">Run 1</h4>
<div class="sourceCode" id="cb323"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb323-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb323-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb323-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb323-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb323-5" title="5"></a>
<a class="sourceLine" id="cb323-6" title="6"><span class="kw">def</span> fourier_1d(x):</a>
<a class="sourceLine" id="cb323-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb323-8" title="8"><span class="co">  This function returns the one dimensional fourier transform of array x.</span></a>
<a class="sourceLine" id="cb323-9" title="9"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb323-10" title="10">  N <span class="op">=</span> x.shape[<span class="dv">0</span>]</a>
<a class="sourceLine" id="cb323-11" title="11">  w <span class="op">=</span> np.zeros(N, dtype<span class="op">=</span>np.<span class="bu">complex</span>)</a>
<a class="sourceLine" id="cb323-12" title="12">  <span class="cf">for</span> k <span class="kw">in</span> <span class="bu">range</span>(N):</a>
<a class="sourceLine" id="cb323-13" title="13">    <span class="cf">for</span> n <span class="kw">in</span> <span class="bu">range</span>(N):</a>
<a class="sourceLine" id="cb323-14" title="14">      w[k] <span class="op">+=</span> x[n]<span class="op">*</span>np.exp(<span class="op">-</span><span class="dv">2</span><span class="op">*</span>np.pi<span class="op">*</span>1j<span class="op">*</span>k<span class="op">*</span>n<span class="op">/</span>N)</a>
<a class="sourceLine" id="cb323-15" title="15">  <span class="cf">return</span> w</a>
<a class="sourceLine" id="cb323-16" title="16"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb323-17" title="17"><span class="im">from</span> numpy.fft <span class="im">import</span> fft</a>
<a class="sourceLine" id="cb323-18" title="18"></a>
<a class="sourceLine" id="cb323-19" title="19">x <span class="op">=</span> np.array([<span class="fl">1.0</span>, <span class="fl">2.0</span>, <span class="fl">1.0</span>, <span class="fl">-1.0</span>, <span class="fl">1.5</span>])</a>
<a class="sourceLine" id="cb323-20" title="20"></a>
<a class="sourceLine" id="cb323-21" title="21">true_y <span class="op">=</span> fft(x)</a>
<a class="sourceLine" id="cb323-22" title="22"></a>
<a class="sourceLine" id="cb323-23" title="23">test_y <span class="op">=</span> fourier_1d(x)</a>
<a class="sourceLine" id="cb323-24" title="24"></a>
<a class="sourceLine" id="cb323-25" title="25">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.allclose(true_y, test_y) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-29">Run 2</h4>
<div class="sourceCode" id="cb325"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb325-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb325-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb325-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb325-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb325-5" title="5"></a>
<a class="sourceLine" id="cb325-6" title="6"><span class="kw">def</span> fourier_1d(x):</a>
<a class="sourceLine" id="cb325-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb325-8" title="8"><span class="co">  This function returns the one dimensional fourier transform of array x.</span></a>
<a class="sourceLine" id="cb325-9" title="9"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb325-10" title="10">  N <span class="op">=</span> <span class="bu">len</span>(x)</a>
<a class="sourceLine" id="cb325-11" title="11">  w <span class="op">=</span> np.zeros(N, dtype<span class="op">=</span><span class="bu">complex</span>)</a>
<a class="sourceLine" id="cb325-12" title="12">  <span class="cf">for</span> k <span class="kw">in</span> <span class="bu">range</span>(N):</a>
<a class="sourceLine" id="cb325-13" title="13">    <span class="cf">for</span> n <span class="kw">in</span> <span class="bu">range</span>(N):</a>
<a class="sourceLine" id="cb325-14" title="14">      w[k] <span class="op">+=</span> x[n]<span class="op">*</span>np.exp(<span class="op">-</span>2j<span class="op">*</span>np.pi<span class="op">*</span>k<span class="op">*</span>n<span class="op">/</span>N)</a>
<a class="sourceLine" id="cb325-15" title="15">  <span class="cf">return</span> w</a>
<a class="sourceLine" id="cb325-16" title="16"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb325-17" title="17"><span class="im">from</span> numpy.fft <span class="im">import</span> fft</a>
<a class="sourceLine" id="cb325-18" title="18"></a>
<a class="sourceLine" id="cb325-19" title="19">x <span class="op">=</span> np.array([<span class="fl">1.0</span>, <span class="fl">2.0</span>, <span class="fl">1.0</span>, <span class="fl">-1.0</span>, <span class="fl">1.5</span>])</a>
<a class="sourceLine" id="cb325-20" title="20"></a>
<a class="sourceLine" id="cb325-21" title="21">true_y <span class="op">=</span> fft(x)</a>
<a class="sourceLine" id="cb325-22" title="22"></a>
<a class="sourceLine" id="cb325-23" title="23">test_y <span class="op">=</span> fourier_1d(x)</a>
<a class="sourceLine" id="cb325-24" title="24"></a>
<a class="sourceLine" id="cb325-25" title="25">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.allclose(true_y, test_y) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-29">Run 3</h4>
<div class="sourceCode" id="cb327"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb327-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb327-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb327-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb327-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb327-5" title="5"></a>
<a class="sourceLine" id="cb327-6" title="6"><span class="kw">def</span> fourier_1d(x):</a>
<a class="sourceLine" id="cb327-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb327-8" title="8"><span class="co">  This function returns the one dimensional fourier transform of array x.</span></a>
<a class="sourceLine" id="cb327-9" title="9"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb327-10" title="10">  N <span class="op">=</span> <span class="bu">len</span>(x)</a>
<a class="sourceLine" id="cb327-11" title="11">  w <span class="op">=</span> np.zeros(N, dtype<span class="op">=</span>np.<span class="bu">complex</span>)</a>
<a class="sourceLine" id="cb327-12" title="12">  <span class="cf">for</span> k <span class="kw">in</span> <span class="bu">range</span>(N):</a>
<a class="sourceLine" id="cb327-13" title="13">    <span class="cf">for</span> n <span class="kw">in</span> <span class="bu">range</span>(N):</a>
<a class="sourceLine" id="cb327-14" title="14">      w[k] <span class="op">+=</span> x[n] <span class="op">*</span> np.exp(<span class="op">-</span>2j <span class="op">*</span> np.pi <span class="op">*</span> k <span class="op">*</span> n <span class="op">/</span> N)</a>
<a class="sourceLine" id="cb327-15" title="15">  <span class="cf">return</span> w</a>
<a class="sourceLine" id="cb327-16" title="16"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb327-17" title="17"><span class="im">from</span> numpy.fft <span class="im">import</span> fft</a>
<a class="sourceLine" id="cb327-18" title="18"></a>
<a class="sourceLine" id="cb327-19" title="19">x <span class="op">=</span> np.array([<span class="fl">1.0</span>, <span class="fl">2.0</span>, <span class="fl">1.0</span>, <span class="fl">-1.0</span>, <span class="fl">1.5</span>])</a>
<a class="sourceLine" id="cb327-20" title="20"></a>
<a class="sourceLine" id="cb327-21" title="21">true_y <span class="op">=</span> fft(x)</a>
<a class="sourceLine" id="cb327-22" title="22"></a>
<a class="sourceLine" id="cb327-23" title="23">test_y <span class="op">=</span> fourier_1d(x)</a>
<a class="sourceLine" id="cb327-24" title="24"></a>
<a class="sourceLine" id="cb327-25" title="25">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.allclose(true_y, test_y) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-29">Run 4</h4>
<div class="sourceCode" id="cb329"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb329-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb329-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb329-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb329-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb329-5" title="5"></a>
<a class="sourceLine" id="cb329-6" title="6"><span class="kw">def</span> fourier_1d(x):</a>
<a class="sourceLine" id="cb329-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb329-8" title="8"><span class="co">  This function returns the one dimensional fourier transform of array x.</span></a>
<a class="sourceLine" id="cb329-9" title="9"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb329-10" title="10">  N <span class="op">=</span> <span class="bu">len</span>(x)</a>
<a class="sourceLine" id="cb329-11" title="11">  w <span class="op">=</span> np.zeros(N, dtype<span class="op">=</span><span class="bu">complex</span>)</a>
<a class="sourceLine" id="cb329-12" title="12">  <span class="cf">for</span> k <span class="kw">in</span> <span class="bu">range</span>(N):</a>
<a class="sourceLine" id="cb329-13" title="13">    <span class="cf">for</span> n <span class="kw">in</span> <span class="bu">range</span>(N):</a>
<a class="sourceLine" id="cb329-14" title="14">      w[k] <span class="op">+=</span> x[n]<span class="op">*</span>np.exp(<span class="op">-</span>2j<span class="op">*</span>np.pi<span class="op">*</span>k<span class="op">*</span>n<span class="op">/</span>N)</a>
<a class="sourceLine" id="cb329-15" title="15">  <span class="cf">return</span> w</a>
<a class="sourceLine" id="cb329-16" title="16"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb329-17" title="17"><span class="im">from</span> numpy.fft <span class="im">import</span> fft</a>
<a class="sourceLine" id="cb329-18" title="18"></a>
<a class="sourceLine" id="cb329-19" title="19">x <span class="op">=</span> np.array([<span class="fl">1.0</span>, <span class="fl">2.0</span>, <span class="fl">1.0</span>, <span class="fl">-1.0</span>, <span class="fl">1.5</span>])</a>
<a class="sourceLine" id="cb329-20" title="20"></a>
<a class="sourceLine" id="cb329-21" title="21">true_y <span class="op">=</span> fft(x)</a>
<a class="sourceLine" id="cb329-22" title="22"></a>
<a class="sourceLine" id="cb329-23" title="23">test_y <span class="op">=</span> fourier_1d(x)</a>
<a class="sourceLine" id="cb329-24" title="24"></a>
<a class="sourceLine" id="cb329-25" title="25">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.allclose(true_y, test_y) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>freezing_depression</summary></p>
<h4 id="query-30">Query</h4>
<div class="sourceCode" id="cb331"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb331-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb331-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb331-3" title="3"></a>
<a class="sourceLine" id="cb331-4" title="4"><span class="kw">def</span> freezing_depression(Kf,m):</a>
<a class="sourceLine" id="cb331-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb331-6" title="6"><span class="co">   This function returns the decrease in freezing point in Kelvin</span></a>
<a class="sourceLine" id="cb331-7" title="7"><span class="co">   The depression constant is Kf in K kg/mol and is greater than zero</span></a>
<a class="sourceLine" id="cb331-8" title="8"><span class="co">   Molality m is given in mol/kg</span></a>
<a class="sourceLine" id="cb331-9" title="9"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb331-10" title="10">   [insert]</a>
<a class="sourceLine" id="cb331-11" title="11">   <span class="cf">return</span> deltaT</a></code></pre></div>
<h4 id="run-0-30">Run 0</h4>
<div class="sourceCode" id="cb332"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb332-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb332-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb332-3" title="3"></a>
<a class="sourceLine" id="cb332-4" title="4"><span class="kw">def</span> freezing_depression(Kf,m):</a>
<a class="sourceLine" id="cb332-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb332-6" title="6"><span class="co">   This function returns the decrease in freezing point in Kelvin</span></a>
<a class="sourceLine" id="cb332-7" title="7"><span class="co">   The depression constant is Kf in K kg/mol and is greater than zero</span></a>
<a class="sourceLine" id="cb332-8" title="8"><span class="co">   Molality m is given in mol/kg</span></a>
<a class="sourceLine" id="cb332-9" title="9"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb332-10" title="10">   deltaT <span class="op">=</span> Kf<span class="op">*</span>m</a>
<a class="sourceLine" id="cb332-11" title="11">   <span class="cf">return</span> deltaT</a>
<a class="sourceLine" id="cb332-12" title="12"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb332-13" title="13">molality <span class="op">=</span> <span class="fl">0.1</span></a>
<a class="sourceLine" id="cb332-14" title="14">depression_constant <span class="op">=</span> <span class="fl">-0.512</span></a>
<a class="sourceLine" id="cb332-15" title="15">dT <span class="op">=</span> depression_constant<span class="op">*</span>molality</a>
<a class="sourceLine" id="cb332-16" title="16">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">abs</span>(freezing_depression(depression_constant,molality)<span class="op">-</span>dT)<span class="op">&lt;</span><span class="fl">0.01</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-30">Run 1</h4>
<div class="sourceCode" id="cb334"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb334-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb334-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb334-3" title="3"></a>
<a class="sourceLine" id="cb334-4" title="4"><span class="kw">def</span> freezing_depression(Kf,m):</a>
<a class="sourceLine" id="cb334-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb334-6" title="6"><span class="co">   This function returns the decrease in freezing point in Kelvin</span></a>
<a class="sourceLine" id="cb334-7" title="7"><span class="co">   The depression constant is Kf in K kg/mol and is greater than zero</span></a>
<a class="sourceLine" id="cb334-8" title="8"><span class="co">   Molality m is given in mol/kg</span></a>
<a class="sourceLine" id="cb334-9" title="9"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb334-10" title="10">   deltaT <span class="op">=</span> Kf<span class="op">*</span>m</a>
<a class="sourceLine" id="cb334-11" title="11">   <span class="cf">return</span> deltaT</a>
<a class="sourceLine" id="cb334-12" title="12"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb334-13" title="13">molality <span class="op">=</span> <span class="fl">0.1</span></a>
<a class="sourceLine" id="cb334-14" title="14">depression_constant <span class="op">=</span> <span class="fl">-0.512</span></a>
<a class="sourceLine" id="cb334-15" title="15">dT <span class="op">=</span> depression_constant<span class="op">*</span>molality</a>
<a class="sourceLine" id="cb334-16" title="16">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">abs</span>(freezing_depression(depression_constant,molality)<span class="op">-</span>dT)<span class="op">&lt;</span><span class="fl">0.01</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-30">Run 2</h4>
<div class="sourceCode" id="cb336"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb336-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb336-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb336-3" title="3"></a>
<a class="sourceLine" id="cb336-4" title="4"><span class="kw">def</span> freezing_depression(Kf,m):</a>
<a class="sourceLine" id="cb336-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb336-6" title="6"><span class="co">   This function returns the decrease in freezing point in Kelvin</span></a>
<a class="sourceLine" id="cb336-7" title="7"><span class="co">   The depression constant is Kf in K kg/mol and is greater than zero</span></a>
<a class="sourceLine" id="cb336-8" title="8"><span class="co">   Molality m is given in mol/kg</span></a>
<a class="sourceLine" id="cb336-9" title="9"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb336-10" title="10">   deltaT <span class="op">=</span> Kf<span class="op">*</span>m</a>
<a class="sourceLine" id="cb336-11" title="11">   <span class="cf">return</span> deltaT</a>
<a class="sourceLine" id="cb336-12" title="12"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb336-13" title="13">molality <span class="op">=</span> <span class="fl">0.1</span></a>
<a class="sourceLine" id="cb336-14" title="14">depression_constant <span class="op">=</span> <span class="fl">-0.512</span></a>
<a class="sourceLine" id="cb336-15" title="15">dT <span class="op">=</span> depression_constant<span class="op">*</span>molality</a>
<a class="sourceLine" id="cb336-16" title="16">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">abs</span>(freezing_depression(depression_constant,molality)<span class="op">-</span>dT)<span class="op">&lt;</span><span class="fl">0.01</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-30">Run 3</h4>
<div class="sourceCode" id="cb338"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb338-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb338-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb338-3" title="3"></a>
<a class="sourceLine" id="cb338-4" title="4"><span class="kw">def</span> freezing_depression(Kf,m):</a>
<a class="sourceLine" id="cb338-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb338-6" title="6"><span class="co">   This function returns the decrease in freezing point in Kelvin</span></a>
<a class="sourceLine" id="cb338-7" title="7"><span class="co">   The depression constant is Kf in K kg/mol and is greater than zero</span></a>
<a class="sourceLine" id="cb338-8" title="8"><span class="co">   Molality m is given in mol/kg</span></a>
<a class="sourceLine" id="cb338-9" title="9"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb338-10" title="10">   deltaT <span class="op">=</span> Kf <span class="op">*</span> m</a>
<a class="sourceLine" id="cb338-11" title="11">   <span class="cf">return</span> deltaT</a>
<a class="sourceLine" id="cb338-12" title="12"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb338-13" title="13">molality <span class="op">=</span> <span class="fl">0.1</span></a>
<a class="sourceLine" id="cb338-14" title="14">depression_constant <span class="op">=</span> <span class="fl">-0.512</span></a>
<a class="sourceLine" id="cb338-15" title="15">dT <span class="op">=</span> depression_constant<span class="op">*</span>molality</a>
<a class="sourceLine" id="cb338-16" title="16">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">abs</span>(freezing_depression(depression_constant,molality)<span class="op">-</span>dT)<span class="op">&lt;</span><span class="fl">0.01</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-30">Run 4</h4>
<div class="sourceCode" id="cb340"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb340-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb340-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb340-3" title="3"></a>
<a class="sourceLine" id="cb340-4" title="4"><span class="kw">def</span> freezing_depression(Kf,m):</a>
<a class="sourceLine" id="cb340-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb340-6" title="6"><span class="co">   This function returns the decrease in freezing point in Kelvin</span></a>
<a class="sourceLine" id="cb340-7" title="7"><span class="co">   The depression constant is Kf in K kg/mol and is greater than zero</span></a>
<a class="sourceLine" id="cb340-8" title="8"><span class="co">   Molality m is given in mol/kg</span></a>
<a class="sourceLine" id="cb340-9" title="9"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb340-10" title="10">   deltaT <span class="op">=</span> Kf<span class="op">*</span>m</a>
<a class="sourceLine" id="cb340-11" title="11">   <span class="cf">return</span> deltaT</a>
<a class="sourceLine" id="cb340-12" title="12"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb340-13" title="13">molality <span class="op">=</span> <span class="fl">0.1</span></a>
<a class="sourceLine" id="cb340-14" title="14">depression_constant <span class="op">=</span> <span class="fl">-0.512</span></a>
<a class="sourceLine" id="cb340-15" title="15">dT <span class="op">=</span> depression_constant<span class="op">*</span>molality</a>
<a class="sourceLine" id="cb340-16" title="16">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">abs</span>(freezing_depression(depression_constant,molality)<span class="op">-</span>dT)<span class="op">&lt;</span><span class="fl">0.01</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>genpos</summary></p>
<h4 id="query-31">Query</h4>
<div class="sourceCode" id="cb342"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb342-1" title="1"><span class="im">import</span> requests</a>
<a class="sourceLine" id="cb342-2" title="2"><span class="im">from</span> bs4 <span class="im">import</span> BeautifulSoup</a>
<a class="sourceLine" id="cb342-3" title="3"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb342-4" title="4"></a>
<a class="sourceLine" id="cb342-5" title="5"><span class="kw">def</span> matrix_generators(gnum):</a>
<a class="sourceLine" id="cb342-6" title="6">    <span class="co">&quot;&quot;&quot; Returns list of matrix generators for general positions of given space group</span></a>
<a class="sourceLine" id="cb342-7" title="7"><span class="co">    gnum -  International Tables for Crystallography space group number</span></a>
<a class="sourceLine" id="cb342-8" title="8"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb342-9" title="9">    [insert]</a>
<a class="sourceLine" id="cb342-10" title="10">    <span class="cf">return</span> generators</a></code></pre></div>
<h4 id="run-0-31">Run 0</h4>
<div class="sourceCode" id="cb343"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb343-1" title="1"><span class="im">import</span> requests</a>
<a class="sourceLine" id="cb343-2" title="2"><span class="im">from</span> bs4 <span class="im">import</span> BeautifulSoup</a>
<a class="sourceLine" id="cb343-3" title="3"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb343-4" title="4"></a>
<a class="sourceLine" id="cb343-5" title="5"><span class="kw">def</span> matrix_generators(gnum):</a>
<a class="sourceLine" id="cb343-6" title="6">    <span class="co">&quot;&quot;&quot; Returns list of matrix generators for general positions of given space group</span></a>
<a class="sourceLine" id="cb343-7" title="7"><span class="co">    gnum -  International Tables for Crystallography space group number</span></a>
<a class="sourceLine" id="cb343-8" title="8"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb343-9" title="9">    url <span class="op">=</span> <span class="st">&#39;http://www.cryst.ehu.es/cgi-bin/cryst/programs/nph-gen-matrices?gnum=&#39;</span><span class="op">+</span><span class="bu">str</span>(gnum)</a>
<a class="sourceLine" id="cb343-10" title="10">    r <span class="op">=</span> requests.get(url)</a>
<a class="sourceLine" id="cb343-11" title="11">    soup <span class="op">=</span> BeautifulSoup(r.text, <span class="st">&#39;html.parser&#39;</span>)</a>
<a class="sourceLine" id="cb343-12" title="12">    table <span class="op">=</span> soup.find_all(<span class="st">&#39;table&#39;</span>)[<span class="dv">0</span>]</a>
<a class="sourceLine" id="cb343-13" title="13">    rows <span class="op">=</span> table.find_all(<span class="st">&#39;tr&#39;</span>)</a>
<a class="sourceLine" id="cb343-14" title="14">    generators <span class="op">=</span> []</a>
<a class="sourceLine" id="cb343-15" title="15">    <span class="cf">for</span> row <span class="kw">in</span> rows:</a>
<a class="sourceLine" id="cb343-16" title="16">        cols <span class="op">=</span> row.find_all(<span class="st">&#39;td&#39;</span>)</a>
<a class="sourceLine" id="cb343-17" title="17">        cols <span class="op">=</span> [ele.text.strip() <span class="cf">for</span> ele <span class="kw">in</span> cols]</a>
<a class="sourceLine" id="cb343-18" title="18">        generators.append(cols)</a>
<a class="sourceLine" id="cb343-19" title="19">    generators <span class="op">=</span> np.array(generators)</a>
<a class="sourceLine" id="cb343-20" title="20">    generators <span class="op">=</span> generators[:,<span class="dv">1</span>:].astype(<span class="bu">float</span>)</a>
<a class="sourceLine" id="cb343-21" title="21">    <span class="cf">return</span> generators</a>
<a class="sourceLine" id="cb343-22" title="22"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb343-23" title="23">mgs <span class="op">=</span> matrix_generators(<span class="dv">66</span>)</a>
<a class="sourceLine" id="cb343-24" title="24">ref <span class="op">=</span> np.array([[<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span><span class="op">/</span><span class="dv">2</span>],</a>
<a class="sourceLine" id="cb343-25" title="25">                [<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span><span class="op">/</span><span class="dv">2</span>],</a>
<a class="sourceLine" id="cb343-26" title="26">                [<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>]])</a>
<a class="sourceLine" id="cb343-27" title="27">result <span class="op">=</span> np.allclose(mgs[<span class="op">-</span><span class="dv">1</span>], ref)</a></code></pre></div>
<p>Output:</p>
<pre><code>list index out of range</code></pre>
<h4 id="run-1-31">Run 1</h4>
<div class="sourceCode" id="cb345"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb345-1" title="1"><span class="im">import</span> requests</a>
<a class="sourceLine" id="cb345-2" title="2"><span class="im">from</span> bs4 <span class="im">import</span> BeautifulSoup</a>
<a class="sourceLine" id="cb345-3" title="3"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb345-4" title="4"></a>
<a class="sourceLine" id="cb345-5" title="5"><span class="kw">def</span> matrix_generators(gnum):</a>
<a class="sourceLine" id="cb345-6" title="6">    <span class="co">&quot;&quot;&quot; Returns list of matrix generators for general positions of given space group</span></a>
<a class="sourceLine" id="cb345-7" title="7"><span class="co">    gnum -  International Tables for Crystallography space group number</span></a>
<a class="sourceLine" id="cb345-8" title="8"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb345-9" title="9">    url <span class="op">=</span> <span class="st">&#39;http://www.cryst.ehu.es/cgi-bin/cryst/programs/nph-genmat?gnum=&#39;</span> <span class="op">+</span> <span class="bu">str</span>(gnum)</a>
<a class="sourceLine" id="cb345-10" title="10">    r <span class="op">=</span> requests.get(url)</a>
<a class="sourceLine" id="cb345-11" title="11">    soup <span class="op">=</span> BeautifulSoup(r.text, <span class="st">&#39;html.parser&#39;</span>)</a>
<a class="sourceLine" id="cb345-12" title="12">    table <span class="op">=</span> soup.find(<span class="st">&#39;table&#39;</span>)</a>
<a class="sourceLine" id="cb345-13" title="13">    generators <span class="op">=</span> []</a>
<a class="sourceLine" id="cb345-14" title="14">    <span class="cf">for</span> row <span class="kw">in</span> table.find_all(<span class="st">&#39;tr&#39;</span>):</a>
<a class="sourceLine" id="cb345-15" title="15">        cols <span class="op">=</span> row.find_all(<span class="st">&#39;td&#39;</span>)</a>
<a class="sourceLine" id="cb345-16" title="16">        cols <span class="op">=</span> [ele.text.strip() <span class="cf">for</span> ele <span class="kw">in</span> cols]</a>
<a class="sourceLine" id="cb345-17" title="17">        generators.append([ele <span class="cf">for</span> ele <span class="kw">in</span> cols <span class="cf">if</span> ele])</a>
<a class="sourceLine" id="cb345-18" title="18">    generators <span class="op">=</span> np.array(generators)</a>
<a class="sourceLine" id="cb345-19" title="19">    generators <span class="op">=</span> generators[<span class="dv">1</span>:,<span class="dv">1</span>:]</a>
<a class="sourceLine" id="cb345-20" title="20">    generators <span class="op">=</span> np.array(generators, dtype<span class="op">=</span><span class="bu">float</span>)</a>
<a class="sourceLine" id="cb345-21" title="21">    <span class="cf">return</span> generators</a>
<a class="sourceLine" id="cb345-22" title="22"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb345-23" title="23">mgs <span class="op">=</span> matrix_generators(<span class="dv">66</span>)</a>
<a class="sourceLine" id="cb345-24" title="24">ref <span class="op">=</span> np.array([[<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span><span class="op">/</span><span class="dv">2</span>],</a>
<a class="sourceLine" id="cb345-25" title="25">                [<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span><span class="op">/</span><span class="dv">2</span>],</a>
<a class="sourceLine" id="cb345-26" title="26">                [<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>]])</a>
<a class="sourceLine" id="cb345-27" title="27">result <span class="op">=</span> np.allclose(mgs[<span class="op">-</span><span class="dv">1</span>], ref)</a></code></pre></div>
<p>Output:</p>
<pre><code>&#39;NoneType&#39; object has no attribute &#39;find_all&#39;</code></pre>
<h4 id="run-2-31">Run 2</h4>
<div class="sourceCode" id="cb347"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb347-1" title="1"><span class="im">import</span> requests</a>
<a class="sourceLine" id="cb347-2" title="2"><span class="im">from</span> bs4 <span class="im">import</span> BeautifulSoup</a>
<a class="sourceLine" id="cb347-3" title="3"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb347-4" title="4"></a>
<a class="sourceLine" id="cb347-5" title="5"><span class="kw">def</span> matrix_generators(gnum):</a>
<a class="sourceLine" id="cb347-6" title="6">    <span class="co">&quot;&quot;&quot; Returns list of matrix generators for general positions of given space group</span></a>
<a class="sourceLine" id="cb347-7" title="7"><span class="co">    gnum -  International Tables for Crystallography space group number</span></a>
<a class="sourceLine" id="cb347-8" title="8"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb347-9" title="9">    url <span class="op">=</span> <span class="st">&#39;http://www.cryst.ehu.es/cgi-bin/cryst/programs/nph-matgen?gnum=</span><span class="sc">{}</span><span class="st">&#39;</span>.<span class="bu">format</span>(gnum)</a>
<a class="sourceLine" id="cb347-10" title="10">    r <span class="op">=</span> requests.get(url)</a>
<a class="sourceLine" id="cb347-11" title="11">    soup <span class="op">=</span> BeautifulSoup(r.text, <span class="st">&#39;html.parser&#39;</span>)</a>
<a class="sourceLine" id="cb347-12" title="12">    table <span class="op">=</span> soup.find_all(<span class="st">&#39;table&#39;</span>)[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb347-13" title="13">    generators <span class="op">=</span> []</a>
<a class="sourceLine" id="cb347-14" title="14">    <span class="cf">for</span> row <span class="kw">in</span> table.find_all(<span class="st">&#39;tr&#39;</span>)[<span class="dv">1</span>:]:</a>
<a class="sourceLine" id="cb347-15" title="15">        cols <span class="op">=</span> row.find_all(<span class="st">&#39;td&#39;</span>)</a>
<a class="sourceLine" id="cb347-16" title="16">        generators.append(np.array([<span class="bu">float</span>(cols[<span class="dv">1</span>].text), <span class="bu">float</span>(cols[<span class="dv">2</span>].text), <span class="bu">float</span>(cols[<span class="dv">3</span>].text)]))</a>
<a class="sourceLine" id="cb347-17" title="17">    <span class="cf">return</span> generators</a>
<a class="sourceLine" id="cb347-18" title="18"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb347-19" title="19">mgs <span class="op">=</span> matrix_generators(<span class="dv">66</span>)</a>
<a class="sourceLine" id="cb347-20" title="20">ref <span class="op">=</span> np.array([[<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span><span class="op">/</span><span class="dv">2</span>],</a>
<a class="sourceLine" id="cb347-21" title="21">                [<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span><span class="op">/</span><span class="dv">2</span>],</a>
<a class="sourceLine" id="cb347-22" title="22">                [<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>]])</a>
<a class="sourceLine" id="cb347-23" title="23">result <span class="op">=</span> np.allclose(mgs[<span class="op">-</span><span class="dv">1</span>], ref)</a></code></pre></div>
<p>Output:</p>
<pre><code>list index out of range</code></pre>
<h4 id="run-3-31">Run 3</h4>
<div class="sourceCode" id="cb349"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb349-1" title="1"><span class="im">import</span> requests</a>
<a class="sourceLine" id="cb349-2" title="2"><span class="im">from</span> bs4 <span class="im">import</span> BeautifulSoup</a>
<a class="sourceLine" id="cb349-3" title="3"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb349-4" title="4"></a>
<a class="sourceLine" id="cb349-5" title="5"><span class="kw">def</span> matrix_generators(gnum):</a>
<a class="sourceLine" id="cb349-6" title="6">    <span class="co">&quot;&quot;&quot; Returns list of matrix generators for general positions of given space group</span></a>
<a class="sourceLine" id="cb349-7" title="7"><span class="co">    gnum -  International Tables for Crystallography space group number</span></a>
<a class="sourceLine" id="cb349-8" title="8"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb349-9" title="9">    url <span class="op">=</span> <span class="st">&quot;http://www.cryst.ehu.es/cgi-bin/cryst/programs/nph-matrix_generators?gnum=&quot;</span> <span class="op">+</span> <span class="bu">str</span>(gnum)</a>
<a class="sourceLine" id="cb349-10" title="10">    r <span class="op">=</span> requests.get(url)</a>
<a class="sourceLine" id="cb349-11" title="11">    soup <span class="op">=</span> BeautifulSoup(r.content, <span class="st">&quot;html.parser&quot;</span>)</a>
<a class="sourceLine" id="cb349-12" title="12">    table <span class="op">=</span> soup.find_all(<span class="st">&quot;table&quot;</span>)[<span class="dv">0</span>]</a>
<a class="sourceLine" id="cb349-13" title="13">    generators <span class="op">=</span> []</a>
<a class="sourceLine" id="cb349-14" title="14">    <span class="cf">for</span> row <span class="kw">in</span> table.find_all(<span class="st">&quot;tr&quot;</span>)[<span class="dv">1</span>:]:</a>
<a class="sourceLine" id="cb349-15" title="15">        cols <span class="op">=</span> row.find_all(<span class="st">&quot;td&quot;</span>)</a>
<a class="sourceLine" id="cb349-16" title="16">        generators.append(np.array([[<span class="bu">float</span>(cols[<span class="dv">1</span>].text), <span class="bu">float</span>(cols[<span class="dv">2</span>].text), <span class="bu">float</span>(cols[<span class="dv">3</span>].text)],</a>
<a class="sourceLine" id="cb349-17" title="17">                                    [<span class="bu">float</span>(cols[<span class="dv">4</span>].text), <span class="bu">float</span>(cols[<span class="dv">5</span>].text), <span class="bu">float</span>(cols[<span class="dv">6</span>].text)],</a>
<a class="sourceLine" id="cb349-18" title="18">                                    [<span class="bu">float</span>(cols[<span class="dv">7</span>].text), <span class="bu">float</span>(cols[<span class="dv">8</span>].text), <span class="bu">float</span>(cols[<span class="dv">9</span>].text)]]))</a>
<a class="sourceLine" id="cb349-19" title="19">    <span class="cf">return</span> generators</a>
<a class="sourceLine" id="cb349-20" title="20"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb349-21" title="21">mgs <span class="op">=</span> matrix_generators(<span class="dv">66</span>)</a>
<a class="sourceLine" id="cb349-22" title="22">ref <span class="op">=</span> np.array([[<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span><span class="op">/</span><span class="dv">2</span>],</a>
<a class="sourceLine" id="cb349-23" title="23">                [<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span><span class="op">/</span><span class="dv">2</span>],</a>
<a class="sourceLine" id="cb349-24" title="24">                [<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>]])</a>
<a class="sourceLine" id="cb349-25" title="25">result <span class="op">=</span> np.allclose(mgs[<span class="op">-</span><span class="dv">1</span>], ref)</a></code></pre></div>
<p>Output:</p>
<pre><code>list index out of range</code></pre>
<h4 id="run-4-31">Run 4</h4>
<div class="sourceCode" id="cb351"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb351-1" title="1"><span class="im">import</span> requests</a>
<a class="sourceLine" id="cb351-2" title="2"><span class="im">from</span> bs4 <span class="im">import</span> BeautifulSoup</a>
<a class="sourceLine" id="cb351-3" title="3"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb351-4" title="4"></a>
<a class="sourceLine" id="cb351-5" title="5"><span class="kw">def</span> matrix_generators(gnum):</a>
<a class="sourceLine" id="cb351-6" title="6">    <span class="co">&quot;&quot;&quot; Returns list of matrix generators for general positions of given space group</span></a>
<a class="sourceLine" id="cb351-7" title="7"><span class="co">    gnum -  International Tables for Crystallography space group number</span></a>
<a class="sourceLine" id="cb351-8" title="8"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb351-9" title="9">    url <span class="op">=</span> <span class="st">&#39;http://www.cryst.ehu.es/cgi-bin/cryst/programs/nph-genmat?gnum=&#39;</span> <span class="op">+</span> <span class="bu">str</span>(gnum)</a>
<a class="sourceLine" id="cb351-10" title="10">    r <span class="op">=</span> requests.get(url)</a>
<a class="sourceLine" id="cb351-11" title="11">    soup <span class="op">=</span> BeautifulSoup(r.content, <span class="st">&#39;html.parser&#39;</span>)</a>
<a class="sourceLine" id="cb351-12" title="12">    table <span class="op">=</span> soup.find_all(<span class="st">&#39;table&#39;</span>)[<span class="dv">0</span>]</a>
<a class="sourceLine" id="cb351-13" title="13">    rows <span class="op">=</span> table.find_all(<span class="st">&#39;tr&#39;</span>)</a>
<a class="sourceLine" id="cb351-14" title="14">    generators <span class="op">=</span> []</a>
<a class="sourceLine" id="cb351-15" title="15">    <span class="cf">for</span> row <span class="kw">in</span> rows:</a>
<a class="sourceLine" id="cb351-16" title="16">        cols <span class="op">=</span> row.find_all(<span class="st">&#39;td&#39;</span>)</a>
<a class="sourceLine" id="cb351-17" title="17">        cols <span class="op">=</span> [ele.text.strip() <span class="cf">for</span> ele <span class="kw">in</span> cols]</a>
<a class="sourceLine" id="cb351-18" title="18">        generators.append([ele <span class="cf">for</span> ele <span class="kw">in</span> cols <span class="cf">if</span> ele])</a>
<a class="sourceLine" id="cb351-19" title="19">    generators <span class="op">=</span> generators[<span class="dv">1</span>:]</a>
<a class="sourceLine" id="cb351-20" title="20">    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(generators)):</a>
<a class="sourceLine" id="cb351-21" title="21">        generators[i] <span class="op">=</span> np.array(generators[i][<span class="dv">1</span>:]).astype(<span class="bu">float</span>)</a>
<a class="sourceLine" id="cb351-22" title="22">    generators <span class="op">=</span> np.array(generators)</a>
<a class="sourceLine" id="cb351-23" title="23">    <span class="cf">return</span> generators</a>
<a class="sourceLine" id="cb351-24" title="24"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb351-25" title="25">mgs <span class="op">=</span> matrix_generators(<span class="dv">66</span>)</a>
<a class="sourceLine" id="cb351-26" title="26">ref <span class="op">=</span> np.array([[<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span><span class="op">/</span><span class="dv">2</span>],</a>
<a class="sourceLine" id="cb351-27" title="27">                [<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span><span class="op">/</span><span class="dv">2</span>],</a>
<a class="sourceLine" id="cb351-28" title="28">                [<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>]])</a>
<a class="sourceLine" id="cb351-29" title="29">result <span class="op">=</span> np.allclose(mgs[<span class="op">-</span><span class="dv">1</span>], ref)</a></code></pre></div>
<p>Output:</p>
<pre><code>list index out of range</code></pre>
</details>
<details>
<p><summary>heating_water</summary></p>
<h4 id="query-32">Query</h4>
<div class="sourceCode" id="cb353"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb353-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb353-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb353-3" title="3"></a>
<a class="sourceLine" id="cb353-4" title="4"><span class="kw">def</span> heating_energy(n, T1, T2):</a>
<a class="sourceLine" id="cb353-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb353-6" title="6"><span class="co">   This function returns the energy in kcal required to heat n moles of water from T1 to T2</span></a>
<a class="sourceLine" id="cb353-7" title="7"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb353-8" title="8">   [insert]</a>
<a class="sourceLine" id="cb353-9" title="9">   <span class="cf">return</span> q</a>
<a class="sourceLine" id="cb353-10" title="10"></a></code></pre></div>
<h4 id="run-0-32">Run 0</h4>
<div class="sourceCode" id="cb354"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb354-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb354-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb354-3" title="3"></a>
<a class="sourceLine" id="cb354-4" title="4"><span class="kw">def</span> heating_energy(n, T1, T2):</a>
<a class="sourceLine" id="cb354-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb354-6" title="6"><span class="co">   This function returns the energy in kcal required to heat n moles of water from T1 to T2</span></a>
<a class="sourceLine" id="cb354-7" title="7"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb354-8" title="8">   q <span class="op">=</span> n <span class="op">*</span> <span class="fl">4.184</span> <span class="op">*</span> (T2 <span class="op">-</span> T1)</a>
<a class="sourceLine" id="cb354-9" title="9">   <span class="cf">return</span> q</a>
<a class="sourceLine" id="cb354-10" title="10"></a>
<a class="sourceLine" id="cb354-11" title="11"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb354-12" title="12"></a>
<a class="sourceLine" id="cb354-13" title="13">n <span class="op">=</span> <span class="dv">2</span></a>
<a class="sourceLine" id="cb354-14" title="14">T1 <span class="op">=</span> <span class="dv">300</span></a>
<a class="sourceLine" id="cb354-15" title="15">T2 <span class="op">=</span> <span class="dv">350</span></a>
<a class="sourceLine" id="cb354-16" title="16">C <span class="op">=</span> <span class="dv">1</span><span class="op">*</span><span class="fl">18.</span><span class="op">/</span><span class="dv">1000</span> <span class="co">#cal/g/deg</span></a>
<a class="sourceLine" id="cb354-17" title="17">q <span class="op">=</span> n<span class="op">*</span>C<span class="op">*</span>(T2<span class="op">-</span>T1)</a>
<a class="sourceLine" id="cb354-18" title="18"><span class="co"># heat in kilocalories</span></a>
<a class="sourceLine" id="cb354-19" title="19"></a>
<a class="sourceLine" id="cb354-20" title="20">q_codex <span class="op">=</span> heating_energy(n, T1, T2)</a>
<a class="sourceLine" id="cb354-21" title="21"></a>
<a class="sourceLine" id="cb354-22" title="22"><span class="co"># check </span></a>
<a class="sourceLine" id="cb354-23" title="23"><span class="cf">if</span> np.isclose(q, q_codex, rtol<span class="op">=</span><span class="fl">0.01</span>) <span class="op">==</span> <span class="va">True</span>:</a>
<a class="sourceLine" id="cb354-24" title="24">    result <span class="op">=</span> <span class="va">True</span> </a>
<a class="sourceLine" id="cb354-25" title="25"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb354-26" title="26">    result <span class="op">=</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-32">Run 1</h4>
<div class="sourceCode" id="cb356"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb356-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb356-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb356-3" title="3"></a>
<a class="sourceLine" id="cb356-4" title="4"><span class="kw">def</span> heating_energy(n, T1, T2):</a>
<a class="sourceLine" id="cb356-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb356-6" title="6"><span class="co">   This function returns the energy in kcal required to heat n moles of water from T1 to T2</span></a>
<a class="sourceLine" id="cb356-7" title="7"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb356-8" title="8">   q <span class="op">=</span> n <span class="op">*</span> <span class="fl">4.184</span> <span class="op">*</span> (T2 <span class="op">-</span> T1)</a>
<a class="sourceLine" id="cb356-9" title="9">   <span class="cf">return</span> q</a>
<a class="sourceLine" id="cb356-10" title="10"></a>
<a class="sourceLine" id="cb356-11" title="11"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb356-12" title="12"></a>
<a class="sourceLine" id="cb356-13" title="13">n <span class="op">=</span> <span class="dv">2</span></a>
<a class="sourceLine" id="cb356-14" title="14">T1 <span class="op">=</span> <span class="dv">300</span></a>
<a class="sourceLine" id="cb356-15" title="15">T2 <span class="op">=</span> <span class="dv">350</span></a>
<a class="sourceLine" id="cb356-16" title="16">C <span class="op">=</span> <span class="dv">1</span><span class="op">*</span><span class="fl">18.</span><span class="op">/</span><span class="dv">1000</span> <span class="co">#cal/g/deg</span></a>
<a class="sourceLine" id="cb356-17" title="17">q <span class="op">=</span> n<span class="op">*</span>C<span class="op">*</span>(T2<span class="op">-</span>T1)</a>
<a class="sourceLine" id="cb356-18" title="18"><span class="co"># heat in kilocalories</span></a>
<a class="sourceLine" id="cb356-19" title="19"></a>
<a class="sourceLine" id="cb356-20" title="20">q_codex <span class="op">=</span> heating_energy(n, T1, T2)</a>
<a class="sourceLine" id="cb356-21" title="21"></a>
<a class="sourceLine" id="cb356-22" title="22"><span class="co"># check </span></a>
<a class="sourceLine" id="cb356-23" title="23"><span class="cf">if</span> np.isclose(q, q_codex, rtol<span class="op">=</span><span class="fl">0.01</span>) <span class="op">==</span> <span class="va">True</span>:</a>
<a class="sourceLine" id="cb356-24" title="24">    result <span class="op">=</span> <span class="va">True</span> </a>
<a class="sourceLine" id="cb356-25" title="25"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb356-26" title="26">    result <span class="op">=</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-32">Run 2</h4>
<div class="sourceCode" id="cb358"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb358-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb358-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb358-3" title="3"></a>
<a class="sourceLine" id="cb358-4" title="4"><span class="kw">def</span> heating_energy(n, T1, T2):</a>
<a class="sourceLine" id="cb358-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb358-6" title="6"><span class="co">   This function returns the energy in kcal required to heat n moles of water from T1 to T2</span></a>
<a class="sourceLine" id="cb358-7" title="7"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb358-8" title="8">   q <span class="op">=</span> n <span class="op">*</span> <span class="fl">4.184</span> <span class="op">*</span> (T2 <span class="op">-</span> T1)</a>
<a class="sourceLine" id="cb358-9" title="9">   <span class="cf">return</span> q</a>
<a class="sourceLine" id="cb358-10" title="10"></a>
<a class="sourceLine" id="cb358-11" title="11"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb358-12" title="12"></a>
<a class="sourceLine" id="cb358-13" title="13">n <span class="op">=</span> <span class="dv">2</span></a>
<a class="sourceLine" id="cb358-14" title="14">T1 <span class="op">=</span> <span class="dv">300</span></a>
<a class="sourceLine" id="cb358-15" title="15">T2 <span class="op">=</span> <span class="dv">350</span></a>
<a class="sourceLine" id="cb358-16" title="16">C <span class="op">=</span> <span class="dv">1</span><span class="op">*</span><span class="fl">18.</span><span class="op">/</span><span class="dv">1000</span> <span class="co">#cal/g/deg</span></a>
<a class="sourceLine" id="cb358-17" title="17">q <span class="op">=</span> n<span class="op">*</span>C<span class="op">*</span>(T2<span class="op">-</span>T1)</a>
<a class="sourceLine" id="cb358-18" title="18"><span class="co"># heat in kilocalories</span></a>
<a class="sourceLine" id="cb358-19" title="19"></a>
<a class="sourceLine" id="cb358-20" title="20">q_codex <span class="op">=</span> heating_energy(n, T1, T2)</a>
<a class="sourceLine" id="cb358-21" title="21"></a>
<a class="sourceLine" id="cb358-22" title="22"><span class="co"># check </span></a>
<a class="sourceLine" id="cb358-23" title="23"><span class="cf">if</span> np.isclose(q, q_codex, rtol<span class="op">=</span><span class="fl">0.01</span>) <span class="op">==</span> <span class="va">True</span>:</a>
<a class="sourceLine" id="cb358-24" title="24">    result <span class="op">=</span> <span class="va">True</span> </a>
<a class="sourceLine" id="cb358-25" title="25"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb358-26" title="26">    result <span class="op">=</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-32">Run 3</h4>
<div class="sourceCode" id="cb360"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb360-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb360-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb360-3" title="3"></a>
<a class="sourceLine" id="cb360-4" title="4"><span class="kw">def</span> heating_energy(n, T1, T2):</a>
<a class="sourceLine" id="cb360-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb360-6" title="6"><span class="co">   This function returns the energy in kcal required to heat n moles of water from T1 to T2</span></a>
<a class="sourceLine" id="cb360-7" title="7"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb360-8" title="8">   q <span class="op">=</span> n <span class="op">*</span> <span class="fl">4.184</span> <span class="op">*</span> (T2 <span class="op">-</span> T1)</a>
<a class="sourceLine" id="cb360-9" title="9">   <span class="cf">return</span> q</a>
<a class="sourceLine" id="cb360-10" title="10"></a>
<a class="sourceLine" id="cb360-11" title="11"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb360-12" title="12"></a>
<a class="sourceLine" id="cb360-13" title="13">n <span class="op">=</span> <span class="dv">2</span></a>
<a class="sourceLine" id="cb360-14" title="14">T1 <span class="op">=</span> <span class="dv">300</span></a>
<a class="sourceLine" id="cb360-15" title="15">T2 <span class="op">=</span> <span class="dv">350</span></a>
<a class="sourceLine" id="cb360-16" title="16">C <span class="op">=</span> <span class="dv">1</span><span class="op">*</span><span class="fl">18.</span><span class="op">/</span><span class="dv">1000</span> <span class="co">#cal/g/deg</span></a>
<a class="sourceLine" id="cb360-17" title="17">q <span class="op">=</span> n<span class="op">*</span>C<span class="op">*</span>(T2<span class="op">-</span>T1)</a>
<a class="sourceLine" id="cb360-18" title="18"><span class="co"># heat in kilocalories</span></a>
<a class="sourceLine" id="cb360-19" title="19"></a>
<a class="sourceLine" id="cb360-20" title="20">q_codex <span class="op">=</span> heating_energy(n, T1, T2)</a>
<a class="sourceLine" id="cb360-21" title="21"></a>
<a class="sourceLine" id="cb360-22" title="22"><span class="co"># check </span></a>
<a class="sourceLine" id="cb360-23" title="23"><span class="cf">if</span> np.isclose(q, q_codex, rtol<span class="op">=</span><span class="fl">0.01</span>) <span class="op">==</span> <span class="va">True</span>:</a>
<a class="sourceLine" id="cb360-24" title="24">    result <span class="op">=</span> <span class="va">True</span> </a>
<a class="sourceLine" id="cb360-25" title="25"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb360-26" title="26">    result <span class="op">=</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-32">Run 4</h4>
<div class="sourceCode" id="cb362"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb362-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb362-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb362-3" title="3"></a>
<a class="sourceLine" id="cb362-4" title="4"><span class="kw">def</span> heating_energy(n, T1, T2):</a>
<a class="sourceLine" id="cb362-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb362-6" title="6"><span class="co">   This function returns the energy in kcal required to heat n moles of water from T1 to T2</span></a>
<a class="sourceLine" id="cb362-7" title="7"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb362-8" title="8">   q <span class="op">=</span> n<span class="op">*</span>(<span class="fl">4.184</span>)<span class="op">*</span>(T2<span class="op">-</span>T1)</a>
<a class="sourceLine" id="cb362-9" title="9">   <span class="cf">return</span> q</a>
<a class="sourceLine" id="cb362-10" title="10"></a>
<a class="sourceLine" id="cb362-11" title="11"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb362-12" title="12"></a>
<a class="sourceLine" id="cb362-13" title="13">n <span class="op">=</span> <span class="dv">2</span></a>
<a class="sourceLine" id="cb362-14" title="14">T1 <span class="op">=</span> <span class="dv">300</span></a>
<a class="sourceLine" id="cb362-15" title="15">T2 <span class="op">=</span> <span class="dv">350</span></a>
<a class="sourceLine" id="cb362-16" title="16">C <span class="op">=</span> <span class="dv">1</span><span class="op">*</span><span class="fl">18.</span><span class="op">/</span><span class="dv">1000</span> <span class="co">#cal/g/deg</span></a>
<a class="sourceLine" id="cb362-17" title="17">q <span class="op">=</span> n<span class="op">*</span>C<span class="op">*</span>(T2<span class="op">-</span>T1)</a>
<a class="sourceLine" id="cb362-18" title="18"><span class="co"># heat in kilocalories</span></a>
<a class="sourceLine" id="cb362-19" title="19"></a>
<a class="sourceLine" id="cb362-20" title="20">q_codex <span class="op">=</span> heating_energy(n, T1, T2)</a>
<a class="sourceLine" id="cb362-21" title="21"></a>
<a class="sourceLine" id="cb362-22" title="22"><span class="co"># check </span></a>
<a class="sourceLine" id="cb362-23" title="23"><span class="cf">if</span> np.isclose(q, q_codex, rtol<span class="op">=</span><span class="fl">0.01</span>) <span class="op">==</span> <span class="va">True</span>:</a>
<a class="sourceLine" id="cb362-24" title="24">    result <span class="op">=</span> <span class="va">True</span> </a>
<a class="sourceLine" id="cb362-25" title="25"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb362-26" title="26">    result <span class="op">=</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>hydrophobic_res</summary></p>
<h4 id="query-33">Query</h4>
<div class="sourceCode" id="cb364"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb364-1" title="1"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb364-2" title="2"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb364-3" title="3"></a>
<a class="sourceLine" id="cb364-4" title="4"><span class="kw">def</span> get_hydrophobic_residues(pdb_filename):</a>
<a class="sourceLine" id="cb364-5" title="5">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb364-6" title="6"><span class="co">  Returns list of hydrophobic residues indices</span></a>
<a class="sourceLine" id="cb364-7" title="7"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb364-8" title="8">  [insert]</a>
<a class="sourceLine" id="cb364-9" title="9">  <span class="cf">return</span> resids</a></code></pre></div>
<h4 id="run-0-33">Run 0</h4>
<div class="sourceCode" id="cb365"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb365-1" title="1"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb365-2" title="2"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb365-3" title="3"></a>
<a class="sourceLine" id="cb365-4" title="4"><span class="kw">def</span> get_hydrophobic_residues(pdb_filename):</a>
<a class="sourceLine" id="cb365-5" title="5">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb365-6" title="6"><span class="co">  Returns list of hydrophobic residues indices</span></a>
<a class="sourceLine" id="cb365-7" title="7"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb365-8" title="8">  traj <span class="op">=</span> md.load(pdb_filename)</a>
<a class="sourceLine" id="cb365-9" title="9">  resids <span class="op">=</span> []</a>
<a class="sourceLine" id="cb365-10" title="10">  <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(traj.n_residues):</a>
<a class="sourceLine" id="cb365-11" title="11">    <span class="cf">if</span> traj.topology.residue(i).is_hydrophobic:</a>
<a class="sourceLine" id="cb365-12" title="12">      resids.append(i)</a>
<a class="sourceLine" id="cb365-13" title="13">  <span class="cf">return</span> resids</a>
<a class="sourceLine" id="cb365-14" title="14"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb365-15" title="15">t <span class="op">=</span> md.load(os.path.join(_FILE_DIR_, <span class="st">&#39;e22g.pdb&#39;</span>))</a>
<a class="sourceLine" id="cb365-16" title="16">top <span class="op">=</span> t.topology</a>
<a class="sourceLine" id="cb365-17" title="17">hp_res_list <span class="op">=</span> [<span class="st">&#39;ALA&#39;</span>, <span class="st">&#39;VAL&#39;</span>, <span class="st">&#39;LEU&#39;</span>, <span class="st">&#39;ILE&#39;</span>, <span class="st">&#39;PRO&#39;</span>, <span class="st">&#39;PHE&#39;</span>, <span class="st">&#39;CYS&#39;</span>]</a>
<a class="sourceLine" id="cb365-18" title="18">hydrophobic_res <span class="op">=</span> [res.index <span class="cf">for</span> res <span class="kw">in</span> top.residues <span class="cf">if</span> <span class="bu">str</span>(res)[</a>
<a class="sourceLine" id="cb365-19" title="19">    :<span class="dv">3</span>] <span class="kw">in</span> hp_res_list]</a>
<a class="sourceLine" id="cb365-20" title="20"><span class="bu">print</span>(hydrophobic_res)</a>
<a class="sourceLine" id="cb365-21" title="21">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> get_hydrophobic_residues(os.path.join(</a>
<a class="sourceLine" id="cb365-22" title="22">    _FILE_DIR_, <span class="st">&#39;e22g.pdb&#39;</span>)) <span class="op">==</span> hydrophobic_res <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>&#39;Residue&#39; object has no attribute &#39;is_hydrophobic&#39;</code></pre>
<h4 id="run-1-33">Run 1</h4>
<div class="sourceCode" id="cb367"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb367-1" title="1"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb367-2" title="2"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb367-3" title="3"></a>
<a class="sourceLine" id="cb367-4" title="4"><span class="kw">def</span> get_hydrophobic_residues(pdb_filename):</a>
<a class="sourceLine" id="cb367-5" title="5">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb367-6" title="6"><span class="co">  Returns list of hydrophobic residues indices</span></a>
<a class="sourceLine" id="cb367-7" title="7"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb367-8" title="8">  pdb <span class="op">=</span> md.load(pdb_filename)</a>
<a class="sourceLine" id="cb367-9" title="9">  resids <span class="op">=</span> []</a>
<a class="sourceLine" id="cb367-10" title="10">  <span class="cf">for</span> atom <span class="kw">in</span> pdb.topology.atoms:</a>
<a class="sourceLine" id="cb367-11" title="11">    <span class="cf">if</span> atom.element.symbol <span class="op">==</span> <span class="st">&#39;C&#39;</span>:</a>
<a class="sourceLine" id="cb367-12" title="12">      resids.append(atom.residue.index)</a>
<a class="sourceLine" id="cb367-13" title="13">  resids <span class="op">=</span> np.unique(resids)</a>
<a class="sourceLine" id="cb367-14" title="14">  <span class="cf">return</span> resids</a>
<a class="sourceLine" id="cb367-15" title="15"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb367-16" title="16">t <span class="op">=</span> md.load(os.path.join(_FILE_DIR_, <span class="st">&#39;e22g.pdb&#39;</span>))</a>
<a class="sourceLine" id="cb367-17" title="17">top <span class="op">=</span> t.topology</a>
<a class="sourceLine" id="cb367-18" title="18">hp_res_list <span class="op">=</span> [<span class="st">&#39;ALA&#39;</span>, <span class="st">&#39;VAL&#39;</span>, <span class="st">&#39;LEU&#39;</span>, <span class="st">&#39;ILE&#39;</span>, <span class="st">&#39;PRO&#39;</span>, <span class="st">&#39;PHE&#39;</span>, <span class="st">&#39;CYS&#39;</span>]</a>
<a class="sourceLine" id="cb367-19" title="19">hydrophobic_res <span class="op">=</span> [res.index <span class="cf">for</span> res <span class="kw">in</span> top.residues <span class="cf">if</span> <span class="bu">str</span>(res)[</a>
<a class="sourceLine" id="cb367-20" title="20">    :<span class="dv">3</span>] <span class="kw">in</span> hp_res_list]</a>
<a class="sourceLine" id="cb367-21" title="21"><span class="bu">print</span>(hydrophobic_res)</a>
<a class="sourceLine" id="cb367-22" title="22">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> get_hydrophobic_residues(os.path.join(</a>
<a class="sourceLine" id="cb367-23" title="23">    _FILE_DIR_, <span class="st">&#39;e22g.pdb&#39;</span>)) <span class="op">==</span> hydrophobic_res <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-33">Run 2</h4>
<div class="sourceCode" id="cb369"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb369-1" title="1"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb369-2" title="2"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb369-3" title="3"></a>
<a class="sourceLine" id="cb369-4" title="4"><span class="kw">def</span> get_hydrophobic_residues(pdb_filename):</a>
<a class="sourceLine" id="cb369-5" title="5">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb369-6" title="6"><span class="co">  Returns list of hydrophobic residues indices</span></a>
<a class="sourceLine" id="cb369-7" title="7"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb369-8" title="8">  traj <span class="op">=</span> md.load(pdb_filename)</a>
<a class="sourceLine" id="cb369-9" title="9">  resids <span class="op">=</span> []</a>
<a class="sourceLine" id="cb369-10" title="10">  <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(traj.n_residues):</a>
<a class="sourceLine" id="cb369-11" title="11">    <span class="cf">if</span> traj.topology.residue(i).is_hydrophobic:</a>
<a class="sourceLine" id="cb369-12" title="12">      resids.append(i)</a>
<a class="sourceLine" id="cb369-13" title="13">  <span class="cf">return</span> resids</a>
<a class="sourceLine" id="cb369-14" title="14"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb369-15" title="15">t <span class="op">=</span> md.load(os.path.join(_FILE_DIR_, <span class="st">&#39;e22g.pdb&#39;</span>))</a>
<a class="sourceLine" id="cb369-16" title="16">top <span class="op">=</span> t.topology</a>
<a class="sourceLine" id="cb369-17" title="17">hp_res_list <span class="op">=</span> [<span class="st">&#39;ALA&#39;</span>, <span class="st">&#39;VAL&#39;</span>, <span class="st">&#39;LEU&#39;</span>, <span class="st">&#39;ILE&#39;</span>, <span class="st">&#39;PRO&#39;</span>, <span class="st">&#39;PHE&#39;</span>, <span class="st">&#39;CYS&#39;</span>]</a>
<a class="sourceLine" id="cb369-18" title="18">hydrophobic_res <span class="op">=</span> [res.index <span class="cf">for</span> res <span class="kw">in</span> top.residues <span class="cf">if</span> <span class="bu">str</span>(res)[</a>
<a class="sourceLine" id="cb369-19" title="19">    :<span class="dv">3</span>] <span class="kw">in</span> hp_res_list]</a>
<a class="sourceLine" id="cb369-20" title="20"><span class="bu">print</span>(hydrophobic_res)</a>
<a class="sourceLine" id="cb369-21" title="21">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> get_hydrophobic_residues(os.path.join(</a>
<a class="sourceLine" id="cb369-22" title="22">    _FILE_DIR_, <span class="st">&#39;e22g.pdb&#39;</span>)) <span class="op">==</span> hydrophobic_res <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>&#39;Residue&#39; object has no attribute &#39;is_hydrophobic&#39;</code></pre>
<h4 id="run-3-33">Run 3</h4>
<div class="sourceCode" id="cb371"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb371-1" title="1"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb371-2" title="2"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb371-3" title="3"></a>
<a class="sourceLine" id="cb371-4" title="4"><span class="kw">def</span> get_hydrophobic_residues(pdb_filename):</a>
<a class="sourceLine" id="cb371-5" title="5">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb371-6" title="6"><span class="co">  Returns list of hydrophobic residues indices</span></a>
<a class="sourceLine" id="cb371-7" title="7"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb371-8" title="8">  traj <span class="op">=</span> md.load(pdb_filename)</a>
<a class="sourceLine" id="cb371-9" title="9">  resids <span class="op">=</span> []</a>
<a class="sourceLine" id="cb371-10" title="10">  <span class="cf">for</span> res <span class="kw">in</span> traj.topology.residues:</a>
<a class="sourceLine" id="cb371-11" title="11">    <span class="cf">if</span> res.is_water:</a>
<a class="sourceLine" id="cb371-12" title="12">      <span class="cf">continue</span></a>
<a class="sourceLine" id="cb371-13" title="13">    <span class="cf">if</span> res.name <span class="kw">in</span> [<span class="st">&#39;ALA&#39;</span>, <span class="st">&#39;VAL&#39;</span>, <span class="st">&#39;LEU&#39;</span>, <span class="st">&#39;ILE&#39;</span>, <span class="st">&#39;PHE&#39;</span>, <span class="st">&#39;TRP&#39;</span>, <span class="st">&#39;MET&#39;</span>, <span class="st">&#39;PRO&#39;</span>]:</a>
<a class="sourceLine" id="cb371-14" title="14">      resids.append(res.index)</a>
<a class="sourceLine" id="cb371-15" title="15">  <span class="cf">return</span> resids</a>
<a class="sourceLine" id="cb371-16" title="16"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb371-17" title="17">t <span class="op">=</span> md.load(os.path.join(_FILE_DIR_, <span class="st">&#39;e22g.pdb&#39;</span>))</a>
<a class="sourceLine" id="cb371-18" title="18">top <span class="op">=</span> t.topology</a>
<a class="sourceLine" id="cb371-19" title="19">hp_res_list <span class="op">=</span> [<span class="st">&#39;ALA&#39;</span>, <span class="st">&#39;VAL&#39;</span>, <span class="st">&#39;LEU&#39;</span>, <span class="st">&#39;ILE&#39;</span>, <span class="st">&#39;PRO&#39;</span>, <span class="st">&#39;PHE&#39;</span>, <span class="st">&#39;CYS&#39;</span>]</a>
<a class="sourceLine" id="cb371-20" title="20">hydrophobic_res <span class="op">=</span> [res.index <span class="cf">for</span> res <span class="kw">in</span> top.residues <span class="cf">if</span> <span class="bu">str</span>(res)[</a>
<a class="sourceLine" id="cb371-21" title="21">    :<span class="dv">3</span>] <span class="kw">in</span> hp_res_list]</a>
<a class="sourceLine" id="cb371-22" title="22"><span class="bu">print</span>(hydrophobic_res)</a>
<a class="sourceLine" id="cb371-23" title="23">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> get_hydrophobic_residues(os.path.join(</a>
<a class="sourceLine" id="cb371-24" title="24">    _FILE_DIR_, <span class="st">&#39;e22g.pdb&#39;</span>)) <span class="op">==</span> hydrophobic_res <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-33">Run 4</h4>
<div class="sourceCode" id="cb373"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb373-1" title="1"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb373-2" title="2"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb373-3" title="3"></a>
<a class="sourceLine" id="cb373-4" title="4"><span class="kw">def</span> get_hydrophobic_residues(pdb_filename):</a>
<a class="sourceLine" id="cb373-5" title="5">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb373-6" title="6"><span class="co">  Returns list of hydrophobic residues indices</span></a>
<a class="sourceLine" id="cb373-7" title="7"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb373-8" title="8">  traj <span class="op">=</span> md.load(pdb_filename)</a>
<a class="sourceLine" id="cb373-9" title="9">  resids <span class="op">=</span> []</a>
<a class="sourceLine" id="cb373-10" title="10">  <span class="cf">for</span> atom <span class="kw">in</span> traj.topology.atoms:</a>
<a class="sourceLine" id="cb373-11" title="11">    <span class="cf">if</span> atom.element.symbol <span class="op">==</span> <span class="st">&#39;C&#39;</span>:</a>
<a class="sourceLine" id="cb373-12" title="12">      resids.append(atom.residue.index)</a>
<a class="sourceLine" id="cb373-13" title="13">  resids <span class="op">=</span> np.unique(resids)</a>
<a class="sourceLine" id="cb373-14" title="14">  <span class="cf">return</span> resids</a>
<a class="sourceLine" id="cb373-15" title="15"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb373-16" title="16">t <span class="op">=</span> md.load(os.path.join(_FILE_DIR_, <span class="st">&#39;e22g.pdb&#39;</span>))</a>
<a class="sourceLine" id="cb373-17" title="17">top <span class="op">=</span> t.topology</a>
<a class="sourceLine" id="cb373-18" title="18">hp_res_list <span class="op">=</span> [<span class="st">&#39;ALA&#39;</span>, <span class="st">&#39;VAL&#39;</span>, <span class="st">&#39;LEU&#39;</span>, <span class="st">&#39;ILE&#39;</span>, <span class="st">&#39;PRO&#39;</span>, <span class="st">&#39;PHE&#39;</span>, <span class="st">&#39;CYS&#39;</span>]</a>
<a class="sourceLine" id="cb373-19" title="19">hydrophobic_res <span class="op">=</span> [res.index <span class="cf">for</span> res <span class="kw">in</span> top.residues <span class="cf">if</span> <span class="bu">str</span>(res)[</a>
<a class="sourceLine" id="cb373-20" title="20">    :<span class="dv">3</span>] <span class="kw">in</span> hp_res_list]</a>
<a class="sourceLine" id="cb373-21" title="21"><span class="bu">print</span>(hydrophobic_res)</a>
<a class="sourceLine" id="cb373-22" title="22">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> get_hydrophobic_residues(os.path.join(</a>
<a class="sourceLine" id="cb373-23" title="23">    _FILE_DIR_, <span class="st">&#39;e22g.pdb&#39;</span>)) <span class="op">==</span> hydrophobic_res <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>ideal_gas</summary></p>
<h4 id="query-34">Query</h4>
<div class="sourceCode" id="cb375"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb375-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb375-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb375-3" title="3"></a>
<a class="sourceLine" id="cb375-4" title="4"><span class="kw">def</span> ideal_gas_pressure(n,V,T):</a>
<a class="sourceLine" id="cb375-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb375-6" title="6"><span class="co">   This function returns the pressure for n moles of an ideal gas at temperature T and volume V, using the ideal gas equation of state.</span></a>
<a class="sourceLine" id="cb375-7" title="7"><span class="co">   The pressure returned is in atm units.</span></a>
<a class="sourceLine" id="cb375-8" title="8"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb375-9" title="9">   [insert]</a>
<a class="sourceLine" id="cb375-10" title="10">   <span class="cf">return</span> P</a></code></pre></div>
<h4 id="run-0-34">Run 0</h4>
<div class="sourceCode" id="cb376"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb376-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb376-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb376-3" title="3"></a>
<a class="sourceLine" id="cb376-4" title="4"><span class="kw">def</span> ideal_gas_pressure(n,V,T):</a>
<a class="sourceLine" id="cb376-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb376-6" title="6"><span class="co">   This function returns the pressure for n moles of an ideal gas at temperature T and volume V, using the ideal gas equation of state.</span></a>
<a class="sourceLine" id="cb376-7" title="7"><span class="co">   The pressure returned is in atm units.</span></a>
<a class="sourceLine" id="cb376-8" title="8"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb376-9" title="9">   R <span class="op">=</span> <span class="fl">0.0821</span> <span class="co">#atm*L/mol/K</span></a>
<a class="sourceLine" id="cb376-10" title="10">   P <span class="op">=</span> (n<span class="op">*</span>R<span class="op">*</span>T)<span class="op">/</span>V</a>
<a class="sourceLine" id="cb376-11" title="11">   <span class="cf">return</span> P</a>
<a class="sourceLine" id="cb376-12" title="12"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb376-13" title="13"></a>
<a class="sourceLine" id="cb376-14" title="14"><span class="co"># input</span></a>
<a class="sourceLine" id="cb376-15" title="15">V <span class="op">=</span> <span class="fl">20.0</span>    <span class="co"># volume (in L)</span></a>
<a class="sourceLine" id="cb376-16" title="16">n <span class="op">=</span> <span class="fl">10.0</span>    <span class="co"># in moles</span></a>
<a class="sourceLine" id="cb376-17" title="17">R <span class="op">=</span> <span class="fl">0.08206</span>  <span class="co"># in L.atm/mol.K</span></a>
<a class="sourceLine" id="cb376-18" title="18">T <span class="op">=</span> <span class="dv">350</span>     <span class="co"># in K </span></a>
<a class="sourceLine" id="cb376-19" title="19"></a>
<a class="sourceLine" id="cb376-20" title="20">P <span class="op">=</span> n<span class="op">*</span>R<span class="op">*</span>T<span class="op">/</span>V</a>
<a class="sourceLine" id="cb376-21" title="21"><span class="co">#print(&quot;Pressure =&quot;, P)</span></a>
<a class="sourceLine" id="cb376-22" title="22"></a>
<a class="sourceLine" id="cb376-23" title="23">codex_pressure <span class="op">=</span> ideal_gas_pressure(n,V,T)</a>
<a class="sourceLine" id="cb376-24" title="24"><span class="co">#print(&quot;Codex pressure =&quot;, codex_pressure)</span></a>
<a class="sourceLine" id="cb376-25" title="25"><span class="co"># check </span></a>
<a class="sourceLine" id="cb376-26" title="26"><span class="cf">if</span> np.isclose(P, codex_pressure, rtol<span class="op">=</span><span class="fl">0.01</span>) <span class="op">==</span> <span class="va">True</span>:</a>
<a class="sourceLine" id="cb376-27" title="27">    result <span class="op">=</span> <span class="va">True</span> </a>
<a class="sourceLine" id="cb376-28" title="28"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb376-29" title="29">    result <span class="op">=</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-34">Run 1</h4>
<div class="sourceCode" id="cb378"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb378-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb378-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb378-3" title="3"></a>
<a class="sourceLine" id="cb378-4" title="4"><span class="kw">def</span> ideal_gas_pressure(n,V,T):</a>
<a class="sourceLine" id="cb378-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb378-6" title="6"><span class="co">   This function returns the pressure for n moles of an ideal gas at temperature T and volume V, using the ideal gas equation of state.</span></a>
<a class="sourceLine" id="cb378-7" title="7"><span class="co">   The pressure returned is in atm units.</span></a>
<a class="sourceLine" id="cb378-8" title="8"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb378-9" title="9">   R <span class="op">=</span> <span class="fl">0.0821</span> <span class="co"># atm*L/mol/K</span></a>
<a class="sourceLine" id="cb378-10" title="10">   P <span class="op">=</span> (n<span class="op">*</span>R<span class="op">*</span>T)<span class="op">/</span>V</a>
<a class="sourceLine" id="cb378-11" title="11">   <span class="cf">return</span> P</a>
<a class="sourceLine" id="cb378-12" title="12"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb378-13" title="13"></a>
<a class="sourceLine" id="cb378-14" title="14"><span class="co"># input</span></a>
<a class="sourceLine" id="cb378-15" title="15">V <span class="op">=</span> <span class="fl">20.0</span>    <span class="co"># volume (in L)</span></a>
<a class="sourceLine" id="cb378-16" title="16">n <span class="op">=</span> <span class="fl">10.0</span>    <span class="co"># in moles</span></a>
<a class="sourceLine" id="cb378-17" title="17">R <span class="op">=</span> <span class="fl">0.08206</span>  <span class="co"># in L.atm/mol.K</span></a>
<a class="sourceLine" id="cb378-18" title="18">T <span class="op">=</span> <span class="dv">350</span>     <span class="co"># in K </span></a>
<a class="sourceLine" id="cb378-19" title="19"></a>
<a class="sourceLine" id="cb378-20" title="20">P <span class="op">=</span> n<span class="op">*</span>R<span class="op">*</span>T<span class="op">/</span>V</a>
<a class="sourceLine" id="cb378-21" title="21"><span class="co">#print(&quot;Pressure =&quot;, P)</span></a>
<a class="sourceLine" id="cb378-22" title="22"></a>
<a class="sourceLine" id="cb378-23" title="23">codex_pressure <span class="op">=</span> ideal_gas_pressure(n,V,T)</a>
<a class="sourceLine" id="cb378-24" title="24"><span class="co">#print(&quot;Codex pressure =&quot;, codex_pressure)</span></a>
<a class="sourceLine" id="cb378-25" title="25"><span class="co"># check </span></a>
<a class="sourceLine" id="cb378-26" title="26"><span class="cf">if</span> np.isclose(P, codex_pressure, rtol<span class="op">=</span><span class="fl">0.01</span>) <span class="op">==</span> <span class="va">True</span>:</a>
<a class="sourceLine" id="cb378-27" title="27">    result <span class="op">=</span> <span class="va">True</span> </a>
<a class="sourceLine" id="cb378-28" title="28"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb378-29" title="29">    result <span class="op">=</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-34">Run 2</h4>
<div class="sourceCode" id="cb380"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb380-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb380-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb380-3" title="3"></a>
<a class="sourceLine" id="cb380-4" title="4"><span class="kw">def</span> ideal_gas_pressure(n,V,T):</a>
<a class="sourceLine" id="cb380-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb380-6" title="6"><span class="co">   This function returns the pressure for n moles of an ideal gas at temperature T and volume V, using the ideal gas equation of state.</span></a>
<a class="sourceLine" id="cb380-7" title="7"><span class="co">   The pressure returned is in atm units.</span></a>
<a class="sourceLine" id="cb380-8" title="8"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb380-9" title="9">   R <span class="op">=</span> <span class="fl">0.0821</span> <span class="co"># atm L / mol K</span></a>
<a class="sourceLine" id="cb380-10" title="10">   P <span class="op">=</span> (n <span class="op">*</span> R <span class="op">*</span> T) <span class="op">/</span> V</a>
<a class="sourceLine" id="cb380-11" title="11">   <span class="cf">return</span> P</a>
<a class="sourceLine" id="cb380-12" title="12"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb380-13" title="13"></a>
<a class="sourceLine" id="cb380-14" title="14"><span class="co"># input</span></a>
<a class="sourceLine" id="cb380-15" title="15">V <span class="op">=</span> <span class="fl">20.0</span>    <span class="co"># volume (in L)</span></a>
<a class="sourceLine" id="cb380-16" title="16">n <span class="op">=</span> <span class="fl">10.0</span>    <span class="co"># in moles</span></a>
<a class="sourceLine" id="cb380-17" title="17">R <span class="op">=</span> <span class="fl">0.08206</span>  <span class="co"># in L.atm/mol.K</span></a>
<a class="sourceLine" id="cb380-18" title="18">T <span class="op">=</span> <span class="dv">350</span>     <span class="co"># in K </span></a>
<a class="sourceLine" id="cb380-19" title="19"></a>
<a class="sourceLine" id="cb380-20" title="20">P <span class="op">=</span> n<span class="op">*</span>R<span class="op">*</span>T<span class="op">/</span>V</a>
<a class="sourceLine" id="cb380-21" title="21"><span class="co">#print(&quot;Pressure =&quot;, P)</span></a>
<a class="sourceLine" id="cb380-22" title="22"></a>
<a class="sourceLine" id="cb380-23" title="23">codex_pressure <span class="op">=</span> ideal_gas_pressure(n,V,T)</a>
<a class="sourceLine" id="cb380-24" title="24"><span class="co">#print(&quot;Codex pressure =&quot;, codex_pressure)</span></a>
<a class="sourceLine" id="cb380-25" title="25"><span class="co"># check </span></a>
<a class="sourceLine" id="cb380-26" title="26"><span class="cf">if</span> np.isclose(P, codex_pressure, rtol<span class="op">=</span><span class="fl">0.01</span>) <span class="op">==</span> <span class="va">True</span>:</a>
<a class="sourceLine" id="cb380-27" title="27">    result <span class="op">=</span> <span class="va">True</span> </a>
<a class="sourceLine" id="cb380-28" title="28"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb380-29" title="29">    result <span class="op">=</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-34">Run 3</h4>
<div class="sourceCode" id="cb382"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb382-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb382-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb382-3" title="3"></a>
<a class="sourceLine" id="cb382-4" title="4"><span class="kw">def</span> ideal_gas_pressure(n,V,T):</a>
<a class="sourceLine" id="cb382-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb382-6" title="6"><span class="co">   This function returns the pressure for n moles of an ideal gas at temperature T and volume V, using the ideal gas equation of state.</span></a>
<a class="sourceLine" id="cb382-7" title="7"><span class="co">   The pressure returned is in atm units.</span></a>
<a class="sourceLine" id="cb382-8" title="8"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb382-9" title="9">   R <span class="op">=</span> <span class="fl">0.0821</span> <span class="co"># atm L / mol K</span></a>
<a class="sourceLine" id="cb382-10" title="10">   P <span class="op">=</span> (n<span class="op">*</span>R<span class="op">*</span>T)<span class="op">/</span>V</a>
<a class="sourceLine" id="cb382-11" title="11">   <span class="cf">return</span> P</a>
<a class="sourceLine" id="cb382-12" title="12"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb382-13" title="13"></a>
<a class="sourceLine" id="cb382-14" title="14"><span class="co"># input</span></a>
<a class="sourceLine" id="cb382-15" title="15">V <span class="op">=</span> <span class="fl">20.0</span>    <span class="co"># volume (in L)</span></a>
<a class="sourceLine" id="cb382-16" title="16">n <span class="op">=</span> <span class="fl">10.0</span>    <span class="co"># in moles</span></a>
<a class="sourceLine" id="cb382-17" title="17">R <span class="op">=</span> <span class="fl">0.08206</span>  <span class="co"># in L.atm/mol.K</span></a>
<a class="sourceLine" id="cb382-18" title="18">T <span class="op">=</span> <span class="dv">350</span>     <span class="co"># in K </span></a>
<a class="sourceLine" id="cb382-19" title="19"></a>
<a class="sourceLine" id="cb382-20" title="20">P <span class="op">=</span> n<span class="op">*</span>R<span class="op">*</span>T<span class="op">/</span>V</a>
<a class="sourceLine" id="cb382-21" title="21"><span class="co">#print(&quot;Pressure =&quot;, P)</span></a>
<a class="sourceLine" id="cb382-22" title="22"></a>
<a class="sourceLine" id="cb382-23" title="23">codex_pressure <span class="op">=</span> ideal_gas_pressure(n,V,T)</a>
<a class="sourceLine" id="cb382-24" title="24"><span class="co">#print(&quot;Codex pressure =&quot;, codex_pressure)</span></a>
<a class="sourceLine" id="cb382-25" title="25"><span class="co"># check </span></a>
<a class="sourceLine" id="cb382-26" title="26"><span class="cf">if</span> np.isclose(P, codex_pressure, rtol<span class="op">=</span><span class="fl">0.01</span>) <span class="op">==</span> <span class="va">True</span>:</a>
<a class="sourceLine" id="cb382-27" title="27">    result <span class="op">=</span> <span class="va">True</span> </a>
<a class="sourceLine" id="cb382-28" title="28"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb382-29" title="29">    result <span class="op">=</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-34">Run 4</h4>
<div class="sourceCode" id="cb384"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb384-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb384-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb384-3" title="3"></a>
<a class="sourceLine" id="cb384-4" title="4"><span class="kw">def</span> ideal_gas_pressure(n,V,T):</a>
<a class="sourceLine" id="cb384-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb384-6" title="6"><span class="co">   This function returns the pressure for n moles of an ideal gas at temperature T and volume V, using the ideal gas equation of state.</span></a>
<a class="sourceLine" id="cb384-7" title="7"><span class="co">   The pressure returned is in atm units.</span></a>
<a class="sourceLine" id="cb384-8" title="8"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb384-9" title="9">   R <span class="op">=</span> <span class="fl">0.0821</span> <span class="co"># atm L / mol K</span></a>
<a class="sourceLine" id="cb384-10" title="10">   P <span class="op">=</span> (n<span class="op">*</span>R<span class="op">*</span>T)<span class="op">/</span>V</a>
<a class="sourceLine" id="cb384-11" title="11">   <span class="cf">return</span> P</a>
<a class="sourceLine" id="cb384-12" title="12"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb384-13" title="13"></a>
<a class="sourceLine" id="cb384-14" title="14"><span class="co"># input</span></a>
<a class="sourceLine" id="cb384-15" title="15">V <span class="op">=</span> <span class="fl">20.0</span>    <span class="co"># volume (in L)</span></a>
<a class="sourceLine" id="cb384-16" title="16">n <span class="op">=</span> <span class="fl">10.0</span>    <span class="co"># in moles</span></a>
<a class="sourceLine" id="cb384-17" title="17">R <span class="op">=</span> <span class="fl">0.08206</span>  <span class="co"># in L.atm/mol.K</span></a>
<a class="sourceLine" id="cb384-18" title="18">T <span class="op">=</span> <span class="dv">350</span>     <span class="co"># in K </span></a>
<a class="sourceLine" id="cb384-19" title="19"></a>
<a class="sourceLine" id="cb384-20" title="20">P <span class="op">=</span> n<span class="op">*</span>R<span class="op">*</span>T<span class="op">/</span>V</a>
<a class="sourceLine" id="cb384-21" title="21"><span class="co">#print(&quot;Pressure =&quot;, P)</span></a>
<a class="sourceLine" id="cb384-22" title="22"></a>
<a class="sourceLine" id="cb384-23" title="23">codex_pressure <span class="op">=</span> ideal_gas_pressure(n,V,T)</a>
<a class="sourceLine" id="cb384-24" title="24"><span class="co">#print(&quot;Codex pressure =&quot;, codex_pressure)</span></a>
<a class="sourceLine" id="cb384-25" title="25"><span class="co"># check </span></a>
<a class="sourceLine" id="cb384-26" title="26"><span class="cf">if</span> np.isclose(P, codex_pressure, rtol<span class="op">=</span><span class="fl">0.01</span>) <span class="op">==</span> <span class="va">True</span>:</a>
<a class="sourceLine" id="cb384-27" title="27">    result <span class="op">=</span> <span class="va">True</span> </a>
<a class="sourceLine" id="cb384-28" title="28"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb384-29" title="29">    result <span class="op">=</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>integral</summary></p>
<h4 id="query-35">Query</h4>
<div class="sourceCode" id="cb386"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb386-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb386-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb386-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb386-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb386-5" title="5"></a>
<a class="sourceLine" id="cb386-6" title="6"><span class="kw">def</span> find_integral(a,b,c,d):</a>
<a class="sourceLine" id="cb386-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb386-8" title="8"><span class="co">  This function generates a one dimensional polynomial with coefficients a,b,c,d and returns its integral.</span></a>
<a class="sourceLine" id="cb386-9" title="9"></a>
<a class="sourceLine" id="cb386-10" title="10"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb386-11" title="11">  [insert]</a>
<a class="sourceLine" id="cb386-12" title="12">  <span class="cf">return</span> integral</a></code></pre></div>
<h4 id="run-0-35">Run 0</h4>
<div class="sourceCode" id="cb387"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb387-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb387-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb387-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb387-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb387-5" title="5"></a>
<a class="sourceLine" id="cb387-6" title="6"><span class="kw">def</span> find_integral(a,b,c,d):</a>
<a class="sourceLine" id="cb387-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb387-8" title="8"><span class="co">  This function generates a one dimensional polynomial with coefficients a,b,c,d and returns its integral.</span></a>
<a class="sourceLine" id="cb387-9" title="9"></a>
<a class="sourceLine" id="cb387-10" title="10"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb387-11" title="11">  x <span class="op">=</span> np.linspace(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">100</span>)</a>
<a class="sourceLine" id="cb387-12" title="12">  y <span class="op">=</span> a<span class="op">*</span>x<span class="op">**</span><span class="dv">3</span> <span class="op">+</span> b<span class="op">*</span>x<span class="op">**</span><span class="dv">2</span> <span class="op">+</span> c<span class="op">*</span>x <span class="op">+</span> d</a>
<a class="sourceLine" id="cb387-13" title="13">  integral <span class="op">=</span> np.trapz(y,x)</a>
<a class="sourceLine" id="cb387-14" title="14">  <span class="cf">return</span> integral</a>
<a class="sourceLine" id="cb387-15" title="15"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb387-16" title="16"></a>
<a class="sourceLine" id="cb387-17" title="17">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> find_integral(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>) <span class="op">==</span> np.poly1d([<span class="dv">1</span><span class="op">/</span><span class="dv">4</span>, <span class="dv">2</span><span class="op">/</span><span class="dv">3</span>, <span class="dv">3</span><span class="op">/</span><span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">0</span>]) <span class="cf">else</span> <span class="va">False</span> </a></code></pre></div>
<p>Output:</p>
<pre><code>The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()</code></pre>
<h4 id="run-1-35">Run 1</h4>
<div class="sourceCode" id="cb389"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb389-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb389-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb389-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb389-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb389-5" title="5"></a>
<a class="sourceLine" id="cb389-6" title="6"><span class="kw">def</span> find_integral(a,b,c,d):</a>
<a class="sourceLine" id="cb389-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb389-8" title="8"><span class="co">  This function generates a one dimensional polynomial with coefficients a,b,c,d and returns its integral.</span></a>
<a class="sourceLine" id="cb389-9" title="9"></a>
<a class="sourceLine" id="cb389-10" title="10"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb389-11" title="11">  x <span class="op">=</span> np.linspace(<span class="dv">0</span>,<span class="dv">10</span>,<span class="dv">100</span>)</a>
<a class="sourceLine" id="cb389-12" title="12">  y <span class="op">=</span> a<span class="op">*</span>x<span class="op">**</span><span class="dv">3</span> <span class="op">+</span> b<span class="op">*</span>x<span class="op">**</span><span class="dv">2</span> <span class="op">+</span> c<span class="op">*</span>x <span class="op">+</span> d</a>
<a class="sourceLine" id="cb389-13" title="13">  integral <span class="op">=</span> np.trapz(y,x)</a>
<a class="sourceLine" id="cb389-14" title="14">  <span class="cf">return</span> integral</a>
<a class="sourceLine" id="cb389-15" title="15"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb389-16" title="16"></a>
<a class="sourceLine" id="cb389-17" title="17">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> find_integral(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>) <span class="op">==</span> np.poly1d([<span class="dv">1</span><span class="op">/</span><span class="dv">4</span>, <span class="dv">2</span><span class="op">/</span><span class="dv">3</span>, <span class="dv">3</span><span class="op">/</span><span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">0</span>]) <span class="cf">else</span> <span class="va">False</span> </a></code></pre></div>
<p>Output:</p>
<pre><code>The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()</code></pre>
<h4 id="run-2-35">Run 2</h4>
<div class="sourceCode" id="cb391"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb391-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb391-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb391-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb391-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb391-5" title="5"></a>
<a class="sourceLine" id="cb391-6" title="6"><span class="kw">def</span> find_integral(a,b,c,d):</a>
<a class="sourceLine" id="cb391-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb391-8" title="8"><span class="co">  This function generates a one dimensional polynomial with coefficients a,b,c,d and returns its integral.</span></a>
<a class="sourceLine" id="cb391-9" title="9"></a>
<a class="sourceLine" id="cb391-10" title="10"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb391-11" title="11">  x <span class="op">=</span> np.linspace(<span class="op">-</span><span class="dv">10</span>,<span class="dv">10</span>,<span class="dv">100</span>)</a>
<a class="sourceLine" id="cb391-12" title="12">  y <span class="op">=</span> a<span class="op">*</span>x<span class="op">**</span><span class="dv">3</span> <span class="op">+</span> b<span class="op">*</span>x<span class="op">**</span><span class="dv">2</span> <span class="op">+</span> c<span class="op">*</span>x <span class="op">+</span> d</a>
<a class="sourceLine" id="cb391-13" title="13">  integral <span class="op">=</span> np.trapz(y,x)</a>
<a class="sourceLine" id="cb391-14" title="14">  <span class="cf">return</span> integral</a>
<a class="sourceLine" id="cb391-15" title="15"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb391-16" title="16"></a>
<a class="sourceLine" id="cb391-17" title="17">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> find_integral(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>) <span class="op">==</span> np.poly1d([<span class="dv">1</span><span class="op">/</span><span class="dv">4</span>, <span class="dv">2</span><span class="op">/</span><span class="dv">3</span>, <span class="dv">3</span><span class="op">/</span><span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">0</span>]) <span class="cf">else</span> <span class="va">False</span> </a></code></pre></div>
<p>Output:</p>
<pre><code>The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()</code></pre>
<h4 id="run-3-35">Run 3</h4>
<div class="sourceCode" id="cb393"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb393-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb393-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb393-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb393-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb393-5" title="5"></a>
<a class="sourceLine" id="cb393-6" title="6"><span class="kw">def</span> find_integral(a,b,c,d):</a>
<a class="sourceLine" id="cb393-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb393-8" title="8"><span class="co">  This function generates a one dimensional polynomial with coefficients a,b,c,d and returns its integral.</span></a>
<a class="sourceLine" id="cb393-9" title="9"></a>
<a class="sourceLine" id="cb393-10" title="10"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb393-11" title="11">  x <span class="op">=</span> np.linspace(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">100</span>)</a>
<a class="sourceLine" id="cb393-12" title="12">  y <span class="op">=</span> a<span class="op">*</span>x<span class="op">**</span><span class="dv">3</span> <span class="op">+</span> b<span class="op">*</span>x<span class="op">**</span><span class="dv">2</span> <span class="op">+</span> c<span class="op">*</span>x <span class="op">+</span> d</a>
<a class="sourceLine" id="cb393-13" title="13">  integral <span class="op">=</span> np.trapz(y,x)</a>
<a class="sourceLine" id="cb393-14" title="14">  <span class="cf">return</span> integral</a>
<a class="sourceLine" id="cb393-15" title="15"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb393-16" title="16"></a>
<a class="sourceLine" id="cb393-17" title="17">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> find_integral(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>) <span class="op">==</span> np.poly1d([<span class="dv">1</span><span class="op">/</span><span class="dv">4</span>, <span class="dv">2</span><span class="op">/</span><span class="dv">3</span>, <span class="dv">3</span><span class="op">/</span><span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">0</span>]) <span class="cf">else</span> <span class="va">False</span> </a></code></pre></div>
<p>Output:</p>
<pre><code>The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()</code></pre>
<h4 id="run-4-35">Run 4</h4>
<div class="sourceCode" id="cb395"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb395-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb395-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb395-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb395-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb395-5" title="5"></a>
<a class="sourceLine" id="cb395-6" title="6"><span class="kw">def</span> find_integral(a,b,c,d):</a>
<a class="sourceLine" id="cb395-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb395-8" title="8"><span class="co">  This function generates a one dimensional polynomial with coefficients a,b,c,d and returns its integral.</span></a>
<a class="sourceLine" id="cb395-9" title="9"></a>
<a class="sourceLine" id="cb395-10" title="10"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb395-11" title="11">  integral <span class="op">=</span> (a<span class="op">/</span><span class="dv">4</span>)<span class="op">*</span>(b<span class="op">**</span><span class="dv">4</span>) <span class="op">+</span> (b<span class="op">/</span><span class="dv">3</span>)<span class="op">*</span>(b<span class="op">**</span><span class="dv">3</span>) <span class="op">+</span> (c<span class="op">/</span><span class="dv">2</span>)<span class="op">*</span>(b<span class="op">**</span><span class="dv">2</span>) <span class="op">+</span> d<span class="op">*</span>b</a>
<a class="sourceLine" id="cb395-12" title="12">  <span class="cf">return</span> integral</a>
<a class="sourceLine" id="cb395-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb395-14" title="14"></a>
<a class="sourceLine" id="cb395-15" title="15">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> find_integral(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>) <span class="op">==</span> np.poly1d([<span class="dv">1</span><span class="op">/</span><span class="dv">4</span>, <span class="dv">2</span><span class="op">/</span><span class="dv">3</span>, <span class="dv">3</span><span class="op">/</span><span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">0</span>]) <span class="cf">else</span> <span class="va">False</span> </a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>trap</summary></p>
<h4 id="query-36">Query</h4>
<div class="sourceCode" id="cb397"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb397-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb397-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb397-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb397-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb397-5" title="5"></a>
<a class="sourceLine" id="cb397-6" title="6"><span class="kw">def</span> trap(f, n, a, b):</a>
<a class="sourceLine" id="cb397-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb397-8" title="8"><span class="co">  This function evaluates the integral of a univariate function f from a to b with n itervals using the composite trapezoidal rule.</span></a>
<a class="sourceLine" id="cb397-9" title="9"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb397-10" title="10">  [insert]</a>
<a class="sourceLine" id="cb397-11" title="11">  <span class="cf">return</span> integral</a></code></pre></div>
<h4 id="run-0-36">Run 0</h4>
<div class="sourceCode" id="cb398"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb398-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb398-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb398-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb398-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb398-5" title="5"></a>
<a class="sourceLine" id="cb398-6" title="6"><span class="kw">def</span> trap(f, n, a, b):</a>
<a class="sourceLine" id="cb398-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb398-8" title="8"><span class="co">  This function evaluates the integral of a univariate function f from a to b with n itervals using the composite trapezoidal rule.</span></a>
<a class="sourceLine" id="cb398-9" title="9"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb398-10" title="10">  h <span class="op">=</span> (b <span class="op">-</span> a) <span class="op">/</span> n</a>
<a class="sourceLine" id="cb398-11" title="11">  x <span class="op">=</span> np.linspace(a, b, n<span class="op">+</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb398-12" title="12">  integral <span class="op">=</span> <span class="fl">0.5</span> <span class="op">*</span> h <span class="op">*</span> (f(a) <span class="op">+</span> f(b))</a>
<a class="sourceLine" id="cb398-13" title="13">  <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, n):</a>
<a class="sourceLine" id="cb398-14" title="14">    integral <span class="op">+=</span> h <span class="op">*</span> f(x[i])</a>
<a class="sourceLine" id="cb398-15" title="15"></a>
<a class="sourceLine" id="cb398-16" title="16">  <span class="cf">return</span> integral</a>
<a class="sourceLine" id="cb398-17" title="17"><span class="im">import</span> numpy</a>
<a class="sourceLine" id="cb398-18" title="18"></a>
<a class="sourceLine" id="cb398-19" title="19"><span class="kw">def</span> f(x):</a>
<a class="sourceLine" id="cb398-20" title="20">    <span class="cf">return</span> x <span class="op">**</span> <span class="dv">4</span> <span class="op">*</span> np.log(x <span class="op">+</span> np.sqrt(x <span class="op">**</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">1</span>))</a>
<a class="sourceLine" id="cb398-21" title="21"></a>
<a class="sourceLine" id="cb398-22" title="22">a <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb398-23" title="23">b <span class="op">=</span> <span class="dv">5</span></a>
<a class="sourceLine" id="cb398-24" title="24">n <span class="op">=</span> <span class="dv">100</span></a>
<a class="sourceLine" id="cb398-25" title="25"></a>
<a class="sourceLine" id="cb398-26" title="26">x <span class="op">=</span> np.linspace(a,b,num<span class="op">=</span>n)</a>
<a class="sourceLine" id="cb398-27" title="27">test_intgr <span class="op">=</span> np.trapz(f(x), x<span class="op">=</span>x)</a>
<a class="sourceLine" id="cb398-28" title="28"></a>
<a class="sourceLine" id="cb398-29" title="29">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(trap(f,n,a,b),test_intgr) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-36">Run 1</h4>
<div class="sourceCode" id="cb400"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb400-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb400-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb400-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb400-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb400-5" title="5"></a>
<a class="sourceLine" id="cb400-6" title="6"><span class="kw">def</span> trap(f, n, a, b):</a>
<a class="sourceLine" id="cb400-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb400-8" title="8"><span class="co">  This function evaluates the integral of a univariate function f from a to b with n itervals using the composite trapezoidal rule.</span></a>
<a class="sourceLine" id="cb400-9" title="9"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb400-10" title="10">  h <span class="op">=</span> (b <span class="op">-</span> a)<span class="op">/</span>n</a>
<a class="sourceLine" id="cb400-11" title="11">  integral <span class="op">=</span> <span class="fl">0.5</span><span class="op">*</span>f(a) <span class="op">+</span> <span class="fl">0.5</span><span class="op">*</span>f(b)</a>
<a class="sourceLine" id="cb400-12" title="12">  <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, n):</a>
<a class="sourceLine" id="cb400-13" title="13">    integral <span class="op">+=</span> f(a <span class="op">+</span> i<span class="op">*</span>h)</a>
<a class="sourceLine" id="cb400-14" title="14">  integral <span class="op">*=</span> h</a>
<a class="sourceLine" id="cb400-15" title="15">  <span class="cf">return</span> integral</a>
<a class="sourceLine" id="cb400-16" title="16"><span class="im">import</span> numpy</a>
<a class="sourceLine" id="cb400-17" title="17"></a>
<a class="sourceLine" id="cb400-18" title="18"><span class="kw">def</span> f(x):</a>
<a class="sourceLine" id="cb400-19" title="19">    <span class="cf">return</span> x <span class="op">**</span> <span class="dv">4</span> <span class="op">*</span> np.log(x <span class="op">+</span> np.sqrt(x <span class="op">**</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">1</span>))</a>
<a class="sourceLine" id="cb400-20" title="20"></a>
<a class="sourceLine" id="cb400-21" title="21">a <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb400-22" title="22">b <span class="op">=</span> <span class="dv">5</span></a>
<a class="sourceLine" id="cb400-23" title="23">n <span class="op">=</span> <span class="dv">100</span></a>
<a class="sourceLine" id="cb400-24" title="24"></a>
<a class="sourceLine" id="cb400-25" title="25">x <span class="op">=</span> np.linspace(a,b,num<span class="op">=</span>n)</a>
<a class="sourceLine" id="cb400-26" title="26">test_intgr <span class="op">=</span> np.trapz(f(x), x<span class="op">=</span>x)</a>
<a class="sourceLine" id="cb400-27" title="27"></a>
<a class="sourceLine" id="cb400-28" title="28">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(trap(f,n,a,b),test_intgr) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-36">Run 2</h4>
<div class="sourceCode" id="cb402"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb402-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb402-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb402-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb402-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb402-5" title="5"></a>
<a class="sourceLine" id="cb402-6" title="6"><span class="kw">def</span> trap(f, n, a, b):</a>
<a class="sourceLine" id="cb402-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb402-8" title="8"><span class="co">  This function evaluates the integral of a univariate function f from a to b with n itervals using the composite trapezoidal rule.</span></a>
<a class="sourceLine" id="cb402-9" title="9"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb402-10" title="10">  h <span class="op">=</span> (b<span class="op">-</span>a)<span class="op">/</span>n</a>
<a class="sourceLine" id="cb402-11" title="11">  x <span class="op">=</span> np.linspace(a, b, n<span class="op">+</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb402-12" title="12">  y <span class="op">=</span> f(x)</a>
<a class="sourceLine" id="cb402-13" title="13">  integral <span class="op">=</span> h<span class="op">*</span>(<span class="fl">0.5</span><span class="op">*</span>y[<span class="dv">0</span>] <span class="op">+</span> <span class="fl">0.5</span><span class="op">*</span>y[<span class="op">-</span><span class="dv">1</span>] <span class="op">+</span> np.<span class="bu">sum</span>(y[<span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>]))</a>
<a class="sourceLine" id="cb402-14" title="14">  <span class="cf">return</span> integral</a>
<a class="sourceLine" id="cb402-15" title="15"><span class="im">import</span> numpy</a>
<a class="sourceLine" id="cb402-16" title="16"></a>
<a class="sourceLine" id="cb402-17" title="17"><span class="kw">def</span> f(x):</a>
<a class="sourceLine" id="cb402-18" title="18">    <span class="cf">return</span> x <span class="op">**</span> <span class="dv">4</span> <span class="op">*</span> np.log(x <span class="op">+</span> np.sqrt(x <span class="op">**</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">1</span>))</a>
<a class="sourceLine" id="cb402-19" title="19"></a>
<a class="sourceLine" id="cb402-20" title="20">a <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb402-21" title="21">b <span class="op">=</span> <span class="dv">5</span></a>
<a class="sourceLine" id="cb402-22" title="22">n <span class="op">=</span> <span class="dv">100</span></a>
<a class="sourceLine" id="cb402-23" title="23"></a>
<a class="sourceLine" id="cb402-24" title="24">x <span class="op">=</span> np.linspace(a,b,num<span class="op">=</span>n)</a>
<a class="sourceLine" id="cb402-25" title="25">test_intgr <span class="op">=</span> np.trapz(f(x), x<span class="op">=</span>x)</a>
<a class="sourceLine" id="cb402-26" title="26"></a>
<a class="sourceLine" id="cb402-27" title="27">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(trap(f,n,a,b),test_intgr) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-36">Run 3</h4>
<div class="sourceCode" id="cb404"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb404-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb404-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb404-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb404-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb404-5" title="5"></a>
<a class="sourceLine" id="cb404-6" title="6"><span class="kw">def</span> trap(f, n, a, b):</a>
<a class="sourceLine" id="cb404-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb404-8" title="8"><span class="co">  This function evaluates the integral of a univariate function f from a to b with n itervals using the composite trapezoidal rule.</span></a>
<a class="sourceLine" id="cb404-9" title="9"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb404-10" title="10">  h <span class="op">=</span> (b<span class="op">-</span>a)<span class="op">/</span>n</a>
<a class="sourceLine" id="cb404-11" title="11">  x <span class="op">=</span> np.linspace(a, b, n<span class="op">+</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb404-12" title="12">  integral <span class="op">=</span> <span class="fl">0.5</span><span class="op">*</span>h<span class="op">*</span>(f(a) <span class="op">+</span> f(b))</a>
<a class="sourceLine" id="cb404-13" title="13">  <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, n):</a>
<a class="sourceLine" id="cb404-14" title="14">    integral <span class="op">+=</span> h<span class="op">*</span>f(x[i])</a>
<a class="sourceLine" id="cb404-15" title="15"></a>
<a class="sourceLine" id="cb404-16" title="16">  <span class="cf">return</span> integral</a>
<a class="sourceLine" id="cb404-17" title="17"><span class="im">import</span> numpy</a>
<a class="sourceLine" id="cb404-18" title="18"></a>
<a class="sourceLine" id="cb404-19" title="19"><span class="kw">def</span> f(x):</a>
<a class="sourceLine" id="cb404-20" title="20">    <span class="cf">return</span> x <span class="op">**</span> <span class="dv">4</span> <span class="op">*</span> np.log(x <span class="op">+</span> np.sqrt(x <span class="op">**</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">1</span>))</a>
<a class="sourceLine" id="cb404-21" title="21"></a>
<a class="sourceLine" id="cb404-22" title="22">a <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb404-23" title="23">b <span class="op">=</span> <span class="dv">5</span></a>
<a class="sourceLine" id="cb404-24" title="24">n <span class="op">=</span> <span class="dv">100</span></a>
<a class="sourceLine" id="cb404-25" title="25"></a>
<a class="sourceLine" id="cb404-26" title="26">x <span class="op">=</span> np.linspace(a,b,num<span class="op">=</span>n)</a>
<a class="sourceLine" id="cb404-27" title="27">test_intgr <span class="op">=</span> np.trapz(f(x), x<span class="op">=</span>x)</a>
<a class="sourceLine" id="cb404-28" title="28"></a>
<a class="sourceLine" id="cb404-29" title="29">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(trap(f,n,a,b),test_intgr) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-36">Run 4</h4>
<div class="sourceCode" id="cb406"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb406-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb406-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb406-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb406-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb406-5" title="5"></a>
<a class="sourceLine" id="cb406-6" title="6"><span class="kw">def</span> trap(f, n, a, b):</a>
<a class="sourceLine" id="cb406-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb406-8" title="8"><span class="co">  This function evaluates the integral of a univariate function f from a to b with n itervals using the composite trapezoidal rule.</span></a>
<a class="sourceLine" id="cb406-9" title="9"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb406-10" title="10">  x <span class="op">=</span> np.linspace(a, b, n<span class="op">+</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb406-11" title="11">  h <span class="op">=</span> (b<span class="op">-</span>a)<span class="op">/</span>n</a>
<a class="sourceLine" id="cb406-12" title="12">  integral <span class="op">=</span> <span class="fl">0.5</span><span class="op">*</span>h<span class="op">*</span>(f(a) <span class="op">+</span> f(b))</a>
<a class="sourceLine" id="cb406-13" title="13">  <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, n):</a>
<a class="sourceLine" id="cb406-14" title="14">    integral <span class="op">+=</span> h<span class="op">*</span>f(x[i])</a>
<a class="sourceLine" id="cb406-15" title="15">  <span class="cf">return</span> integral</a>
<a class="sourceLine" id="cb406-16" title="16"><span class="im">import</span> numpy</a>
<a class="sourceLine" id="cb406-17" title="17"></a>
<a class="sourceLine" id="cb406-18" title="18"><span class="kw">def</span> f(x):</a>
<a class="sourceLine" id="cb406-19" title="19">    <span class="cf">return</span> x <span class="op">**</span> <span class="dv">4</span> <span class="op">*</span> np.log(x <span class="op">+</span> np.sqrt(x <span class="op">**</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">1</span>))</a>
<a class="sourceLine" id="cb406-20" title="20"></a>
<a class="sourceLine" id="cb406-21" title="21">a <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb406-22" title="22">b <span class="op">=</span> <span class="dv">5</span></a>
<a class="sourceLine" id="cb406-23" title="23">n <span class="op">=</span> <span class="dv">100</span></a>
<a class="sourceLine" id="cb406-24" title="24"></a>
<a class="sourceLine" id="cb406-25" title="25">x <span class="op">=</span> np.linspace(a,b,num<span class="op">=</span>n)</a>
<a class="sourceLine" id="cb406-26" title="26">test_intgr <span class="op">=</span> np.trapz(f(x), x<span class="op">=</span>x)</a>
<a class="sourceLine" id="cb406-27" title="27"></a>
<a class="sourceLine" id="cb406-28" title="28">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(trap(f,n,a,b),test_intgr) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>invert_matrix</summary></p>
<h4 id="query-37">Query</h4>
<div class="sourceCode" id="cb408"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb408-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb408-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb408-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb408-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb408-5" title="5"></a>
<a class="sourceLine" id="cb408-6" title="6"><span class="kw">def</span> invert_matrix(A):</a>
<a class="sourceLine" id="cb408-7" title="7">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb408-8" title="8"><span class="co">    This function computes the inverse of matrix A</span></a>
<a class="sourceLine" id="cb408-9" title="9"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb408-10" title="10">    [insert]</a>
<a class="sourceLine" id="cb408-11" title="11">    <span class="cf">return</span> Ainv</a></code></pre></div>
<h4 id="run-0-37">Run 0</h4>
<div class="sourceCode" id="cb409"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb409-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb409-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb409-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb409-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb409-5" title="5"></a>
<a class="sourceLine" id="cb409-6" title="6"><span class="kw">def</span> invert_matrix(A):</a>
<a class="sourceLine" id="cb409-7" title="7">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb409-8" title="8"><span class="co">    This function computes the inverse of matrix A</span></a>
<a class="sourceLine" id="cb409-9" title="9"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb409-10" title="10">    Ainv <span class="op">=</span> np.linalg.inv(A)</a>
<a class="sourceLine" id="cb409-11" title="11">    <span class="cf">return</span> Ainv</a>
<a class="sourceLine" id="cb409-12" title="12"></a>
<a class="sourceLine" id="cb409-13" title="13"></a>
<a class="sourceLine" id="cb409-14" title="14"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb409-15" title="15"></a>
<a class="sourceLine" id="cb409-16" title="16">x <span class="op">=</span> np.array([[<span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>], [<span class="dv">2</span>,<span class="dv">6</span>]])</a>
<a class="sourceLine" id="cb409-17" title="17">m_i <span class="op">=</span> invert_matrix(x)</a>
<a class="sourceLine" id="cb409-18" title="18">x_i <span class="op">=</span> np.array([[<span class="fl">0.75</span>,<span class="fl">0.125</span>], [<span class="op">-</span><span class="fl">0.25</span>,<span class="fl">0.125</span>]])</a>
<a class="sourceLine" id="cb409-19" title="19"></a>
<a class="sourceLine" id="cb409-20" title="20">result <span class="op">=</span> np.array_equal(m_i,x_i)</a>
<a class="sourceLine" id="cb409-21" title="21"></a>
<a class="sourceLine" id="cb409-22" title="22"></a>
<a class="sourceLine" id="cb409-23" title="23"></a>
<a class="sourceLine" id="cb409-24" title="24"></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-37">Run 1</h4>
<div class="sourceCode" id="cb411"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb411-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb411-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb411-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb411-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb411-5" title="5"></a>
<a class="sourceLine" id="cb411-6" title="6"><span class="kw">def</span> invert_matrix(A):</a>
<a class="sourceLine" id="cb411-7" title="7">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb411-8" title="8"><span class="co">    This function computes the inverse of matrix A</span></a>
<a class="sourceLine" id="cb411-9" title="9"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb411-10" title="10">    Ainv <span class="op">=</span> np.linalg.inv(A)</a>
<a class="sourceLine" id="cb411-11" title="11">    <span class="cf">return</span> Ainv</a>
<a class="sourceLine" id="cb411-12" title="12"></a>
<a class="sourceLine" id="cb411-13" title="13"></a>
<a class="sourceLine" id="cb411-14" title="14"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb411-15" title="15"></a>
<a class="sourceLine" id="cb411-16" title="16">x <span class="op">=</span> np.array([[<span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>], [<span class="dv">2</span>,<span class="dv">6</span>]])</a>
<a class="sourceLine" id="cb411-17" title="17">m_i <span class="op">=</span> invert_matrix(x)</a>
<a class="sourceLine" id="cb411-18" title="18">x_i <span class="op">=</span> np.array([[<span class="fl">0.75</span>,<span class="fl">0.125</span>], [<span class="op">-</span><span class="fl">0.25</span>,<span class="fl">0.125</span>]])</a>
<a class="sourceLine" id="cb411-19" title="19"></a>
<a class="sourceLine" id="cb411-20" title="20">result <span class="op">=</span> np.array_equal(m_i,x_i)</a>
<a class="sourceLine" id="cb411-21" title="21"></a>
<a class="sourceLine" id="cb411-22" title="22"></a>
<a class="sourceLine" id="cb411-23" title="23"></a>
<a class="sourceLine" id="cb411-24" title="24"></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-37">Run 2</h4>
<div class="sourceCode" id="cb413"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb413-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb413-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb413-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb413-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb413-5" title="5"></a>
<a class="sourceLine" id="cb413-6" title="6"><span class="kw">def</span> invert_matrix(A):</a>
<a class="sourceLine" id="cb413-7" title="7">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb413-8" title="8"><span class="co">    This function computes the inverse of matrix A</span></a>
<a class="sourceLine" id="cb413-9" title="9"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb413-10" title="10">    Ainv <span class="op">=</span> np.linalg.inv(A)</a>
<a class="sourceLine" id="cb413-11" title="11">    <span class="cf">return</span> Ainv</a>
<a class="sourceLine" id="cb413-12" title="12"></a>
<a class="sourceLine" id="cb413-13" title="13"></a>
<a class="sourceLine" id="cb413-14" title="14"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb413-15" title="15"></a>
<a class="sourceLine" id="cb413-16" title="16">x <span class="op">=</span> np.array([[<span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>], [<span class="dv">2</span>,<span class="dv">6</span>]])</a>
<a class="sourceLine" id="cb413-17" title="17">m_i <span class="op">=</span> invert_matrix(x)</a>
<a class="sourceLine" id="cb413-18" title="18">x_i <span class="op">=</span> np.array([[<span class="fl">0.75</span>,<span class="fl">0.125</span>], [<span class="op">-</span><span class="fl">0.25</span>,<span class="fl">0.125</span>]])</a>
<a class="sourceLine" id="cb413-19" title="19"></a>
<a class="sourceLine" id="cb413-20" title="20">result <span class="op">=</span> np.array_equal(m_i,x_i)</a>
<a class="sourceLine" id="cb413-21" title="21"></a>
<a class="sourceLine" id="cb413-22" title="22"></a>
<a class="sourceLine" id="cb413-23" title="23"></a>
<a class="sourceLine" id="cb413-24" title="24"></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-37">Run 3</h4>
<div class="sourceCode" id="cb415"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb415-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb415-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb415-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb415-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb415-5" title="5"></a>
<a class="sourceLine" id="cb415-6" title="6"><span class="kw">def</span> invert_matrix(A):</a>
<a class="sourceLine" id="cb415-7" title="7">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb415-8" title="8"><span class="co">    This function computes the inverse of matrix A</span></a>
<a class="sourceLine" id="cb415-9" title="9"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb415-10" title="10">    Ainv <span class="op">=</span> np.linalg.inv(A)</a>
<a class="sourceLine" id="cb415-11" title="11">    <span class="cf">return</span> Ainv</a>
<a class="sourceLine" id="cb415-12" title="12"></a>
<a class="sourceLine" id="cb415-13" title="13"></a>
<a class="sourceLine" id="cb415-14" title="14"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb415-15" title="15"></a>
<a class="sourceLine" id="cb415-16" title="16">x <span class="op">=</span> np.array([[<span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>], [<span class="dv">2</span>,<span class="dv">6</span>]])</a>
<a class="sourceLine" id="cb415-17" title="17">m_i <span class="op">=</span> invert_matrix(x)</a>
<a class="sourceLine" id="cb415-18" title="18">x_i <span class="op">=</span> np.array([[<span class="fl">0.75</span>,<span class="fl">0.125</span>], [<span class="op">-</span><span class="fl">0.25</span>,<span class="fl">0.125</span>]])</a>
<a class="sourceLine" id="cb415-19" title="19"></a>
<a class="sourceLine" id="cb415-20" title="20">result <span class="op">=</span> np.array_equal(m_i,x_i)</a>
<a class="sourceLine" id="cb415-21" title="21"></a>
<a class="sourceLine" id="cb415-22" title="22"></a>
<a class="sourceLine" id="cb415-23" title="23"></a>
<a class="sourceLine" id="cb415-24" title="24"></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-37">Run 4</h4>
<div class="sourceCode" id="cb417"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb417-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb417-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb417-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb417-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb417-5" title="5"></a>
<a class="sourceLine" id="cb417-6" title="6"><span class="kw">def</span> invert_matrix(A):</a>
<a class="sourceLine" id="cb417-7" title="7">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb417-8" title="8"><span class="co">    This function computes the inverse of matrix A</span></a>
<a class="sourceLine" id="cb417-9" title="9"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb417-10" title="10">    Ainv <span class="op">=</span> np.linalg.inv(A)</a>
<a class="sourceLine" id="cb417-11" title="11">    <span class="cf">return</span> Ainv</a>
<a class="sourceLine" id="cb417-12" title="12"></a>
<a class="sourceLine" id="cb417-13" title="13"></a>
<a class="sourceLine" id="cb417-14" title="14"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb417-15" title="15"></a>
<a class="sourceLine" id="cb417-16" title="16">x <span class="op">=</span> np.array([[<span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>], [<span class="dv">2</span>,<span class="dv">6</span>]])</a>
<a class="sourceLine" id="cb417-17" title="17">m_i <span class="op">=</span> invert_matrix(x)</a>
<a class="sourceLine" id="cb417-18" title="18">x_i <span class="op">=</span> np.array([[<span class="fl">0.75</span>,<span class="fl">0.125</span>], [<span class="op">-</span><span class="fl">0.25</span>,<span class="fl">0.125</span>]])</a>
<a class="sourceLine" id="cb417-19" title="19"></a>
<a class="sourceLine" id="cb417-20" title="20">result <span class="op">=</span> np.array_equal(m_i,x_i)</a>
<a class="sourceLine" id="cb417-21" title="21"></a>
<a class="sourceLine" id="cb417-22" title="22"></a>
<a class="sourceLine" id="cb417-23" title="23"></a>
<a class="sourceLine" id="cb417-24" title="24"></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>iupac2smiles</summary></p>
<h4 id="query-38">Query</h4>
<div class="sourceCode" id="cb419"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb419-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb419-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb419-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb419-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb419-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb419-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb419-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb419-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb419-9" title="9"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb419-10" title="10"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb419-11" title="11"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb419-12" title="12"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb419-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb419-14" title="14"></a>
<a class="sourceLine" id="cb419-15" title="15"><span class="kw">def</span> iupac2smiles(IUPAC):</a>
<a class="sourceLine" id="cb419-16" title="16">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb419-17" title="17"><span class="co">    This function takes in the IUPAC name string and converts it to a SMILES string</span></a>
<a class="sourceLine" id="cb419-18" title="18"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb419-19" title="19">    [insert]</a>
<a class="sourceLine" id="cb419-20" title="20">    <span class="cf">return</span> SMILES</a></code></pre></div>
<h4 id="run-0-38">Run 0</h4>
<div class="sourceCode" id="cb420"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb420-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb420-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb420-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb420-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb420-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb420-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb420-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb420-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb420-9" title="9"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb420-10" title="10"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb420-11" title="11"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb420-12" title="12"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb420-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb420-14" title="14"></a>
<a class="sourceLine" id="cb420-15" title="15"><span class="kw">def</span> iupac2smiles(IUPAC):</a>
<a class="sourceLine" id="cb420-16" title="16">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb420-17" title="17"><span class="co">    This function takes in the IUPAC name string and converts it to a SMILES string</span></a>
<a class="sourceLine" id="cb420-18" title="18"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb420-19" title="19">    mol <span class="op">=</span> Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(IUPAC)))</a>
<a class="sourceLine" id="cb420-20" title="20">    SMILES <span class="op">=</span> Chem.MolToSmiles(mol)</a>
<a class="sourceLine" id="cb420-21" title="21">    <span class="cf">return</span> SMILES</a>
<a class="sourceLine" id="cb420-22" title="22"></a>
<a class="sourceLine" id="cb420-23" title="23">iupac <span class="op">=</span> <span class="st">&quot;2,5,5-trimethyl-2-hexene&quot;</span></a>
<a class="sourceLine" id="cb420-24" title="24">smiles <span class="op">=</span> <span class="st">&quot;CC(C)=CCC(C)(C)C&quot;</span></a>
<a class="sourceLine" id="cb420-25" title="25"></a>
<a class="sourceLine" id="cb420-26" title="26">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> iupac2smiles(iupac) <span class="op">==</span> smiles <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Python argument types in
    rdkit.Chem.rdmolfiles.MolToSmiles(NoneType)
did not match C++ signature:
    MolToSmiles(RDKit::ROMol mol, bool isomericSmiles=True, bool kekuleSmiles=False, int rootedAtAtom=-1, bool canonical=True, bool allBondsExplicit=False, bool allHsExplicit=False, bool doRandom=False)</code></pre>
<h4 id="run-1-38">Run 1</h4>
<div class="sourceCode" id="cb422"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb422-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb422-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb422-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb422-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb422-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb422-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb422-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb422-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb422-9" title="9"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb422-10" title="10"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb422-11" title="11"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb422-12" title="12"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb422-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb422-14" title="14"></a>
<a class="sourceLine" id="cb422-15" title="15"><span class="kw">def</span> iupac2smiles(IUPAC):</a>
<a class="sourceLine" id="cb422-16" title="16">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb422-17" title="17"><span class="co">    This function takes in the IUPAC name string and converts it to a SMILES string</span></a>
<a class="sourceLine" id="cb422-18" title="18"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb422-19" title="19">    mol <span class="op">=</span> Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(IUPAC)))</a>
<a class="sourceLine" id="cb422-20" title="20">    SMILES <span class="op">=</span> Chem.MolToSmiles(mol)</a>
<a class="sourceLine" id="cb422-21" title="21">    <span class="cf">return</span> SMILES</a>
<a class="sourceLine" id="cb422-22" title="22"></a>
<a class="sourceLine" id="cb422-23" title="23">iupac <span class="op">=</span> <span class="st">&quot;2,5,5-trimethyl-2-hexene&quot;</span></a>
<a class="sourceLine" id="cb422-24" title="24">smiles <span class="op">=</span> <span class="st">&quot;CC(C)=CCC(C)(C)C&quot;</span></a>
<a class="sourceLine" id="cb422-25" title="25"></a>
<a class="sourceLine" id="cb422-26" title="26">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> iupac2smiles(iupac) <span class="op">==</span> smiles <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Python argument types in
    rdkit.Chem.rdmolfiles.MolToSmiles(NoneType)
did not match C++ signature:
    MolToSmiles(RDKit::ROMol mol, bool isomericSmiles=True, bool kekuleSmiles=False, int rootedAtAtom=-1, bool canonical=True, bool allBondsExplicit=False, bool allHsExplicit=False, bool doRandom=False)</code></pre>
<h4 id="run-2-38">Run 2</h4>
<div class="sourceCode" id="cb424"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb424-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb424-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb424-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb424-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb424-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb424-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb424-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb424-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb424-9" title="9"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb424-10" title="10"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb424-11" title="11"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb424-12" title="12"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb424-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb424-14" title="14"></a>
<a class="sourceLine" id="cb424-15" title="15"><span class="kw">def</span> iupac2smiles(IUPAC):</a>
<a class="sourceLine" id="cb424-16" title="16">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb424-17" title="17"><span class="co">    This function takes in the IUPAC name string and converts it to a SMILES string</span></a>
<a class="sourceLine" id="cb424-18" title="18"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb424-19" title="19">    mol <span class="op">=</span> Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(IUPAC)))</a>
<a class="sourceLine" id="cb424-20" title="20">    SMILES <span class="op">=</span> Chem.MolToSmiles(mol)</a>
<a class="sourceLine" id="cb424-21" title="21">    <span class="cf">return</span> SMILES</a>
<a class="sourceLine" id="cb424-22" title="22"></a>
<a class="sourceLine" id="cb424-23" title="23">iupac <span class="op">=</span> <span class="st">&quot;2,5,5-trimethyl-2-hexene&quot;</span></a>
<a class="sourceLine" id="cb424-24" title="24">smiles <span class="op">=</span> <span class="st">&quot;CC(C)=CCC(C)(C)C&quot;</span></a>
<a class="sourceLine" id="cb424-25" title="25"></a>
<a class="sourceLine" id="cb424-26" title="26">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> iupac2smiles(iupac) <span class="op">==</span> smiles <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Python argument types in
    rdkit.Chem.rdmolfiles.MolToSmiles(NoneType)
did not match C++ signature:
    MolToSmiles(RDKit::ROMol mol, bool isomericSmiles=True, bool kekuleSmiles=False, int rootedAtAtom=-1, bool canonical=True, bool allBondsExplicit=False, bool allHsExplicit=False, bool doRandom=False)</code></pre>
<h4 id="run-3-38">Run 3</h4>
<div class="sourceCode" id="cb426"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb426-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb426-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb426-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb426-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb426-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb426-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb426-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb426-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb426-9" title="9"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb426-10" title="10"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb426-11" title="11"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb426-12" title="12"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb426-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb426-14" title="14"></a>
<a class="sourceLine" id="cb426-15" title="15"><span class="kw">def</span> iupac2smiles(IUPAC):</a>
<a class="sourceLine" id="cb426-16" title="16">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb426-17" title="17"><span class="co">    This function takes in the IUPAC name string and converts it to a SMILES string</span></a>
<a class="sourceLine" id="cb426-18" title="18"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb426-19" title="19">    mol <span class="op">=</span> Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(IUPAC)))</a>
<a class="sourceLine" id="cb426-20" title="20">    SMILES <span class="op">=</span> Chem.MolToSmiles(mol)</a>
<a class="sourceLine" id="cb426-21" title="21">    <span class="cf">return</span> SMILES</a>
<a class="sourceLine" id="cb426-22" title="22"></a>
<a class="sourceLine" id="cb426-23" title="23">iupac <span class="op">=</span> <span class="st">&quot;2,5,5-trimethyl-2-hexene&quot;</span></a>
<a class="sourceLine" id="cb426-24" title="24">smiles <span class="op">=</span> <span class="st">&quot;CC(C)=CCC(C)(C)C&quot;</span></a>
<a class="sourceLine" id="cb426-25" title="25"></a>
<a class="sourceLine" id="cb426-26" title="26">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> iupac2smiles(iupac) <span class="op">==</span> smiles <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Python argument types in
    rdkit.Chem.rdmolfiles.MolToSmiles(NoneType)
did not match C++ signature:
    MolToSmiles(RDKit::ROMol mol, bool isomericSmiles=True, bool kekuleSmiles=False, int rootedAtAtom=-1, bool canonical=True, bool allBondsExplicit=False, bool allHsExplicit=False, bool doRandom=False)</code></pre>
<h4 id="run-4-38">Run 4</h4>
<div class="sourceCode" id="cb428"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb428-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb428-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb428-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb428-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb428-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb428-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb428-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb428-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb428-9" title="9"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb428-10" title="10"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb428-11" title="11"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb428-12" title="12"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb428-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb428-14" title="14"></a>
<a class="sourceLine" id="cb428-15" title="15"><span class="kw">def</span> iupac2smiles(IUPAC):</a>
<a class="sourceLine" id="cb428-16" title="16">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb428-17" title="17"><span class="co">    This function takes in the IUPAC name string and converts it to a SMILES string</span></a>
<a class="sourceLine" id="cb428-18" title="18"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb428-19" title="19">    m <span class="op">=</span> Chem.MolFromSmiles(IUPAC)</a>
<a class="sourceLine" id="cb428-20" title="20">    SMILES <span class="op">=</span> Chem.MolToSmiles(m)</a>
<a class="sourceLine" id="cb428-21" title="21">    <span class="cf">return</span> SMILES</a>
<a class="sourceLine" id="cb428-22" title="22"></a>
<a class="sourceLine" id="cb428-23" title="23">iupac <span class="op">=</span> <span class="st">&quot;2,5,5-trimethyl-2-hexene&quot;</span></a>
<a class="sourceLine" id="cb428-24" title="24">smiles <span class="op">=</span> <span class="st">&quot;CC(C)=CCC(C)(C)C&quot;</span></a>
<a class="sourceLine" id="cb428-25" title="25"></a>
<a class="sourceLine" id="cb428-26" title="26">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> iupac2smiles(iupac) <span class="op">==</span> smiles <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Python argument types in
    rdkit.Chem.rdmolfiles.MolToSmiles(NoneType)
did not match C++ signature:
    MolToSmiles(RDKit::ROMol mol, bool isomericSmiles=True, bool kekuleSmiles=False, int rootedAtAtom=-1, bool canonical=True, bool allBondsExplicit=False, bool allHsExplicit=False, bool doRandom=False)</code></pre>
</details>
<details>
<p><summary>kld</summary></p>
<h4 id="query-39">Query</h4>
<div class="sourceCode" id="cb430"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb430-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb430-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb430-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb430-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb430-5" title="5"></a>
<a class="sourceLine" id="cb430-6" title="6"><span class="kw">def</span> kld(true_data, predicted_data):</a>
<a class="sourceLine" id="cb430-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb430-8" title="8"><span class="co">  This function calculates the Kullback–Leibler (KL) divergence loss between true_data and predicted_data.</span></a>
<a class="sourceLine" id="cb430-9" title="9"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb430-10" title="10">  [insert]</a>
<a class="sourceLine" id="cb430-11" title="11">  <span class="cf">return</span> loss</a></code></pre></div>
<h4 id="run-0-39">Run 0</h4>
<div class="sourceCode" id="cb431"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb431-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb431-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb431-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb431-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb431-5" title="5"></a>
<a class="sourceLine" id="cb431-6" title="6"><span class="kw">def</span> kld(true_data, predicted_data):</a>
<a class="sourceLine" id="cb431-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb431-8" title="8"><span class="co">  This function calculates the Kullback–Leibler (KL) divergence loss between true_data and predicted_data.</span></a>
<a class="sourceLine" id="cb431-9" title="9"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb431-10" title="10">  loss <span class="op">=</span> np.<span class="bu">sum</span>(np.where(true_data <span class="op">!=</span> <span class="dv">0</span>, true_data <span class="op">*</span> np.log(true_data <span class="op">/</span> predicted_data), <span class="dv">0</span>))</a>
<a class="sourceLine" id="cb431-11" title="11">  <span class="cf">return</span> loss</a>
<a class="sourceLine" id="cb431-12" title="12"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb431-13" title="13"></a>
<a class="sourceLine" id="cb431-14" title="14">np.random.seed(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb431-15" title="15">M <span class="op">=</span> <span class="dv">100</span></a>
<a class="sourceLine" id="cb431-16" title="16">targets <span class="op">=</span> np.random.rand(M)</a>
<a class="sourceLine" id="cb431-17" title="17">predictions <span class="op">=</span> targets <span class="op">*</span> <span class="fl">0.9</span></a>
<a class="sourceLine" id="cb431-18" title="18">kld_loss <span class="op">=</span> <span class="op">-</span>np.<span class="bu">sum</span>(targets<span class="op">*</span>np.log(</a>
<a class="sourceLine" id="cb431-19" title="19">    np.divide(predictions, targets) <span class="op">+</span> <span class="fl">1e-10</span>))</a>
<a class="sourceLine" id="cb431-20" title="20"></a>
<a class="sourceLine" id="cb431-21" title="21">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(kld(targets, predictions), kld_loss) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-39">Run 1</h4>
<div class="sourceCode" id="cb433"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb433-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb433-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb433-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb433-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb433-5" title="5"></a>
<a class="sourceLine" id="cb433-6" title="6"><span class="kw">def</span> kld(true_data, predicted_data):</a>
<a class="sourceLine" id="cb433-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb433-8" title="8"><span class="co">  This function calculates the Kullback–Leibler (KL) divergence loss between true_data and predicted_data.</span></a>
<a class="sourceLine" id="cb433-9" title="9"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb433-10" title="10">  loss <span class="op">=</span> np.<span class="bu">sum</span>(np.where(true_data <span class="op">!=</span> <span class="dv">0</span>, true_data <span class="op">*</span> np.log(true_data <span class="op">/</span> predicted_data), <span class="dv">0</span>))</a>
<a class="sourceLine" id="cb433-11" title="11">  <span class="cf">return</span> loss</a>
<a class="sourceLine" id="cb433-12" title="12"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb433-13" title="13"></a>
<a class="sourceLine" id="cb433-14" title="14">np.random.seed(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb433-15" title="15">M <span class="op">=</span> <span class="dv">100</span></a>
<a class="sourceLine" id="cb433-16" title="16">targets <span class="op">=</span> np.random.rand(M)</a>
<a class="sourceLine" id="cb433-17" title="17">predictions <span class="op">=</span> targets <span class="op">*</span> <span class="fl">0.9</span></a>
<a class="sourceLine" id="cb433-18" title="18">kld_loss <span class="op">=</span> <span class="op">-</span>np.<span class="bu">sum</span>(targets<span class="op">*</span>np.log(</a>
<a class="sourceLine" id="cb433-19" title="19">    np.divide(predictions, targets) <span class="op">+</span> <span class="fl">1e-10</span>))</a>
<a class="sourceLine" id="cb433-20" title="20"></a>
<a class="sourceLine" id="cb433-21" title="21">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(kld(targets, predictions), kld_loss) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-39">Run 2</h4>
<div class="sourceCode" id="cb435"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb435-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb435-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb435-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb435-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb435-5" title="5"></a>
<a class="sourceLine" id="cb435-6" title="6"><span class="kw">def</span> kld(true_data, predicted_data):</a>
<a class="sourceLine" id="cb435-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb435-8" title="8"><span class="co">  This function calculates the Kullback–Leibler (KL) divergence loss between true_data and predicted_data.</span></a>
<a class="sourceLine" id="cb435-9" title="9"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb435-10" title="10">  loss <span class="op">=</span> np.<span class="bu">sum</span>(np.where(true_data <span class="op">!=</span> <span class="dv">0</span>, true_data <span class="op">*</span> np.log(true_data <span class="op">/</span> predicted_data), <span class="dv">0</span>))</a>
<a class="sourceLine" id="cb435-11" title="11">  <span class="cf">return</span> loss</a>
<a class="sourceLine" id="cb435-12" title="12"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb435-13" title="13"></a>
<a class="sourceLine" id="cb435-14" title="14">np.random.seed(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb435-15" title="15">M <span class="op">=</span> <span class="dv">100</span></a>
<a class="sourceLine" id="cb435-16" title="16">targets <span class="op">=</span> np.random.rand(M)</a>
<a class="sourceLine" id="cb435-17" title="17">predictions <span class="op">=</span> targets <span class="op">*</span> <span class="fl">0.9</span></a>
<a class="sourceLine" id="cb435-18" title="18">kld_loss <span class="op">=</span> <span class="op">-</span>np.<span class="bu">sum</span>(targets<span class="op">*</span>np.log(</a>
<a class="sourceLine" id="cb435-19" title="19">    np.divide(predictions, targets) <span class="op">+</span> <span class="fl">1e-10</span>))</a>
<a class="sourceLine" id="cb435-20" title="20"></a>
<a class="sourceLine" id="cb435-21" title="21">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(kld(targets, predictions), kld_loss) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-39">Run 3</h4>
<div class="sourceCode" id="cb437"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb437-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb437-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb437-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb437-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb437-5" title="5"></a>
<a class="sourceLine" id="cb437-6" title="6"><span class="kw">def</span> kld(true_data, predicted_data):</a>
<a class="sourceLine" id="cb437-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb437-8" title="8"><span class="co">  This function calculates the Kullback–Leibler (KL) divergence loss between true_data and predicted_data.</span></a>
<a class="sourceLine" id="cb437-9" title="9"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb437-10" title="10">  loss <span class="op">=</span> np.<span class="bu">sum</span>(true_data <span class="op">*</span> np.log(true_data <span class="op">/</span> predicted_data))</a>
<a class="sourceLine" id="cb437-11" title="11">  <span class="cf">return</span> loss</a>
<a class="sourceLine" id="cb437-12" title="12"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb437-13" title="13"></a>
<a class="sourceLine" id="cb437-14" title="14">np.random.seed(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb437-15" title="15">M <span class="op">=</span> <span class="dv">100</span></a>
<a class="sourceLine" id="cb437-16" title="16">targets <span class="op">=</span> np.random.rand(M)</a>
<a class="sourceLine" id="cb437-17" title="17">predictions <span class="op">=</span> targets <span class="op">*</span> <span class="fl">0.9</span></a>
<a class="sourceLine" id="cb437-18" title="18">kld_loss <span class="op">=</span> <span class="op">-</span>np.<span class="bu">sum</span>(targets<span class="op">*</span>np.log(</a>
<a class="sourceLine" id="cb437-19" title="19">    np.divide(predictions, targets) <span class="op">+</span> <span class="fl">1e-10</span>))</a>
<a class="sourceLine" id="cb437-20" title="20"></a>
<a class="sourceLine" id="cb437-21" title="21">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(kld(targets, predictions), kld_loss) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-39">Run 4</h4>
<div class="sourceCode" id="cb439"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb439-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb439-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb439-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb439-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb439-5" title="5"></a>
<a class="sourceLine" id="cb439-6" title="6"><span class="kw">def</span> kld(true_data, predicted_data):</a>
<a class="sourceLine" id="cb439-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb439-8" title="8"><span class="co">  This function calculates the Kullback–Leibler (KL) divergence loss between true_data and predicted_data.</span></a>
<a class="sourceLine" id="cb439-9" title="9"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb439-10" title="10">  loss <span class="op">=</span> np.<span class="bu">sum</span>(np.where(true_data <span class="op">!=</span> <span class="dv">0</span>, true_data <span class="op">*</span> np.log(true_data <span class="op">/</span> predicted_data), <span class="dv">0</span>))</a>
<a class="sourceLine" id="cb439-11" title="11">  <span class="cf">return</span> loss</a>
<a class="sourceLine" id="cb439-12" title="12"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb439-13" title="13"></a>
<a class="sourceLine" id="cb439-14" title="14">np.random.seed(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb439-15" title="15">M <span class="op">=</span> <span class="dv">100</span></a>
<a class="sourceLine" id="cb439-16" title="16">targets <span class="op">=</span> np.random.rand(M)</a>
<a class="sourceLine" id="cb439-17" title="17">predictions <span class="op">=</span> targets <span class="op">*</span> <span class="fl">0.9</span></a>
<a class="sourceLine" id="cb439-18" title="18">kld_loss <span class="op">=</span> <span class="op">-</span>np.<span class="bu">sum</span>(targets<span class="op">*</span>np.log(</a>
<a class="sourceLine" id="cb439-19" title="19">    np.divide(predictions, targets) <span class="op">+</span> <span class="fl">1e-10</span>))</a>
<a class="sourceLine" id="cb439-20" title="20"></a>
<a class="sourceLine" id="cb439-21" title="21">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(kld(targets, predictions), kld_loss) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>langevin_dynamics</summary></p>
<h4 id="query-40">Query</h4>
<div class="sourceCode" id="cb441"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb441-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb441-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb441-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb441-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb441-5" title="5"></a>
<a class="sourceLine" id="cb441-6" title="6"><span class="kw">def</span> run_langevin_dynamics(x0,v0,gamma,F,n_steps,dt<span class="op">=</span><span class="fl">0.003</span>,T<span class="op">=</span><span class="fl">1.0</span>,m<span class="op">=</span><span class="dv">1</span>):</a>
<a class="sourceLine" id="cb441-7" title="7">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb441-8" title="8"><span class="co">    This function runs a Langevin dynamics simulation in 1d in an external potential</span></a>
<a class="sourceLine" id="cb441-9" title="9"><span class="co">    It returns the trajectory of x and v.</span></a>
<a class="sourceLine" id="cb441-10" title="10"></a>
<a class="sourceLine" id="cb441-11" title="11"><span class="co">    The initial position is x0</span></a>
<a class="sourceLine" id="cb441-12" title="12"><span class="co">    The initial velocity is v0</span></a>
<a class="sourceLine" id="cb441-13" title="13"><span class="co">    The temperature is T</span></a>
<a class="sourceLine" id="cb441-14" title="14"><span class="co">    m is the mass</span></a>
<a class="sourceLine" id="cb441-15" title="15"><span class="co">    F(x) is a function that returns the external force</span></a>
<a class="sourceLine" id="cb441-16" title="16"><span class="co">    gamma is the drag coefficient</span></a>
<a class="sourceLine" id="cb441-17" title="17"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb441-18" title="18">    x_traj <span class="op">=</span> np.zeros(n_steps)</a>
<a class="sourceLine" id="cb441-19" title="19">    v_traj <span class="op">=</span> np.zeros(n_steps)</a>
<a class="sourceLine" id="cb441-20" title="20">    [insert]</a>
<a class="sourceLine" id="cb441-21" title="21">    <span class="cf">return</span> x_traj, v_traj</a></code></pre></div>
<h4 id="run-0-40">Run 0</h4>
<div class="sourceCode" id="cb442"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb442-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb442-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb442-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb442-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb442-5" title="5"></a>
<a class="sourceLine" id="cb442-6" title="6"><span class="kw">def</span> run_langevin_dynamics(x0,v0,gamma,F,n_steps,dt<span class="op">=</span><span class="fl">0.003</span>,T<span class="op">=</span><span class="fl">1.0</span>,m<span class="op">=</span><span class="dv">1</span>):</a>
<a class="sourceLine" id="cb442-7" title="7">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb442-8" title="8"><span class="co">    This function runs a Langevin dynamics simulation in 1d in an external potential</span></a>
<a class="sourceLine" id="cb442-9" title="9"><span class="co">    It returns the trajectory of x and v.</span></a>
<a class="sourceLine" id="cb442-10" title="10"></a>
<a class="sourceLine" id="cb442-11" title="11"><span class="co">    The initial position is x0</span></a>
<a class="sourceLine" id="cb442-12" title="12"><span class="co">    The initial velocity is v0</span></a>
<a class="sourceLine" id="cb442-13" title="13"><span class="co">    The temperature is T</span></a>
<a class="sourceLine" id="cb442-14" title="14"><span class="co">    m is the mass</span></a>
<a class="sourceLine" id="cb442-15" title="15"><span class="co">    F(x) is a function that returns the external force</span></a>
<a class="sourceLine" id="cb442-16" title="16"><span class="co">    gamma is the drag coefficient</span></a>
<a class="sourceLine" id="cb442-17" title="17"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb442-18" title="18">    x_traj <span class="op">=</span> np.zeros(n_steps)</a>
<a class="sourceLine" id="cb442-19" title="19">    v_traj <span class="op">=</span> np.zeros(n_steps)</a>
<a class="sourceLine" id="cb442-20" title="20">    x_traj[<span class="dv">0</span>] <span class="op">=</span> x0</a>
<a class="sourceLine" id="cb442-21" title="21">    v_traj[<span class="dv">0</span>] <span class="op">=</span> v0</a>
<a class="sourceLine" id="cb442-22" title="22">    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n_steps<span class="dv">-1</span>):</a>
<a class="sourceLine" id="cb442-23" title="23">        v_traj[i<span class="op">+</span><span class="dv">1</span>] <span class="op">=</span> v_traj[i] <span class="op">-</span> (gamma<span class="op">/</span>m)<span class="op">*</span>v_traj[i]<span class="op">*</span>dt <span class="op">+</span> (<span class="dv">1</span><span class="op">/</span>m)<span class="op">*</span>F(x_traj[i])<span class="op">*</span>dt <span class="op">+</span> np.sqrt(<span class="dv">2</span><span class="op">*</span>gamma<span class="op">*</span>T<span class="op">*</span>dt<span class="op">/</span>m)<span class="op">*</span>np.random.normal()</a>
<a class="sourceLine" id="cb442-24" title="24">        x_traj[i<span class="op">+</span><span class="dv">1</span>] <span class="op">=</span> x_traj[i] <span class="op">+</span> v_traj[i<span class="op">+</span><span class="dv">1</span>]<span class="op">*</span>dt</a>
<a class="sourceLine" id="cb442-25" title="25"></a>
<a class="sourceLine" id="cb442-26" title="26">    <span class="cf">return</span> x_traj, v_traj</a>
<a class="sourceLine" id="cb442-27" title="27"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb442-28" title="28"><span class="im">import</span> pylab <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb442-29" title="29"><span class="co">#def PE(q):</span></a>
<a class="sourceLine" id="cb442-30" title="30"><span class="co">#    return (q**2-1.0)**2</span></a>
<a class="sourceLine" id="cb442-31" title="31"><span class="co">#def F(q):</span></a>
<a class="sourceLine" id="cb442-32" title="32"><span class="co">#    return -4.0 * q * (q**2-1.0)</span></a>
<a class="sourceLine" id="cb442-33" title="33"><span class="kw">def</span> F(q,k<span class="op">=</span><span class="dv">2</span>):</a>
<a class="sourceLine" id="cb442-34" title="34">    <span class="cf">return</span> <span class="op">-</span>k<span class="op">*</span>q</a>
<a class="sourceLine" id="cb442-35" title="35"></a>
<a class="sourceLine" id="cb442-36" title="36">x_traj, v_traj <span class="op">=</span> run_langevin_dynamics(<span class="fl">0.1</span>,<span class="op">-</span><span class="fl">0.1</span>,<span class="fl">0.1</span>,F,<span class="dv">100000</span>)</a>
<a class="sourceLine" id="cb442-37" title="37">plt.plot(x_traj)</a>
<a class="sourceLine" id="cb442-38" title="38">plt.show()</a>
<a class="sourceLine" id="cb442-39" title="39">v_traj_half <span class="op">=</span> np.array(v_traj)[<span class="bu">len</span>(v_traj)<span class="op">//</span><span class="dv">2</span>:]</a>
<a class="sourceLine" id="cb442-40" title="40">msv <span class="op">=</span> v_traj_half.var()</a>
<a class="sourceLine" id="cb442-41" title="41">ideal_msv <span class="op">=</span> <span class="dv">1</span> <span class="co">#kT/m</span></a>
<a class="sourceLine" id="cb442-42" title="42"></a>
<a class="sourceLine" id="cb442-43" title="43">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">abs</span>(msv<span class="op">-</span>ideal_msv)<span class="op">/</span>ideal_msv <span class="op">&lt;</span> <span class="fl">0.2</span> <span class="kw">and</span> np.<span class="bu">abs</span>(np.mean(x_traj[<span class="bu">len</span>(x_traj)<span class="op">//</span><span class="dv">2</span>:]))<span class="op">&lt;</span><span class="fl">0.1</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-40">Run 1</h4>
<div class="sourceCode" id="cb444"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb444-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb444-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb444-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb444-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb444-5" title="5"></a>
<a class="sourceLine" id="cb444-6" title="6"><span class="kw">def</span> run_langevin_dynamics(x0,v0,gamma,F,n_steps,dt<span class="op">=</span><span class="fl">0.003</span>,T<span class="op">=</span><span class="fl">1.0</span>,m<span class="op">=</span><span class="dv">1</span>):</a>
<a class="sourceLine" id="cb444-7" title="7">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb444-8" title="8"><span class="co">    This function runs a Langevin dynamics simulation in 1d in an external potential</span></a>
<a class="sourceLine" id="cb444-9" title="9"><span class="co">    It returns the trajectory of x and v.</span></a>
<a class="sourceLine" id="cb444-10" title="10"></a>
<a class="sourceLine" id="cb444-11" title="11"><span class="co">    The initial position is x0</span></a>
<a class="sourceLine" id="cb444-12" title="12"><span class="co">    The initial velocity is v0</span></a>
<a class="sourceLine" id="cb444-13" title="13"><span class="co">    The temperature is T</span></a>
<a class="sourceLine" id="cb444-14" title="14"><span class="co">    m is the mass</span></a>
<a class="sourceLine" id="cb444-15" title="15"><span class="co">    F(x) is a function that returns the external force</span></a>
<a class="sourceLine" id="cb444-16" title="16"><span class="co">    gamma is the drag coefficient</span></a>
<a class="sourceLine" id="cb444-17" title="17"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb444-18" title="18">    x_traj <span class="op">=</span> np.zeros(n_steps)</a>
<a class="sourceLine" id="cb444-19" title="19">    v_traj <span class="op">=</span> np.zeros(n_steps)</a>
<a class="sourceLine" id="cb444-20" title="20">    x_traj[<span class="dv">0</span>] <span class="op">=</span> x0</a>
<a class="sourceLine" id="cb444-21" title="21">    v_traj[<span class="dv">0</span>] <span class="op">=</span> v0</a>
<a class="sourceLine" id="cb444-22" title="22">    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n_steps<span class="dv">-1</span>):</a>
<a class="sourceLine" id="cb444-23" title="23">        v_traj[i<span class="op">+</span><span class="dv">1</span>] <span class="op">=</span> v_traj[i] <span class="op">-</span> (gamma<span class="op">/</span>m)<span class="op">*</span>v_traj[i]<span class="op">*</span>dt <span class="op">+</span> (<span class="dv">1</span><span class="op">/</span>m)<span class="op">*</span>F(x_traj[i])<span class="op">*</span>dt <span class="op">+</span> np.sqrt(<span class="dv">2</span><span class="op">*</span>gamma<span class="op">*</span>T<span class="op">/</span>m)<span class="op">*</span>np.random.normal(<span class="dv">0</span>,<span class="dv">1</span>)<span class="op">*</span>np.sqrt(dt)</a>
<a class="sourceLine" id="cb444-24" title="24">        x_traj[i<span class="op">+</span><span class="dv">1</span>] <span class="op">=</span> x_traj[i] <span class="op">+</span> v_traj[i<span class="op">+</span><span class="dv">1</span>]<span class="op">*</span>dt</a>
<a class="sourceLine" id="cb444-25" title="25"></a>
<a class="sourceLine" id="cb444-26" title="26">    <span class="cf">return</span> x_traj, v_traj</a>
<a class="sourceLine" id="cb444-27" title="27"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb444-28" title="28"><span class="im">import</span> pylab <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb444-29" title="29"><span class="co">#def PE(q):</span></a>
<a class="sourceLine" id="cb444-30" title="30"><span class="co">#    return (q**2-1.0)**2</span></a>
<a class="sourceLine" id="cb444-31" title="31"><span class="co">#def F(q):</span></a>
<a class="sourceLine" id="cb444-32" title="32"><span class="co">#    return -4.0 * q * (q**2-1.0)</span></a>
<a class="sourceLine" id="cb444-33" title="33"><span class="kw">def</span> F(q,k<span class="op">=</span><span class="dv">2</span>):</a>
<a class="sourceLine" id="cb444-34" title="34">    <span class="cf">return</span> <span class="op">-</span>k<span class="op">*</span>q</a>
<a class="sourceLine" id="cb444-35" title="35"></a>
<a class="sourceLine" id="cb444-36" title="36">x_traj, v_traj <span class="op">=</span> run_langevin_dynamics(<span class="fl">0.1</span>,<span class="op">-</span><span class="fl">0.1</span>,<span class="fl">0.1</span>,F,<span class="dv">100000</span>)</a>
<a class="sourceLine" id="cb444-37" title="37">plt.plot(x_traj)</a>
<a class="sourceLine" id="cb444-38" title="38">plt.show()</a>
<a class="sourceLine" id="cb444-39" title="39">v_traj_half <span class="op">=</span> np.array(v_traj)[<span class="bu">len</span>(v_traj)<span class="op">//</span><span class="dv">2</span>:]</a>
<a class="sourceLine" id="cb444-40" title="40">msv <span class="op">=</span> v_traj_half.var()</a>
<a class="sourceLine" id="cb444-41" title="41">ideal_msv <span class="op">=</span> <span class="dv">1</span> <span class="co">#kT/m</span></a>
<a class="sourceLine" id="cb444-42" title="42"></a>
<a class="sourceLine" id="cb444-43" title="43">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">abs</span>(msv<span class="op">-</span>ideal_msv)<span class="op">/</span>ideal_msv <span class="op">&lt;</span> <span class="fl">0.2</span> <span class="kw">and</span> np.<span class="bu">abs</span>(np.mean(x_traj[<span class="bu">len</span>(x_traj)<span class="op">//</span><span class="dv">2</span>:]))<span class="op">&lt;</span><span class="fl">0.1</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-40">Run 2</h4>
<div class="sourceCode" id="cb446"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb446-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb446-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb446-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb446-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb446-5" title="5"></a>
<a class="sourceLine" id="cb446-6" title="6"><span class="kw">def</span> run_langevin_dynamics(x0,v0,gamma,F,n_steps,dt<span class="op">=</span><span class="fl">0.003</span>,T<span class="op">=</span><span class="fl">1.0</span>,m<span class="op">=</span><span class="dv">1</span>):</a>
<a class="sourceLine" id="cb446-7" title="7">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb446-8" title="8"><span class="co">    This function runs a Langevin dynamics simulation in 1d in an external potential</span></a>
<a class="sourceLine" id="cb446-9" title="9"><span class="co">    It returns the trajectory of x and v.</span></a>
<a class="sourceLine" id="cb446-10" title="10"></a>
<a class="sourceLine" id="cb446-11" title="11"><span class="co">    The initial position is x0</span></a>
<a class="sourceLine" id="cb446-12" title="12"><span class="co">    The initial velocity is v0</span></a>
<a class="sourceLine" id="cb446-13" title="13"><span class="co">    The temperature is T</span></a>
<a class="sourceLine" id="cb446-14" title="14"><span class="co">    m is the mass</span></a>
<a class="sourceLine" id="cb446-15" title="15"><span class="co">    F(x) is a function that returns the external force</span></a>
<a class="sourceLine" id="cb446-16" title="16"><span class="co">    gamma is the drag coefficient</span></a>
<a class="sourceLine" id="cb446-17" title="17"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb446-18" title="18">    x_traj <span class="op">=</span> np.zeros(n_steps)</a>
<a class="sourceLine" id="cb446-19" title="19">    v_traj <span class="op">=</span> np.zeros(n_steps)</a>
<a class="sourceLine" id="cb446-20" title="20">    x_traj[<span class="dv">0</span>] <span class="op">=</span> x0</a>
<a class="sourceLine" id="cb446-21" title="21">    v_traj[<span class="dv">0</span>] <span class="op">=</span> v0</a>
<a class="sourceLine" id="cb446-22" title="22">    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n_steps<span class="dv">-1</span>):</a>
<a class="sourceLine" id="cb446-23" title="23">        x_traj[i<span class="op">+</span><span class="dv">1</span>] <span class="op">=</span> x_traj[i] <span class="op">+</span> v_traj[i]<span class="op">*</span>dt</a>
<a class="sourceLine" id="cb446-24" title="24">        v_traj[i<span class="op">+</span><span class="dv">1</span>] <span class="op">=</span> v_traj[i] <span class="op">+</span> (<span class="op">-</span>gamma<span class="op">*</span>v_traj[i] <span class="op">+</span> F(x_traj[i])<span class="op">/</span>m <span class="op">+</span> np.sqrt(<span class="dv">2</span><span class="op">*</span>gamma<span class="op">*</span>T<span class="op">/</span>m)<span class="op">*</span>np.random.normal())<span class="op">*</span>dt</a>
<a class="sourceLine" id="cb446-25" title="25"></a>
<a class="sourceLine" id="cb446-26" title="26">    <span class="cf">return</span> x_traj, v_traj</a>
<a class="sourceLine" id="cb446-27" title="27"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb446-28" title="28"><span class="im">import</span> pylab <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb446-29" title="29"><span class="co">#def PE(q):</span></a>
<a class="sourceLine" id="cb446-30" title="30"><span class="co">#    return (q**2-1.0)**2</span></a>
<a class="sourceLine" id="cb446-31" title="31"><span class="co">#def F(q):</span></a>
<a class="sourceLine" id="cb446-32" title="32"><span class="co">#    return -4.0 * q * (q**2-1.0)</span></a>
<a class="sourceLine" id="cb446-33" title="33"><span class="kw">def</span> F(q,k<span class="op">=</span><span class="dv">2</span>):</a>
<a class="sourceLine" id="cb446-34" title="34">    <span class="cf">return</span> <span class="op">-</span>k<span class="op">*</span>q</a>
<a class="sourceLine" id="cb446-35" title="35"></a>
<a class="sourceLine" id="cb446-36" title="36">x_traj, v_traj <span class="op">=</span> run_langevin_dynamics(<span class="fl">0.1</span>,<span class="op">-</span><span class="fl">0.1</span>,<span class="fl">0.1</span>,F,<span class="dv">100000</span>)</a>
<a class="sourceLine" id="cb446-37" title="37">plt.plot(x_traj)</a>
<a class="sourceLine" id="cb446-38" title="38">plt.show()</a>
<a class="sourceLine" id="cb446-39" title="39">v_traj_half <span class="op">=</span> np.array(v_traj)[<span class="bu">len</span>(v_traj)<span class="op">//</span><span class="dv">2</span>:]</a>
<a class="sourceLine" id="cb446-40" title="40">msv <span class="op">=</span> v_traj_half.var()</a>
<a class="sourceLine" id="cb446-41" title="41">ideal_msv <span class="op">=</span> <span class="dv">1</span> <span class="co">#kT/m</span></a>
<a class="sourceLine" id="cb446-42" title="42"></a>
<a class="sourceLine" id="cb446-43" title="43">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">abs</span>(msv<span class="op">-</span>ideal_msv)<span class="op">/</span>ideal_msv <span class="op">&lt;</span> <span class="fl">0.2</span> <span class="kw">and</span> np.<span class="bu">abs</span>(np.mean(x_traj[<span class="bu">len</span>(x_traj)<span class="op">//</span><span class="dv">2</span>:]))<span class="op">&lt;</span><span class="fl">0.1</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-40">Run 3</h4>
<div class="sourceCode" id="cb448"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb448-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb448-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb448-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb448-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb448-5" title="5"></a>
<a class="sourceLine" id="cb448-6" title="6"><span class="kw">def</span> run_langevin_dynamics(x0,v0,gamma,F,n_steps,dt<span class="op">=</span><span class="fl">0.003</span>,T<span class="op">=</span><span class="fl">1.0</span>,m<span class="op">=</span><span class="dv">1</span>):</a>
<a class="sourceLine" id="cb448-7" title="7">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb448-8" title="8"><span class="co">    This function runs a Langevin dynamics simulation in 1d in an external potential</span></a>
<a class="sourceLine" id="cb448-9" title="9"><span class="co">    It returns the trajectory of x and v.</span></a>
<a class="sourceLine" id="cb448-10" title="10"></a>
<a class="sourceLine" id="cb448-11" title="11"><span class="co">    The initial position is x0</span></a>
<a class="sourceLine" id="cb448-12" title="12"><span class="co">    The initial velocity is v0</span></a>
<a class="sourceLine" id="cb448-13" title="13"><span class="co">    The temperature is T</span></a>
<a class="sourceLine" id="cb448-14" title="14"><span class="co">    m is the mass</span></a>
<a class="sourceLine" id="cb448-15" title="15"><span class="co">    F(x) is a function that returns the external force</span></a>
<a class="sourceLine" id="cb448-16" title="16"><span class="co">    gamma is the drag coefficient</span></a>
<a class="sourceLine" id="cb448-17" title="17"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb448-18" title="18">    x_traj <span class="op">=</span> np.zeros(n_steps)</a>
<a class="sourceLine" id="cb448-19" title="19">    v_traj <span class="op">=</span> np.zeros(n_steps)</a>
<a class="sourceLine" id="cb448-20" title="20">    x_traj[<span class="dv">0</span>] <span class="op">=</span> x0</a>
<a class="sourceLine" id="cb448-21" title="21">    v_traj[<span class="dv">0</span>] <span class="op">=</span> v0</a>
<a class="sourceLine" id="cb448-22" title="22">    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n_steps<span class="dv">-1</span>):</a>
<a class="sourceLine" id="cb448-23" title="23">        x_traj[i<span class="op">+</span><span class="dv">1</span>] <span class="op">=</span> x_traj[i] <span class="op">+</span> dt<span class="op">*</span>v_traj[i]</a>
<a class="sourceLine" id="cb448-24" title="24">        v_traj[i<span class="op">+</span><span class="dv">1</span>] <span class="op">=</span> v_traj[i] <span class="op">+</span> dt<span class="op">*</span>(F(x_traj[i])<span class="op">/</span>m <span class="op">-</span> gamma<span class="op">*</span>v_traj[i] <span class="op">+</span> np.sqrt(<span class="dv">2</span><span class="op">*</span>gamma<span class="op">*</span>T<span class="op">/</span>m)<span class="op">*</span>np.random.normal())</a>
<a class="sourceLine" id="cb448-25" title="25">    <span class="cf">return</span> x_traj, v_traj</a>
<a class="sourceLine" id="cb448-26" title="26"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb448-27" title="27"><span class="im">import</span> pylab <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb448-28" title="28"><span class="co">#def PE(q):</span></a>
<a class="sourceLine" id="cb448-29" title="29"><span class="co">#    return (q**2-1.0)**2</span></a>
<a class="sourceLine" id="cb448-30" title="30"><span class="co">#def F(q):</span></a>
<a class="sourceLine" id="cb448-31" title="31"><span class="co">#    return -4.0 * q * (q**2-1.0)</span></a>
<a class="sourceLine" id="cb448-32" title="32"><span class="kw">def</span> F(q,k<span class="op">=</span><span class="dv">2</span>):</a>
<a class="sourceLine" id="cb448-33" title="33">    <span class="cf">return</span> <span class="op">-</span>k<span class="op">*</span>q</a>
<a class="sourceLine" id="cb448-34" title="34"></a>
<a class="sourceLine" id="cb448-35" title="35">x_traj, v_traj <span class="op">=</span> run_langevin_dynamics(<span class="fl">0.1</span>,<span class="op">-</span><span class="fl">0.1</span>,<span class="fl">0.1</span>,F,<span class="dv">100000</span>)</a>
<a class="sourceLine" id="cb448-36" title="36">plt.plot(x_traj)</a>
<a class="sourceLine" id="cb448-37" title="37">plt.show()</a>
<a class="sourceLine" id="cb448-38" title="38">v_traj_half <span class="op">=</span> np.array(v_traj)[<span class="bu">len</span>(v_traj)<span class="op">//</span><span class="dv">2</span>:]</a>
<a class="sourceLine" id="cb448-39" title="39">msv <span class="op">=</span> v_traj_half.var()</a>
<a class="sourceLine" id="cb448-40" title="40">ideal_msv <span class="op">=</span> <span class="dv">1</span> <span class="co">#kT/m</span></a>
<a class="sourceLine" id="cb448-41" title="41"></a>
<a class="sourceLine" id="cb448-42" title="42">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">abs</span>(msv<span class="op">-</span>ideal_msv)<span class="op">/</span>ideal_msv <span class="op">&lt;</span> <span class="fl">0.2</span> <span class="kw">and</span> np.<span class="bu">abs</span>(np.mean(x_traj[<span class="bu">len</span>(x_traj)<span class="op">//</span><span class="dv">2</span>:]))<span class="op">&lt;</span><span class="fl">0.1</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-40">Run 4</h4>
<div class="sourceCode" id="cb450"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb450-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb450-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb450-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb450-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb450-5" title="5"></a>
<a class="sourceLine" id="cb450-6" title="6"><span class="kw">def</span> run_langevin_dynamics(x0,v0,gamma,F,n_steps,dt<span class="op">=</span><span class="fl">0.003</span>,T<span class="op">=</span><span class="fl">1.0</span>,m<span class="op">=</span><span class="dv">1</span>):</a>
<a class="sourceLine" id="cb450-7" title="7">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb450-8" title="8"><span class="co">    This function runs a Langevin dynamics simulation in 1d in an external potential</span></a>
<a class="sourceLine" id="cb450-9" title="9"><span class="co">    It returns the trajectory of x and v.</span></a>
<a class="sourceLine" id="cb450-10" title="10"></a>
<a class="sourceLine" id="cb450-11" title="11"><span class="co">    The initial position is x0</span></a>
<a class="sourceLine" id="cb450-12" title="12"><span class="co">    The initial velocity is v0</span></a>
<a class="sourceLine" id="cb450-13" title="13"><span class="co">    The temperature is T</span></a>
<a class="sourceLine" id="cb450-14" title="14"><span class="co">    m is the mass</span></a>
<a class="sourceLine" id="cb450-15" title="15"><span class="co">    F(x) is a function that returns the external force</span></a>
<a class="sourceLine" id="cb450-16" title="16"><span class="co">    gamma is the drag coefficient</span></a>
<a class="sourceLine" id="cb450-17" title="17"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb450-18" title="18">    x_traj <span class="op">=</span> np.zeros(n_steps)</a>
<a class="sourceLine" id="cb450-19" title="19">    v_traj <span class="op">=</span> np.zeros(n_steps)</a>
<a class="sourceLine" id="cb450-20" title="20">    x_traj[<span class="dv">0</span>] <span class="op">=</span> x0</a>
<a class="sourceLine" id="cb450-21" title="21">    v_traj[<span class="dv">0</span>] <span class="op">=</span> v0</a>
<a class="sourceLine" id="cb450-22" title="22">    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n_steps<span class="dv">-1</span>):</a>
<a class="sourceLine" id="cb450-23" title="23">        x_traj[i<span class="op">+</span><span class="dv">1</span>] <span class="op">=</span> x_traj[i] <span class="op">+</span> v_traj[i]<span class="op">*</span>dt</a>
<a class="sourceLine" id="cb450-24" title="24">        v_traj[i<span class="op">+</span><span class="dv">1</span>] <span class="op">=</span> v_traj[i] <span class="op">+</span> (F(x_traj[i])<span class="op">/</span>m <span class="op">-</span> gamma<span class="op">*</span>v_traj[i])<span class="op">*</span>dt <span class="op">+</span> np.sqrt(<span class="dv">2</span><span class="op">*</span>gamma<span class="op">*</span>T<span class="op">*</span>dt)<span class="op">*</span>np.random.normal()</a>
<a class="sourceLine" id="cb450-25" title="25"></a>
<a class="sourceLine" id="cb450-26" title="26">    <span class="cf">return</span> x_traj, v_traj</a>
<a class="sourceLine" id="cb450-27" title="27"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb450-28" title="28"><span class="im">import</span> pylab <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb450-29" title="29"><span class="co">#def PE(q):</span></a>
<a class="sourceLine" id="cb450-30" title="30"><span class="co">#    return (q**2-1.0)**2</span></a>
<a class="sourceLine" id="cb450-31" title="31"><span class="co">#def F(q):</span></a>
<a class="sourceLine" id="cb450-32" title="32"><span class="co">#    return -4.0 * q * (q**2-1.0)</span></a>
<a class="sourceLine" id="cb450-33" title="33"><span class="kw">def</span> F(q,k<span class="op">=</span><span class="dv">2</span>):</a>
<a class="sourceLine" id="cb450-34" title="34">    <span class="cf">return</span> <span class="op">-</span>k<span class="op">*</span>q</a>
<a class="sourceLine" id="cb450-35" title="35"></a>
<a class="sourceLine" id="cb450-36" title="36">x_traj, v_traj <span class="op">=</span> run_langevin_dynamics(<span class="fl">0.1</span>,<span class="op">-</span><span class="fl">0.1</span>,<span class="fl">0.1</span>,F,<span class="dv">100000</span>)</a>
<a class="sourceLine" id="cb450-37" title="37">plt.plot(x_traj)</a>
<a class="sourceLine" id="cb450-38" title="38">plt.show()</a>
<a class="sourceLine" id="cb450-39" title="39">v_traj_half <span class="op">=</span> np.array(v_traj)[<span class="bu">len</span>(v_traj)<span class="op">//</span><span class="dv">2</span>:]</a>
<a class="sourceLine" id="cb450-40" title="40">msv <span class="op">=</span> v_traj_half.var()</a>
<a class="sourceLine" id="cb450-41" title="41">ideal_msv <span class="op">=</span> <span class="dv">1</span> <span class="co">#kT/m</span></a>
<a class="sourceLine" id="cb450-42" title="42"></a>
<a class="sourceLine" id="cb450-43" title="43">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">abs</span>(msv<span class="op">-</span>ideal_msv)<span class="op">/</span>ideal_msv <span class="op">&lt;</span> <span class="fl">0.2</span> <span class="kw">and</span> np.<span class="bu">abs</span>(np.mean(x_traj[<span class="bu">len</span>(x_traj)<span class="op">//</span><span class="dv">2</span>:]))<span class="op">&lt;</span><span class="fl">0.1</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>lipinski_rule_of_five</summary></p>
<h4 id="query-41">Query</h4>
<div class="sourceCode" id="cb452"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb452-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb452-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb452-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb452-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb452-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb452-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb452-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb452-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb452-9" title="9"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb452-10" title="10"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb452-11" title="11"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb452-12" title="12"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb452-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb452-14" title="14"></a>
<a class="sourceLine" id="cb452-15" title="15"><span class="kw">def</span> lipinski_rule_of_five(smiles):</a>
<a class="sourceLine" id="cb452-16" title="16">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb452-17" title="17"><span class="co">    This function calculates the Lipinski descriptors of the given SMILES string and returns a boolean to indicate if Lipinski&#39;s rule of five was satisfied.</span></a>
<a class="sourceLine" id="cb452-18" title="18"></a>
<a class="sourceLine" id="cb452-19" title="19"><span class="co">    Lipinski&#39;s rules are:</span></a>
<a class="sourceLine" id="cb452-20" title="20"><span class="co">    Hydrogen bond donors &lt;= 5</span></a>
<a class="sourceLine" id="cb452-21" title="21"><span class="co">    Hydrogen bond acceptors &lt;= 10</span></a>
<a class="sourceLine" id="cb452-22" title="22"><span class="co">    Molecular weight &lt; 500 daltons</span></a>
<a class="sourceLine" id="cb452-23" title="23"><span class="co">    logP &lt; 5</span></a>
<a class="sourceLine" id="cb452-24" title="24"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb452-25" title="25">    [insert]</a>
<a class="sourceLine" id="cb452-26" title="26">    <span class="cf">return</span> result</a></code></pre></div>
<h4 id="run-0-41">Run 0</h4>
<div class="sourceCode" id="cb453"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb453-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb453-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb453-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb453-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb453-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb453-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb453-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb453-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb453-9" title="9"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb453-10" title="10"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb453-11" title="11"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb453-12" title="12"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb453-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb453-14" title="14"></a>
<a class="sourceLine" id="cb453-15" title="15"><span class="kw">def</span> lipinski_rule_of_five(smiles):</a>
<a class="sourceLine" id="cb453-16" title="16">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb453-17" title="17"><span class="co">    This function calculates the Lipinski descriptors of the given SMILES string and returns a boolean to indicate if Lipinski&#39;s rule of five was satisfied.</span></a>
<a class="sourceLine" id="cb453-18" title="18"></a>
<a class="sourceLine" id="cb453-19" title="19"><span class="co">    Lipinski&#39;s rules are:</span></a>
<a class="sourceLine" id="cb453-20" title="20"><span class="co">    Hydrogen bond donors &lt;= 5</span></a>
<a class="sourceLine" id="cb453-21" title="21"><span class="co">    Hydrogen bond acceptors &lt;= 10</span></a>
<a class="sourceLine" id="cb453-22" title="22"><span class="co">    Molecular weight &lt; 500 daltons</span></a>
<a class="sourceLine" id="cb453-23" title="23"><span class="co">    logP &lt; 5</span></a>
<a class="sourceLine" id="cb453-24" title="24"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb453-25" title="25">    mol <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb453-26" title="26">    <span class="cf">if</span> mol <span class="kw">is</span> <span class="va">None</span>:</a>
<a class="sourceLine" id="cb453-27" title="27">        <span class="cf">return</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb453-28" title="28">    result <span class="op">=</span> <span class="va">True</span></a>
<a class="sourceLine" id="cb453-29" title="29">    <span class="cf">if</span> Descriptors.NumHDonors(mol) <span class="op">&gt;</span> <span class="dv">5</span>:</a>
<a class="sourceLine" id="cb453-30" title="30">        result <span class="op">=</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb453-31" title="31">    <span class="cf">if</span> Descriptors.NumHAcceptors(mol) <span class="op">&gt;</span> <span class="dv">10</span>:</a>
<a class="sourceLine" id="cb453-32" title="32">        result <span class="op">=</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb453-33" title="33">    <span class="cf">if</span> Descriptors.MolWt(mol) <span class="op">&gt;</span> <span class="dv">500</span>:</a>
<a class="sourceLine" id="cb453-34" title="34">        result <span class="op">=</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb453-35" title="35">    <span class="cf">if</span> Crippen.MolLogP(mol) <span class="op">&gt;</span> <span class="dv">5</span>:</a>
<a class="sourceLine" id="cb453-36" title="36">        result <span class="op">=</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb453-37" title="37"></a>
<a class="sourceLine" id="cb453-38" title="38">    <span class="cf">return</span> result</a>
<a class="sourceLine" id="cb453-39" title="39"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb453-40" title="40">smiles <span class="op">=</span> <span class="st">&#39;CC1=CN=C(C(=C1OC)C)CS(=O)C2=NC3=C(N2)C=C(C=C3)OC&#39;</span>  <span class="co"># omeprazole</span></a>
<a class="sourceLine" id="cb453-41" title="41">m <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb453-42" title="42">hbd <span class="op">=</span> Chem.rdMolDescriptors.CalcNumHBD(m)</a>
<a class="sourceLine" id="cb453-43" title="43">hba <span class="op">=</span> Chem.rdMolDescriptors.CalcNumHBA(m)</a>
<a class="sourceLine" id="cb453-44" title="44">wt <span class="op">=</span> Chem.rdMolDescriptors.CalcExactMolWt(m)</a>
<a class="sourceLine" id="cb453-45" title="45">logp <span class="op">=</span> Chem.Crippen.MolLogP(m)</a>
<a class="sourceLine" id="cb453-46" title="46"></a>
<a class="sourceLine" id="cb453-47" title="47"><span class="cf">if</span> hbd <span class="op">&lt;</span> <span class="dv">5</span> <span class="kw">and</span> hba <span class="op">&lt;</span> <span class="dv">10</span> <span class="kw">and</span> wt <span class="op">&lt;</span> <span class="dv">500</span> <span class="kw">and</span> logp <span class="op">&lt;</span> <span class="dv">5</span>:</a>
<a class="sourceLine" id="cb453-48" title="48">    passed <span class="op">=</span> <span class="va">True</span></a>
<a class="sourceLine" id="cb453-49" title="49"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb453-50" title="50">    passed <span class="op">=</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb453-51" title="51"></a>
<a class="sourceLine" id="cb453-52" title="52">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> lipinski_rule_of_five(smiles) <span class="op">==</span> passed <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-41">Run 1</h4>
<div class="sourceCode" id="cb455"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb455-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb455-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb455-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb455-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb455-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb455-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb455-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb455-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb455-9" title="9"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb455-10" title="10"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb455-11" title="11"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb455-12" title="12"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb455-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb455-14" title="14"></a>
<a class="sourceLine" id="cb455-15" title="15"><span class="kw">def</span> lipinski_rule_of_five(smiles):</a>
<a class="sourceLine" id="cb455-16" title="16">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb455-17" title="17"><span class="co">    This function calculates the Lipinski descriptors of the given SMILES string and returns a boolean to indicate if Lipinski&#39;s rule of five was satisfied.</span></a>
<a class="sourceLine" id="cb455-18" title="18"></a>
<a class="sourceLine" id="cb455-19" title="19"><span class="co">    Lipinski&#39;s rules are:</span></a>
<a class="sourceLine" id="cb455-20" title="20"><span class="co">    Hydrogen bond donors &lt;= 5</span></a>
<a class="sourceLine" id="cb455-21" title="21"><span class="co">    Hydrogen bond acceptors &lt;= 10</span></a>
<a class="sourceLine" id="cb455-22" title="22"><span class="co">    Molecular weight &lt; 500 daltons</span></a>
<a class="sourceLine" id="cb455-23" title="23"><span class="co">    logP &lt; 5</span></a>
<a class="sourceLine" id="cb455-24" title="24"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb455-25" title="25">    mol <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb455-26" title="26">    result <span class="op">=</span> <span class="va">True</span></a>
<a class="sourceLine" id="cb455-27" title="27">    <span class="cf">if</span> rdMolDescriptors.CalcNumHBD(mol) <span class="op">&gt;</span> <span class="dv">5</span>:</a>
<a class="sourceLine" id="cb455-28" title="28">        result <span class="op">=</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb455-29" title="29">    <span class="cf">if</span> rdMolDescriptors.CalcNumHBA(mol) <span class="op">&gt;</span> <span class="dv">10</span>:</a>
<a class="sourceLine" id="cb455-30" title="30">        result <span class="op">=</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb455-31" title="31">    <span class="cf">if</span> Descriptors.MolWt(mol) <span class="op">&gt;</span> <span class="dv">500</span>:</a>
<a class="sourceLine" id="cb455-32" title="32">        result <span class="op">=</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb455-33" title="33">    <span class="cf">if</span> Crippen.MolLogP(mol) <span class="op">&gt;</span> <span class="dv">5</span>:</a>
<a class="sourceLine" id="cb455-34" title="34">        result <span class="op">=</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb455-35" title="35"></a>
<a class="sourceLine" id="cb455-36" title="36">    <span class="cf">return</span> result</a>
<a class="sourceLine" id="cb455-37" title="37"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb455-38" title="38">smiles <span class="op">=</span> <span class="st">&#39;CC1=CN=C(C(=C1OC)C)CS(=O)C2=NC3=C(N2)C=C(C=C3)OC&#39;</span>  <span class="co"># omeprazole</span></a>
<a class="sourceLine" id="cb455-39" title="39">m <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb455-40" title="40">hbd <span class="op">=</span> Chem.rdMolDescriptors.CalcNumHBD(m)</a>
<a class="sourceLine" id="cb455-41" title="41">hba <span class="op">=</span> Chem.rdMolDescriptors.CalcNumHBA(m)</a>
<a class="sourceLine" id="cb455-42" title="42">wt <span class="op">=</span> Chem.rdMolDescriptors.CalcExactMolWt(m)</a>
<a class="sourceLine" id="cb455-43" title="43">logp <span class="op">=</span> Chem.Crippen.MolLogP(m)</a>
<a class="sourceLine" id="cb455-44" title="44"></a>
<a class="sourceLine" id="cb455-45" title="45"><span class="cf">if</span> hbd <span class="op">&lt;</span> <span class="dv">5</span> <span class="kw">and</span> hba <span class="op">&lt;</span> <span class="dv">10</span> <span class="kw">and</span> wt <span class="op">&lt;</span> <span class="dv">500</span> <span class="kw">and</span> logp <span class="op">&lt;</span> <span class="dv">5</span>:</a>
<a class="sourceLine" id="cb455-46" title="46">    passed <span class="op">=</span> <span class="va">True</span></a>
<a class="sourceLine" id="cb455-47" title="47"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb455-48" title="48">    passed <span class="op">=</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb455-49" title="49"></a>
<a class="sourceLine" id="cb455-50" title="50">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> lipinski_rule_of_five(smiles) <span class="op">==</span> passed <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-41">Run 2</h4>
<div class="sourceCode" id="cb457"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb457-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb457-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb457-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb457-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb457-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb457-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb457-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb457-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb457-9" title="9"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb457-10" title="10"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb457-11" title="11"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb457-12" title="12"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb457-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb457-14" title="14"></a>
<a class="sourceLine" id="cb457-15" title="15"><span class="kw">def</span> lipinski_rule_of_five(smiles):</a>
<a class="sourceLine" id="cb457-16" title="16">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb457-17" title="17"><span class="co">    This function calculates the Lipinski descriptors of the given SMILES string and returns a boolean to indicate if Lipinski&#39;s rule of five was satisfied.</span></a>
<a class="sourceLine" id="cb457-18" title="18"></a>
<a class="sourceLine" id="cb457-19" title="19"><span class="co">    Lipinski&#39;s rules are:</span></a>
<a class="sourceLine" id="cb457-20" title="20"><span class="co">    Hydrogen bond donors &lt;= 5</span></a>
<a class="sourceLine" id="cb457-21" title="21"><span class="co">    Hydrogen bond acceptors &lt;= 10</span></a>
<a class="sourceLine" id="cb457-22" title="22"><span class="co">    Molecular weight &lt; 500 daltons</span></a>
<a class="sourceLine" id="cb457-23" title="23"><span class="co">    logP &lt; 5</span></a>
<a class="sourceLine" id="cb457-24" title="24"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb457-25" title="25">    mol <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb457-26" title="26">    <span class="cf">if</span> mol <span class="kw">is</span> <span class="va">None</span>:</a>
<a class="sourceLine" id="cb457-27" title="27">        <span class="cf">return</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb457-28" title="28">    result <span class="op">=</span> <span class="va">True</span></a>
<a class="sourceLine" id="cb457-29" title="29">    <span class="cf">if</span> rdMolDescriptors.CalcNumHBD(mol) <span class="op">&gt;</span> <span class="dv">5</span>:</a>
<a class="sourceLine" id="cb457-30" title="30">        result <span class="op">=</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb457-31" title="31">    <span class="cf">if</span> rdMolDescriptors.CalcNumHBA(mol) <span class="op">&gt;</span> <span class="dv">10</span>:</a>
<a class="sourceLine" id="cb457-32" title="32">        result <span class="op">=</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb457-33" title="33">    <span class="cf">if</span> Descriptors.MolWt(mol) <span class="op">&gt;</span> <span class="dv">500</span>:</a>
<a class="sourceLine" id="cb457-34" title="34">        result <span class="op">=</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb457-35" title="35">    <span class="cf">if</span> Crippen.MolLogP(mol) <span class="op">&gt;</span> <span class="dv">5</span>:</a>
<a class="sourceLine" id="cb457-36" title="36">        result <span class="op">=</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb457-37" title="37">    <span class="cf">return</span> result</a>
<a class="sourceLine" id="cb457-38" title="38"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb457-39" title="39">smiles <span class="op">=</span> <span class="st">&#39;CC1=CN=C(C(=C1OC)C)CS(=O)C2=NC3=C(N2)C=C(C=C3)OC&#39;</span>  <span class="co"># omeprazole</span></a>
<a class="sourceLine" id="cb457-40" title="40">m <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb457-41" title="41">hbd <span class="op">=</span> Chem.rdMolDescriptors.CalcNumHBD(m)</a>
<a class="sourceLine" id="cb457-42" title="42">hba <span class="op">=</span> Chem.rdMolDescriptors.CalcNumHBA(m)</a>
<a class="sourceLine" id="cb457-43" title="43">wt <span class="op">=</span> Chem.rdMolDescriptors.CalcExactMolWt(m)</a>
<a class="sourceLine" id="cb457-44" title="44">logp <span class="op">=</span> Chem.Crippen.MolLogP(m)</a>
<a class="sourceLine" id="cb457-45" title="45"></a>
<a class="sourceLine" id="cb457-46" title="46"><span class="cf">if</span> hbd <span class="op">&lt;</span> <span class="dv">5</span> <span class="kw">and</span> hba <span class="op">&lt;</span> <span class="dv">10</span> <span class="kw">and</span> wt <span class="op">&lt;</span> <span class="dv">500</span> <span class="kw">and</span> logp <span class="op">&lt;</span> <span class="dv">5</span>:</a>
<a class="sourceLine" id="cb457-47" title="47">    passed <span class="op">=</span> <span class="va">True</span></a>
<a class="sourceLine" id="cb457-48" title="48"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb457-49" title="49">    passed <span class="op">=</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb457-50" title="50"></a>
<a class="sourceLine" id="cb457-51" title="51">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> lipinski_rule_of_five(smiles) <span class="op">==</span> passed <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-41">Run 3</h4>
<div class="sourceCode" id="cb459"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb459-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb459-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb459-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb459-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb459-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb459-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb459-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb459-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb459-9" title="9"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb459-10" title="10"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb459-11" title="11"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb459-12" title="12"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb459-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb459-14" title="14"></a>
<a class="sourceLine" id="cb459-15" title="15"><span class="kw">def</span> lipinski_rule_of_five(smiles):</a>
<a class="sourceLine" id="cb459-16" title="16">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb459-17" title="17"><span class="co">    This function calculates the Lipinski descriptors of the given SMILES string and returns a boolean to indicate if Lipinski&#39;s rule of five was satisfied.</span></a>
<a class="sourceLine" id="cb459-18" title="18"></a>
<a class="sourceLine" id="cb459-19" title="19"><span class="co">    Lipinski&#39;s rules are:</span></a>
<a class="sourceLine" id="cb459-20" title="20"><span class="co">    Hydrogen bond donors &lt;= 5</span></a>
<a class="sourceLine" id="cb459-21" title="21"><span class="co">    Hydrogen bond acceptors &lt;= 10</span></a>
<a class="sourceLine" id="cb459-22" title="22"><span class="co">    Molecular weight &lt; 500 daltons</span></a>
<a class="sourceLine" id="cb459-23" title="23"><span class="co">    logP &lt; 5</span></a>
<a class="sourceLine" id="cb459-24" title="24"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb459-25" title="25">    mol <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb459-26" title="26">    result <span class="op">=</span> <span class="va">True</span></a>
<a class="sourceLine" id="cb459-27" title="27">    <span class="cf">if</span> rdMolDescriptors.CalcNumHBD(mol) <span class="op">&gt;</span> <span class="dv">5</span>:</a>
<a class="sourceLine" id="cb459-28" title="28">        result <span class="op">=</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb459-29" title="29">    <span class="cf">if</span> rdMolDescriptors.CalcNumHBA(mol) <span class="op">&gt;</span> <span class="dv">10</span>:</a>
<a class="sourceLine" id="cb459-30" title="30">        result <span class="op">=</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb459-31" title="31">    <span class="cf">if</span> Descriptors.MolWt(mol) <span class="op">&gt;</span> <span class="dv">500</span>:</a>
<a class="sourceLine" id="cb459-32" title="32">        result <span class="op">=</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb459-33" title="33">    <span class="cf">if</span> Crippen.MolLogP(mol) <span class="op">&gt;</span> <span class="dv">5</span>:</a>
<a class="sourceLine" id="cb459-34" title="34">        result <span class="op">=</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb459-35" title="35"></a>
<a class="sourceLine" id="cb459-36" title="36">    <span class="cf">return</span> result</a>
<a class="sourceLine" id="cb459-37" title="37"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb459-38" title="38">smiles <span class="op">=</span> <span class="st">&#39;CC1=CN=C(C(=C1OC)C)CS(=O)C2=NC3=C(N2)C=C(C=C3)OC&#39;</span>  <span class="co"># omeprazole</span></a>
<a class="sourceLine" id="cb459-39" title="39">m <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb459-40" title="40">hbd <span class="op">=</span> Chem.rdMolDescriptors.CalcNumHBD(m)</a>
<a class="sourceLine" id="cb459-41" title="41">hba <span class="op">=</span> Chem.rdMolDescriptors.CalcNumHBA(m)</a>
<a class="sourceLine" id="cb459-42" title="42">wt <span class="op">=</span> Chem.rdMolDescriptors.CalcExactMolWt(m)</a>
<a class="sourceLine" id="cb459-43" title="43">logp <span class="op">=</span> Chem.Crippen.MolLogP(m)</a>
<a class="sourceLine" id="cb459-44" title="44"></a>
<a class="sourceLine" id="cb459-45" title="45"><span class="cf">if</span> hbd <span class="op">&lt;</span> <span class="dv">5</span> <span class="kw">and</span> hba <span class="op">&lt;</span> <span class="dv">10</span> <span class="kw">and</span> wt <span class="op">&lt;</span> <span class="dv">500</span> <span class="kw">and</span> logp <span class="op">&lt;</span> <span class="dv">5</span>:</a>
<a class="sourceLine" id="cb459-46" title="46">    passed <span class="op">=</span> <span class="va">True</span></a>
<a class="sourceLine" id="cb459-47" title="47"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb459-48" title="48">    passed <span class="op">=</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb459-49" title="49"></a>
<a class="sourceLine" id="cb459-50" title="50">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> lipinski_rule_of_five(smiles) <span class="op">==</span> passed <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-41">Run 4</h4>
<div class="sourceCode" id="cb461"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb461-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb461-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb461-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb461-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb461-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb461-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb461-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb461-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb461-9" title="9"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb461-10" title="10"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb461-11" title="11"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb461-12" title="12"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb461-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb461-14" title="14"></a>
<a class="sourceLine" id="cb461-15" title="15"><span class="kw">def</span> lipinski_rule_of_five(smiles):</a>
<a class="sourceLine" id="cb461-16" title="16">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb461-17" title="17"><span class="co">    This function calculates the Lipinski descriptors of the given SMILES string and returns a boolean to indicate if Lipinski&#39;s rule of five was satisfied.</span></a>
<a class="sourceLine" id="cb461-18" title="18"></a>
<a class="sourceLine" id="cb461-19" title="19"><span class="co">    Lipinski&#39;s rules are:</span></a>
<a class="sourceLine" id="cb461-20" title="20"><span class="co">    Hydrogen bond donors &lt;= 5</span></a>
<a class="sourceLine" id="cb461-21" title="21"><span class="co">    Hydrogen bond acceptors &lt;= 10</span></a>
<a class="sourceLine" id="cb461-22" title="22"><span class="co">    Molecular weight &lt; 500 daltons</span></a>
<a class="sourceLine" id="cb461-23" title="23"><span class="co">    logP &lt; 5</span></a>
<a class="sourceLine" id="cb461-24" title="24"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb461-25" title="25">    mol <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb461-26" title="26">    hbd <span class="op">=</span> rdMolDescriptors.CalcNumHBD(mol)</a>
<a class="sourceLine" id="cb461-27" title="27">    hba <span class="op">=</span> rdMolDescriptors.CalcNumHBA(mol)</a>
<a class="sourceLine" id="cb461-28" title="28">    mw <span class="op">=</span> Descriptors.MolWt(mol)</a>
<a class="sourceLine" id="cb461-29" title="29">    logp <span class="op">=</span> Crippen.MolLogP(mol)</a>
<a class="sourceLine" id="cb461-30" title="30">    result <span class="op">=</span> <span class="va">True</span></a>
<a class="sourceLine" id="cb461-31" title="31">    <span class="cf">if</span> hbd <span class="op">&gt;</span> <span class="dv">5</span>:</a>
<a class="sourceLine" id="cb461-32" title="32">        result <span class="op">=</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb461-33" title="33">    <span class="cf">if</span> hba <span class="op">&gt;</span> <span class="dv">10</span>:</a>
<a class="sourceLine" id="cb461-34" title="34">        result <span class="op">=</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb461-35" title="35">    <span class="cf">if</span> mw <span class="op">&gt;</span> <span class="dv">500</span>:</a>
<a class="sourceLine" id="cb461-36" title="36">        result <span class="op">=</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb461-37" title="37">    <span class="cf">if</span> logp <span class="op">&gt;</span> <span class="dv">5</span>:</a>
<a class="sourceLine" id="cb461-38" title="38">        result <span class="op">=</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb461-39" title="39">    <span class="cf">return</span> result</a>
<a class="sourceLine" id="cb461-40" title="40"></a>
<a class="sourceLine" id="cb461-41" title="41"></a>
<a class="sourceLine" id="cb461-42" title="42">    <span class="cf">return</span> result</a>
<a class="sourceLine" id="cb461-43" title="43"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb461-44" title="44">smiles <span class="op">=</span> <span class="st">&#39;CC1=CN=C(C(=C1OC)C)CS(=O)C2=NC3=C(N2)C=C(C=C3)OC&#39;</span>  <span class="co"># omeprazole</span></a>
<a class="sourceLine" id="cb461-45" title="45">m <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb461-46" title="46">hbd <span class="op">=</span> Chem.rdMolDescriptors.CalcNumHBD(m)</a>
<a class="sourceLine" id="cb461-47" title="47">hba <span class="op">=</span> Chem.rdMolDescriptors.CalcNumHBA(m)</a>
<a class="sourceLine" id="cb461-48" title="48">wt <span class="op">=</span> Chem.rdMolDescriptors.CalcExactMolWt(m)</a>
<a class="sourceLine" id="cb461-49" title="49">logp <span class="op">=</span> Chem.Crippen.MolLogP(m)</a>
<a class="sourceLine" id="cb461-50" title="50"></a>
<a class="sourceLine" id="cb461-51" title="51"><span class="cf">if</span> hbd <span class="op">&lt;</span> <span class="dv">5</span> <span class="kw">and</span> hba <span class="op">&lt;</span> <span class="dv">10</span> <span class="kw">and</span> wt <span class="op">&lt;</span> <span class="dv">500</span> <span class="kw">and</span> logp <span class="op">&lt;</span> <span class="dv">5</span>:</a>
<a class="sourceLine" id="cb461-52" title="52">    passed <span class="op">=</span> <span class="va">True</span></a>
<a class="sourceLine" id="cb461-53" title="53"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb461-54" title="54">    passed <span class="op">=</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb461-55" title="55"></a>
<a class="sourceLine" id="cb461-56" title="56">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> lipinski_rule_of_five(smiles) <span class="op">==</span> passed <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>mape</summary></p>
<h4 id="query-42">Query</h4>
<div class="sourceCode" id="cb463"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb463-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb463-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb463-3" title="3"></a>
<a class="sourceLine" id="cb463-4" title="4"><span class="kw">def</span> mape(y_hat,y):</a>
<a class="sourceLine" id="cb463-5" title="5">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb463-6" title="6"><span class="co">  This function computes the mean absolute percentage error (mape) between y_hat and y.</span></a>
<a class="sourceLine" id="cb463-7" title="7"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb463-8" title="8">  [insert]</a>
<a class="sourceLine" id="cb463-9" title="9">  <span class="cf">return</span> e</a></code></pre></div>
<h4 id="run-0-42">Run 0</h4>
<div class="sourceCode" id="cb464"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb464-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb464-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb464-3" title="3"></a>
<a class="sourceLine" id="cb464-4" title="4"><span class="kw">def</span> mape(y_hat,y):</a>
<a class="sourceLine" id="cb464-5" title="5">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb464-6" title="6"><span class="co">  This function computes the mean absolute percentage error (mape) between y_hat and y.</span></a>
<a class="sourceLine" id="cb464-7" title="7"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb464-8" title="8">  e <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb464-9" title="9">  <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(y)):</a>
<a class="sourceLine" id="cb464-10" title="10">    e <span class="op">+=</span> <span class="bu">abs</span>(y_hat[i]<span class="op">-</span>y[i])<span class="op">/</span>y[i]</a>
<a class="sourceLine" id="cb464-11" title="11">  e <span class="op">=</span> e<span class="op">/</span><span class="bu">len</span>(y)</a>
<a class="sourceLine" id="cb464-12" title="12">  <span class="cf">return</span> e</a>
<a class="sourceLine" id="cb464-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb464-14" title="14"></a>
<a class="sourceLine" id="cb464-15" title="15">np.random.seed(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb464-16" title="16">M<span class="op">=</span><span class="dv">100</span></a>
<a class="sourceLine" id="cb464-17" title="17">y_hat <span class="op">=</span> np.random.normal(loc<span class="op">=</span><span class="dv">10</span>,scale<span class="op">=</span><span class="dv">3</span>,size<span class="op">=</span>(M,))</a>
<a class="sourceLine" id="cb464-18" title="18">y <span class="op">=</span> np.random.normal(loc<span class="op">=</span><span class="dv">9</span>, scale<span class="op">=</span><span class="dv">2</span>, size<span class="op">=</span>(M,))</a>
<a class="sourceLine" id="cb464-19" title="19"></a>
<a class="sourceLine" id="cb464-20" title="20">test_mape <span class="op">=</span> <span class="bu">abs</span>((y <span class="op">-</span> y_hat)<span class="op">*</span><span class="dv">100</span><span class="op">/</span> y).mean()</a>
<a class="sourceLine" id="cb464-21" title="21">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(mape(y_hat,y),test_mape) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-42">Run 1</h4>
<div class="sourceCode" id="cb466"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb466-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb466-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb466-3" title="3"></a>
<a class="sourceLine" id="cb466-4" title="4"><span class="kw">def</span> mape(y_hat,y):</a>
<a class="sourceLine" id="cb466-5" title="5">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb466-6" title="6"><span class="co">  This function computes the mean absolute percentage error (mape) between y_hat and y.</span></a>
<a class="sourceLine" id="cb466-7" title="7"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb466-8" title="8">  e <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb466-9" title="9">  <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(y)):</a>
<a class="sourceLine" id="cb466-10" title="10">    e <span class="op">+=</span> math.fabs(y_hat[i] <span class="op">-</span> y[i]) <span class="op">/</span> y[i]</a>
<a class="sourceLine" id="cb466-11" title="11">  e <span class="op">/=</span> <span class="bu">len</span>(y)</a>
<a class="sourceLine" id="cb466-12" title="12">  <span class="cf">return</span> e</a>
<a class="sourceLine" id="cb466-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb466-14" title="14"></a>
<a class="sourceLine" id="cb466-15" title="15">np.random.seed(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb466-16" title="16">M<span class="op">=</span><span class="dv">100</span></a>
<a class="sourceLine" id="cb466-17" title="17">y_hat <span class="op">=</span> np.random.normal(loc<span class="op">=</span><span class="dv">10</span>,scale<span class="op">=</span><span class="dv">3</span>,size<span class="op">=</span>(M,))</a>
<a class="sourceLine" id="cb466-18" title="18">y <span class="op">=</span> np.random.normal(loc<span class="op">=</span><span class="dv">9</span>, scale<span class="op">=</span><span class="dv">2</span>, size<span class="op">=</span>(M,))</a>
<a class="sourceLine" id="cb466-19" title="19"></a>
<a class="sourceLine" id="cb466-20" title="20">test_mape <span class="op">=</span> <span class="bu">abs</span>((y <span class="op">-</span> y_hat)<span class="op">*</span><span class="dv">100</span><span class="op">/</span> y).mean()</a>
<a class="sourceLine" id="cb466-21" title="21">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(mape(y_hat,y),test_mape) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-42">Run 2</h4>
<div class="sourceCode" id="cb468"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb468-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb468-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb468-3" title="3"></a>
<a class="sourceLine" id="cb468-4" title="4"><span class="kw">def</span> mape(y_hat,y):</a>
<a class="sourceLine" id="cb468-5" title="5">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb468-6" title="6"><span class="co">  This function computes the mean absolute percentage error (mape) between y_hat and y.</span></a>
<a class="sourceLine" id="cb468-7" title="7"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb468-8" title="8">  e <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb468-9" title="9">  <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(y)):</a>
<a class="sourceLine" id="cb468-10" title="10">    e <span class="op">+=</span> <span class="bu">abs</span>(y_hat[i] <span class="op">-</span> y[i]) <span class="op">/</span> y[i]</a>
<a class="sourceLine" id="cb468-11" title="11">  e <span class="op">/=</span> <span class="bu">len</span>(y)</a>
<a class="sourceLine" id="cb468-12" title="12">  <span class="cf">return</span> e</a>
<a class="sourceLine" id="cb468-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb468-14" title="14"></a>
<a class="sourceLine" id="cb468-15" title="15">np.random.seed(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb468-16" title="16">M<span class="op">=</span><span class="dv">100</span></a>
<a class="sourceLine" id="cb468-17" title="17">y_hat <span class="op">=</span> np.random.normal(loc<span class="op">=</span><span class="dv">10</span>,scale<span class="op">=</span><span class="dv">3</span>,size<span class="op">=</span>(M,))</a>
<a class="sourceLine" id="cb468-18" title="18">y <span class="op">=</span> np.random.normal(loc<span class="op">=</span><span class="dv">9</span>, scale<span class="op">=</span><span class="dv">2</span>, size<span class="op">=</span>(M,))</a>
<a class="sourceLine" id="cb468-19" title="19"></a>
<a class="sourceLine" id="cb468-20" title="20">test_mape <span class="op">=</span> <span class="bu">abs</span>((y <span class="op">-</span> y_hat)<span class="op">*</span><span class="dv">100</span><span class="op">/</span> y).mean()</a>
<a class="sourceLine" id="cb468-21" title="21">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(mape(y_hat,y),test_mape) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-42">Run 3</h4>
<div class="sourceCode" id="cb470"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb470-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb470-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb470-3" title="3"></a>
<a class="sourceLine" id="cb470-4" title="4"><span class="kw">def</span> mape(y_hat,y):</a>
<a class="sourceLine" id="cb470-5" title="5">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb470-6" title="6"><span class="co">  This function computes the mean absolute percentage error (mape) between y_hat and y.</span></a>
<a class="sourceLine" id="cb470-7" title="7"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb470-8" title="8">  e <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb470-9" title="9">  <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(y)):</a>
<a class="sourceLine" id="cb470-10" title="10">    e <span class="op">+=</span> <span class="bu">abs</span>(y_hat[i]<span class="op">-</span>y[i])<span class="op">/</span>y[i]</a>
<a class="sourceLine" id="cb470-11" title="11">  e <span class="op">=</span> e<span class="op">/</span><span class="bu">len</span>(y)</a>
<a class="sourceLine" id="cb470-12" title="12">  <span class="cf">return</span> e</a>
<a class="sourceLine" id="cb470-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb470-14" title="14"></a>
<a class="sourceLine" id="cb470-15" title="15">np.random.seed(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb470-16" title="16">M<span class="op">=</span><span class="dv">100</span></a>
<a class="sourceLine" id="cb470-17" title="17">y_hat <span class="op">=</span> np.random.normal(loc<span class="op">=</span><span class="dv">10</span>,scale<span class="op">=</span><span class="dv">3</span>,size<span class="op">=</span>(M,))</a>
<a class="sourceLine" id="cb470-18" title="18">y <span class="op">=</span> np.random.normal(loc<span class="op">=</span><span class="dv">9</span>, scale<span class="op">=</span><span class="dv">2</span>, size<span class="op">=</span>(M,))</a>
<a class="sourceLine" id="cb470-19" title="19"></a>
<a class="sourceLine" id="cb470-20" title="20">test_mape <span class="op">=</span> <span class="bu">abs</span>((y <span class="op">-</span> y_hat)<span class="op">*</span><span class="dv">100</span><span class="op">/</span> y).mean()</a>
<a class="sourceLine" id="cb470-21" title="21">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(mape(y_hat,y),test_mape) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-42">Run 4</h4>
<div class="sourceCode" id="cb472"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb472-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb472-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb472-3" title="3"></a>
<a class="sourceLine" id="cb472-4" title="4"><span class="kw">def</span> mape(y_hat,y):</a>
<a class="sourceLine" id="cb472-5" title="5">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb472-6" title="6"><span class="co">  This function computes the mean absolute percentage error (mape) between y_hat and y.</span></a>
<a class="sourceLine" id="cb472-7" title="7"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb472-8" title="8">  e <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb472-9" title="9">  <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(y)):</a>
<a class="sourceLine" id="cb472-10" title="10">    e <span class="op">+=</span> <span class="bu">abs</span>(y_hat[i]<span class="op">-</span>y[i])<span class="op">/</span>y[i]</a>
<a class="sourceLine" id="cb472-11" title="11">  e <span class="op">=</span> e<span class="op">/</span><span class="bu">len</span>(y)</a>
<a class="sourceLine" id="cb472-12" title="12">  <span class="cf">return</span> e</a>
<a class="sourceLine" id="cb472-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb472-14" title="14"></a>
<a class="sourceLine" id="cb472-15" title="15">np.random.seed(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb472-16" title="16">M<span class="op">=</span><span class="dv">100</span></a>
<a class="sourceLine" id="cb472-17" title="17">y_hat <span class="op">=</span> np.random.normal(loc<span class="op">=</span><span class="dv">10</span>,scale<span class="op">=</span><span class="dv">3</span>,size<span class="op">=</span>(M,))</a>
<a class="sourceLine" id="cb472-18" title="18">y <span class="op">=</span> np.random.normal(loc<span class="op">=</span><span class="dv">9</span>, scale<span class="op">=</span><span class="dv">2</span>, size<span class="op">=</span>(M,))</a>
<a class="sourceLine" id="cb472-19" title="19"></a>
<a class="sourceLine" id="cb472-20" title="20">test_mape <span class="op">=</span> <span class="bu">abs</span>((y <span class="op">-</span> y_hat)<span class="op">*</span><span class="dv">100</span><span class="op">/</span> y).mean()</a>
<a class="sourceLine" id="cb472-21" title="21">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(mape(y_hat,y),test_mape) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>mapping_operator</summary></p>
<h4 id="query-43">Query</h4>
<div class="sourceCode" id="cb474"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb474-1" title="1"><span class="im">import</span> MDAnalysis</a>
<a class="sourceLine" id="cb474-2" title="2"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb474-3" title="3"></a>
<a class="sourceLine" id="cb474-4" title="4"><span class="kw">def</span> mapping_operator(molecule, beads_mappings):</a>
<a class="sourceLine" id="cb474-5" title="5">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb474-6" title="6"><span class="co">  This function generates a mass-mass weighted mapping matrix given an MD analysis molecule</span></a>
<a class="sourceLine" id="cb474-7" title="7"><span class="co">  and atom selections for the beads.</span></a>
<a class="sourceLine" id="cb474-8" title="8"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb474-9" title="9">  [insert]</a>
<a class="sourceLine" id="cb474-10" title="10">  <span class="cf">return</span> M</a></code></pre></div>
<h4 id="run-0-43">Run 0</h4>
<div class="sourceCode" id="cb475"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb475-1" title="1"><span class="im">import</span> MDAnalysis</a>
<a class="sourceLine" id="cb475-2" title="2"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb475-3" title="3"></a>
<a class="sourceLine" id="cb475-4" title="4"><span class="kw">def</span> mapping_operator(molecule, beads_mappings):</a>
<a class="sourceLine" id="cb475-5" title="5">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb475-6" title="6"><span class="co">  This function generates a mass-mass weighted mapping matrix given an MD analysis molecule</span></a>
<a class="sourceLine" id="cb475-7" title="7"><span class="co">  and atom selections for the beads.</span></a>
<a class="sourceLine" id="cb475-8" title="8"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb475-9" title="9">  M <span class="op">=</span> np.zeros((<span class="bu">len</span>(beads_mappings), molecule.n_atoms))</a>
<a class="sourceLine" id="cb475-10" title="10">  <span class="cf">for</span> i, bead <span class="kw">in</span> <span class="bu">enumerate</span>(beads_mappings):</a>
<a class="sourceLine" id="cb475-11" title="11">    M[i, bead.indices] <span class="op">=</span> bead.masses <span class="op">/</span> bead.masses.<span class="bu">sum</span>()</a>
<a class="sourceLine" id="cb475-12" title="12">  <span class="cf">return</span> M</a>
<a class="sourceLine" id="cb475-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb475-14" title="14"><span class="im">import</span> MDAnalysis <span class="im">as</span> mda</a>
<a class="sourceLine" id="cb475-15" title="15"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb475-16" title="16"></a>
<a class="sourceLine" id="cb475-17" title="17"><span class="co"># read molecule</span></a>
<a class="sourceLine" id="cb475-18" title="18">u <span class="op">=</span> mda.Universe(os.path.join(_FILE_DIR_, <span class="st">&#39;water.gro&#39;</span>))</a>
<a class="sourceLine" id="cb475-19" title="19">molecule <span class="op">=</span> u.atoms</a>
<a class="sourceLine" id="cb475-20" title="20"><span class="co"># define atoms that belong to the a single bead</span></a>
<a class="sourceLine" id="cb475-21" title="21">beads_mappings <span class="op">=</span> [[<span class="st">&#39;OW&#39;</span>, <span class="st">&#39;HW1&#39;</span>, <span class="st">&#39;HW2&#39;</span>]]</a>
<a class="sourceLine" id="cb475-22" title="22">Mws_dict <span class="op">=</span> <span class="bu">dict</span>(<span class="bu">zip</span>(molecule.names, molecule.masses))</a>
<a class="sourceLine" id="cb475-23" title="23">M, N <span class="op">=</span> <span class="bu">len</span>(beads_mappings), <span class="bu">len</span>(molecule)</a>
<a class="sourceLine" id="cb475-24" title="24">CG_matrix <span class="op">=</span> np.zeros((M, N))</a>
<a class="sourceLine" id="cb475-25" title="25">index <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb475-26" title="26"><span class="cf">for</span> s <span class="kw">in</span> <span class="bu">range</span>(M):</a>
<a class="sourceLine" id="cb475-27" title="27">    <span class="cf">for</span> i, atom <span class="kw">in</span> <span class="bu">enumerate</span>(beads_mappings[s]):</a>
<a class="sourceLine" id="cb475-28" title="28">        CG_matrix[s, i <span class="op">+</span> index] <span class="op">=</span> [v <span class="cf">for</span> k,</a>
<a class="sourceLine" id="cb475-29" title="29">                                   v <span class="kw">in</span> Mws_dict.items() <span class="cf">if</span> atom <span class="kw">in</span> k][<span class="dv">0</span>]</a>
<a class="sourceLine" id="cb475-30" title="30">    index <span class="op">+=</span> np.count_nonzero(CG_matrix[s])</a>
<a class="sourceLine" id="cb475-31" title="31">    CG_matrix[s] <span class="op">=</span> CG_matrix[s] <span class="op">/</span> np.<span class="bu">sum</span>(CG_matrix[s])</a>
<a class="sourceLine" id="cb475-32" title="32"></a>
<a class="sourceLine" id="cb475-33" title="33">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(</a>
<a class="sourceLine" id="cb475-34" title="34">    CG_matrix, mapping_operator(molecule, beads_mappings)).<span class="bu">all</span>() <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>&#39;list&#39; object has no attribute &#39;masses&#39;</code></pre>
<h4 id="run-1-43">Run 1</h4>
<div class="sourceCode" id="cb477"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb477-1" title="1"><span class="im">import</span> MDAnalysis</a>
<a class="sourceLine" id="cb477-2" title="2"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb477-3" title="3"></a>
<a class="sourceLine" id="cb477-4" title="4"><span class="kw">def</span> mapping_operator(molecule, beads_mappings):</a>
<a class="sourceLine" id="cb477-5" title="5">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb477-6" title="6"><span class="co">  This function generates a mass-mass weighted mapping matrix given an MD analysis molecule</span></a>
<a class="sourceLine" id="cb477-7" title="7"><span class="co">  and atom selections for the beads.</span></a>
<a class="sourceLine" id="cb477-8" title="8"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb477-9" title="9">  M <span class="op">=</span> np.zeros((<span class="bu">len</span>(beads_mappings), molecule.n_atoms))</a>
<a class="sourceLine" id="cb477-10" title="10">  <span class="cf">for</span> i, bead <span class="kw">in</span> <span class="bu">enumerate</span>(beads_mappings):</a>
<a class="sourceLine" id="cb477-11" title="11">    M[i, bead.indices] <span class="op">=</span> bead.masses <span class="op">/</span> bead.masses.<span class="bu">sum</span>()</a>
<a class="sourceLine" id="cb477-12" title="12">  <span class="cf">return</span> M</a>
<a class="sourceLine" id="cb477-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb477-14" title="14"><span class="im">import</span> MDAnalysis <span class="im">as</span> mda</a>
<a class="sourceLine" id="cb477-15" title="15"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb477-16" title="16"></a>
<a class="sourceLine" id="cb477-17" title="17"><span class="co"># read molecule</span></a>
<a class="sourceLine" id="cb477-18" title="18">u <span class="op">=</span> mda.Universe(os.path.join(_FILE_DIR_, <span class="st">&#39;water.gro&#39;</span>))</a>
<a class="sourceLine" id="cb477-19" title="19">molecule <span class="op">=</span> u.atoms</a>
<a class="sourceLine" id="cb477-20" title="20"><span class="co"># define atoms that belong to the a single bead</span></a>
<a class="sourceLine" id="cb477-21" title="21">beads_mappings <span class="op">=</span> [[<span class="st">&#39;OW&#39;</span>, <span class="st">&#39;HW1&#39;</span>, <span class="st">&#39;HW2&#39;</span>]]</a>
<a class="sourceLine" id="cb477-22" title="22">Mws_dict <span class="op">=</span> <span class="bu">dict</span>(<span class="bu">zip</span>(molecule.names, molecule.masses))</a>
<a class="sourceLine" id="cb477-23" title="23">M, N <span class="op">=</span> <span class="bu">len</span>(beads_mappings), <span class="bu">len</span>(molecule)</a>
<a class="sourceLine" id="cb477-24" title="24">CG_matrix <span class="op">=</span> np.zeros((M, N))</a>
<a class="sourceLine" id="cb477-25" title="25">index <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb477-26" title="26"><span class="cf">for</span> s <span class="kw">in</span> <span class="bu">range</span>(M):</a>
<a class="sourceLine" id="cb477-27" title="27">    <span class="cf">for</span> i, atom <span class="kw">in</span> <span class="bu">enumerate</span>(beads_mappings[s]):</a>
<a class="sourceLine" id="cb477-28" title="28">        CG_matrix[s, i <span class="op">+</span> index] <span class="op">=</span> [v <span class="cf">for</span> k,</a>
<a class="sourceLine" id="cb477-29" title="29">                                   v <span class="kw">in</span> Mws_dict.items() <span class="cf">if</span> atom <span class="kw">in</span> k][<span class="dv">0</span>]</a>
<a class="sourceLine" id="cb477-30" title="30">    index <span class="op">+=</span> np.count_nonzero(CG_matrix[s])</a>
<a class="sourceLine" id="cb477-31" title="31">    CG_matrix[s] <span class="op">=</span> CG_matrix[s] <span class="op">/</span> np.<span class="bu">sum</span>(CG_matrix[s])</a>
<a class="sourceLine" id="cb477-32" title="32"></a>
<a class="sourceLine" id="cb477-33" title="33">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(</a>
<a class="sourceLine" id="cb477-34" title="34">    CG_matrix, mapping_operator(molecule, beads_mappings)).<span class="bu">all</span>() <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>&#39;list&#39; object has no attribute &#39;masses&#39;</code></pre>
<h4 id="run-2-43">Run 2</h4>
<div class="sourceCode" id="cb479"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb479-1" title="1"><span class="im">import</span> MDAnalysis</a>
<a class="sourceLine" id="cb479-2" title="2"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb479-3" title="3"></a>
<a class="sourceLine" id="cb479-4" title="4"><span class="kw">def</span> mapping_operator(molecule, beads_mappings):</a>
<a class="sourceLine" id="cb479-5" title="5">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb479-6" title="6"><span class="co">  This function generates a mass-mass weighted mapping matrix given an MD analysis molecule</span></a>
<a class="sourceLine" id="cb479-7" title="7"><span class="co">  and atom selections for the beads.</span></a>
<a class="sourceLine" id="cb479-8" title="8"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb479-9" title="9">  M <span class="op">=</span> np.zeros((<span class="bu">len</span>(beads_mappings), molecule.n_atoms))</a>
<a class="sourceLine" id="cb479-10" title="10">  <span class="cf">for</span> i, bead <span class="kw">in</span> <span class="bu">enumerate</span>(beads_mappings):</a>
<a class="sourceLine" id="cb479-11" title="11">    M[i, bead.indices] <span class="op">=</span> bead.masses <span class="op">/</span> bead.masses.<span class="bu">sum</span>()</a>
<a class="sourceLine" id="cb479-12" title="12"></a>
<a class="sourceLine" id="cb479-13" title="13">  <span class="cf">return</span> M</a>
<a class="sourceLine" id="cb479-14" title="14"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb479-15" title="15"><span class="im">import</span> MDAnalysis <span class="im">as</span> mda</a>
<a class="sourceLine" id="cb479-16" title="16"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb479-17" title="17"></a>
<a class="sourceLine" id="cb479-18" title="18"><span class="co"># read molecule</span></a>
<a class="sourceLine" id="cb479-19" title="19">u <span class="op">=</span> mda.Universe(os.path.join(_FILE_DIR_, <span class="st">&#39;water.gro&#39;</span>))</a>
<a class="sourceLine" id="cb479-20" title="20">molecule <span class="op">=</span> u.atoms</a>
<a class="sourceLine" id="cb479-21" title="21"><span class="co"># define atoms that belong to the a single bead</span></a>
<a class="sourceLine" id="cb479-22" title="22">beads_mappings <span class="op">=</span> [[<span class="st">&#39;OW&#39;</span>, <span class="st">&#39;HW1&#39;</span>, <span class="st">&#39;HW2&#39;</span>]]</a>
<a class="sourceLine" id="cb479-23" title="23">Mws_dict <span class="op">=</span> <span class="bu">dict</span>(<span class="bu">zip</span>(molecule.names, molecule.masses))</a>
<a class="sourceLine" id="cb479-24" title="24">M, N <span class="op">=</span> <span class="bu">len</span>(beads_mappings), <span class="bu">len</span>(molecule)</a>
<a class="sourceLine" id="cb479-25" title="25">CG_matrix <span class="op">=</span> np.zeros((M, N))</a>
<a class="sourceLine" id="cb479-26" title="26">index <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb479-27" title="27"><span class="cf">for</span> s <span class="kw">in</span> <span class="bu">range</span>(M):</a>
<a class="sourceLine" id="cb479-28" title="28">    <span class="cf">for</span> i, atom <span class="kw">in</span> <span class="bu">enumerate</span>(beads_mappings[s]):</a>
<a class="sourceLine" id="cb479-29" title="29">        CG_matrix[s, i <span class="op">+</span> index] <span class="op">=</span> [v <span class="cf">for</span> k,</a>
<a class="sourceLine" id="cb479-30" title="30">                                   v <span class="kw">in</span> Mws_dict.items() <span class="cf">if</span> atom <span class="kw">in</span> k][<span class="dv">0</span>]</a>
<a class="sourceLine" id="cb479-31" title="31">    index <span class="op">+=</span> np.count_nonzero(CG_matrix[s])</a>
<a class="sourceLine" id="cb479-32" title="32">    CG_matrix[s] <span class="op">=</span> CG_matrix[s] <span class="op">/</span> np.<span class="bu">sum</span>(CG_matrix[s])</a>
<a class="sourceLine" id="cb479-33" title="33"></a>
<a class="sourceLine" id="cb479-34" title="34">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(</a>
<a class="sourceLine" id="cb479-35" title="35">    CG_matrix, mapping_operator(molecule, beads_mappings)).<span class="bu">all</span>() <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>&#39;list&#39; object has no attribute &#39;masses&#39;</code></pre>
<h4 id="run-3-43">Run 3</h4>
<div class="sourceCode" id="cb481"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb481-1" title="1"><span class="im">import</span> MDAnalysis</a>
<a class="sourceLine" id="cb481-2" title="2"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb481-3" title="3"></a>
<a class="sourceLine" id="cb481-4" title="4"><span class="kw">def</span> mapping_operator(molecule, beads_mappings):</a>
<a class="sourceLine" id="cb481-5" title="5">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb481-6" title="6"><span class="co">  This function generates a mass-mass weighted mapping matrix given an MD analysis molecule</span></a>
<a class="sourceLine" id="cb481-7" title="7"><span class="co">  and atom selections for the beads.</span></a>
<a class="sourceLine" id="cb481-8" title="8"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb481-9" title="9">  M <span class="op">=</span> np.zeros((molecule.n_atoms, <span class="bu">len</span>(beads_mappings)))</a>
<a class="sourceLine" id="cb481-10" title="10">  <span class="cf">for</span> i, bead <span class="kw">in</span> <span class="bu">enumerate</span>(beads_mappings):</a>
<a class="sourceLine" id="cb481-11" title="11">    M[bead.indices, i] <span class="op">=</span> bead.masses <span class="op">/</span> bead.masses.<span class="bu">sum</span>()</a>
<a class="sourceLine" id="cb481-12" title="12">  <span class="cf">return</span> M</a>
<a class="sourceLine" id="cb481-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb481-14" title="14"><span class="im">import</span> MDAnalysis <span class="im">as</span> mda</a>
<a class="sourceLine" id="cb481-15" title="15"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb481-16" title="16"></a>
<a class="sourceLine" id="cb481-17" title="17"><span class="co"># read molecule</span></a>
<a class="sourceLine" id="cb481-18" title="18">u <span class="op">=</span> mda.Universe(os.path.join(_FILE_DIR_, <span class="st">&#39;water.gro&#39;</span>))</a>
<a class="sourceLine" id="cb481-19" title="19">molecule <span class="op">=</span> u.atoms</a>
<a class="sourceLine" id="cb481-20" title="20"><span class="co"># define atoms that belong to the a single bead</span></a>
<a class="sourceLine" id="cb481-21" title="21">beads_mappings <span class="op">=</span> [[<span class="st">&#39;OW&#39;</span>, <span class="st">&#39;HW1&#39;</span>, <span class="st">&#39;HW2&#39;</span>]]</a>
<a class="sourceLine" id="cb481-22" title="22">Mws_dict <span class="op">=</span> <span class="bu">dict</span>(<span class="bu">zip</span>(molecule.names, molecule.masses))</a>
<a class="sourceLine" id="cb481-23" title="23">M, N <span class="op">=</span> <span class="bu">len</span>(beads_mappings), <span class="bu">len</span>(molecule)</a>
<a class="sourceLine" id="cb481-24" title="24">CG_matrix <span class="op">=</span> np.zeros((M, N))</a>
<a class="sourceLine" id="cb481-25" title="25">index <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb481-26" title="26"><span class="cf">for</span> s <span class="kw">in</span> <span class="bu">range</span>(M):</a>
<a class="sourceLine" id="cb481-27" title="27">    <span class="cf">for</span> i, atom <span class="kw">in</span> <span class="bu">enumerate</span>(beads_mappings[s]):</a>
<a class="sourceLine" id="cb481-28" title="28">        CG_matrix[s, i <span class="op">+</span> index] <span class="op">=</span> [v <span class="cf">for</span> k,</a>
<a class="sourceLine" id="cb481-29" title="29">                                   v <span class="kw">in</span> Mws_dict.items() <span class="cf">if</span> atom <span class="kw">in</span> k][<span class="dv">0</span>]</a>
<a class="sourceLine" id="cb481-30" title="30">    index <span class="op">+=</span> np.count_nonzero(CG_matrix[s])</a>
<a class="sourceLine" id="cb481-31" title="31">    CG_matrix[s] <span class="op">=</span> CG_matrix[s] <span class="op">/</span> np.<span class="bu">sum</span>(CG_matrix[s])</a>
<a class="sourceLine" id="cb481-32" title="32"></a>
<a class="sourceLine" id="cb481-33" title="33">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(</a>
<a class="sourceLine" id="cb481-34" title="34">    CG_matrix, mapping_operator(molecule, beads_mappings)).<span class="bu">all</span>() <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>&#39;list&#39; object has no attribute &#39;masses&#39;</code></pre>
<h4 id="run-4-43">Run 4</h4>
<div class="sourceCode" id="cb483"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb483-1" title="1"><span class="im">import</span> MDAnalysis</a>
<a class="sourceLine" id="cb483-2" title="2"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb483-3" title="3"></a>
<a class="sourceLine" id="cb483-4" title="4"><span class="kw">def</span> mapping_operator(molecule, beads_mappings):</a>
<a class="sourceLine" id="cb483-5" title="5">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb483-6" title="6"><span class="co">  This function generates a mass-mass weighted mapping matrix given an MD analysis molecule</span></a>
<a class="sourceLine" id="cb483-7" title="7"><span class="co">  and atom selections for the beads.</span></a>
<a class="sourceLine" id="cb483-8" title="8"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb483-9" title="9">  M <span class="op">=</span> np.zeros((<span class="bu">len</span>(beads_mappings), molecule.n_atoms))</a>
<a class="sourceLine" id="cb483-10" title="10">  <span class="cf">for</span> i, bead <span class="kw">in</span> <span class="bu">enumerate</span>(beads_mappings):</a>
<a class="sourceLine" id="cb483-11" title="11">    M[i, bead.indices] <span class="op">=</span> bead.masses<span class="op">/</span>bead.masses.<span class="bu">sum</span>()</a>
<a class="sourceLine" id="cb483-12" title="12">  <span class="cf">return</span> M</a>
<a class="sourceLine" id="cb483-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb483-14" title="14"><span class="im">import</span> MDAnalysis <span class="im">as</span> mda</a>
<a class="sourceLine" id="cb483-15" title="15"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb483-16" title="16"></a>
<a class="sourceLine" id="cb483-17" title="17"><span class="co"># read molecule</span></a>
<a class="sourceLine" id="cb483-18" title="18">u <span class="op">=</span> mda.Universe(os.path.join(_FILE_DIR_, <span class="st">&#39;water.gro&#39;</span>))</a>
<a class="sourceLine" id="cb483-19" title="19">molecule <span class="op">=</span> u.atoms</a>
<a class="sourceLine" id="cb483-20" title="20"><span class="co"># define atoms that belong to the a single bead</span></a>
<a class="sourceLine" id="cb483-21" title="21">beads_mappings <span class="op">=</span> [[<span class="st">&#39;OW&#39;</span>, <span class="st">&#39;HW1&#39;</span>, <span class="st">&#39;HW2&#39;</span>]]</a>
<a class="sourceLine" id="cb483-22" title="22">Mws_dict <span class="op">=</span> <span class="bu">dict</span>(<span class="bu">zip</span>(molecule.names, molecule.masses))</a>
<a class="sourceLine" id="cb483-23" title="23">M, N <span class="op">=</span> <span class="bu">len</span>(beads_mappings), <span class="bu">len</span>(molecule)</a>
<a class="sourceLine" id="cb483-24" title="24">CG_matrix <span class="op">=</span> np.zeros((M, N))</a>
<a class="sourceLine" id="cb483-25" title="25">index <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb483-26" title="26"><span class="cf">for</span> s <span class="kw">in</span> <span class="bu">range</span>(M):</a>
<a class="sourceLine" id="cb483-27" title="27">    <span class="cf">for</span> i, atom <span class="kw">in</span> <span class="bu">enumerate</span>(beads_mappings[s]):</a>
<a class="sourceLine" id="cb483-28" title="28">        CG_matrix[s, i <span class="op">+</span> index] <span class="op">=</span> [v <span class="cf">for</span> k,</a>
<a class="sourceLine" id="cb483-29" title="29">                                   v <span class="kw">in</span> Mws_dict.items() <span class="cf">if</span> atom <span class="kw">in</span> k][<span class="dv">0</span>]</a>
<a class="sourceLine" id="cb483-30" title="30">    index <span class="op">+=</span> np.count_nonzero(CG_matrix[s])</a>
<a class="sourceLine" id="cb483-31" title="31">    CG_matrix[s] <span class="op">=</span> CG_matrix[s] <span class="op">/</span> np.<span class="bu">sum</span>(CG_matrix[s])</a>
<a class="sourceLine" id="cb483-32" title="32"></a>
<a class="sourceLine" id="cb483-33" title="33">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(</a>
<a class="sourceLine" id="cb483-34" title="34">    CG_matrix, mapping_operator(molecule, beads_mappings)).<span class="bu">all</span>() <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>&#39;list&#39; object has no attribute &#39;masses&#39;</code></pre>
</details>
<details>
<p><summary>matpow</summary></p>
<h4 id="query-44">Query</h4>
<div class="sourceCode" id="cb485"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb485-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb485-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb485-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb485-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb485-5" title="5"></a>
<a class="sourceLine" id="cb485-6" title="6"><span class="kw">def</span> matpow(x,n):</a>
<a class="sourceLine" id="cb485-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb485-8" title="8"><span class="co">  This function computes matrix x raised to the power n.</span></a>
<a class="sourceLine" id="cb485-9" title="9"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb485-10" title="10">  [insert]</a>
<a class="sourceLine" id="cb485-11" title="11">  <span class="cf">return</span> r</a></code></pre></div>
<h4 id="run-0-44">Run 0</h4>
<div class="sourceCode" id="cb486"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb486-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb486-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb486-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb486-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb486-5" title="5"></a>
<a class="sourceLine" id="cb486-6" title="6"><span class="kw">def</span> matpow(x,n):</a>
<a class="sourceLine" id="cb486-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb486-8" title="8"><span class="co">  This function computes matrix x raised to the power n.</span></a>
<a class="sourceLine" id="cb486-9" title="9"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb486-10" title="10">  r <span class="op">=</span> np.eye(x.shape[<span class="dv">0</span>])</a>
<a class="sourceLine" id="cb486-11" title="11">  <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n):</a>
<a class="sourceLine" id="cb486-12" title="12">    r <span class="op">=</span> np.dot(r,x)</a>
<a class="sourceLine" id="cb486-13" title="13">  <span class="cf">return</span> r</a>
<a class="sourceLine" id="cb486-14" title="14"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb486-15" title="15"></a>
<a class="sourceLine" id="cb486-16" title="16"></a>
<a class="sourceLine" id="cb486-17" title="17">x <span class="op">=</span> np.array([[<span class="dv">0</span>, <span class="dv">1</span>], [<span class="op">-</span><span class="dv">1</span>, <span class="dv">0</span>]])</a>
<a class="sourceLine" id="cb486-18" title="18"></a>
<a class="sourceLine" id="cb486-19" title="19">true_y <span class="op">=</span> np.linalg.matrix_power(x,<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb486-20" title="20"></a>
<a class="sourceLine" id="cb486-21" title="21">pred_y <span class="op">=</span> matpow(x,<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb486-22" title="22"></a>
<a class="sourceLine" id="cb486-23" title="23">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.allclose(true_y,pred_y) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-44">Run 1</h4>
<div class="sourceCode" id="cb488"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb488-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb488-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb488-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb488-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb488-5" title="5"></a>
<a class="sourceLine" id="cb488-6" title="6"><span class="kw">def</span> matpow(x,n):</a>
<a class="sourceLine" id="cb488-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb488-8" title="8"><span class="co">  This function computes matrix x raised to the power n.</span></a>
<a class="sourceLine" id="cb488-9" title="9"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb488-10" title="10">  r <span class="op">=</span> np.eye(x.shape[<span class="dv">0</span>])</a>
<a class="sourceLine" id="cb488-11" title="11">  <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n):</a>
<a class="sourceLine" id="cb488-12" title="12">    r <span class="op">=</span> np.dot(r,x)</a>
<a class="sourceLine" id="cb488-13" title="13">  <span class="cf">return</span> r</a>
<a class="sourceLine" id="cb488-14" title="14"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb488-15" title="15"></a>
<a class="sourceLine" id="cb488-16" title="16"></a>
<a class="sourceLine" id="cb488-17" title="17">x <span class="op">=</span> np.array([[<span class="dv">0</span>, <span class="dv">1</span>], [<span class="op">-</span><span class="dv">1</span>, <span class="dv">0</span>]])</a>
<a class="sourceLine" id="cb488-18" title="18"></a>
<a class="sourceLine" id="cb488-19" title="19">true_y <span class="op">=</span> np.linalg.matrix_power(x,<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb488-20" title="20"></a>
<a class="sourceLine" id="cb488-21" title="21">pred_y <span class="op">=</span> matpow(x,<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb488-22" title="22"></a>
<a class="sourceLine" id="cb488-23" title="23">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.allclose(true_y,pred_y) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-44">Run 2</h4>
<div class="sourceCode" id="cb490"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb490-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb490-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb490-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb490-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb490-5" title="5"></a>
<a class="sourceLine" id="cb490-6" title="6"><span class="kw">def</span> matpow(x,n):</a>
<a class="sourceLine" id="cb490-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb490-8" title="8"><span class="co">  This function computes matrix x raised to the power n.</span></a>
<a class="sourceLine" id="cb490-9" title="9"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb490-10" title="10">  r <span class="op">=</span> np.eye(x.shape[<span class="dv">0</span>])</a>
<a class="sourceLine" id="cb490-11" title="11">  <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n):</a>
<a class="sourceLine" id="cb490-12" title="12">    r <span class="op">=</span> np.dot(r,x)</a>
<a class="sourceLine" id="cb490-13" title="13">  <span class="cf">return</span> r</a>
<a class="sourceLine" id="cb490-14" title="14"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb490-15" title="15"></a>
<a class="sourceLine" id="cb490-16" title="16"></a>
<a class="sourceLine" id="cb490-17" title="17">x <span class="op">=</span> np.array([[<span class="dv">0</span>, <span class="dv">1</span>], [<span class="op">-</span><span class="dv">1</span>, <span class="dv">0</span>]])</a>
<a class="sourceLine" id="cb490-18" title="18"></a>
<a class="sourceLine" id="cb490-19" title="19">true_y <span class="op">=</span> np.linalg.matrix_power(x,<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb490-20" title="20"></a>
<a class="sourceLine" id="cb490-21" title="21">pred_y <span class="op">=</span> matpow(x,<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb490-22" title="22"></a>
<a class="sourceLine" id="cb490-23" title="23">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.allclose(true_y,pred_y) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-44">Run 3</h4>
<div class="sourceCode" id="cb492"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb492-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb492-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb492-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb492-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb492-5" title="5"></a>
<a class="sourceLine" id="cb492-6" title="6"><span class="kw">def</span> matpow(x,n):</a>
<a class="sourceLine" id="cb492-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb492-8" title="8"><span class="co">  This function computes matrix x raised to the power n.</span></a>
<a class="sourceLine" id="cb492-9" title="9"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb492-10" title="10">  r <span class="op">=</span> np.eye(x.shape[<span class="dv">0</span>])</a>
<a class="sourceLine" id="cb492-11" title="11">  <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n):</a>
<a class="sourceLine" id="cb492-12" title="12">    r <span class="op">=</span> np.dot(r,x)</a>
<a class="sourceLine" id="cb492-13" title="13">  <span class="cf">return</span> r</a>
<a class="sourceLine" id="cb492-14" title="14"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb492-15" title="15"></a>
<a class="sourceLine" id="cb492-16" title="16"></a>
<a class="sourceLine" id="cb492-17" title="17">x <span class="op">=</span> np.array([[<span class="dv">0</span>, <span class="dv">1</span>], [<span class="op">-</span><span class="dv">1</span>, <span class="dv">0</span>]])</a>
<a class="sourceLine" id="cb492-18" title="18"></a>
<a class="sourceLine" id="cb492-19" title="19">true_y <span class="op">=</span> np.linalg.matrix_power(x,<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb492-20" title="20"></a>
<a class="sourceLine" id="cb492-21" title="21">pred_y <span class="op">=</span> matpow(x,<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb492-22" title="22"></a>
<a class="sourceLine" id="cb492-23" title="23">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.allclose(true_y,pred_y) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-44">Run 4</h4>
<div class="sourceCode" id="cb494"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb494-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb494-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb494-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb494-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb494-5" title="5"></a>
<a class="sourceLine" id="cb494-6" title="6"><span class="kw">def</span> matpow(x,n):</a>
<a class="sourceLine" id="cb494-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb494-8" title="8"><span class="co">  This function computes matrix x raised to the power n.</span></a>
<a class="sourceLine" id="cb494-9" title="9"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb494-10" title="10">  r <span class="op">=</span> np.eye(x.shape[<span class="dv">0</span>])</a>
<a class="sourceLine" id="cb494-11" title="11">  <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n):</a>
<a class="sourceLine" id="cb494-12" title="12">    r <span class="op">=</span> np.dot(r,x)</a>
<a class="sourceLine" id="cb494-13" title="13">  <span class="cf">return</span> r</a>
<a class="sourceLine" id="cb494-14" title="14"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb494-15" title="15"></a>
<a class="sourceLine" id="cb494-16" title="16"></a>
<a class="sourceLine" id="cb494-17" title="17">x <span class="op">=</span> np.array([[<span class="dv">0</span>, <span class="dv">1</span>], [<span class="op">-</span><span class="dv">1</span>, <span class="dv">0</span>]])</a>
<a class="sourceLine" id="cb494-18" title="18"></a>
<a class="sourceLine" id="cb494-19" title="19">true_y <span class="op">=</span> np.linalg.matrix_power(x,<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb494-20" title="20"></a>
<a class="sourceLine" id="cb494-21" title="21">pred_y <span class="op">=</span> matpow(x,<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb494-22" title="22"></a>
<a class="sourceLine" id="cb494-23" title="23">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.allclose(true_y,pred_y) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>matrix_factorial</summary></p>
<h4 id="query-45">Query</h4>
<div class="sourceCode" id="cb496"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb496-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb496-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb496-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb496-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb496-5" title="5"></a>
<a class="sourceLine" id="cb496-6" title="6"><span class="kw">def</span> matrix_factorial(n):</a>
<a class="sourceLine" id="cb496-7" title="7">     <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb496-8" title="8"><span class="co">     This function calculates and returns the factorial of a matrix (array) element wise</span></a>
<a class="sourceLine" id="cb496-9" title="9"><span class="co">     &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb496-10" title="10">     [insert]</a>
<a class="sourceLine" id="cb496-11" title="11">     <span class="cf">return</span> f</a></code></pre></div>
<h4 id="run-0-45">Run 0</h4>
<div class="sourceCode" id="cb497"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb497-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb497-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb497-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb497-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb497-5" title="5"></a>
<a class="sourceLine" id="cb497-6" title="6"><span class="kw">def</span> matrix_factorial(n):</a>
<a class="sourceLine" id="cb497-7" title="7">     <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb497-8" title="8"><span class="co">     This function calculates and returns the factorial of a matrix (array) element wise</span></a>
<a class="sourceLine" id="cb497-9" title="9"><span class="co">     &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb497-10" title="10">     f <span class="op">=</span> np.zeros(n.shape)</a>
<a class="sourceLine" id="cb497-11" title="11">     <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n.shape[<span class="dv">0</span>]):</a>
<a class="sourceLine" id="cb497-12" title="12">          <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(n.shape[<span class="dv">1</span>]):</a>
<a class="sourceLine" id="cb497-13" title="13">               f[i,j] <span class="op">=</span> np.math.factorial(n[i,j])</a>
<a class="sourceLine" id="cb497-14" title="14">     <span class="cf">return</span> f</a>
<a class="sourceLine" id="cb497-15" title="15"></a>
<a class="sourceLine" id="cb497-16" title="16"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb497-17" title="17"></a>
<a class="sourceLine" id="cb497-18" title="18">x <span class="op">=</span> np.array([[<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>], [<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>]])</a>
<a class="sourceLine" id="cb497-19" title="19">m_f <span class="op">=</span> matrix_factorial(x)</a>
<a class="sourceLine" id="cb497-20" title="20">x_f <span class="op">=</span> np.array([[<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">6</span>], [<span class="dv">24</span>,<span class="dv">120</span>,<span class="dv">720</span>]])</a>
<a class="sourceLine" id="cb497-21" title="21"></a>
<a class="sourceLine" id="cb497-22" title="22">result <span class="op">=</span> np.array_equal(x_f,m_f) </a>
<a class="sourceLine" id="cb497-23" title="23"></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-45">Run 1</h4>
<div class="sourceCode" id="cb499"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb499-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb499-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb499-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb499-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb499-5" title="5"></a>
<a class="sourceLine" id="cb499-6" title="6"><span class="kw">def</span> matrix_factorial(n):</a>
<a class="sourceLine" id="cb499-7" title="7">     <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb499-8" title="8"><span class="co">     This function calculates and returns the factorial of a matrix (array) element wise</span></a>
<a class="sourceLine" id="cb499-9" title="9"><span class="co">     &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb499-10" title="10">     f <span class="op">=</span> np.zeros(n.shape)</a>
<a class="sourceLine" id="cb499-11" title="11">     <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n.shape[<span class="dv">0</span>]):</a>
<a class="sourceLine" id="cb499-12" title="12">          <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(n.shape[<span class="dv">1</span>]):</a>
<a class="sourceLine" id="cb499-13" title="13">               f[i,j] <span class="op">=</span> np.math.factorial(n[i,j])</a>
<a class="sourceLine" id="cb499-14" title="14">     <span class="cf">return</span> f</a>
<a class="sourceLine" id="cb499-15" title="15"></a>
<a class="sourceLine" id="cb499-16" title="16"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb499-17" title="17"></a>
<a class="sourceLine" id="cb499-18" title="18">x <span class="op">=</span> np.array([[<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>], [<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>]])</a>
<a class="sourceLine" id="cb499-19" title="19">m_f <span class="op">=</span> matrix_factorial(x)</a>
<a class="sourceLine" id="cb499-20" title="20">x_f <span class="op">=</span> np.array([[<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">6</span>], [<span class="dv">24</span>,<span class="dv">120</span>,<span class="dv">720</span>]])</a>
<a class="sourceLine" id="cb499-21" title="21"></a>
<a class="sourceLine" id="cb499-22" title="22">result <span class="op">=</span> np.array_equal(x_f,m_f) </a>
<a class="sourceLine" id="cb499-23" title="23"></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-45">Run 2</h4>
<div class="sourceCode" id="cb501"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb501-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb501-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb501-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb501-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb501-5" title="5"></a>
<a class="sourceLine" id="cb501-6" title="6"><span class="kw">def</span> matrix_factorial(n):</a>
<a class="sourceLine" id="cb501-7" title="7">     <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb501-8" title="8"><span class="co">     This function calculates and returns the factorial of a matrix (array) element wise</span></a>
<a class="sourceLine" id="cb501-9" title="9"><span class="co">     &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb501-10" title="10">     f <span class="op">=</span> np.zeros(n.shape)</a>
<a class="sourceLine" id="cb501-11" title="11">     <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n.shape[<span class="dv">0</span>]):</a>
<a class="sourceLine" id="cb501-12" title="12">          <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(n.shape[<span class="dv">1</span>]):</a>
<a class="sourceLine" id="cb501-13" title="13">               f[i,j] <span class="op">=</span> np.math.factorial(n[i,j])</a>
<a class="sourceLine" id="cb501-14" title="14">     <span class="cf">return</span> f</a>
<a class="sourceLine" id="cb501-15" title="15"></a>
<a class="sourceLine" id="cb501-16" title="16"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb501-17" title="17"></a>
<a class="sourceLine" id="cb501-18" title="18">x <span class="op">=</span> np.array([[<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>], [<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>]])</a>
<a class="sourceLine" id="cb501-19" title="19">m_f <span class="op">=</span> matrix_factorial(x)</a>
<a class="sourceLine" id="cb501-20" title="20">x_f <span class="op">=</span> np.array([[<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">6</span>], [<span class="dv">24</span>,<span class="dv">120</span>,<span class="dv">720</span>]])</a>
<a class="sourceLine" id="cb501-21" title="21"></a>
<a class="sourceLine" id="cb501-22" title="22">result <span class="op">=</span> np.array_equal(x_f,m_f) </a>
<a class="sourceLine" id="cb501-23" title="23"></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-45">Run 3</h4>
<div class="sourceCode" id="cb503"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb503-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb503-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb503-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb503-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb503-5" title="5"></a>
<a class="sourceLine" id="cb503-6" title="6"><span class="kw">def</span> matrix_factorial(n):</a>
<a class="sourceLine" id="cb503-7" title="7">     <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb503-8" title="8"><span class="co">     This function calculates and returns the factorial of a matrix (array) element wise</span></a>
<a class="sourceLine" id="cb503-9" title="9"><span class="co">     &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb503-10" title="10">     f <span class="op">=</span> np.zeros(n.shape)</a>
<a class="sourceLine" id="cb503-11" title="11">     <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n.shape[<span class="dv">0</span>]):</a>
<a class="sourceLine" id="cb503-12" title="12">          <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(n.shape[<span class="dv">1</span>]):</a>
<a class="sourceLine" id="cb503-13" title="13">               f[i,j] <span class="op">=</span> np.math.factorial(n[i,j])</a>
<a class="sourceLine" id="cb503-14" title="14">     <span class="cf">return</span> f</a>
<a class="sourceLine" id="cb503-15" title="15"></a>
<a class="sourceLine" id="cb503-16" title="16"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb503-17" title="17"></a>
<a class="sourceLine" id="cb503-18" title="18">x <span class="op">=</span> np.array([[<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>], [<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>]])</a>
<a class="sourceLine" id="cb503-19" title="19">m_f <span class="op">=</span> matrix_factorial(x)</a>
<a class="sourceLine" id="cb503-20" title="20">x_f <span class="op">=</span> np.array([[<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">6</span>], [<span class="dv">24</span>,<span class="dv">120</span>,<span class="dv">720</span>]])</a>
<a class="sourceLine" id="cb503-21" title="21"></a>
<a class="sourceLine" id="cb503-22" title="22">result <span class="op">=</span> np.array_equal(x_f,m_f) </a>
<a class="sourceLine" id="cb503-23" title="23"></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-45">Run 4</h4>
<div class="sourceCode" id="cb505"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb505-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb505-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb505-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb505-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb505-5" title="5"></a>
<a class="sourceLine" id="cb505-6" title="6"><span class="kw">def</span> matrix_factorial(n):</a>
<a class="sourceLine" id="cb505-7" title="7">     <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb505-8" title="8"><span class="co">     This function calculates and returns the factorial of a matrix (array) element wise</span></a>
<a class="sourceLine" id="cb505-9" title="9"><span class="co">     &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb505-10" title="10">     f <span class="op">=</span> np.zeros(n.shape)</a>
<a class="sourceLine" id="cb505-11" title="11">     <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n.shape[<span class="dv">0</span>]):</a>
<a class="sourceLine" id="cb505-12" title="12">          <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(n.shape[<span class="dv">1</span>]):</a>
<a class="sourceLine" id="cb505-13" title="13">               f[i,j] <span class="op">=</span> np.math.factorial(n[i,j])</a>
<a class="sourceLine" id="cb505-14" title="14">     <span class="cf">return</span> f</a>
<a class="sourceLine" id="cb505-15" title="15"></a>
<a class="sourceLine" id="cb505-16" title="16"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb505-17" title="17"></a>
<a class="sourceLine" id="cb505-18" title="18">x <span class="op">=</span> np.array([[<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>], [<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>]])</a>
<a class="sourceLine" id="cb505-19" title="19">m_f <span class="op">=</span> matrix_factorial(x)</a>
<a class="sourceLine" id="cb505-20" title="20">x_f <span class="op">=</span> np.array([[<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">6</span>], [<span class="dv">24</span>,<span class="dv">120</span>,<span class="dv">720</span>]])</a>
<a class="sourceLine" id="cb505-21" title="21"></a>
<a class="sourceLine" id="cb505-22" title="22">result <span class="op">=</span> np.array_equal(x_f,m_f) </a>
<a class="sourceLine" id="cb505-23" title="23"></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>max-boltz</summary></p>
<h4 id="query-46">Query</h4>
<div class="sourceCode" id="cb507"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb507-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb507-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb507-3" title="3"></a>
<a class="sourceLine" id="cb507-4" title="4"><span class="kw">def</span> max_boltz_rms_speed(T,M):</a>
<a class="sourceLine" id="cb507-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb507-6" title="6"><span class="co">   This function returns the rms speed of a molecule in m/s</span></a>
<a class="sourceLine" id="cb507-7" title="7"></a>
<a class="sourceLine" id="cb507-8" title="8"><span class="co">   The temperature is T in Kelvin</span></a>
<a class="sourceLine" id="cb507-9" title="9"><span class="co">   The molecule has mass M in kiolograms</span></a>
<a class="sourceLine" id="cb507-10" title="10"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb507-11" title="11">   [insert]</a>
<a class="sourceLine" id="cb507-12" title="12">   <span class="cf">return</span> s</a></code></pre></div>
<h4 id="run-0-46">Run 0</h4>
<div class="sourceCode" id="cb508"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb508-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb508-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb508-3" title="3"></a>
<a class="sourceLine" id="cb508-4" title="4"><span class="kw">def</span> max_boltz_rms_speed(T,M):</a>
<a class="sourceLine" id="cb508-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb508-6" title="6"><span class="co">   This function returns the rms speed of a molecule in m/s</span></a>
<a class="sourceLine" id="cb508-7" title="7"></a>
<a class="sourceLine" id="cb508-8" title="8"><span class="co">   The temperature is T in Kelvin</span></a>
<a class="sourceLine" id="cb508-9" title="9"><span class="co">   The molecule has mass M in kiolograms</span></a>
<a class="sourceLine" id="cb508-10" title="10"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb508-11" title="11">   k <span class="op">=</span> <span class="fl">1.3806503e-23</span></a>
<a class="sourceLine" id="cb508-12" title="12">   s <span class="op">=</span> math.sqrt(<span class="dv">3</span><span class="op">*</span>k<span class="op">*</span>T<span class="op">/</span>M)</a>
<a class="sourceLine" id="cb508-13" title="13">   <span class="cf">return</span> s</a>
<a class="sourceLine" id="cb508-14" title="14"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb508-15" title="15"></a>
<a class="sourceLine" id="cb508-16" title="16"><span class="co"># input params</span></a>
<a class="sourceLine" id="cb508-17" title="17">M <span class="op">=</span> <span class="fl">32e-3</span>           <span class="co"># for O2, kg/mol</span></a>
<a class="sourceLine" id="cb508-18" title="18">R <span class="op">=</span> <span class="fl">8.314</span>           <span class="co"># J/mol.K</span></a>
<a class="sourceLine" id="cb508-19" title="19">T <span class="op">=</span> <span class="dv">300</span></a>
<a class="sourceLine" id="cb508-20" title="20"></a>
<a class="sourceLine" id="cb508-21" title="21">c_rms <span class="op">=</span> np.sqrt(<span class="fl">3.0</span><span class="op">*</span>R<span class="op">*</span>T<span class="op">/</span>M)</a>
<a class="sourceLine" id="cb508-22" title="22"><span class="co">#print(&quot;rms speeds :&quot;, c_rms)</span></a>
<a class="sourceLine" id="cb508-23" title="23"></a>
<a class="sourceLine" id="cb508-24" title="24">M_in_kg <span class="op">=</span> M<span class="op">/</span><span class="fl">6.022e23</span></a>
<a class="sourceLine" id="cb508-25" title="25"></a>
<a class="sourceLine" id="cb508-26" title="26">c_rms_codex <span class="op">=</span> max_boltz_rms_speed(T,M_in_kg)</a>
<a class="sourceLine" id="cb508-27" title="27"><span class="co">#print(&quot;rms speeds from codex :&quot;, c_rms_codex)</span></a>
<a class="sourceLine" id="cb508-28" title="28"></a>
<a class="sourceLine" id="cb508-29" title="29"><span class="co"># check</span></a>
<a class="sourceLine" id="cb508-30" title="30"><span class="cf">if</span> np.isclose(c_rms,c_rms_codex,rtol<span class="op">=</span><span class="fl">0.01</span>):</a>
<a class="sourceLine" id="cb508-31" title="31">    result <span class="op">=</span> <span class="va">True</span> </a>
<a class="sourceLine" id="cb508-32" title="32"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb508-33" title="33">    result <span class="op">=</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-46">Run 1</h4>
<div class="sourceCode" id="cb510"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb510-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb510-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb510-3" title="3"></a>
<a class="sourceLine" id="cb510-4" title="4"><span class="kw">def</span> max_boltz_rms_speed(T,M):</a>
<a class="sourceLine" id="cb510-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb510-6" title="6"><span class="co">   This function returns the rms speed of a molecule in m/s</span></a>
<a class="sourceLine" id="cb510-7" title="7"></a>
<a class="sourceLine" id="cb510-8" title="8"><span class="co">   The temperature is T in Kelvin</span></a>
<a class="sourceLine" id="cb510-9" title="9"><span class="co">   The molecule has mass M in kiolograms</span></a>
<a class="sourceLine" id="cb510-10" title="10"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb510-11" title="11">   k <span class="op">=</span> <span class="fl">1.38064852e-23</span> <span class="co"># Boltzmann constant in m^2 kg s^-2 K^-1</span></a>
<a class="sourceLine" id="cb510-12" title="12">   s <span class="op">=</span> math.sqrt(<span class="dv">3</span><span class="op">*</span>k<span class="op">*</span>T<span class="op">/</span>M)</a>
<a class="sourceLine" id="cb510-13" title="13">   <span class="cf">return</span> s</a>
<a class="sourceLine" id="cb510-14" title="14"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb510-15" title="15"></a>
<a class="sourceLine" id="cb510-16" title="16"><span class="co"># input params</span></a>
<a class="sourceLine" id="cb510-17" title="17">M <span class="op">=</span> <span class="fl">32e-3</span>           <span class="co"># for O2, kg/mol</span></a>
<a class="sourceLine" id="cb510-18" title="18">R <span class="op">=</span> <span class="fl">8.314</span>           <span class="co"># J/mol.K</span></a>
<a class="sourceLine" id="cb510-19" title="19">T <span class="op">=</span> <span class="dv">300</span></a>
<a class="sourceLine" id="cb510-20" title="20"></a>
<a class="sourceLine" id="cb510-21" title="21">c_rms <span class="op">=</span> np.sqrt(<span class="fl">3.0</span><span class="op">*</span>R<span class="op">*</span>T<span class="op">/</span>M)</a>
<a class="sourceLine" id="cb510-22" title="22"><span class="co">#print(&quot;rms speeds :&quot;, c_rms)</span></a>
<a class="sourceLine" id="cb510-23" title="23"></a>
<a class="sourceLine" id="cb510-24" title="24">M_in_kg <span class="op">=</span> M<span class="op">/</span><span class="fl">6.022e23</span></a>
<a class="sourceLine" id="cb510-25" title="25"></a>
<a class="sourceLine" id="cb510-26" title="26">c_rms_codex <span class="op">=</span> max_boltz_rms_speed(T,M_in_kg)</a>
<a class="sourceLine" id="cb510-27" title="27"><span class="co">#print(&quot;rms speeds from codex :&quot;, c_rms_codex)</span></a>
<a class="sourceLine" id="cb510-28" title="28"></a>
<a class="sourceLine" id="cb510-29" title="29"><span class="co"># check</span></a>
<a class="sourceLine" id="cb510-30" title="30"><span class="cf">if</span> np.isclose(c_rms,c_rms_codex,rtol<span class="op">=</span><span class="fl">0.01</span>):</a>
<a class="sourceLine" id="cb510-31" title="31">    result <span class="op">=</span> <span class="va">True</span> </a>
<a class="sourceLine" id="cb510-32" title="32"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb510-33" title="33">    result <span class="op">=</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-46">Run 2</h4>
<div class="sourceCode" id="cb512"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb512-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb512-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb512-3" title="3"></a>
<a class="sourceLine" id="cb512-4" title="4"><span class="kw">def</span> max_boltz_rms_speed(T,M):</a>
<a class="sourceLine" id="cb512-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb512-6" title="6"><span class="co">   This function returns the rms speed of a molecule in m/s</span></a>
<a class="sourceLine" id="cb512-7" title="7"></a>
<a class="sourceLine" id="cb512-8" title="8"><span class="co">   The temperature is T in Kelvin</span></a>
<a class="sourceLine" id="cb512-9" title="9"><span class="co">   The molecule has mass M in kiolograms</span></a>
<a class="sourceLine" id="cb512-10" title="10"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb512-11" title="11">   k <span class="op">=</span> <span class="fl">1.38064852e-23</span></a>
<a class="sourceLine" id="cb512-12" title="12">   s <span class="op">=</span> math.sqrt(<span class="dv">3</span><span class="op">*</span>k<span class="op">*</span>T<span class="op">/</span>M)</a>
<a class="sourceLine" id="cb512-13" title="13">   <span class="cf">return</span> s</a>
<a class="sourceLine" id="cb512-14" title="14"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb512-15" title="15"></a>
<a class="sourceLine" id="cb512-16" title="16"><span class="co"># input params</span></a>
<a class="sourceLine" id="cb512-17" title="17">M <span class="op">=</span> <span class="fl">32e-3</span>           <span class="co"># for O2, kg/mol</span></a>
<a class="sourceLine" id="cb512-18" title="18">R <span class="op">=</span> <span class="fl">8.314</span>           <span class="co"># J/mol.K</span></a>
<a class="sourceLine" id="cb512-19" title="19">T <span class="op">=</span> <span class="dv">300</span></a>
<a class="sourceLine" id="cb512-20" title="20"></a>
<a class="sourceLine" id="cb512-21" title="21">c_rms <span class="op">=</span> np.sqrt(<span class="fl">3.0</span><span class="op">*</span>R<span class="op">*</span>T<span class="op">/</span>M)</a>
<a class="sourceLine" id="cb512-22" title="22"><span class="co">#print(&quot;rms speeds :&quot;, c_rms)</span></a>
<a class="sourceLine" id="cb512-23" title="23"></a>
<a class="sourceLine" id="cb512-24" title="24">M_in_kg <span class="op">=</span> M<span class="op">/</span><span class="fl">6.022e23</span></a>
<a class="sourceLine" id="cb512-25" title="25"></a>
<a class="sourceLine" id="cb512-26" title="26">c_rms_codex <span class="op">=</span> max_boltz_rms_speed(T,M_in_kg)</a>
<a class="sourceLine" id="cb512-27" title="27"><span class="co">#print(&quot;rms speeds from codex :&quot;, c_rms_codex)</span></a>
<a class="sourceLine" id="cb512-28" title="28"></a>
<a class="sourceLine" id="cb512-29" title="29"><span class="co"># check</span></a>
<a class="sourceLine" id="cb512-30" title="30"><span class="cf">if</span> np.isclose(c_rms,c_rms_codex,rtol<span class="op">=</span><span class="fl">0.01</span>):</a>
<a class="sourceLine" id="cb512-31" title="31">    result <span class="op">=</span> <span class="va">True</span> </a>
<a class="sourceLine" id="cb512-32" title="32"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb512-33" title="33">    result <span class="op">=</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-46">Run 3</h4>
<div class="sourceCode" id="cb514"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb514-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb514-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb514-3" title="3"></a>
<a class="sourceLine" id="cb514-4" title="4"><span class="kw">def</span> max_boltz_rms_speed(T,M):</a>
<a class="sourceLine" id="cb514-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb514-6" title="6"><span class="co">   This function returns the rms speed of a molecule in m/s</span></a>
<a class="sourceLine" id="cb514-7" title="7"></a>
<a class="sourceLine" id="cb514-8" title="8"><span class="co">   The temperature is T in Kelvin</span></a>
<a class="sourceLine" id="cb514-9" title="9"><span class="co">   The molecule has mass M in kiolograms</span></a>
<a class="sourceLine" id="cb514-10" title="10"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb514-11" title="11">   k <span class="op">=</span> <span class="fl">1.3806488e-23</span></a>
<a class="sourceLine" id="cb514-12" title="12">   s <span class="op">=</span> math.sqrt(<span class="dv">3</span><span class="op">*</span>k<span class="op">*</span>T<span class="op">/</span>M)</a>
<a class="sourceLine" id="cb514-13" title="13">   <span class="cf">return</span> s</a>
<a class="sourceLine" id="cb514-14" title="14"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb514-15" title="15"></a>
<a class="sourceLine" id="cb514-16" title="16"><span class="co"># input params</span></a>
<a class="sourceLine" id="cb514-17" title="17">M <span class="op">=</span> <span class="fl">32e-3</span>           <span class="co"># for O2, kg/mol</span></a>
<a class="sourceLine" id="cb514-18" title="18">R <span class="op">=</span> <span class="fl">8.314</span>           <span class="co"># J/mol.K</span></a>
<a class="sourceLine" id="cb514-19" title="19">T <span class="op">=</span> <span class="dv">300</span></a>
<a class="sourceLine" id="cb514-20" title="20"></a>
<a class="sourceLine" id="cb514-21" title="21">c_rms <span class="op">=</span> np.sqrt(<span class="fl">3.0</span><span class="op">*</span>R<span class="op">*</span>T<span class="op">/</span>M)</a>
<a class="sourceLine" id="cb514-22" title="22"><span class="co">#print(&quot;rms speeds :&quot;, c_rms)</span></a>
<a class="sourceLine" id="cb514-23" title="23"></a>
<a class="sourceLine" id="cb514-24" title="24">M_in_kg <span class="op">=</span> M<span class="op">/</span><span class="fl">6.022e23</span></a>
<a class="sourceLine" id="cb514-25" title="25"></a>
<a class="sourceLine" id="cb514-26" title="26">c_rms_codex <span class="op">=</span> max_boltz_rms_speed(T,M_in_kg)</a>
<a class="sourceLine" id="cb514-27" title="27"><span class="co">#print(&quot;rms speeds from codex :&quot;, c_rms_codex)</span></a>
<a class="sourceLine" id="cb514-28" title="28"></a>
<a class="sourceLine" id="cb514-29" title="29"><span class="co"># check</span></a>
<a class="sourceLine" id="cb514-30" title="30"><span class="cf">if</span> np.isclose(c_rms,c_rms_codex,rtol<span class="op">=</span><span class="fl">0.01</span>):</a>
<a class="sourceLine" id="cb514-31" title="31">    result <span class="op">=</span> <span class="va">True</span> </a>
<a class="sourceLine" id="cb514-32" title="32"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb514-33" title="33">    result <span class="op">=</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-46">Run 4</h4>
<div class="sourceCode" id="cb516"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb516-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb516-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb516-3" title="3"></a>
<a class="sourceLine" id="cb516-4" title="4"><span class="kw">def</span> max_boltz_rms_speed(T,M):</a>
<a class="sourceLine" id="cb516-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb516-6" title="6"><span class="co">   This function returns the rms speed of a molecule in m/s</span></a>
<a class="sourceLine" id="cb516-7" title="7"></a>
<a class="sourceLine" id="cb516-8" title="8"><span class="co">   The temperature is T in Kelvin</span></a>
<a class="sourceLine" id="cb516-9" title="9"><span class="co">   The molecule has mass M in kiolograms</span></a>
<a class="sourceLine" id="cb516-10" title="10"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb516-11" title="11">   k <span class="op">=</span> <span class="fl">1.3806503e-23</span></a>
<a class="sourceLine" id="cb516-12" title="12">   s <span class="op">=</span> math.sqrt(<span class="dv">3</span><span class="op">*</span>k<span class="op">*</span>T<span class="op">/</span>M)</a>
<a class="sourceLine" id="cb516-13" title="13">   <span class="cf">return</span> s</a>
<a class="sourceLine" id="cb516-14" title="14"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb516-15" title="15"></a>
<a class="sourceLine" id="cb516-16" title="16"><span class="co"># input params</span></a>
<a class="sourceLine" id="cb516-17" title="17">M <span class="op">=</span> <span class="fl">32e-3</span>           <span class="co"># for O2, kg/mol</span></a>
<a class="sourceLine" id="cb516-18" title="18">R <span class="op">=</span> <span class="fl">8.314</span>           <span class="co"># J/mol.K</span></a>
<a class="sourceLine" id="cb516-19" title="19">T <span class="op">=</span> <span class="dv">300</span></a>
<a class="sourceLine" id="cb516-20" title="20"></a>
<a class="sourceLine" id="cb516-21" title="21">c_rms <span class="op">=</span> np.sqrt(<span class="fl">3.0</span><span class="op">*</span>R<span class="op">*</span>T<span class="op">/</span>M)</a>
<a class="sourceLine" id="cb516-22" title="22"><span class="co">#print(&quot;rms speeds :&quot;, c_rms)</span></a>
<a class="sourceLine" id="cb516-23" title="23"></a>
<a class="sourceLine" id="cb516-24" title="24">M_in_kg <span class="op">=</span> M<span class="op">/</span><span class="fl">6.022e23</span></a>
<a class="sourceLine" id="cb516-25" title="25"></a>
<a class="sourceLine" id="cb516-26" title="26">c_rms_codex <span class="op">=</span> max_boltz_rms_speed(T,M_in_kg)</a>
<a class="sourceLine" id="cb516-27" title="27"><span class="co">#print(&quot;rms speeds from codex :&quot;, c_rms_codex)</span></a>
<a class="sourceLine" id="cb516-28" title="28"></a>
<a class="sourceLine" id="cb516-29" title="29"><span class="co"># check</span></a>
<a class="sourceLine" id="cb516-30" title="30"><span class="cf">if</span> np.isclose(c_rms,c_rms_codex,rtol<span class="op">=</span><span class="fl">0.01</span>):</a>
<a class="sourceLine" id="cb516-31" title="31">    result <span class="op">=</span> <span class="va">True</span> </a>
<a class="sourceLine" id="cb516-32" title="32"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb516-33" title="33">    result <span class="op">=</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>michaelis</summary></p>
<h4 id="query-47">Query</h4>
<div class="sourceCode" id="cb518"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb518-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb518-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb518-3" title="3"></a>
<a class="sourceLine" id="cb518-4" title="4"><span class="kw">def</span> reaction_velocity(Vmax, S, Km):</a>
<a class="sourceLine" id="cb518-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb518-6" title="6"><span class="co">   This function returns the initial reaction rate according to Michaelis-Menten kinetics</span></a>
<a class="sourceLine" id="cb518-7" title="7"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb518-8" title="8">   [insert]</a>
<a class="sourceLine" id="cb518-9" title="9">   <span class="cf">return</span> v</a>
<a class="sourceLine" id="cb518-10" title="10"></a></code></pre></div>
<h4 id="run-0-47">Run 0</h4>
<div class="sourceCode" id="cb519"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb519-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb519-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb519-3" title="3"></a>
<a class="sourceLine" id="cb519-4" title="4"><span class="kw">def</span> reaction_velocity(Vmax, S, Km):</a>
<a class="sourceLine" id="cb519-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb519-6" title="6"><span class="co">   This function returns the initial reaction rate according to Michaelis-Menten kinetics</span></a>
<a class="sourceLine" id="cb519-7" title="7"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb519-8" title="8">   v <span class="op">=</span> Vmax<span class="op">*</span>S<span class="op">/</span>(Km<span class="op">+</span>S)</a>
<a class="sourceLine" id="cb519-9" title="9">   <span class="cf">return</span> v</a>
<a class="sourceLine" id="cb519-10" title="10"></a>
<a class="sourceLine" id="cb519-11" title="11"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb519-12" title="12"></a>
<a class="sourceLine" id="cb519-13" title="13">Vmax<span class="op">=</span><span class="dv">10</span></a>
<a class="sourceLine" id="cb519-14" title="14">K_M <span class="op">=</span> <span class="dv">2</span></a>
<a class="sourceLine" id="cb519-15" title="15">S <span class="op">=</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb519-16" title="16">v<span class="op">=</span>Vmax<span class="op">*</span>S<span class="op">/</span>(S<span class="op">+</span>K_M)</a>
<a class="sourceLine" id="cb519-17" title="17"></a>
<a class="sourceLine" id="cb519-18" title="18">v_codex <span class="op">=</span> reaction_velocity(Vmax, S, K_M)</a>
<a class="sourceLine" id="cb519-19" title="19"></a>
<a class="sourceLine" id="cb519-20" title="20"><span class="co"># check </span></a>
<a class="sourceLine" id="cb519-21" title="21"><span class="cf">if</span> np.isclose(v, v_codex, rtol<span class="op">=</span><span class="fl">0.01</span>) <span class="op">==</span> <span class="va">True</span>:</a>
<a class="sourceLine" id="cb519-22" title="22">    result <span class="op">=</span> <span class="va">True</span> </a>
<a class="sourceLine" id="cb519-23" title="23"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb519-24" title="24">    result <span class="op">=</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-47">Run 1</h4>
<div class="sourceCode" id="cb521"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb521-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb521-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb521-3" title="3"></a>
<a class="sourceLine" id="cb521-4" title="4"><span class="kw">def</span> reaction_velocity(Vmax, S, Km):</a>
<a class="sourceLine" id="cb521-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb521-6" title="6"><span class="co">   This function returns the initial reaction rate according to Michaelis-Menten kinetics</span></a>
<a class="sourceLine" id="cb521-7" title="7"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb521-8" title="8">   v <span class="op">=</span> Vmax<span class="op">*</span>S<span class="op">/</span>(Km<span class="op">+</span>S)</a>
<a class="sourceLine" id="cb521-9" title="9">   <span class="cf">return</span> v</a>
<a class="sourceLine" id="cb521-10" title="10"></a>
<a class="sourceLine" id="cb521-11" title="11"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb521-12" title="12"></a>
<a class="sourceLine" id="cb521-13" title="13">Vmax<span class="op">=</span><span class="dv">10</span></a>
<a class="sourceLine" id="cb521-14" title="14">K_M <span class="op">=</span> <span class="dv">2</span></a>
<a class="sourceLine" id="cb521-15" title="15">S <span class="op">=</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb521-16" title="16">v<span class="op">=</span>Vmax<span class="op">*</span>S<span class="op">/</span>(S<span class="op">+</span>K_M)</a>
<a class="sourceLine" id="cb521-17" title="17"></a>
<a class="sourceLine" id="cb521-18" title="18">v_codex <span class="op">=</span> reaction_velocity(Vmax, S, K_M)</a>
<a class="sourceLine" id="cb521-19" title="19"></a>
<a class="sourceLine" id="cb521-20" title="20"><span class="co"># check </span></a>
<a class="sourceLine" id="cb521-21" title="21"><span class="cf">if</span> np.isclose(v, v_codex, rtol<span class="op">=</span><span class="fl">0.01</span>) <span class="op">==</span> <span class="va">True</span>:</a>
<a class="sourceLine" id="cb521-22" title="22">    result <span class="op">=</span> <span class="va">True</span> </a>
<a class="sourceLine" id="cb521-23" title="23"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb521-24" title="24">    result <span class="op">=</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-47">Run 2</h4>
<div class="sourceCode" id="cb523"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb523-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb523-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb523-3" title="3"></a>
<a class="sourceLine" id="cb523-4" title="4"><span class="kw">def</span> reaction_velocity(Vmax, S, Km):</a>
<a class="sourceLine" id="cb523-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb523-6" title="6"><span class="co">   This function returns the initial reaction rate according to Michaelis-Menten kinetics</span></a>
<a class="sourceLine" id="cb523-7" title="7"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb523-8" title="8">   v <span class="op">=</span> Vmax<span class="op">*</span>S<span class="op">/</span>(Km<span class="op">+</span>S)</a>
<a class="sourceLine" id="cb523-9" title="9">   <span class="cf">return</span> v</a>
<a class="sourceLine" id="cb523-10" title="10"></a>
<a class="sourceLine" id="cb523-11" title="11"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb523-12" title="12"></a>
<a class="sourceLine" id="cb523-13" title="13">Vmax<span class="op">=</span><span class="dv">10</span></a>
<a class="sourceLine" id="cb523-14" title="14">K_M <span class="op">=</span> <span class="dv">2</span></a>
<a class="sourceLine" id="cb523-15" title="15">S <span class="op">=</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb523-16" title="16">v<span class="op">=</span>Vmax<span class="op">*</span>S<span class="op">/</span>(S<span class="op">+</span>K_M)</a>
<a class="sourceLine" id="cb523-17" title="17"></a>
<a class="sourceLine" id="cb523-18" title="18">v_codex <span class="op">=</span> reaction_velocity(Vmax, S, K_M)</a>
<a class="sourceLine" id="cb523-19" title="19"></a>
<a class="sourceLine" id="cb523-20" title="20"><span class="co"># check </span></a>
<a class="sourceLine" id="cb523-21" title="21"><span class="cf">if</span> np.isclose(v, v_codex, rtol<span class="op">=</span><span class="fl">0.01</span>) <span class="op">==</span> <span class="va">True</span>:</a>
<a class="sourceLine" id="cb523-22" title="22">    result <span class="op">=</span> <span class="va">True</span> </a>
<a class="sourceLine" id="cb523-23" title="23"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb523-24" title="24">    result <span class="op">=</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-47">Run 3</h4>
<div class="sourceCode" id="cb525"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb525-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb525-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb525-3" title="3"></a>
<a class="sourceLine" id="cb525-4" title="4"><span class="kw">def</span> reaction_velocity(Vmax, S, Km):</a>
<a class="sourceLine" id="cb525-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb525-6" title="6"><span class="co">   This function returns the initial reaction rate according to Michaelis-Menten kinetics</span></a>
<a class="sourceLine" id="cb525-7" title="7"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb525-8" title="8">   v <span class="op">=</span> Vmax<span class="op">*</span>S<span class="op">/</span>(Km<span class="op">+</span>S)</a>
<a class="sourceLine" id="cb525-9" title="9">   <span class="cf">return</span> v</a>
<a class="sourceLine" id="cb525-10" title="10"></a>
<a class="sourceLine" id="cb525-11" title="11"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb525-12" title="12"></a>
<a class="sourceLine" id="cb525-13" title="13">Vmax<span class="op">=</span><span class="dv">10</span></a>
<a class="sourceLine" id="cb525-14" title="14">K_M <span class="op">=</span> <span class="dv">2</span></a>
<a class="sourceLine" id="cb525-15" title="15">S <span class="op">=</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb525-16" title="16">v<span class="op">=</span>Vmax<span class="op">*</span>S<span class="op">/</span>(S<span class="op">+</span>K_M)</a>
<a class="sourceLine" id="cb525-17" title="17"></a>
<a class="sourceLine" id="cb525-18" title="18">v_codex <span class="op">=</span> reaction_velocity(Vmax, S, K_M)</a>
<a class="sourceLine" id="cb525-19" title="19"></a>
<a class="sourceLine" id="cb525-20" title="20"><span class="co"># check </span></a>
<a class="sourceLine" id="cb525-21" title="21"><span class="cf">if</span> np.isclose(v, v_codex, rtol<span class="op">=</span><span class="fl">0.01</span>) <span class="op">==</span> <span class="va">True</span>:</a>
<a class="sourceLine" id="cb525-22" title="22">    result <span class="op">=</span> <span class="va">True</span> </a>
<a class="sourceLine" id="cb525-23" title="23"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb525-24" title="24">    result <span class="op">=</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-47">Run 4</h4>
<div class="sourceCode" id="cb527"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb527-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb527-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb527-3" title="3"></a>
<a class="sourceLine" id="cb527-4" title="4"><span class="kw">def</span> reaction_velocity(Vmax, S, Km):</a>
<a class="sourceLine" id="cb527-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb527-6" title="6"><span class="co">   This function returns the initial reaction rate according to Michaelis-Menten kinetics</span></a>
<a class="sourceLine" id="cb527-7" title="7"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb527-8" title="8">   v <span class="op">=</span> Vmax <span class="op">*</span> S <span class="op">/</span> (Km <span class="op">+</span> S)</a>
<a class="sourceLine" id="cb527-9" title="9">   <span class="cf">return</span> v</a>
<a class="sourceLine" id="cb527-10" title="10"></a>
<a class="sourceLine" id="cb527-11" title="11"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb527-12" title="12"></a>
<a class="sourceLine" id="cb527-13" title="13">Vmax<span class="op">=</span><span class="dv">10</span></a>
<a class="sourceLine" id="cb527-14" title="14">K_M <span class="op">=</span> <span class="dv">2</span></a>
<a class="sourceLine" id="cb527-15" title="15">S <span class="op">=</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb527-16" title="16">v<span class="op">=</span>Vmax<span class="op">*</span>S<span class="op">/</span>(S<span class="op">+</span>K_M)</a>
<a class="sourceLine" id="cb527-17" title="17"></a>
<a class="sourceLine" id="cb527-18" title="18">v_codex <span class="op">=</span> reaction_velocity(Vmax, S, K_M)</a>
<a class="sourceLine" id="cb527-19" title="19"></a>
<a class="sourceLine" id="cb527-20" title="20"><span class="co"># check </span></a>
<a class="sourceLine" id="cb527-21" title="21"><span class="cf">if</span> np.isclose(v, v_codex, rtol<span class="op">=</span><span class="fl">0.01</span>) <span class="op">==</span> <span class="va">True</span>:</a>
<a class="sourceLine" id="cb527-22" title="22">    result <span class="op">=</span> <span class="va">True</span> </a>
<a class="sourceLine" id="cb527-23" title="23"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb527-24" title="24">    result <span class="op">=</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>mol_charge</summary></p>
<h4 id="query-48">Query</h4>
<div class="sourceCode" id="cb529"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb529-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb529-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb529-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb529-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb529-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb529-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb529-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb529-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb529-9" title="9"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb529-10" title="10"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb529-11" title="11"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb529-12" title="12"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb529-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb529-14" title="14"></a>
<a class="sourceLine" id="cb529-15" title="15"><span class="kw">def</span> net_charge(smiles):</a>
<a class="sourceLine" id="cb529-16" title="16">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb529-17" title="17"><span class="co">    This function returns net charge of given molecule</span></a>
<a class="sourceLine" id="cb529-18" title="18"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb529-19" title="19">    [insert]</a>
<a class="sourceLine" id="cb529-20" title="20">    <span class="cf">return</span> charge</a></code></pre></div>
<h4 id="run-0-48">Run 0</h4>
<div class="sourceCode" id="cb530"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb530-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb530-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb530-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb530-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb530-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb530-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb530-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb530-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb530-9" title="9"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb530-10" title="10"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb530-11" title="11"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb530-12" title="12"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb530-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb530-14" title="14"></a>
<a class="sourceLine" id="cb530-15" title="15"><span class="kw">def</span> net_charge(smiles):</a>
<a class="sourceLine" id="cb530-16" title="16">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb530-17" title="17"><span class="co">    This function returns net charge of given molecule</span></a>
<a class="sourceLine" id="cb530-18" title="18"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb530-19" title="19">    mol <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb530-20" title="20">    charge <span class="op">=</span> Descriptors.MolWt(mol)</a>
<a class="sourceLine" id="cb530-21" title="21">    <span class="cf">return</span> charge</a>
<a class="sourceLine" id="cb530-22" title="22"></a>
<a class="sourceLine" id="cb530-23" title="23">s <span class="op">=</span> <span class="st">&#39;C1([O-])C=CC=C1NC2CCCCCC2C3=CC=CC=C3&#39;</span></a>
<a class="sourceLine" id="cb530-24" title="24">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> net_charge(s) <span class="op">==</span> <span class="dv">-1</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-48">Run 1</h4>
<div class="sourceCode" id="cb532"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb532-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb532-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb532-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb532-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb532-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb532-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb532-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb532-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb532-9" title="9"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb532-10" title="10"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb532-11" title="11"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb532-12" title="12"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb532-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb532-14" title="14"></a>
<a class="sourceLine" id="cb532-15" title="15"><span class="kw">def</span> net_charge(smiles):</a>
<a class="sourceLine" id="cb532-16" title="16">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb532-17" title="17"><span class="co">    This function returns net charge of given molecule</span></a>
<a class="sourceLine" id="cb532-18" title="18"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb532-19" title="19">    mol <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb532-20" title="20">    charge <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb532-21" title="21">    <span class="cf">for</span> atom <span class="kw">in</span> mol.GetAtoms():</a>
<a class="sourceLine" id="cb532-22" title="22">        charge <span class="op">+=</span> atom.GetFormalCharge()</a>
<a class="sourceLine" id="cb532-23" title="23">    <span class="cf">return</span> charge</a>
<a class="sourceLine" id="cb532-24" title="24"></a>
<a class="sourceLine" id="cb532-25" title="25">s <span class="op">=</span> <span class="st">&#39;C1([O-])C=CC=C1NC2CCCCCC2C3=CC=CC=C3&#39;</span></a>
<a class="sourceLine" id="cb532-26" title="26">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> net_charge(s) <span class="op">==</span> <span class="dv">-1</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-48">Run 2</h4>
<div class="sourceCode" id="cb534"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb534-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb534-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb534-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb534-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb534-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb534-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb534-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb534-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb534-9" title="9"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb534-10" title="10"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb534-11" title="11"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb534-12" title="12"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb534-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb534-14" title="14"></a>
<a class="sourceLine" id="cb534-15" title="15"><span class="kw">def</span> net_charge(smiles):</a>
<a class="sourceLine" id="cb534-16" title="16">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb534-17" title="17"><span class="co">    This function returns net charge of given molecule</span></a>
<a class="sourceLine" id="cb534-18" title="18"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb534-19" title="19">    mol <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb534-20" title="20">    charge <span class="op">=</span> Descriptors.MolWt(mol)</a>
<a class="sourceLine" id="cb534-21" title="21">    charge <span class="op">=</span> <span class="bu">round</span>(charge,<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb534-22" title="22">    <span class="cf">return</span> charge</a>
<a class="sourceLine" id="cb534-23" title="23"></a>
<a class="sourceLine" id="cb534-24" title="24">s <span class="op">=</span> <span class="st">&#39;C1([O-])C=CC=C1NC2CCCCCC2C3=CC=CC=C3&#39;</span></a>
<a class="sourceLine" id="cb534-25" title="25">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> net_charge(s) <span class="op">==</span> <span class="dv">-1</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-48">Run 3</h4>
<div class="sourceCode" id="cb536"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb536-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb536-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb536-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb536-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb536-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb536-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb536-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb536-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb536-9" title="9"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb536-10" title="10"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb536-11" title="11"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb536-12" title="12"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb536-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb536-14" title="14"></a>
<a class="sourceLine" id="cb536-15" title="15"><span class="kw">def</span> net_charge(smiles):</a>
<a class="sourceLine" id="cb536-16" title="16">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb536-17" title="17"><span class="co">    This function returns net charge of given molecule</span></a>
<a class="sourceLine" id="cb536-18" title="18"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb536-19" title="19">    mol <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb536-20" title="20">    charge <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb536-21" title="21">    <span class="cf">for</span> atom <span class="kw">in</span> mol.GetAtoms():</a>
<a class="sourceLine" id="cb536-22" title="22">        charge <span class="op">+=</span> atom.GetFormalCharge()</a>
<a class="sourceLine" id="cb536-23" title="23">    <span class="cf">return</span> charge</a>
<a class="sourceLine" id="cb536-24" title="24"></a>
<a class="sourceLine" id="cb536-25" title="25">s <span class="op">=</span> <span class="st">&#39;C1([O-])C=CC=C1NC2CCCCCC2C3=CC=CC=C3&#39;</span></a>
<a class="sourceLine" id="cb536-26" title="26">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> net_charge(s) <span class="op">==</span> <span class="dv">-1</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-48">Run 4</h4>
<div class="sourceCode" id="cb538"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb538-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb538-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb538-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb538-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb538-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb538-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb538-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb538-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb538-9" title="9"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb538-10" title="10"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb538-11" title="11"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb538-12" title="12"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb538-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb538-14" title="14"></a>
<a class="sourceLine" id="cb538-15" title="15"><span class="kw">def</span> net_charge(smiles):</a>
<a class="sourceLine" id="cb538-16" title="16">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb538-17" title="17"><span class="co">    This function returns net charge of given molecule</span></a>
<a class="sourceLine" id="cb538-18" title="18"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb538-19" title="19">    mol <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb538-20" title="20">    charge <span class="op">=</span> Descriptors.MolWt(mol)</a>
<a class="sourceLine" id="cb538-21" title="21">    <span class="cf">return</span> charge</a>
<a class="sourceLine" id="cb538-22" title="22"></a>
<a class="sourceLine" id="cb538-23" title="23">s <span class="op">=</span> <span class="st">&#39;C1([O-])C=CC=C1NC2CCCCCC2C3=CC=CC=C3&#39;</span></a>
<a class="sourceLine" id="cb538-24" title="24">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> net_charge(s) <span class="op">==</span> <span class="dv">-1</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>net_charge</summary></p>
<h4 id="query-49">Query</h4>
<div class="sourceCode" id="cb540"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb540-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb540-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb540-3" title="3"></a>
<a class="sourceLine" id="cb540-4" title="4"><span class="kw">def</span> net_charge(sequence):</a>
<a class="sourceLine" id="cb540-5" title="5">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb540-6" title="6"><span class="co">    This function returns net charge of amino acid sequence</span></a>
<a class="sourceLine" id="cb540-7" title="7"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb540-8" title="8">    [insert]</a>
<a class="sourceLine" id="cb540-9" title="9">    <span class="cf">return</span> charge</a></code></pre></div>
<h4 id="run-0-49">Run 0</h4>
<div class="sourceCode" id="cb541"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb541-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb541-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb541-3" title="3"></a>
<a class="sourceLine" id="cb541-4" title="4"><span class="kw">def</span> net_charge(sequence):</a>
<a class="sourceLine" id="cb541-5" title="5">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb541-6" title="6"><span class="co">    This function returns net charge of amino acid sequence</span></a>
<a class="sourceLine" id="cb541-7" title="7"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb541-8" title="8">    charge <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb541-9" title="9">    <span class="cf">for</span> aa <span class="kw">in</span> sequence:</a>
<a class="sourceLine" id="cb541-10" title="10">        <span class="cf">if</span> aa <span class="op">==</span> <span class="st">&#39;R&#39;</span> <span class="kw">or</span> aa <span class="op">==</span> <span class="st">&#39;K&#39;</span>:</a>
<a class="sourceLine" id="cb541-11" title="11">            charge <span class="op">+=</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb541-12" title="12">        <span class="cf">elif</span> aa <span class="op">==</span> <span class="st">&#39;D&#39;</span> <span class="kw">or</span> aa <span class="op">==</span> <span class="st">&#39;E&#39;</span>:</a>
<a class="sourceLine" id="cb541-13" title="13">            charge <span class="op">-=</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb541-14" title="14">        <span class="cf">else</span>:</a>
<a class="sourceLine" id="cb541-15" title="15">            charge <span class="op">+=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb541-16" title="16">    <span class="cf">return</span> charge</a>
<a class="sourceLine" id="cb541-17" title="17"></a>
<a class="sourceLine" id="cb541-18" title="18">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> net_charge(<span class="st">&quot;DSAVRCPQD&quot;</span>) <span class="op">==</span> <span class="dv">-1</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-49">Run 1</h4>
<div class="sourceCode" id="cb543"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb543-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb543-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb543-3" title="3"></a>
<a class="sourceLine" id="cb543-4" title="4"><span class="kw">def</span> net_charge(sequence):</a>
<a class="sourceLine" id="cb543-5" title="5">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb543-6" title="6"><span class="co">    This function returns net charge of amino acid sequence</span></a>
<a class="sourceLine" id="cb543-7" title="7"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb543-8" title="8">    charge <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb543-9" title="9">    <span class="cf">for</span> aa <span class="kw">in</span> sequence:</a>
<a class="sourceLine" id="cb543-10" title="10">        <span class="cf">if</span> aa <span class="op">==</span> <span class="st">&#39;K&#39;</span>:</a>
<a class="sourceLine" id="cb543-11" title="11">            charge <span class="op">+=</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb543-12" title="12">        <span class="cf">elif</span> aa <span class="op">==</span> <span class="st">&#39;R&#39;</span>:</a>
<a class="sourceLine" id="cb543-13" title="13">            charge <span class="op">+=</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb543-14" title="14">        <span class="cf">elif</span> aa <span class="op">==</span> <span class="st">&#39;H&#39;</span>:</a>
<a class="sourceLine" id="cb543-15" title="15">            charge <span class="op">+=</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb543-16" title="16">        <span class="cf">elif</span> aa <span class="op">==</span> <span class="st">&#39;D&#39;</span>:</a>
<a class="sourceLine" id="cb543-17" title="17">            charge <span class="op">-=</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb543-18" title="18">        <span class="cf">elif</span> aa <span class="op">==</span> <span class="st">&#39;E&#39;</span>:</a>
<a class="sourceLine" id="cb543-19" title="19">            charge <span class="op">-=</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb543-20" title="20">        <span class="cf">else</span>:</a>
<a class="sourceLine" id="cb543-21" title="21">            <span class="cf">pass</span></a>
<a class="sourceLine" id="cb543-22" title="22"></a>
<a class="sourceLine" id="cb543-23" title="23">    <span class="cf">return</span> charge</a>
<a class="sourceLine" id="cb543-24" title="24"></a>
<a class="sourceLine" id="cb543-25" title="25">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> net_charge(<span class="st">&quot;DSAVRCPQD&quot;</span>) <span class="op">==</span> <span class="dv">-1</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-49">Run 2</h4>
<div class="sourceCode" id="cb545"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb545-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb545-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb545-3" title="3"></a>
<a class="sourceLine" id="cb545-4" title="4"><span class="kw">def</span> net_charge(sequence):</a>
<a class="sourceLine" id="cb545-5" title="5">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb545-6" title="6"><span class="co">    This function returns net charge of amino acid sequence</span></a>
<a class="sourceLine" id="cb545-7" title="7"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb545-8" title="8">    charge <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb545-9" title="9">    <span class="cf">for</span> i <span class="kw">in</span> sequence:</a>
<a class="sourceLine" id="cb545-10" title="10">        <span class="cf">if</span> i <span class="op">==</span> <span class="st">&quot;K&quot;</span> <span class="kw">or</span> i <span class="op">==</span> <span class="st">&quot;R&quot;</span>:</a>
<a class="sourceLine" id="cb545-11" title="11">            charge <span class="op">+=</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb545-12" title="12">        <span class="cf">elif</span> i <span class="op">==</span> <span class="st">&quot;D&quot;</span> <span class="kw">or</span> i <span class="op">==</span> <span class="st">&quot;E&quot;</span>:</a>
<a class="sourceLine" id="cb545-13" title="13">            charge <span class="op">-=</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb545-14" title="14">    <span class="cf">return</span> charge</a>
<a class="sourceLine" id="cb545-15" title="15"></a>
<a class="sourceLine" id="cb545-16" title="16">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> net_charge(<span class="st">&quot;DSAVRCPQD&quot;</span>) <span class="op">==</span> <span class="dv">-1</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-49">Run 3</h4>
<div class="sourceCode" id="cb547"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb547-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb547-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb547-3" title="3"></a>
<a class="sourceLine" id="cb547-4" title="4"><span class="kw">def</span> net_charge(sequence):</a>
<a class="sourceLine" id="cb547-5" title="5">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb547-6" title="6"><span class="co">    This function returns net charge of amino acid sequence</span></a>
<a class="sourceLine" id="cb547-7" title="7"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb547-8" title="8">    charge <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb547-9" title="9">    <span class="cf">for</span> i <span class="kw">in</span> sequence:</a>
<a class="sourceLine" id="cb547-10" title="10">        <span class="cf">if</span> i <span class="op">==</span> <span class="st">&#39;K&#39;</span> <span class="kw">or</span> i <span class="op">==</span> <span class="st">&#39;R&#39;</span>:</a>
<a class="sourceLine" id="cb547-11" title="11">            charge <span class="op">+=</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb547-12" title="12">        <span class="cf">elif</span> i <span class="op">==</span> <span class="st">&#39;D&#39;</span> <span class="kw">or</span> i <span class="op">==</span> <span class="st">&#39;E&#39;</span>:</a>
<a class="sourceLine" id="cb547-13" title="13">            charge <span class="op">-=</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb547-14" title="14">        <span class="cf">else</span>:</a>
<a class="sourceLine" id="cb547-15" title="15">            charge <span class="op">+=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb547-16" title="16"></a>
<a class="sourceLine" id="cb547-17" title="17">    <span class="cf">return</span> charge</a>
<a class="sourceLine" id="cb547-18" title="18"></a>
<a class="sourceLine" id="cb547-19" title="19">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> net_charge(<span class="st">&quot;DSAVRCPQD&quot;</span>) <span class="op">==</span> <span class="dv">-1</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-49">Run 4</h4>
<div class="sourceCode" id="cb549"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb549-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb549-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb549-3" title="3"></a>
<a class="sourceLine" id="cb549-4" title="4"><span class="kw">def</span> net_charge(sequence):</a>
<a class="sourceLine" id="cb549-5" title="5">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb549-6" title="6"><span class="co">    This function returns net charge of amino acid sequence</span></a>
<a class="sourceLine" id="cb549-7" title="7"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb549-8" title="8">    charge <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb549-9" title="9">    <span class="cf">for</span> i <span class="kw">in</span> sequence:</a>
<a class="sourceLine" id="cb549-10" title="10">        <span class="cf">if</span> i <span class="op">==</span> <span class="st">&#39;R&#39;</span> <span class="kw">or</span> i <span class="op">==</span> <span class="st">&#39;K&#39;</span>:</a>
<a class="sourceLine" id="cb549-11" title="11">            charge <span class="op">+=</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb549-12" title="12">        <span class="cf">elif</span> i <span class="op">==</span> <span class="st">&#39;D&#39;</span> <span class="kw">or</span> i <span class="op">==</span> <span class="st">&#39;E&#39;</span>:</a>
<a class="sourceLine" id="cb549-13" title="13">            charge <span class="op">-=</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb549-14" title="14">        <span class="cf">else</span>:</a>
<a class="sourceLine" id="cb549-15" title="15">            charge <span class="op">+=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb549-16" title="16">    <span class="cf">return</span> charge</a>
<a class="sourceLine" id="cb549-17" title="17"></a>
<a class="sourceLine" id="cb549-18" title="18">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> net_charge(<span class="st">&quot;DSAVRCPQD&quot;</span>) <span class="op">==</span> <span class="dv">-1</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>solve_ode</summary></p>
<h4 id="query-50">Query</h4>
<div class="sourceCode" id="cb551"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb551-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb551-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb551-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb551-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb551-5" title="5"></a>
<a class="sourceLine" id="cb551-6" title="6"><span class="kw">def</span> solve_ode(fn, t, y0):</a>
<a class="sourceLine" id="cb551-7" title="7">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb551-8" title="8"><span class="co">    Solve an initial value problem for system of Ordinary Differential Equations using the Explicit Runge-Kutta method of order 5. t is a 1D vector and dy/dt=fn(t,y). Returns the values of the solution y at t.</span></a>
<a class="sourceLine" id="cb551-9" title="9"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb551-10" title="10">    [insert]</a>
<a class="sourceLine" id="cb551-11" title="11">    <span class="cf">return</span> sol</a></code></pre></div>
<h4 id="run-0-50">Run 0</h4>
<div class="sourceCode" id="cb552"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb552-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb552-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb552-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb552-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb552-5" title="5"></a>
<a class="sourceLine" id="cb552-6" title="6"><span class="kw">def</span> solve_ode(fn, t, y0):</a>
<a class="sourceLine" id="cb552-7" title="7">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb552-8" title="8"><span class="co">    Solve an initial value problem for system of Ordinary Differential Equations using the Explicit Runge-Kutta method of order 5. t is a 1D vector and dy/dt=fn(t,y). Returns the values of the solution y at t.</span></a>
<a class="sourceLine" id="cb552-9" title="9"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb552-10" title="10">    n <span class="op">=</span> <span class="bu">len</span>(t)</a>
<a class="sourceLine" id="cb552-11" title="11">    y <span class="op">=</span> np.zeros((n, <span class="bu">len</span>(y0)))</a>
<a class="sourceLine" id="cb552-12" title="12">    y[<span class="dv">0</span>] <span class="op">=</span> y0</a>
<a class="sourceLine" id="cb552-13" title="13">    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n<span class="dv">-1</span>):</a>
<a class="sourceLine" id="cb552-14" title="14">        h <span class="op">=</span> t[i<span class="op">+</span><span class="dv">1</span>] <span class="op">-</span> t[i]</a>
<a class="sourceLine" id="cb552-15" title="15">        k1 <span class="op">=</span> fn(t[i], y[i])</a>
<a class="sourceLine" id="cb552-16" title="16">        k2 <span class="op">=</span> fn(t[i] <span class="op">+</span> h<span class="op">/</span><span class="dv">4</span>, y[i] <span class="op">+</span> h<span class="op">*</span>k1<span class="op">/</span><span class="dv">4</span>)</a>
<a class="sourceLine" id="cb552-17" title="17">        k3 <span class="op">=</span> fn(t[i] <span class="op">+</span> <span class="dv">3</span><span class="op">*</span>h<span class="op">/</span><span class="dv">8</span>, y[i] <span class="op">+</span> <span class="dv">3</span><span class="op">*</span>h<span class="op">*</span>k1<span class="op">/</span><span class="dv">32</span> <span class="op">+</span> <span class="dv">9</span><span class="op">*</span>h<span class="op">*</span>k2<span class="op">/</span><span class="dv">32</span>)</a>
<a class="sourceLine" id="cb552-18" title="18">        k4 <span class="op">=</span> fn(t[i] <span class="op">+</span> <span class="dv">12</span><span class="op">*</span>h<span class="op">/</span><span class="dv">13</span>, y[i] <span class="op">+</span> <span class="dv">1932</span><span class="op">*</span>h<span class="op">*</span>k1<span class="op">/</span><span class="dv">2197</span> <span class="op">-</span> <span class="dv">7200</span><span class="op">*</span>h<span class="op">*</span>k2<span class="op">/</span><span class="dv">2197</span> <span class="op">+</span> <span class="dv">7296</span><span class="op">*</span>h<span class="op">*</span>k3<span class="op">/</span><span class="dv">2197</span>)</a>
<a class="sourceLine" id="cb552-19" title="19">        k5 <span class="op">=</span> fn(t[i] <span class="op">+</span> h, y[i] <span class="op">+</span> <span class="dv">439</span><span class="op">*</span>h<span class="op">*</span>k1<span class="op">/</span><span class="dv">216</span> <span class="op">-</span> <span class="dv">8</span><span class="op">*</span>h<span class="op">*</span>k2 <span class="op">+</span> <span class="dv">3680</span><span class="op">*</span>h<span class="op">*</span>k3<span class="op">/</span><span class="dv">513</span> <span class="op">-</span> <span class="dv">845</span><span class="op">*</span>h<span class="op">*</span>k4<span class="op">/</span><span class="dv">4104</span>)</a>
<a class="sourceLine" id="cb552-20" title="20">        k6 <span class="op">=</span> fn(t[i] <span class="op">+</span> h<span class="op">/</span><span class="dv">2</span>, y[i] <span class="op">-</span> <span class="dv">8</span><span class="op">*</span>h<span class="op">*</span>k1<span class="op">/</span><span class="dv">27</span> <span class="op">+</span> <span class="dv">2</span><span class="op">*</span>h<span class="op">*</span>k2 <span class="op">-</span> <span class="dv">3544</span><span class="op">*</span>h<span class="op">*</span>k3<span class="op">/</span><span class="dv">2565</span> <span class="op">+</span> <span class="dv">1859</span><span class="op">*</span>h<span class="op">*</span>k4<span class="op">/</span><span class="dv">4104</span> <span class="op">-</span> <span class="dv">11</span><span class="op">*</span>h<span class="op">*</span>k5<span class="op">/</span><span class="dv">40</span>)</a>
<a class="sourceLine" id="cb552-21" title="21">        y[i<span class="op">+</span><span class="dv">1</span>] <span class="op">=</span> y[i] <span class="op">+</span> h<span class="op">*</span>(<span class="dv">25</span><span class="op">*</span>k1<span class="op">/</span><span class="dv">216</span> <span class="op">+</span> <span class="dv">1408</span><span class="op">*</span>k3<span class="op">/</span><span class="dv">2565</span> <span class="op">+</span> <span class="dv">2197</span><span class="op">*</span>k4<span class="op">/</span><span class="dv">4104</span> <span class="op">-</span> k5<span class="op">/</span><span class="dv">5</span>)</a>
<a class="sourceLine" id="cb552-22" title="22">    <span class="cf">return</span> y</a>
<a class="sourceLine" id="cb552-23" title="23"></a>
<a class="sourceLine" id="cb552-24" title="24"></a>
<a class="sourceLine" id="cb552-25" title="25">    <span class="cf">return</span> sol</a>
<a class="sourceLine" id="cb552-26" title="26"><span class="im">from</span> scipy.integrate <span class="im">import</span> solve_ivp</a>
<a class="sourceLine" id="cb552-27" title="27"><span class="kw">def</span> exponential_decay(t, y): </a>
<a class="sourceLine" id="cb552-28" title="28">    <span class="cf">return</span> <span class="fl">-0.5</span> <span class="op">*</span> y</a>
<a class="sourceLine" id="cb552-29" title="29">solution <span class="op">=</span> solve_ivp(exponential_decay, [<span class="dv">0</span>, <span class="dv">10</span>], [<span class="dv">4</span>], t_eval<span class="op">=</span>[<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">8</span>])</a>
<a class="sourceLine" id="cb552-30" title="30"></a>
<a class="sourceLine" id="cb552-31" title="31">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.allclose(solution, solve_ode(exponential_decay, [<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">8</span>], [<span class="dv">4</span>])) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>ufunc &#39;isfinite&#39; not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule &#39;&#39;safe&#39;&#39;</code></pre>
<h4 id="run-1-50">Run 1</h4>
<div class="sourceCode" id="cb554"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb554-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb554-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb554-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb554-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb554-5" title="5"></a>
<a class="sourceLine" id="cb554-6" title="6"><span class="kw">def</span> solve_ode(fn, t, y0):</a>
<a class="sourceLine" id="cb554-7" title="7">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb554-8" title="8"><span class="co">    Solve an initial value problem for system of Ordinary Differential Equations using the Explicit Runge-Kutta method of order 5. t is a 1D vector and dy/dt=fn(t,y). Returns the values of the solution y at t.</span></a>
<a class="sourceLine" id="cb554-9" title="9"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb554-10" title="10">    n <span class="op">=</span> <span class="bu">len</span>(t)</a>
<a class="sourceLine" id="cb554-11" title="11">    y <span class="op">=</span> np.zeros((n, <span class="bu">len</span>(y0)))</a>
<a class="sourceLine" id="cb554-12" title="12">    y[<span class="dv">0</span>,:] <span class="op">=</span> y0</a>
<a class="sourceLine" id="cb554-13" title="13">    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n<span class="dv">-1</span>):</a>
<a class="sourceLine" id="cb554-14" title="14">        h <span class="op">=</span> t[i<span class="op">+</span><span class="dv">1</span>] <span class="op">-</span> t[i]</a>
<a class="sourceLine" id="cb554-15" title="15">        k1 <span class="op">=</span> fn(t[i], y[i,:])</a>
<a class="sourceLine" id="cb554-16" title="16">        k2 <span class="op">=</span> fn(t[i] <span class="op">+</span> h<span class="op">/</span><span class="dv">4</span>, y[i,:] <span class="op">+</span> h<span class="op">*</span>k1<span class="op">/</span><span class="dv">4</span>)</a>
<a class="sourceLine" id="cb554-17" title="17">        k3 <span class="op">=</span> fn(t[i] <span class="op">+</span> <span class="dv">3</span><span class="op">*</span>h<span class="op">/</span><span class="dv">8</span>, y[i,:] <span class="op">+</span> <span class="dv">3</span><span class="op">*</span>h<span class="op">*</span>k1<span class="op">/</span><span class="dv">32</span> <span class="op">+</span> <span class="dv">9</span><span class="op">*</span>h<span class="op">*</span>k2<span class="op">/</span><span class="dv">32</span>)</a>
<a class="sourceLine" id="cb554-18" title="18">        k4 <span class="op">=</span> fn(t[i] <span class="op">+</span> <span class="dv">12</span><span class="op">*</span>h<span class="op">/</span><span class="dv">13</span>, y[i,:] <span class="op">+</span> <span class="dv">1932</span><span class="op">*</span>h<span class="op">*</span>k1<span class="op">/</span><span class="dv">2197</span> <span class="op">-</span> <span class="dv">7200</span><span class="op">*</span>h<span class="op">*</span>k2<span class="op">/</span><span class="dv">2197</span> <span class="op">+</span> <span class="dv">7296</span><span class="op">*</span>h<span class="op">*</span>k3<span class="op">/</span><span class="dv">2197</span>)</a>
<a class="sourceLine" id="cb554-19" title="19">        k5 <span class="op">=</span> fn(t[i] <span class="op">+</span> h, y[i,:] <span class="op">+</span> <span class="dv">439</span><span class="op">*</span>h<span class="op">*</span>k1<span class="op">/</span><span class="dv">216</span> <span class="op">-</span> <span class="dv">8</span><span class="op">*</span>h<span class="op">*</span>k2 <span class="op">+</span> <span class="dv">3680</span><span class="op">*</span>h<span class="op">*</span>k3<span class="op">/</span><span class="dv">513</span> <span class="op">-</span> <span class="dv">845</span><span class="op">*</span>h<span class="op">*</span>k4<span class="op">/</span><span class="dv">4104</span>)</a>
<a class="sourceLine" id="cb554-20" title="20">        k6 <span class="op">=</span> fn(t[i] <span class="op">+</span> h<span class="op">/</span><span class="dv">2</span>, y[i,:] <span class="op">-</span> <span class="dv">8</span><span class="op">*</span>h<span class="op">*</span>k1<span class="op">/</span><span class="dv">27</span> <span class="op">+</span> <span class="dv">2</span><span class="op">*</span>h<span class="op">*</span>k2 <span class="op">-</span> <span class="dv">3544</span><span class="op">*</span>h<span class="op">*</span>k3<span class="op">/</span><span class="dv">2565</span> <span class="op">+</span> <span class="dv">1859</span><span class="op">*</span>h<span class="op">*</span>k4<span class="op">/</span><span class="dv">4104</span> <span class="op">-</span> <span class="dv">11</span><span class="op">*</span>h<span class="op">*</span>k5<span class="op">/</span><span class="dv">40</span>)</a>
<a class="sourceLine" id="cb554-21" title="21">        y[i<span class="op">+</span><span class="dv">1</span>,:] <span class="op">=</span> y[i,:] <span class="op">+</span> h<span class="op">*</span>(<span class="dv">25</span><span class="op">*</span>k1<span class="op">/</span><span class="dv">216</span> <span class="op">+</span> <span class="dv">1408</span><span class="op">*</span>k3<span class="op">/</span><span class="dv">2565</span> <span class="op">+</span> <span class="dv">2197</span><span class="op">*</span>k4<span class="op">/</span><span class="dv">4104</span> <span class="op">-</span> k5<span class="op">/</span><span class="dv">5</span>)</a>
<a class="sourceLine" id="cb554-22" title="22">    <span class="cf">return</span> y</a>
<a class="sourceLine" id="cb554-23" title="23"></a>
<a class="sourceLine" id="cb554-24" title="24"></a>
<a class="sourceLine" id="cb554-25" title="25">    <span class="cf">return</span> sol</a>
<a class="sourceLine" id="cb554-26" title="26"><span class="im">from</span> scipy.integrate <span class="im">import</span> solve_ivp</a>
<a class="sourceLine" id="cb554-27" title="27"><span class="kw">def</span> exponential_decay(t, y): </a>
<a class="sourceLine" id="cb554-28" title="28">    <span class="cf">return</span> <span class="fl">-0.5</span> <span class="op">*</span> y</a>
<a class="sourceLine" id="cb554-29" title="29">solution <span class="op">=</span> solve_ivp(exponential_decay, [<span class="dv">0</span>, <span class="dv">10</span>], [<span class="dv">4</span>], t_eval<span class="op">=</span>[<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">8</span>])</a>
<a class="sourceLine" id="cb554-30" title="30"></a>
<a class="sourceLine" id="cb554-31" title="31">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.allclose(solution, solve_ode(exponential_decay, [<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">8</span>], [<span class="dv">4</span>])) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>ufunc &#39;isfinite&#39; not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule &#39;&#39;safe&#39;&#39;</code></pre>
<h4 id="run-2-50">Run 2</h4>
<div class="sourceCode" id="cb556"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb556-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb556-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb556-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb556-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb556-5" title="5"></a>
<a class="sourceLine" id="cb556-6" title="6"><span class="kw">def</span> solve_ode(fn, t, y0):</a>
<a class="sourceLine" id="cb556-7" title="7">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb556-8" title="8"><span class="co">    Solve an initial value problem for system of Ordinary Differential Equations using the Explicit Runge-Kutta method of order 5. t is a 1D vector and dy/dt=fn(t,y). Returns the values of the solution y at t.</span></a>
<a class="sourceLine" id="cb556-9" title="9"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb556-10" title="10">    sol <span class="op">=</span> np.zeros((<span class="bu">len</span>(t), <span class="bu">len</span>(y0)))</a>
<a class="sourceLine" id="cb556-11" title="11">    sol[<span class="dv">0</span>,:] <span class="op">=</span> y0</a>
<a class="sourceLine" id="cb556-12" title="12">    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(t)<span class="op">-</span><span class="dv">1</span>):</a>
<a class="sourceLine" id="cb556-13" title="13">        h <span class="op">=</span> t[i<span class="op">+</span><span class="dv">1</span>] <span class="op">-</span> t[i]</a>
<a class="sourceLine" id="cb556-14" title="14">        k1 <span class="op">=</span> h <span class="op">*</span> fn(t[i], sol[i,:])</a>
<a class="sourceLine" id="cb556-15" title="15">        k2 <span class="op">=</span> h <span class="op">*</span> fn(t[i] <span class="op">+</span> h<span class="op">/</span><span class="dv">4</span>, sol[i,:] <span class="op">+</span> k1<span class="op">/</span><span class="dv">4</span>)</a>
<a class="sourceLine" id="cb556-16" title="16">        k3 <span class="op">=</span> h <span class="op">*</span> fn(t[i] <span class="op">+</span> <span class="dv">3</span><span class="op">*</span>h<span class="op">/</span><span class="dv">8</span>, sol[i,:] <span class="op">+</span> <span class="dv">3</span><span class="op">*</span>k1<span class="op">/</span><span class="dv">32</span> <span class="op">+</span> <span class="dv">9</span><span class="op">*</span>k2<span class="op">/</span><span class="dv">32</span>)</a>
<a class="sourceLine" id="cb556-17" title="17">        k4 <span class="op">=</span> h <span class="op">*</span> fn(t[i] <span class="op">+</span> <span class="dv">12</span><span class="op">*</span>h<span class="op">/</span><span class="dv">13</span>, sol[i,:] <span class="op">+</span> <span class="dv">1932</span><span class="op">*</span>k1<span class="op">/</span><span class="dv">2197</span> <span class="op">-</span> <span class="dv">7200</span><span class="op">*</span>k2<span class="op">/</span><span class="dv">2197</span> <span class="op">+</span> <span class="dv">7296</span><span class="op">*</span>k3<span class="op">/</span><span class="dv">2197</span>)</a>
<a class="sourceLine" id="cb556-18" title="18">        k5 <span class="op">=</span> h <span class="op">*</span> fn(t[i] <span class="op">+</span> h, sol[i,:] <span class="op">+</span> <span class="dv">439</span><span class="op">*</span>k1<span class="op">/</span><span class="dv">216</span> <span class="op">-</span> <span class="dv">8</span><span class="op">*</span>k2 <span class="op">+</span> <span class="dv">3680</span><span class="op">*</span>k3<span class="op">/</span><span class="dv">513</span> <span class="op">-</span> <span class="dv">845</span><span class="op">*</span>k4<span class="op">/</span><span class="dv">4104</span>)</a>
<a class="sourceLine" id="cb556-19" title="19">        k6 <span class="op">=</span> h <span class="op">*</span> fn(t[i] <span class="op">+</span> h<span class="op">/</span><span class="dv">2</span>, sol[i,:] <span class="op">-</span> <span class="dv">8</span><span class="op">*</span>k1<span class="op">/</span><span class="dv">27</span> <span class="op">+</span> <span class="dv">2</span><span class="op">*</span>k2 <span class="op">-</span> <span class="dv">3544</span><span class="op">*</span>k3<span class="op">/</span><span class="dv">2565</span> <span class="op">+</span> <span class="dv">1859</span><span class="op">*</span>k4<span class="op">/</span><span class="dv">4104</span> <span class="op">-</span> <span class="dv">11</span><span class="op">*</span>k5<span class="op">/</span><span class="dv">40</span>)</a>
<a class="sourceLine" id="cb556-20" title="20">        sol[i<span class="op">+</span><span class="dv">1</span>,:] <span class="op">=</span> sol[i,:] <span class="op">+</span> <span class="dv">25</span><span class="op">*</span>k1<span class="op">/</span><span class="dv">216</span> <span class="op">+</span> <span class="dv">1408</span><span class="op">*</span>k3<span class="op">/</span><span class="dv">2565</span> <span class="op">+</span> <span class="dv">2197</span><span class="op">*</span>k4<span class="op">/</span><span class="dv">4104</span> <span class="op">-</span> k5<span class="op">/</span><span class="dv">5</span></a>
<a class="sourceLine" id="cb556-21" title="21"></a>
<a class="sourceLine" id="cb556-22" title="22">    <span class="cf">return</span> sol</a>
<a class="sourceLine" id="cb556-23" title="23"><span class="im">from</span> scipy.integrate <span class="im">import</span> solve_ivp</a>
<a class="sourceLine" id="cb556-24" title="24"><span class="kw">def</span> exponential_decay(t, y): </a>
<a class="sourceLine" id="cb556-25" title="25">    <span class="cf">return</span> <span class="fl">-0.5</span> <span class="op">*</span> y</a>
<a class="sourceLine" id="cb556-26" title="26">solution <span class="op">=</span> solve_ivp(exponential_decay, [<span class="dv">0</span>, <span class="dv">10</span>], [<span class="dv">4</span>], t_eval<span class="op">=</span>[<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">8</span>])</a>
<a class="sourceLine" id="cb556-27" title="27"></a>
<a class="sourceLine" id="cb556-28" title="28">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.allclose(solution, solve_ode(exponential_decay, [<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">8</span>], [<span class="dv">4</span>])) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>ufunc &#39;isfinite&#39; not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule &#39;&#39;safe&#39;&#39;</code></pre>
<h4 id="run-3-50">Run 3</h4>
<div class="sourceCode" id="cb558"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb558-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb558-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb558-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb558-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb558-5" title="5"></a>
<a class="sourceLine" id="cb558-6" title="6"><span class="kw">def</span> solve_ode(fn, t, y0):</a>
<a class="sourceLine" id="cb558-7" title="7">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb558-8" title="8"><span class="co">    Solve an initial value problem for system of Ordinary Differential Equations using the Explicit Runge-Kutta method of order 5. t is a 1D vector and dy/dt=fn(t,y). Returns the values of the solution y at t.</span></a>
<a class="sourceLine" id="cb558-9" title="9"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb558-10" title="10">    sol <span class="op">=</span> np.zeros((<span class="bu">len</span>(t), <span class="bu">len</span>(y0)))</a>
<a class="sourceLine" id="cb558-11" title="11">    sol[<span class="dv">0</span>] <span class="op">=</span> y0</a>
<a class="sourceLine" id="cb558-12" title="12">    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(t)<span class="op">-</span><span class="dv">1</span>):</a>
<a class="sourceLine" id="cb558-13" title="13">        k1 <span class="op">=</span> fn(t[i], sol[i])</a>
<a class="sourceLine" id="cb558-14" title="14">        k2 <span class="op">=</span> fn(t[i] <span class="op">+</span> t[i<span class="op">+</span><span class="dv">1</span>]<span class="op">/</span><span class="dv">4</span>, sol[i] <span class="op">+</span> t[i<span class="op">+</span><span class="dv">1</span>]<span class="op">/</span><span class="dv">4</span><span class="op">*</span>k1)</a>
<a class="sourceLine" id="cb558-15" title="15">        k3 <span class="op">=</span> fn(t[i] <span class="op">+</span> <span class="dv">3</span><span class="op">*</span>t[i<span class="op">+</span><span class="dv">1</span>]<span class="op">/</span><span class="dv">8</span>, sol[i] <span class="op">+</span> <span class="dv">3</span><span class="op">*</span>t[i<span class="op">+</span><span class="dv">1</span>]<span class="op">/</span><span class="dv">32</span><span class="op">*</span>k1 <span class="op">+</span> <span class="dv">9</span><span class="op">*</span>t[i<span class="op">+</span><span class="dv">1</span>]<span class="op">/</span><span class="dv">32</span><span class="op">*</span>k2)</a>
<a class="sourceLine" id="cb558-16" title="16">        k4 <span class="op">=</span> fn(t[i] <span class="op">+</span> <span class="dv">12</span><span class="op">*</span>t[i<span class="op">+</span><span class="dv">1</span>]<span class="op">/</span><span class="dv">13</span>, sol[i] <span class="op">+</span> <span class="dv">1932</span><span class="op">*</span>t[i<span class="op">+</span><span class="dv">1</span>]<span class="op">/</span><span class="dv">2197</span><span class="op">*</span>k1 <span class="op">-</span> <span class="dv">7200</span><span class="op">*</span>t[i<span class="op">+</span><span class="dv">1</span>]<span class="op">/</span><span class="dv">2197</span><span class="op">*</span>k2 <span class="op">+</span> <span class="dv">7296</span><span class="op">*</span>t[i<span class="op">+</span><span class="dv">1</span>]<span class="op">/</span><span class="dv">2197</span><span class="op">*</span>k3)</a>
<a class="sourceLine" id="cb558-17" title="17">        k5 <span class="op">=</span> fn(t[i] <span class="op">+</span> t[i<span class="op">+</span><span class="dv">1</span>], sol[i] <span class="op">+</span> <span class="dv">439</span><span class="op">*</span>t[i<span class="op">+</span><span class="dv">1</span>]<span class="op">/</span><span class="dv">216</span><span class="op">*</span>k1 <span class="op">-</span> <span class="dv">8</span><span class="op">*</span>t[i<span class="op">+</span><span class="dv">1</span>]<span class="op">*</span>k2 <span class="op">+</span> <span class="dv">3680</span><span class="op">*</span>t[i<span class="op">+</span><span class="dv">1</span>]<span class="op">/</span><span class="dv">513</span><span class="op">*</span>k3 <span class="op">-</span> <span class="dv">845</span><span class="op">*</span>t[i<span class="op">+</span><span class="dv">1</span>]<span class="op">/</span><span class="dv">4104</span><span class="op">*</span>k4)</a>
<a class="sourceLine" id="cb558-18" title="18">        k6 <span class="op">=</span> fn(t[i] <span class="op">+</span> t[i<span class="op">+</span><span class="dv">1</span>]<span class="op">/</span><span class="dv">2</span>, sol[i] <span class="op">-</span> <span class="dv">8</span><span class="op">*</span>t[i<span class="op">+</span><span class="dv">1</span>]<span class="op">/</span><span class="dv">27</span><span class="op">*</span>k1 <span class="op">+</span> <span class="dv">2</span><span class="op">*</span>t[i<span class="op">+</span><span class="dv">1</span>]<span class="op">*</span>k2 <span class="op">-</span> <span class="dv">3544</span><span class="op">*</span>t[i<span class="op">+</span><span class="dv">1</span>]<span class="op">/</span><span class="dv">2565</span><span class="op">*</span>k3 <span class="op">+</span> <span class="dv">1859</span><span class="op">*</span>t[i<span class="op">+</span><span class="dv">1</span>]<span class="op">/</span><span class="dv">4104</span><span class="op">*</span>k4 <span class="op">-</span> <span class="dv">11</span><span class="op">*</span>t[i<span class="op">+</span><span class="dv">1</span>]<span class="op">/</span><span class="dv">40</span><span class="op">*</span>k5)</a>
<a class="sourceLine" id="cb558-19" title="19">        sol[i<span class="op">+</span><span class="dv">1</span>] <span class="op">=</span> sol[i] <span class="op">+</span> t[i<span class="op">+</span><span class="dv">1</span>]<span class="op">/</span><span class="dv">360</span><span class="op">*</span>(<span class="dv">16</span><span class="op">*</span>k1<span class="op">/</span><span class="dv">135</span> <span class="op">+</span> <span class="dv">6656</span><span class="op">*</span>k3<span class="op">/</span><span class="dv">12825</span> <span class="op">+</span> <span class="dv">28561</span><span class="op">*</span>k4<span class="op">/</span><span class="dv">56430</span> <span class="op">-</span> <span class="dv">9</span><span class="op">*</span>k5<span class="op">/</span><span class="dv">50</span> <span class="op">+</span> <span class="dv">2</span><span class="op">*</span>k6<span class="op">/</span><span class="dv">55</span>)</a>
<a class="sourceLine" id="cb558-20" title="20">    <span class="cf">return</span> sol</a>
<a class="sourceLine" id="cb558-21" title="21"><span class="im">from</span> scipy.integrate <span class="im">import</span> solve_ivp</a>
<a class="sourceLine" id="cb558-22" title="22"><span class="kw">def</span> exponential_decay(t, y): </a>
<a class="sourceLine" id="cb558-23" title="23">    <span class="cf">return</span> <span class="fl">-0.5</span> <span class="op">*</span> y</a>
<a class="sourceLine" id="cb558-24" title="24">solution <span class="op">=</span> solve_ivp(exponential_decay, [<span class="dv">0</span>, <span class="dv">10</span>], [<span class="dv">4</span>], t_eval<span class="op">=</span>[<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">8</span>])</a>
<a class="sourceLine" id="cb558-25" title="25"></a>
<a class="sourceLine" id="cb558-26" title="26">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.allclose(solution, solve_ode(exponential_decay, [<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">8</span>], [<span class="dv">4</span>])) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>ufunc &#39;isfinite&#39; not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule &#39;&#39;safe&#39;&#39;</code></pre>
<h4 id="run-4-50">Run 4</h4>
<div class="sourceCode" id="cb560"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb560-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb560-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb560-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb560-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb560-5" title="5"></a>
<a class="sourceLine" id="cb560-6" title="6"><span class="kw">def</span> solve_ode(fn, t, y0):</a>
<a class="sourceLine" id="cb560-7" title="7">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb560-8" title="8"><span class="co">    Solve an initial value problem for system of Ordinary Differential Equations using the Explicit Runge-Kutta method of order 5. t is a 1D vector and dy/dt=fn(t,y). Returns the values of the solution y at t.</span></a>
<a class="sourceLine" id="cb560-9" title="9"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb560-10" title="10">    n <span class="op">=</span> <span class="bu">len</span>(t)</a>
<a class="sourceLine" id="cb560-11" title="11">    y <span class="op">=</span> np.zeros((n, <span class="bu">len</span>(y0)))</a>
<a class="sourceLine" id="cb560-12" title="12">    y[<span class="dv">0</span>] <span class="op">=</span> y0</a>
<a class="sourceLine" id="cb560-13" title="13">    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n<span class="dv">-1</span>):</a>
<a class="sourceLine" id="cb560-14" title="14">        h <span class="op">=</span> t[i<span class="op">+</span><span class="dv">1</span>] <span class="op">-</span> t[i]</a>
<a class="sourceLine" id="cb560-15" title="15">        k1 <span class="op">=</span> h <span class="op">*</span> fn(t[i], y[i])</a>
<a class="sourceLine" id="cb560-16" title="16">        k2 <span class="op">=</span> h <span class="op">*</span> fn(t[i] <span class="op">+</span> h<span class="op">/</span><span class="dv">4</span>, y[i] <span class="op">+</span> k1<span class="op">/</span><span class="dv">4</span>)</a>
<a class="sourceLine" id="cb560-17" title="17">        k3 <span class="op">=</span> h <span class="op">*</span> fn(t[i] <span class="op">+</span> <span class="dv">3</span><span class="op">*</span>h<span class="op">/</span><span class="dv">8</span>, y[i] <span class="op">+</span> <span class="dv">3</span><span class="op">*</span>k1<span class="op">/</span><span class="dv">32</span> <span class="op">+</span> <span class="dv">9</span><span class="op">*</span>k2<span class="op">/</span><span class="dv">32</span>)</a>
<a class="sourceLine" id="cb560-18" title="18">        k4 <span class="op">=</span> h <span class="op">*</span> fn(t[i] <span class="op">+</span> <span class="dv">12</span><span class="op">*</span>h<span class="op">/</span><span class="dv">13</span>, y[i] <span class="op">+</span> <span class="dv">1932</span><span class="op">*</span>k1<span class="op">/</span><span class="dv">2197</span> <span class="op">-</span> <span class="dv">7200</span><span class="op">*</span>k2<span class="op">/</span><span class="dv">2197</span> <span class="op">+</span> <span class="dv">7296</span><span class="op">*</span>k3<span class="op">/</span><span class="dv">2197</span>)</a>
<a class="sourceLine" id="cb560-19" title="19">        k5 <span class="op">=</span> h <span class="op">*</span> fn(t[i] <span class="op">+</span> h, y[i] <span class="op">+</span> <span class="dv">439</span><span class="op">*</span>k1<span class="op">/</span><span class="dv">216</span> <span class="op">-</span> <span class="dv">8</span><span class="op">*</span>k2 <span class="op">+</span> <span class="dv">3680</span><span class="op">*</span>k3<span class="op">/</span><span class="dv">513</span> <span class="op">-</span> <span class="dv">845</span><span class="op">*</span>k4<span class="op">/</span><span class="dv">4104</span>)</a>
<a class="sourceLine" id="cb560-20" title="20">        k6 <span class="op">=</span> h <span class="op">*</span> fn(t[i] <span class="op">+</span> h<span class="op">/</span><span class="dv">2</span>, y[i] <span class="op">-</span> <span class="dv">8</span><span class="op">*</span>k1<span class="op">/</span><span class="dv">27</span> <span class="op">+</span> <span class="dv">2</span><span class="op">*</span>k2 <span class="op">-</span> <span class="dv">3544</span><span class="op">*</span>k3<span class="op">/</span><span class="dv">2565</span> <span class="op">+</span> <span class="dv">1859</span><span class="op">*</span>k4<span class="op">/</span><span class="dv">4104</span> <span class="op">-</span> <span class="dv">11</span><span class="op">*</span>k5<span class="op">/</span><span class="dv">40</span>)</a>
<a class="sourceLine" id="cb560-21" title="21">        y[i<span class="op">+</span><span class="dv">1</span>] <span class="op">=</span> y[i] <span class="op">+</span> <span class="dv">25</span><span class="op">*</span>k1<span class="op">/</span><span class="dv">216</span> <span class="op">+</span> <span class="dv">1408</span><span class="op">*</span>k3<span class="op">/</span><span class="dv">2565</span> <span class="op">+</span> <span class="dv">2197</span><span class="op">*</span>k4<span class="op">/</span><span class="dv">4104</span> <span class="op">-</span> k5<span class="op">/</span><span class="dv">5</span></a>
<a class="sourceLine" id="cb560-22" title="22">    <span class="cf">return</span> y</a>
<a class="sourceLine" id="cb560-23" title="23"></a>
<a class="sourceLine" id="cb560-24" title="24"></a>
<a class="sourceLine" id="cb560-25" title="25">    <span class="cf">return</span> sol</a>
<a class="sourceLine" id="cb560-26" title="26"><span class="im">from</span> scipy.integrate <span class="im">import</span> solve_ivp</a>
<a class="sourceLine" id="cb560-27" title="27"><span class="kw">def</span> exponential_decay(t, y): </a>
<a class="sourceLine" id="cb560-28" title="28">    <span class="cf">return</span> <span class="fl">-0.5</span> <span class="op">*</span> y</a>
<a class="sourceLine" id="cb560-29" title="29">solution <span class="op">=</span> solve_ivp(exponential_decay, [<span class="dv">0</span>, <span class="dv">10</span>], [<span class="dv">4</span>], t_eval<span class="op">=</span>[<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">8</span>])</a>
<a class="sourceLine" id="cb560-30" title="30"></a>
<a class="sourceLine" id="cb560-31" title="31">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.allclose(solution, solve_ode(exponential_decay, [<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">8</span>], [<span class="dv">4</span>])) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>ufunc &#39;isfinite&#39; not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule &#39;&#39;safe&#39;&#39;</code></pre>
</details>
<details>
<p><summary>ohe</summary></p>
<h4 id="query-51">Query</h4>
<div class="sourceCode" id="cb562"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb562-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb562-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb562-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb562-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb562-5" title="5"></a>
<a class="sourceLine" id="cb562-6" title="6"><span class="kw">def</span> ohe(a):</a>
<a class="sourceLine" id="cb562-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb562-8" title="8"><span class="co">  This function generates one-hot encodings for</span></a>
<a class="sourceLine" id="cb562-9" title="9"><span class="co">  the class names in the given list of strings.</span></a>
<a class="sourceLine" id="cb562-10" title="10"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb562-11" title="11">  [insert]</a>
<a class="sourceLine" id="cb562-12" title="12">  <span class="cf">return</span> v</a></code></pre></div>
<h4 id="run-0-51">Run 0</h4>
<div class="sourceCode" id="cb563"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb563-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb563-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb563-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb563-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb563-5" title="5"></a>
<a class="sourceLine" id="cb563-6" title="6"><span class="kw">def</span> ohe(a):</a>
<a class="sourceLine" id="cb563-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb563-8" title="8"><span class="co">  This function generates one-hot encodings for</span></a>
<a class="sourceLine" id="cb563-9" title="9"><span class="co">  the class names in the given list of strings.</span></a>
<a class="sourceLine" id="cb563-10" title="10"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb563-11" title="11">  v <span class="op">=</span> np.zeros((<span class="bu">len</span>(a), <span class="bu">len</span>(<span class="bu">set</span>(a))))</a>
<a class="sourceLine" id="cb563-12" title="12">  <span class="cf">for</span> i, k <span class="kw">in</span> <span class="bu">enumerate</span>(a):</a>
<a class="sourceLine" id="cb563-13" title="13">    v[i, k] <span class="op">=</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb563-14" title="14">  <span class="cf">return</span> v</a>
<a class="sourceLine" id="cb563-15" title="15"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb563-16" title="16"></a>
<a class="sourceLine" id="cb563-17" title="17">dog_breeds <span class="op">=</span> [<span class="st">&#39;German Shepherd&#39;</span>, <span class="st">&#39;Husky&#39;</span>,</a>
<a class="sourceLine" id="cb563-18" title="18">              <span class="st">&#39;Bulldog&#39;</span>, <span class="st">&#39;Dobermann&#39;</span>, <span class="st">&#39;Great Dane&#39;</span>, <span class="st">&#39;Husky&#39;</span>, <span class="st">&#39;Bulldog&#39;</span>, <span class="st">&#39;German Shepherd&#39;</span>, <span class="st">&#39;Great Dane&#39;</span>, <span class="st">&#39;German Shepherd&#39;</span>]</a>
<a class="sourceLine" id="cb563-19" title="19"></a>
<a class="sourceLine" id="cb563-20" title="20">unique_list <span class="op">=</span> <span class="bu">sorted</span>(<span class="bu">list</span>(<span class="bu">set</span>(dog_breeds)))</a>
<a class="sourceLine" id="cb563-21" title="21">n <span class="op">=</span> <span class="bu">len</span>(dog_breeds)</a>
<a class="sourceLine" id="cb563-22" title="22">m <span class="op">=</span> <span class="bu">len</span>(unique_list)</a>
<a class="sourceLine" id="cb563-23" title="23">ohe_array <span class="op">=</span> np.zeros((n, m))</a>
<a class="sourceLine" id="cb563-24" title="24">j <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb563-25" title="25"><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n):</a>
<a class="sourceLine" id="cb563-26" title="26">        ohe_array[j, unique_list.index(dog_breeds[i])] <span class="op">=</span> <span class="fl">1.</span></a>
<a class="sourceLine" id="cb563-27" title="27">        j <span class="op">+=</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb563-28" title="28"></a>
<a class="sourceLine" id="cb563-29" title="29">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(ohe(dog_breeds), ohe_array).<span class="bu">all</span>() <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>only integers, slices (`:`), ellipsis (`...`), numpy.newaxis (`None`) and integer or boolean arrays are valid indices</code></pre>
<h4 id="run-1-51">Run 1</h4>
<div class="sourceCode" id="cb565"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb565-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb565-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb565-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb565-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb565-5" title="5"></a>
<a class="sourceLine" id="cb565-6" title="6"><span class="kw">def</span> ohe(a):</a>
<a class="sourceLine" id="cb565-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb565-8" title="8"><span class="co">  This function generates one-hot encodings for</span></a>
<a class="sourceLine" id="cb565-9" title="9"><span class="co">  the class names in the given list of strings.</span></a>
<a class="sourceLine" id="cb565-10" title="10"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb565-11" title="11">  v <span class="op">=</span> np.zeros((<span class="bu">len</span>(a), <span class="bu">len</span>(<span class="bu">set</span>(a))))</a>
<a class="sourceLine" id="cb565-12" title="12">  <span class="cf">for</span> i, x <span class="kw">in</span> <span class="bu">enumerate</span>(a):</a>
<a class="sourceLine" id="cb565-13" title="13">    v[i, x] <span class="op">=</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb565-14" title="14"></a>
<a class="sourceLine" id="cb565-15" title="15">  <span class="cf">return</span> v</a>
<a class="sourceLine" id="cb565-16" title="16"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb565-17" title="17"></a>
<a class="sourceLine" id="cb565-18" title="18">dog_breeds <span class="op">=</span> [<span class="st">&#39;German Shepherd&#39;</span>, <span class="st">&#39;Husky&#39;</span>,</a>
<a class="sourceLine" id="cb565-19" title="19">              <span class="st">&#39;Bulldog&#39;</span>, <span class="st">&#39;Dobermann&#39;</span>, <span class="st">&#39;Great Dane&#39;</span>, <span class="st">&#39;Husky&#39;</span>, <span class="st">&#39;Bulldog&#39;</span>, <span class="st">&#39;German Shepherd&#39;</span>, <span class="st">&#39;Great Dane&#39;</span>, <span class="st">&#39;German Shepherd&#39;</span>]</a>
<a class="sourceLine" id="cb565-20" title="20"></a>
<a class="sourceLine" id="cb565-21" title="21">unique_list <span class="op">=</span> <span class="bu">sorted</span>(<span class="bu">list</span>(<span class="bu">set</span>(dog_breeds)))</a>
<a class="sourceLine" id="cb565-22" title="22">n <span class="op">=</span> <span class="bu">len</span>(dog_breeds)</a>
<a class="sourceLine" id="cb565-23" title="23">m <span class="op">=</span> <span class="bu">len</span>(unique_list)</a>
<a class="sourceLine" id="cb565-24" title="24">ohe_array <span class="op">=</span> np.zeros((n, m))</a>
<a class="sourceLine" id="cb565-25" title="25">j <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb565-26" title="26"><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n):</a>
<a class="sourceLine" id="cb565-27" title="27">        ohe_array[j, unique_list.index(dog_breeds[i])] <span class="op">=</span> <span class="fl">1.</span></a>
<a class="sourceLine" id="cb565-28" title="28">        j <span class="op">+=</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb565-29" title="29"></a>
<a class="sourceLine" id="cb565-30" title="30">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(ohe(dog_breeds), ohe_array).<span class="bu">all</span>() <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>only integers, slices (`:`), ellipsis (`...`), numpy.newaxis (`None`) and integer or boolean arrays are valid indices</code></pre>
<h4 id="run-2-51">Run 2</h4>
<div class="sourceCode" id="cb567"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb567-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb567-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb567-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb567-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb567-5" title="5"></a>
<a class="sourceLine" id="cb567-6" title="6"><span class="kw">def</span> ohe(a):</a>
<a class="sourceLine" id="cb567-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb567-8" title="8"><span class="co">  This function generates one-hot encodings for</span></a>
<a class="sourceLine" id="cb567-9" title="9"><span class="co">  the class names in the given list of strings.</span></a>
<a class="sourceLine" id="cb567-10" title="10"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb567-11" title="11">  v <span class="op">=</span> np.zeros((<span class="bu">len</span>(a), <span class="bu">len</span>(<span class="bu">set</span>(a))))</a>
<a class="sourceLine" id="cb567-12" title="12">  <span class="cf">for</span> i, val <span class="kw">in</span> <span class="bu">enumerate</span>(a):</a>
<a class="sourceLine" id="cb567-13" title="13">    v[i, val] <span class="op">=</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb567-14" title="14">  <span class="cf">return</span> v</a>
<a class="sourceLine" id="cb567-15" title="15"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb567-16" title="16"></a>
<a class="sourceLine" id="cb567-17" title="17">dog_breeds <span class="op">=</span> [<span class="st">&#39;German Shepherd&#39;</span>, <span class="st">&#39;Husky&#39;</span>,</a>
<a class="sourceLine" id="cb567-18" title="18">              <span class="st">&#39;Bulldog&#39;</span>, <span class="st">&#39;Dobermann&#39;</span>, <span class="st">&#39;Great Dane&#39;</span>, <span class="st">&#39;Husky&#39;</span>, <span class="st">&#39;Bulldog&#39;</span>, <span class="st">&#39;German Shepherd&#39;</span>, <span class="st">&#39;Great Dane&#39;</span>, <span class="st">&#39;German Shepherd&#39;</span>]</a>
<a class="sourceLine" id="cb567-19" title="19"></a>
<a class="sourceLine" id="cb567-20" title="20">unique_list <span class="op">=</span> <span class="bu">sorted</span>(<span class="bu">list</span>(<span class="bu">set</span>(dog_breeds)))</a>
<a class="sourceLine" id="cb567-21" title="21">n <span class="op">=</span> <span class="bu">len</span>(dog_breeds)</a>
<a class="sourceLine" id="cb567-22" title="22">m <span class="op">=</span> <span class="bu">len</span>(unique_list)</a>
<a class="sourceLine" id="cb567-23" title="23">ohe_array <span class="op">=</span> np.zeros((n, m))</a>
<a class="sourceLine" id="cb567-24" title="24">j <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb567-25" title="25"><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n):</a>
<a class="sourceLine" id="cb567-26" title="26">        ohe_array[j, unique_list.index(dog_breeds[i])] <span class="op">=</span> <span class="fl">1.</span></a>
<a class="sourceLine" id="cb567-27" title="27">        j <span class="op">+=</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb567-28" title="28"></a>
<a class="sourceLine" id="cb567-29" title="29">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(ohe(dog_breeds), ohe_array).<span class="bu">all</span>() <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>only integers, slices (`:`), ellipsis (`...`), numpy.newaxis (`None`) and integer or boolean arrays are valid indices</code></pre>
<h4 id="run-3-51">Run 3</h4>
<div class="sourceCode" id="cb569"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb569-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb569-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb569-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb569-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb569-5" title="5"></a>
<a class="sourceLine" id="cb569-6" title="6"><span class="kw">def</span> ohe(a):</a>
<a class="sourceLine" id="cb569-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb569-8" title="8"><span class="co">  This function generates one-hot encodings for</span></a>
<a class="sourceLine" id="cb569-9" title="9"><span class="co">  the class names in the given list of strings.</span></a>
<a class="sourceLine" id="cb569-10" title="10"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb569-11" title="11">  v <span class="op">=</span> np.zeros((<span class="bu">len</span>(a), <span class="bu">len</span>(<span class="bu">set</span>(a))))</a>
<a class="sourceLine" id="cb569-12" title="12">  <span class="cf">for</span> i, k <span class="kw">in</span> <span class="bu">enumerate</span>(a):</a>
<a class="sourceLine" id="cb569-13" title="13">    v[i, k] <span class="op">=</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb569-14" title="14">  <span class="cf">return</span> v</a>
<a class="sourceLine" id="cb569-15" title="15"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb569-16" title="16"></a>
<a class="sourceLine" id="cb569-17" title="17">dog_breeds <span class="op">=</span> [<span class="st">&#39;German Shepherd&#39;</span>, <span class="st">&#39;Husky&#39;</span>,</a>
<a class="sourceLine" id="cb569-18" title="18">              <span class="st">&#39;Bulldog&#39;</span>, <span class="st">&#39;Dobermann&#39;</span>, <span class="st">&#39;Great Dane&#39;</span>, <span class="st">&#39;Husky&#39;</span>, <span class="st">&#39;Bulldog&#39;</span>, <span class="st">&#39;German Shepherd&#39;</span>, <span class="st">&#39;Great Dane&#39;</span>, <span class="st">&#39;German Shepherd&#39;</span>]</a>
<a class="sourceLine" id="cb569-19" title="19"></a>
<a class="sourceLine" id="cb569-20" title="20">unique_list <span class="op">=</span> <span class="bu">sorted</span>(<span class="bu">list</span>(<span class="bu">set</span>(dog_breeds)))</a>
<a class="sourceLine" id="cb569-21" title="21">n <span class="op">=</span> <span class="bu">len</span>(dog_breeds)</a>
<a class="sourceLine" id="cb569-22" title="22">m <span class="op">=</span> <span class="bu">len</span>(unique_list)</a>
<a class="sourceLine" id="cb569-23" title="23">ohe_array <span class="op">=</span> np.zeros((n, m))</a>
<a class="sourceLine" id="cb569-24" title="24">j <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb569-25" title="25"><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n):</a>
<a class="sourceLine" id="cb569-26" title="26">        ohe_array[j, unique_list.index(dog_breeds[i])] <span class="op">=</span> <span class="fl">1.</span></a>
<a class="sourceLine" id="cb569-27" title="27">        j <span class="op">+=</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb569-28" title="28"></a>
<a class="sourceLine" id="cb569-29" title="29">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(ohe(dog_breeds), ohe_array).<span class="bu">all</span>() <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>only integers, slices (`:`), ellipsis (`...`), numpy.newaxis (`None`) and integer or boolean arrays are valid indices</code></pre>
<h4 id="run-4-51">Run 4</h4>
<div class="sourceCode" id="cb571"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb571-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb571-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb571-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb571-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb571-5" title="5"></a>
<a class="sourceLine" id="cb571-6" title="6"><span class="kw">def</span> ohe(a):</a>
<a class="sourceLine" id="cb571-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb571-8" title="8"><span class="co">  This function generates one-hot encodings for</span></a>
<a class="sourceLine" id="cb571-9" title="9"><span class="co">  the class names in the given list of strings.</span></a>
<a class="sourceLine" id="cb571-10" title="10"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb571-11" title="11">  v <span class="op">=</span> np.zeros((<span class="bu">len</span>(a), <span class="bu">len</span>(<span class="bu">set</span>(a))))</a>
<a class="sourceLine" id="cb571-12" title="12">  <span class="cf">for</span> i, k <span class="kw">in</span> <span class="bu">enumerate</span>(a):</a>
<a class="sourceLine" id="cb571-13" title="13">    v[i, k] <span class="op">=</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb571-14" title="14">  <span class="cf">return</span> v</a>
<a class="sourceLine" id="cb571-15" title="15"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb571-16" title="16"></a>
<a class="sourceLine" id="cb571-17" title="17">dog_breeds <span class="op">=</span> [<span class="st">&#39;German Shepherd&#39;</span>, <span class="st">&#39;Husky&#39;</span>,</a>
<a class="sourceLine" id="cb571-18" title="18">              <span class="st">&#39;Bulldog&#39;</span>, <span class="st">&#39;Dobermann&#39;</span>, <span class="st">&#39;Great Dane&#39;</span>, <span class="st">&#39;Husky&#39;</span>, <span class="st">&#39;Bulldog&#39;</span>, <span class="st">&#39;German Shepherd&#39;</span>, <span class="st">&#39;Great Dane&#39;</span>, <span class="st">&#39;German Shepherd&#39;</span>]</a>
<a class="sourceLine" id="cb571-19" title="19"></a>
<a class="sourceLine" id="cb571-20" title="20">unique_list <span class="op">=</span> <span class="bu">sorted</span>(<span class="bu">list</span>(<span class="bu">set</span>(dog_breeds)))</a>
<a class="sourceLine" id="cb571-21" title="21">n <span class="op">=</span> <span class="bu">len</span>(dog_breeds)</a>
<a class="sourceLine" id="cb571-22" title="22">m <span class="op">=</span> <span class="bu">len</span>(unique_list)</a>
<a class="sourceLine" id="cb571-23" title="23">ohe_array <span class="op">=</span> np.zeros((n, m))</a>
<a class="sourceLine" id="cb571-24" title="24">j <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb571-25" title="25"><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n):</a>
<a class="sourceLine" id="cb571-26" title="26">        ohe_array[j, unique_list.index(dog_breeds[i])] <span class="op">=</span> <span class="fl">1.</span></a>
<a class="sourceLine" id="cb571-27" title="27">        j <span class="op">+=</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb571-28" title="28"></a>
<a class="sourceLine" id="cb571-29" title="29">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(ohe(dog_breeds), ohe_array).<span class="bu">all</span>() <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>only integers, slices (`:`), ellipsis (`...`), numpy.newaxis (`None`) and integer or boolean arrays are valid indices</code></pre>
</details>
<details>
<p><summary>osmotic_pressure</summary></p>
<h4 id="query-52">Query</h4>
<div class="sourceCode" id="cb573"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb573-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb573-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb573-3" title="3"></a>
<a class="sourceLine" id="cb573-4" title="4"><span class="kw">def</span> osmotic_pressure_concentration(Pi,T):</a>
<a class="sourceLine" id="cb573-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb573-6" title="6"><span class="co">   This function returns the concentration in mol/l given an osmotic pressure Pi and temperature T</span></a>
<a class="sourceLine" id="cb573-7" title="7"><span class="co">   T is in K</span></a>
<a class="sourceLine" id="cb573-8" title="8"><span class="co">   Pi is in atm</span></a>
<a class="sourceLine" id="cb573-9" title="9"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb573-10" title="10">   R <span class="op">=</span> <span class="fl">0.08206</span> <span class="co"># l atm /K /mol</span></a>
<a class="sourceLine" id="cb573-11" title="11">   [insert]</a>
<a class="sourceLine" id="cb573-12" title="12">   <span class="cf">return</span> p</a></code></pre></div>
<h4 id="run-0-52">Run 0</h4>
<div class="sourceCode" id="cb574"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb574-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb574-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb574-3" title="3"></a>
<a class="sourceLine" id="cb574-4" title="4"><span class="kw">def</span> osmotic_pressure_concentration(Pi,T):</a>
<a class="sourceLine" id="cb574-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb574-6" title="6"><span class="co">   This function returns the concentration in mol/l given an osmotic pressure Pi and temperature T</span></a>
<a class="sourceLine" id="cb574-7" title="7"><span class="co">   T is in K</span></a>
<a class="sourceLine" id="cb574-8" title="8"><span class="co">   Pi is in atm</span></a>
<a class="sourceLine" id="cb574-9" title="9"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb574-10" title="10">   R <span class="op">=</span> <span class="fl">0.08206</span> <span class="co"># l atm /K /mol</span></a>
<a class="sourceLine" id="cb574-11" title="11">   p <span class="op">=</span> Pi<span class="op">/</span>(R<span class="op">*</span>T)</a>
<a class="sourceLine" id="cb574-12" title="12">   <span class="cf">return</span> p</a>
<a class="sourceLine" id="cb574-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb574-14" title="14">pressure <span class="op">=</span> <span class="fl">0.02</span> <span class="co">#atm</span></a>
<a class="sourceLine" id="cb574-15" title="15">temperature <span class="op">=</span> <span class="dv">310</span> <span class="co">#K </span></a>
<a class="sourceLine" id="cb574-16" title="16">c <span class="op">=</span> pressure<span class="op">/</span>(<span class="fl">0.08206</span><span class="op">*</span>temperature)</a>
<a class="sourceLine" id="cb574-17" title="17">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">abs</span>(osmotic_pressure_concentration(pressure,temperature)<span class="op">-</span>c)<span class="op">&lt;</span><span class="fl">0.01</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-52">Run 1</h4>
<div class="sourceCode" id="cb576"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb576-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb576-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb576-3" title="3"></a>
<a class="sourceLine" id="cb576-4" title="4"><span class="kw">def</span> osmotic_pressure_concentration(Pi,T):</a>
<a class="sourceLine" id="cb576-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb576-6" title="6"><span class="co">   This function returns the concentration in mol/l given an osmotic pressure Pi and temperature T</span></a>
<a class="sourceLine" id="cb576-7" title="7"><span class="co">   T is in K</span></a>
<a class="sourceLine" id="cb576-8" title="8"><span class="co">   Pi is in atm</span></a>
<a class="sourceLine" id="cb576-9" title="9"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb576-10" title="10">   R <span class="op">=</span> <span class="fl">0.08206</span> <span class="co"># l atm /K /mol</span></a>
<a class="sourceLine" id="cb576-11" title="11">   p <span class="op">=</span> Pi<span class="op">/</span>(R<span class="op">*</span>T)</a>
<a class="sourceLine" id="cb576-12" title="12">   <span class="cf">return</span> p</a>
<a class="sourceLine" id="cb576-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb576-14" title="14">pressure <span class="op">=</span> <span class="fl">0.02</span> <span class="co">#atm</span></a>
<a class="sourceLine" id="cb576-15" title="15">temperature <span class="op">=</span> <span class="dv">310</span> <span class="co">#K </span></a>
<a class="sourceLine" id="cb576-16" title="16">c <span class="op">=</span> pressure<span class="op">/</span>(<span class="fl">0.08206</span><span class="op">*</span>temperature)</a>
<a class="sourceLine" id="cb576-17" title="17">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">abs</span>(osmotic_pressure_concentration(pressure,temperature)<span class="op">-</span>c)<span class="op">&lt;</span><span class="fl">0.01</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-52">Run 2</h4>
<div class="sourceCode" id="cb578"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb578-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb578-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb578-3" title="3"></a>
<a class="sourceLine" id="cb578-4" title="4"><span class="kw">def</span> osmotic_pressure_concentration(Pi,T):</a>
<a class="sourceLine" id="cb578-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb578-6" title="6"><span class="co">   This function returns the concentration in mol/l given an osmotic pressure Pi and temperature T</span></a>
<a class="sourceLine" id="cb578-7" title="7"><span class="co">   T is in K</span></a>
<a class="sourceLine" id="cb578-8" title="8"><span class="co">   Pi is in atm</span></a>
<a class="sourceLine" id="cb578-9" title="9"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb578-10" title="10">   R <span class="op">=</span> <span class="fl">0.08206</span> <span class="co"># l atm /K /mol</span></a>
<a class="sourceLine" id="cb578-11" title="11">   p <span class="op">=</span> Pi<span class="op">/</span>(R<span class="op">*</span>T)</a>
<a class="sourceLine" id="cb578-12" title="12">   <span class="cf">return</span> p</a>
<a class="sourceLine" id="cb578-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb578-14" title="14">pressure <span class="op">=</span> <span class="fl">0.02</span> <span class="co">#atm</span></a>
<a class="sourceLine" id="cb578-15" title="15">temperature <span class="op">=</span> <span class="dv">310</span> <span class="co">#K </span></a>
<a class="sourceLine" id="cb578-16" title="16">c <span class="op">=</span> pressure<span class="op">/</span>(<span class="fl">0.08206</span><span class="op">*</span>temperature)</a>
<a class="sourceLine" id="cb578-17" title="17">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">abs</span>(osmotic_pressure_concentration(pressure,temperature)<span class="op">-</span>c)<span class="op">&lt;</span><span class="fl">0.01</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-52">Run 3</h4>
<div class="sourceCode" id="cb580"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb580-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb580-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb580-3" title="3"></a>
<a class="sourceLine" id="cb580-4" title="4"><span class="kw">def</span> osmotic_pressure_concentration(Pi,T):</a>
<a class="sourceLine" id="cb580-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb580-6" title="6"><span class="co">   This function returns the concentration in mol/l given an osmotic pressure Pi and temperature T</span></a>
<a class="sourceLine" id="cb580-7" title="7"><span class="co">   T is in K</span></a>
<a class="sourceLine" id="cb580-8" title="8"><span class="co">   Pi is in atm</span></a>
<a class="sourceLine" id="cb580-9" title="9"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb580-10" title="10">   R <span class="op">=</span> <span class="fl">0.08206</span> <span class="co"># l atm /K /mol</span></a>
<a class="sourceLine" id="cb580-11" title="11">   p <span class="op">=</span> Pi <span class="op">/</span> (R<span class="op">*</span>T)</a>
<a class="sourceLine" id="cb580-12" title="12">   <span class="cf">return</span> p</a>
<a class="sourceLine" id="cb580-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb580-14" title="14">pressure <span class="op">=</span> <span class="fl">0.02</span> <span class="co">#atm</span></a>
<a class="sourceLine" id="cb580-15" title="15">temperature <span class="op">=</span> <span class="dv">310</span> <span class="co">#K </span></a>
<a class="sourceLine" id="cb580-16" title="16">c <span class="op">=</span> pressure<span class="op">/</span>(<span class="fl">0.08206</span><span class="op">*</span>temperature)</a>
<a class="sourceLine" id="cb580-17" title="17">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">abs</span>(osmotic_pressure_concentration(pressure,temperature)<span class="op">-</span>c)<span class="op">&lt;</span><span class="fl">0.01</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-52">Run 4</h4>
<div class="sourceCode" id="cb582"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb582-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb582-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb582-3" title="3"></a>
<a class="sourceLine" id="cb582-4" title="4"><span class="kw">def</span> osmotic_pressure_concentration(Pi,T):</a>
<a class="sourceLine" id="cb582-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb582-6" title="6"><span class="co">   This function returns the concentration in mol/l given an osmotic pressure Pi and temperature T</span></a>
<a class="sourceLine" id="cb582-7" title="7"><span class="co">   T is in K</span></a>
<a class="sourceLine" id="cb582-8" title="8"><span class="co">   Pi is in atm</span></a>
<a class="sourceLine" id="cb582-9" title="9"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb582-10" title="10">   R <span class="op">=</span> <span class="fl">0.08206</span> <span class="co"># l atm /K /mol</span></a>
<a class="sourceLine" id="cb582-11" title="11">   p <span class="op">=</span> Pi<span class="op">/</span>(R<span class="op">*</span>T)</a>
<a class="sourceLine" id="cb582-12" title="12">   <span class="cf">return</span> p</a>
<a class="sourceLine" id="cb582-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb582-14" title="14">pressure <span class="op">=</span> <span class="fl">0.02</span> <span class="co">#atm</span></a>
<a class="sourceLine" id="cb582-15" title="15">temperature <span class="op">=</span> <span class="dv">310</span> <span class="co">#K </span></a>
<a class="sourceLine" id="cb582-16" title="16">c <span class="op">=</span> pressure<span class="op">/</span>(<span class="fl">0.08206</span><span class="op">*</span>temperature)</a>
<a class="sourceLine" id="cb582-17" title="17">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">abs</span>(osmotic_pressure_concentration(pressure,temperature)<span class="op">-</span>c)<span class="op">&lt;</span><span class="fl">0.01</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>pair_wise</summary></p>
<h4 id="query-53">Query</h4>
<div class="sourceCode" id="cb584"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb584-1" title="1"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb584-2" title="2"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb584-3" title="3"></a>
<a class="sourceLine" id="cb584-4" title="4"><span class="kw">def</span> pairwise_dist(pdb_file):</a>
<a class="sourceLine" id="cb584-5" title="5">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb584-6" title="6"><span class="co">  1 This function loads a pdb</span></a>
<a class="sourceLine" id="cb584-7" title="7"><span class="co">  2 Selects only the alpha carbons</span></a>
<a class="sourceLine" id="cb584-8" title="8"><span class="co">  3 Calculates the number of unique alpha carbon pairs</span></a>
<a class="sourceLine" id="cb584-9" title="9"><span class="co">  4 Returns the distances between each alpha carbon pair</span></a>
<a class="sourceLine" id="cb584-10" title="10"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb584-11" title="11">  [insert]</a>
<a class="sourceLine" id="cb584-12" title="12">  <span class="cf">return</span> distances</a></code></pre></div>
<h4 id="run-0-53">Run 0</h4>
<div class="sourceCode" id="cb585"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb585-1" title="1"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb585-2" title="2"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb585-3" title="3"></a>
<a class="sourceLine" id="cb585-4" title="4"><span class="kw">def</span> pairwise_dist(pdb_file):</a>
<a class="sourceLine" id="cb585-5" title="5">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb585-6" title="6"><span class="co">  1 This function loads a pdb</span></a>
<a class="sourceLine" id="cb585-7" title="7"><span class="co">  2 Selects only the alpha carbons</span></a>
<a class="sourceLine" id="cb585-8" title="8"><span class="co">  3 Calculates the number of unique alpha carbon pairs</span></a>
<a class="sourceLine" id="cb585-9" title="9"><span class="co">  4 Returns the distances between each alpha carbon pair</span></a>
<a class="sourceLine" id="cb585-10" title="10"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb585-11" title="11">  traj <span class="op">=</span> md.load(pdb_file)</a>
<a class="sourceLine" id="cb585-12" title="12">  alpha_carbons <span class="op">=</span> traj.topology.select(<span class="st">&#39;name CA&#39;</span>)</a>
<a class="sourceLine" id="cb585-13" title="13">  distances <span class="op">=</span> md.compute_distances(traj, alpha_carbons, periodic<span class="op">=</span><span class="va">False</span>)</a>
<a class="sourceLine" id="cb585-14" title="14">  distances <span class="op">=</span> distances[<span class="dv">0</span>]</a>
<a class="sourceLine" id="cb585-15" title="15">  distances <span class="op">=</span> np.triu(distances)</a>
<a class="sourceLine" id="cb585-16" title="16">  distances <span class="op">=</span> distances[distances <span class="op">&gt;</span> <span class="dv">0</span>]</a>
<a class="sourceLine" id="cb585-17" title="17">  <span class="cf">return</span> distances</a>
<a class="sourceLine" id="cb585-18" title="18"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb585-19" title="19"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb585-20" title="20"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb585-21" title="21"></a>
<a class="sourceLine" id="cb585-22" title="22">pdb_file <span class="op">=</span> os.path.join(_FILE_DIR_, <span class="st">&quot;1VII.pdb&quot;</span>)</a>
<a class="sourceLine" id="cb585-23" title="23"></a>
<a class="sourceLine" id="cb585-24" title="24"></a>
<a class="sourceLine" id="cb585-25" title="25"><span class="kw">def</span> pairwise(pdb_file):</a>
<a class="sourceLine" id="cb585-26" title="26">    <span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb585-27" title="27">    <span class="im">from</span> itertools <span class="im">import</span> combinations</a>
<a class="sourceLine" id="cb585-28" title="28">    pdb <span class="op">=</span> md.load(pdb_file)</a>
<a class="sourceLine" id="cb585-29" title="29">    cas <span class="op">=</span> pdb.top.select(<span class="st">&quot;name CA&quot;</span>)</a>
<a class="sourceLine" id="cb585-30" title="30">    distances <span class="op">=</span> []</a>
<a class="sourceLine" id="cb585-31" title="31">    comb <span class="op">=</span> combinations(cas, <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb585-32" title="32">    distances <span class="op">=</span> md.compute_distances(pdb, comb, periodic<span class="op">=</span><span class="va">True</span>)</a>
<a class="sourceLine" id="cb585-33" title="33">    <span class="cf">return</span> distances</a>
<a class="sourceLine" id="cb585-34" title="34"></a>
<a class="sourceLine" id="cb585-35" title="35"></a>
<a class="sourceLine" id="cb585-36" title="36">my_result <span class="op">=</span> pairwise(pdb_file)</a>
<a class="sourceLine" id="cb585-37" title="37">nlcc_result <span class="op">=</span> pairwise_dist(pdb_file)</a>
<a class="sourceLine" id="cb585-38" title="38"></a>
<a class="sourceLine" id="cb585-39" title="39"><span class="co">#print(&quot;My result:&quot;, my_result)</span></a>
<a class="sourceLine" id="cb585-40" title="40"><span class="co">#print(&quot;nlcc result&quot;, nlcc_result)</span></a>
<a class="sourceLine" id="cb585-41" title="41"></a>
<a class="sourceLine" id="cb585-42" title="42">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">abs</span>(np.mean(my_result) <span class="op">-</span></a>
<a class="sourceLine" id="cb585-43" title="43">                        np.mean(nlcc_result)) <span class="op">&lt;</span> <span class="fl">0.01</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>&#39;Constant&#39; object has no attribute &#39;kind&#39;</code></pre>
<h4 id="run-1-53">Run 1</h4>
<div class="sourceCode" id="cb587"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb587-1" title="1"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb587-2" title="2"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb587-3" title="3"></a>
<a class="sourceLine" id="cb587-4" title="4"><span class="kw">def</span> pairwise_dist(pdb_file):</a>
<a class="sourceLine" id="cb587-5" title="5">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb587-6" title="6"><span class="co">  1 This function loads a pdb</span></a>
<a class="sourceLine" id="cb587-7" title="7"><span class="co">  2 Selects only the alpha carbons</span></a>
<a class="sourceLine" id="cb587-8" title="8"><span class="co">  3 Calculates the number of unique alpha carbon pairs</span></a>
<a class="sourceLine" id="cb587-9" title="9"><span class="co">  4 Returns the distances between each alpha carbon pair</span></a>
<a class="sourceLine" id="cb587-10" title="10"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb587-11" title="11">  traj <span class="op">=</span> md.load(pdb_file)</a>
<a class="sourceLine" id="cb587-12" title="12">  alpha_carbons <span class="op">=</span> traj.topology.select(<span class="st">&#39;name CA&#39;</span>)</a>
<a class="sourceLine" id="cb587-13" title="13">  distances <span class="op">=</span> md.compute_distances(traj, alpha_carbons, periodic<span class="op">=</span><span class="va">False</span>)</a>
<a class="sourceLine" id="cb587-14" title="14">  <span class="cf">return</span> distances</a>
<a class="sourceLine" id="cb587-15" title="15"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb587-16" title="16"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb587-17" title="17"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb587-18" title="18"></a>
<a class="sourceLine" id="cb587-19" title="19">pdb_file <span class="op">=</span> os.path.join(_FILE_DIR_, <span class="st">&quot;1VII.pdb&quot;</span>)</a>
<a class="sourceLine" id="cb587-20" title="20"></a>
<a class="sourceLine" id="cb587-21" title="21"></a>
<a class="sourceLine" id="cb587-22" title="22"><span class="kw">def</span> pairwise(pdb_file):</a>
<a class="sourceLine" id="cb587-23" title="23">    <span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb587-24" title="24">    <span class="im">from</span> itertools <span class="im">import</span> combinations</a>
<a class="sourceLine" id="cb587-25" title="25">    pdb <span class="op">=</span> md.load(pdb_file)</a>
<a class="sourceLine" id="cb587-26" title="26">    cas <span class="op">=</span> pdb.top.select(<span class="st">&quot;name CA&quot;</span>)</a>
<a class="sourceLine" id="cb587-27" title="27">    distances <span class="op">=</span> []</a>
<a class="sourceLine" id="cb587-28" title="28">    comb <span class="op">=</span> combinations(cas, <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb587-29" title="29">    distances <span class="op">=</span> md.compute_distances(pdb, comb, periodic<span class="op">=</span><span class="va">True</span>)</a>
<a class="sourceLine" id="cb587-30" title="30">    <span class="cf">return</span> distances</a>
<a class="sourceLine" id="cb587-31" title="31"></a>
<a class="sourceLine" id="cb587-32" title="32"></a>
<a class="sourceLine" id="cb587-33" title="33">my_result <span class="op">=</span> pairwise(pdb_file)</a>
<a class="sourceLine" id="cb587-34" title="34">nlcc_result <span class="op">=</span> pairwise_dist(pdb_file)</a>
<a class="sourceLine" id="cb587-35" title="35"></a>
<a class="sourceLine" id="cb587-36" title="36"><span class="co">#print(&quot;My result:&quot;, my_result)</span></a>
<a class="sourceLine" id="cb587-37" title="37"><span class="co">#print(&quot;nlcc result&quot;, nlcc_result)</span></a>
<a class="sourceLine" id="cb587-38" title="38"></a>
<a class="sourceLine" id="cb587-39" title="39">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">abs</span>(np.mean(my_result) <span class="op">-</span></a>
<a class="sourceLine" id="cb587-40" title="40">                        np.mean(nlcc_result)) <span class="op">&lt;</span> <span class="fl">0.01</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>&#39;Constant&#39; object has no attribute &#39;kind&#39;</code></pre>
<h4 id="run-2-53">Run 2</h4>
<div class="sourceCode" id="cb589"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb589-1" title="1"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb589-2" title="2"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb589-3" title="3"></a>
<a class="sourceLine" id="cb589-4" title="4"><span class="kw">def</span> pairwise_dist(pdb_file):</a>
<a class="sourceLine" id="cb589-5" title="5">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb589-6" title="6"><span class="co">  1 This function loads a pdb</span></a>
<a class="sourceLine" id="cb589-7" title="7"><span class="co">  2 Selects only the alpha carbons</span></a>
<a class="sourceLine" id="cb589-8" title="8"><span class="co">  3 Calculates the number of unique alpha carbon pairs</span></a>
<a class="sourceLine" id="cb589-9" title="9"><span class="co">  4 Returns the distances between each alpha carbon pair</span></a>
<a class="sourceLine" id="cb589-10" title="10"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb589-11" title="11">  traj <span class="op">=</span> md.load(pdb_file)</a>
<a class="sourceLine" id="cb589-12" title="12">  topology <span class="op">=</span> traj.topology</a>
<a class="sourceLine" id="cb589-13" title="13">  alpha_carbons <span class="op">=</span> topology.select(<span class="st">&#39;name CA&#39;</span>)</a>
<a class="sourceLine" id="cb589-14" title="14">  distances <span class="op">=</span> md.compute_distances(traj, alpha_carbons, periodic<span class="op">=</span><span class="va">False</span>)</a>
<a class="sourceLine" id="cb589-15" title="15">  distances <span class="op">=</span> distances[<span class="dv">0</span>]</a>
<a class="sourceLine" id="cb589-16" title="16">  distances <span class="op">=</span> np.tril(distances, k<span class="op">=-</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb589-17" title="17">  distances <span class="op">=</span> distances[distances <span class="op">&gt;</span> <span class="dv">0</span>]</a>
<a class="sourceLine" id="cb589-18" title="18">  <span class="cf">return</span> distances</a>
<a class="sourceLine" id="cb589-19" title="19"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb589-20" title="20"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb589-21" title="21"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb589-22" title="22"></a>
<a class="sourceLine" id="cb589-23" title="23">pdb_file <span class="op">=</span> os.path.join(_FILE_DIR_, <span class="st">&quot;1VII.pdb&quot;</span>)</a>
<a class="sourceLine" id="cb589-24" title="24"></a>
<a class="sourceLine" id="cb589-25" title="25"></a>
<a class="sourceLine" id="cb589-26" title="26"><span class="kw">def</span> pairwise(pdb_file):</a>
<a class="sourceLine" id="cb589-27" title="27">    <span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb589-28" title="28">    <span class="im">from</span> itertools <span class="im">import</span> combinations</a>
<a class="sourceLine" id="cb589-29" title="29">    pdb <span class="op">=</span> md.load(pdb_file)</a>
<a class="sourceLine" id="cb589-30" title="30">    cas <span class="op">=</span> pdb.top.select(<span class="st">&quot;name CA&quot;</span>)</a>
<a class="sourceLine" id="cb589-31" title="31">    distances <span class="op">=</span> []</a>
<a class="sourceLine" id="cb589-32" title="32">    comb <span class="op">=</span> combinations(cas, <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb589-33" title="33">    distances <span class="op">=</span> md.compute_distances(pdb, comb, periodic<span class="op">=</span><span class="va">True</span>)</a>
<a class="sourceLine" id="cb589-34" title="34">    <span class="cf">return</span> distances</a>
<a class="sourceLine" id="cb589-35" title="35"></a>
<a class="sourceLine" id="cb589-36" title="36"></a>
<a class="sourceLine" id="cb589-37" title="37">my_result <span class="op">=</span> pairwise(pdb_file)</a>
<a class="sourceLine" id="cb589-38" title="38">nlcc_result <span class="op">=</span> pairwise_dist(pdb_file)</a>
<a class="sourceLine" id="cb589-39" title="39"></a>
<a class="sourceLine" id="cb589-40" title="40"><span class="co">#print(&quot;My result:&quot;, my_result)</span></a>
<a class="sourceLine" id="cb589-41" title="41"><span class="co">#print(&quot;nlcc result&quot;, nlcc_result)</span></a>
<a class="sourceLine" id="cb589-42" title="42"></a>
<a class="sourceLine" id="cb589-43" title="43">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">abs</span>(np.mean(my_result) <span class="op">-</span></a>
<a class="sourceLine" id="cb589-44" title="44">                        np.mean(nlcc_result)) <span class="op">&lt;</span> <span class="fl">0.01</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>&#39;Constant&#39; object has no attribute &#39;kind&#39;</code></pre>
<h4 id="run-3-53">Run 3</h4>
<div class="sourceCode" id="cb591"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb591-1" title="1"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb591-2" title="2"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb591-3" title="3"></a>
<a class="sourceLine" id="cb591-4" title="4"><span class="kw">def</span> pairwise_dist(pdb_file):</a>
<a class="sourceLine" id="cb591-5" title="5">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb591-6" title="6"><span class="co">  1 This function loads a pdb</span></a>
<a class="sourceLine" id="cb591-7" title="7"><span class="co">  2 Selects only the alpha carbons</span></a>
<a class="sourceLine" id="cb591-8" title="8"><span class="co">  3 Calculates the number of unique alpha carbon pairs</span></a>
<a class="sourceLine" id="cb591-9" title="9"><span class="co">  4 Returns the distances between each alpha carbon pair</span></a>
<a class="sourceLine" id="cb591-10" title="10"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb591-11" title="11">  traj <span class="op">=</span> md.load(pdb_file)</a>
<a class="sourceLine" id="cb591-12" title="12">  topology <span class="op">=</span> traj.topology</a>
<a class="sourceLine" id="cb591-13" title="13">  alpha_carbons <span class="op">=</span> topology.select(<span class="st">&#39;name CA&#39;</span>)</a>
<a class="sourceLine" id="cb591-14" title="14">  distances <span class="op">=</span> md.compute_distances(traj, alpha_carbons, alpha_carbons)</a>
<a class="sourceLine" id="cb591-15" title="15">  distances <span class="op">=</span> np.tril(distances)</a>
<a class="sourceLine" id="cb591-16" title="16">  distances <span class="op">=</span> distances[np.nonzero(distances)]</a>
<a class="sourceLine" id="cb591-17" title="17">  <span class="cf">return</span> distances</a>
<a class="sourceLine" id="cb591-18" title="18"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb591-19" title="19"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb591-20" title="20"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb591-21" title="21"></a>
<a class="sourceLine" id="cb591-22" title="22">pdb_file <span class="op">=</span> os.path.join(_FILE_DIR_, <span class="st">&quot;1VII.pdb&quot;</span>)</a>
<a class="sourceLine" id="cb591-23" title="23"></a>
<a class="sourceLine" id="cb591-24" title="24"></a>
<a class="sourceLine" id="cb591-25" title="25"><span class="kw">def</span> pairwise(pdb_file):</a>
<a class="sourceLine" id="cb591-26" title="26">    <span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb591-27" title="27">    <span class="im">from</span> itertools <span class="im">import</span> combinations</a>
<a class="sourceLine" id="cb591-28" title="28">    pdb <span class="op">=</span> md.load(pdb_file)</a>
<a class="sourceLine" id="cb591-29" title="29">    cas <span class="op">=</span> pdb.top.select(<span class="st">&quot;name CA&quot;</span>)</a>
<a class="sourceLine" id="cb591-30" title="30">    distances <span class="op">=</span> []</a>
<a class="sourceLine" id="cb591-31" title="31">    comb <span class="op">=</span> combinations(cas, <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb591-32" title="32">    distances <span class="op">=</span> md.compute_distances(pdb, comb, periodic<span class="op">=</span><span class="va">True</span>)</a>
<a class="sourceLine" id="cb591-33" title="33">    <span class="cf">return</span> distances</a>
<a class="sourceLine" id="cb591-34" title="34"></a>
<a class="sourceLine" id="cb591-35" title="35"></a>
<a class="sourceLine" id="cb591-36" title="36">my_result <span class="op">=</span> pairwise(pdb_file)</a>
<a class="sourceLine" id="cb591-37" title="37">nlcc_result <span class="op">=</span> pairwise_dist(pdb_file)</a>
<a class="sourceLine" id="cb591-38" title="38"></a>
<a class="sourceLine" id="cb591-39" title="39"><span class="co">#print(&quot;My result:&quot;, my_result)</span></a>
<a class="sourceLine" id="cb591-40" title="40"><span class="co">#print(&quot;nlcc result&quot;, nlcc_result)</span></a>
<a class="sourceLine" id="cb591-41" title="41"></a>
<a class="sourceLine" id="cb591-42" title="42">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">abs</span>(np.mean(my_result) <span class="op">-</span></a>
<a class="sourceLine" id="cb591-43" title="43">                        np.mean(nlcc_result)) <span class="op">&lt;</span> <span class="fl">0.01</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>&#39;Constant&#39; object has no attribute &#39;kind&#39;</code></pre>
<h4 id="run-4-53">Run 4</h4>
<div class="sourceCode" id="cb593"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb593-1" title="1"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb593-2" title="2"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb593-3" title="3"></a>
<a class="sourceLine" id="cb593-4" title="4"><span class="kw">def</span> pairwise_dist(pdb_file):</a>
<a class="sourceLine" id="cb593-5" title="5">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb593-6" title="6"><span class="co">  1 This function loads a pdb</span></a>
<a class="sourceLine" id="cb593-7" title="7"><span class="co">  2 Selects only the alpha carbons</span></a>
<a class="sourceLine" id="cb593-8" title="8"><span class="co">  3 Calculates the number of unique alpha carbon pairs</span></a>
<a class="sourceLine" id="cb593-9" title="9"><span class="co">  4 Returns the distances between each alpha carbon pair</span></a>
<a class="sourceLine" id="cb593-10" title="10"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb593-11" title="11">  traj <span class="op">=</span> md.load(pdb_file)</a>
<a class="sourceLine" id="cb593-12" title="12">  topology <span class="op">=</span> traj.topology</a>
<a class="sourceLine" id="cb593-13" title="13">  alpha_carbons <span class="op">=</span> topology.select(<span class="st">&#39;name CA&#39;</span>)</a>
<a class="sourceLine" id="cb593-14" title="14">  distances <span class="op">=</span> md.compute_distances(traj, alpha_carbons, periodic<span class="op">=</span><span class="va">False</span>)</a>
<a class="sourceLine" id="cb593-15" title="15">  distances <span class="op">=</span> np.tril(distances)</a>
<a class="sourceLine" id="cb593-16" title="16">  distances <span class="op">=</span> distances[distances <span class="op">!=</span> <span class="dv">0</span>]</a>
<a class="sourceLine" id="cb593-17" title="17">  <span class="cf">return</span> distances</a>
<a class="sourceLine" id="cb593-18" title="18"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb593-19" title="19"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb593-20" title="20"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb593-21" title="21"></a>
<a class="sourceLine" id="cb593-22" title="22">pdb_file <span class="op">=</span> os.path.join(_FILE_DIR_, <span class="st">&quot;1VII.pdb&quot;</span>)</a>
<a class="sourceLine" id="cb593-23" title="23"></a>
<a class="sourceLine" id="cb593-24" title="24"></a>
<a class="sourceLine" id="cb593-25" title="25"><span class="kw">def</span> pairwise(pdb_file):</a>
<a class="sourceLine" id="cb593-26" title="26">    <span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb593-27" title="27">    <span class="im">from</span> itertools <span class="im">import</span> combinations</a>
<a class="sourceLine" id="cb593-28" title="28">    pdb <span class="op">=</span> md.load(pdb_file)</a>
<a class="sourceLine" id="cb593-29" title="29">    cas <span class="op">=</span> pdb.top.select(<span class="st">&quot;name CA&quot;</span>)</a>
<a class="sourceLine" id="cb593-30" title="30">    distances <span class="op">=</span> []</a>
<a class="sourceLine" id="cb593-31" title="31">    comb <span class="op">=</span> combinations(cas, <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb593-32" title="32">    distances <span class="op">=</span> md.compute_distances(pdb, comb, periodic<span class="op">=</span><span class="va">True</span>)</a>
<a class="sourceLine" id="cb593-33" title="33">    <span class="cf">return</span> distances</a>
<a class="sourceLine" id="cb593-34" title="34"></a>
<a class="sourceLine" id="cb593-35" title="35"></a>
<a class="sourceLine" id="cb593-36" title="36">my_result <span class="op">=</span> pairwise(pdb_file)</a>
<a class="sourceLine" id="cb593-37" title="37">nlcc_result <span class="op">=</span> pairwise_dist(pdb_file)</a>
<a class="sourceLine" id="cb593-38" title="38"></a>
<a class="sourceLine" id="cb593-39" title="39"><span class="co">#print(&quot;My result:&quot;, my_result)</span></a>
<a class="sourceLine" id="cb593-40" title="40"><span class="co">#print(&quot;nlcc result&quot;, nlcc_result)</span></a>
<a class="sourceLine" id="cb593-41" title="41"></a>
<a class="sourceLine" id="cb593-42" title="42">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">abs</span>(np.mean(my_result) <span class="op">-</span></a>
<a class="sourceLine" id="cb593-43" title="43">                        np.mean(nlcc_result)) <span class="op">&lt;</span> <span class="fl">0.01</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>&#39;Constant&#39; object has no attribute &#39;kind&#39;</code></pre>
</details>
<details>
<p><summary>pi</summary></p>
<h4 id="query-54">Query</h4>
<div class="sourceCode" id="cb595"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb595-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb595-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb595-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb595-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb595-5" title="5"></a>
<a class="sourceLine" id="cb595-6" title="6"><span class="kw">def</span> pi(nsamples):</a>
<a class="sourceLine" id="cb595-7" title="7">    <span class="co">&quot;&quot;&quot; This function returns the value of pi by monte carlo sampling &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb595-8" title="8">    [insert]</a>
<a class="sourceLine" id="cb595-9" title="9">    <span class="cf">return</span> pi_est</a></code></pre></div>
<h4 id="run-0-54">Run 0</h4>
<div class="sourceCode" id="cb596"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb596-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb596-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb596-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb596-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb596-5" title="5"></a>
<a class="sourceLine" id="cb596-6" title="6"><span class="kw">def</span> pi(nsamples):</a>
<a class="sourceLine" id="cb596-7" title="7">    <span class="co">&quot;&quot;&quot; This function returns the value of pi by monte carlo sampling &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb596-8" title="8">    x <span class="op">=</span> np.random.uniform(<span class="dv">0</span>,<span class="dv">1</span>,nsamples)</a>
<a class="sourceLine" id="cb596-9" title="9">    y <span class="op">=</span> np.random.uniform(<span class="dv">0</span>,<span class="dv">1</span>,nsamples)</a>
<a class="sourceLine" id="cb596-10" title="10">    r <span class="op">=</span> np.sqrt(x<span class="op">**</span><span class="dv">2</span> <span class="op">+</span> y<span class="op">**</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb596-11" title="11">    pi_est <span class="op">=</span> <span class="dv">4</span><span class="op">*</span>np.<span class="bu">sum</span>(r<span class="op">&lt;</span><span class="dv">1</span>)<span class="op">/</span>nsamples</a>
<a class="sourceLine" id="cb596-12" title="12">    <span class="cf">return</span> pi_est</a>
<a class="sourceLine" id="cb596-13" title="13"></a>
<a class="sourceLine" id="cb596-14" title="14"></a>
<a class="sourceLine" id="cb596-15" title="15">    <span class="cf">return</span> pi_est</a>
<a class="sourceLine" id="cb596-16" title="16">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">abs</span>(pi(<span class="dv">10000</span>)<span class="op">-</span><span class="fl">3.14159265</span>)<span class="op">&lt;</span><span class="fl">0.1</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-54">Run 1</h4>
<div class="sourceCode" id="cb598"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb598-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb598-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb598-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb598-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb598-5" title="5"></a>
<a class="sourceLine" id="cb598-6" title="6"><span class="kw">def</span> pi(nsamples):</a>
<a class="sourceLine" id="cb598-7" title="7">    <span class="co">&quot;&quot;&quot; This function returns the value of pi by monte carlo sampling &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb598-8" title="8">    x <span class="op">=</span> np.random.uniform(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>,nsamples)</a>
<a class="sourceLine" id="cb598-9" title="9">    y <span class="op">=</span> np.random.uniform(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>,nsamples)</a>
<a class="sourceLine" id="cb598-10" title="10">    r <span class="op">=</span> np.sqrt(x<span class="op">**</span><span class="dv">2</span> <span class="op">+</span> y<span class="op">**</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb598-11" title="11">    pi_est <span class="op">=</span> <span class="dv">4</span><span class="op">*</span>np.<span class="bu">sum</span>(r<span class="op">&lt;</span><span class="dv">1</span>)<span class="op">/</span>nsamples</a>
<a class="sourceLine" id="cb598-12" title="12">    <span class="cf">return</span> pi_est</a>
<a class="sourceLine" id="cb598-13" title="13">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">abs</span>(pi(<span class="dv">10000</span>)<span class="op">-</span><span class="fl">3.14159265</span>)<span class="op">&lt;</span><span class="fl">0.1</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-54">Run 2</h4>
<div class="sourceCode" id="cb600"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb600-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb600-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb600-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb600-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb600-5" title="5"></a>
<a class="sourceLine" id="cb600-6" title="6"><span class="kw">def</span> pi(nsamples):</a>
<a class="sourceLine" id="cb600-7" title="7">    <span class="co">&quot;&quot;&quot; This function returns the value of pi by monte carlo sampling &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb600-8" title="8">    x <span class="op">=</span> np.random.uniform(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>,nsamples)</a>
<a class="sourceLine" id="cb600-9" title="9">    y <span class="op">=</span> np.random.uniform(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>,nsamples)</a>
<a class="sourceLine" id="cb600-10" title="10">    r <span class="op">=</span> np.sqrt(x<span class="op">**</span><span class="dv">2</span> <span class="op">+</span> y<span class="op">**</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb600-11" title="11">    pi_est <span class="op">=</span> <span class="dv">4</span><span class="op">*</span>np.<span class="bu">sum</span>(r<span class="op">&lt;</span><span class="dv">1</span>)<span class="op">/</span>nsamples</a>
<a class="sourceLine" id="cb600-12" title="12">    <span class="cf">return</span> pi_est</a>
<a class="sourceLine" id="cb600-13" title="13">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">abs</span>(pi(<span class="dv">10000</span>)<span class="op">-</span><span class="fl">3.14159265</span>)<span class="op">&lt;</span><span class="fl">0.1</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-54">Run 3</h4>
<div class="sourceCode" id="cb602"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb602-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb602-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb602-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb602-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb602-5" title="5"></a>
<a class="sourceLine" id="cb602-6" title="6"><span class="kw">def</span> pi(nsamples):</a>
<a class="sourceLine" id="cb602-7" title="7">    <span class="co">&quot;&quot;&quot; This function returns the value of pi by monte carlo sampling &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb602-8" title="8">    x <span class="op">=</span> np.random.uniform(<span class="dv">0</span>,<span class="dv">1</span>,nsamples)</a>
<a class="sourceLine" id="cb602-9" title="9">    y <span class="op">=</span> np.random.uniform(<span class="dv">0</span>,<span class="dv">1</span>,nsamples)</a>
<a class="sourceLine" id="cb602-10" title="10">    r <span class="op">=</span> np.sqrt(x<span class="op">**</span><span class="dv">2</span> <span class="op">+</span> y<span class="op">**</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb602-11" title="11">    pi_est <span class="op">=</span> <span class="dv">4</span><span class="op">*</span>np.<span class="bu">sum</span>(r<span class="op">&lt;</span><span class="dv">1</span>)<span class="op">/</span>nsamples</a>
<a class="sourceLine" id="cb602-12" title="12">    <span class="cf">return</span> pi_est</a>
<a class="sourceLine" id="cb602-13" title="13"></a>
<a class="sourceLine" id="cb602-14" title="14"></a>
<a class="sourceLine" id="cb602-15" title="15">    <span class="cf">return</span> pi_est</a>
<a class="sourceLine" id="cb602-16" title="16">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">abs</span>(pi(<span class="dv">10000</span>)<span class="op">-</span><span class="fl">3.14159265</span>)<span class="op">&lt;</span><span class="fl">0.1</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-54">Run 4</h4>
<div class="sourceCode" id="cb604"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb604-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb604-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb604-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb604-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb604-5" title="5"></a>
<a class="sourceLine" id="cb604-6" title="6"><span class="kw">def</span> pi(nsamples):</a>
<a class="sourceLine" id="cb604-7" title="7">    <span class="co">&quot;&quot;&quot; This function returns the value of pi by monte carlo sampling &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb604-8" title="8">    x <span class="op">=</span> np.random.uniform(<span class="dv">0</span>,<span class="dv">1</span>,nsamples)</a>
<a class="sourceLine" id="cb604-9" title="9">    y <span class="op">=</span> np.random.uniform(<span class="dv">0</span>,<span class="dv">1</span>,nsamples)</a>
<a class="sourceLine" id="cb604-10" title="10">    r <span class="op">=</span> np.sqrt(x<span class="op">**</span><span class="dv">2</span> <span class="op">+</span> y<span class="op">**</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb604-11" title="11">    pi_est <span class="op">=</span> <span class="dv">4</span><span class="op">*</span>np.<span class="bu">sum</span>(r<span class="op">&lt;</span><span class="dv">1</span>)<span class="op">/</span>nsamples</a>
<a class="sourceLine" id="cb604-12" title="12">    <span class="cf">return</span> pi_est</a>
<a class="sourceLine" id="cb604-13" title="13"></a>
<a class="sourceLine" id="cb604-14" title="14"></a>
<a class="sourceLine" id="cb604-15" title="15">    <span class="cf">return</span> pi_est</a>
<a class="sourceLine" id="cb604-16" title="16">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">abs</span>(pi(<span class="dv">10000</span>)<span class="op">-</span><span class="fl">3.14159265</span>)<span class="op">&lt;</span><span class="fl">0.1</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>pib_1d</summary></p>
<h4 id="query-55">Query</h4>
<div class="sourceCode" id="cb606"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb606-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb606-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb606-3" title="3"></a>
<a class="sourceLine" id="cb606-4" title="4"><span class="kw">def</span> particle_in_box(n,m,L,hbar<span class="op">=</span><span class="dv">1</span>):</a>
<a class="sourceLine" id="cb606-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb606-6" title="6"><span class="co">   This function returns the energy for a quantum particle in a 1d box</span></a>
<a class="sourceLine" id="cb606-7" title="7"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb606-8" title="8">   [insert]</a>
<a class="sourceLine" id="cb606-9" title="9">   <span class="cf">return</span> e</a></code></pre></div>
<h4 id="run-0-55">Run 0</h4>
<div class="sourceCode" id="cb607"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb607-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb607-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb607-3" title="3"></a>
<a class="sourceLine" id="cb607-4" title="4"><span class="kw">def</span> particle_in_box(n,m,L,hbar<span class="op">=</span><span class="dv">1</span>):</a>
<a class="sourceLine" id="cb607-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb607-6" title="6"><span class="co">   This function returns the energy for a quantum particle in a 1d box</span></a>
<a class="sourceLine" id="cb607-7" title="7"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb607-8" title="8">   e <span class="op">=</span> (n<span class="op">**</span><span class="dv">2</span><span class="op">*</span>math.pi<span class="op">**</span><span class="dv">2</span><span class="op">*</span>hbar<span class="op">**</span><span class="dv">2</span>)<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>m<span class="op">*</span>L<span class="op">**</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb607-9" title="9">   <span class="cf">return</span> e</a>
<a class="sourceLine" id="cb607-10" title="10"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb607-11" title="11"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb607-12" title="12"></a>
<a class="sourceLine" id="cb607-13" title="13"><span class="co"># input params </span></a>
<a class="sourceLine" id="cb607-14" title="14">L <span class="op">=</span> <span class="dv">10</span>     <span class="co"># length of the box</span></a>
<a class="sourceLine" id="cb607-15" title="15">m <span class="op">=</span> <span class="dv">1</span>      <span class="co"># masss of the particle</span></a>
<a class="sourceLine" id="cb607-16" title="16">n <span class="op">=</span> <span class="dv">10</span>     <span class="co"># quantum number </span></a>
<a class="sourceLine" id="cb607-17" title="17">hbar <span class="op">=</span> <span class="dv">1</span>      <span class="co"># planck constant</span></a>
<a class="sourceLine" id="cb607-18" title="18"></a>
<a class="sourceLine" id="cb607-19" title="19"><span class="co"># energy</span></a>
<a class="sourceLine" id="cb607-20" title="20">e_n <span class="op">=</span> ((n<span class="op">**</span><span class="dv">2</span>)<span class="op">*</span>(hbar<span class="op">**</span><span class="dv">2</span>)<span class="op">*</span>(np.pi<span class="op">**</span><span class="dv">2</span>))<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>m<span class="op">*</span>L<span class="op">**</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb607-21" title="21"><span class="bu">print</span>(<span class="st">&quot;energy =&quot;</span>, e_n)</a>
<a class="sourceLine" id="cb607-22" title="22"></a>
<a class="sourceLine" id="cb607-23" title="23">e_n_codex <span class="op">=</span> particle_in_box(n,m,L)  </a>
<a class="sourceLine" id="cb607-24" title="24"><span class="bu">print</span>(<span class="st">&quot;energy from codex =&quot;</span>, e_n_codex)</a>
<a class="sourceLine" id="cb607-25" title="25"></a>
<a class="sourceLine" id="cb607-26" title="26"></a>
<a class="sourceLine" id="cb607-27" title="27"><span class="co"># check</span></a>
<a class="sourceLine" id="cb607-28" title="28"><span class="cf">if</span> <span class="bu">abs</span>(e_n <span class="op">-</span> e_n_codex) <span class="op">&lt;=</span> <span class="fl">1e-3</span>:</a>
<a class="sourceLine" id="cb607-29" title="29">    result <span class="op">=</span> <span class="va">True</span> </a>
<a class="sourceLine" id="cb607-30" title="30"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb607-31" title="31">    result <span class="op">=</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb607-32" title="32"></a>
<a class="sourceLine" id="cb607-33" title="33"></a>
<a class="sourceLine" id="cb607-34" title="34"></a>
<a class="sourceLine" id="cb607-35" title="35"></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-55">Run 1</h4>
<div class="sourceCode" id="cb609"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb609-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb609-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb609-3" title="3"></a>
<a class="sourceLine" id="cb609-4" title="4"><span class="kw">def</span> particle_in_box(n,m,L,hbar<span class="op">=</span><span class="dv">1</span>):</a>
<a class="sourceLine" id="cb609-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb609-6" title="6"><span class="co">   This function returns the energy for a quantum particle in a 1d box</span></a>
<a class="sourceLine" id="cb609-7" title="7"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb609-8" title="8">   e <span class="op">=</span> (n<span class="op">**</span><span class="dv">2</span> <span class="op">*</span> math.pi<span class="op">**</span><span class="dv">2</span> <span class="op">*</span> hbar<span class="op">**</span><span class="dv">2</span>)<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>m<span class="op">*</span>L<span class="op">**</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb609-9" title="9">   <span class="cf">return</span> e</a>
<a class="sourceLine" id="cb609-10" title="10"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb609-11" title="11"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb609-12" title="12"></a>
<a class="sourceLine" id="cb609-13" title="13"><span class="co"># input params </span></a>
<a class="sourceLine" id="cb609-14" title="14">L <span class="op">=</span> <span class="dv">10</span>     <span class="co"># length of the box</span></a>
<a class="sourceLine" id="cb609-15" title="15">m <span class="op">=</span> <span class="dv">1</span>      <span class="co"># masss of the particle</span></a>
<a class="sourceLine" id="cb609-16" title="16">n <span class="op">=</span> <span class="dv">10</span>     <span class="co"># quantum number </span></a>
<a class="sourceLine" id="cb609-17" title="17">hbar <span class="op">=</span> <span class="dv">1</span>      <span class="co"># planck constant</span></a>
<a class="sourceLine" id="cb609-18" title="18"></a>
<a class="sourceLine" id="cb609-19" title="19"><span class="co"># energy</span></a>
<a class="sourceLine" id="cb609-20" title="20">e_n <span class="op">=</span> ((n<span class="op">**</span><span class="dv">2</span>)<span class="op">*</span>(hbar<span class="op">**</span><span class="dv">2</span>)<span class="op">*</span>(np.pi<span class="op">**</span><span class="dv">2</span>))<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>m<span class="op">*</span>L<span class="op">**</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb609-21" title="21"><span class="bu">print</span>(<span class="st">&quot;energy =&quot;</span>, e_n)</a>
<a class="sourceLine" id="cb609-22" title="22"></a>
<a class="sourceLine" id="cb609-23" title="23">e_n_codex <span class="op">=</span> particle_in_box(n,m,L)  </a>
<a class="sourceLine" id="cb609-24" title="24"><span class="bu">print</span>(<span class="st">&quot;energy from codex =&quot;</span>, e_n_codex)</a>
<a class="sourceLine" id="cb609-25" title="25"></a>
<a class="sourceLine" id="cb609-26" title="26"></a>
<a class="sourceLine" id="cb609-27" title="27"><span class="co"># check</span></a>
<a class="sourceLine" id="cb609-28" title="28"><span class="cf">if</span> <span class="bu">abs</span>(e_n <span class="op">-</span> e_n_codex) <span class="op">&lt;=</span> <span class="fl">1e-3</span>:</a>
<a class="sourceLine" id="cb609-29" title="29">    result <span class="op">=</span> <span class="va">True</span> </a>
<a class="sourceLine" id="cb609-30" title="30"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb609-31" title="31">    result <span class="op">=</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb609-32" title="32"></a>
<a class="sourceLine" id="cb609-33" title="33"></a>
<a class="sourceLine" id="cb609-34" title="34"></a>
<a class="sourceLine" id="cb609-35" title="35"></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-55">Run 2</h4>
<div class="sourceCode" id="cb611"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb611-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb611-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb611-3" title="3"></a>
<a class="sourceLine" id="cb611-4" title="4"><span class="kw">def</span> particle_in_box(n,m,L,hbar<span class="op">=</span><span class="dv">1</span>):</a>
<a class="sourceLine" id="cb611-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb611-6" title="6"><span class="co">   This function returns the energy for a quantum particle in a 1d box</span></a>
<a class="sourceLine" id="cb611-7" title="7"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb611-8" title="8">   e <span class="op">=</span> n<span class="op">**</span><span class="dv">2</span><span class="op">*</span>math.pi<span class="op">**</span><span class="dv">2</span><span class="op">*</span>hbar<span class="op">**</span><span class="dv">2</span><span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>m<span class="op">*</span>L<span class="op">**</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb611-9" title="9">   <span class="cf">return</span> e</a>
<a class="sourceLine" id="cb611-10" title="10"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb611-11" title="11"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb611-12" title="12"></a>
<a class="sourceLine" id="cb611-13" title="13"><span class="co"># input params </span></a>
<a class="sourceLine" id="cb611-14" title="14">L <span class="op">=</span> <span class="dv">10</span>     <span class="co"># length of the box</span></a>
<a class="sourceLine" id="cb611-15" title="15">m <span class="op">=</span> <span class="dv">1</span>      <span class="co"># masss of the particle</span></a>
<a class="sourceLine" id="cb611-16" title="16">n <span class="op">=</span> <span class="dv">10</span>     <span class="co"># quantum number </span></a>
<a class="sourceLine" id="cb611-17" title="17">hbar <span class="op">=</span> <span class="dv">1</span>      <span class="co"># planck constant</span></a>
<a class="sourceLine" id="cb611-18" title="18"></a>
<a class="sourceLine" id="cb611-19" title="19"><span class="co"># energy</span></a>
<a class="sourceLine" id="cb611-20" title="20">e_n <span class="op">=</span> ((n<span class="op">**</span><span class="dv">2</span>)<span class="op">*</span>(hbar<span class="op">**</span><span class="dv">2</span>)<span class="op">*</span>(np.pi<span class="op">**</span><span class="dv">2</span>))<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>m<span class="op">*</span>L<span class="op">**</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb611-21" title="21"><span class="bu">print</span>(<span class="st">&quot;energy =&quot;</span>, e_n)</a>
<a class="sourceLine" id="cb611-22" title="22"></a>
<a class="sourceLine" id="cb611-23" title="23">e_n_codex <span class="op">=</span> particle_in_box(n,m,L)  </a>
<a class="sourceLine" id="cb611-24" title="24"><span class="bu">print</span>(<span class="st">&quot;energy from codex =&quot;</span>, e_n_codex)</a>
<a class="sourceLine" id="cb611-25" title="25"></a>
<a class="sourceLine" id="cb611-26" title="26"></a>
<a class="sourceLine" id="cb611-27" title="27"><span class="co"># check</span></a>
<a class="sourceLine" id="cb611-28" title="28"><span class="cf">if</span> <span class="bu">abs</span>(e_n <span class="op">-</span> e_n_codex) <span class="op">&lt;=</span> <span class="fl">1e-3</span>:</a>
<a class="sourceLine" id="cb611-29" title="29">    result <span class="op">=</span> <span class="va">True</span> </a>
<a class="sourceLine" id="cb611-30" title="30"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb611-31" title="31">    result <span class="op">=</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb611-32" title="32"></a>
<a class="sourceLine" id="cb611-33" title="33"></a>
<a class="sourceLine" id="cb611-34" title="34"></a>
<a class="sourceLine" id="cb611-35" title="35"></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-55">Run 3</h4>
<div class="sourceCode" id="cb613"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb613-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb613-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb613-3" title="3"></a>
<a class="sourceLine" id="cb613-4" title="4"><span class="kw">def</span> particle_in_box(n,m,L,hbar<span class="op">=</span><span class="dv">1</span>):</a>
<a class="sourceLine" id="cb613-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb613-6" title="6"><span class="co">   This function returns the energy for a quantum particle in a 1d box</span></a>
<a class="sourceLine" id="cb613-7" title="7"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb613-8" title="8">   e <span class="op">=</span> (n<span class="op">**</span><span class="dv">2</span><span class="op">*</span>math.pi<span class="op">**</span><span class="dv">2</span><span class="op">*</span>hbar<span class="op">**</span><span class="dv">2</span>)<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>m<span class="op">*</span>L<span class="op">**</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb613-9" title="9">   <span class="cf">return</span> e</a>
<a class="sourceLine" id="cb613-10" title="10"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb613-11" title="11"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb613-12" title="12"></a>
<a class="sourceLine" id="cb613-13" title="13"><span class="co"># input params </span></a>
<a class="sourceLine" id="cb613-14" title="14">L <span class="op">=</span> <span class="dv">10</span>     <span class="co"># length of the box</span></a>
<a class="sourceLine" id="cb613-15" title="15">m <span class="op">=</span> <span class="dv">1</span>      <span class="co"># masss of the particle</span></a>
<a class="sourceLine" id="cb613-16" title="16">n <span class="op">=</span> <span class="dv">10</span>     <span class="co"># quantum number </span></a>
<a class="sourceLine" id="cb613-17" title="17">hbar <span class="op">=</span> <span class="dv">1</span>      <span class="co"># planck constant</span></a>
<a class="sourceLine" id="cb613-18" title="18"></a>
<a class="sourceLine" id="cb613-19" title="19"><span class="co"># energy</span></a>
<a class="sourceLine" id="cb613-20" title="20">e_n <span class="op">=</span> ((n<span class="op">**</span><span class="dv">2</span>)<span class="op">*</span>(hbar<span class="op">**</span><span class="dv">2</span>)<span class="op">*</span>(np.pi<span class="op">**</span><span class="dv">2</span>))<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>m<span class="op">*</span>L<span class="op">**</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb613-21" title="21"><span class="bu">print</span>(<span class="st">&quot;energy =&quot;</span>, e_n)</a>
<a class="sourceLine" id="cb613-22" title="22"></a>
<a class="sourceLine" id="cb613-23" title="23">e_n_codex <span class="op">=</span> particle_in_box(n,m,L)  </a>
<a class="sourceLine" id="cb613-24" title="24"><span class="bu">print</span>(<span class="st">&quot;energy from codex =&quot;</span>, e_n_codex)</a>
<a class="sourceLine" id="cb613-25" title="25"></a>
<a class="sourceLine" id="cb613-26" title="26"></a>
<a class="sourceLine" id="cb613-27" title="27"><span class="co"># check</span></a>
<a class="sourceLine" id="cb613-28" title="28"><span class="cf">if</span> <span class="bu">abs</span>(e_n <span class="op">-</span> e_n_codex) <span class="op">&lt;=</span> <span class="fl">1e-3</span>:</a>
<a class="sourceLine" id="cb613-29" title="29">    result <span class="op">=</span> <span class="va">True</span> </a>
<a class="sourceLine" id="cb613-30" title="30"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb613-31" title="31">    result <span class="op">=</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb613-32" title="32"></a>
<a class="sourceLine" id="cb613-33" title="33"></a>
<a class="sourceLine" id="cb613-34" title="34"></a>
<a class="sourceLine" id="cb613-35" title="35"></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-55">Run 4</h4>
<div class="sourceCode" id="cb615"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb615-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb615-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb615-3" title="3"></a>
<a class="sourceLine" id="cb615-4" title="4"><span class="kw">def</span> particle_in_box(n,m,L,hbar<span class="op">=</span><span class="dv">1</span>):</a>
<a class="sourceLine" id="cb615-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb615-6" title="6"><span class="co">   This function returns the energy for a quantum particle in a 1d box</span></a>
<a class="sourceLine" id="cb615-7" title="7"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb615-8" title="8">   e <span class="op">=</span> (n<span class="op">**</span><span class="dv">2</span> <span class="op">*</span> math.pi<span class="op">**</span><span class="dv">2</span> <span class="op">*</span> hbar<span class="op">**</span><span class="dv">2</span>)<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>m<span class="op">*</span>L<span class="op">**</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb615-9" title="9">   <span class="cf">return</span> e</a>
<a class="sourceLine" id="cb615-10" title="10"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb615-11" title="11"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb615-12" title="12"></a>
<a class="sourceLine" id="cb615-13" title="13"><span class="co"># input params </span></a>
<a class="sourceLine" id="cb615-14" title="14">L <span class="op">=</span> <span class="dv">10</span>     <span class="co"># length of the box</span></a>
<a class="sourceLine" id="cb615-15" title="15">m <span class="op">=</span> <span class="dv">1</span>      <span class="co"># masss of the particle</span></a>
<a class="sourceLine" id="cb615-16" title="16">n <span class="op">=</span> <span class="dv">10</span>     <span class="co"># quantum number </span></a>
<a class="sourceLine" id="cb615-17" title="17">hbar <span class="op">=</span> <span class="dv">1</span>      <span class="co"># planck constant</span></a>
<a class="sourceLine" id="cb615-18" title="18"></a>
<a class="sourceLine" id="cb615-19" title="19"><span class="co"># energy</span></a>
<a class="sourceLine" id="cb615-20" title="20">e_n <span class="op">=</span> ((n<span class="op">**</span><span class="dv">2</span>)<span class="op">*</span>(hbar<span class="op">**</span><span class="dv">2</span>)<span class="op">*</span>(np.pi<span class="op">**</span><span class="dv">2</span>))<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>m<span class="op">*</span>L<span class="op">**</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb615-21" title="21"><span class="bu">print</span>(<span class="st">&quot;energy =&quot;</span>, e_n)</a>
<a class="sourceLine" id="cb615-22" title="22"></a>
<a class="sourceLine" id="cb615-23" title="23">e_n_codex <span class="op">=</span> particle_in_box(n,m,L)  </a>
<a class="sourceLine" id="cb615-24" title="24"><span class="bu">print</span>(<span class="st">&quot;energy from codex =&quot;</span>, e_n_codex)</a>
<a class="sourceLine" id="cb615-25" title="25"></a>
<a class="sourceLine" id="cb615-26" title="26"></a>
<a class="sourceLine" id="cb615-27" title="27"><span class="co"># check</span></a>
<a class="sourceLine" id="cb615-28" title="28"><span class="cf">if</span> <span class="bu">abs</span>(e_n <span class="op">-</span> e_n_codex) <span class="op">&lt;=</span> <span class="fl">1e-3</span>:</a>
<a class="sourceLine" id="cb615-29" title="29">    result <span class="op">=</span> <span class="va">True</span> </a>
<a class="sourceLine" id="cb615-30" title="30"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb615-31" title="31">    result <span class="op">=</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb615-32" title="32"></a>
<a class="sourceLine" id="cb615-33" title="33"></a>
<a class="sourceLine" id="cb615-34" title="34"></a>
<a class="sourceLine" id="cb615-35" title="35"></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>pred_interval</summary></p>
<h4 id="query-56">Query</h4>
<div class="sourceCode" id="cb617"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb617-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb617-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb617-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb617-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb617-5" title="5"></a>
<a class="sourceLine" id="cb617-6" title="6"><span class="kw">def</span> num_trials(pred_level, p):</a>
<a class="sourceLine" id="cb617-7" title="7">   <span class="co">&quot;&quot;&quot;Returns the minimum number of trials needed to achieve</span></a>
<a class="sourceLine" id="cb617-8" title="8"><span class="co">      a probability given by pred_level in a geometric distribution</span></a>
<a class="sourceLine" id="cb617-9" title="9"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb617-10" title="10">   [insert]</a>
<a class="sourceLine" id="cb617-11" title="11">   <span class="cf">return</span> n</a></code></pre></div>
<h4 id="run-0-56">Run 0</h4>
<div class="sourceCode" id="cb618"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb618-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb618-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb618-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb618-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb618-5" title="5"></a>
<a class="sourceLine" id="cb618-6" title="6"><span class="kw">def</span> num_trials(pred_level, p):</a>
<a class="sourceLine" id="cb618-7" title="7">   <span class="co">&quot;&quot;&quot;Returns the minimum number of trials needed to achieve</span></a>
<a class="sourceLine" id="cb618-8" title="8"><span class="co">      a probability given by pred_level in a geometric distribution</span></a>
<a class="sourceLine" id="cb618-9" title="9"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb618-10" title="10">   n <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb618-11" title="11">   <span class="cf">while</span> (<span class="dv">1</span> <span class="op">-</span> p)<span class="op">**</span>n <span class="op">&lt;</span> pred_level:</a>
<a class="sourceLine" id="cb618-12" title="12">      n <span class="op">+=</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb618-13" title="13">   <span class="cf">return</span> n</a>
<a class="sourceLine" id="cb618-14" title="14"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb618-15" title="15"></a>
<a class="sourceLine" id="cb618-16" title="16">prediction_level <span class="op">=</span> <span class="fl">0.9</span></a>
<a class="sourceLine" id="cb618-17" title="17">samples <span class="op">=</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="dv">100</span>)</a>
<a class="sourceLine" id="cb618-18" title="18">p <span class="op">=</span> <span class="fl">0.1</span></a>
<a class="sourceLine" id="cb618-19" title="19">psum <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb618-20" title="20"><span class="cf">for</span> n <span class="kw">in</span> samples:</a>
<a class="sourceLine" id="cb618-21" title="21">    psum <span class="op">+=</span> (<span class="dv">1</span> <span class="op">-</span> p) <span class="op">**</span> (n <span class="op">-</span> <span class="dv">1</span>) <span class="op">*</span> p</a>
<a class="sourceLine" id="cb618-22" title="22">    <span class="cf">if</span>(psum <span class="op">&gt;=</span> prediction_level):</a>
<a class="sourceLine" id="cb618-23" title="23">        <span class="cf">break</span></a>
<a class="sourceLine" id="cb618-24" title="24"></a>
<a class="sourceLine" id="cb618-25" title="25">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> num_trials(prediction_level, p) <span class="op">==</span> n <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-56">Run 1</h4>
<div class="sourceCode" id="cb620"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb620-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb620-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb620-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb620-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb620-5" title="5"></a>
<a class="sourceLine" id="cb620-6" title="6"><span class="kw">def</span> num_trials(pred_level, p):</a>
<a class="sourceLine" id="cb620-7" title="7">   <span class="co">&quot;&quot;&quot;Returns the minimum number of trials needed to achieve</span></a>
<a class="sourceLine" id="cb620-8" title="8"><span class="co">      a probability given by pred_level in a geometric distribution</span></a>
<a class="sourceLine" id="cb620-9" title="9"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb620-10" title="10">   n <span class="op">=</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb620-11" title="11">   <span class="cf">while</span> np.<span class="bu">sum</span>(p <span class="op">*</span> (<span class="dv">1</span><span class="op">-</span>p)<span class="op">**</span>np.arange(n)) <span class="op">&lt;</span> pred_level:</a>
<a class="sourceLine" id="cb620-12" title="12">      n <span class="op">+=</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb620-13" title="13">   <span class="cf">return</span> n</a>
<a class="sourceLine" id="cb620-14" title="14"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb620-15" title="15"></a>
<a class="sourceLine" id="cb620-16" title="16">prediction_level <span class="op">=</span> <span class="fl">0.9</span></a>
<a class="sourceLine" id="cb620-17" title="17">samples <span class="op">=</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="dv">100</span>)</a>
<a class="sourceLine" id="cb620-18" title="18">p <span class="op">=</span> <span class="fl">0.1</span></a>
<a class="sourceLine" id="cb620-19" title="19">psum <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb620-20" title="20"><span class="cf">for</span> n <span class="kw">in</span> samples:</a>
<a class="sourceLine" id="cb620-21" title="21">    psum <span class="op">+=</span> (<span class="dv">1</span> <span class="op">-</span> p) <span class="op">**</span> (n <span class="op">-</span> <span class="dv">1</span>) <span class="op">*</span> p</a>
<a class="sourceLine" id="cb620-22" title="22">    <span class="cf">if</span>(psum <span class="op">&gt;=</span> prediction_level):</a>
<a class="sourceLine" id="cb620-23" title="23">        <span class="cf">break</span></a>
<a class="sourceLine" id="cb620-24" title="24"></a>
<a class="sourceLine" id="cb620-25" title="25">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> num_trials(prediction_level, p) <span class="op">==</span> n <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-56">Run 2</h4>
<div class="sourceCode" id="cb622"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb622-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb622-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb622-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb622-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb622-5" title="5"></a>
<a class="sourceLine" id="cb622-6" title="6"><span class="kw">def</span> num_trials(pred_level, p):</a>
<a class="sourceLine" id="cb622-7" title="7">   <span class="co">&quot;&quot;&quot;Returns the minimum number of trials needed to achieve</span></a>
<a class="sourceLine" id="cb622-8" title="8"><span class="co">      a probability given by pred_level in a geometric distribution</span></a>
<a class="sourceLine" id="cb622-9" title="9"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb622-10" title="10">   n <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb622-11" title="11">   <span class="cf">while</span> np.<span class="bu">sum</span>(p<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>p)<span class="op">**</span>np.arange(n)) <span class="op">&lt;</span> pred_level:</a>
<a class="sourceLine" id="cb622-12" title="12">      n <span class="op">+=</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb622-13" title="13">   <span class="cf">return</span> n</a>
<a class="sourceLine" id="cb622-14" title="14"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb622-15" title="15"></a>
<a class="sourceLine" id="cb622-16" title="16">prediction_level <span class="op">=</span> <span class="fl">0.9</span></a>
<a class="sourceLine" id="cb622-17" title="17">samples <span class="op">=</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="dv">100</span>)</a>
<a class="sourceLine" id="cb622-18" title="18">p <span class="op">=</span> <span class="fl">0.1</span></a>
<a class="sourceLine" id="cb622-19" title="19">psum <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb622-20" title="20"><span class="cf">for</span> n <span class="kw">in</span> samples:</a>
<a class="sourceLine" id="cb622-21" title="21">    psum <span class="op">+=</span> (<span class="dv">1</span> <span class="op">-</span> p) <span class="op">**</span> (n <span class="op">-</span> <span class="dv">1</span>) <span class="op">*</span> p</a>
<a class="sourceLine" id="cb622-22" title="22">    <span class="cf">if</span>(psum <span class="op">&gt;=</span> prediction_level):</a>
<a class="sourceLine" id="cb622-23" title="23">        <span class="cf">break</span></a>
<a class="sourceLine" id="cb622-24" title="24"></a>
<a class="sourceLine" id="cb622-25" title="25">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> num_trials(prediction_level, p) <span class="op">==</span> n <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-56">Run 3</h4>
<div class="sourceCode" id="cb624"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb624-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb624-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb624-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb624-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb624-5" title="5"></a>
<a class="sourceLine" id="cb624-6" title="6"><span class="kw">def</span> num_trials(pred_level, p):</a>
<a class="sourceLine" id="cb624-7" title="7">   <span class="co">&quot;&quot;&quot;Returns the minimum number of trials needed to achieve</span></a>
<a class="sourceLine" id="cb624-8" title="8"><span class="co">      a probability given by pred_level in a geometric distribution</span></a>
<a class="sourceLine" id="cb624-9" title="9"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb624-10" title="10">   n <span class="op">=</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb624-11" title="11">   <span class="cf">while</span> np.power(<span class="dv">1</span><span class="op">-</span>p, n<span class="dv">-1</span>) <span class="op">*</span> p <span class="op">&lt;</span> pred_level:</a>
<a class="sourceLine" id="cb624-12" title="12">      n <span class="op">+=</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb624-13" title="13">   <span class="cf">return</span> n</a>
<a class="sourceLine" id="cb624-14" title="14"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb624-15" title="15"></a>
<a class="sourceLine" id="cb624-16" title="16">prediction_level <span class="op">=</span> <span class="fl">0.9</span></a>
<a class="sourceLine" id="cb624-17" title="17">samples <span class="op">=</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="dv">100</span>)</a>
<a class="sourceLine" id="cb624-18" title="18">p <span class="op">=</span> <span class="fl">0.1</span></a>
<a class="sourceLine" id="cb624-19" title="19">psum <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb624-20" title="20"><span class="cf">for</span> n <span class="kw">in</span> samples:</a>
<a class="sourceLine" id="cb624-21" title="21">    psum <span class="op">+=</span> (<span class="dv">1</span> <span class="op">-</span> p) <span class="op">**</span> (n <span class="op">-</span> <span class="dv">1</span>) <span class="op">*</span> p</a>
<a class="sourceLine" id="cb624-22" title="22">    <span class="cf">if</span>(psum <span class="op">&gt;=</span> prediction_level):</a>
<a class="sourceLine" id="cb624-23" title="23">        <span class="cf">break</span></a>
<a class="sourceLine" id="cb624-24" title="24"></a>
<a class="sourceLine" id="cb624-25" title="25">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> num_trials(prediction_level, p) <span class="op">==</span> n <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Timeout</code></pre>
<h4 id="run-4-56">Run 4</h4>
<div class="sourceCode" id="cb626"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb626-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb626-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb626-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb626-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb626-5" title="5"></a>
<a class="sourceLine" id="cb626-6" title="6"><span class="kw">def</span> num_trials(pred_level, p):</a>
<a class="sourceLine" id="cb626-7" title="7">   <span class="co">&quot;&quot;&quot;Returns the minimum number of trials needed to achieve</span></a>
<a class="sourceLine" id="cb626-8" title="8"><span class="co">      a probability given by pred_level in a geometric distribution</span></a>
<a class="sourceLine" id="cb626-9" title="9"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb626-10" title="10">   n <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb626-11" title="11">   <span class="cf">while</span> <span class="dv">1</span> <span class="op">-</span> p<span class="op">**</span>n <span class="op">&gt;</span> pred_level:</a>
<a class="sourceLine" id="cb626-12" title="12">      n <span class="op">+=</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb626-13" title="13">   <span class="cf">return</span> n</a>
<a class="sourceLine" id="cb626-14" title="14"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb626-15" title="15"></a>
<a class="sourceLine" id="cb626-16" title="16">prediction_level <span class="op">=</span> <span class="fl">0.9</span></a>
<a class="sourceLine" id="cb626-17" title="17">samples <span class="op">=</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="dv">100</span>)</a>
<a class="sourceLine" id="cb626-18" title="18">p <span class="op">=</span> <span class="fl">0.1</span></a>
<a class="sourceLine" id="cb626-19" title="19">psum <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb626-20" title="20"><span class="cf">for</span> n <span class="kw">in</span> samples:</a>
<a class="sourceLine" id="cb626-21" title="21">    psum <span class="op">+=</span> (<span class="dv">1</span> <span class="op">-</span> p) <span class="op">**</span> (n <span class="op">-</span> <span class="dv">1</span>) <span class="op">*</span> p</a>
<a class="sourceLine" id="cb626-22" title="22">    <span class="cf">if</span>(psum <span class="op">&gt;=</span> prediction_level):</a>
<a class="sourceLine" id="cb626-23" title="23">        <span class="cf">break</span></a>
<a class="sourceLine" id="cb626-24" title="24"></a>
<a class="sourceLine" id="cb626-25" title="25">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> num_trials(prediction_level, p) <span class="op">==</span> n <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>pubchem</summary></p>
<h4 id="query-57">Query</h4>
<div class="sourceCode" id="cb628"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb628-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb628-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb628-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb628-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb628-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb628-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb628-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb628-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb628-9" title="9"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb628-10" title="10"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb628-11" title="11"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb628-12" title="12"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb628-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb628-14" title="14"></a>
<a class="sourceLine" id="cb628-15" title="15"><span class="im">import</span> requests</a>
<a class="sourceLine" id="cb628-16" title="16"></a>
<a class="sourceLine" id="cb628-17" title="17"><span class="kw">def</span> find_similar(smiles):</a>
<a class="sourceLine" id="cb628-18" title="18">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb628-19" title="19"><span class="co">  Returns a set of molecules with greater than 80% similarity using the PubChem REST API.</span></a>
<a class="sourceLine" id="cb628-20" title="20"><span class="co">  The returned molecules are SMILES strings, not CIDs.</span></a>
<a class="sourceLine" id="cb628-21" title="21"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb628-22" title="22">  [insert]</a>
<a class="sourceLine" id="cb628-23" title="23">  <span class="cf">return</span> mols</a></code></pre></div>
<h4 id="run-0-57">Run 0</h4>
<div class="sourceCode" id="cb629"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb629-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb629-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb629-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb629-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb629-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb629-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb629-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb629-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb629-9" title="9"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb629-10" title="10"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb629-11" title="11"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb629-12" title="12"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb629-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb629-14" title="14"></a>
<a class="sourceLine" id="cb629-15" title="15"><span class="im">import</span> requests</a>
<a class="sourceLine" id="cb629-16" title="16"></a>
<a class="sourceLine" id="cb629-17" title="17"><span class="kw">def</span> find_similar(smiles):</a>
<a class="sourceLine" id="cb629-18" title="18">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb629-19" title="19"><span class="co">  Returns a set of molecules with greater than 80% similarity using the PubChem REST API.</span></a>
<a class="sourceLine" id="cb629-20" title="20"><span class="co">  The returned molecules are SMILES strings, not CIDs.</span></a>
<a class="sourceLine" id="cb629-21" title="21"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb629-22" title="22">  <span class="co"># PubChem REST API</span></a>
<a class="sourceLine" id="cb629-23" title="23">  url <span class="op">=</span> <span class="st">&quot;https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/smiles/similarity/JSON&quot;</span></a>
<a class="sourceLine" id="cb629-24" title="24">  payload <span class="op">=</span> {<span class="st">&#39;smiles&#39;</span>: smiles, <span class="st">&#39;threshold&#39;</span>: <span class="dv">80</span>, <span class="st">&#39;sids&#39;</span>: <span class="st">&#39;all&#39;</span>}</a>
<a class="sourceLine" id="cb629-25" title="25">  r <span class="op">=</span> requests.get(url, params<span class="op">=</span>payload)</a>
<a class="sourceLine" id="cb629-26" title="26">  data <span class="op">=</span> r.json()</a>
<a class="sourceLine" id="cb629-27" title="27">  mols <span class="op">=</span> <span class="bu">set</span>()</a>
<a class="sourceLine" id="cb629-28" title="28">  <span class="cf">for</span> mol <span class="kw">in</span> data[<span class="st">&#39;Similarity&#39;</span>]:</a>
<a class="sourceLine" id="cb629-29" title="29">    mols.add(mol[<span class="st">&#39;CID&#39;</span>])</a>
<a class="sourceLine" id="cb629-30" title="30">  <span class="cf">return</span> mols</a>
<a class="sourceLine" id="cb629-31" title="31"></a>
<a class="sourceLine" id="cb629-32" title="32"></a>
<a class="sourceLine" id="cb629-33" title="33">  <span class="cf">return</span> mols</a>
<a class="sourceLine" id="cb629-34" title="34"><span class="im">import</span> requests</a>
<a class="sourceLine" id="cb629-35" title="35"><span class="im">import</span> time</a>
<a class="sourceLine" id="cb629-36" title="36"></a>
<a class="sourceLine" id="cb629-37" title="37">time.sleep(<span class="fl">0.5</span>)</a>
<a class="sourceLine" id="cb629-38" title="38"></a>
<a class="sourceLine" id="cb629-39" title="39"></a>
<a class="sourceLine" id="cb629-40" title="40"><span class="kw">def</span> ref_find_similar(s):</a>
<a class="sourceLine" id="cb629-41" title="41">    url <span class="op">=</span> <span class="ss">f&quot;https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/fastsimilarity_2d/smiles/</span><span class="sc">{s}</span><span class="ss">/property/CanonicalSMILES/JSON&quot;</span></a>
<a class="sourceLine" id="cb629-42" title="42">    reply <span class="op">=</span> requests.get(</a>
<a class="sourceLine" id="cb629-43" title="43">        url,</a>
<a class="sourceLine" id="cb629-44" title="44">        params<span class="op">=</span>{<span class="st">&quot;Threshold&quot;</span>: <span class="dv">80</span>, <span class="st">&quot;MaxRecords&quot;</span>: <span class="dv">100</span>},</a>
<a class="sourceLine" id="cb629-45" title="45">        headers<span class="op">=</span>{<span class="st">&quot;accept&quot;</span>: <span class="st">&quot;text/json&quot;</span>},</a>
<a class="sourceLine" id="cb629-46" title="46">        timeout<span class="op">=</span><span class="dv">10</span>,</a>
<a class="sourceLine" id="cb629-47" title="47">    )</a>
<a class="sourceLine" id="cb629-48" title="48">    data <span class="op">=</span> reply.json()</a>
<a class="sourceLine" id="cb629-49" title="49">    smiles <span class="op">=</span> [d[<span class="st">&quot;CanonicalSMILES&quot;</span>]</a>
<a class="sourceLine" id="cb629-50" title="50">              <span class="cf">for</span> d <span class="kw">in</span> data[<span class="st">&quot;PropertyTable&quot;</span>][<span class="st">&quot;Properties&quot;</span>]]</a>
<a class="sourceLine" id="cb629-51" title="51">    smiles <span class="op">=</span> <span class="bu">set</span>(smiles)</a>
<a class="sourceLine" id="cb629-52" title="52">    <span class="cf">return</span> smiles</a>
<a class="sourceLine" id="cb629-53" title="53"></a>
<a class="sourceLine" id="cb629-54" title="54"></a>
<a class="sourceLine" id="cb629-55" title="55">s <span class="op">=</span> <span class="st">&#39;CC=C=C(C(=O)N)&#39;</span></a>
<a class="sourceLine" id="cb629-56" title="56">ref_sim <span class="op">=</span> ref_find_similar(s)</a>
<a class="sourceLine" id="cb629-57" title="57">sim <span class="op">=</span> find_similar(s)</a>
<a class="sourceLine" id="cb629-58" title="58">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> ref_sim <span class="op">==</span> <span class="bu">set</span>(sim) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>&#39;Similarity&#39;</code></pre>
<h4 id="run-1-57">Run 1</h4>
<div class="sourceCode" id="cb631"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb631-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb631-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb631-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb631-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb631-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb631-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb631-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb631-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb631-9" title="9"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb631-10" title="10"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb631-11" title="11"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb631-12" title="12"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb631-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb631-14" title="14"></a>
<a class="sourceLine" id="cb631-15" title="15"><span class="im">import</span> requests</a>
<a class="sourceLine" id="cb631-16" title="16"></a>
<a class="sourceLine" id="cb631-17" title="17"><span class="kw">def</span> find_similar(smiles):</a>
<a class="sourceLine" id="cb631-18" title="18">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb631-19" title="19"><span class="co">  Returns a set of molecules with greater than 80% similarity using the PubChem REST API.</span></a>
<a class="sourceLine" id="cb631-20" title="20"><span class="co">  The returned molecules are SMILES strings, not CIDs.</span></a>
<a class="sourceLine" id="cb631-21" title="21"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb631-22" title="22">  url <span class="op">=</span> <span class="st">&#39;https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/smiles/</span><span class="sc">%s</span><span class="st">/cids/TXT&#39;</span> <span class="op">%</span> smiles</a>
<a class="sourceLine" id="cb631-23" title="23">  response <span class="op">=</span> requests.get(url)</a>
<a class="sourceLine" id="cb631-24" title="24">  cids <span class="op">=</span> response.text.split()</a>
<a class="sourceLine" id="cb631-25" title="25">  cids <span class="op">=</span> [<span class="bu">int</span>(cid) <span class="cf">for</span> cid <span class="kw">in</span> cids]</a>
<a class="sourceLine" id="cb631-26" title="26">  url <span class="op">=</span> <span class="st">&#39;https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/cid/</span><span class="sc">%s</span><span class="st">/property/CanonicalSMILES/TXT&#39;</span> <span class="op">%</span> <span class="st">&#39;,&#39;</span>.join(<span class="bu">map</span>(<span class="bu">str</span>, cids))</a>
<a class="sourceLine" id="cb631-27" title="27">  response <span class="op">=</span> requests.get(url)</a>
<a class="sourceLine" id="cb631-28" title="28">  mols <span class="op">=</span> response.text.split()</a>
<a class="sourceLine" id="cb631-29" title="29">  mols <span class="op">=</span> [mol <span class="cf">for</span> mol <span class="kw">in</span> mols <span class="cf">if</span> mol <span class="op">!=</span> smiles]</a>
<a class="sourceLine" id="cb631-30" title="30">  <span class="cf">return</span> mols</a>
<a class="sourceLine" id="cb631-31" title="31"><span class="im">import</span> requests</a>
<a class="sourceLine" id="cb631-32" title="32"><span class="im">import</span> time</a>
<a class="sourceLine" id="cb631-33" title="33"></a>
<a class="sourceLine" id="cb631-34" title="34">time.sleep(<span class="fl">0.5</span>)</a>
<a class="sourceLine" id="cb631-35" title="35"></a>
<a class="sourceLine" id="cb631-36" title="36"></a>
<a class="sourceLine" id="cb631-37" title="37"><span class="kw">def</span> ref_find_similar(s):</a>
<a class="sourceLine" id="cb631-38" title="38">    url <span class="op">=</span> <span class="ss">f&quot;https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/fastsimilarity_2d/smiles/</span><span class="sc">{s}</span><span class="ss">/property/CanonicalSMILES/JSON&quot;</span></a>
<a class="sourceLine" id="cb631-39" title="39">    reply <span class="op">=</span> requests.get(</a>
<a class="sourceLine" id="cb631-40" title="40">        url,</a>
<a class="sourceLine" id="cb631-41" title="41">        params<span class="op">=</span>{<span class="st">&quot;Threshold&quot;</span>: <span class="dv">80</span>, <span class="st">&quot;MaxRecords&quot;</span>: <span class="dv">100</span>},</a>
<a class="sourceLine" id="cb631-42" title="42">        headers<span class="op">=</span>{<span class="st">&quot;accept&quot;</span>: <span class="st">&quot;text/json&quot;</span>},</a>
<a class="sourceLine" id="cb631-43" title="43">        timeout<span class="op">=</span><span class="dv">10</span>,</a>
<a class="sourceLine" id="cb631-44" title="44">    )</a>
<a class="sourceLine" id="cb631-45" title="45">    data <span class="op">=</span> reply.json()</a>
<a class="sourceLine" id="cb631-46" title="46">    smiles <span class="op">=</span> [d[<span class="st">&quot;CanonicalSMILES&quot;</span>]</a>
<a class="sourceLine" id="cb631-47" title="47">              <span class="cf">for</span> d <span class="kw">in</span> data[<span class="st">&quot;PropertyTable&quot;</span>][<span class="st">&quot;Properties&quot;</span>]]</a>
<a class="sourceLine" id="cb631-48" title="48">    smiles <span class="op">=</span> <span class="bu">set</span>(smiles)</a>
<a class="sourceLine" id="cb631-49" title="49">    <span class="cf">return</span> smiles</a>
<a class="sourceLine" id="cb631-50" title="50"></a>
<a class="sourceLine" id="cb631-51" title="51"></a>
<a class="sourceLine" id="cb631-52" title="52">s <span class="op">=</span> <span class="st">&#39;CC=C=C(C(=O)N)&#39;</span></a>
<a class="sourceLine" id="cb631-53" title="53">ref_sim <span class="op">=</span> ref_find_similar(s)</a>
<a class="sourceLine" id="cb631-54" title="54">sim <span class="op">=</span> find_similar(s)</a>
<a class="sourceLine" id="cb631-55" title="55">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> ref_sim <span class="op">==</span> <span class="bu">set</span>(sim) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-57">Run 2</h4>
<div class="sourceCode" id="cb633"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb633-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb633-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb633-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb633-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb633-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb633-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb633-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb633-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb633-9" title="9"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb633-10" title="10"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb633-11" title="11"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb633-12" title="12"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb633-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb633-14" title="14"></a>
<a class="sourceLine" id="cb633-15" title="15"><span class="im">import</span> requests</a>
<a class="sourceLine" id="cb633-16" title="16"></a>
<a class="sourceLine" id="cb633-17" title="17"><span class="kw">def</span> find_similar(smiles):</a>
<a class="sourceLine" id="cb633-18" title="18">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb633-19" title="19"><span class="co">  Returns a set of molecules with greater than 80% similarity using the PubChem REST API.</span></a>
<a class="sourceLine" id="cb633-20" title="20"><span class="co">  The returned molecules are SMILES strings, not CIDs.</span></a>
<a class="sourceLine" id="cb633-21" title="21"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb633-22" title="22">  mols <span class="op">=</span> <span class="bu">set</span>()</a>
<a class="sourceLine" id="cb633-23" title="23">  url <span class="op">=</span> <span class="st">&quot;https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/smiles/similarity/smiles/</span><span class="sc">%s</span><span class="st">/cids/TXT&quot;</span> <span class="op">%</span> smiles</a>
<a class="sourceLine" id="cb633-24" title="24">  r <span class="op">=</span> requests.get(url)</a>
<a class="sourceLine" id="cb633-25" title="25">  cids <span class="op">=</span> r.text.split(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)</a>
<a class="sourceLine" id="cb633-26" title="26">  <span class="cf">for</span> cid <span class="kw">in</span> cids:</a>
<a class="sourceLine" id="cb633-27" title="27">    <span class="cf">if</span> cid <span class="op">==</span> <span class="st">&quot;&quot;</span>:</a>
<a class="sourceLine" id="cb633-28" title="28">      <span class="cf">continue</span></a>
<a class="sourceLine" id="cb633-29" title="29">    url <span class="op">=</span> <span class="st">&quot;https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/cid/</span><span class="sc">%s</span><span class="st">/property/CanonicalSMILES/TXT&quot;</span> <span class="op">%</span> cid</a>
<a class="sourceLine" id="cb633-30" title="30">    r <span class="op">=</span> requests.get(url)</a>
<a class="sourceLine" id="cb633-31" title="31">    mols.add(r.text)</a>
<a class="sourceLine" id="cb633-32" title="32">  <span class="cf">return</span> mols</a>
<a class="sourceLine" id="cb633-33" title="33"><span class="im">import</span> requests</a>
<a class="sourceLine" id="cb633-34" title="34"><span class="im">import</span> time</a>
<a class="sourceLine" id="cb633-35" title="35"></a>
<a class="sourceLine" id="cb633-36" title="36">time.sleep(<span class="fl">0.5</span>)</a>
<a class="sourceLine" id="cb633-37" title="37"></a>
<a class="sourceLine" id="cb633-38" title="38"></a>
<a class="sourceLine" id="cb633-39" title="39"><span class="kw">def</span> ref_find_similar(s):</a>
<a class="sourceLine" id="cb633-40" title="40">    url <span class="op">=</span> <span class="ss">f&quot;https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/fastsimilarity_2d/smiles/</span><span class="sc">{s}</span><span class="ss">/property/CanonicalSMILES/JSON&quot;</span></a>
<a class="sourceLine" id="cb633-41" title="41">    reply <span class="op">=</span> requests.get(</a>
<a class="sourceLine" id="cb633-42" title="42">        url,</a>
<a class="sourceLine" id="cb633-43" title="43">        params<span class="op">=</span>{<span class="st">&quot;Threshold&quot;</span>: <span class="dv">80</span>, <span class="st">&quot;MaxRecords&quot;</span>: <span class="dv">100</span>},</a>
<a class="sourceLine" id="cb633-44" title="44">        headers<span class="op">=</span>{<span class="st">&quot;accept&quot;</span>: <span class="st">&quot;text/json&quot;</span>},</a>
<a class="sourceLine" id="cb633-45" title="45">        timeout<span class="op">=</span><span class="dv">10</span>,</a>
<a class="sourceLine" id="cb633-46" title="46">    )</a>
<a class="sourceLine" id="cb633-47" title="47">    data <span class="op">=</span> reply.json()</a>
<a class="sourceLine" id="cb633-48" title="48">    smiles <span class="op">=</span> [d[<span class="st">&quot;CanonicalSMILES&quot;</span>]</a>
<a class="sourceLine" id="cb633-49" title="49">              <span class="cf">for</span> d <span class="kw">in</span> data[<span class="st">&quot;PropertyTable&quot;</span>][<span class="st">&quot;Properties&quot;</span>]]</a>
<a class="sourceLine" id="cb633-50" title="50">    smiles <span class="op">=</span> <span class="bu">set</span>(smiles)</a>
<a class="sourceLine" id="cb633-51" title="51">    <span class="cf">return</span> smiles</a>
<a class="sourceLine" id="cb633-52" title="52"></a>
<a class="sourceLine" id="cb633-53" title="53"></a>
<a class="sourceLine" id="cb633-54" title="54">s <span class="op">=</span> <span class="st">&#39;CC=C=C(C(=O)N)&#39;</span></a>
<a class="sourceLine" id="cb633-55" title="55">ref_sim <span class="op">=</span> ref_find_similar(s)</a>
<a class="sourceLine" id="cb633-56" title="56">sim <span class="op">=</span> find_similar(s)</a>
<a class="sourceLine" id="cb633-57" title="57">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> ref_sim <span class="op">==</span> <span class="bu">set</span>(sim) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-57">Run 3</h4>
<div class="sourceCode" id="cb635"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb635-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb635-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb635-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb635-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb635-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb635-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb635-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb635-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb635-9" title="9"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb635-10" title="10"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb635-11" title="11"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb635-12" title="12"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb635-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb635-14" title="14"></a>
<a class="sourceLine" id="cb635-15" title="15"><span class="im">import</span> requests</a>
<a class="sourceLine" id="cb635-16" title="16"></a>
<a class="sourceLine" id="cb635-17" title="17"><span class="kw">def</span> find_similar(smiles):</a>
<a class="sourceLine" id="cb635-18" title="18">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb635-19" title="19"><span class="co">  Returns a set of molecules with greater than 80% similarity using the PubChem REST API.</span></a>
<a class="sourceLine" id="cb635-20" title="20"><span class="co">  The returned molecules are SMILES strings, not CIDs.</span></a>
<a class="sourceLine" id="cb635-21" title="21"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb635-22" title="22">  url <span class="op">=</span> <span class="st">&quot;https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/smiles/similarity/smiles/</span><span class="sc">{}</span><span class="st">/cids/TXT&quot;</span>.<span class="bu">format</span>(smiles)</a>
<a class="sourceLine" id="cb635-23" title="23">  response <span class="op">=</span> requests.get(url)</a>
<a class="sourceLine" id="cb635-24" title="24">  cids <span class="op">=</span> response.text.split()</a>
<a class="sourceLine" id="cb635-25" title="25">  cids <span class="op">=</span> cids[:<span class="dv">10</span>]</a>
<a class="sourceLine" id="cb635-26" title="26">  mols <span class="op">=</span> []</a>
<a class="sourceLine" id="cb635-27" title="27">  <span class="cf">for</span> cid <span class="kw">in</span> cids:</a>
<a class="sourceLine" id="cb635-28" title="28">    url <span class="op">=</span> <span class="st">&quot;https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/cid/</span><span class="sc">{}</span><span class="st">/property/CanonicalSMILES/TXT&quot;</span>.<span class="bu">format</span>(cid)</a>
<a class="sourceLine" id="cb635-29" title="29">    response <span class="op">=</span> requests.get(url)</a>
<a class="sourceLine" id="cb635-30" title="30">    mols.append(response.text)</a>
<a class="sourceLine" id="cb635-31" title="31">  <span class="cf">return</span> mols</a>
<a class="sourceLine" id="cb635-32" title="32"><span class="im">import</span> requests</a>
<a class="sourceLine" id="cb635-33" title="33"><span class="im">import</span> time</a>
<a class="sourceLine" id="cb635-34" title="34"></a>
<a class="sourceLine" id="cb635-35" title="35">time.sleep(<span class="fl">0.5</span>)</a>
<a class="sourceLine" id="cb635-36" title="36"></a>
<a class="sourceLine" id="cb635-37" title="37"></a>
<a class="sourceLine" id="cb635-38" title="38"><span class="kw">def</span> ref_find_similar(s):</a>
<a class="sourceLine" id="cb635-39" title="39">    url <span class="op">=</span> <span class="ss">f&quot;https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/fastsimilarity_2d/smiles/</span><span class="sc">{s}</span><span class="ss">/property/CanonicalSMILES/JSON&quot;</span></a>
<a class="sourceLine" id="cb635-40" title="40">    reply <span class="op">=</span> requests.get(</a>
<a class="sourceLine" id="cb635-41" title="41">        url,</a>
<a class="sourceLine" id="cb635-42" title="42">        params<span class="op">=</span>{<span class="st">&quot;Threshold&quot;</span>: <span class="dv">80</span>, <span class="st">&quot;MaxRecords&quot;</span>: <span class="dv">100</span>},</a>
<a class="sourceLine" id="cb635-43" title="43">        headers<span class="op">=</span>{<span class="st">&quot;accept&quot;</span>: <span class="st">&quot;text/json&quot;</span>},</a>
<a class="sourceLine" id="cb635-44" title="44">        timeout<span class="op">=</span><span class="dv">10</span>,</a>
<a class="sourceLine" id="cb635-45" title="45">    )</a>
<a class="sourceLine" id="cb635-46" title="46">    data <span class="op">=</span> reply.json()</a>
<a class="sourceLine" id="cb635-47" title="47">    smiles <span class="op">=</span> [d[<span class="st">&quot;CanonicalSMILES&quot;</span>]</a>
<a class="sourceLine" id="cb635-48" title="48">              <span class="cf">for</span> d <span class="kw">in</span> data[<span class="st">&quot;PropertyTable&quot;</span>][<span class="st">&quot;Properties&quot;</span>]]</a>
<a class="sourceLine" id="cb635-49" title="49">    smiles <span class="op">=</span> <span class="bu">set</span>(smiles)</a>
<a class="sourceLine" id="cb635-50" title="50">    <span class="cf">return</span> smiles</a>
<a class="sourceLine" id="cb635-51" title="51"></a>
<a class="sourceLine" id="cb635-52" title="52"></a>
<a class="sourceLine" id="cb635-53" title="53">s <span class="op">=</span> <span class="st">&#39;CC=C=C(C(=O)N)&#39;</span></a>
<a class="sourceLine" id="cb635-54" title="54">ref_sim <span class="op">=</span> ref_find_similar(s)</a>
<a class="sourceLine" id="cb635-55" title="55">sim <span class="op">=</span> find_similar(s)</a>
<a class="sourceLine" id="cb635-56" title="56">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> ref_sim <span class="op">==</span> <span class="bu">set</span>(sim) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-57">Run 4</h4>
<div class="sourceCode" id="cb637"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb637-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb637-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb637-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb637-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb637-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb637-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb637-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb637-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb637-9" title="9"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb637-10" title="10"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb637-11" title="11"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb637-12" title="12"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb637-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb637-14" title="14"></a>
<a class="sourceLine" id="cb637-15" title="15"><span class="im">import</span> requests</a>
<a class="sourceLine" id="cb637-16" title="16"></a>
<a class="sourceLine" id="cb637-17" title="17"><span class="kw">def</span> find_similar(smiles):</a>
<a class="sourceLine" id="cb637-18" title="18">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb637-19" title="19"><span class="co">  Returns a set of molecules with greater than 80% similarity using the PubChem REST API.</span></a>
<a class="sourceLine" id="cb637-20" title="20"><span class="co">  The returned molecules are SMILES strings, not CIDs.</span></a>
<a class="sourceLine" id="cb637-21" title="21"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb637-22" title="22">  url <span class="op">=</span> <span class="st">&#39;https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/smiles/similarity/smiles/&#39;</span></a>
<a class="sourceLine" id="cb637-23" title="23">  url <span class="op">+=</span> smiles</a>
<a class="sourceLine" id="cb637-24" title="24">  url <span class="op">+=</span> <span class="st">&#39;/cids/TXT?Threshold=80&#39;</span></a>
<a class="sourceLine" id="cb637-25" title="25">  response <span class="op">=</span> requests.get(url)</a>
<a class="sourceLine" id="cb637-26" title="26">  cids <span class="op">=</span> response.text.split(<span class="st">&#39;</span><span class="ch">\n</span><span class="st">&#39;</span>)</a>
<a class="sourceLine" id="cb637-27" title="27">  cids <span class="op">=</span> [cid <span class="cf">for</span> cid <span class="kw">in</span> cids <span class="cf">if</span> cid <span class="op">!=</span> <span class="st">&#39;&#39;</span>]</a>
<a class="sourceLine" id="cb637-28" title="28">  mols <span class="op">=</span> []</a>
<a class="sourceLine" id="cb637-29" title="29">  <span class="cf">for</span> cid <span class="kw">in</span> cids:</a>
<a class="sourceLine" id="cb637-30" title="30">    url <span class="op">=</span> <span class="st">&#39;https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/cid/&#39;</span></a>
<a class="sourceLine" id="cb637-31" title="31">    url <span class="op">+=</span> cid</a>
<a class="sourceLine" id="cb637-32" title="32">    url <span class="op">+=</span> <span class="st">&#39;/property/CanonicalSMILES/TXT&#39;</span></a>
<a class="sourceLine" id="cb637-33" title="33">    response <span class="op">=</span> requests.get(url)</a>
<a class="sourceLine" id="cb637-34" title="34">    mols.append(response.text)</a>
<a class="sourceLine" id="cb637-35" title="35">  <span class="cf">return</span> mols</a>
<a class="sourceLine" id="cb637-36" title="36"><span class="im">import</span> requests</a>
<a class="sourceLine" id="cb637-37" title="37"><span class="im">import</span> time</a>
<a class="sourceLine" id="cb637-38" title="38"></a>
<a class="sourceLine" id="cb637-39" title="39">time.sleep(<span class="fl">0.5</span>)</a>
<a class="sourceLine" id="cb637-40" title="40"></a>
<a class="sourceLine" id="cb637-41" title="41"></a>
<a class="sourceLine" id="cb637-42" title="42"><span class="kw">def</span> ref_find_similar(s):</a>
<a class="sourceLine" id="cb637-43" title="43">    url <span class="op">=</span> <span class="ss">f&quot;https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/fastsimilarity_2d/smiles/</span><span class="sc">{s}</span><span class="ss">/property/CanonicalSMILES/JSON&quot;</span></a>
<a class="sourceLine" id="cb637-44" title="44">    reply <span class="op">=</span> requests.get(</a>
<a class="sourceLine" id="cb637-45" title="45">        url,</a>
<a class="sourceLine" id="cb637-46" title="46">        params<span class="op">=</span>{<span class="st">&quot;Threshold&quot;</span>: <span class="dv">80</span>, <span class="st">&quot;MaxRecords&quot;</span>: <span class="dv">100</span>},</a>
<a class="sourceLine" id="cb637-47" title="47">        headers<span class="op">=</span>{<span class="st">&quot;accept&quot;</span>: <span class="st">&quot;text/json&quot;</span>},</a>
<a class="sourceLine" id="cb637-48" title="48">        timeout<span class="op">=</span><span class="dv">10</span>,</a>
<a class="sourceLine" id="cb637-49" title="49">    )</a>
<a class="sourceLine" id="cb637-50" title="50">    data <span class="op">=</span> reply.json()</a>
<a class="sourceLine" id="cb637-51" title="51">    smiles <span class="op">=</span> [d[<span class="st">&quot;CanonicalSMILES&quot;</span>]</a>
<a class="sourceLine" id="cb637-52" title="52">              <span class="cf">for</span> d <span class="kw">in</span> data[<span class="st">&quot;PropertyTable&quot;</span>][<span class="st">&quot;Properties&quot;</span>]]</a>
<a class="sourceLine" id="cb637-53" title="53">    smiles <span class="op">=</span> <span class="bu">set</span>(smiles)</a>
<a class="sourceLine" id="cb637-54" title="54">    <span class="cf">return</span> smiles</a>
<a class="sourceLine" id="cb637-55" title="55"></a>
<a class="sourceLine" id="cb637-56" title="56"></a>
<a class="sourceLine" id="cb637-57" title="57">s <span class="op">=</span> <span class="st">&#39;CC=C=C(C(=O)N)&#39;</span></a>
<a class="sourceLine" id="cb637-58" title="58">ref_sim <span class="op">=</span> ref_find_similar(s)</a>
<a class="sourceLine" id="cb637-59" title="59">sim <span class="op">=</span> find_similar(s)</a>
<a class="sourceLine" id="cb637-60" title="60">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> ref_sim <span class="op">==</span> <span class="bu">set</span>(sim) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>pyscf_energy</summary></p>
<h4 id="query-58">Query</h4>
<div class="sourceCode" id="cb639"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb639-1" title="1"><span class="im">import</span> pyscf</a>
<a class="sourceLine" id="cb639-2" title="2"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb639-3" title="3"></a>
<a class="sourceLine" id="cb639-4" title="4"><span class="kw">def</span> calc_molecule_energy(atom,basis):</a>
<a class="sourceLine" id="cb639-5" title="5">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb639-6" title="6"><span class="co">    This function returns the ground state energy for atom using restricted Hartree-Fock in the given basis</span></a>
<a class="sourceLine" id="cb639-7" title="7"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb639-8" title="8">    [insert]</a>
<a class="sourceLine" id="cb639-9" title="9">    <span class="cf">return</span> ground_energy</a></code></pre></div>
<h4 id="run-0-58">Run 0</h4>
<div class="sourceCode" id="cb640"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb640-1" title="1"><span class="im">import</span> pyscf</a>
<a class="sourceLine" id="cb640-2" title="2"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb640-3" title="3"></a>
<a class="sourceLine" id="cb640-4" title="4"><span class="kw">def</span> calc_molecule_energy(atom,basis):</a>
<a class="sourceLine" id="cb640-5" title="5">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb640-6" title="6"><span class="co">    This function returns the ground state energy for atom using restricted Hartree-Fock in the given basis</span></a>
<a class="sourceLine" id="cb640-7" title="7"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb640-8" title="8">    mol <span class="op">=</span> pyscf.gto.M(atom<span class="op">=</span>atom, basis<span class="op">=</span>basis)</a>
<a class="sourceLine" id="cb640-9" title="9">    mf <span class="op">=</span> pyscf.scf.RHF(mol)</a>
<a class="sourceLine" id="cb640-10" title="10">    mf.kernel()</a>
<a class="sourceLine" id="cb640-11" title="11">    ground_energy <span class="op">=</span> mf.e_tot</a>
<a class="sourceLine" id="cb640-12" title="12"></a>
<a class="sourceLine" id="cb640-13" title="13">    <span class="cf">return</span> ground_energy</a>
<a class="sourceLine" id="cb640-14" title="14">atom_coordinates <span class="op">=</span> <span class="st">&quot;H 0 0 0; F 0 0 1&quot;</span></a>
<a class="sourceLine" id="cb640-15" title="15">basis <span class="op">=</span> <span class="st">&quot;sto-3g&quot;</span></a>
<a class="sourceLine" id="cb640-16" title="16"></a>
<a class="sourceLine" id="cb640-17" title="17"><span class="co">#so that it doesn&#39;t fail b/c not importing these in prompt:</span></a>
<a class="sourceLine" id="cb640-18" title="18"><span class="im">from</span> pyscf <span class="im">import</span> gto, scf</a>
<a class="sourceLine" id="cb640-19" title="19"></a>
<a class="sourceLine" id="cb640-20" title="20"><span class="kw">def</span> calc_molecule_energy_test(atom_coordinates,basis):</a>
<a class="sourceLine" id="cb640-21" title="21">    mol <span class="op">=</span> gto.M(atom<span class="op">=</span>atom_coordinates,basis<span class="op">=</span>basis)</a>
<a class="sourceLine" id="cb640-22" title="22">    mf <span class="op">=</span> scf.RHF(mol)</a>
<a class="sourceLine" id="cb640-23" title="23">    <span class="cf">return</span> mf.kernel()</a>
<a class="sourceLine" id="cb640-24" title="24"></a>
<a class="sourceLine" id="cb640-25" title="25">my_energy <span class="op">=</span> calc_molecule_energy_test(atom_coordinates,basis)</a>
<a class="sourceLine" id="cb640-26" title="26">nlcc_energy <span class="op">=</span> calc_molecule_energy(atom_coordinates,basis)</a>
<a class="sourceLine" id="cb640-27" title="27"></a>
<a class="sourceLine" id="cb640-28" title="28"><span class="bu">print</span>(<span class="st">&quot;My result:&quot;</span>, my_energy)</a>
<a class="sourceLine" id="cb640-29" title="29"><span class="bu">print</span>(<span class="st">&quot;nlcc result:&quot;</span>, nlcc_energy)</a>
<a class="sourceLine" id="cb640-30" title="30"></a>
<a class="sourceLine" id="cb640-31" title="31">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">abs</span>( my_energy <span class="op">-</span> nlcc_energy )<span class="op">&lt;</span><span class="fl">0.1</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>&#39;NoneType&#39; object has no attribute &#39;write&#39;</code></pre>
<h4 id="run-1-58">Run 1</h4>
<div class="sourceCode" id="cb642"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb642-1" title="1"><span class="im">import</span> pyscf</a>
<a class="sourceLine" id="cb642-2" title="2"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb642-3" title="3"></a>
<a class="sourceLine" id="cb642-4" title="4"><span class="kw">def</span> calc_molecule_energy(atom,basis):</a>
<a class="sourceLine" id="cb642-5" title="5">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb642-6" title="6"><span class="co">    This function returns the ground state energy for atom using restricted Hartree-Fock in the given basis</span></a>
<a class="sourceLine" id="cb642-7" title="7"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb642-8" title="8">    mol <span class="op">=</span> pyscf.gto.M(atom<span class="op">=</span>atom,basis<span class="op">=</span>basis)</a>
<a class="sourceLine" id="cb642-9" title="9">    mol.build()</a>
<a class="sourceLine" id="cb642-10" title="10">    mf <span class="op">=</span> pyscf.scf.RHF(mol)</a>
<a class="sourceLine" id="cb642-11" title="11">    mf.scf()</a>
<a class="sourceLine" id="cb642-12" title="12">    ground_energy <span class="op">=</span> mf.e_tot</a>
<a class="sourceLine" id="cb642-13" title="13">    <span class="cf">return</span> ground_energy</a>
<a class="sourceLine" id="cb642-14" title="14"></a>
<a class="sourceLine" id="cb642-15" title="15"></a>
<a class="sourceLine" id="cb642-16" title="16">    <span class="cf">return</span> ground_energy</a>
<a class="sourceLine" id="cb642-17" title="17">atom_coordinates <span class="op">=</span> <span class="st">&quot;H 0 0 0; F 0 0 1&quot;</span></a>
<a class="sourceLine" id="cb642-18" title="18">basis <span class="op">=</span> <span class="st">&quot;sto-3g&quot;</span></a>
<a class="sourceLine" id="cb642-19" title="19"></a>
<a class="sourceLine" id="cb642-20" title="20"><span class="co">#so that it doesn&#39;t fail b/c not importing these in prompt:</span></a>
<a class="sourceLine" id="cb642-21" title="21"><span class="im">from</span> pyscf <span class="im">import</span> gto, scf</a>
<a class="sourceLine" id="cb642-22" title="22"></a>
<a class="sourceLine" id="cb642-23" title="23"><span class="kw">def</span> calc_molecule_energy_test(atom_coordinates,basis):</a>
<a class="sourceLine" id="cb642-24" title="24">    mol <span class="op">=</span> gto.M(atom<span class="op">=</span>atom_coordinates,basis<span class="op">=</span>basis)</a>
<a class="sourceLine" id="cb642-25" title="25">    mf <span class="op">=</span> scf.RHF(mol)</a>
<a class="sourceLine" id="cb642-26" title="26">    <span class="cf">return</span> mf.kernel()</a>
<a class="sourceLine" id="cb642-27" title="27"></a>
<a class="sourceLine" id="cb642-28" title="28">my_energy <span class="op">=</span> calc_molecule_energy_test(atom_coordinates,basis)</a>
<a class="sourceLine" id="cb642-29" title="29">nlcc_energy <span class="op">=</span> calc_molecule_energy(atom_coordinates,basis)</a>
<a class="sourceLine" id="cb642-30" title="30"></a>
<a class="sourceLine" id="cb642-31" title="31"><span class="bu">print</span>(<span class="st">&quot;My result:&quot;</span>, my_energy)</a>
<a class="sourceLine" id="cb642-32" title="32"><span class="bu">print</span>(<span class="st">&quot;nlcc result:&quot;</span>, nlcc_energy)</a>
<a class="sourceLine" id="cb642-33" title="33"></a>
<a class="sourceLine" id="cb642-34" title="34">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">abs</span>( my_energy <span class="op">-</span> nlcc_energy )<span class="op">&lt;</span><span class="fl">0.1</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>&#39;NoneType&#39; object has no attribute &#39;write&#39;</code></pre>
<h4 id="run-2-58">Run 2</h4>
<div class="sourceCode" id="cb644"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb644-1" title="1"><span class="im">import</span> pyscf</a>
<a class="sourceLine" id="cb644-2" title="2"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb644-3" title="3"></a>
<a class="sourceLine" id="cb644-4" title="4"><span class="kw">def</span> calc_molecule_energy(atom,basis):</a>
<a class="sourceLine" id="cb644-5" title="5">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb644-6" title="6"><span class="co">    This function returns the ground state energy for atom using restricted Hartree-Fock in the given basis</span></a>
<a class="sourceLine" id="cb644-7" title="7"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb644-8" title="8">    mol <span class="op">=</span> pyscf.gto.M(atom<span class="op">=</span>atom, basis<span class="op">=</span>basis)</a>
<a class="sourceLine" id="cb644-9" title="9">    mf <span class="op">=</span> pyscf.scf.RHF(mol)</a>
<a class="sourceLine" id="cb644-10" title="10">    mf.scf()</a>
<a class="sourceLine" id="cb644-11" title="11">    ground_energy <span class="op">=</span> mf.e_tot</a>
<a class="sourceLine" id="cb644-12" title="12"></a>
<a class="sourceLine" id="cb644-13" title="13">    <span class="cf">return</span> ground_energy</a>
<a class="sourceLine" id="cb644-14" title="14">atom_coordinates <span class="op">=</span> <span class="st">&quot;H 0 0 0; F 0 0 1&quot;</span></a>
<a class="sourceLine" id="cb644-15" title="15">basis <span class="op">=</span> <span class="st">&quot;sto-3g&quot;</span></a>
<a class="sourceLine" id="cb644-16" title="16"></a>
<a class="sourceLine" id="cb644-17" title="17"><span class="co">#so that it doesn&#39;t fail b/c not importing these in prompt:</span></a>
<a class="sourceLine" id="cb644-18" title="18"><span class="im">from</span> pyscf <span class="im">import</span> gto, scf</a>
<a class="sourceLine" id="cb644-19" title="19"></a>
<a class="sourceLine" id="cb644-20" title="20"><span class="kw">def</span> calc_molecule_energy_test(atom_coordinates,basis):</a>
<a class="sourceLine" id="cb644-21" title="21">    mol <span class="op">=</span> gto.M(atom<span class="op">=</span>atom_coordinates,basis<span class="op">=</span>basis)</a>
<a class="sourceLine" id="cb644-22" title="22">    mf <span class="op">=</span> scf.RHF(mol)</a>
<a class="sourceLine" id="cb644-23" title="23">    <span class="cf">return</span> mf.kernel()</a>
<a class="sourceLine" id="cb644-24" title="24"></a>
<a class="sourceLine" id="cb644-25" title="25">my_energy <span class="op">=</span> calc_molecule_energy_test(atom_coordinates,basis)</a>
<a class="sourceLine" id="cb644-26" title="26">nlcc_energy <span class="op">=</span> calc_molecule_energy(atom_coordinates,basis)</a>
<a class="sourceLine" id="cb644-27" title="27"></a>
<a class="sourceLine" id="cb644-28" title="28"><span class="bu">print</span>(<span class="st">&quot;My result:&quot;</span>, my_energy)</a>
<a class="sourceLine" id="cb644-29" title="29"><span class="bu">print</span>(<span class="st">&quot;nlcc result:&quot;</span>, nlcc_energy)</a>
<a class="sourceLine" id="cb644-30" title="30"></a>
<a class="sourceLine" id="cb644-31" title="31">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">abs</span>( my_energy <span class="op">-</span> nlcc_energy )<span class="op">&lt;</span><span class="fl">0.1</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>&#39;NoneType&#39; object has no attribute &#39;write&#39;</code></pre>
<h4 id="run-3-58">Run 3</h4>
<div class="sourceCode" id="cb646"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb646-1" title="1"><span class="im">import</span> pyscf</a>
<a class="sourceLine" id="cb646-2" title="2"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb646-3" title="3"></a>
<a class="sourceLine" id="cb646-4" title="4"><span class="kw">def</span> calc_molecule_energy(atom,basis):</a>
<a class="sourceLine" id="cb646-5" title="5">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb646-6" title="6"><span class="co">    This function returns the ground state energy for atom using restricted Hartree-Fock in the given basis</span></a>
<a class="sourceLine" id="cb646-7" title="7"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb646-8" title="8">    mol <span class="op">=</span> pyscf.gto.M(atom<span class="op">=</span>atom,basis<span class="op">=</span>basis)</a>
<a class="sourceLine" id="cb646-9" title="9">    mf <span class="op">=</span> pyscf.scf.RHF(mol)</a>
<a class="sourceLine" id="cb646-10" title="10">    mf.scf()</a>
<a class="sourceLine" id="cb646-11" title="11">    ground_energy <span class="op">=</span> mf.e_tot</a>
<a class="sourceLine" id="cb646-12" title="12">    <span class="bu">print</span>(ground_energy)</a>
<a class="sourceLine" id="cb646-13" title="13">    <span class="cf">return</span> ground_energy</a>
<a class="sourceLine" id="cb646-14" title="14">atom_coordinates <span class="op">=</span> <span class="st">&quot;H 0 0 0; F 0 0 1&quot;</span></a>
<a class="sourceLine" id="cb646-15" title="15">basis <span class="op">=</span> <span class="st">&quot;sto-3g&quot;</span></a>
<a class="sourceLine" id="cb646-16" title="16"></a>
<a class="sourceLine" id="cb646-17" title="17"><span class="co">#so that it doesn&#39;t fail b/c not importing these in prompt:</span></a>
<a class="sourceLine" id="cb646-18" title="18"><span class="im">from</span> pyscf <span class="im">import</span> gto, scf</a>
<a class="sourceLine" id="cb646-19" title="19"></a>
<a class="sourceLine" id="cb646-20" title="20"><span class="kw">def</span> calc_molecule_energy_test(atom_coordinates,basis):</a>
<a class="sourceLine" id="cb646-21" title="21">    mol <span class="op">=</span> gto.M(atom<span class="op">=</span>atom_coordinates,basis<span class="op">=</span>basis)</a>
<a class="sourceLine" id="cb646-22" title="22">    mf <span class="op">=</span> scf.RHF(mol)</a>
<a class="sourceLine" id="cb646-23" title="23">    <span class="cf">return</span> mf.kernel()</a>
<a class="sourceLine" id="cb646-24" title="24"></a>
<a class="sourceLine" id="cb646-25" title="25">my_energy <span class="op">=</span> calc_molecule_energy_test(atom_coordinates,basis)</a>
<a class="sourceLine" id="cb646-26" title="26">nlcc_energy <span class="op">=</span> calc_molecule_energy(atom_coordinates,basis)</a>
<a class="sourceLine" id="cb646-27" title="27"></a>
<a class="sourceLine" id="cb646-28" title="28"><span class="bu">print</span>(<span class="st">&quot;My result:&quot;</span>, my_energy)</a>
<a class="sourceLine" id="cb646-29" title="29"><span class="bu">print</span>(<span class="st">&quot;nlcc result:&quot;</span>, nlcc_energy)</a>
<a class="sourceLine" id="cb646-30" title="30"></a>
<a class="sourceLine" id="cb646-31" title="31">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">abs</span>( my_energy <span class="op">-</span> nlcc_energy )<span class="op">&lt;</span><span class="fl">0.1</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>&#39;NoneType&#39; object has no attribute &#39;write&#39;</code></pre>
<h4 id="run-4-58">Run 4</h4>
<div class="sourceCode" id="cb648"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb648-1" title="1"><span class="im">import</span> pyscf</a>
<a class="sourceLine" id="cb648-2" title="2"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb648-3" title="3"></a>
<a class="sourceLine" id="cb648-4" title="4"><span class="kw">def</span> calc_molecule_energy(atom,basis):</a>
<a class="sourceLine" id="cb648-5" title="5">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb648-6" title="6"><span class="co">    This function returns the ground state energy for atom using restricted Hartree-Fock in the given basis</span></a>
<a class="sourceLine" id="cb648-7" title="7"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb648-8" title="8">    mol <span class="op">=</span> pyscf.gto.Mole()</a>
<a class="sourceLine" id="cb648-9" title="9">    mol.atom <span class="op">=</span> atom</a>
<a class="sourceLine" id="cb648-10" title="10">    mol.basis <span class="op">=</span> basis</a>
<a class="sourceLine" id="cb648-11" title="11">    mol.build()</a>
<a class="sourceLine" id="cb648-12" title="12">    mf <span class="op">=</span> pyscf.scf.RHF(mol)</a>
<a class="sourceLine" id="cb648-13" title="13">    mf.kernel()</a>
<a class="sourceLine" id="cb648-14" title="14">    ground_energy <span class="op">=</span> mf.e_tot</a>
<a class="sourceLine" id="cb648-15" title="15">    <span class="cf">return</span> ground_energy</a>
<a class="sourceLine" id="cb648-16" title="16"></a>
<a class="sourceLine" id="cb648-17" title="17"></a>
<a class="sourceLine" id="cb648-18" title="18">    <span class="cf">return</span> ground_energy</a>
<a class="sourceLine" id="cb648-19" title="19">atom_coordinates <span class="op">=</span> <span class="st">&quot;H 0 0 0; F 0 0 1&quot;</span></a>
<a class="sourceLine" id="cb648-20" title="20">basis <span class="op">=</span> <span class="st">&quot;sto-3g&quot;</span></a>
<a class="sourceLine" id="cb648-21" title="21"></a>
<a class="sourceLine" id="cb648-22" title="22"><span class="co">#so that it doesn&#39;t fail b/c not importing these in prompt:</span></a>
<a class="sourceLine" id="cb648-23" title="23"><span class="im">from</span> pyscf <span class="im">import</span> gto, scf</a>
<a class="sourceLine" id="cb648-24" title="24"></a>
<a class="sourceLine" id="cb648-25" title="25"><span class="kw">def</span> calc_molecule_energy_test(atom_coordinates,basis):</a>
<a class="sourceLine" id="cb648-26" title="26">    mol <span class="op">=</span> gto.M(atom<span class="op">=</span>atom_coordinates,basis<span class="op">=</span>basis)</a>
<a class="sourceLine" id="cb648-27" title="27">    mf <span class="op">=</span> scf.RHF(mol)</a>
<a class="sourceLine" id="cb648-28" title="28">    <span class="cf">return</span> mf.kernel()</a>
<a class="sourceLine" id="cb648-29" title="29"></a>
<a class="sourceLine" id="cb648-30" title="30">my_energy <span class="op">=</span> calc_molecule_energy_test(atom_coordinates,basis)</a>
<a class="sourceLine" id="cb648-31" title="31">nlcc_energy <span class="op">=</span> calc_molecule_energy(atom_coordinates,basis)</a>
<a class="sourceLine" id="cb648-32" title="32"></a>
<a class="sourceLine" id="cb648-33" title="33"><span class="bu">print</span>(<span class="st">&quot;My result:&quot;</span>, my_energy)</a>
<a class="sourceLine" id="cb648-34" title="34"><span class="bu">print</span>(<span class="st">&quot;nlcc result:&quot;</span>, nlcc_energy)</a>
<a class="sourceLine" id="cb648-35" title="35"></a>
<a class="sourceLine" id="cb648-36" title="36">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">abs</span>( my_energy <span class="op">-</span> nlcc_energy )<span class="op">&lt;</span><span class="fl">0.1</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>&#39;NoneType&#39; object has no attribute &#39;write&#39;</code></pre>
</details>
<details>
<p><summary>qed</summary></p>
<h4 id="query-59">Query</h4>
<div class="sourceCode" id="cb650"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb650-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb650-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb650-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb650-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb650-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb650-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb650-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb650-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb650-9" title="9"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb650-10" title="10"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb650-11" title="11"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb650-12" title="12"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb650-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb650-14" title="14"></a>
<a class="sourceLine" id="cb650-15" title="15"><span class="kw">def</span> qed(smiles):</a>
<a class="sourceLine" id="cb650-16" title="16">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb650-17" title="17"><span class="co">    This function takes a SMILES string and returns the quantitative estimation of drug-likeness for the molecule.</span></a>
<a class="sourceLine" id="cb650-18" title="18"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb650-19" title="19">    [insert]</a>
<a class="sourceLine" id="cb650-20" title="20">    <span class="cf">return</span> result</a></code></pre></div>
<h4 id="run-0-59">Run 0</h4>
<div class="sourceCode" id="cb651"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb651-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb651-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb651-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb651-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb651-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb651-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb651-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb651-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb651-9" title="9"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb651-10" title="10"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb651-11" title="11"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb651-12" title="12"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb651-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb651-14" title="14"></a>
<a class="sourceLine" id="cb651-15" title="15"><span class="kw">def</span> qed(smiles):</a>
<a class="sourceLine" id="cb651-16" title="16">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb651-17" title="17"><span class="co">    This function takes a SMILES string and returns the quantitative estimation of drug-likeness for the molecule.</span></a>
<a class="sourceLine" id="cb651-18" title="18"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb651-19" title="19">    mol <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb651-20" title="20">    qed_value <span class="op">=</span> Crippen.MolLogP(mol) <span class="op">+</span> Descriptors.MolWt(mol)</a>
<a class="sourceLine" id="cb651-21" title="21">    <span class="cf">return</span> qed_value</a>
<a class="sourceLine" id="cb651-22" title="22"></a>
<a class="sourceLine" id="cb651-23" title="23"></a>
<a class="sourceLine" id="cb651-24" title="24">    <span class="cf">return</span> result</a>
<a class="sourceLine" id="cb651-25" title="25"><span class="im">from</span> rdkit.Chem <span class="im">import</span> QED</a>
<a class="sourceLine" id="cb651-26" title="26">smiles <span class="op">=</span> <span class="st">&#39;CC1=CN=C(C(=C1OC)C)CS(=O)C2=NC3=C(N2)C=C(C=C3)OC&#39;</span> <span class="co"># omeprazole</span></a>
<a class="sourceLine" id="cb651-27" title="27">m <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb651-28" title="28">q <span class="op">=</span> QED.qed(m)</a>
<a class="sourceLine" id="cb651-29" title="29"></a>
<a class="sourceLine" id="cb651-30" title="30">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(qed(smiles), q) <span class="cf">else</span> <span class="va">False</span> </a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-59">Run 1</h4>
<div class="sourceCode" id="cb653"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb653-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb653-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb653-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb653-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb653-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb653-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb653-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb653-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb653-9" title="9"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb653-10" title="10"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb653-11" title="11"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb653-12" title="12"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb653-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb653-14" title="14"></a>
<a class="sourceLine" id="cb653-15" title="15"><span class="kw">def</span> qed(smiles):</a>
<a class="sourceLine" id="cb653-16" title="16">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb653-17" title="17"><span class="co">    This function takes a SMILES string and returns the quantitative estimation of drug-likeness for the molecule.</span></a>
<a class="sourceLine" id="cb653-18" title="18"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb653-19" title="19">    mol <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb653-20" title="20">    result <span class="op">=</span> Crippen.MolLogP(mol)</a>
<a class="sourceLine" id="cb653-21" title="21">    <span class="cf">return</span> result</a>
<a class="sourceLine" id="cb653-22" title="22"><span class="im">from</span> rdkit.Chem <span class="im">import</span> QED</a>
<a class="sourceLine" id="cb653-23" title="23">smiles <span class="op">=</span> <span class="st">&#39;CC1=CN=C(C(=C1OC)C)CS(=O)C2=NC3=C(N2)C=C(C=C3)OC&#39;</span> <span class="co"># omeprazole</span></a>
<a class="sourceLine" id="cb653-24" title="24">m <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb653-25" title="25">q <span class="op">=</span> QED.qed(m)</a>
<a class="sourceLine" id="cb653-26" title="26"></a>
<a class="sourceLine" id="cb653-27" title="27">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(qed(smiles), q) <span class="cf">else</span> <span class="va">False</span> </a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-59">Run 2</h4>
<div class="sourceCode" id="cb655"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb655-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb655-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb655-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb655-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb655-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb655-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb655-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb655-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb655-9" title="9"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb655-10" title="10"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb655-11" title="11"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb655-12" title="12"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb655-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb655-14" title="14"></a>
<a class="sourceLine" id="cb655-15" title="15"><span class="kw">def</span> qed(smiles):</a>
<a class="sourceLine" id="cb655-16" title="16">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb655-17" title="17"><span class="co">    This function takes a SMILES string and returns the quantitative estimation of drug-likeness for the molecule.</span></a>
<a class="sourceLine" id="cb655-18" title="18"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb655-19" title="19">    m <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb655-20" title="20">    result <span class="op">=</span> Crippen.MolLogP(m) <span class="op">+</span> Descriptors.MolWt(m)</a>
<a class="sourceLine" id="cb655-21" title="21">    <span class="cf">return</span> result</a>
<a class="sourceLine" id="cb655-22" title="22"></a>
<a class="sourceLine" id="cb655-23" title="23"></a>
<a class="sourceLine" id="cb655-24" title="24">    <span class="cf">return</span> result</a>
<a class="sourceLine" id="cb655-25" title="25"><span class="im">from</span> rdkit.Chem <span class="im">import</span> QED</a>
<a class="sourceLine" id="cb655-26" title="26">smiles <span class="op">=</span> <span class="st">&#39;CC1=CN=C(C(=C1OC)C)CS(=O)C2=NC3=C(N2)C=C(C=C3)OC&#39;</span> <span class="co"># omeprazole</span></a>
<a class="sourceLine" id="cb655-27" title="27">m <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb655-28" title="28">q <span class="op">=</span> QED.qed(m)</a>
<a class="sourceLine" id="cb655-29" title="29"></a>
<a class="sourceLine" id="cb655-30" title="30">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(qed(smiles), q) <span class="cf">else</span> <span class="va">False</span> </a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-59">Run 3</h4>
<div class="sourceCode" id="cb657"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb657-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb657-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb657-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb657-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb657-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb657-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb657-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb657-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb657-9" title="9"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb657-10" title="10"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb657-11" title="11"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb657-12" title="12"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb657-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb657-14" title="14"></a>
<a class="sourceLine" id="cb657-15" title="15"><span class="kw">def</span> qed(smiles):</a>
<a class="sourceLine" id="cb657-16" title="16">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb657-17" title="17"><span class="co">    This function takes a SMILES string and returns the quantitative estimation of drug-likeness for the molecule.</span></a>
<a class="sourceLine" id="cb657-18" title="18"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb657-19" title="19">    mol <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb657-20" title="20">    result <span class="op">=</span> Crippen.MolLogP(mol)</a>
<a class="sourceLine" id="cb657-21" title="21">    <span class="cf">return</span> result</a>
<a class="sourceLine" id="cb657-22" title="22"></a>
<a class="sourceLine" id="cb657-23" title="23"></a>
<a class="sourceLine" id="cb657-24" title="24">    <span class="cf">return</span> result</a>
<a class="sourceLine" id="cb657-25" title="25"><span class="im">from</span> rdkit.Chem <span class="im">import</span> QED</a>
<a class="sourceLine" id="cb657-26" title="26">smiles <span class="op">=</span> <span class="st">&#39;CC1=CN=C(C(=C1OC)C)CS(=O)C2=NC3=C(N2)C=C(C=C3)OC&#39;</span> <span class="co"># omeprazole</span></a>
<a class="sourceLine" id="cb657-27" title="27">m <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb657-28" title="28">q <span class="op">=</span> QED.qed(m)</a>
<a class="sourceLine" id="cb657-29" title="29"></a>
<a class="sourceLine" id="cb657-30" title="30">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(qed(smiles), q) <span class="cf">else</span> <span class="va">False</span> </a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-59">Run 4</h4>
<div class="sourceCode" id="cb659"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb659-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb659-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb659-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb659-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb659-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb659-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb659-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb659-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb659-9" title="9"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb659-10" title="10"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb659-11" title="11"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb659-12" title="12"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb659-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb659-14" title="14"></a>
<a class="sourceLine" id="cb659-15" title="15"><span class="kw">def</span> qed(smiles):</a>
<a class="sourceLine" id="cb659-16" title="16">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb659-17" title="17"><span class="co">    This function takes a SMILES string and returns the quantitative estimation of drug-likeness for the molecule.</span></a>
<a class="sourceLine" id="cb659-18" title="18"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb659-19" title="19">    mol <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb659-20" title="20">    result <span class="op">=</span> Crippen.MolLogP(mol)</a>
<a class="sourceLine" id="cb659-21" title="21">    <span class="cf">return</span> result</a>
<a class="sourceLine" id="cb659-22" title="22"><span class="im">from</span> rdkit.Chem <span class="im">import</span> QED</a>
<a class="sourceLine" id="cb659-23" title="23">smiles <span class="op">=</span> <span class="st">&#39;CC1=CN=C(C(=C1OC)C)CS(=O)C2=NC3=C(N2)C=C(C=C3)OC&#39;</span> <span class="co"># omeprazole</span></a>
<a class="sourceLine" id="cb659-24" title="24">m <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb659-25" title="25">q <span class="op">=</span> QED.qed(m)</a>
<a class="sourceLine" id="cb659-26" title="26"></a>
<a class="sourceLine" id="cb659-27" title="27">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(qed(smiles), q) <span class="cf">else</span> <span class="va">False</span> </a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>quantile</summary></p>
<h4 id="query-60">Query</h4>
<div class="sourceCode" id="cb661"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb661-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb661-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb661-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb661-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb661-5" title="5"></a>
<a class="sourceLine" id="cb661-6" title="6"><span class="kw">def</span> quantile(a, q):</a>
<a class="sourceLine" id="cb661-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb661-8" title="8"><span class="co">  This function computes the q-th quantile of the numpy array a. q can be a sequence of quantiles with values between 0 and 1 inclusive.</span></a>
<a class="sourceLine" id="cb661-9" title="9"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb661-10" title="10">  [insert]</a>
<a class="sourceLine" id="cb661-11" title="11">  <span class="cf">return</span> result</a></code></pre></div>
<h4 id="run-0-60">Run 0</h4>
<div class="sourceCode" id="cb662"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb662-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb662-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb662-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb662-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb662-5" title="5"></a>
<a class="sourceLine" id="cb662-6" title="6"><span class="kw">def</span> quantile(a, q):</a>
<a class="sourceLine" id="cb662-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb662-8" title="8"><span class="co">  This function computes the q-th quantile of the numpy array a. q can be a sequence of quantiles with values between 0 and 1 inclusive.</span></a>
<a class="sourceLine" id="cb662-9" title="9"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb662-10" title="10">  <span class="co"># Sort the array</span></a>
<a class="sourceLine" id="cb662-11" title="11">  a <span class="op">=</span> np.sort(a)</a>
<a class="sourceLine" id="cb662-12" title="12">  <span class="co"># Compute the quantiles</span></a>
<a class="sourceLine" id="cb662-13" title="13">  q <span class="op">=</span> np.array(q)</a>
<a class="sourceLine" id="cb662-14" title="14">  result <span class="op">=</span> np.zeros(q.size)</a>
<a class="sourceLine" id="cb662-15" title="15">  <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(q.size):</a>
<a class="sourceLine" id="cb662-16" title="16">    result[i] <span class="op">=</span> a[<span class="bu">int</span>(q[i]<span class="op">*</span>a.size)]</a>
<a class="sourceLine" id="cb662-17" title="17">  <span class="cf">return</span> result</a>
<a class="sourceLine" id="cb662-18" title="18"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb662-19" title="19"></a>
<a class="sourceLine" id="cb662-20" title="20">np.random.seed(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb662-21" title="21">M <span class="op">=</span> <span class="dv">100</span></a>
<a class="sourceLine" id="cb662-22" title="22">data <span class="op">=</span> np.random.randint(<span class="dv">1</span>, M, size<span class="op">=</span>(M,))</a>
<a class="sourceLine" id="cb662-23" title="23">quantiles <span class="op">=</span> [<span class="fl">0.1</span>, <span class="fl">0.5</span>, <span class="fl">0.9</span>]</a>
<a class="sourceLine" id="cb662-24" title="24"></a>
<a class="sourceLine" id="cb662-25" title="25">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.allclose(</a>
<a class="sourceLine" id="cb662-26" title="26">    quantile(data, quantiles), np.quantile(data, q<span class="op">=</span>quantiles)) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-60">Run 1</h4>
<div class="sourceCode" id="cb664"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb664-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb664-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb664-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb664-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb664-5" title="5"></a>
<a class="sourceLine" id="cb664-6" title="6"><span class="kw">def</span> quantile(a, q):</a>
<a class="sourceLine" id="cb664-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb664-8" title="8"><span class="co">  This function computes the q-th quantile of the numpy array a. q can be a sequence of quantiles with values between 0 and 1 inclusive.</span></a>
<a class="sourceLine" id="cb664-9" title="9"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb664-10" title="10">  result <span class="op">=</span> np.percentile(a, q <span class="op">*</span> <span class="dv">100</span>)</a>
<a class="sourceLine" id="cb664-11" title="11">  <span class="cf">return</span> result</a>
<a class="sourceLine" id="cb664-12" title="12"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb664-13" title="13"></a>
<a class="sourceLine" id="cb664-14" title="14">np.random.seed(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb664-15" title="15">M <span class="op">=</span> <span class="dv">100</span></a>
<a class="sourceLine" id="cb664-16" title="16">data <span class="op">=</span> np.random.randint(<span class="dv">1</span>, M, size<span class="op">=</span>(M,))</a>
<a class="sourceLine" id="cb664-17" title="17">quantiles <span class="op">=</span> [<span class="fl">0.1</span>, <span class="fl">0.5</span>, <span class="fl">0.9</span>]</a>
<a class="sourceLine" id="cb664-18" title="18"></a>
<a class="sourceLine" id="cb664-19" title="19">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.allclose(</a>
<a class="sourceLine" id="cb664-20" title="20">    quantile(data, quantiles), np.quantile(data, q<span class="op">=</span>quantiles)) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>operands could not be broadcast together with shapes (300,) (3,) </code></pre>
<h4 id="run-2-60">Run 2</h4>
<div class="sourceCode" id="cb666"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb666-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb666-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb666-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb666-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb666-5" title="5"></a>
<a class="sourceLine" id="cb666-6" title="6"><span class="kw">def</span> quantile(a, q):</a>
<a class="sourceLine" id="cb666-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb666-8" title="8"><span class="co">  This function computes the q-th quantile of the numpy array a. q can be a sequence of quantiles with values between 0 and 1 inclusive.</span></a>
<a class="sourceLine" id="cb666-9" title="9"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb666-10" title="10">  result <span class="op">=</span> np.percentile(a, [<span class="fl">100.</span> <span class="op">*</span> qi <span class="cf">for</span> qi <span class="kw">in</span> q])</a>
<a class="sourceLine" id="cb666-11" title="11">  <span class="cf">return</span> result</a>
<a class="sourceLine" id="cb666-12" title="12"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb666-13" title="13"></a>
<a class="sourceLine" id="cb666-14" title="14">np.random.seed(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb666-15" title="15">M <span class="op">=</span> <span class="dv">100</span></a>
<a class="sourceLine" id="cb666-16" title="16">data <span class="op">=</span> np.random.randint(<span class="dv">1</span>, M, size<span class="op">=</span>(M,))</a>
<a class="sourceLine" id="cb666-17" title="17">quantiles <span class="op">=</span> [<span class="fl">0.1</span>, <span class="fl">0.5</span>, <span class="fl">0.9</span>]</a>
<a class="sourceLine" id="cb666-18" title="18"></a>
<a class="sourceLine" id="cb666-19" title="19">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.allclose(</a>
<a class="sourceLine" id="cb666-20" title="20">    quantile(data, quantiles), np.quantile(data, q<span class="op">=</span>quantiles)) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-60">Run 3</h4>
<div class="sourceCode" id="cb668"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb668-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb668-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb668-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb668-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb668-5" title="5"></a>
<a class="sourceLine" id="cb668-6" title="6"><span class="kw">def</span> quantile(a, q):</a>
<a class="sourceLine" id="cb668-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb668-8" title="8"><span class="co">  This function computes the q-th quantile of the numpy array a. q can be a sequence of quantiles with values between 0 and 1 inclusive.</span></a>
<a class="sourceLine" id="cb668-9" title="9"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb668-10" title="10">  result <span class="op">=</span> np.percentile(a, q<span class="op">*</span><span class="dv">100</span>)</a>
<a class="sourceLine" id="cb668-11" title="11">  <span class="cf">return</span> result</a>
<a class="sourceLine" id="cb668-12" title="12"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb668-13" title="13"></a>
<a class="sourceLine" id="cb668-14" title="14">np.random.seed(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb668-15" title="15">M <span class="op">=</span> <span class="dv">100</span></a>
<a class="sourceLine" id="cb668-16" title="16">data <span class="op">=</span> np.random.randint(<span class="dv">1</span>, M, size<span class="op">=</span>(M,))</a>
<a class="sourceLine" id="cb668-17" title="17">quantiles <span class="op">=</span> [<span class="fl">0.1</span>, <span class="fl">0.5</span>, <span class="fl">0.9</span>]</a>
<a class="sourceLine" id="cb668-18" title="18"></a>
<a class="sourceLine" id="cb668-19" title="19">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.allclose(</a>
<a class="sourceLine" id="cb668-20" title="20">    quantile(data, quantiles), np.quantile(data, q<span class="op">=</span>quantiles)) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>operands could not be broadcast together with shapes (300,) (3,) </code></pre>
<h4 id="run-4-60">Run 4</h4>
<div class="sourceCode" id="cb670"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb670-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb670-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb670-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb670-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb670-5" title="5"></a>
<a class="sourceLine" id="cb670-6" title="6"><span class="kw">def</span> quantile(a, q):</a>
<a class="sourceLine" id="cb670-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb670-8" title="8"><span class="co">  This function computes the q-th quantile of the numpy array a. q can be a sequence of quantiles with values between 0 and 1 inclusive.</span></a>
<a class="sourceLine" id="cb670-9" title="9"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb670-10" title="10">  a <span class="op">=</span> np.array(a)</a>
<a class="sourceLine" id="cb670-11" title="11">  a <span class="op">=</span> a[<span class="op">~</span>np.isnan(a)]</a>
<a class="sourceLine" id="cb670-12" title="12">  <span class="cf">if</span> <span class="bu">len</span>(a) <span class="op">==</span> <span class="dv">0</span>:</a>
<a class="sourceLine" id="cb670-13" title="13">    <span class="cf">return</span> np.nan</a>
<a class="sourceLine" id="cb670-14" title="14">  <span class="cf">if</span> <span class="bu">isinstance</span>(q, <span class="bu">float</span>):</a>
<a class="sourceLine" id="cb670-15" title="15">    q <span class="op">=</span> [q]</a>
<a class="sourceLine" id="cb670-16" title="16">  result <span class="op">=</span> np.zeros(<span class="bu">len</span>(q))</a>
<a class="sourceLine" id="cb670-17" title="17">  <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(q)):</a>
<a class="sourceLine" id="cb670-18" title="18">    result[i] <span class="op">=</span> np.percentile(a, q[i]<span class="op">*</span><span class="dv">100</span>)</a>
<a class="sourceLine" id="cb670-19" title="19">  <span class="cf">return</span> result</a>
<a class="sourceLine" id="cb670-20" title="20"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb670-21" title="21"></a>
<a class="sourceLine" id="cb670-22" title="22">np.random.seed(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb670-23" title="23">M <span class="op">=</span> <span class="dv">100</span></a>
<a class="sourceLine" id="cb670-24" title="24">data <span class="op">=</span> np.random.randint(<span class="dv">1</span>, M, size<span class="op">=</span>(M,))</a>
<a class="sourceLine" id="cb670-25" title="25">quantiles <span class="op">=</span> [<span class="fl">0.1</span>, <span class="fl">0.5</span>, <span class="fl">0.9</span>]</a>
<a class="sourceLine" id="cb670-26" title="26"></a>
<a class="sourceLine" id="cb670-27" title="27">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.allclose(</a>
<a class="sourceLine" id="cb670-28" title="28">    quantile(data, quantiles), np.quantile(data, q<span class="op">=</span>quantiles)) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>random_walk</summary></p>
<h4 id="query-61">Query</h4>
<div class="sourceCode" id="cb672"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb672-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb672-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb672-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb672-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb672-5" title="5"></a>
<a class="sourceLine" id="cb672-6" title="6"><span class="kw">def</span> random_walk(N):</a>
<a class="sourceLine" id="cb672-7" title="7">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb672-8" title="8"><span class="co">    This function returns the trajectory of an N step random walk on a one dimensional lattice</span></a>
<a class="sourceLine" id="cb672-9" title="9"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb672-10" title="10">    a <span class="op">=</span> <span class="dv">1</span> <span class="co"># lattice spacing</span></a>
<a class="sourceLine" id="cb672-11" title="11">    x0 <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb672-12" title="12">    [insert]</a>
<a class="sourceLine" id="cb672-13" title="13">    <span class="cf">return</span> traj</a></code></pre></div>
<h4 id="run-0-61">Run 0</h4>
<div class="sourceCode" id="cb673"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb673-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb673-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb673-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb673-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb673-5" title="5"></a>
<a class="sourceLine" id="cb673-6" title="6"><span class="kw">def</span> random_walk(N):</a>
<a class="sourceLine" id="cb673-7" title="7">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb673-8" title="8"><span class="co">    This function returns the trajectory of an N step random walk on a one dimensional lattice</span></a>
<a class="sourceLine" id="cb673-9" title="9"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb673-10" title="10">    a <span class="op">=</span> <span class="dv">1</span> <span class="co"># lattice spacing</span></a>
<a class="sourceLine" id="cb673-11" title="11">    x0 <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb673-12" title="12">    traj <span class="op">=</span> np.zeros(N)</a>
<a class="sourceLine" id="cb673-13" title="13">    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(N):</a>
<a class="sourceLine" id="cb673-14" title="14">        traj[i] <span class="op">=</span> x0</a>
<a class="sourceLine" id="cb673-15" title="15">        x0 <span class="op">+=</span> a<span class="op">*</span>(np.random.randint(<span class="dv">2</span>)<span class="op">*</span><span class="dv">2-1</span>)</a>
<a class="sourceLine" id="cb673-16" title="16">    <span class="cf">return</span> traj</a>
<a class="sourceLine" id="cb673-17" title="17"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb673-18" title="18"><span class="im">import</span> pylab <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb673-19" title="19">nsteps <span class="op">=</span> <span class="dv">5000</span></a>
<a class="sourceLine" id="cb673-20" title="20">n_repeats <span class="op">=</span> <span class="dv">250</span></a>
<a class="sourceLine" id="cb673-21" title="21">nlcc_trj_list <span class="op">=</span> []</a>
<a class="sourceLine" id="cb673-22" title="22"><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n_repeats):</a>
<a class="sourceLine" id="cb673-23" title="23">    nlcc_trj <span class="op">=</span> random_walk(nsteps)</a>
<a class="sourceLine" id="cb673-24" title="24">    nlcc_trj_list.append(nlcc_trj)</a>
<a class="sourceLine" id="cb673-25" title="25">nlcc_trj_list <span class="op">=</span> np.array(nlcc_trj_list)</a>
<a class="sourceLine" id="cb673-26" title="26"></a>
<a class="sourceLine" id="cb673-27" title="27">msd <span class="op">=</span> (nlcc_trj_list<span class="op">*</span>nlcc_trj_list).mean(axis<span class="op">=</span><span class="dv">0</span>)</a>
<a class="sourceLine" id="cb673-28" title="28"></a>
<a class="sourceLine" id="cb673-29" title="29">a,b <span class="op">=</span> np.polyfit(np.log(np.arange(<span class="dv">1</span>,nsteps)),np.log(msd[<span class="dv">1</span>:]),<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb673-30" title="30"><span class="co">#plt.plot(np.arange(nsteps),msd)</span></a>
<a class="sourceLine" id="cb673-31" title="31"><span class="co">#plt.plot(np.arange(nsteps),np.exp(b+a*np.log(np.arange(nsteps))),linestyle=&#39;--&#39;,label=&#39;fit&#39;)</span></a>
<a class="sourceLine" id="cb673-32" title="32"><span class="co">#plt.legend()</span></a>
<a class="sourceLine" id="cb673-33" title="33"><span class="co">#plt.show()</span></a>
<a class="sourceLine" id="cb673-34" title="34"><span class="co">#print(&quot;a =&quot;,a)</span></a>
<a class="sourceLine" id="cb673-35" title="35"><span class="co">#print(&quot;b =&quot;,b)</span></a>
<a class="sourceLine" id="cb673-36" title="36"></a>
<a class="sourceLine" id="cb673-37" title="37"><span class="co">#ideal exponent for msd is 1</span></a>
<a class="sourceLine" id="cb673-38" title="38">ideal <span class="op">=</span> <span class="fl">1.0</span></a>
<a class="sourceLine" id="cb673-39" title="39">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">abs</span>((a<span class="op">-</span>ideal)<span class="op">/</span>ideal) <span class="op">&lt;</span> <span class="fl">0.1</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-61">Run 1</h4>
<div class="sourceCode" id="cb675"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb675-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb675-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb675-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb675-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb675-5" title="5"></a>
<a class="sourceLine" id="cb675-6" title="6"><span class="kw">def</span> random_walk(N):</a>
<a class="sourceLine" id="cb675-7" title="7">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb675-8" title="8"><span class="co">    This function returns the trajectory of an N step random walk on a one dimensional lattice</span></a>
<a class="sourceLine" id="cb675-9" title="9"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb675-10" title="10">    a <span class="op">=</span> <span class="dv">1</span> <span class="co"># lattice spacing</span></a>
<a class="sourceLine" id="cb675-11" title="11">    x0 <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb675-12" title="12">    traj <span class="op">=</span> np.zeros(N)</a>
<a class="sourceLine" id="cb675-13" title="13">    traj[<span class="dv">0</span>] <span class="op">=</span> x0</a>
<a class="sourceLine" id="cb675-14" title="14">    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>,N):</a>
<a class="sourceLine" id="cb675-15" title="15">        traj[i] <span class="op">=</span> traj[i<span class="dv">-1</span>] <span class="op">+</span> a<span class="op">*</span>(<span class="dv">2</span><span class="op">*</span>np.random.randint(<span class="dv">2</span>)<span class="op">-</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb675-16" title="16">    </a>
<a class="sourceLine" id="cb675-17" title="17">    <span class="cf">return</span> traj</a>
<a class="sourceLine" id="cb675-18" title="18"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb675-19" title="19"><span class="im">import</span> pylab <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb675-20" title="20">nsteps <span class="op">=</span> <span class="dv">5000</span></a>
<a class="sourceLine" id="cb675-21" title="21">n_repeats <span class="op">=</span> <span class="dv">250</span></a>
<a class="sourceLine" id="cb675-22" title="22">nlcc_trj_list <span class="op">=</span> []</a>
<a class="sourceLine" id="cb675-23" title="23"><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n_repeats):</a>
<a class="sourceLine" id="cb675-24" title="24">    nlcc_trj <span class="op">=</span> random_walk(nsteps)</a>
<a class="sourceLine" id="cb675-25" title="25">    nlcc_trj_list.append(nlcc_trj)</a>
<a class="sourceLine" id="cb675-26" title="26">nlcc_trj_list <span class="op">=</span> np.array(nlcc_trj_list)</a>
<a class="sourceLine" id="cb675-27" title="27"></a>
<a class="sourceLine" id="cb675-28" title="28">msd <span class="op">=</span> (nlcc_trj_list<span class="op">*</span>nlcc_trj_list).mean(axis<span class="op">=</span><span class="dv">0</span>)</a>
<a class="sourceLine" id="cb675-29" title="29"></a>
<a class="sourceLine" id="cb675-30" title="30">a,b <span class="op">=</span> np.polyfit(np.log(np.arange(<span class="dv">1</span>,nsteps)),np.log(msd[<span class="dv">1</span>:]),<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb675-31" title="31"><span class="co">#plt.plot(np.arange(nsteps),msd)</span></a>
<a class="sourceLine" id="cb675-32" title="32"><span class="co">#plt.plot(np.arange(nsteps),np.exp(b+a*np.log(np.arange(nsteps))),linestyle=&#39;--&#39;,label=&#39;fit&#39;)</span></a>
<a class="sourceLine" id="cb675-33" title="33"><span class="co">#plt.legend()</span></a>
<a class="sourceLine" id="cb675-34" title="34"><span class="co">#plt.show()</span></a>
<a class="sourceLine" id="cb675-35" title="35"><span class="co">#print(&quot;a =&quot;,a)</span></a>
<a class="sourceLine" id="cb675-36" title="36"><span class="co">#print(&quot;b =&quot;,b)</span></a>
<a class="sourceLine" id="cb675-37" title="37"></a>
<a class="sourceLine" id="cb675-38" title="38"><span class="co">#ideal exponent for msd is 1</span></a>
<a class="sourceLine" id="cb675-39" title="39">ideal <span class="op">=</span> <span class="fl">1.0</span></a>
<a class="sourceLine" id="cb675-40" title="40">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">abs</span>((a<span class="op">-</span>ideal)<span class="op">/</span>ideal) <span class="op">&lt;</span> <span class="fl">0.1</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-61">Run 2</h4>
<div class="sourceCode" id="cb677"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb677-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb677-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb677-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb677-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb677-5" title="5"></a>
<a class="sourceLine" id="cb677-6" title="6"><span class="kw">def</span> random_walk(N):</a>
<a class="sourceLine" id="cb677-7" title="7">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb677-8" title="8"><span class="co">    This function returns the trajectory of an N step random walk on a one dimensional lattice</span></a>
<a class="sourceLine" id="cb677-9" title="9"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb677-10" title="10">    a <span class="op">=</span> <span class="dv">1</span> <span class="co"># lattice spacing</span></a>
<a class="sourceLine" id="cb677-11" title="11">    x0 <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb677-12" title="12">    traj <span class="op">=</span> np.zeros(N)</a>
<a class="sourceLine" id="cb677-13" title="13">    traj[<span class="dv">0</span>] <span class="op">=</span> x0</a>
<a class="sourceLine" id="cb677-14" title="14">    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>,N):</a>
<a class="sourceLine" id="cb677-15" title="15">        traj[i] <span class="op">=</span> traj[i<span class="dv">-1</span>] <span class="op">+</span> a<span class="op">*</span>np.random.choice([<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb677-16" title="16">    <span class="cf">return</span> traj</a>
<a class="sourceLine" id="cb677-17" title="17"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb677-18" title="18"><span class="im">import</span> pylab <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb677-19" title="19">nsteps <span class="op">=</span> <span class="dv">5000</span></a>
<a class="sourceLine" id="cb677-20" title="20">n_repeats <span class="op">=</span> <span class="dv">250</span></a>
<a class="sourceLine" id="cb677-21" title="21">nlcc_trj_list <span class="op">=</span> []</a>
<a class="sourceLine" id="cb677-22" title="22"><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n_repeats):</a>
<a class="sourceLine" id="cb677-23" title="23">    nlcc_trj <span class="op">=</span> random_walk(nsteps)</a>
<a class="sourceLine" id="cb677-24" title="24">    nlcc_trj_list.append(nlcc_trj)</a>
<a class="sourceLine" id="cb677-25" title="25">nlcc_trj_list <span class="op">=</span> np.array(nlcc_trj_list)</a>
<a class="sourceLine" id="cb677-26" title="26"></a>
<a class="sourceLine" id="cb677-27" title="27">msd <span class="op">=</span> (nlcc_trj_list<span class="op">*</span>nlcc_trj_list).mean(axis<span class="op">=</span><span class="dv">0</span>)</a>
<a class="sourceLine" id="cb677-28" title="28"></a>
<a class="sourceLine" id="cb677-29" title="29">a,b <span class="op">=</span> np.polyfit(np.log(np.arange(<span class="dv">1</span>,nsteps)),np.log(msd[<span class="dv">1</span>:]),<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb677-30" title="30"><span class="co">#plt.plot(np.arange(nsteps),msd)</span></a>
<a class="sourceLine" id="cb677-31" title="31"><span class="co">#plt.plot(np.arange(nsteps),np.exp(b+a*np.log(np.arange(nsteps))),linestyle=&#39;--&#39;,label=&#39;fit&#39;)</span></a>
<a class="sourceLine" id="cb677-32" title="32"><span class="co">#plt.legend()</span></a>
<a class="sourceLine" id="cb677-33" title="33"><span class="co">#plt.show()</span></a>
<a class="sourceLine" id="cb677-34" title="34"><span class="co">#print(&quot;a =&quot;,a)</span></a>
<a class="sourceLine" id="cb677-35" title="35"><span class="co">#print(&quot;b =&quot;,b)</span></a>
<a class="sourceLine" id="cb677-36" title="36"></a>
<a class="sourceLine" id="cb677-37" title="37"><span class="co">#ideal exponent for msd is 1</span></a>
<a class="sourceLine" id="cb677-38" title="38">ideal <span class="op">=</span> <span class="fl">1.0</span></a>
<a class="sourceLine" id="cb677-39" title="39">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">abs</span>((a<span class="op">-</span>ideal)<span class="op">/</span>ideal) <span class="op">&lt;</span> <span class="fl">0.1</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Timeout</code></pre>
<h4 id="run-3-61">Run 3</h4>
<div class="sourceCode" id="cb679"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb679-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb679-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb679-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb679-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb679-5" title="5"></a>
<a class="sourceLine" id="cb679-6" title="6"><span class="kw">def</span> random_walk(N):</a>
<a class="sourceLine" id="cb679-7" title="7">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb679-8" title="8"><span class="co">    This function returns the trajectory of an N step random walk on a one dimensional lattice</span></a>
<a class="sourceLine" id="cb679-9" title="9"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb679-10" title="10">    a <span class="op">=</span> <span class="dv">1</span> <span class="co"># lattice spacing</span></a>
<a class="sourceLine" id="cb679-11" title="11">    x0 <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb679-12" title="12">    traj <span class="op">=</span> np.zeros(N)</a>
<a class="sourceLine" id="cb679-13" title="13">    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(N):</a>
<a class="sourceLine" id="cb679-14" title="14">        traj[i] <span class="op">=</span> x0</a>
<a class="sourceLine" id="cb679-15" title="15">        x0 <span class="op">+=</span> a<span class="op">*</span>(<span class="dv">2</span><span class="op">*</span>np.random.randint(<span class="dv">2</span>)<span class="op">-</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb679-16" title="16">    <span class="cf">return</span> traj</a>
<a class="sourceLine" id="cb679-17" title="17"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb679-18" title="18"><span class="im">import</span> pylab <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb679-19" title="19">nsteps <span class="op">=</span> <span class="dv">5000</span></a>
<a class="sourceLine" id="cb679-20" title="20">n_repeats <span class="op">=</span> <span class="dv">250</span></a>
<a class="sourceLine" id="cb679-21" title="21">nlcc_trj_list <span class="op">=</span> []</a>
<a class="sourceLine" id="cb679-22" title="22"><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n_repeats):</a>
<a class="sourceLine" id="cb679-23" title="23">    nlcc_trj <span class="op">=</span> random_walk(nsteps)</a>
<a class="sourceLine" id="cb679-24" title="24">    nlcc_trj_list.append(nlcc_trj)</a>
<a class="sourceLine" id="cb679-25" title="25">nlcc_trj_list <span class="op">=</span> np.array(nlcc_trj_list)</a>
<a class="sourceLine" id="cb679-26" title="26"></a>
<a class="sourceLine" id="cb679-27" title="27">msd <span class="op">=</span> (nlcc_trj_list<span class="op">*</span>nlcc_trj_list).mean(axis<span class="op">=</span><span class="dv">0</span>)</a>
<a class="sourceLine" id="cb679-28" title="28"></a>
<a class="sourceLine" id="cb679-29" title="29">a,b <span class="op">=</span> np.polyfit(np.log(np.arange(<span class="dv">1</span>,nsteps)),np.log(msd[<span class="dv">1</span>:]),<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb679-30" title="30"><span class="co">#plt.plot(np.arange(nsteps),msd)</span></a>
<a class="sourceLine" id="cb679-31" title="31"><span class="co">#plt.plot(np.arange(nsteps),np.exp(b+a*np.log(np.arange(nsteps))),linestyle=&#39;--&#39;,label=&#39;fit&#39;)</span></a>
<a class="sourceLine" id="cb679-32" title="32"><span class="co">#plt.legend()</span></a>
<a class="sourceLine" id="cb679-33" title="33"><span class="co">#plt.show()</span></a>
<a class="sourceLine" id="cb679-34" title="34"><span class="co">#print(&quot;a =&quot;,a)</span></a>
<a class="sourceLine" id="cb679-35" title="35"><span class="co">#print(&quot;b =&quot;,b)</span></a>
<a class="sourceLine" id="cb679-36" title="36"></a>
<a class="sourceLine" id="cb679-37" title="37"><span class="co">#ideal exponent for msd is 1</span></a>
<a class="sourceLine" id="cb679-38" title="38">ideal <span class="op">=</span> <span class="fl">1.0</span></a>
<a class="sourceLine" id="cb679-39" title="39">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">abs</span>((a<span class="op">-</span>ideal)<span class="op">/</span>ideal) <span class="op">&lt;</span> <span class="fl">0.1</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-61">Run 4</h4>
<div class="sourceCode" id="cb681"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb681-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb681-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb681-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb681-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb681-5" title="5"></a>
<a class="sourceLine" id="cb681-6" title="6"><span class="kw">def</span> random_walk(N):</a>
<a class="sourceLine" id="cb681-7" title="7">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb681-8" title="8"><span class="co">    This function returns the trajectory of an N step random walk on a one dimensional lattice</span></a>
<a class="sourceLine" id="cb681-9" title="9"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb681-10" title="10">    a <span class="op">=</span> <span class="dv">1</span> <span class="co"># lattice spacing</span></a>
<a class="sourceLine" id="cb681-11" title="11">    x0 <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb681-12" title="12">    traj <span class="op">=</span> np.zeros(N)</a>
<a class="sourceLine" id="cb681-13" title="13">    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(N):</a>
<a class="sourceLine" id="cb681-14" title="14">        traj[i] <span class="op">=</span> x0</a>
<a class="sourceLine" id="cb681-15" title="15">        x0 <span class="op">+=</span> a<span class="op">*</span>np.random.choice([<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb681-16" title="16">    <span class="cf">return</span> traj</a>
<a class="sourceLine" id="cb681-17" title="17"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb681-18" title="18"><span class="im">import</span> pylab <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb681-19" title="19">nsteps <span class="op">=</span> <span class="dv">5000</span></a>
<a class="sourceLine" id="cb681-20" title="20">n_repeats <span class="op">=</span> <span class="dv">250</span></a>
<a class="sourceLine" id="cb681-21" title="21">nlcc_trj_list <span class="op">=</span> []</a>
<a class="sourceLine" id="cb681-22" title="22"><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n_repeats):</a>
<a class="sourceLine" id="cb681-23" title="23">    nlcc_trj <span class="op">=</span> random_walk(nsteps)</a>
<a class="sourceLine" id="cb681-24" title="24">    nlcc_trj_list.append(nlcc_trj)</a>
<a class="sourceLine" id="cb681-25" title="25">nlcc_trj_list <span class="op">=</span> np.array(nlcc_trj_list)</a>
<a class="sourceLine" id="cb681-26" title="26"></a>
<a class="sourceLine" id="cb681-27" title="27">msd <span class="op">=</span> (nlcc_trj_list<span class="op">*</span>nlcc_trj_list).mean(axis<span class="op">=</span><span class="dv">0</span>)</a>
<a class="sourceLine" id="cb681-28" title="28"></a>
<a class="sourceLine" id="cb681-29" title="29">a,b <span class="op">=</span> np.polyfit(np.log(np.arange(<span class="dv">1</span>,nsteps)),np.log(msd[<span class="dv">1</span>:]),<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb681-30" title="30"><span class="co">#plt.plot(np.arange(nsteps),msd)</span></a>
<a class="sourceLine" id="cb681-31" title="31"><span class="co">#plt.plot(np.arange(nsteps),np.exp(b+a*np.log(np.arange(nsteps))),linestyle=&#39;--&#39;,label=&#39;fit&#39;)</span></a>
<a class="sourceLine" id="cb681-32" title="32"><span class="co">#plt.legend()</span></a>
<a class="sourceLine" id="cb681-33" title="33"><span class="co">#plt.show()</span></a>
<a class="sourceLine" id="cb681-34" title="34"><span class="co">#print(&quot;a =&quot;,a)</span></a>
<a class="sourceLine" id="cb681-35" title="35"><span class="co">#print(&quot;b =&quot;,b)</span></a>
<a class="sourceLine" id="cb681-36" title="36"></a>
<a class="sourceLine" id="cb681-37" title="37"><span class="co">#ideal exponent for msd is 1</span></a>
<a class="sourceLine" id="cb681-38" title="38">ideal <span class="op">=</span> <span class="fl">1.0</span></a>
<a class="sourceLine" id="cb681-39" title="39">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">abs</span>((a<span class="op">-</span>ideal)<span class="op">/</span>ideal) <span class="op">&lt;</span> <span class="fl">0.1</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Timeout</code></pre>
</details>
<details>
<p><summary>rank</summary></p>
<h4 id="query-62">Query</h4>
<div class="sourceCode" id="cb683"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb683-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb683-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb683-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb683-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb683-5" title="5"></a>
<a class="sourceLine" id="cb683-6" title="6"><span class="kw">def</span> rank(M):</a>
<a class="sourceLine" id="cb683-7" title="7">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb683-8" title="8"><span class="co">    这个函数使用奇异值分解来计算矩阵M的秩。</span></a>
<a class="sourceLine" id="cb683-9" title="9"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb683-10" title="10">    [insert]</a>
<a class="sourceLine" id="cb683-11" title="11">    <span class="cf">return</span> r</a></code></pre></div>
<h4 id="run-0-62">Run 0</h4>
<div class="sourceCode" id="cb684"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb684-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb684-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb684-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb684-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb684-5" title="5"></a>
<a class="sourceLine" id="cb684-6" title="6"><span class="kw">def</span> rank(M):</a>
<a class="sourceLine" id="cb684-7" title="7">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb684-8" title="8"><span class="co">    这个函数使用奇异值分解来计算矩阵M的秩。</span></a>
<a class="sourceLine" id="cb684-9" title="9"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb684-10" title="10">    U, s, V <span class="op">=</span> np.linalg.svd(M)</a>
<a class="sourceLine" id="cb684-11" title="11">    r <span class="op">=</span> np.<span class="bu">sum</span>(s <span class="op">&gt;</span> <span class="fl">1e-10</span>)</a>
<a class="sourceLine" id="cb684-12" title="12">    <span class="cf">return</span> r</a>
<a class="sourceLine" id="cb684-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb684-14" title="14"></a>
<a class="sourceLine" id="cb684-15" title="15">np.random.seed(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb684-16" title="16">M <span class="op">=</span> np.random.random((<span class="dv">5</span>,<span class="dv">5</span>))</a>
<a class="sourceLine" id="cb684-17" title="17">r <span class="op">=</span> np.linalg.matrix_rank(M)</a>
<a class="sourceLine" id="cb684-18" title="18"></a>
<a class="sourceLine" id="cb684-19" title="19">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(r, rank(M)) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-62">Run 1</h4>
<div class="sourceCode" id="cb686"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb686-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb686-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb686-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb686-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb686-5" title="5"></a>
<a class="sourceLine" id="cb686-6" title="6"><span class="kw">def</span> rank(M):</a>
<a class="sourceLine" id="cb686-7" title="7">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb686-8" title="8"><span class="co">    这个函数使用奇异值分解来计算矩阵M的秩。</span></a>
<a class="sourceLine" id="cb686-9" title="9"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb686-10" title="10">    U, s, V <span class="op">=</span> np.linalg.svd(M)</a>
<a class="sourceLine" id="cb686-11" title="11">    r <span class="op">=</span> np.<span class="bu">sum</span>(s <span class="op">&gt;</span> <span class="fl">1e-10</span>)</a>
<a class="sourceLine" id="cb686-12" title="12">    <span class="cf">return</span> r</a>
<a class="sourceLine" id="cb686-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb686-14" title="14"></a>
<a class="sourceLine" id="cb686-15" title="15">np.random.seed(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb686-16" title="16">M <span class="op">=</span> np.random.random((<span class="dv">5</span>,<span class="dv">5</span>))</a>
<a class="sourceLine" id="cb686-17" title="17">r <span class="op">=</span> np.linalg.matrix_rank(M)</a>
<a class="sourceLine" id="cb686-18" title="18"></a>
<a class="sourceLine" id="cb686-19" title="19">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(r, rank(M)) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-62">Run 2</h4>
<div class="sourceCode" id="cb688"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb688-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb688-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb688-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb688-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb688-5" title="5"></a>
<a class="sourceLine" id="cb688-6" title="6"><span class="kw">def</span> rank(M):</a>
<a class="sourceLine" id="cb688-7" title="7">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb688-8" title="8"><span class="co">    这个函数使用奇异值分解来计算矩阵M的秩。</span></a>
<a class="sourceLine" id="cb688-9" title="9"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb688-10" title="10">    U, s, V <span class="op">=</span> np.linalg.svd(M)</a>
<a class="sourceLine" id="cb688-11" title="11">    r <span class="op">=</span> np.<span class="bu">sum</span>(s <span class="op">&gt;</span> <span class="fl">1e-10</span>)</a>
<a class="sourceLine" id="cb688-12" title="12">    <span class="cf">return</span> r</a>
<a class="sourceLine" id="cb688-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb688-14" title="14"></a>
<a class="sourceLine" id="cb688-15" title="15">np.random.seed(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb688-16" title="16">M <span class="op">=</span> np.random.random((<span class="dv">5</span>,<span class="dv">5</span>))</a>
<a class="sourceLine" id="cb688-17" title="17">r <span class="op">=</span> np.linalg.matrix_rank(M)</a>
<a class="sourceLine" id="cb688-18" title="18"></a>
<a class="sourceLine" id="cb688-19" title="19">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(r, rank(M)) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-62">Run 3</h4>
<div class="sourceCode" id="cb690"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb690-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb690-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb690-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb690-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb690-5" title="5"></a>
<a class="sourceLine" id="cb690-6" title="6"><span class="kw">def</span> rank(M):</a>
<a class="sourceLine" id="cb690-7" title="7">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb690-8" title="8"><span class="co">    这个函数使用奇异值分解来计算矩阵M的秩。</span></a>
<a class="sourceLine" id="cb690-9" title="9"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb690-10" title="10">    U, s, V <span class="op">=</span> np.linalg.svd(M)</a>
<a class="sourceLine" id="cb690-11" title="11">    r <span class="op">=</span> np.<span class="bu">sum</span>(s <span class="op">&gt;</span> <span class="fl">1e-10</span>)</a>
<a class="sourceLine" id="cb690-12" title="12">    <span class="cf">return</span> r</a>
<a class="sourceLine" id="cb690-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb690-14" title="14"></a>
<a class="sourceLine" id="cb690-15" title="15">np.random.seed(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb690-16" title="16">M <span class="op">=</span> np.random.random((<span class="dv">5</span>,<span class="dv">5</span>))</a>
<a class="sourceLine" id="cb690-17" title="17">r <span class="op">=</span> np.linalg.matrix_rank(M)</a>
<a class="sourceLine" id="cb690-18" title="18"></a>
<a class="sourceLine" id="cb690-19" title="19">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(r, rank(M)) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-62">Run 4</h4>
<div class="sourceCode" id="cb692"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb692-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb692-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb692-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb692-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb692-5" title="5"></a>
<a class="sourceLine" id="cb692-6" title="6"><span class="kw">def</span> rank(M):</a>
<a class="sourceLine" id="cb692-7" title="7">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb692-8" title="8"><span class="co">    这个函数使用奇异值分解来计算矩阵M的秩。</span></a>
<a class="sourceLine" id="cb692-9" title="9"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb692-10" title="10">    U, S, V <span class="op">=</span> np.linalg.svd(M)</a>
<a class="sourceLine" id="cb692-11" title="11">    r <span class="op">=</span> np.<span class="bu">sum</span>(S <span class="op">&gt;</span> <span class="fl">1e-10</span>)</a>
<a class="sourceLine" id="cb692-12" title="12">    <span class="cf">return</span> r</a>
<a class="sourceLine" id="cb692-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb692-14" title="14"></a>
<a class="sourceLine" id="cb692-15" title="15">np.random.seed(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb692-16" title="16">M <span class="op">=</span> np.random.random((<span class="dv">5</span>,<span class="dv">5</span>))</a>
<a class="sourceLine" id="cb692-17" title="17">r <span class="op">=</span> np.linalg.matrix_rank(M)</a>
<a class="sourceLine" id="cb692-18" title="18"></a>
<a class="sourceLine" id="cb692-19" title="19">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(r, rank(M)) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>rank</summary></p>
<h4 id="query-63">Query</h4>
<div class="sourceCode" id="cb694"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb694-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb694-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb694-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb694-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb694-5" title="5"></a>
<a class="sourceLine" id="cb694-6" title="6"><span class="kw">def</span> rank(M):</a>
<a class="sourceLine" id="cb694-7" title="7">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb694-8" title="8"><span class="co">    This function calculates the rank of matrix M using singular value decomposition.</span></a>
<a class="sourceLine" id="cb694-9" title="9"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb694-10" title="10">    [insert]</a>
<a class="sourceLine" id="cb694-11" title="11">    <span class="cf">return</span> r</a></code></pre></div>
<h4 id="run-0-63">Run 0</h4>
<div class="sourceCode" id="cb695"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb695-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb695-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb695-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb695-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb695-5" title="5"></a>
<a class="sourceLine" id="cb695-6" title="6"><span class="kw">def</span> rank(M):</a>
<a class="sourceLine" id="cb695-7" title="7">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb695-8" title="8"><span class="co">    This function calculates the rank of matrix M using singular value decomposition.</span></a>
<a class="sourceLine" id="cb695-9" title="9"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb695-10" title="10">    U, s, V <span class="op">=</span> np.linalg.svd(M)</a>
<a class="sourceLine" id="cb695-11" title="11">    r <span class="op">=</span> np.<span class="bu">sum</span>(s <span class="op">&gt;</span> <span class="fl">1e-10</span>)</a>
<a class="sourceLine" id="cb695-12" title="12">    <span class="cf">return</span> r</a>
<a class="sourceLine" id="cb695-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb695-14" title="14"></a>
<a class="sourceLine" id="cb695-15" title="15">np.random.seed(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb695-16" title="16">M <span class="op">=</span> np.random.random((<span class="dv">5</span>,<span class="dv">5</span>))</a>
<a class="sourceLine" id="cb695-17" title="17">r <span class="op">=</span> np.linalg.matrix_rank(M)</a>
<a class="sourceLine" id="cb695-18" title="18"></a>
<a class="sourceLine" id="cb695-19" title="19">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(r, rank(M)) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-63">Run 1</h4>
<div class="sourceCode" id="cb697"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb697-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb697-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb697-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb697-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb697-5" title="5"></a>
<a class="sourceLine" id="cb697-6" title="6"><span class="kw">def</span> rank(M):</a>
<a class="sourceLine" id="cb697-7" title="7">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb697-8" title="8"><span class="co">    This function calculates the rank of matrix M using singular value decomposition.</span></a>
<a class="sourceLine" id="cb697-9" title="9"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb697-10" title="10">    U, s, V <span class="op">=</span> np.linalg.svd(M)</a>
<a class="sourceLine" id="cb697-11" title="11">    r <span class="op">=</span> np.<span class="bu">sum</span>(s <span class="op">&gt;</span> <span class="fl">1e-6</span>)</a>
<a class="sourceLine" id="cb697-12" title="12">    <span class="cf">return</span> r</a>
<a class="sourceLine" id="cb697-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb697-14" title="14"></a>
<a class="sourceLine" id="cb697-15" title="15">np.random.seed(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb697-16" title="16">M <span class="op">=</span> np.random.random((<span class="dv">5</span>,<span class="dv">5</span>))</a>
<a class="sourceLine" id="cb697-17" title="17">r <span class="op">=</span> np.linalg.matrix_rank(M)</a>
<a class="sourceLine" id="cb697-18" title="18"></a>
<a class="sourceLine" id="cb697-19" title="19">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(r, rank(M)) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-63">Run 2</h4>
<div class="sourceCode" id="cb699"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb699-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb699-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb699-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb699-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb699-5" title="5"></a>
<a class="sourceLine" id="cb699-6" title="6"><span class="kw">def</span> rank(M):</a>
<a class="sourceLine" id="cb699-7" title="7">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb699-8" title="8"><span class="co">    This function calculates the rank of matrix M using singular value decomposition.</span></a>
<a class="sourceLine" id="cb699-9" title="9"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb699-10" title="10">    U, s, V <span class="op">=</span> np.linalg.svd(M)</a>
<a class="sourceLine" id="cb699-11" title="11">    r <span class="op">=</span> np.<span class="bu">sum</span>(s <span class="op">&gt;</span> <span class="fl">1e-12</span>)</a>
<a class="sourceLine" id="cb699-12" title="12">    <span class="cf">return</span> r</a>
<a class="sourceLine" id="cb699-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb699-14" title="14"></a>
<a class="sourceLine" id="cb699-15" title="15">np.random.seed(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb699-16" title="16">M <span class="op">=</span> np.random.random((<span class="dv">5</span>,<span class="dv">5</span>))</a>
<a class="sourceLine" id="cb699-17" title="17">r <span class="op">=</span> np.linalg.matrix_rank(M)</a>
<a class="sourceLine" id="cb699-18" title="18"></a>
<a class="sourceLine" id="cb699-19" title="19">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(r, rank(M)) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-63">Run 3</h4>
<div class="sourceCode" id="cb701"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb701-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb701-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb701-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb701-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb701-5" title="5"></a>
<a class="sourceLine" id="cb701-6" title="6"><span class="kw">def</span> rank(M):</a>
<a class="sourceLine" id="cb701-7" title="7">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb701-8" title="8"><span class="co">    This function calculates the rank of matrix M using singular value decomposition.</span></a>
<a class="sourceLine" id="cb701-9" title="9"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb701-10" title="10">    U, s, V <span class="op">=</span> np.linalg.svd(M)</a>
<a class="sourceLine" id="cb701-11" title="11">    r <span class="op">=</span> np.<span class="bu">sum</span>(s <span class="op">&gt;</span> <span class="fl">1e-12</span>)</a>
<a class="sourceLine" id="cb701-12" title="12">    <span class="cf">return</span> r</a>
<a class="sourceLine" id="cb701-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb701-14" title="14"></a>
<a class="sourceLine" id="cb701-15" title="15">np.random.seed(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb701-16" title="16">M <span class="op">=</span> np.random.random((<span class="dv">5</span>,<span class="dv">5</span>))</a>
<a class="sourceLine" id="cb701-17" title="17">r <span class="op">=</span> np.linalg.matrix_rank(M)</a>
<a class="sourceLine" id="cb701-18" title="18"></a>
<a class="sourceLine" id="cb701-19" title="19">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(r, rank(M)) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-63">Run 4</h4>
<div class="sourceCode" id="cb703"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb703-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb703-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb703-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb703-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb703-5" title="5"></a>
<a class="sourceLine" id="cb703-6" title="6"><span class="kw">def</span> rank(M):</a>
<a class="sourceLine" id="cb703-7" title="7">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb703-8" title="8"><span class="co">    This function calculates the rank of matrix M using singular value decomposition.</span></a>
<a class="sourceLine" id="cb703-9" title="9"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb703-10" title="10">    U, s, V <span class="op">=</span> np.linalg.svd(M)</a>
<a class="sourceLine" id="cb703-11" title="11">    r <span class="op">=</span> np.<span class="bu">sum</span>(s <span class="op">&gt;</span> <span class="fl">1e-12</span>)</a>
<a class="sourceLine" id="cb703-12" title="12">    <span class="cf">return</span> r</a>
<a class="sourceLine" id="cb703-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb703-14" title="14"></a>
<a class="sourceLine" id="cb703-15" title="15">np.random.seed(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb703-16" title="16">M <span class="op">=</span> np.random.random((<span class="dv">5</span>,<span class="dv">5</span>))</a>
<a class="sourceLine" id="cb703-17" title="17">r <span class="op">=</span> np.linalg.matrix_rank(M)</a>
<a class="sourceLine" id="cb703-18" title="18"></a>
<a class="sourceLine" id="cb703-19" title="19">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(r, rank(M)) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>remove-water</summary></p>
<h4 id="query-64">Query</h4>
<div class="sourceCode" id="cb705"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb705-1" title="1"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb705-2" title="2"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb705-3" title="3"></a>
<a class="sourceLine" id="cb705-4" title="4"><span class="kw">def</span> remove_water(traj_file,top_file):</a>
<a class="sourceLine" id="cb705-5" title="5">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb705-6" title="6"><span class="co">  This function removes solvent from loaded trajectory traj_file and topology in top_file to return the new trajctory</span></a>
<a class="sourceLine" id="cb705-7" title="7"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb705-8" title="8">  [insert]</a>
<a class="sourceLine" id="cb705-9" title="9">  <span class="cf">return</span> new_traj</a></code></pre></div>
<h4 id="run-0-64">Run 0</h4>
<div class="sourceCode" id="cb706"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb706-1" title="1"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb706-2" title="2"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb706-3" title="3"></a>
<a class="sourceLine" id="cb706-4" title="4"><span class="kw">def</span> remove_water(traj_file,top_file):</a>
<a class="sourceLine" id="cb706-5" title="5">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb706-6" title="6"><span class="co">  This function removes solvent from loaded trajectory traj_file and topology in top_file to return the new trajctory</span></a>
<a class="sourceLine" id="cb706-7" title="7"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb706-8" title="8">  traj <span class="op">=</span> md.load(traj_file,top<span class="op">=</span>top_file)</a>
<a class="sourceLine" id="cb706-9" title="9">  top <span class="op">=</span> traj.topology</a>
<a class="sourceLine" id="cb706-10" title="10">  new_traj <span class="op">=</span> traj.atom_slice(np.array([atom.index <span class="cf">for</span> atom <span class="kw">in</span> top.atoms <span class="cf">if</span> atom.residue.name <span class="op">!=</span> <span class="st">&#39;HOH&#39;</span>]))</a>
<a class="sourceLine" id="cb706-11" title="11">  <span class="cf">return</span> new_traj</a>
<a class="sourceLine" id="cb706-12" title="12"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb706-13" title="13"><span class="im">import</span> mdtraj <span class="im">as</span> md </a>
<a class="sourceLine" id="cb706-14" title="14"></a>
<a class="sourceLine" id="cb706-15" title="15">traj <span class="op">=</span> md.load(os.path.join(_FILE_DIR_,<span class="st">&#39;trp-cage-small.trr&#39;</span>), top<span class="op">=</span>os.path.join(_FILE_DIR_,<span class="st">&#39;trp-cage.pdb&#39;</span>))</a>
<a class="sourceLine" id="cb706-16" title="16">nowater <span class="op">=</span> traj.remove_solvent()</a>
<a class="sourceLine" id="cb706-17" title="17">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> remove_water(os.path.join(_FILE_DIR_,<span class="st">&#39;trp-cage-small.trr&#39;</span>),os.path.join(_FILE_DIR_,<span class="st">&#39;trp-cage.pdb&#39;</span>)).n_atoms <span class="op">==</span> nowater.n_atoms <span class="cf">else</span> <span class="va">False</span> </a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-64">Run 1</h4>
<div class="sourceCode" id="cb708"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb708-1" title="1"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb708-2" title="2"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb708-3" title="3"></a>
<a class="sourceLine" id="cb708-4" title="4"><span class="kw">def</span> remove_water(traj_file,top_file):</a>
<a class="sourceLine" id="cb708-5" title="5">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb708-6" title="6"><span class="co">  This function removes solvent from loaded trajectory traj_file and topology in top_file to return the new trajctory</span></a>
<a class="sourceLine" id="cb708-7" title="7"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb708-8" title="8">  traj <span class="op">=</span> md.load(traj_file,top<span class="op">=</span>top_file)</a>
<a class="sourceLine" id="cb708-9" title="9">  top <span class="op">=</span> traj.topology</a>
<a class="sourceLine" id="cb708-10" title="10">  new_traj <span class="op">=</span> traj.atom_slice(top.select(<span class="st">&#39;not water&#39;</span>))</a>
<a class="sourceLine" id="cb708-11" title="11">  <span class="cf">return</span> new_traj</a>
<a class="sourceLine" id="cb708-12" title="12"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb708-13" title="13"><span class="im">import</span> mdtraj <span class="im">as</span> md </a>
<a class="sourceLine" id="cb708-14" title="14"></a>
<a class="sourceLine" id="cb708-15" title="15">traj <span class="op">=</span> md.load(os.path.join(_FILE_DIR_,<span class="st">&#39;trp-cage-small.trr&#39;</span>), top<span class="op">=</span>os.path.join(_FILE_DIR_,<span class="st">&#39;trp-cage.pdb&#39;</span>))</a>
<a class="sourceLine" id="cb708-16" title="16">nowater <span class="op">=</span> traj.remove_solvent()</a>
<a class="sourceLine" id="cb708-17" title="17">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> remove_water(os.path.join(_FILE_DIR_,<span class="st">&#39;trp-cage-small.trr&#39;</span>),os.path.join(_FILE_DIR_,<span class="st">&#39;trp-cage.pdb&#39;</span>)).n_atoms <span class="op">==</span> nowater.n_atoms <span class="cf">else</span> <span class="va">False</span> </a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-64">Run 2</h4>
<div class="sourceCode" id="cb710"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb710-1" title="1"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb710-2" title="2"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb710-3" title="3"></a>
<a class="sourceLine" id="cb710-4" title="4"><span class="kw">def</span> remove_water(traj_file,top_file):</a>
<a class="sourceLine" id="cb710-5" title="5">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb710-6" title="6"><span class="co">  This function removes solvent from loaded trajectory traj_file and topology in top_file to return the new trajctory</span></a>
<a class="sourceLine" id="cb710-7" title="7"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb710-8" title="8">  traj <span class="op">=</span> md.load(traj_file,top<span class="op">=</span>top_file)</a>
<a class="sourceLine" id="cb710-9" title="9">  new_traj <span class="op">=</span> traj.atom_slice(traj.top.select(<span class="st">&#39;not water&#39;</span>))</a>
<a class="sourceLine" id="cb710-10" title="10">  <span class="cf">return</span> new_traj</a>
<a class="sourceLine" id="cb710-11" title="11"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb710-12" title="12"><span class="im">import</span> mdtraj <span class="im">as</span> md </a>
<a class="sourceLine" id="cb710-13" title="13"></a>
<a class="sourceLine" id="cb710-14" title="14">traj <span class="op">=</span> md.load(os.path.join(_FILE_DIR_,<span class="st">&#39;trp-cage-small.trr&#39;</span>), top<span class="op">=</span>os.path.join(_FILE_DIR_,<span class="st">&#39;trp-cage.pdb&#39;</span>))</a>
<a class="sourceLine" id="cb710-15" title="15">nowater <span class="op">=</span> traj.remove_solvent()</a>
<a class="sourceLine" id="cb710-16" title="16">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> remove_water(os.path.join(_FILE_DIR_,<span class="st">&#39;trp-cage-small.trr&#39;</span>),os.path.join(_FILE_DIR_,<span class="st">&#39;trp-cage.pdb&#39;</span>)).n_atoms <span class="op">==</span> nowater.n_atoms <span class="cf">else</span> <span class="va">False</span> </a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-64">Run 3</h4>
<div class="sourceCode" id="cb712"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb712-1" title="1"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb712-2" title="2"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb712-3" title="3"></a>
<a class="sourceLine" id="cb712-4" title="4"><span class="kw">def</span> remove_water(traj_file,top_file):</a>
<a class="sourceLine" id="cb712-5" title="5">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb712-6" title="6"><span class="co">  This function removes solvent from loaded trajectory traj_file and topology in top_file to return the new trajctory</span></a>
<a class="sourceLine" id="cb712-7" title="7"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb712-8" title="8">  traj <span class="op">=</span> md.load(traj_file,top<span class="op">=</span>top_file)</a>
<a class="sourceLine" id="cb712-9" title="9">  new_traj <span class="op">=</span> traj.atom_slice(traj.topology.select(<span class="st">&#39;not water&#39;</span>))</a>
<a class="sourceLine" id="cb712-10" title="10">  <span class="cf">return</span> new_traj</a>
<a class="sourceLine" id="cb712-11" title="11"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb712-12" title="12"><span class="im">import</span> mdtraj <span class="im">as</span> md </a>
<a class="sourceLine" id="cb712-13" title="13"></a>
<a class="sourceLine" id="cb712-14" title="14">traj <span class="op">=</span> md.load(os.path.join(_FILE_DIR_,<span class="st">&#39;trp-cage-small.trr&#39;</span>), top<span class="op">=</span>os.path.join(_FILE_DIR_,<span class="st">&#39;trp-cage.pdb&#39;</span>))</a>
<a class="sourceLine" id="cb712-15" title="15">nowater <span class="op">=</span> traj.remove_solvent()</a>
<a class="sourceLine" id="cb712-16" title="16">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> remove_water(os.path.join(_FILE_DIR_,<span class="st">&#39;trp-cage-small.trr&#39;</span>),os.path.join(_FILE_DIR_,<span class="st">&#39;trp-cage.pdb&#39;</span>)).n_atoms <span class="op">==</span> nowater.n_atoms <span class="cf">else</span> <span class="va">False</span> </a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-64">Run 4</h4>
<div class="sourceCode" id="cb714"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb714-1" title="1"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb714-2" title="2"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb714-3" title="3"></a>
<a class="sourceLine" id="cb714-4" title="4"><span class="kw">def</span> remove_water(traj_file,top_file):</a>
<a class="sourceLine" id="cb714-5" title="5">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb714-6" title="6"><span class="co">  This function removes solvent from loaded trajectory traj_file and topology in top_file to return the new trajctory</span></a>
<a class="sourceLine" id="cb714-7" title="7"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb714-8" title="8">  traj <span class="op">=</span> md.load(traj_file,top<span class="op">=</span>top_file)</a>
<a class="sourceLine" id="cb714-9" title="9">  top <span class="op">=</span> traj.topology</a>
<a class="sourceLine" id="cb714-10" title="10">  new_traj <span class="op">=</span> traj.atom_slice(top.select(<span class="st">&#39;not water&#39;</span>))</a>
<a class="sourceLine" id="cb714-11" title="11">  <span class="cf">return</span> new_traj</a>
<a class="sourceLine" id="cb714-12" title="12"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb714-13" title="13"><span class="im">import</span> mdtraj <span class="im">as</span> md </a>
<a class="sourceLine" id="cb714-14" title="14"></a>
<a class="sourceLine" id="cb714-15" title="15">traj <span class="op">=</span> md.load(os.path.join(_FILE_DIR_,<span class="st">&#39;trp-cage-small.trr&#39;</span>), top<span class="op">=</span>os.path.join(_FILE_DIR_,<span class="st">&#39;trp-cage.pdb&#39;</span>))</a>
<a class="sourceLine" id="cb714-16" title="16">nowater <span class="op">=</span> traj.remove_solvent()</a>
<a class="sourceLine" id="cb714-17" title="17">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> remove_water(os.path.join(_FILE_DIR_,<span class="st">&#39;trp-cage-small.trr&#39;</span>),os.path.join(_FILE_DIR_,<span class="st">&#39;trp-cage.pdb&#39;</span>)).n_atoms <span class="op">==</span> nowater.n_atoms <span class="cf">else</span> <span class="va">False</span> </a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>rms_velocity</summary></p>
<h4 id="query-65">Query</h4>
<div class="sourceCode" id="cb716"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb716-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb716-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb716-3" title="3"></a>
<a class="sourceLine" id="cb716-4" title="4"><span class="kw">def</span> rms_velocity(T,m):</a>
<a class="sourceLine" id="cb716-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb716-6" title="6"><span class="co">   This function returns the root-mean-squared velocity of an ideal gas molecule at temperature T</span></a>
<a class="sourceLine" id="cb716-7" title="7"><span class="co">   m is mass in g/mol</span></a>
<a class="sourceLine" id="cb716-8" title="8"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb716-9" title="9">   [insert]</a>
<a class="sourceLine" id="cb716-10" title="10">   <span class="cf">return</span> v_rms</a>
<a class="sourceLine" id="cb716-11" title="11"></a></code></pre></div>
<h4 id="run-0-65">Run 0</h4>
<div class="sourceCode" id="cb717"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb717-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb717-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb717-3" title="3"></a>
<a class="sourceLine" id="cb717-4" title="4"><span class="kw">def</span> rms_velocity(T,m):</a>
<a class="sourceLine" id="cb717-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb717-6" title="6"><span class="co">   This function returns the root-mean-squared velocity of an ideal gas molecule at temperature T</span></a>
<a class="sourceLine" id="cb717-7" title="7"><span class="co">   m is mass in g/mol</span></a>
<a class="sourceLine" id="cb717-8" title="8"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb717-9" title="9">   k <span class="op">=</span> <span class="fl">1.38064852e-23</span> <span class="co">#J/K</span></a>
<a class="sourceLine" id="cb717-10" title="10">   m <span class="op">=</span> m<span class="op">*</span><span class="fl">1.66054e-24</span> <span class="co">#g to amu</span></a>
<a class="sourceLine" id="cb717-11" title="11">   v_rms <span class="op">=</span> math.sqrt(<span class="dv">3</span><span class="op">*</span>k<span class="op">*</span>T<span class="op">/</span>m)</a>
<a class="sourceLine" id="cb717-12" title="12">   <span class="cf">return</span> v_rms</a>
<a class="sourceLine" id="cb717-13" title="13"></a>
<a class="sourceLine" id="cb717-14" title="14"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb717-15" title="15"></a>
<a class="sourceLine" id="cb717-16" title="16">m<span class="op">=</span><span class="dv">32</span></a>
<a class="sourceLine" id="cb717-17" title="17">T<span class="op">=</span><span class="dv">300</span></a>
<a class="sourceLine" id="cb717-18" title="18">R<span class="op">=</span><span class="fl">8.314</span></a>
<a class="sourceLine" id="cb717-19" title="19">v_rms <span class="op">=</span> np.sqrt(<span class="dv">3</span><span class="op">*</span>R<span class="op">*</span>T<span class="op">/</span>(m<span class="op">/</span><span class="dv">1000</span>))</a>
<a class="sourceLine" id="cb717-20" title="20"></a>
<a class="sourceLine" id="cb717-21" title="21">v_rms_codex <span class="op">=</span> rms_velocity(T,m)</a>
<a class="sourceLine" id="cb717-22" title="22"></a>
<a class="sourceLine" id="cb717-23" title="23"><span class="co"># check </span></a>
<a class="sourceLine" id="cb717-24" title="24"><span class="cf">if</span> np.isclose(v_rms, v_rms_codex, rtol<span class="op">=</span><span class="fl">0.01</span>) <span class="op">==</span> <span class="va">True</span>:</a>
<a class="sourceLine" id="cb717-25" title="25">    result <span class="op">=</span> <span class="va">True</span> </a>
<a class="sourceLine" id="cb717-26" title="26"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb717-27" title="27">    result <span class="op">=</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-65">Run 1</h4>
<div class="sourceCode" id="cb719"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb719-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb719-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb719-3" title="3"></a>
<a class="sourceLine" id="cb719-4" title="4"><span class="kw">def</span> rms_velocity(T,m):</a>
<a class="sourceLine" id="cb719-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb719-6" title="6"><span class="co">   This function returns the root-mean-squared velocity of an ideal gas molecule at temperature T</span></a>
<a class="sourceLine" id="cb719-7" title="7"><span class="co">   m is mass in g/mol</span></a>
<a class="sourceLine" id="cb719-8" title="8"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb719-9" title="9">   k <span class="op">=</span> <span class="fl">1.38064852e-23</span> <span class="co">#J/K</span></a>
<a class="sourceLine" id="cb719-10" title="10">   m <span class="op">=</span> m <span class="op">*</span> <span class="fl">1.66054e-24</span> <span class="co">#g to amu</span></a>
<a class="sourceLine" id="cb719-11" title="11">   v_rms <span class="op">=</span> math.sqrt(<span class="dv">3</span><span class="op">*</span>k<span class="op">*</span>T<span class="op">/</span>m)</a>
<a class="sourceLine" id="cb719-12" title="12">   <span class="cf">return</span> v_rms</a>
<a class="sourceLine" id="cb719-13" title="13"></a>
<a class="sourceLine" id="cb719-14" title="14"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb719-15" title="15"></a>
<a class="sourceLine" id="cb719-16" title="16">m<span class="op">=</span><span class="dv">32</span></a>
<a class="sourceLine" id="cb719-17" title="17">T<span class="op">=</span><span class="dv">300</span></a>
<a class="sourceLine" id="cb719-18" title="18">R<span class="op">=</span><span class="fl">8.314</span></a>
<a class="sourceLine" id="cb719-19" title="19">v_rms <span class="op">=</span> np.sqrt(<span class="dv">3</span><span class="op">*</span>R<span class="op">*</span>T<span class="op">/</span>(m<span class="op">/</span><span class="dv">1000</span>))</a>
<a class="sourceLine" id="cb719-20" title="20"></a>
<a class="sourceLine" id="cb719-21" title="21">v_rms_codex <span class="op">=</span> rms_velocity(T,m)</a>
<a class="sourceLine" id="cb719-22" title="22"></a>
<a class="sourceLine" id="cb719-23" title="23"><span class="co"># check </span></a>
<a class="sourceLine" id="cb719-24" title="24"><span class="cf">if</span> np.isclose(v_rms, v_rms_codex, rtol<span class="op">=</span><span class="fl">0.01</span>) <span class="op">==</span> <span class="va">True</span>:</a>
<a class="sourceLine" id="cb719-25" title="25">    result <span class="op">=</span> <span class="va">True</span> </a>
<a class="sourceLine" id="cb719-26" title="26"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb719-27" title="27">    result <span class="op">=</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-65">Run 2</h4>
<div class="sourceCode" id="cb721"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb721-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb721-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb721-3" title="3"></a>
<a class="sourceLine" id="cb721-4" title="4"><span class="kw">def</span> rms_velocity(T,m):</a>
<a class="sourceLine" id="cb721-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb721-6" title="6"><span class="co">   This function returns the root-mean-squared velocity of an ideal gas molecule at temperature T</span></a>
<a class="sourceLine" id="cb721-7" title="7"><span class="co">   m is mass in g/mol</span></a>
<a class="sourceLine" id="cb721-8" title="8"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb721-9" title="9">   k <span class="op">=</span> <span class="fl">1.38064852e-23</span> <span class="co"># Boltzmann constant</span></a>
<a class="sourceLine" id="cb721-10" title="10">   m <span class="op">=</span> m <span class="op">*</span> <span class="fl">1.66054e-24</span> <span class="co"># mass in g</span></a>
<a class="sourceLine" id="cb721-11" title="11">   v_rms <span class="op">=</span> math.sqrt(<span class="dv">3</span><span class="op">*</span>k<span class="op">*</span>T<span class="op">/</span>m)</a>
<a class="sourceLine" id="cb721-12" title="12">   <span class="cf">return</span> v_rms</a>
<a class="sourceLine" id="cb721-13" title="13"></a>
<a class="sourceLine" id="cb721-14" title="14"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb721-15" title="15"></a>
<a class="sourceLine" id="cb721-16" title="16">m<span class="op">=</span><span class="dv">32</span></a>
<a class="sourceLine" id="cb721-17" title="17">T<span class="op">=</span><span class="dv">300</span></a>
<a class="sourceLine" id="cb721-18" title="18">R<span class="op">=</span><span class="fl">8.314</span></a>
<a class="sourceLine" id="cb721-19" title="19">v_rms <span class="op">=</span> np.sqrt(<span class="dv">3</span><span class="op">*</span>R<span class="op">*</span>T<span class="op">/</span>(m<span class="op">/</span><span class="dv">1000</span>))</a>
<a class="sourceLine" id="cb721-20" title="20"></a>
<a class="sourceLine" id="cb721-21" title="21">v_rms_codex <span class="op">=</span> rms_velocity(T,m)</a>
<a class="sourceLine" id="cb721-22" title="22"></a>
<a class="sourceLine" id="cb721-23" title="23"><span class="co"># check </span></a>
<a class="sourceLine" id="cb721-24" title="24"><span class="cf">if</span> np.isclose(v_rms, v_rms_codex, rtol<span class="op">=</span><span class="fl">0.01</span>) <span class="op">==</span> <span class="va">True</span>:</a>
<a class="sourceLine" id="cb721-25" title="25">    result <span class="op">=</span> <span class="va">True</span> </a>
<a class="sourceLine" id="cb721-26" title="26"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb721-27" title="27">    result <span class="op">=</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-65">Run 3</h4>
<div class="sourceCode" id="cb723"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb723-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb723-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb723-3" title="3"></a>
<a class="sourceLine" id="cb723-4" title="4"><span class="kw">def</span> rms_velocity(T,m):</a>
<a class="sourceLine" id="cb723-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb723-6" title="6"><span class="co">   This function returns the root-mean-squared velocity of an ideal gas molecule at temperature T</span></a>
<a class="sourceLine" id="cb723-7" title="7"><span class="co">   m is mass in g/mol</span></a>
<a class="sourceLine" id="cb723-8" title="8"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb723-9" title="9">   k <span class="op">=</span> <span class="fl">1.38064852e-23</span> <span class="co">#J/K</span></a>
<a class="sourceLine" id="cb723-10" title="10">   N_A <span class="op">=</span> <span class="fl">6.022140857e23</span> <span class="co">#1/mol</span></a>
<a class="sourceLine" id="cb723-11" title="11">   m <span class="op">=</span> m<span class="op">*</span><span class="fl">1e-3</span> <span class="co">#kg/mol</span></a>
<a class="sourceLine" id="cb723-12" title="12">   v_rms <span class="op">=</span> math.sqrt(<span class="dv">3</span><span class="op">*</span>k<span class="op">*</span>T<span class="op">/</span>(m<span class="op">*</span>N_A)) <span class="co">#m/s</span></a>
<a class="sourceLine" id="cb723-13" title="13">   <span class="cf">return</span> v_rms</a>
<a class="sourceLine" id="cb723-14" title="14"></a>
<a class="sourceLine" id="cb723-15" title="15"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb723-16" title="16"></a>
<a class="sourceLine" id="cb723-17" title="17">m<span class="op">=</span><span class="dv">32</span></a>
<a class="sourceLine" id="cb723-18" title="18">T<span class="op">=</span><span class="dv">300</span></a>
<a class="sourceLine" id="cb723-19" title="19">R<span class="op">=</span><span class="fl">8.314</span></a>
<a class="sourceLine" id="cb723-20" title="20">v_rms <span class="op">=</span> np.sqrt(<span class="dv">3</span><span class="op">*</span>R<span class="op">*</span>T<span class="op">/</span>(m<span class="op">/</span><span class="dv">1000</span>))</a>
<a class="sourceLine" id="cb723-21" title="21"></a>
<a class="sourceLine" id="cb723-22" title="22">v_rms_codex <span class="op">=</span> rms_velocity(T,m)</a>
<a class="sourceLine" id="cb723-23" title="23"></a>
<a class="sourceLine" id="cb723-24" title="24"><span class="co"># check </span></a>
<a class="sourceLine" id="cb723-25" title="25"><span class="cf">if</span> np.isclose(v_rms, v_rms_codex, rtol<span class="op">=</span><span class="fl">0.01</span>) <span class="op">==</span> <span class="va">True</span>:</a>
<a class="sourceLine" id="cb723-26" title="26">    result <span class="op">=</span> <span class="va">True</span> </a>
<a class="sourceLine" id="cb723-27" title="27"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb723-28" title="28">    result <span class="op">=</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-65">Run 4</h4>
<div class="sourceCode" id="cb725"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb725-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb725-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb725-3" title="3"></a>
<a class="sourceLine" id="cb725-4" title="4"><span class="kw">def</span> rms_velocity(T,m):</a>
<a class="sourceLine" id="cb725-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb725-6" title="6"><span class="co">   This function returns the root-mean-squared velocity of an ideal gas molecule at temperature T</span></a>
<a class="sourceLine" id="cb725-7" title="7"><span class="co">   m is mass in g/mol</span></a>
<a class="sourceLine" id="cb725-8" title="8"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb725-9" title="9">   k <span class="op">=</span> <span class="fl">1.38064852e-23</span> <span class="co">#J/K</span></a>
<a class="sourceLine" id="cb725-10" title="10">   m <span class="op">=</span> m<span class="op">*</span><span class="fl">1.6605e-27</span> <span class="co">#kg</span></a>
<a class="sourceLine" id="cb725-11" title="11">   v_rms <span class="op">=</span> math.sqrt(<span class="dv">3</span><span class="op">*</span>k<span class="op">*</span>T<span class="op">/</span>m)</a>
<a class="sourceLine" id="cb725-12" title="12">   <span class="bu">print</span>(v_rms)</a>
<a class="sourceLine" id="cb725-13" title="13">   <span class="cf">return</span> v_rms</a>
<a class="sourceLine" id="cb725-14" title="14"></a>
<a class="sourceLine" id="cb725-15" title="15"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb725-16" title="16"></a>
<a class="sourceLine" id="cb725-17" title="17">m<span class="op">=</span><span class="dv">32</span></a>
<a class="sourceLine" id="cb725-18" title="18">T<span class="op">=</span><span class="dv">300</span></a>
<a class="sourceLine" id="cb725-19" title="19">R<span class="op">=</span><span class="fl">8.314</span></a>
<a class="sourceLine" id="cb725-20" title="20">v_rms <span class="op">=</span> np.sqrt(<span class="dv">3</span><span class="op">*</span>R<span class="op">*</span>T<span class="op">/</span>(m<span class="op">/</span><span class="dv">1000</span>))</a>
<a class="sourceLine" id="cb725-21" title="21"></a>
<a class="sourceLine" id="cb725-22" title="22">v_rms_codex <span class="op">=</span> rms_velocity(T,m)</a>
<a class="sourceLine" id="cb725-23" title="23"></a>
<a class="sourceLine" id="cb725-24" title="24"><span class="co"># check </span></a>
<a class="sourceLine" id="cb725-25" title="25"><span class="cf">if</span> np.isclose(v_rms, v_rms_codex, rtol<span class="op">=</span><span class="fl">0.01</span>) <span class="op">==</span> <span class="va">True</span>:</a>
<a class="sourceLine" id="cb725-26" title="26">    result <span class="op">=</span> <span class="va">True</span> </a>
<a class="sourceLine" id="cb725-27" title="27"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb725-28" title="28">    result <span class="op">=</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>rmse</summary></p>
<h4 id="query-66">Query</h4>
<div class="sourceCode" id="cb727"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb727-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb727-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb727-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb727-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb727-5" title="5"></a>
<a class="sourceLine" id="cb727-6" title="6"><span class="kw">def</span> rmse(a,b):</a>
<a class="sourceLine" id="cb727-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb727-8" title="8"><span class="co">  This function evaluates the root mean square error (rmse) between a and b.</span></a>
<a class="sourceLine" id="cb727-9" title="9"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb727-10" title="10">  [insert]</a>
<a class="sourceLine" id="cb727-11" title="11">  <span class="cf">return</span> e</a></code></pre></div>
<h4 id="run-0-66">Run 0</h4>
<div class="sourceCode" id="cb728"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb728-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb728-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb728-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb728-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb728-5" title="5"></a>
<a class="sourceLine" id="cb728-6" title="6"><span class="kw">def</span> rmse(a,b):</a>
<a class="sourceLine" id="cb728-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb728-8" title="8"><span class="co">  This function evaluates the root mean square error (rmse) between a and b.</span></a>
<a class="sourceLine" id="cb728-9" title="9"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb728-10" title="10">  e <span class="op">=</span> np.sqrt(np.mean((a<span class="op">-</span>b)<span class="op">**</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb728-11" title="11">  <span class="cf">return</span> e</a>
<a class="sourceLine" id="cb728-12" title="12"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb728-13" title="13"></a>
<a class="sourceLine" id="cb728-14" title="14">np.random.seed(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb728-15" title="15">M <span class="op">=</span> <span class="dv">100</span></a>
<a class="sourceLine" id="cb728-16" title="16">predictions <span class="op">=</span> np.random.normal(loc<span class="op">=</span><span class="dv">10</span>, scale<span class="op">=</span><span class="dv">3</span>, size<span class="op">=</span>(M,))</a>
<a class="sourceLine" id="cb728-17" title="17">targets <span class="op">=</span> np.random.normal(loc<span class="op">=</span><span class="dv">9</span>, scale<span class="op">=</span><span class="dv">2</span>, size<span class="op">=</span>(M,))</a>
<a class="sourceLine" id="cb728-18" title="18"></a>
<a class="sourceLine" id="cb728-19" title="19">test_rmse <span class="op">=</span> np.sqrt(((predictions <span class="op">-</span> targets) <span class="op">**</span> <span class="dv">2</span>).mean())</a>
<a class="sourceLine" id="cb728-20" title="20">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(rmse(predictions, targets), test_rmse) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-66">Run 1</h4>
<div class="sourceCode" id="cb730"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb730-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb730-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb730-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb730-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb730-5" title="5"></a>
<a class="sourceLine" id="cb730-6" title="6"><span class="kw">def</span> rmse(a,b):</a>
<a class="sourceLine" id="cb730-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb730-8" title="8"><span class="co">  This function evaluates the root mean square error (rmse) between a and b.</span></a>
<a class="sourceLine" id="cb730-9" title="9"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb730-10" title="10">  e <span class="op">=</span> np.sqrt(np.mean((a<span class="op">-</span>b)<span class="op">**</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb730-11" title="11">  <span class="cf">return</span> e</a>
<a class="sourceLine" id="cb730-12" title="12"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb730-13" title="13"></a>
<a class="sourceLine" id="cb730-14" title="14">np.random.seed(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb730-15" title="15">M <span class="op">=</span> <span class="dv">100</span></a>
<a class="sourceLine" id="cb730-16" title="16">predictions <span class="op">=</span> np.random.normal(loc<span class="op">=</span><span class="dv">10</span>, scale<span class="op">=</span><span class="dv">3</span>, size<span class="op">=</span>(M,))</a>
<a class="sourceLine" id="cb730-17" title="17">targets <span class="op">=</span> np.random.normal(loc<span class="op">=</span><span class="dv">9</span>, scale<span class="op">=</span><span class="dv">2</span>, size<span class="op">=</span>(M,))</a>
<a class="sourceLine" id="cb730-18" title="18"></a>
<a class="sourceLine" id="cb730-19" title="19">test_rmse <span class="op">=</span> np.sqrt(((predictions <span class="op">-</span> targets) <span class="op">**</span> <span class="dv">2</span>).mean())</a>
<a class="sourceLine" id="cb730-20" title="20">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(rmse(predictions, targets), test_rmse) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-66">Run 2</h4>
<div class="sourceCode" id="cb732"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb732-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb732-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb732-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb732-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb732-5" title="5"></a>
<a class="sourceLine" id="cb732-6" title="6"><span class="kw">def</span> rmse(a,b):</a>
<a class="sourceLine" id="cb732-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb732-8" title="8"><span class="co">  This function evaluates the root mean square error (rmse) between a and b.</span></a>
<a class="sourceLine" id="cb732-9" title="9"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb732-10" title="10">  e <span class="op">=</span> np.sqrt(np.mean((a<span class="op">-</span>b)<span class="op">**</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb732-11" title="11">  <span class="cf">return</span> e</a>
<a class="sourceLine" id="cb732-12" title="12"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb732-13" title="13"></a>
<a class="sourceLine" id="cb732-14" title="14">np.random.seed(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb732-15" title="15">M <span class="op">=</span> <span class="dv">100</span></a>
<a class="sourceLine" id="cb732-16" title="16">predictions <span class="op">=</span> np.random.normal(loc<span class="op">=</span><span class="dv">10</span>, scale<span class="op">=</span><span class="dv">3</span>, size<span class="op">=</span>(M,))</a>
<a class="sourceLine" id="cb732-17" title="17">targets <span class="op">=</span> np.random.normal(loc<span class="op">=</span><span class="dv">9</span>, scale<span class="op">=</span><span class="dv">2</span>, size<span class="op">=</span>(M,))</a>
<a class="sourceLine" id="cb732-18" title="18"></a>
<a class="sourceLine" id="cb732-19" title="19">test_rmse <span class="op">=</span> np.sqrt(((predictions <span class="op">-</span> targets) <span class="op">**</span> <span class="dv">2</span>).mean())</a>
<a class="sourceLine" id="cb732-20" title="20">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(rmse(predictions, targets), test_rmse) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-66">Run 3</h4>
<div class="sourceCode" id="cb734"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb734-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb734-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb734-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb734-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb734-5" title="5"></a>
<a class="sourceLine" id="cb734-6" title="6"><span class="kw">def</span> rmse(a,b):</a>
<a class="sourceLine" id="cb734-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb734-8" title="8"><span class="co">  This function evaluates the root mean square error (rmse) between a and b.</span></a>
<a class="sourceLine" id="cb734-9" title="9"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb734-10" title="10">  e <span class="op">=</span> np.sqrt(np.mean((a<span class="op">-</span>b)<span class="op">**</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb734-11" title="11">  <span class="cf">return</span> e</a>
<a class="sourceLine" id="cb734-12" title="12"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb734-13" title="13"></a>
<a class="sourceLine" id="cb734-14" title="14">np.random.seed(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb734-15" title="15">M <span class="op">=</span> <span class="dv">100</span></a>
<a class="sourceLine" id="cb734-16" title="16">predictions <span class="op">=</span> np.random.normal(loc<span class="op">=</span><span class="dv">10</span>, scale<span class="op">=</span><span class="dv">3</span>, size<span class="op">=</span>(M,))</a>
<a class="sourceLine" id="cb734-17" title="17">targets <span class="op">=</span> np.random.normal(loc<span class="op">=</span><span class="dv">9</span>, scale<span class="op">=</span><span class="dv">2</span>, size<span class="op">=</span>(M,))</a>
<a class="sourceLine" id="cb734-18" title="18"></a>
<a class="sourceLine" id="cb734-19" title="19">test_rmse <span class="op">=</span> np.sqrt(((predictions <span class="op">-</span> targets) <span class="op">**</span> <span class="dv">2</span>).mean())</a>
<a class="sourceLine" id="cb734-20" title="20">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(rmse(predictions, targets), test_rmse) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-66">Run 4</h4>
<div class="sourceCode" id="cb736"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb736-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb736-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb736-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb736-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb736-5" title="5"></a>
<a class="sourceLine" id="cb736-6" title="6"><span class="kw">def</span> rmse(a,b):</a>
<a class="sourceLine" id="cb736-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb736-8" title="8"><span class="co">  This function evaluates the root mean square error (rmse) between a and b.</span></a>
<a class="sourceLine" id="cb736-9" title="9"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb736-10" title="10">  e <span class="op">=</span> np.sqrt(np.mean((a<span class="op">-</span>b)<span class="op">**</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb736-11" title="11">  <span class="cf">return</span> e</a>
<a class="sourceLine" id="cb736-12" title="12"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb736-13" title="13"></a>
<a class="sourceLine" id="cb736-14" title="14">np.random.seed(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb736-15" title="15">M <span class="op">=</span> <span class="dv">100</span></a>
<a class="sourceLine" id="cb736-16" title="16">predictions <span class="op">=</span> np.random.normal(loc<span class="op">=</span><span class="dv">10</span>, scale<span class="op">=</span><span class="dv">3</span>, size<span class="op">=</span>(M,))</a>
<a class="sourceLine" id="cb736-17" title="17">targets <span class="op">=</span> np.random.normal(loc<span class="op">=</span><span class="dv">9</span>, scale<span class="op">=</span><span class="dv">2</span>, size<span class="op">=</span>(M,))</a>
<a class="sourceLine" id="cb736-18" title="18"></a>
<a class="sourceLine" id="cb736-19" title="19">test_rmse <span class="op">=</span> np.sqrt(((predictions <span class="op">-</span> targets) <span class="op">**</span> <span class="dv">2</span>).mean())</a>
<a class="sourceLine" id="cb736-20" title="20">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(rmse(predictions, targets), test_rmse) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>rog</summary></p>
<h4 id="query-67">Query</h4>
<div class="sourceCode" id="cb738"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb738-1" title="1"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb738-2" title="2"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb738-3" title="3"></a>
<a class="sourceLine" id="cb738-4" title="4"><span class="kw">def</span> protein_radius_of_gyration(pdb_file):</a>
<a class="sourceLine" id="cb738-5" title="5">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb738-6" title="6"><span class="co">  1. This function loads a pdb</span></a>
<a class="sourceLine" id="cb738-7" title="7"><span class="co">  2. Calculates the radius of gyration</span></a>
<a class="sourceLine" id="cb738-8" title="8"><span class="co">  3. Returns it</span></a>
<a class="sourceLine" id="cb738-9" title="9"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb738-10" title="10">  [insert]</a>
<a class="sourceLine" id="cb738-11" title="11">  <span class="cf">return</span> rg</a></code></pre></div>
<h4 id="run-0-67">Run 0</h4>
<div class="sourceCode" id="cb739"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb739-1" title="1"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb739-2" title="2"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb739-3" title="3"></a>
<a class="sourceLine" id="cb739-4" title="4"><span class="kw">def</span> protein_radius_of_gyration(pdb_file):</a>
<a class="sourceLine" id="cb739-5" title="5">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb739-6" title="6"><span class="co">  1. This function loads a pdb</span></a>
<a class="sourceLine" id="cb739-7" title="7"><span class="co">  2. Calculates the radius of gyration</span></a>
<a class="sourceLine" id="cb739-8" title="8"><span class="co">  3. Returns it</span></a>
<a class="sourceLine" id="cb739-9" title="9"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb739-10" title="10">  traj <span class="op">=</span> md.load(pdb_file)</a>
<a class="sourceLine" id="cb739-11" title="11">  rg <span class="op">=</span> md.compute_rg(traj)</a>
<a class="sourceLine" id="cb739-12" title="12">  <span class="cf">return</span> rg</a>
<a class="sourceLine" id="cb739-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb739-14" title="14"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb739-15" title="15"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb739-16" title="16"></a>
<a class="sourceLine" id="cb739-17" title="17">pdb_file <span class="op">=</span> os.path.join(_FILE_DIR_,<span class="st">&quot;1VII.pdb&quot;</span>)</a>
<a class="sourceLine" id="cb739-18" title="18"></a>
<a class="sourceLine" id="cb739-19" title="19"><span class="kw">def</span> compute_rg_mdtraj(pdb_file):</a>
<a class="sourceLine" id="cb739-20" title="20">    <span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb739-21" title="21">    pdb <span class="op">=</span> md.load(pdb_file)</a>
<a class="sourceLine" id="cb739-22" title="22">    rg <span class="op">=</span> md.compute_rg(pdb)</a>
<a class="sourceLine" id="cb739-23" title="23">    <span class="cf">return</span> rg</a>
<a class="sourceLine" id="cb739-24" title="24"></a>
<a class="sourceLine" id="cb739-25" title="25">my_rg <span class="op">=</span> compute_rg_mdtraj(pdb_file)</a>
<a class="sourceLine" id="cb739-26" title="26">nlcc_rg <span class="op">=</span> protein_radius_of_gyration(pdb_file)</a>
<a class="sourceLine" id="cb739-27" title="27"></a>
<a class="sourceLine" id="cb739-28" title="28"><span class="co">#print(&quot;My result:&quot;, my_rg)</span></a>
<a class="sourceLine" id="cb739-29" title="29"><span class="co">#print(&quot;nlcc result&quot;, nlcc_rg)</span></a>
<a class="sourceLine" id="cb739-30" title="30"></a>
<a class="sourceLine" id="cb739-31" title="31">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">abs</span>( my_rg <span class="op">-</span> nlcc_rg )<span class="op">&lt;</span><span class="fl">0.1</span> <span class="cf">else</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb739-32" title="32"></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-67">Run 1</h4>
<div class="sourceCode" id="cb741"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb741-1" title="1"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb741-2" title="2"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb741-3" title="3"></a>
<a class="sourceLine" id="cb741-4" title="4"><span class="kw">def</span> protein_radius_of_gyration(pdb_file):</a>
<a class="sourceLine" id="cb741-5" title="5">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb741-6" title="6"><span class="co">  1. This function loads a pdb</span></a>
<a class="sourceLine" id="cb741-7" title="7"><span class="co">  2. Calculates the radius of gyration</span></a>
<a class="sourceLine" id="cb741-8" title="8"><span class="co">  3. Returns it</span></a>
<a class="sourceLine" id="cb741-9" title="9"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb741-10" title="10">  traj <span class="op">=</span> md.load(pdb_file)</a>
<a class="sourceLine" id="cb741-11" title="11">  rg <span class="op">=</span> md.compute_rg(traj)</a>
<a class="sourceLine" id="cb741-12" title="12">  rg <span class="op">=</span> np.mean(rg)</a>
<a class="sourceLine" id="cb741-13" title="13">  <span class="cf">return</span> rg</a>
<a class="sourceLine" id="cb741-14" title="14"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb741-15" title="15"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb741-16" title="16"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb741-17" title="17"></a>
<a class="sourceLine" id="cb741-18" title="18">pdb_file <span class="op">=</span> os.path.join(_FILE_DIR_,<span class="st">&quot;1VII.pdb&quot;</span>)</a>
<a class="sourceLine" id="cb741-19" title="19"></a>
<a class="sourceLine" id="cb741-20" title="20"><span class="kw">def</span> compute_rg_mdtraj(pdb_file):</a>
<a class="sourceLine" id="cb741-21" title="21">    <span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb741-22" title="22">    pdb <span class="op">=</span> md.load(pdb_file)</a>
<a class="sourceLine" id="cb741-23" title="23">    rg <span class="op">=</span> md.compute_rg(pdb)</a>
<a class="sourceLine" id="cb741-24" title="24">    <span class="cf">return</span> rg</a>
<a class="sourceLine" id="cb741-25" title="25"></a>
<a class="sourceLine" id="cb741-26" title="26">my_rg <span class="op">=</span> compute_rg_mdtraj(pdb_file)</a>
<a class="sourceLine" id="cb741-27" title="27">nlcc_rg <span class="op">=</span> protein_radius_of_gyration(pdb_file)</a>
<a class="sourceLine" id="cb741-28" title="28"></a>
<a class="sourceLine" id="cb741-29" title="29"><span class="co">#print(&quot;My result:&quot;, my_rg)</span></a>
<a class="sourceLine" id="cb741-30" title="30"><span class="co">#print(&quot;nlcc result&quot;, nlcc_rg)</span></a>
<a class="sourceLine" id="cb741-31" title="31"></a>
<a class="sourceLine" id="cb741-32" title="32">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">abs</span>( my_rg <span class="op">-</span> nlcc_rg )<span class="op">&lt;</span><span class="fl">0.1</span> <span class="cf">else</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb741-33" title="33"></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-67">Run 2</h4>
<div class="sourceCode" id="cb743"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb743-1" title="1"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb743-2" title="2"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb743-3" title="3"></a>
<a class="sourceLine" id="cb743-4" title="4"><span class="kw">def</span> protein_radius_of_gyration(pdb_file):</a>
<a class="sourceLine" id="cb743-5" title="5">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb743-6" title="6"><span class="co">  1. This function loads a pdb</span></a>
<a class="sourceLine" id="cb743-7" title="7"><span class="co">  2. Calculates the radius of gyration</span></a>
<a class="sourceLine" id="cb743-8" title="8"><span class="co">  3. Returns it</span></a>
<a class="sourceLine" id="cb743-9" title="9"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb743-10" title="10">  traj <span class="op">=</span> md.load(pdb_file)</a>
<a class="sourceLine" id="cb743-11" title="11">  rg <span class="op">=</span> md.compute_rg(traj)</a>
<a class="sourceLine" id="cb743-12" title="12">  rg <span class="op">=</span> np.mean(rg)</a>
<a class="sourceLine" id="cb743-13" title="13">  <span class="cf">return</span> rg</a>
<a class="sourceLine" id="cb743-14" title="14"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb743-15" title="15"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb743-16" title="16"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb743-17" title="17"></a>
<a class="sourceLine" id="cb743-18" title="18">pdb_file <span class="op">=</span> os.path.join(_FILE_DIR_,<span class="st">&quot;1VII.pdb&quot;</span>)</a>
<a class="sourceLine" id="cb743-19" title="19"></a>
<a class="sourceLine" id="cb743-20" title="20"><span class="kw">def</span> compute_rg_mdtraj(pdb_file):</a>
<a class="sourceLine" id="cb743-21" title="21">    <span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb743-22" title="22">    pdb <span class="op">=</span> md.load(pdb_file)</a>
<a class="sourceLine" id="cb743-23" title="23">    rg <span class="op">=</span> md.compute_rg(pdb)</a>
<a class="sourceLine" id="cb743-24" title="24">    <span class="cf">return</span> rg</a>
<a class="sourceLine" id="cb743-25" title="25"></a>
<a class="sourceLine" id="cb743-26" title="26">my_rg <span class="op">=</span> compute_rg_mdtraj(pdb_file)</a>
<a class="sourceLine" id="cb743-27" title="27">nlcc_rg <span class="op">=</span> protein_radius_of_gyration(pdb_file)</a>
<a class="sourceLine" id="cb743-28" title="28"></a>
<a class="sourceLine" id="cb743-29" title="29"><span class="co">#print(&quot;My result:&quot;, my_rg)</span></a>
<a class="sourceLine" id="cb743-30" title="30"><span class="co">#print(&quot;nlcc result&quot;, nlcc_rg)</span></a>
<a class="sourceLine" id="cb743-31" title="31"></a>
<a class="sourceLine" id="cb743-32" title="32">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">abs</span>( my_rg <span class="op">-</span> nlcc_rg )<span class="op">&lt;</span><span class="fl">0.1</span> <span class="cf">else</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb743-33" title="33"></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-67">Run 3</h4>
<div class="sourceCode" id="cb745"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb745-1" title="1"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb745-2" title="2"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb745-3" title="3"></a>
<a class="sourceLine" id="cb745-4" title="4"><span class="kw">def</span> protein_radius_of_gyration(pdb_file):</a>
<a class="sourceLine" id="cb745-5" title="5">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb745-6" title="6"><span class="co">  1. This function loads a pdb</span></a>
<a class="sourceLine" id="cb745-7" title="7"><span class="co">  2. Calculates the radius of gyration</span></a>
<a class="sourceLine" id="cb745-8" title="8"><span class="co">  3. Returns it</span></a>
<a class="sourceLine" id="cb745-9" title="9"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb745-10" title="10">  traj <span class="op">=</span> md.load(pdb_file)</a>
<a class="sourceLine" id="cb745-11" title="11">  rg <span class="op">=</span> md.compute_rg(traj)</a>
<a class="sourceLine" id="cb745-12" title="12">  rg <span class="op">=</span> np.mean(rg)</a>
<a class="sourceLine" id="cb745-13" title="13">  <span class="cf">return</span> rg</a>
<a class="sourceLine" id="cb745-14" title="14"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb745-15" title="15"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb745-16" title="16"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb745-17" title="17"></a>
<a class="sourceLine" id="cb745-18" title="18">pdb_file <span class="op">=</span> os.path.join(_FILE_DIR_,<span class="st">&quot;1VII.pdb&quot;</span>)</a>
<a class="sourceLine" id="cb745-19" title="19"></a>
<a class="sourceLine" id="cb745-20" title="20"><span class="kw">def</span> compute_rg_mdtraj(pdb_file):</a>
<a class="sourceLine" id="cb745-21" title="21">    <span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb745-22" title="22">    pdb <span class="op">=</span> md.load(pdb_file)</a>
<a class="sourceLine" id="cb745-23" title="23">    rg <span class="op">=</span> md.compute_rg(pdb)</a>
<a class="sourceLine" id="cb745-24" title="24">    <span class="cf">return</span> rg</a>
<a class="sourceLine" id="cb745-25" title="25"></a>
<a class="sourceLine" id="cb745-26" title="26">my_rg <span class="op">=</span> compute_rg_mdtraj(pdb_file)</a>
<a class="sourceLine" id="cb745-27" title="27">nlcc_rg <span class="op">=</span> protein_radius_of_gyration(pdb_file)</a>
<a class="sourceLine" id="cb745-28" title="28"></a>
<a class="sourceLine" id="cb745-29" title="29"><span class="co">#print(&quot;My result:&quot;, my_rg)</span></a>
<a class="sourceLine" id="cb745-30" title="30"><span class="co">#print(&quot;nlcc result&quot;, nlcc_rg)</span></a>
<a class="sourceLine" id="cb745-31" title="31"></a>
<a class="sourceLine" id="cb745-32" title="32">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">abs</span>( my_rg <span class="op">-</span> nlcc_rg )<span class="op">&lt;</span><span class="fl">0.1</span> <span class="cf">else</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb745-33" title="33"></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-67">Run 4</h4>
<div class="sourceCode" id="cb747"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb747-1" title="1"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb747-2" title="2"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb747-3" title="3"></a>
<a class="sourceLine" id="cb747-4" title="4"><span class="kw">def</span> protein_radius_of_gyration(pdb_file):</a>
<a class="sourceLine" id="cb747-5" title="5">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb747-6" title="6"><span class="co">  1. This function loads a pdb</span></a>
<a class="sourceLine" id="cb747-7" title="7"><span class="co">  2. Calculates the radius of gyration</span></a>
<a class="sourceLine" id="cb747-8" title="8"><span class="co">  3. Returns it</span></a>
<a class="sourceLine" id="cb747-9" title="9"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb747-10" title="10">  traj <span class="op">=</span> md.load(pdb_file)</a>
<a class="sourceLine" id="cb747-11" title="11">  rg <span class="op">=</span> md.compute_rg(traj)</a>
<a class="sourceLine" id="cb747-12" title="12">  <span class="cf">return</span> rg</a>
<a class="sourceLine" id="cb747-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb747-14" title="14"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb747-15" title="15"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb747-16" title="16"></a>
<a class="sourceLine" id="cb747-17" title="17">pdb_file <span class="op">=</span> os.path.join(_FILE_DIR_,<span class="st">&quot;1VII.pdb&quot;</span>)</a>
<a class="sourceLine" id="cb747-18" title="18"></a>
<a class="sourceLine" id="cb747-19" title="19"><span class="kw">def</span> compute_rg_mdtraj(pdb_file):</a>
<a class="sourceLine" id="cb747-20" title="20">    <span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb747-21" title="21">    pdb <span class="op">=</span> md.load(pdb_file)</a>
<a class="sourceLine" id="cb747-22" title="22">    rg <span class="op">=</span> md.compute_rg(pdb)</a>
<a class="sourceLine" id="cb747-23" title="23">    <span class="cf">return</span> rg</a>
<a class="sourceLine" id="cb747-24" title="24"></a>
<a class="sourceLine" id="cb747-25" title="25">my_rg <span class="op">=</span> compute_rg_mdtraj(pdb_file)</a>
<a class="sourceLine" id="cb747-26" title="26">nlcc_rg <span class="op">=</span> protein_radius_of_gyration(pdb_file)</a>
<a class="sourceLine" id="cb747-27" title="27"></a>
<a class="sourceLine" id="cb747-28" title="28"><span class="co">#print(&quot;My result:&quot;, my_rg)</span></a>
<a class="sourceLine" id="cb747-29" title="29"><span class="co">#print(&quot;nlcc result&quot;, nlcc_rg)</span></a>
<a class="sourceLine" id="cb747-30" title="30"></a>
<a class="sourceLine" id="cb747-31" title="31">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">abs</span>( my_rg <span class="op">-</span> nlcc_rg )<span class="op">&lt;</span><span class="fl">0.1</span> <span class="cf">else</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb747-32" title="32"></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>sasa</summary></p>
<h4 id="query-68">Query</h4>
<div class="sourceCode" id="cb749"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb749-1" title="1"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb749-2" title="2"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb749-3" title="3"></a>
<a class="sourceLine" id="cb749-4" title="4"><span class="kw">def</span> protein_surface_area(pdb_file):</a>
<a class="sourceLine" id="cb749-5" title="5">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb749-6" title="6"><span class="co">  1. This function loads a pdb</span></a>
<a class="sourceLine" id="cb749-7" title="7"><span class="co">  2. Calculates the Solvent Accessible Surface Area (sasa) per residue</span></a>
<a class="sourceLine" id="cb749-8" title="8"><span class="co">  3. Returns it</span></a>
<a class="sourceLine" id="cb749-9" title="9"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb749-10" title="10">  [insert]</a>
<a class="sourceLine" id="cb749-11" title="11">  <span class="cf">return</span> sasa</a></code></pre></div>
<h4 id="run-0-68">Run 0</h4>
<div class="sourceCode" id="cb750"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb750-1" title="1"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb750-2" title="2"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb750-3" title="3"></a>
<a class="sourceLine" id="cb750-4" title="4"><span class="kw">def</span> protein_surface_area(pdb_file):</a>
<a class="sourceLine" id="cb750-5" title="5">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb750-6" title="6"><span class="co">  1. This function loads a pdb</span></a>
<a class="sourceLine" id="cb750-7" title="7"><span class="co">  2. Calculates the Solvent Accessible Surface Area (sasa) per residue</span></a>
<a class="sourceLine" id="cb750-8" title="8"><span class="co">  3. Returns it</span></a>
<a class="sourceLine" id="cb750-9" title="9"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb750-10" title="10">  traj <span class="op">=</span> md.load(pdb_file)</a>
<a class="sourceLine" id="cb750-11" title="11">  sasa <span class="op">=</span> md.shrake_rupley(traj)</a>
<a class="sourceLine" id="cb750-12" title="12">  sasa <span class="op">=</span> np.<span class="bu">sum</span>(sasa, axis<span class="op">=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb750-13" title="13">  <span class="cf">return</span> sasa</a>
<a class="sourceLine" id="cb750-14" title="14"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb750-15" title="15"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb750-16" title="16"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb750-17" title="17"></a>
<a class="sourceLine" id="cb750-18" title="18">pdb_file <span class="op">=</span> os.path.join(_FILE_DIR_,<span class="st">&quot;1VII.pdb&quot;</span>)</a>
<a class="sourceLine" id="cb750-19" title="19"></a>
<a class="sourceLine" id="cb750-20" title="20"><span class="kw">def</span> compute_sasa_mdtraj(pdb_file):</a>
<a class="sourceLine" id="cb750-21" title="21">    <span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb750-22" title="22">    pdb <span class="op">=</span> md.load(pdb_file)</a>
<a class="sourceLine" id="cb750-23" title="23">    </a>
<a class="sourceLine" id="cb750-24" title="24">    sasa <span class="op">=</span> md.shrake_rupley(pdb,mode<span class="op">=</span><span class="st">&#39;residue&#39;</span>)</a>
<a class="sourceLine" id="cb750-25" title="25">    <span class="cf">return</span> sasa</a>
<a class="sourceLine" id="cb750-26" title="26"></a>
<a class="sourceLine" id="cb750-27" title="27">my_sasa <span class="op">=</span> compute_sasa_mdtraj(pdb_file)</a>
<a class="sourceLine" id="cb750-28" title="28">nlcc_sasa <span class="op">=</span> protein_surface_area(pdb_file)</a>
<a class="sourceLine" id="cb750-29" title="29"></a>
<a class="sourceLine" id="cb750-30" title="30"><span class="co">#print(&quot;My result:&quot;, my_sasa)</span></a>
<a class="sourceLine" id="cb750-31" title="31"><span class="co">#print(&quot;nlcc result&quot;, nlcc_sasa)</span></a>
<a class="sourceLine" id="cb750-32" title="32"></a>
<a class="sourceLine" id="cb750-33" title="33">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">abs</span>( my_sasa.mean() <span class="op">-</span> nlcc_sasa.mean() )<span class="op">&lt;</span><span class="fl">0.1</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-68">Run 1</h4>
<div class="sourceCode" id="cb752"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb752-1" title="1"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb752-2" title="2"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb752-3" title="3"></a>
<a class="sourceLine" id="cb752-4" title="4"><span class="kw">def</span> protein_surface_area(pdb_file):</a>
<a class="sourceLine" id="cb752-5" title="5">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb752-6" title="6"><span class="co">  1. This function loads a pdb</span></a>
<a class="sourceLine" id="cb752-7" title="7"><span class="co">  2. Calculates the Solvent Accessible Surface Area (sasa) per residue</span></a>
<a class="sourceLine" id="cb752-8" title="8"><span class="co">  3. Returns it</span></a>
<a class="sourceLine" id="cb752-9" title="9"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb752-10" title="10">  traj <span class="op">=</span> md.load(pdb_file)</a>
<a class="sourceLine" id="cb752-11" title="11">  sasa <span class="op">=</span> md.shrake_rupley(traj)</a>
<a class="sourceLine" id="cb752-12" title="12">  sasa <span class="op">=</span> np.<span class="bu">sum</span>(sasa, axis<span class="op">=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb752-13" title="13">  sasa <span class="op">=</span> np.<span class="bu">sum</span>(sasa, axis<span class="op">=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb752-14" title="14">  sasa <span class="op">=</span> np.<span class="bu">sum</span>(sasa, axis<span class="op">=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb752-15" title="15">  <span class="cf">return</span> sasa</a>
<a class="sourceLine" id="cb752-16" title="16"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb752-17" title="17"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb752-18" title="18"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb752-19" title="19"></a>
<a class="sourceLine" id="cb752-20" title="20">pdb_file <span class="op">=</span> os.path.join(_FILE_DIR_,<span class="st">&quot;1VII.pdb&quot;</span>)</a>
<a class="sourceLine" id="cb752-21" title="21"></a>
<a class="sourceLine" id="cb752-22" title="22"><span class="kw">def</span> compute_sasa_mdtraj(pdb_file):</a>
<a class="sourceLine" id="cb752-23" title="23">    <span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb752-24" title="24">    pdb <span class="op">=</span> md.load(pdb_file)</a>
<a class="sourceLine" id="cb752-25" title="25">    </a>
<a class="sourceLine" id="cb752-26" title="26">    sasa <span class="op">=</span> md.shrake_rupley(pdb,mode<span class="op">=</span><span class="st">&#39;residue&#39;</span>)</a>
<a class="sourceLine" id="cb752-27" title="27">    <span class="cf">return</span> sasa</a>
<a class="sourceLine" id="cb752-28" title="28"></a>
<a class="sourceLine" id="cb752-29" title="29">my_sasa <span class="op">=</span> compute_sasa_mdtraj(pdb_file)</a>
<a class="sourceLine" id="cb752-30" title="30">nlcc_sasa <span class="op">=</span> protein_surface_area(pdb_file)</a>
<a class="sourceLine" id="cb752-31" title="31"></a>
<a class="sourceLine" id="cb752-32" title="32"><span class="co">#print(&quot;My result:&quot;, my_sasa)</span></a>
<a class="sourceLine" id="cb752-33" title="33"><span class="co">#print(&quot;nlcc result&quot;, nlcc_sasa)</span></a>
<a class="sourceLine" id="cb752-34" title="34"></a>
<a class="sourceLine" id="cb752-35" title="35">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">abs</span>( my_sasa.mean() <span class="op">-</span> nlcc_sasa.mean() )<span class="op">&lt;</span><span class="fl">0.1</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>axis 1 is out of bounds for array of dimension 1</code></pre>
<h4 id="run-2-68">Run 2</h4>
<div class="sourceCode" id="cb754"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb754-1" title="1"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb754-2" title="2"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb754-3" title="3"></a>
<a class="sourceLine" id="cb754-4" title="4"><span class="kw">def</span> protein_surface_area(pdb_file):</a>
<a class="sourceLine" id="cb754-5" title="5">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb754-6" title="6"><span class="co">  1. This function loads a pdb</span></a>
<a class="sourceLine" id="cb754-7" title="7"><span class="co">  2. Calculates the Solvent Accessible Surface Area (sasa) per residue</span></a>
<a class="sourceLine" id="cb754-8" title="8"><span class="co">  3. Returns it</span></a>
<a class="sourceLine" id="cb754-9" title="9"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb754-10" title="10">  traj <span class="op">=</span> md.load(pdb_file)</a>
<a class="sourceLine" id="cb754-11" title="11">  sasa <span class="op">=</span> md.shrake_rupley(traj)</a>
<a class="sourceLine" id="cb754-12" title="12">  sasa <span class="op">=</span> np.<span class="bu">sum</span>(sasa, axis<span class="op">=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb754-13" title="13">  sasa <span class="op">=</span> np.<span class="bu">sum</span>(sasa, axis<span class="op">=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb754-14" title="14">  sasa <span class="op">=</span> np.<span class="bu">sum</span>(sasa, axis<span class="op">=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb754-15" title="15">  <span class="cf">return</span> sasa</a>
<a class="sourceLine" id="cb754-16" title="16"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb754-17" title="17"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb754-18" title="18"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb754-19" title="19"></a>
<a class="sourceLine" id="cb754-20" title="20">pdb_file <span class="op">=</span> os.path.join(_FILE_DIR_,<span class="st">&quot;1VII.pdb&quot;</span>)</a>
<a class="sourceLine" id="cb754-21" title="21"></a>
<a class="sourceLine" id="cb754-22" title="22"><span class="kw">def</span> compute_sasa_mdtraj(pdb_file):</a>
<a class="sourceLine" id="cb754-23" title="23">    <span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb754-24" title="24">    pdb <span class="op">=</span> md.load(pdb_file)</a>
<a class="sourceLine" id="cb754-25" title="25">    </a>
<a class="sourceLine" id="cb754-26" title="26">    sasa <span class="op">=</span> md.shrake_rupley(pdb,mode<span class="op">=</span><span class="st">&#39;residue&#39;</span>)</a>
<a class="sourceLine" id="cb754-27" title="27">    <span class="cf">return</span> sasa</a>
<a class="sourceLine" id="cb754-28" title="28"></a>
<a class="sourceLine" id="cb754-29" title="29">my_sasa <span class="op">=</span> compute_sasa_mdtraj(pdb_file)</a>
<a class="sourceLine" id="cb754-30" title="30">nlcc_sasa <span class="op">=</span> protein_surface_area(pdb_file)</a>
<a class="sourceLine" id="cb754-31" title="31"></a>
<a class="sourceLine" id="cb754-32" title="32"><span class="co">#print(&quot;My result:&quot;, my_sasa)</span></a>
<a class="sourceLine" id="cb754-33" title="33"><span class="co">#print(&quot;nlcc result&quot;, nlcc_sasa)</span></a>
<a class="sourceLine" id="cb754-34" title="34"></a>
<a class="sourceLine" id="cb754-35" title="35">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">abs</span>( my_sasa.mean() <span class="op">-</span> nlcc_sasa.mean() )<span class="op">&lt;</span><span class="fl">0.1</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>axis 1 is out of bounds for array of dimension 1</code></pre>
<h4 id="run-3-68">Run 3</h4>
<div class="sourceCode" id="cb756"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb756-1" title="1"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb756-2" title="2"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb756-3" title="3"></a>
<a class="sourceLine" id="cb756-4" title="4"><span class="kw">def</span> protein_surface_area(pdb_file):</a>
<a class="sourceLine" id="cb756-5" title="5">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb756-6" title="6"><span class="co">  1. This function loads a pdb</span></a>
<a class="sourceLine" id="cb756-7" title="7"><span class="co">  2. Calculates the Solvent Accessible Surface Area (sasa) per residue</span></a>
<a class="sourceLine" id="cb756-8" title="8"><span class="co">  3. Returns it</span></a>
<a class="sourceLine" id="cb756-9" title="9"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb756-10" title="10">  traj <span class="op">=</span> md.load(pdb_file)</a>
<a class="sourceLine" id="cb756-11" title="11">  sasa <span class="op">=</span> md.shrake_rupley(traj)</a>
<a class="sourceLine" id="cb756-12" title="12">  sasa <span class="op">=</span> np.<span class="bu">sum</span>(sasa, axis<span class="op">=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb756-13" title="13">  <span class="cf">return</span> sasa</a>
<a class="sourceLine" id="cb756-14" title="14"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb756-15" title="15"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb756-16" title="16"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb756-17" title="17"></a>
<a class="sourceLine" id="cb756-18" title="18">pdb_file <span class="op">=</span> os.path.join(_FILE_DIR_,<span class="st">&quot;1VII.pdb&quot;</span>)</a>
<a class="sourceLine" id="cb756-19" title="19"></a>
<a class="sourceLine" id="cb756-20" title="20"><span class="kw">def</span> compute_sasa_mdtraj(pdb_file):</a>
<a class="sourceLine" id="cb756-21" title="21">    <span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb756-22" title="22">    pdb <span class="op">=</span> md.load(pdb_file)</a>
<a class="sourceLine" id="cb756-23" title="23">    </a>
<a class="sourceLine" id="cb756-24" title="24">    sasa <span class="op">=</span> md.shrake_rupley(pdb,mode<span class="op">=</span><span class="st">&#39;residue&#39;</span>)</a>
<a class="sourceLine" id="cb756-25" title="25">    <span class="cf">return</span> sasa</a>
<a class="sourceLine" id="cb756-26" title="26"></a>
<a class="sourceLine" id="cb756-27" title="27">my_sasa <span class="op">=</span> compute_sasa_mdtraj(pdb_file)</a>
<a class="sourceLine" id="cb756-28" title="28">nlcc_sasa <span class="op">=</span> protein_surface_area(pdb_file)</a>
<a class="sourceLine" id="cb756-29" title="29"></a>
<a class="sourceLine" id="cb756-30" title="30"><span class="co">#print(&quot;My result:&quot;, my_sasa)</span></a>
<a class="sourceLine" id="cb756-31" title="31"><span class="co">#print(&quot;nlcc result&quot;, nlcc_sasa)</span></a>
<a class="sourceLine" id="cb756-32" title="32"></a>
<a class="sourceLine" id="cb756-33" title="33">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">abs</span>( my_sasa.mean() <span class="op">-</span> nlcc_sasa.mean() )<span class="op">&lt;</span><span class="fl">0.1</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-68">Run 4</h4>
<div class="sourceCode" id="cb758"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb758-1" title="1"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb758-2" title="2"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb758-3" title="3"></a>
<a class="sourceLine" id="cb758-4" title="4"><span class="kw">def</span> protein_surface_area(pdb_file):</a>
<a class="sourceLine" id="cb758-5" title="5">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb758-6" title="6"><span class="co">  1. This function loads a pdb</span></a>
<a class="sourceLine" id="cb758-7" title="7"><span class="co">  2. Calculates the Solvent Accessible Surface Area (sasa) per residue</span></a>
<a class="sourceLine" id="cb758-8" title="8"><span class="co">  3. Returns it</span></a>
<a class="sourceLine" id="cb758-9" title="9"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb758-10" title="10">  traj <span class="op">=</span> md.load(pdb_file)</a>
<a class="sourceLine" id="cb758-11" title="11">  sasa <span class="op">=</span> md.shrake_rupley(traj)</a>
<a class="sourceLine" id="cb758-12" title="12">  sasa <span class="op">=</span> np.<span class="bu">sum</span>(sasa, axis<span class="op">=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb758-13" title="13">  sasa <span class="op">=</span> np.<span class="bu">sum</span>(sasa, axis<span class="op">=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb758-14" title="14">  <span class="cf">return</span> sasa</a>
<a class="sourceLine" id="cb758-15" title="15"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb758-16" title="16"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb758-17" title="17"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb758-18" title="18"></a>
<a class="sourceLine" id="cb758-19" title="19">pdb_file <span class="op">=</span> os.path.join(_FILE_DIR_,<span class="st">&quot;1VII.pdb&quot;</span>)</a>
<a class="sourceLine" id="cb758-20" title="20"></a>
<a class="sourceLine" id="cb758-21" title="21"><span class="kw">def</span> compute_sasa_mdtraj(pdb_file):</a>
<a class="sourceLine" id="cb758-22" title="22">    <span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb758-23" title="23">    pdb <span class="op">=</span> md.load(pdb_file)</a>
<a class="sourceLine" id="cb758-24" title="24">    </a>
<a class="sourceLine" id="cb758-25" title="25">    sasa <span class="op">=</span> md.shrake_rupley(pdb,mode<span class="op">=</span><span class="st">&#39;residue&#39;</span>)</a>
<a class="sourceLine" id="cb758-26" title="26">    <span class="cf">return</span> sasa</a>
<a class="sourceLine" id="cb758-27" title="27"></a>
<a class="sourceLine" id="cb758-28" title="28">my_sasa <span class="op">=</span> compute_sasa_mdtraj(pdb_file)</a>
<a class="sourceLine" id="cb758-29" title="29">nlcc_sasa <span class="op">=</span> protein_surface_area(pdb_file)</a>
<a class="sourceLine" id="cb758-30" title="30"></a>
<a class="sourceLine" id="cb758-31" title="31"><span class="co">#print(&quot;My result:&quot;, my_sasa)</span></a>
<a class="sourceLine" id="cb758-32" title="32"><span class="co">#print(&quot;nlcc result&quot;, nlcc_sasa)</span></a>
<a class="sourceLine" id="cb758-33" title="33"></a>
<a class="sourceLine" id="cb758-34" title="34">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">abs</span>( my_sasa.mean() <span class="op">-</span> nlcc_sasa.mean() )<span class="op">&lt;</span><span class="fl">0.1</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>axis 1 is out of bounds for array of dimension 1</code></pre>
</details>
<details>
<p><summary>scaffold</summary></p>
<h4 id="query-69">Query</h4>
<div class="sourceCode" id="cb760"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb760-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb760-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb760-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb760-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb760-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb760-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb760-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb760-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb760-9" title="9"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb760-10" title="10"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb760-11" title="11"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb760-12" title="12"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb760-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb760-14" title="14"></a>
<a class="sourceLine" id="cb760-15" title="15"><span class="kw">def</span> scaffold(smiles):</a>
<a class="sourceLine" id="cb760-16" title="16">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb760-17" title="17"><span class="co">    Returns Murcko scaffold of given molecule</span></a>
<a class="sourceLine" id="cb760-18" title="18"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb760-19" title="19">    [insert]</a>
<a class="sourceLine" id="cb760-20" title="20">    <span class="cf">return</span> scaffold_smiles</a></code></pre></div>
<h4 id="run-0-69">Run 0</h4>
<div class="sourceCode" id="cb761"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb761-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb761-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb761-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb761-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb761-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb761-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb761-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb761-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb761-9" title="9"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb761-10" title="10"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb761-11" title="11"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb761-12" title="12"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb761-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb761-14" title="14"></a>
<a class="sourceLine" id="cb761-15" title="15"><span class="kw">def</span> scaffold(smiles):</a>
<a class="sourceLine" id="cb761-16" title="16">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb761-17" title="17"><span class="co">    Returns Murcko scaffold of given molecule</span></a>
<a class="sourceLine" id="cb761-18" title="18"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb761-19" title="19">    mol <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb761-20" title="20">    scaffold_smiles <span class="op">=</span> Scaffolds.MurckoScaffoldSmiles(mol)</a>
<a class="sourceLine" id="cb761-21" title="21">    <span class="cf">return</span> scaffold_smiles</a>
<a class="sourceLine" id="cb761-22" title="22">smiles <span class="op">=</span> <span class="st">&#39;C1([O-])C=CC=C1NCC[NH+]&#39;</span></a>
<a class="sourceLine" id="cb761-23" title="23">mol <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb761-24" title="24">sc <span class="op">=</span> rdkit.Chem.rdMolHash.MolHash(</a>
<a class="sourceLine" id="cb761-25" title="25">    mol, rdkit.Chem.rdMolHash.HashFunction.MurckoScaffold)</a>
<a class="sourceLine" id="cb761-26" title="26">result <span class="op">=</span> scaffold(smiles) <span class="op">==</span> sc</a></code></pre></div>
<p>Output:</p>
<pre><code>module &#39;rdkit.Chem.Scaffolds&#39; has no attribute &#39;MurckoScaffoldSmiles&#39;</code></pre>
<h4 id="run-1-69">Run 1</h4>
<div class="sourceCode" id="cb763"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb763-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb763-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb763-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb763-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb763-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb763-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb763-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb763-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb763-9" title="9"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb763-10" title="10"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb763-11" title="11"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb763-12" title="12"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb763-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb763-14" title="14"></a>
<a class="sourceLine" id="cb763-15" title="15"><span class="kw">def</span> scaffold(smiles):</a>
<a class="sourceLine" id="cb763-16" title="16">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb763-17" title="17"><span class="co">    Returns Murcko scaffold of given molecule</span></a>
<a class="sourceLine" id="cb763-18" title="18"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb763-19" title="19">    mol <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb763-20" title="20">    scaffold_mol <span class="op">=</span> Scaffolds.MurckoScaffold.GetScaffoldForMol(mol)</a>
<a class="sourceLine" id="cb763-21" title="21">    scaffold_smiles <span class="op">=</span> Chem.MolToSmiles(scaffold_mol)</a>
<a class="sourceLine" id="cb763-22" title="22">    <span class="cf">return</span> scaffold_smiles</a>
<a class="sourceLine" id="cb763-23" title="23">smiles <span class="op">=</span> <span class="st">&#39;C1([O-])C=CC=C1NCC[NH+]&#39;</span></a>
<a class="sourceLine" id="cb763-24" title="24">mol <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb763-25" title="25">sc <span class="op">=</span> rdkit.Chem.rdMolHash.MolHash(</a>
<a class="sourceLine" id="cb763-26" title="26">    mol, rdkit.Chem.rdMolHash.HashFunction.MurckoScaffold)</a>
<a class="sourceLine" id="cb763-27" title="27">result <span class="op">=</span> scaffold(smiles) <span class="op">==</span> sc</a></code></pre></div>
<p>Output:</p>
<pre><code>module &#39;rdkit.Chem.Scaffolds&#39; has no attribute &#39;MurckoScaffold&#39;</code></pre>
<h4 id="run-2-69">Run 2</h4>
<div class="sourceCode" id="cb765"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb765-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb765-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb765-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb765-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb765-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb765-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb765-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb765-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb765-9" title="9"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb765-10" title="10"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb765-11" title="11"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb765-12" title="12"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb765-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb765-14" title="14"></a>
<a class="sourceLine" id="cb765-15" title="15"><span class="kw">def</span> scaffold(smiles):</a>
<a class="sourceLine" id="cb765-16" title="16">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb765-17" title="17"><span class="co">    Returns Murcko scaffold of given molecule</span></a>
<a class="sourceLine" id="cb765-18" title="18"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb765-19" title="19">    mol <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb765-20" title="20">    scaffold_mol <span class="op">=</span> Scaffolds.MurckoScaffold.GetScaffoldForMol(mol)</a>
<a class="sourceLine" id="cb765-21" title="21">    scaffold_smiles <span class="op">=</span> Chem.MolToSmiles(scaffold_mol)</a>
<a class="sourceLine" id="cb765-22" title="22">    <span class="cf">return</span> scaffold_smiles</a>
<a class="sourceLine" id="cb765-23" title="23">smiles <span class="op">=</span> <span class="st">&#39;C1([O-])C=CC=C1NCC[NH+]&#39;</span></a>
<a class="sourceLine" id="cb765-24" title="24">mol <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb765-25" title="25">sc <span class="op">=</span> rdkit.Chem.rdMolHash.MolHash(</a>
<a class="sourceLine" id="cb765-26" title="26">    mol, rdkit.Chem.rdMolHash.HashFunction.MurckoScaffold)</a>
<a class="sourceLine" id="cb765-27" title="27">result <span class="op">=</span> scaffold(smiles) <span class="op">==</span> sc</a></code></pre></div>
<p>Output:</p>
<pre><code>module &#39;rdkit.Chem.Scaffolds&#39; has no attribute &#39;MurckoScaffold&#39;</code></pre>
<h4 id="run-3-69">Run 3</h4>
<div class="sourceCode" id="cb767"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb767-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb767-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb767-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb767-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb767-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb767-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb767-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb767-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb767-9" title="9"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb767-10" title="10"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb767-11" title="11"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb767-12" title="12"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb767-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb767-14" title="14"></a>
<a class="sourceLine" id="cb767-15" title="15"><span class="kw">def</span> scaffold(smiles):</a>
<a class="sourceLine" id="cb767-16" title="16">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb767-17" title="17"><span class="co">    Returns Murcko scaffold of given molecule</span></a>
<a class="sourceLine" id="cb767-18" title="18"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb767-19" title="19">    mol <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb767-20" title="20">    scaffold_smiles <span class="op">=</span> Scaffolds.MurckoScaffoldSmiles(mol)</a>
<a class="sourceLine" id="cb767-21" title="21">    <span class="cf">return</span> scaffold_smiles</a>
<a class="sourceLine" id="cb767-22" title="22">smiles <span class="op">=</span> <span class="st">&#39;C1([O-])C=CC=C1NCC[NH+]&#39;</span></a>
<a class="sourceLine" id="cb767-23" title="23">mol <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb767-24" title="24">sc <span class="op">=</span> rdkit.Chem.rdMolHash.MolHash(</a>
<a class="sourceLine" id="cb767-25" title="25">    mol, rdkit.Chem.rdMolHash.HashFunction.MurckoScaffold)</a>
<a class="sourceLine" id="cb767-26" title="26">result <span class="op">=</span> scaffold(smiles) <span class="op">==</span> sc</a></code></pre></div>
<p>Output:</p>
<pre><code>module &#39;rdkit.Chem.Scaffolds&#39; has no attribute &#39;MurckoScaffoldSmiles&#39;</code></pre>
<h4 id="run-4-69">Run 4</h4>
<div class="sourceCode" id="cb769"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb769-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb769-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb769-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb769-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb769-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb769-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb769-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb769-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb769-9" title="9"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb769-10" title="10"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb769-11" title="11"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb769-12" title="12"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb769-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb769-14" title="14"></a>
<a class="sourceLine" id="cb769-15" title="15"><span class="kw">def</span> scaffold(smiles):</a>
<a class="sourceLine" id="cb769-16" title="16">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb769-17" title="17"><span class="co">    Returns Murcko scaffold of given molecule</span></a>
<a class="sourceLine" id="cb769-18" title="18"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb769-19" title="19">    mol <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb769-20" title="20">    scaffold_smiles <span class="op">=</span> Scaffolds.MurckoScaffoldSmiles(mol)</a>
<a class="sourceLine" id="cb769-21" title="21">    <span class="cf">return</span> scaffold_smiles</a>
<a class="sourceLine" id="cb769-22" title="22">smiles <span class="op">=</span> <span class="st">&#39;C1([O-])C=CC=C1NCC[NH+]&#39;</span></a>
<a class="sourceLine" id="cb769-23" title="23">mol <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb769-24" title="24">sc <span class="op">=</span> rdkit.Chem.rdMolHash.MolHash(</a>
<a class="sourceLine" id="cb769-25" title="25">    mol, rdkit.Chem.rdMolHash.HashFunction.MurckoScaffold)</a>
<a class="sourceLine" id="cb769-26" title="26">result <span class="op">=</span> scaffold(smiles) <span class="op">==</span> sc</a></code></pre></div>
<p>Output:</p>
<pre><code>module &#39;rdkit.Chem.Scaffolds&#39; has no attribute &#39;MurckoScaffoldSmiles&#39;</code></pre>
</details>
<details>
<p><summary>seq-align</summary></p>
<h4 id="query-70">Query</h4>
<div class="sourceCode" id="cb771"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb771-1" title="1"><span class="im">from</span> Bio <span class="im">import</span> SeqIO</a>
<a class="sourceLine" id="cb771-2" title="2"><span class="im">from</span> Bio <span class="im">import</span> Align</a>
<a class="sourceLine" id="cb771-3" title="3"><span class="im">from</span> Bio <span class="im">import</span> PopGen</a>
<a class="sourceLine" id="cb771-4" title="4"><span class="im">from</span> Bio.PDB <span class="im">import</span> <span class="op">*</span></a>
<a class="sourceLine" id="cb771-5" title="5"><span class="im">from</span> Bio.Seq <span class="im">import</span> Seq</a>
<a class="sourceLine" id="cb771-6" title="6"><span class="im">import</span> Bio</a>
<a class="sourceLine" id="cb771-7" title="7"><span class="im">from</span> Bio <span class="im">import</span> pairwise2</a>
<a class="sourceLine" id="cb771-8" title="8"><span class="im">from</span> Bio.Blast <span class="im">import</span> NCBIWWW, NCBIXML</a>
<a class="sourceLine" id="cb771-9" title="9"><span class="im">from</span> Bio.SubsMat <span class="im">import</span> MatrixInfo <span class="im">as</span> matlist</a>
<a class="sourceLine" id="cb771-10" title="10"></a>
<a class="sourceLine" id="cb771-11" title="11"><span class="kw">def</span> align(seq1, seq2):</a>
<a class="sourceLine" id="cb771-12" title="12">    <span class="co">&#39;&#39;&#39;</span></a>
<a class="sourceLine" id="cb771-13" title="13"><span class="co">    Align the two amino acid sequences with BLOSUM62 and return aligned sequences</span></a>
<a class="sourceLine" id="cb771-14" title="14"><span class="co">    &#39;&#39;&#39;</span></a>
<a class="sourceLine" id="cb771-15" title="15">    [insert]</a>
<a class="sourceLine" id="cb771-16" title="16">    <span class="cf">return</span> aligned</a></code></pre></div>
<h4 id="run-0-70">Run 0</h4>
<div class="sourceCode" id="cb772"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb772-1" title="1"><span class="im">from</span> Bio <span class="im">import</span> SeqIO</a>
<a class="sourceLine" id="cb772-2" title="2"><span class="im">from</span> Bio <span class="im">import</span> Align</a>
<a class="sourceLine" id="cb772-3" title="3"><span class="im">from</span> Bio <span class="im">import</span> PopGen</a>
<a class="sourceLine" id="cb772-4" title="4"><span class="im">from</span> Bio.PDB <span class="im">import</span> <span class="op">*</span></a>
<a class="sourceLine" id="cb772-5" title="5"><span class="im">from</span> Bio.Seq <span class="im">import</span> Seq</a>
<a class="sourceLine" id="cb772-6" title="6"><span class="im">import</span> Bio</a>
<a class="sourceLine" id="cb772-7" title="7"><span class="im">from</span> Bio <span class="im">import</span> pairwise2</a>
<a class="sourceLine" id="cb772-8" title="8"><span class="im">from</span> Bio.Blast <span class="im">import</span> NCBIWWW, NCBIXML</a>
<a class="sourceLine" id="cb772-9" title="9"><span class="im">from</span> Bio.SubsMat <span class="im">import</span> MatrixInfo <span class="im">as</span> matlist</a>
<a class="sourceLine" id="cb772-10" title="10"></a>
<a class="sourceLine" id="cb772-11" title="11"><span class="kw">def</span> align(seq1, seq2):</a>
<a class="sourceLine" id="cb772-12" title="12">    <span class="co">&#39;&#39;&#39;</span></a>
<a class="sourceLine" id="cb772-13" title="13"><span class="co">    Align the two amino acid sequences with BLOSUM62 and return aligned sequences</span></a>
<a class="sourceLine" id="cb772-14" title="14"><span class="co">    &#39;&#39;&#39;</span></a>
<a class="sourceLine" id="cb772-15" title="15">    matrix <span class="op">=</span> matlist.blosum62</a>
<a class="sourceLine" id="cb772-16" title="16">    gap_open <span class="op">=</span> <span class="dv">-10</span></a>
<a class="sourceLine" id="cb772-17" title="17">    gap_extend <span class="op">=</span> <span class="fl">-0.5</span></a>
<a class="sourceLine" id="cb772-18" title="18">    alns <span class="op">=</span> pairwise2.align.globalds(seq1, seq2, matrix, gap_open, gap_extend)</a>
<a class="sourceLine" id="cb772-19" title="19">    aligned <span class="op">=</span> pairwise2.format_alignment(<span class="op">*</span>alns[<span class="dv">0</span>])</a>
<a class="sourceLine" id="cb772-20" title="20">    <span class="cf">return</span> aligned</a>
<a class="sourceLine" id="cb772-21" title="21">seq1 <span class="op">=</span> Seq(<span class="st">&#39;EEKG&#39;</span>)</a>
<a class="sourceLine" id="cb772-22" title="22">seq2 <span class="op">=</span> Seq(<span class="st">&#39;SSSDEKA&#39;</span>)</a>
<a class="sourceLine" id="cb772-23" title="23">a <span class="op">=</span> align(seq1, seq2)</a>
<a class="sourceLine" id="cb772-24" title="24">result <span class="op">=</span> a[<span class="dv">0</span>] <span class="op">==</span> <span class="st">&#39;---EEKG&#39;</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-70">Run 1</h4>
<div class="sourceCode" id="cb774"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb774-1" title="1"><span class="im">from</span> Bio <span class="im">import</span> SeqIO</a>
<a class="sourceLine" id="cb774-2" title="2"><span class="im">from</span> Bio <span class="im">import</span> Align</a>
<a class="sourceLine" id="cb774-3" title="3"><span class="im">from</span> Bio <span class="im">import</span> PopGen</a>
<a class="sourceLine" id="cb774-4" title="4"><span class="im">from</span> Bio.PDB <span class="im">import</span> <span class="op">*</span></a>
<a class="sourceLine" id="cb774-5" title="5"><span class="im">from</span> Bio.Seq <span class="im">import</span> Seq</a>
<a class="sourceLine" id="cb774-6" title="6"><span class="im">import</span> Bio</a>
<a class="sourceLine" id="cb774-7" title="7"><span class="im">from</span> Bio <span class="im">import</span> pairwise2</a>
<a class="sourceLine" id="cb774-8" title="8"><span class="im">from</span> Bio.Blast <span class="im">import</span> NCBIWWW, NCBIXML</a>
<a class="sourceLine" id="cb774-9" title="9"><span class="im">from</span> Bio.SubsMat <span class="im">import</span> MatrixInfo <span class="im">as</span> matlist</a>
<a class="sourceLine" id="cb774-10" title="10"></a>
<a class="sourceLine" id="cb774-11" title="11"><span class="kw">def</span> align(seq1, seq2):</a>
<a class="sourceLine" id="cb774-12" title="12">    <span class="co">&#39;&#39;&#39;</span></a>
<a class="sourceLine" id="cb774-13" title="13"><span class="co">    Align the two amino acid sequences with BLOSUM62 and return aligned sequences</span></a>
<a class="sourceLine" id="cb774-14" title="14"><span class="co">    &#39;&#39;&#39;</span></a>
<a class="sourceLine" id="cb774-15" title="15">    matrix <span class="op">=</span> matlist.blosum62</a>
<a class="sourceLine" id="cb774-16" title="16">    gap_open <span class="op">=</span> <span class="dv">-10</span></a>
<a class="sourceLine" id="cb774-17" title="17">    gap_extend <span class="op">=</span> <span class="fl">-0.5</span></a>
<a class="sourceLine" id="cb774-18" title="18">    alns <span class="op">=</span> pairwise2.align.globalds(seq1, seq2, matrix, gap_open, gap_extend)</a>
<a class="sourceLine" id="cb774-19" title="19">    seq1 <span class="op">=</span> alns[<span class="dv">0</span>][<span class="dv">0</span>]</a>
<a class="sourceLine" id="cb774-20" title="20">    seq2 <span class="op">=</span> alns[<span class="dv">0</span>][<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb774-21" title="21">    aligned <span class="op">=</span> [seq1, seq2]</a>
<a class="sourceLine" id="cb774-22" title="22">    <span class="cf">return</span> aligned</a>
<a class="sourceLine" id="cb774-23" title="23">seq1 <span class="op">=</span> Seq(<span class="st">&#39;EEKG&#39;</span>)</a>
<a class="sourceLine" id="cb774-24" title="24">seq2 <span class="op">=</span> Seq(<span class="st">&#39;SSSDEKA&#39;</span>)</a>
<a class="sourceLine" id="cb774-25" title="25">a <span class="op">=</span> align(seq1, seq2)</a>
<a class="sourceLine" id="cb774-26" title="26">result <span class="op">=</span> a[<span class="dv">0</span>] <span class="op">==</span> <span class="st">&#39;---EEKG&#39;</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-70">Run 2</h4>
<div class="sourceCode" id="cb776"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb776-1" title="1"><span class="im">from</span> Bio <span class="im">import</span> SeqIO</a>
<a class="sourceLine" id="cb776-2" title="2"><span class="im">from</span> Bio <span class="im">import</span> Align</a>
<a class="sourceLine" id="cb776-3" title="3"><span class="im">from</span> Bio <span class="im">import</span> PopGen</a>
<a class="sourceLine" id="cb776-4" title="4"><span class="im">from</span> Bio.PDB <span class="im">import</span> <span class="op">*</span></a>
<a class="sourceLine" id="cb776-5" title="5"><span class="im">from</span> Bio.Seq <span class="im">import</span> Seq</a>
<a class="sourceLine" id="cb776-6" title="6"><span class="im">import</span> Bio</a>
<a class="sourceLine" id="cb776-7" title="7"><span class="im">from</span> Bio <span class="im">import</span> pairwise2</a>
<a class="sourceLine" id="cb776-8" title="8"><span class="im">from</span> Bio.Blast <span class="im">import</span> NCBIWWW, NCBIXML</a>
<a class="sourceLine" id="cb776-9" title="9"><span class="im">from</span> Bio.SubsMat <span class="im">import</span> MatrixInfo <span class="im">as</span> matlist</a>
<a class="sourceLine" id="cb776-10" title="10"></a>
<a class="sourceLine" id="cb776-11" title="11"><span class="kw">def</span> align(seq1, seq2):</a>
<a class="sourceLine" id="cb776-12" title="12">    <span class="co">&#39;&#39;&#39;</span></a>
<a class="sourceLine" id="cb776-13" title="13"><span class="co">    Align the two amino acid sequences with BLOSUM62 and return aligned sequences</span></a>
<a class="sourceLine" id="cb776-14" title="14"><span class="co">    &#39;&#39;&#39;</span></a>
<a class="sourceLine" id="cb776-15" title="15">    matrix <span class="op">=</span> matlist.blosum62</a>
<a class="sourceLine" id="cb776-16" title="16">    gap_open <span class="op">=</span> <span class="dv">-10</span></a>
<a class="sourceLine" id="cb776-17" title="17">    gap_extend <span class="op">=</span> <span class="fl">-0.5</span></a>
<a class="sourceLine" id="cb776-18" title="18">    alns <span class="op">=</span> pairwise2.align.globalds(seq1, seq2, matrix, gap_open, gap_extend)</a>
<a class="sourceLine" id="cb776-19" title="19">    top_aln <span class="op">=</span> alns[<span class="dv">0</span>]</a>
<a class="sourceLine" id="cb776-20" title="20">    aligned <span class="op">=</span> pairwise2.format_alignment(<span class="op">*</span>top_aln)</a>
<a class="sourceLine" id="cb776-21" title="21">    <span class="cf">return</span> aligned</a>
<a class="sourceLine" id="cb776-22" title="22">seq1 <span class="op">=</span> Seq(<span class="st">&#39;EEKG&#39;</span>)</a>
<a class="sourceLine" id="cb776-23" title="23">seq2 <span class="op">=</span> Seq(<span class="st">&#39;SSSDEKA&#39;</span>)</a>
<a class="sourceLine" id="cb776-24" title="24">a <span class="op">=</span> align(seq1, seq2)</a>
<a class="sourceLine" id="cb776-25" title="25">result <span class="op">=</span> a[<span class="dv">0</span>] <span class="op">==</span> <span class="st">&#39;---EEKG&#39;</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-70">Run 3</h4>
<div class="sourceCode" id="cb778"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb778-1" title="1"><span class="im">from</span> Bio <span class="im">import</span> SeqIO</a>
<a class="sourceLine" id="cb778-2" title="2"><span class="im">from</span> Bio <span class="im">import</span> Align</a>
<a class="sourceLine" id="cb778-3" title="3"><span class="im">from</span> Bio <span class="im">import</span> PopGen</a>
<a class="sourceLine" id="cb778-4" title="4"><span class="im">from</span> Bio.PDB <span class="im">import</span> <span class="op">*</span></a>
<a class="sourceLine" id="cb778-5" title="5"><span class="im">from</span> Bio.Seq <span class="im">import</span> Seq</a>
<a class="sourceLine" id="cb778-6" title="6"><span class="im">import</span> Bio</a>
<a class="sourceLine" id="cb778-7" title="7"><span class="im">from</span> Bio <span class="im">import</span> pairwise2</a>
<a class="sourceLine" id="cb778-8" title="8"><span class="im">from</span> Bio.Blast <span class="im">import</span> NCBIWWW, NCBIXML</a>
<a class="sourceLine" id="cb778-9" title="9"><span class="im">from</span> Bio.SubsMat <span class="im">import</span> MatrixInfo <span class="im">as</span> matlist</a>
<a class="sourceLine" id="cb778-10" title="10"></a>
<a class="sourceLine" id="cb778-11" title="11"><span class="kw">def</span> align(seq1, seq2):</a>
<a class="sourceLine" id="cb778-12" title="12">    <span class="co">&#39;&#39;&#39;</span></a>
<a class="sourceLine" id="cb778-13" title="13"><span class="co">    Align the two amino acid sequences with BLOSUM62 and return aligned sequences</span></a>
<a class="sourceLine" id="cb778-14" title="14"><span class="co">    &#39;&#39;&#39;</span></a>
<a class="sourceLine" id="cb778-15" title="15">    matrix <span class="op">=</span> matlist.blosum62</a>
<a class="sourceLine" id="cb778-16" title="16">    gap_open <span class="op">=</span> <span class="dv">-10</span></a>
<a class="sourceLine" id="cb778-17" title="17">    gap_extend <span class="op">=</span> <span class="fl">-0.5</span></a>
<a class="sourceLine" id="cb778-18" title="18">    alns <span class="op">=</span> pairwise2.align.globalds(seq1, seq2, matrix, gap_open, gap_extend)</a>
<a class="sourceLine" id="cb778-19" title="19">    aligned <span class="op">=</span> pairwise2.format_alignment(<span class="op">*</span>alns[<span class="dv">0</span>])</a>
<a class="sourceLine" id="cb778-20" title="20">    <span class="cf">return</span> aligned</a>
<a class="sourceLine" id="cb778-21" title="21">seq1 <span class="op">=</span> Seq(<span class="st">&#39;EEKG&#39;</span>)</a>
<a class="sourceLine" id="cb778-22" title="22">seq2 <span class="op">=</span> Seq(<span class="st">&#39;SSSDEKA&#39;</span>)</a>
<a class="sourceLine" id="cb778-23" title="23">a <span class="op">=</span> align(seq1, seq2)</a>
<a class="sourceLine" id="cb778-24" title="24">result <span class="op">=</span> a[<span class="dv">0</span>] <span class="op">==</span> <span class="st">&#39;---EEKG&#39;</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-70">Run 4</h4>
<div class="sourceCode" id="cb780"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb780-1" title="1"><span class="im">from</span> Bio <span class="im">import</span> SeqIO</a>
<a class="sourceLine" id="cb780-2" title="2"><span class="im">from</span> Bio <span class="im">import</span> Align</a>
<a class="sourceLine" id="cb780-3" title="3"><span class="im">from</span> Bio <span class="im">import</span> PopGen</a>
<a class="sourceLine" id="cb780-4" title="4"><span class="im">from</span> Bio.PDB <span class="im">import</span> <span class="op">*</span></a>
<a class="sourceLine" id="cb780-5" title="5"><span class="im">from</span> Bio.Seq <span class="im">import</span> Seq</a>
<a class="sourceLine" id="cb780-6" title="6"><span class="im">import</span> Bio</a>
<a class="sourceLine" id="cb780-7" title="7"><span class="im">from</span> Bio <span class="im">import</span> pairwise2</a>
<a class="sourceLine" id="cb780-8" title="8"><span class="im">from</span> Bio.Blast <span class="im">import</span> NCBIWWW, NCBIXML</a>
<a class="sourceLine" id="cb780-9" title="9"><span class="im">from</span> Bio.SubsMat <span class="im">import</span> MatrixInfo <span class="im">as</span> matlist</a>
<a class="sourceLine" id="cb780-10" title="10"></a>
<a class="sourceLine" id="cb780-11" title="11"><span class="kw">def</span> align(seq1, seq2):</a>
<a class="sourceLine" id="cb780-12" title="12">    <span class="co">&#39;&#39;&#39;</span></a>
<a class="sourceLine" id="cb780-13" title="13"><span class="co">    Align the two amino acid sequences with BLOSUM62 and return aligned sequences</span></a>
<a class="sourceLine" id="cb780-14" title="14"><span class="co">    &#39;&#39;&#39;</span></a>
<a class="sourceLine" id="cb780-15" title="15">    matrix <span class="op">=</span> matlist.blosum62</a>
<a class="sourceLine" id="cb780-16" title="16">    gap_open <span class="op">=</span> <span class="dv">-10</span></a>
<a class="sourceLine" id="cb780-17" title="17">    gap_extend <span class="op">=</span> <span class="fl">-0.5</span></a>
<a class="sourceLine" id="cb780-18" title="18">    alns <span class="op">=</span> pairwise2.align.globalds(seq1, seq2, matrix, gap_open, gap_extend)</a>
<a class="sourceLine" id="cb780-19" title="19">    aligned <span class="op">=</span> pairwise2.format_alignment(<span class="op">*</span>alns[<span class="dv">0</span>])</a>
<a class="sourceLine" id="cb780-20" title="20">    <span class="cf">return</span> aligned</a>
<a class="sourceLine" id="cb780-21" title="21">seq1 <span class="op">=</span> Seq(<span class="st">&#39;EEKG&#39;</span>)</a>
<a class="sourceLine" id="cb780-22" title="22">seq2 <span class="op">=</span> Seq(<span class="st">&#39;SSSDEKA&#39;</span>)</a>
<a class="sourceLine" id="cb780-23" title="23">a <span class="op">=</span> align(seq1, seq2)</a>
<a class="sourceLine" id="cb780-24" title="24">result <span class="op">=</span> a[<span class="dv">0</span>] <span class="op">==</span> <span class="st">&#39;---EEKG&#39;</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>seq-trans</summary></p>
<h4 id="query-71">Query</h4>
<div class="sourceCode" id="cb782"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb782-1" title="1"><span class="im">from</span> Bio <span class="im">import</span> SeqIO</a>
<a class="sourceLine" id="cb782-2" title="2"><span class="im">from</span> Bio <span class="im">import</span> Align</a>
<a class="sourceLine" id="cb782-3" title="3"><span class="im">from</span> Bio <span class="im">import</span> PopGen</a>
<a class="sourceLine" id="cb782-4" title="4"><span class="im">from</span> Bio.PDB <span class="im">import</span> <span class="op">*</span></a>
<a class="sourceLine" id="cb782-5" title="5"><span class="im">from</span> Bio.Seq <span class="im">import</span> Seq</a>
<a class="sourceLine" id="cb782-6" title="6"><span class="im">import</span> Bio</a>
<a class="sourceLine" id="cb782-7" title="7"><span class="im">from</span> Bio <span class="im">import</span> pairwise2</a>
<a class="sourceLine" id="cb782-8" title="8"><span class="im">from</span> Bio.Blast <span class="im">import</span> NCBIWWW, NCBIXML</a>
<a class="sourceLine" id="cb782-9" title="9"><span class="im">from</span> Bio.SubsMat <span class="im">import</span> MatrixInfo <span class="im">as</span> matlist</a>
<a class="sourceLine" id="cb782-10" title="10"></a>
<a class="sourceLine" id="cb782-11" title="11"><span class="kw">def</span> nucleotide_translate(gene_seq):</a>
<a class="sourceLine" id="cb782-12" title="12">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb782-13" title="13"><span class="co">  Converts nucleotide sequence to amino acids. Returns a string</span></a>
<a class="sourceLine" id="cb782-14" title="14"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb782-15" title="15">  [insert]</a>
<a class="sourceLine" id="cb782-16" title="16">  <span class="cf">return</span> prot_seq</a></code></pre></div>
<h4 id="run-0-71">Run 0</h4>
<div class="sourceCode" id="cb783"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb783-1" title="1"><span class="im">from</span> Bio <span class="im">import</span> SeqIO</a>
<a class="sourceLine" id="cb783-2" title="2"><span class="im">from</span> Bio <span class="im">import</span> Align</a>
<a class="sourceLine" id="cb783-3" title="3"><span class="im">from</span> Bio <span class="im">import</span> PopGen</a>
<a class="sourceLine" id="cb783-4" title="4"><span class="im">from</span> Bio.PDB <span class="im">import</span> <span class="op">*</span></a>
<a class="sourceLine" id="cb783-5" title="5"><span class="im">from</span> Bio.Seq <span class="im">import</span> Seq</a>
<a class="sourceLine" id="cb783-6" title="6"><span class="im">import</span> Bio</a>
<a class="sourceLine" id="cb783-7" title="7"><span class="im">from</span> Bio <span class="im">import</span> pairwise2</a>
<a class="sourceLine" id="cb783-8" title="8"><span class="im">from</span> Bio.Blast <span class="im">import</span> NCBIWWW, NCBIXML</a>
<a class="sourceLine" id="cb783-9" title="9"><span class="im">from</span> Bio.SubsMat <span class="im">import</span> MatrixInfo <span class="im">as</span> matlist</a>
<a class="sourceLine" id="cb783-10" title="10"></a>
<a class="sourceLine" id="cb783-11" title="11"><span class="kw">def</span> nucleotide_translate(gene_seq):</a>
<a class="sourceLine" id="cb783-12" title="12">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb783-13" title="13"><span class="co">  Converts nucleotide sequence to amino acids. Returns a string</span></a>
<a class="sourceLine" id="cb783-14" title="14"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb783-15" title="15">  prot_seq <span class="op">=</span> Seq(gene_seq).translate()</a>
<a class="sourceLine" id="cb783-16" title="16">  <span class="cf">return</span> prot_seq</a>
<a class="sourceLine" id="cb783-17" title="17">ns <span class="op">=</span> <span class="st">&#39;atgaggtctttgctaatcttggtgctttgcttcctgcccctggctgctctggggaaagtctttggacgatgtgagctggcagcggctatgaagcgtcacggacttgataactatcggggatacagcctgggaaactgggtgtgtgctgcaaaattcgagagtaacttcaacacccaggctacaaaccgtaacaccgatgggagtaccgactacggaatcctacagatcaacagccgctggtggtgcaacgatggcaggaccccaggctccaggaacctgtgcaacatcccgtgctcagccctgctgagctcagacataacagcgagcgtgaactgcgcgaagaagatcgtcagcgatggaaacggcatgaacgcgtgggtcgcctggcgcaaccgctgcaagggcaccgacgtccaggcgtggatcagaggctgccggctgtga&#39;</span></a>
<a class="sourceLine" id="cb783-18" title="18">ps <span class="op">=</span> <span class="st">&#39;MRSLLILVLCFLPLAALGKVFGRCELAAAMKRHGLDNYRGYSLGNWVCAAKFESNFNTQATNRNTDGSTDYGILQINSRWWCNDGRTPGSRNLCNIPCSALLSSDITASVNCAKKIVSDGNGMNAWVAWRNRCKGTDVQAWIRGCRL&#39;</span></a>
<a class="sourceLine" id="cb783-19" title="19">tps <span class="op">=</span> nucleotide_translate(ns)</a>
<a class="sourceLine" id="cb783-20" title="20">result <span class="op">=</span> ps <span class="kw">in</span> tps</a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-71">Run 1</h4>
<div class="sourceCode" id="cb785"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb785-1" title="1"><span class="im">from</span> Bio <span class="im">import</span> SeqIO</a>
<a class="sourceLine" id="cb785-2" title="2"><span class="im">from</span> Bio <span class="im">import</span> Align</a>
<a class="sourceLine" id="cb785-3" title="3"><span class="im">from</span> Bio <span class="im">import</span> PopGen</a>
<a class="sourceLine" id="cb785-4" title="4"><span class="im">from</span> Bio.PDB <span class="im">import</span> <span class="op">*</span></a>
<a class="sourceLine" id="cb785-5" title="5"><span class="im">from</span> Bio.Seq <span class="im">import</span> Seq</a>
<a class="sourceLine" id="cb785-6" title="6"><span class="im">import</span> Bio</a>
<a class="sourceLine" id="cb785-7" title="7"><span class="im">from</span> Bio <span class="im">import</span> pairwise2</a>
<a class="sourceLine" id="cb785-8" title="8"><span class="im">from</span> Bio.Blast <span class="im">import</span> NCBIWWW, NCBIXML</a>
<a class="sourceLine" id="cb785-9" title="9"><span class="im">from</span> Bio.SubsMat <span class="im">import</span> MatrixInfo <span class="im">as</span> matlist</a>
<a class="sourceLine" id="cb785-10" title="10"></a>
<a class="sourceLine" id="cb785-11" title="11"><span class="kw">def</span> nucleotide_translate(gene_seq):</a>
<a class="sourceLine" id="cb785-12" title="12">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb785-13" title="13"><span class="co">  Converts nucleotide sequence to amino acids. Returns a string</span></a>
<a class="sourceLine" id="cb785-14" title="14"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb785-15" title="15">  prot_seq <span class="op">=</span> gene_seq.translate()</a>
<a class="sourceLine" id="cb785-16" title="16">  <span class="cf">return</span> prot_seq</a>
<a class="sourceLine" id="cb785-17" title="17">ns <span class="op">=</span> <span class="st">&#39;atgaggtctttgctaatcttggtgctttgcttcctgcccctggctgctctggggaaagtctttggacgatgtgagctggcagcggctatgaagcgtcacggacttgataactatcggggatacagcctgggaaactgggtgtgtgctgcaaaattcgagagtaacttcaacacccaggctacaaaccgtaacaccgatgggagtaccgactacggaatcctacagatcaacagccgctggtggtgcaacgatggcaggaccccaggctccaggaacctgtgcaacatcccgtgctcagccctgctgagctcagacataacagcgagcgtgaactgcgcgaagaagatcgtcagcgatggaaacggcatgaacgcgtgggtcgcctggcgcaaccgctgcaagggcaccgacgtccaggcgtggatcagaggctgccggctgtga&#39;</span></a>
<a class="sourceLine" id="cb785-18" title="18">ps <span class="op">=</span> <span class="st">&#39;MRSLLILVLCFLPLAALGKVFGRCELAAAMKRHGLDNYRGYSLGNWVCAAKFESNFNTQATNRNTDGSTDYGILQINSRWWCNDGRTPGSRNLCNIPCSALLSSDITASVNCAKKIVSDGNGMNAWVAWRNRCKGTDVQAWIRGCRL&#39;</span></a>
<a class="sourceLine" id="cb785-19" title="19">tps <span class="op">=</span> nucleotide_translate(ns)</a>
<a class="sourceLine" id="cb785-20" title="20">result <span class="op">=</span> ps <span class="kw">in</span> tps</a></code></pre></div>
<p>Output:</p>
<pre><code>translate() takes exactly one argument (0 given)</code></pre>
<h4 id="run-2-71">Run 2</h4>
<div class="sourceCode" id="cb787"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb787-1" title="1"><span class="im">from</span> Bio <span class="im">import</span> SeqIO</a>
<a class="sourceLine" id="cb787-2" title="2"><span class="im">from</span> Bio <span class="im">import</span> Align</a>
<a class="sourceLine" id="cb787-3" title="3"><span class="im">from</span> Bio <span class="im">import</span> PopGen</a>
<a class="sourceLine" id="cb787-4" title="4"><span class="im">from</span> Bio.PDB <span class="im">import</span> <span class="op">*</span></a>
<a class="sourceLine" id="cb787-5" title="5"><span class="im">from</span> Bio.Seq <span class="im">import</span> Seq</a>
<a class="sourceLine" id="cb787-6" title="6"><span class="im">import</span> Bio</a>
<a class="sourceLine" id="cb787-7" title="7"><span class="im">from</span> Bio <span class="im">import</span> pairwise2</a>
<a class="sourceLine" id="cb787-8" title="8"><span class="im">from</span> Bio.Blast <span class="im">import</span> NCBIWWW, NCBIXML</a>
<a class="sourceLine" id="cb787-9" title="9"><span class="im">from</span> Bio.SubsMat <span class="im">import</span> MatrixInfo <span class="im">as</span> matlist</a>
<a class="sourceLine" id="cb787-10" title="10"></a>
<a class="sourceLine" id="cb787-11" title="11"><span class="kw">def</span> nucleotide_translate(gene_seq):</a>
<a class="sourceLine" id="cb787-12" title="12">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb787-13" title="13"><span class="co">  Converts nucleotide sequence to amino acids. Returns a string</span></a>
<a class="sourceLine" id="cb787-14" title="14"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb787-15" title="15">  prot_seq <span class="op">=</span> Seq(gene_seq).translate()</a>
<a class="sourceLine" id="cb787-16" title="16">  <span class="cf">return</span> prot_seq</a>
<a class="sourceLine" id="cb787-17" title="17">ns <span class="op">=</span> <span class="st">&#39;atgaggtctttgctaatcttggtgctttgcttcctgcccctggctgctctggggaaagtctttggacgatgtgagctggcagcggctatgaagcgtcacggacttgataactatcggggatacagcctgggaaactgggtgtgtgctgcaaaattcgagagtaacttcaacacccaggctacaaaccgtaacaccgatgggagtaccgactacggaatcctacagatcaacagccgctggtggtgcaacgatggcaggaccccaggctccaggaacctgtgcaacatcccgtgctcagccctgctgagctcagacataacagcgagcgtgaactgcgcgaagaagatcgtcagcgatggaaacggcatgaacgcgtgggtcgcctggcgcaaccgctgcaagggcaccgacgtccaggcgtggatcagaggctgccggctgtga&#39;</span></a>
<a class="sourceLine" id="cb787-18" title="18">ps <span class="op">=</span> <span class="st">&#39;MRSLLILVLCFLPLAALGKVFGRCELAAAMKRHGLDNYRGYSLGNWVCAAKFESNFNTQATNRNTDGSTDYGILQINSRWWCNDGRTPGSRNLCNIPCSALLSSDITASVNCAKKIVSDGNGMNAWVAWRNRCKGTDVQAWIRGCRL&#39;</span></a>
<a class="sourceLine" id="cb787-19" title="19">tps <span class="op">=</span> nucleotide_translate(ns)</a>
<a class="sourceLine" id="cb787-20" title="20">result <span class="op">=</span> ps <span class="kw">in</span> tps</a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-71">Run 3</h4>
<div class="sourceCode" id="cb789"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb789-1" title="1"><span class="im">from</span> Bio <span class="im">import</span> SeqIO</a>
<a class="sourceLine" id="cb789-2" title="2"><span class="im">from</span> Bio <span class="im">import</span> Align</a>
<a class="sourceLine" id="cb789-3" title="3"><span class="im">from</span> Bio <span class="im">import</span> PopGen</a>
<a class="sourceLine" id="cb789-4" title="4"><span class="im">from</span> Bio.PDB <span class="im">import</span> <span class="op">*</span></a>
<a class="sourceLine" id="cb789-5" title="5"><span class="im">from</span> Bio.Seq <span class="im">import</span> Seq</a>
<a class="sourceLine" id="cb789-6" title="6"><span class="im">import</span> Bio</a>
<a class="sourceLine" id="cb789-7" title="7"><span class="im">from</span> Bio <span class="im">import</span> pairwise2</a>
<a class="sourceLine" id="cb789-8" title="8"><span class="im">from</span> Bio.Blast <span class="im">import</span> NCBIWWW, NCBIXML</a>
<a class="sourceLine" id="cb789-9" title="9"><span class="im">from</span> Bio.SubsMat <span class="im">import</span> MatrixInfo <span class="im">as</span> matlist</a>
<a class="sourceLine" id="cb789-10" title="10"></a>
<a class="sourceLine" id="cb789-11" title="11"><span class="kw">def</span> nucleotide_translate(gene_seq):</a>
<a class="sourceLine" id="cb789-12" title="12">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb789-13" title="13"><span class="co">  Converts nucleotide sequence to amino acids. Returns a string</span></a>
<a class="sourceLine" id="cb789-14" title="14"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb789-15" title="15">  prot_seq <span class="op">=</span> Seq(gene_seq).translate()</a>
<a class="sourceLine" id="cb789-16" title="16">  <span class="cf">return</span> prot_seq</a>
<a class="sourceLine" id="cb789-17" title="17">ns <span class="op">=</span> <span class="st">&#39;atgaggtctttgctaatcttggtgctttgcttcctgcccctggctgctctggggaaagtctttggacgatgtgagctggcagcggctatgaagcgtcacggacttgataactatcggggatacagcctgggaaactgggtgtgtgctgcaaaattcgagagtaacttcaacacccaggctacaaaccgtaacaccgatgggagtaccgactacggaatcctacagatcaacagccgctggtggtgcaacgatggcaggaccccaggctccaggaacctgtgcaacatcccgtgctcagccctgctgagctcagacataacagcgagcgtgaactgcgcgaagaagatcgtcagcgatggaaacggcatgaacgcgtgggtcgcctggcgcaaccgctgcaagggcaccgacgtccaggcgtggatcagaggctgccggctgtga&#39;</span></a>
<a class="sourceLine" id="cb789-18" title="18">ps <span class="op">=</span> <span class="st">&#39;MRSLLILVLCFLPLAALGKVFGRCELAAAMKRHGLDNYRGYSLGNWVCAAKFESNFNTQATNRNTDGSTDYGILQINSRWWCNDGRTPGSRNLCNIPCSALLSSDITASVNCAKKIVSDGNGMNAWVAWRNRCKGTDVQAWIRGCRL&#39;</span></a>
<a class="sourceLine" id="cb789-19" title="19">tps <span class="op">=</span> nucleotide_translate(ns)</a>
<a class="sourceLine" id="cb789-20" title="20">result <span class="op">=</span> ps <span class="kw">in</span> tps</a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-71">Run 4</h4>
<div class="sourceCode" id="cb791"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb791-1" title="1"><span class="im">from</span> Bio <span class="im">import</span> SeqIO</a>
<a class="sourceLine" id="cb791-2" title="2"><span class="im">from</span> Bio <span class="im">import</span> Align</a>
<a class="sourceLine" id="cb791-3" title="3"><span class="im">from</span> Bio <span class="im">import</span> PopGen</a>
<a class="sourceLine" id="cb791-4" title="4"><span class="im">from</span> Bio.PDB <span class="im">import</span> <span class="op">*</span></a>
<a class="sourceLine" id="cb791-5" title="5"><span class="im">from</span> Bio.Seq <span class="im">import</span> Seq</a>
<a class="sourceLine" id="cb791-6" title="6"><span class="im">import</span> Bio</a>
<a class="sourceLine" id="cb791-7" title="7"><span class="im">from</span> Bio <span class="im">import</span> pairwise2</a>
<a class="sourceLine" id="cb791-8" title="8"><span class="im">from</span> Bio.Blast <span class="im">import</span> NCBIWWW, NCBIXML</a>
<a class="sourceLine" id="cb791-9" title="9"><span class="im">from</span> Bio.SubsMat <span class="im">import</span> MatrixInfo <span class="im">as</span> matlist</a>
<a class="sourceLine" id="cb791-10" title="10"></a>
<a class="sourceLine" id="cb791-11" title="11"><span class="kw">def</span> nucleotide_translate(gene_seq):</a>
<a class="sourceLine" id="cb791-12" title="12">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb791-13" title="13"><span class="co">  Converts nucleotide sequence to amino acids. Returns a string</span></a>
<a class="sourceLine" id="cb791-14" title="14"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb791-15" title="15">  prot_seq <span class="op">=</span> Seq(gene_seq).translate()</a>
<a class="sourceLine" id="cb791-16" title="16">  <span class="cf">return</span> prot_seq</a>
<a class="sourceLine" id="cb791-17" title="17">ns <span class="op">=</span> <span class="st">&#39;atgaggtctttgctaatcttggtgctttgcttcctgcccctggctgctctggggaaagtctttggacgatgtgagctggcagcggctatgaagcgtcacggacttgataactatcggggatacagcctgggaaactgggtgtgtgctgcaaaattcgagagtaacttcaacacccaggctacaaaccgtaacaccgatgggagtaccgactacggaatcctacagatcaacagccgctggtggtgcaacgatggcaggaccccaggctccaggaacctgtgcaacatcccgtgctcagccctgctgagctcagacataacagcgagcgtgaactgcgcgaagaagatcgtcagcgatggaaacggcatgaacgcgtgggtcgcctggcgcaaccgctgcaagggcaccgacgtccaggcgtggatcagaggctgccggctgtga&#39;</span></a>
<a class="sourceLine" id="cb791-18" title="18">ps <span class="op">=</span> <span class="st">&#39;MRSLLILVLCFLPLAALGKVFGRCELAAAMKRHGLDNYRGYSLGNWVCAAKFESNFNTQATNRNTDGSTDYGILQINSRWWCNDGRTPGSRNLCNIPCSALLSSDITASVNCAKKIVSDGNGMNAWVAWRNRCKGTDVQAWIRGCRL&#39;</span></a>
<a class="sourceLine" id="cb791-19" title="19">tps <span class="op">=</span> nucleotide_translate(ns)</a>
<a class="sourceLine" id="cb791-20" title="20">result <span class="op">=</span> ps <span class="kw">in</span> tps</a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>sequence</summary></p>
<h4 id="query-72">Query</h4>
<div class="sourceCode" id="cb793"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb793-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb793-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb793-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb793-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb793-5" title="5"></a>
<a class="sourceLine" id="cb793-6" title="6"><span class="kw">def</span> gen_geometric_sequence(s,e,l):</a>
<a class="sourceLine" id="cb793-7" title="7">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb793-8" title="8"><span class="co">    This function return a geometric sequence that starts at s, ends at e with length l</span></a>
<a class="sourceLine" id="cb793-9" title="9"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb793-10" title="10">    [insert]</a>
<a class="sourceLine" id="cb793-11" title="11">    <span class="cf">return</span> x</a></code></pre></div>
<h4 id="run-0-72">Run 0</h4>
<div class="sourceCode" id="cb794"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb794-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb794-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb794-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb794-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb794-5" title="5"></a>
<a class="sourceLine" id="cb794-6" title="6"><span class="kw">def</span> gen_geometric_sequence(s,e,l):</a>
<a class="sourceLine" id="cb794-7" title="7">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb794-8" title="8"><span class="co">    This function return a geometric sequence that starts at s, ends at e with length l</span></a>
<a class="sourceLine" id="cb794-9" title="9"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb794-10" title="10">    x <span class="op">=</span> np.zeros(l)</a>
<a class="sourceLine" id="cb794-11" title="11">    x[<span class="dv">0</span>] <span class="op">=</span> s</a>
<a class="sourceLine" id="cb794-12" title="12">    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>,l):</a>
<a class="sourceLine" id="cb794-13" title="13">        x[i] <span class="op">=</span> x[i<span class="dv">-1</span>]<span class="op">*</span>e</a>
<a class="sourceLine" id="cb794-14" title="14">    <span class="cf">return</span> x</a>
<a class="sourceLine" id="cb794-15" title="15">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">all</span>(gen_geometric_sequence(<span class="dv">1</span>,<span class="dv">100</span>,<span class="dv">3</span>)<span class="op">==</span> [<span class="dv">1</span>,<span class="dv">10</span>,<span class="dv">100</span>]) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-72">Run 1</h4>
<div class="sourceCode" id="cb796"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb796-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb796-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb796-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb796-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb796-5" title="5"></a>
<a class="sourceLine" id="cb796-6" title="6"><span class="kw">def</span> gen_geometric_sequence(s,e,l):</a>
<a class="sourceLine" id="cb796-7" title="7">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb796-8" title="8"><span class="co">    This function return a geometric sequence that starts at s, ends at e with length l</span></a>
<a class="sourceLine" id="cb796-9" title="9"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb796-10" title="10">    x <span class="op">=</span> np.zeros(l)</a>
<a class="sourceLine" id="cb796-11" title="11">    x[<span class="dv">0</span>] <span class="op">=</span> s</a>
<a class="sourceLine" id="cb796-12" title="12">    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>,l):</a>
<a class="sourceLine" id="cb796-13" title="13">        x[i] <span class="op">=</span> x[i<span class="dv">-1</span>]<span class="op">*</span>e</a>
<a class="sourceLine" id="cb796-14" title="14"></a>
<a class="sourceLine" id="cb796-15" title="15">    <span class="cf">return</span> x</a>
<a class="sourceLine" id="cb796-16" title="16">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">all</span>(gen_geometric_sequence(<span class="dv">1</span>,<span class="dv">100</span>,<span class="dv">3</span>)<span class="op">==</span> [<span class="dv">1</span>,<span class="dv">10</span>,<span class="dv">100</span>]) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-72">Run 2</h4>
<div class="sourceCode" id="cb798"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb798-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb798-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb798-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb798-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb798-5" title="5"></a>
<a class="sourceLine" id="cb798-6" title="6"><span class="kw">def</span> gen_geometric_sequence(s,e,l):</a>
<a class="sourceLine" id="cb798-7" title="7">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb798-8" title="8"><span class="co">    This function return a geometric sequence that starts at s, ends at e with length l</span></a>
<a class="sourceLine" id="cb798-9" title="9"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb798-10" title="10">    x <span class="op">=</span> np.geomspace(s,e,l)</a>
<a class="sourceLine" id="cb798-11" title="11">    <span class="cf">return</span> x</a>
<a class="sourceLine" id="cb798-12" title="12">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">all</span>(gen_geometric_sequence(<span class="dv">1</span>,<span class="dv">100</span>,<span class="dv">3</span>)<span class="op">==</span> [<span class="dv">1</span>,<span class="dv">10</span>,<span class="dv">100</span>]) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-72">Run 3</h4>
<div class="sourceCode" id="cb800"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb800-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb800-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb800-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb800-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb800-5" title="5"></a>
<a class="sourceLine" id="cb800-6" title="6"><span class="kw">def</span> gen_geometric_sequence(s,e,l):</a>
<a class="sourceLine" id="cb800-7" title="7">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb800-8" title="8"><span class="co">    This function return a geometric sequence that starts at s, ends at e with length l</span></a>
<a class="sourceLine" id="cb800-9" title="9"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb800-10" title="10">    x <span class="op">=</span> np.linspace(s,e,l)</a>
<a class="sourceLine" id="cb800-11" title="11">    x <span class="op">=</span> np.power(<span class="dv">10</span>,x)</a>
<a class="sourceLine" id="cb800-12" title="12">    <span class="cf">return</span> x</a>
<a class="sourceLine" id="cb800-13" title="13">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">all</span>(gen_geometric_sequence(<span class="dv">1</span>,<span class="dv">100</span>,<span class="dv">3</span>)<span class="op">==</span> [<span class="dv">1</span>,<span class="dv">10</span>,<span class="dv">100</span>]) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-72">Run 4</h4>
<div class="sourceCode" id="cb802"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb802-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb802-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb802-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb802-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb802-5" title="5"></a>
<a class="sourceLine" id="cb802-6" title="6"><span class="kw">def</span> gen_geometric_sequence(s,e,l):</a>
<a class="sourceLine" id="cb802-7" title="7">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb802-8" title="8"><span class="co">    This function return a geometric sequence that starts at s, ends at e with length l</span></a>
<a class="sourceLine" id="cb802-9" title="9"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb802-10" title="10">    x <span class="op">=</span> np.zeros(l)</a>
<a class="sourceLine" id="cb802-11" title="11">    x[<span class="dv">0</span>] <span class="op">=</span> s</a>
<a class="sourceLine" id="cb802-12" title="12">    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>,l):</a>
<a class="sourceLine" id="cb802-13" title="13">        x[i] <span class="op">=</span> x[i<span class="dv">-1</span>]<span class="op">*</span>e</a>
<a class="sourceLine" id="cb802-14" title="14"></a>
<a class="sourceLine" id="cb802-15" title="15">    <span class="cf">return</span> x</a>
<a class="sourceLine" id="cb802-16" title="16">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">all</span>(gen_geometric_sequence(<span class="dv">1</span>,<span class="dv">100</span>,<span class="dv">3</span>)<span class="op">==</span> [<span class="dv">1</span>,<span class="dv">10</span>,<span class="dv">100</span>]) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>sle</summary></p>
<h4 id="query-73">Query</h4>
<div class="sourceCode" id="cb804"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb804-1" title="1"><span class="im">import</span> sympy</a>
<a class="sourceLine" id="cb804-2" title="2"></a>
<a class="sourceLine" id="cb804-3" title="3"><span class="kw">def</span> sle(eqns):</a>
<a class="sourceLine" id="cb804-4" title="4">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb804-5" title="5"><span class="co">  This function solves a system of linear equations {[&#39;a_0x_0 + b_0x_1 = c0&#39;,&#39;a_1x_0 + b_1x_1 = c1&#39;]}.</span></a>
<a class="sourceLine" id="cb804-6" title="6"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb804-7" title="7">  [insert]</a>
<a class="sourceLine" id="cb804-8" title="8">  <span class="cf">return</span> x</a></code></pre></div>
<h4 id="run-0-73">Run 0</h4>
<div class="sourceCode" id="cb805"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb805-1" title="1"><span class="im">import</span> sympy</a>
<a class="sourceLine" id="cb805-2" title="2"></a>
<a class="sourceLine" id="cb805-3" title="3"><span class="kw">def</span> sle(eqns):</a>
<a class="sourceLine" id="cb805-4" title="4">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb805-5" title="5"><span class="co">  This function solves a system of linear equations {[&#39;a_0x_0 + b_0x_1 = c0&#39;,&#39;a_1x_0 + b_1x_1 = c1&#39;]}.</span></a>
<a class="sourceLine" id="cb805-6" title="6"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb805-7" title="7">  x <span class="op">=</span> sympy.solve(eqns)</a>
<a class="sourceLine" id="cb805-8" title="8">  <span class="cf">return</span> x</a>
<a class="sourceLine" id="cb805-9" title="9"><span class="im">from</span> sympy <span class="im">import</span> solve, Eq</a>
<a class="sourceLine" id="cb805-10" title="10"><span class="im">from</span> sympy.parsing.sympy_parser <span class="im">import</span> parse_expr</a>
<a class="sourceLine" id="cb805-11" title="11"><span class="im">from</span> sympy.parsing.sympy_parser <span class="im">import</span> standard_transformations, implicit_multiplication_application</a>
<a class="sourceLine" id="cb805-12" title="12"></a>
<a class="sourceLine" id="cb805-13" title="13">eqns <span class="op">=</span> [<span class="st">&#39;4x + 3y = 20&#39;</span>, <span class="st">&#39;-5x + 9y = 26&#39;</span>]</a>
<a class="sourceLine" id="cb805-14" title="14">transformations <span class="op">=</span> (standard_transformations <span class="op">+</span></a>
<a class="sourceLine" id="cb805-15" title="15">                   (implicit_multiplication_application,))</a>
<a class="sourceLine" id="cb805-16" title="16">parsed_eqs <span class="op">=</span> []</a>
<a class="sourceLine" id="cb805-17" title="17"><span class="cf">for</span> eq <span class="kw">in</span> eqns:</a>
<a class="sourceLine" id="cb805-18" title="18">        sides <span class="op">=</span> [parse_expr(s, transformations<span class="op">=</span>transformations)</a>
<a class="sourceLine" id="cb805-19" title="19">                <span class="cf">for</span> s <span class="kw">in</span> eq.split(<span class="st">&#39;=&#39;</span>)]</a>
<a class="sourceLine" id="cb805-20" title="20">        parsed_eqs.append(Eq(sides[<span class="dv">0</span>], sides[<span class="dv">1</span>]))</a>
<a class="sourceLine" id="cb805-21" title="21">soln <span class="op">=</span> solve(parsed_eqs)</a>
<a class="sourceLine" id="cb805-22" title="22">test_sol_values <span class="op">=</span> [soln.get(<span class="bu">list</span>(soln.keys())[<span class="dv">0</span>]), soln.get(<span class="bu">list</span>(soln.keys())[<span class="dv">1</span>])]</a>
<a class="sourceLine" id="cb805-23" title="23"></a>
<a class="sourceLine" id="cb805-24" title="24">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> <span class="bu">list</span>(sle(eqns).values()) <span class="op">==</span> test_sol_values <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Sympify of expression &#39;could not parse &#39;4x + 3y = 20&#39;&#39; failed, because of exception being raised:
SyntaxError: invalid syntax (&lt;string&gt;, line 1)</code></pre>
<h4 id="run-1-73">Run 1</h4>
<div class="sourceCode" id="cb807"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb807-1" title="1"><span class="im">import</span> sympy</a>
<a class="sourceLine" id="cb807-2" title="2"></a>
<a class="sourceLine" id="cb807-3" title="3"><span class="kw">def</span> sle(eqns):</a>
<a class="sourceLine" id="cb807-4" title="4">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb807-5" title="5"><span class="co">  This function solves a system of linear equations {[&#39;a_0x_0 + b_0x_1 = c0&#39;,&#39;a_1x_0 + b_1x_1 = c1&#39;]}.</span></a>
<a class="sourceLine" id="cb807-6" title="6"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb807-7" title="7">  x <span class="op">=</span> sympy.solve(eqns)</a>
<a class="sourceLine" id="cb807-8" title="8">  <span class="cf">return</span> x</a>
<a class="sourceLine" id="cb807-9" title="9"><span class="im">from</span> sympy <span class="im">import</span> solve, Eq</a>
<a class="sourceLine" id="cb807-10" title="10"><span class="im">from</span> sympy.parsing.sympy_parser <span class="im">import</span> parse_expr</a>
<a class="sourceLine" id="cb807-11" title="11"><span class="im">from</span> sympy.parsing.sympy_parser <span class="im">import</span> standard_transformations, implicit_multiplication_application</a>
<a class="sourceLine" id="cb807-12" title="12"></a>
<a class="sourceLine" id="cb807-13" title="13">eqns <span class="op">=</span> [<span class="st">&#39;4x + 3y = 20&#39;</span>, <span class="st">&#39;-5x + 9y = 26&#39;</span>]</a>
<a class="sourceLine" id="cb807-14" title="14">transformations <span class="op">=</span> (standard_transformations <span class="op">+</span></a>
<a class="sourceLine" id="cb807-15" title="15">                   (implicit_multiplication_application,))</a>
<a class="sourceLine" id="cb807-16" title="16">parsed_eqs <span class="op">=</span> []</a>
<a class="sourceLine" id="cb807-17" title="17"><span class="cf">for</span> eq <span class="kw">in</span> eqns:</a>
<a class="sourceLine" id="cb807-18" title="18">        sides <span class="op">=</span> [parse_expr(s, transformations<span class="op">=</span>transformations)</a>
<a class="sourceLine" id="cb807-19" title="19">                <span class="cf">for</span> s <span class="kw">in</span> eq.split(<span class="st">&#39;=&#39;</span>)]</a>
<a class="sourceLine" id="cb807-20" title="20">        parsed_eqs.append(Eq(sides[<span class="dv">0</span>], sides[<span class="dv">1</span>]))</a>
<a class="sourceLine" id="cb807-21" title="21">soln <span class="op">=</span> solve(parsed_eqs)</a>
<a class="sourceLine" id="cb807-22" title="22">test_sol_values <span class="op">=</span> [soln.get(<span class="bu">list</span>(soln.keys())[<span class="dv">0</span>]), soln.get(<span class="bu">list</span>(soln.keys())[<span class="dv">1</span>])]</a>
<a class="sourceLine" id="cb807-23" title="23"></a>
<a class="sourceLine" id="cb807-24" title="24">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> <span class="bu">list</span>(sle(eqns).values()) <span class="op">==</span> test_sol_values <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Sympify of expression &#39;could not parse &#39;4x + 3y = 20&#39;&#39; failed, because of exception being raised:
SyntaxError: invalid syntax (&lt;string&gt;, line 1)</code></pre>
<h4 id="run-2-73">Run 2</h4>
<div class="sourceCode" id="cb809"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb809-1" title="1"><span class="im">import</span> sympy</a>
<a class="sourceLine" id="cb809-2" title="2"></a>
<a class="sourceLine" id="cb809-3" title="3"><span class="kw">def</span> sle(eqns):</a>
<a class="sourceLine" id="cb809-4" title="4">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb809-5" title="5"><span class="co">  This function solves a system of linear equations {[&#39;a_0x_0 + b_0x_1 = c0&#39;,&#39;a_1x_0 + b_1x_1 = c1&#39;]}.</span></a>
<a class="sourceLine" id="cb809-6" title="6"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb809-7" title="7">  x <span class="op">=</span> sympy.solve(eqns)</a>
<a class="sourceLine" id="cb809-8" title="8">  <span class="cf">return</span> x</a>
<a class="sourceLine" id="cb809-9" title="9"><span class="im">from</span> sympy <span class="im">import</span> solve, Eq</a>
<a class="sourceLine" id="cb809-10" title="10"><span class="im">from</span> sympy.parsing.sympy_parser <span class="im">import</span> parse_expr</a>
<a class="sourceLine" id="cb809-11" title="11"><span class="im">from</span> sympy.parsing.sympy_parser <span class="im">import</span> standard_transformations, implicit_multiplication_application</a>
<a class="sourceLine" id="cb809-12" title="12"></a>
<a class="sourceLine" id="cb809-13" title="13">eqns <span class="op">=</span> [<span class="st">&#39;4x + 3y = 20&#39;</span>, <span class="st">&#39;-5x + 9y = 26&#39;</span>]</a>
<a class="sourceLine" id="cb809-14" title="14">transformations <span class="op">=</span> (standard_transformations <span class="op">+</span></a>
<a class="sourceLine" id="cb809-15" title="15">                   (implicit_multiplication_application,))</a>
<a class="sourceLine" id="cb809-16" title="16">parsed_eqs <span class="op">=</span> []</a>
<a class="sourceLine" id="cb809-17" title="17"><span class="cf">for</span> eq <span class="kw">in</span> eqns:</a>
<a class="sourceLine" id="cb809-18" title="18">        sides <span class="op">=</span> [parse_expr(s, transformations<span class="op">=</span>transformations)</a>
<a class="sourceLine" id="cb809-19" title="19">                <span class="cf">for</span> s <span class="kw">in</span> eq.split(<span class="st">&#39;=&#39;</span>)]</a>
<a class="sourceLine" id="cb809-20" title="20">        parsed_eqs.append(Eq(sides[<span class="dv">0</span>], sides[<span class="dv">1</span>]))</a>
<a class="sourceLine" id="cb809-21" title="21">soln <span class="op">=</span> solve(parsed_eqs)</a>
<a class="sourceLine" id="cb809-22" title="22">test_sol_values <span class="op">=</span> [soln.get(<span class="bu">list</span>(soln.keys())[<span class="dv">0</span>]), soln.get(<span class="bu">list</span>(soln.keys())[<span class="dv">1</span>])]</a>
<a class="sourceLine" id="cb809-23" title="23"></a>
<a class="sourceLine" id="cb809-24" title="24">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> <span class="bu">list</span>(sle(eqns).values()) <span class="op">==</span> test_sol_values <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Sympify of expression &#39;could not parse &#39;4x + 3y = 20&#39;&#39; failed, because of exception being raised:
SyntaxError: invalid syntax (&lt;string&gt;, line 1)</code></pre>
<h4 id="run-3-73">Run 3</h4>
<div class="sourceCode" id="cb811"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb811-1" title="1"><span class="im">import</span> sympy</a>
<a class="sourceLine" id="cb811-2" title="2"></a>
<a class="sourceLine" id="cb811-3" title="3"><span class="kw">def</span> sle(eqns):</a>
<a class="sourceLine" id="cb811-4" title="4">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb811-5" title="5"><span class="co">  This function solves a system of linear equations {[&#39;a_0x_0 + b_0x_1 = c0&#39;,&#39;a_1x_0 + b_1x_1 = c1&#39;]}.</span></a>
<a class="sourceLine" id="cb811-6" title="6"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb811-7" title="7">  x <span class="op">=</span> sympy.solve(eqns)</a>
<a class="sourceLine" id="cb811-8" title="8">  <span class="cf">return</span> x</a>
<a class="sourceLine" id="cb811-9" title="9"><span class="im">from</span> sympy <span class="im">import</span> solve, Eq</a>
<a class="sourceLine" id="cb811-10" title="10"><span class="im">from</span> sympy.parsing.sympy_parser <span class="im">import</span> parse_expr</a>
<a class="sourceLine" id="cb811-11" title="11"><span class="im">from</span> sympy.parsing.sympy_parser <span class="im">import</span> standard_transformations, implicit_multiplication_application</a>
<a class="sourceLine" id="cb811-12" title="12"></a>
<a class="sourceLine" id="cb811-13" title="13">eqns <span class="op">=</span> [<span class="st">&#39;4x + 3y = 20&#39;</span>, <span class="st">&#39;-5x + 9y = 26&#39;</span>]</a>
<a class="sourceLine" id="cb811-14" title="14">transformations <span class="op">=</span> (standard_transformations <span class="op">+</span></a>
<a class="sourceLine" id="cb811-15" title="15">                   (implicit_multiplication_application,))</a>
<a class="sourceLine" id="cb811-16" title="16">parsed_eqs <span class="op">=</span> []</a>
<a class="sourceLine" id="cb811-17" title="17"><span class="cf">for</span> eq <span class="kw">in</span> eqns:</a>
<a class="sourceLine" id="cb811-18" title="18">        sides <span class="op">=</span> [parse_expr(s, transformations<span class="op">=</span>transformations)</a>
<a class="sourceLine" id="cb811-19" title="19">                <span class="cf">for</span> s <span class="kw">in</span> eq.split(<span class="st">&#39;=&#39;</span>)]</a>
<a class="sourceLine" id="cb811-20" title="20">        parsed_eqs.append(Eq(sides[<span class="dv">0</span>], sides[<span class="dv">1</span>]))</a>
<a class="sourceLine" id="cb811-21" title="21">soln <span class="op">=</span> solve(parsed_eqs)</a>
<a class="sourceLine" id="cb811-22" title="22">test_sol_values <span class="op">=</span> [soln.get(<span class="bu">list</span>(soln.keys())[<span class="dv">0</span>]), soln.get(<span class="bu">list</span>(soln.keys())[<span class="dv">1</span>])]</a>
<a class="sourceLine" id="cb811-23" title="23"></a>
<a class="sourceLine" id="cb811-24" title="24">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> <span class="bu">list</span>(sle(eqns).values()) <span class="op">==</span> test_sol_values <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Sympify of expression &#39;could not parse &#39;4x + 3y = 20&#39;&#39; failed, because of exception being raised:
SyntaxError: invalid syntax (&lt;string&gt;, line 1)</code></pre>
<h4 id="run-4-73">Run 4</h4>
<div class="sourceCode" id="cb813"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb813-1" title="1"><span class="im">import</span> sympy</a>
<a class="sourceLine" id="cb813-2" title="2"></a>
<a class="sourceLine" id="cb813-3" title="3"><span class="kw">def</span> sle(eqns):</a>
<a class="sourceLine" id="cb813-4" title="4">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb813-5" title="5"><span class="co">  This function solves a system of linear equations {[&#39;a_0x_0 + b_0x_1 = c0&#39;,&#39;a_1x_0 + b_1x_1 = c1&#39;]}.</span></a>
<a class="sourceLine" id="cb813-6" title="6"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb813-7" title="7">  x <span class="op">=</span> sympy.solve(eqns)</a>
<a class="sourceLine" id="cb813-8" title="8">  <span class="cf">return</span> x</a>
<a class="sourceLine" id="cb813-9" title="9"><span class="im">from</span> sympy <span class="im">import</span> solve, Eq</a>
<a class="sourceLine" id="cb813-10" title="10"><span class="im">from</span> sympy.parsing.sympy_parser <span class="im">import</span> parse_expr</a>
<a class="sourceLine" id="cb813-11" title="11"><span class="im">from</span> sympy.parsing.sympy_parser <span class="im">import</span> standard_transformations, implicit_multiplication_application</a>
<a class="sourceLine" id="cb813-12" title="12"></a>
<a class="sourceLine" id="cb813-13" title="13">eqns <span class="op">=</span> [<span class="st">&#39;4x + 3y = 20&#39;</span>, <span class="st">&#39;-5x + 9y = 26&#39;</span>]</a>
<a class="sourceLine" id="cb813-14" title="14">transformations <span class="op">=</span> (standard_transformations <span class="op">+</span></a>
<a class="sourceLine" id="cb813-15" title="15">                   (implicit_multiplication_application,))</a>
<a class="sourceLine" id="cb813-16" title="16">parsed_eqs <span class="op">=</span> []</a>
<a class="sourceLine" id="cb813-17" title="17"><span class="cf">for</span> eq <span class="kw">in</span> eqns:</a>
<a class="sourceLine" id="cb813-18" title="18">        sides <span class="op">=</span> [parse_expr(s, transformations<span class="op">=</span>transformations)</a>
<a class="sourceLine" id="cb813-19" title="19">                <span class="cf">for</span> s <span class="kw">in</span> eq.split(<span class="st">&#39;=&#39;</span>)]</a>
<a class="sourceLine" id="cb813-20" title="20">        parsed_eqs.append(Eq(sides[<span class="dv">0</span>], sides[<span class="dv">1</span>]))</a>
<a class="sourceLine" id="cb813-21" title="21">soln <span class="op">=</span> solve(parsed_eqs)</a>
<a class="sourceLine" id="cb813-22" title="22">test_sol_values <span class="op">=</span> [soln.get(<span class="bu">list</span>(soln.keys())[<span class="dv">0</span>]), soln.get(<span class="bu">list</span>(soln.keys())[<span class="dv">1</span>])]</a>
<a class="sourceLine" id="cb813-23" title="23"></a>
<a class="sourceLine" id="cb813-24" title="24">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> <span class="bu">list</span>(sle(eqns).values()) <span class="op">==</span> test_sol_values <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Sympify of expression &#39;could not parse &#39;4x + 3y = 20&#39;&#39; failed, because of exception being raised:
SyntaxError: invalid syntax (&lt;string&gt;, line 1)</code></pre>
</details>
<details>
<p><summary>spectral_r</summary></p>
<h4 id="query-74">Query</h4>
<div class="sourceCode" id="cb815"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb815-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb815-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb815-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb815-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb815-5" title="5"></a>
<a class="sourceLine" id="cb815-6" title="6"><span class="kw">def</span> spectral_r(a):</a>
<a class="sourceLine" id="cb815-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb815-8" title="8"><span class="co">  This function calculates the spectral radius of the input square matrix a.</span></a>
<a class="sourceLine" id="cb815-9" title="9"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb815-10" title="10">  [insert]</a>
<a class="sourceLine" id="cb815-11" title="11">  <span class="cf">return</span> sradius</a></code></pre></div>
<h4 id="run-0-74">Run 0</h4>
<div class="sourceCode" id="cb816"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb816-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb816-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb816-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb816-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb816-5" title="5"></a>
<a class="sourceLine" id="cb816-6" title="6"><span class="kw">def</span> spectral_r(a):</a>
<a class="sourceLine" id="cb816-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb816-8" title="8"><span class="co">  This function calculates the spectral radius of the input square matrix a.</span></a>
<a class="sourceLine" id="cb816-9" title="9"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb816-10" title="10">  eigval <span class="op">=</span> np.linalg.eigvals(a)</a>
<a class="sourceLine" id="cb816-11" title="11">  sradius <span class="op">=</span> np.<span class="bu">max</span>(np.<span class="bu">abs</span>(eigval))</a>
<a class="sourceLine" id="cb816-12" title="12">  <span class="cf">return</span> sradius</a>
<a class="sourceLine" id="cb816-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb816-14" title="14"></a>
<a class="sourceLine" id="cb816-15" title="15">np.random.seed(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb816-16" title="16">M <span class="op">=</span> <span class="dv">100</span></a>
<a class="sourceLine" id="cb816-17" title="17">a <span class="op">=</span> np.random.normal(loc<span class="op">=</span><span class="dv">10</span>, scale<span class="op">=</span><span class="dv">3</span>, size<span class="op">=</span>(M,M))</a>
<a class="sourceLine" id="cb816-18" title="18">eig <span class="op">=</span> np.linalg.eigvals(a)</a>
<a class="sourceLine" id="cb816-19" title="19">s_r <span class="op">=</span> np.amax(np.absolute(eig))</a>
<a class="sourceLine" id="cb816-20" title="20"></a>
<a class="sourceLine" id="cb816-21" title="21">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(spectral_r(a), s_r) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-74">Run 1</h4>
<div class="sourceCode" id="cb818"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb818-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb818-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb818-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb818-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb818-5" title="5"></a>
<a class="sourceLine" id="cb818-6" title="6"><span class="kw">def</span> spectral_r(a):</a>
<a class="sourceLine" id="cb818-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb818-8" title="8"><span class="co">  This function calculates the spectral radius of the input square matrix a.</span></a>
<a class="sourceLine" id="cb818-9" title="9"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb818-10" title="10">  eigval <span class="op">=</span> np.linalg.eigvals(a)</a>
<a class="sourceLine" id="cb818-11" title="11">  sradius <span class="op">=</span> np.<span class="bu">max</span>(np.<span class="bu">abs</span>(eigval))</a>
<a class="sourceLine" id="cb818-12" title="12">  <span class="cf">return</span> sradius</a>
<a class="sourceLine" id="cb818-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb818-14" title="14"></a>
<a class="sourceLine" id="cb818-15" title="15">np.random.seed(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb818-16" title="16">M <span class="op">=</span> <span class="dv">100</span></a>
<a class="sourceLine" id="cb818-17" title="17">a <span class="op">=</span> np.random.normal(loc<span class="op">=</span><span class="dv">10</span>, scale<span class="op">=</span><span class="dv">3</span>, size<span class="op">=</span>(M,M))</a>
<a class="sourceLine" id="cb818-18" title="18">eig <span class="op">=</span> np.linalg.eigvals(a)</a>
<a class="sourceLine" id="cb818-19" title="19">s_r <span class="op">=</span> np.amax(np.absolute(eig))</a>
<a class="sourceLine" id="cb818-20" title="20"></a>
<a class="sourceLine" id="cb818-21" title="21">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(spectral_r(a), s_r) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-74">Run 2</h4>
<div class="sourceCode" id="cb820"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb820-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb820-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb820-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb820-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb820-5" title="5"></a>
<a class="sourceLine" id="cb820-6" title="6"><span class="kw">def</span> spectral_r(a):</a>
<a class="sourceLine" id="cb820-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb820-8" title="8"><span class="co">  This function calculates the spectral radius of the input square matrix a.</span></a>
<a class="sourceLine" id="cb820-9" title="9"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb820-10" title="10">  eigvals <span class="op">=</span> np.linalg.eigvals(a)</a>
<a class="sourceLine" id="cb820-11" title="11">  sradius <span class="op">=</span> np.<span class="bu">max</span>(np.<span class="bu">abs</span>(eigvals))</a>
<a class="sourceLine" id="cb820-12" title="12">  <span class="cf">return</span> sradius</a>
<a class="sourceLine" id="cb820-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb820-14" title="14"></a>
<a class="sourceLine" id="cb820-15" title="15">np.random.seed(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb820-16" title="16">M <span class="op">=</span> <span class="dv">100</span></a>
<a class="sourceLine" id="cb820-17" title="17">a <span class="op">=</span> np.random.normal(loc<span class="op">=</span><span class="dv">10</span>, scale<span class="op">=</span><span class="dv">3</span>, size<span class="op">=</span>(M,M))</a>
<a class="sourceLine" id="cb820-18" title="18">eig <span class="op">=</span> np.linalg.eigvals(a)</a>
<a class="sourceLine" id="cb820-19" title="19">s_r <span class="op">=</span> np.amax(np.absolute(eig))</a>
<a class="sourceLine" id="cb820-20" title="20"></a>
<a class="sourceLine" id="cb820-21" title="21">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(spectral_r(a), s_r) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-74">Run 3</h4>
<div class="sourceCode" id="cb822"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb822-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb822-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb822-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb822-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb822-5" title="5"></a>
<a class="sourceLine" id="cb822-6" title="6"><span class="kw">def</span> spectral_r(a):</a>
<a class="sourceLine" id="cb822-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb822-8" title="8"><span class="co">  This function calculates the spectral radius of the input square matrix a.</span></a>
<a class="sourceLine" id="cb822-9" title="9"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb822-10" title="10">  eigvals <span class="op">=</span> np.linalg.eigvals(a)</a>
<a class="sourceLine" id="cb822-11" title="11">  sradius <span class="op">=</span> np.<span class="bu">max</span>(np.<span class="bu">abs</span>(eigvals))</a>
<a class="sourceLine" id="cb822-12" title="12">  <span class="cf">return</span> sradius</a>
<a class="sourceLine" id="cb822-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb822-14" title="14"></a>
<a class="sourceLine" id="cb822-15" title="15">np.random.seed(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb822-16" title="16">M <span class="op">=</span> <span class="dv">100</span></a>
<a class="sourceLine" id="cb822-17" title="17">a <span class="op">=</span> np.random.normal(loc<span class="op">=</span><span class="dv">10</span>, scale<span class="op">=</span><span class="dv">3</span>, size<span class="op">=</span>(M,M))</a>
<a class="sourceLine" id="cb822-18" title="18">eig <span class="op">=</span> np.linalg.eigvals(a)</a>
<a class="sourceLine" id="cb822-19" title="19">s_r <span class="op">=</span> np.amax(np.absolute(eig))</a>
<a class="sourceLine" id="cb822-20" title="20"></a>
<a class="sourceLine" id="cb822-21" title="21">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(spectral_r(a), s_r) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-74">Run 4</h4>
<div class="sourceCode" id="cb824"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb824-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb824-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb824-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb824-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb824-5" title="5"></a>
<a class="sourceLine" id="cb824-6" title="6"><span class="kw">def</span> spectral_r(a):</a>
<a class="sourceLine" id="cb824-7" title="7">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb824-8" title="8"><span class="co">  This function calculates the spectral radius of the input square matrix a.</span></a>
<a class="sourceLine" id="cb824-9" title="9"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb824-10" title="10">  eigval <span class="op">=</span> np.linalg.eigvals(a)</a>
<a class="sourceLine" id="cb824-11" title="11">  sradius <span class="op">=</span> np.<span class="bu">max</span>(np.<span class="bu">abs</span>(eigval))</a>
<a class="sourceLine" id="cb824-12" title="12">  <span class="cf">return</span> sradius</a>
<a class="sourceLine" id="cb824-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb824-14" title="14"></a>
<a class="sourceLine" id="cb824-15" title="15">np.random.seed(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb824-16" title="16">M <span class="op">=</span> <span class="dv">100</span></a>
<a class="sourceLine" id="cb824-17" title="17">a <span class="op">=</span> np.random.normal(loc<span class="op">=</span><span class="dv">10</span>, scale<span class="op">=</span><span class="dv">3</span>, size<span class="op">=</span>(M,M))</a>
<a class="sourceLine" id="cb824-18" title="18">eig <span class="op">=</span> np.linalg.eigvals(a)</a>
<a class="sourceLine" id="cb824-19" title="19">s_r <span class="op">=</span> np.amax(np.absolute(eig))</a>
<a class="sourceLine" id="cb824-20" title="20"></a>
<a class="sourceLine" id="cb824-21" title="21">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(spectral_r(a), s_r) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>find_peaks</summary></p>
<h4 id="query-75">Query</h4>
<div class="sourceCode" id="cb826"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb826-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb826-2" title="2"><span class="im">import</span> scipy</a>
<a class="sourceLine" id="cb826-3" title="3"></a>
<a class="sourceLine" id="cb826-4" title="4"><span class="im">import</span> scipy.optimize</a>
<a class="sourceLine" id="cb826-5" title="5"><span class="im">import</span> scipy.signal</a>
<a class="sourceLine" id="cb826-6" title="6"></a>
<a class="sourceLine" id="cb826-7" title="7"><span class="kw">def</span> find_peaks(abs_spectrum, npeaks<span class="op">=</span><span class="dv">3</span>):</a>
<a class="sourceLine" id="cb826-8" title="8">    <span class="co">&#39;&#39;&#39; This will find the highest `npeaks` peaks and return a list of peak wavenumbers.</span></a>
<a class="sourceLine" id="cb826-9" title="9"><span class="co">    `abs_spectrum` should be shape (N, 2)</span></a>
<a class="sourceLine" id="cb826-10" title="10"><span class="co">    &#39;&#39;&#39;</span></a>
<a class="sourceLine" id="cb826-11" title="11">    [insert]</a>
<a class="sourceLine" id="cb826-12" title="12">    <span class="cf">return</span> wavenumbers</a></code></pre></div>
<h4 id="run-0-75">Run 0</h4>
<div class="sourceCode" id="cb827"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb827-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb827-2" title="2"><span class="im">import</span> scipy</a>
<a class="sourceLine" id="cb827-3" title="3"></a>
<a class="sourceLine" id="cb827-4" title="4"><span class="im">import</span> scipy.optimize</a>
<a class="sourceLine" id="cb827-5" title="5"><span class="im">import</span> scipy.signal</a>
<a class="sourceLine" id="cb827-6" title="6"></a>
<a class="sourceLine" id="cb827-7" title="7"><span class="kw">def</span> find_peaks(abs_spectrum, npeaks<span class="op">=</span><span class="dv">3</span>):</a>
<a class="sourceLine" id="cb827-8" title="8">    <span class="co">&#39;&#39;&#39; This will find the highest `npeaks` peaks and return a list of peak wavenumbers.</span></a>
<a class="sourceLine" id="cb827-9" title="9"><span class="co">    `abs_spectrum` should be shape (N, 2)</span></a>
<a class="sourceLine" id="cb827-10" title="10"><span class="co">    &#39;&#39;&#39;</span></a>
<a class="sourceLine" id="cb827-11" title="11">    peaks, _ <span class="op">=</span> scipy.signal.find_peaks(abs_spectrum[:,<span class="dv">1</span>], height<span class="op">=</span><span class="fl">0.1</span>)</a>
<a class="sourceLine" id="cb827-12" title="12">    peaks <span class="op">=</span> peaks[np.argsort(abs_spectrum[peaks,<span class="dv">1</span>])[::<span class="op">-</span><span class="dv">1</span>]]</a>
<a class="sourceLine" id="cb827-13" title="13">    wavenumbers <span class="op">=</span> abs_spectrum[peaks,<span class="dv">0</span>][:npeaks]</a>
<a class="sourceLine" id="cb827-14" title="14">    <span class="cf">return</span> wavenumbers</a>
<a class="sourceLine" id="cb827-15" title="15">s <span class="op">=</span> np.loadtxt(</a>
<a class="sourceLine" id="cb827-16" title="16">    <span class="st">&#39;https://raw.githubusercontent.com/whitead/numerical_stats/master/unit_12/lectures/spectrum.txt&#39;</span>)</a>
<a class="sourceLine" id="cb827-17" title="17"><span class="co"># clean up to be like an absorption spectrum</span></a>
<a class="sourceLine" id="cb827-18" title="18">s[:, <span class="dv">1</span>] <span class="op">/=</span> np.<span class="bu">max</span>(s[:, <span class="dv">1</span>])</a>
<a class="sourceLine" id="cb827-19" title="19">ints <span class="op">=</span> np.array(find_peaks(s, <span class="dv">4</span>))</a>
<a class="sourceLine" id="cb827-20" title="20"></a>
<a class="sourceLine" id="cb827-21" title="21">true <span class="op">=</span> [<span class="dv">609</span>, <span class="dv">645</span>, <span class="dv">670</span>]</a>
<a class="sourceLine" id="cb827-22" title="22"></a>
<a class="sourceLine" id="cb827-23" title="23">result <span class="op">=</span> <span class="bu">len</span>(ints) <span class="op">==</span> <span class="dv">4</span></a>
<a class="sourceLine" id="cb827-24" title="24"><span class="cf">for</span> t <span class="kw">in</span> true:</a>
<a class="sourceLine" id="cb827-25" title="25">    result <span class="op">=</span> result <span class="kw">and</span> np.<span class="bu">any</span>(np.<span class="bu">abs</span>(ints <span class="op">-</span> t) <span class="op">&lt;</span> <span class="dv">5</span>)</a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-75">Run 1</h4>
<div class="sourceCode" id="cb829"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb829-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb829-2" title="2"><span class="im">import</span> scipy</a>
<a class="sourceLine" id="cb829-3" title="3"></a>
<a class="sourceLine" id="cb829-4" title="4"><span class="im">import</span> scipy.optimize</a>
<a class="sourceLine" id="cb829-5" title="5"><span class="im">import</span> scipy.signal</a>
<a class="sourceLine" id="cb829-6" title="6"></a>
<a class="sourceLine" id="cb829-7" title="7"><span class="kw">def</span> find_peaks(abs_spectrum, npeaks<span class="op">=</span><span class="dv">3</span>):</a>
<a class="sourceLine" id="cb829-8" title="8">    <span class="co">&#39;&#39;&#39; This will find the highest `npeaks` peaks and return a list of peak wavenumbers.</span></a>
<a class="sourceLine" id="cb829-9" title="9"><span class="co">    `abs_spectrum` should be shape (N, 2)</span></a>
<a class="sourceLine" id="cb829-10" title="10"><span class="co">    &#39;&#39;&#39;</span></a>
<a class="sourceLine" id="cb829-11" title="11">    peaks, _ <span class="op">=</span> scipy.signal.find_peaks(abs_spectrum[:,<span class="dv">1</span>], height<span class="op">=</span><span class="fl">0.1</span>)</a>
<a class="sourceLine" id="cb829-12" title="12">    peaks <span class="op">=</span> peaks[np.argsort(abs_spectrum[peaks,<span class="dv">1</span>])][::<span class="op">-</span><span class="dv">1</span>]</a>
<a class="sourceLine" id="cb829-13" title="13">    wavenumbers <span class="op">=</span> abs_spectrum[peaks,<span class="dv">0</span>][:npeaks]</a>
<a class="sourceLine" id="cb829-14" title="14">    <span class="cf">return</span> wavenumbers</a>
<a class="sourceLine" id="cb829-15" title="15">s <span class="op">=</span> np.loadtxt(</a>
<a class="sourceLine" id="cb829-16" title="16">    <span class="st">&#39;https://raw.githubusercontent.com/whitead/numerical_stats/master/unit_12/lectures/spectrum.txt&#39;</span>)</a>
<a class="sourceLine" id="cb829-17" title="17"><span class="co"># clean up to be like an absorption spectrum</span></a>
<a class="sourceLine" id="cb829-18" title="18">s[:, <span class="dv">1</span>] <span class="op">/=</span> np.<span class="bu">max</span>(s[:, <span class="dv">1</span>])</a>
<a class="sourceLine" id="cb829-19" title="19">ints <span class="op">=</span> np.array(find_peaks(s, <span class="dv">4</span>))</a>
<a class="sourceLine" id="cb829-20" title="20"></a>
<a class="sourceLine" id="cb829-21" title="21">true <span class="op">=</span> [<span class="dv">609</span>, <span class="dv">645</span>, <span class="dv">670</span>]</a>
<a class="sourceLine" id="cb829-22" title="22"></a>
<a class="sourceLine" id="cb829-23" title="23">result <span class="op">=</span> <span class="bu">len</span>(ints) <span class="op">==</span> <span class="dv">4</span></a>
<a class="sourceLine" id="cb829-24" title="24"><span class="cf">for</span> t <span class="kw">in</span> true:</a>
<a class="sourceLine" id="cb829-25" title="25">    result <span class="op">=</span> result <span class="kw">and</span> np.<span class="bu">any</span>(np.<span class="bu">abs</span>(ints <span class="op">-</span> t) <span class="op">&lt;</span> <span class="dv">5</span>)</a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-75">Run 2</h4>
<div class="sourceCode" id="cb831"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb831-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb831-2" title="2"><span class="im">import</span> scipy</a>
<a class="sourceLine" id="cb831-3" title="3"></a>
<a class="sourceLine" id="cb831-4" title="4"><span class="im">import</span> scipy.optimize</a>
<a class="sourceLine" id="cb831-5" title="5"><span class="im">import</span> scipy.signal</a>
<a class="sourceLine" id="cb831-6" title="6"></a>
<a class="sourceLine" id="cb831-7" title="7"><span class="kw">def</span> find_peaks(abs_spectrum, npeaks<span class="op">=</span><span class="dv">3</span>):</a>
<a class="sourceLine" id="cb831-8" title="8">    <span class="co">&#39;&#39;&#39; This will find the highest `npeaks` peaks and return a list of peak wavenumbers.</span></a>
<a class="sourceLine" id="cb831-9" title="9"><span class="co">    `abs_spectrum` should be shape (N, 2)</span></a>
<a class="sourceLine" id="cb831-10" title="10"><span class="co">    &#39;&#39;&#39;</span></a>
<a class="sourceLine" id="cb831-11" title="11">    peaks, _ <span class="op">=</span> scipy.signal.find_peaks(abs_spectrum[:, <span class="dv">1</span>], distance<span class="op">=</span><span class="dv">10</span>)</a>
<a class="sourceLine" id="cb831-12" title="12">    peaks <span class="op">=</span> peaks[np.argsort(abs_spectrum[peaks, <span class="dv">1</span>])][::<span class="op">-</span><span class="dv">1</span>][:npeaks]</a>
<a class="sourceLine" id="cb831-13" title="13">    wavenumbers <span class="op">=</span> abs_spectrum[peaks, <span class="dv">0</span>]</a>
<a class="sourceLine" id="cb831-14" title="14">    <span class="cf">return</span> wavenumbers</a>
<a class="sourceLine" id="cb831-15" title="15">s <span class="op">=</span> np.loadtxt(</a>
<a class="sourceLine" id="cb831-16" title="16">    <span class="st">&#39;https://raw.githubusercontent.com/whitead/numerical_stats/master/unit_12/lectures/spectrum.txt&#39;</span>)</a>
<a class="sourceLine" id="cb831-17" title="17"><span class="co"># clean up to be like an absorption spectrum</span></a>
<a class="sourceLine" id="cb831-18" title="18">s[:, <span class="dv">1</span>] <span class="op">/=</span> np.<span class="bu">max</span>(s[:, <span class="dv">1</span>])</a>
<a class="sourceLine" id="cb831-19" title="19">ints <span class="op">=</span> np.array(find_peaks(s, <span class="dv">4</span>))</a>
<a class="sourceLine" id="cb831-20" title="20"></a>
<a class="sourceLine" id="cb831-21" title="21">true <span class="op">=</span> [<span class="dv">609</span>, <span class="dv">645</span>, <span class="dv">670</span>]</a>
<a class="sourceLine" id="cb831-22" title="22"></a>
<a class="sourceLine" id="cb831-23" title="23">result <span class="op">=</span> <span class="bu">len</span>(ints) <span class="op">==</span> <span class="dv">4</span></a>
<a class="sourceLine" id="cb831-24" title="24"><span class="cf">for</span> t <span class="kw">in</span> true:</a>
<a class="sourceLine" id="cb831-25" title="25">    result <span class="op">=</span> result <span class="kw">and</span> np.<span class="bu">any</span>(np.<span class="bu">abs</span>(ints <span class="op">-</span> t) <span class="op">&lt;</span> <span class="dv">5</span>)</a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-75">Run 3</h4>
<div class="sourceCode" id="cb833"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb833-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb833-2" title="2"><span class="im">import</span> scipy</a>
<a class="sourceLine" id="cb833-3" title="3"></a>
<a class="sourceLine" id="cb833-4" title="4"><span class="im">import</span> scipy.optimize</a>
<a class="sourceLine" id="cb833-5" title="5"><span class="im">import</span> scipy.signal</a>
<a class="sourceLine" id="cb833-6" title="6"></a>
<a class="sourceLine" id="cb833-7" title="7"><span class="kw">def</span> find_peaks(abs_spectrum, npeaks<span class="op">=</span><span class="dv">3</span>):</a>
<a class="sourceLine" id="cb833-8" title="8">    <span class="co">&#39;&#39;&#39; This will find the highest `npeaks` peaks and return a list of peak wavenumbers.</span></a>
<a class="sourceLine" id="cb833-9" title="9"><span class="co">    `abs_spectrum` should be shape (N, 2)</span></a>
<a class="sourceLine" id="cb833-10" title="10"><span class="co">    &#39;&#39;&#39;</span></a>
<a class="sourceLine" id="cb833-11" title="11">    wavenumbers <span class="op">=</span> np.zeros(npeaks)</a>
<a class="sourceLine" id="cb833-12" title="12">    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(npeaks):</a>
<a class="sourceLine" id="cb833-13" title="13">        peak_idx <span class="op">=</span> np.argmax(abs_spectrum[:, <span class="dv">1</span>])</a>
<a class="sourceLine" id="cb833-14" title="14">        wavenumbers[i] <span class="op">=</span> abs_spectrum[peak_idx, <span class="dv">0</span>]</a>
<a class="sourceLine" id="cb833-15" title="15">        abs_spectrum[peak_idx, <span class="dv">1</span>] <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb833-16" title="16"></a>
<a class="sourceLine" id="cb833-17" title="17">    <span class="cf">return</span> wavenumbers</a>
<a class="sourceLine" id="cb833-18" title="18">s <span class="op">=</span> np.loadtxt(</a>
<a class="sourceLine" id="cb833-19" title="19">    <span class="st">&#39;https://raw.githubusercontent.com/whitead/numerical_stats/master/unit_12/lectures/spectrum.txt&#39;</span>)</a>
<a class="sourceLine" id="cb833-20" title="20"><span class="co"># clean up to be like an absorption spectrum</span></a>
<a class="sourceLine" id="cb833-21" title="21">s[:, <span class="dv">1</span>] <span class="op">/=</span> np.<span class="bu">max</span>(s[:, <span class="dv">1</span>])</a>
<a class="sourceLine" id="cb833-22" title="22">ints <span class="op">=</span> np.array(find_peaks(s, <span class="dv">4</span>))</a>
<a class="sourceLine" id="cb833-23" title="23"></a>
<a class="sourceLine" id="cb833-24" title="24">true <span class="op">=</span> [<span class="dv">609</span>, <span class="dv">645</span>, <span class="dv">670</span>]</a>
<a class="sourceLine" id="cb833-25" title="25"></a>
<a class="sourceLine" id="cb833-26" title="26">result <span class="op">=</span> <span class="bu">len</span>(ints) <span class="op">==</span> <span class="dv">4</span></a>
<a class="sourceLine" id="cb833-27" title="27"><span class="cf">for</span> t <span class="kw">in</span> true:</a>
<a class="sourceLine" id="cb833-28" title="28">    result <span class="op">=</span> result <span class="kw">and</span> np.<span class="bu">any</span>(np.<span class="bu">abs</span>(ints <span class="op">-</span> t) <span class="op">&lt;</span> <span class="dv">5</span>)</a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-75">Run 4</h4>
<div class="sourceCode" id="cb835"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb835-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb835-2" title="2"><span class="im">import</span> scipy</a>
<a class="sourceLine" id="cb835-3" title="3"></a>
<a class="sourceLine" id="cb835-4" title="4"><span class="im">import</span> scipy.optimize</a>
<a class="sourceLine" id="cb835-5" title="5"><span class="im">import</span> scipy.signal</a>
<a class="sourceLine" id="cb835-6" title="6"></a>
<a class="sourceLine" id="cb835-7" title="7"><span class="kw">def</span> find_peaks(abs_spectrum, npeaks<span class="op">=</span><span class="dv">3</span>):</a>
<a class="sourceLine" id="cb835-8" title="8">    <span class="co">&#39;&#39;&#39; This will find the highest `npeaks` peaks and return a list of peak wavenumbers.</span></a>
<a class="sourceLine" id="cb835-9" title="9"><span class="co">    `abs_spectrum` should be shape (N, 2)</span></a>
<a class="sourceLine" id="cb835-10" title="10"><span class="co">    &#39;&#39;&#39;</span></a>
<a class="sourceLine" id="cb835-11" title="11">    wavenumbers <span class="op">=</span> []</a>
<a class="sourceLine" id="cb835-12" title="12">    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(npeaks):</a>
<a class="sourceLine" id="cb835-13" title="13">        max_index <span class="op">=</span> np.argmax(abs_spectrum[:, <span class="dv">1</span>])</a>
<a class="sourceLine" id="cb835-14" title="14">        wavenumbers.append(abs_spectrum[max_index, <span class="dv">0</span>])</a>
<a class="sourceLine" id="cb835-15" title="15">        abs_spectrum[max_index, <span class="dv">1</span>] <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb835-16" title="16">    <span class="cf">return</span> wavenumbers</a>
<a class="sourceLine" id="cb835-17" title="17">s <span class="op">=</span> np.loadtxt(</a>
<a class="sourceLine" id="cb835-18" title="18">    <span class="st">&#39;https://raw.githubusercontent.com/whitead/numerical_stats/master/unit_12/lectures/spectrum.txt&#39;</span>)</a>
<a class="sourceLine" id="cb835-19" title="19"><span class="co"># clean up to be like an absorption spectrum</span></a>
<a class="sourceLine" id="cb835-20" title="20">s[:, <span class="dv">1</span>] <span class="op">/=</span> np.<span class="bu">max</span>(s[:, <span class="dv">1</span>])</a>
<a class="sourceLine" id="cb835-21" title="21">ints <span class="op">=</span> np.array(find_peaks(s, <span class="dv">4</span>))</a>
<a class="sourceLine" id="cb835-22" title="22"></a>
<a class="sourceLine" id="cb835-23" title="23">true <span class="op">=</span> [<span class="dv">609</span>, <span class="dv">645</span>, <span class="dv">670</span>]</a>
<a class="sourceLine" id="cb835-24" title="24"></a>
<a class="sourceLine" id="cb835-25" title="25">result <span class="op">=</span> <span class="bu">len</span>(ints) <span class="op">==</span> <span class="dv">4</span></a>
<a class="sourceLine" id="cb835-26" title="26"><span class="cf">for</span> t <span class="kw">in</span> true:</a>
<a class="sourceLine" id="cb835-27" title="27">    result <span class="op">=</span> result <span class="kw">and</span> np.<span class="bu">any</span>(np.<span class="bu">abs</span>(ints <span class="op">-</span> t) <span class="op">&lt;</span> <span class="dv">5</span>)</a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>speed_of_sound</summary></p>
<h4 id="query-76">Query</h4>
<div class="sourceCode" id="cb837"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb837-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb837-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb837-3" title="3"></a>
<a class="sourceLine" id="cb837-4" title="4"><span class="kw">def</span> speed_of_sound(T,m,gamma):</a>
<a class="sourceLine" id="cb837-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb837-6" title="6"><span class="co">   This function returns the speed of sound for an ideal gas at temperature T</span></a>
<a class="sourceLine" id="cb837-7" title="7"><span class="co">   m is mass in g/mol</span></a>
<a class="sourceLine" id="cb837-8" title="8"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb837-9" title="9">   [insert]</a>
<a class="sourceLine" id="cb837-10" title="10">   <span class="cf">return</span> s</a>
<a class="sourceLine" id="cb837-11" title="11"></a></code></pre></div>
<h4 id="run-0-76">Run 0</h4>
<div class="sourceCode" id="cb838"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb838-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb838-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb838-3" title="3"></a>
<a class="sourceLine" id="cb838-4" title="4"><span class="kw">def</span> speed_of_sound(T,m,gamma):</a>
<a class="sourceLine" id="cb838-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb838-6" title="6"><span class="co">   This function returns the speed of sound for an ideal gas at temperature T</span></a>
<a class="sourceLine" id="cb838-7" title="7"><span class="co">   m is mass in g/mol</span></a>
<a class="sourceLine" id="cb838-8" title="8"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb838-9" title="9">   R <span class="op">=</span> <span class="fl">8.314</span> <span class="co">#J/mol/K</span></a>
<a class="sourceLine" id="cb838-10" title="10">   s <span class="op">=</span> math.sqrt(gamma<span class="op">*</span>R<span class="op">*</span>T<span class="op">/</span>m)</a>
<a class="sourceLine" id="cb838-11" title="11">   <span class="cf">return</span> s</a>
<a class="sourceLine" id="cb838-12" title="12"></a>
<a class="sourceLine" id="cb838-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb838-14" title="14"></a>
<a class="sourceLine" id="cb838-15" title="15">M<span class="op">=</span><span class="dv">28</span></a>
<a class="sourceLine" id="cb838-16" title="16">T<span class="op">=</span><span class="dv">300</span></a>
<a class="sourceLine" id="cb838-17" title="17">R<span class="op">=</span><span class="fl">8.314</span></a>
<a class="sourceLine" id="cb838-18" title="18">gamma<span class="op">=</span><span class="dv">7</span><span class="op">/</span><span class="dv">5</span></a>
<a class="sourceLine" id="cb838-19" title="19">s <span class="op">=</span> np.sqrt(gamma<span class="op">*</span>R<span class="op">*</span>T<span class="op">/</span>(M<span class="op">/</span><span class="dv">1000</span>))</a>
<a class="sourceLine" id="cb838-20" title="20"></a>
<a class="sourceLine" id="cb838-21" title="21">s_codex <span class="op">=</span> speed_of_sound(T,M,gamma)</a>
<a class="sourceLine" id="cb838-22" title="22"></a>
<a class="sourceLine" id="cb838-23" title="23"><span class="co"># check </span></a>
<a class="sourceLine" id="cb838-24" title="24"><span class="cf">if</span> np.isclose(s, s_codex, rtol<span class="op">=</span><span class="fl">0.01</span>) <span class="op">==</span> <span class="va">True</span>:</a>
<a class="sourceLine" id="cb838-25" title="25">    result <span class="op">=</span> <span class="va">True</span> </a>
<a class="sourceLine" id="cb838-26" title="26"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb838-27" title="27">    result <span class="op">=</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-76">Run 1</h4>
<div class="sourceCode" id="cb840"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb840-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb840-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb840-3" title="3"></a>
<a class="sourceLine" id="cb840-4" title="4"><span class="kw">def</span> speed_of_sound(T,m,gamma):</a>
<a class="sourceLine" id="cb840-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb840-6" title="6"><span class="co">   This function returns the speed of sound for an ideal gas at temperature T</span></a>
<a class="sourceLine" id="cb840-7" title="7"><span class="co">   m is mass in g/mol</span></a>
<a class="sourceLine" id="cb840-8" title="8"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb840-9" title="9">   R <span class="op">=</span> <span class="fl">8.314</span> <span class="co">#J/mol/K</span></a>
<a class="sourceLine" id="cb840-10" title="10">   s <span class="op">=</span> math.sqrt(gamma<span class="op">*</span>R<span class="op">*</span>T<span class="op">/</span>m)</a>
<a class="sourceLine" id="cb840-11" title="11">   <span class="cf">return</span> s</a>
<a class="sourceLine" id="cb840-12" title="12"></a>
<a class="sourceLine" id="cb840-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb840-14" title="14"></a>
<a class="sourceLine" id="cb840-15" title="15">M<span class="op">=</span><span class="dv">28</span></a>
<a class="sourceLine" id="cb840-16" title="16">T<span class="op">=</span><span class="dv">300</span></a>
<a class="sourceLine" id="cb840-17" title="17">R<span class="op">=</span><span class="fl">8.314</span></a>
<a class="sourceLine" id="cb840-18" title="18">gamma<span class="op">=</span><span class="dv">7</span><span class="op">/</span><span class="dv">5</span></a>
<a class="sourceLine" id="cb840-19" title="19">s <span class="op">=</span> np.sqrt(gamma<span class="op">*</span>R<span class="op">*</span>T<span class="op">/</span>(M<span class="op">/</span><span class="dv">1000</span>))</a>
<a class="sourceLine" id="cb840-20" title="20"></a>
<a class="sourceLine" id="cb840-21" title="21">s_codex <span class="op">=</span> speed_of_sound(T,M,gamma)</a>
<a class="sourceLine" id="cb840-22" title="22"></a>
<a class="sourceLine" id="cb840-23" title="23"><span class="co"># check </span></a>
<a class="sourceLine" id="cb840-24" title="24"><span class="cf">if</span> np.isclose(s, s_codex, rtol<span class="op">=</span><span class="fl">0.01</span>) <span class="op">==</span> <span class="va">True</span>:</a>
<a class="sourceLine" id="cb840-25" title="25">    result <span class="op">=</span> <span class="va">True</span> </a>
<a class="sourceLine" id="cb840-26" title="26"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb840-27" title="27">    result <span class="op">=</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-76">Run 2</h4>
<div class="sourceCode" id="cb842"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb842-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb842-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb842-3" title="3"></a>
<a class="sourceLine" id="cb842-4" title="4"><span class="kw">def</span> speed_of_sound(T,m,gamma):</a>
<a class="sourceLine" id="cb842-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb842-6" title="6"><span class="co">   This function returns the speed of sound for an ideal gas at temperature T</span></a>
<a class="sourceLine" id="cb842-7" title="7"><span class="co">   m is mass in g/mol</span></a>
<a class="sourceLine" id="cb842-8" title="8"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb842-9" title="9">   R <span class="op">=</span> <span class="fl">8.314</span></a>
<a class="sourceLine" id="cb842-10" title="10">   s <span class="op">=</span> math.sqrt((gamma<span class="op">*</span>R<span class="op">*</span>T)<span class="op">/</span>m)</a>
<a class="sourceLine" id="cb842-11" title="11">   <span class="cf">return</span> s</a>
<a class="sourceLine" id="cb842-12" title="12"></a>
<a class="sourceLine" id="cb842-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb842-14" title="14"></a>
<a class="sourceLine" id="cb842-15" title="15">M<span class="op">=</span><span class="dv">28</span></a>
<a class="sourceLine" id="cb842-16" title="16">T<span class="op">=</span><span class="dv">300</span></a>
<a class="sourceLine" id="cb842-17" title="17">R<span class="op">=</span><span class="fl">8.314</span></a>
<a class="sourceLine" id="cb842-18" title="18">gamma<span class="op">=</span><span class="dv">7</span><span class="op">/</span><span class="dv">5</span></a>
<a class="sourceLine" id="cb842-19" title="19">s <span class="op">=</span> np.sqrt(gamma<span class="op">*</span>R<span class="op">*</span>T<span class="op">/</span>(M<span class="op">/</span><span class="dv">1000</span>))</a>
<a class="sourceLine" id="cb842-20" title="20"></a>
<a class="sourceLine" id="cb842-21" title="21">s_codex <span class="op">=</span> speed_of_sound(T,M,gamma)</a>
<a class="sourceLine" id="cb842-22" title="22"></a>
<a class="sourceLine" id="cb842-23" title="23"><span class="co"># check </span></a>
<a class="sourceLine" id="cb842-24" title="24"><span class="cf">if</span> np.isclose(s, s_codex, rtol<span class="op">=</span><span class="fl">0.01</span>) <span class="op">==</span> <span class="va">True</span>:</a>
<a class="sourceLine" id="cb842-25" title="25">    result <span class="op">=</span> <span class="va">True</span> </a>
<a class="sourceLine" id="cb842-26" title="26"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb842-27" title="27">    result <span class="op">=</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-76">Run 3</h4>
<div class="sourceCode" id="cb844"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb844-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb844-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb844-3" title="3"></a>
<a class="sourceLine" id="cb844-4" title="4"><span class="kw">def</span> speed_of_sound(T,m,gamma):</a>
<a class="sourceLine" id="cb844-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb844-6" title="6"><span class="co">   This function returns the speed of sound for an ideal gas at temperature T</span></a>
<a class="sourceLine" id="cb844-7" title="7"><span class="co">   m is mass in g/mol</span></a>
<a class="sourceLine" id="cb844-8" title="8"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb844-9" title="9">   R <span class="op">=</span> <span class="fl">8.314</span> <span class="co">#J/mol/K</span></a>
<a class="sourceLine" id="cb844-10" title="10">   s <span class="op">=</span> math.sqrt(gamma<span class="op">*</span>R<span class="op">*</span>T<span class="op">/</span>m)</a>
<a class="sourceLine" id="cb844-11" title="11">   <span class="cf">return</span> s</a>
<a class="sourceLine" id="cb844-12" title="12"></a>
<a class="sourceLine" id="cb844-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb844-14" title="14"></a>
<a class="sourceLine" id="cb844-15" title="15">M<span class="op">=</span><span class="dv">28</span></a>
<a class="sourceLine" id="cb844-16" title="16">T<span class="op">=</span><span class="dv">300</span></a>
<a class="sourceLine" id="cb844-17" title="17">R<span class="op">=</span><span class="fl">8.314</span></a>
<a class="sourceLine" id="cb844-18" title="18">gamma<span class="op">=</span><span class="dv">7</span><span class="op">/</span><span class="dv">5</span></a>
<a class="sourceLine" id="cb844-19" title="19">s <span class="op">=</span> np.sqrt(gamma<span class="op">*</span>R<span class="op">*</span>T<span class="op">/</span>(M<span class="op">/</span><span class="dv">1000</span>))</a>
<a class="sourceLine" id="cb844-20" title="20"></a>
<a class="sourceLine" id="cb844-21" title="21">s_codex <span class="op">=</span> speed_of_sound(T,M,gamma)</a>
<a class="sourceLine" id="cb844-22" title="22"></a>
<a class="sourceLine" id="cb844-23" title="23"><span class="co"># check </span></a>
<a class="sourceLine" id="cb844-24" title="24"><span class="cf">if</span> np.isclose(s, s_codex, rtol<span class="op">=</span><span class="fl">0.01</span>) <span class="op">==</span> <span class="va">True</span>:</a>
<a class="sourceLine" id="cb844-25" title="25">    result <span class="op">=</span> <span class="va">True</span> </a>
<a class="sourceLine" id="cb844-26" title="26"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb844-27" title="27">    result <span class="op">=</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-76">Run 4</h4>
<div class="sourceCode" id="cb846"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb846-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb846-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb846-3" title="3"></a>
<a class="sourceLine" id="cb846-4" title="4"><span class="kw">def</span> speed_of_sound(T,m,gamma):</a>
<a class="sourceLine" id="cb846-5" title="5">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb846-6" title="6"><span class="co">   This function returns the speed of sound for an ideal gas at temperature T</span></a>
<a class="sourceLine" id="cb846-7" title="7"><span class="co">   m is mass in g/mol</span></a>
<a class="sourceLine" id="cb846-8" title="8"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb846-9" title="9">   R <span class="op">=</span> <span class="fl">8.314</span></a>
<a class="sourceLine" id="cb846-10" title="10">   s <span class="op">=</span> math.sqrt(gamma<span class="op">*</span>R<span class="op">*</span>T<span class="op">/</span>m)</a>
<a class="sourceLine" id="cb846-11" title="11">   <span class="cf">return</span> s</a>
<a class="sourceLine" id="cb846-12" title="12"></a>
<a class="sourceLine" id="cb846-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb846-14" title="14"></a>
<a class="sourceLine" id="cb846-15" title="15">M<span class="op">=</span><span class="dv">28</span></a>
<a class="sourceLine" id="cb846-16" title="16">T<span class="op">=</span><span class="dv">300</span></a>
<a class="sourceLine" id="cb846-17" title="17">R<span class="op">=</span><span class="fl">8.314</span></a>
<a class="sourceLine" id="cb846-18" title="18">gamma<span class="op">=</span><span class="dv">7</span><span class="op">/</span><span class="dv">5</span></a>
<a class="sourceLine" id="cb846-19" title="19">s <span class="op">=</span> np.sqrt(gamma<span class="op">*</span>R<span class="op">*</span>T<span class="op">/</span>(M<span class="op">/</span><span class="dv">1000</span>))</a>
<a class="sourceLine" id="cb846-20" title="20"></a>
<a class="sourceLine" id="cb846-21" title="21">s_codex <span class="op">=</span> speed_of_sound(T,M,gamma)</a>
<a class="sourceLine" id="cb846-22" title="22"></a>
<a class="sourceLine" id="cb846-23" title="23"><span class="co"># check </span></a>
<a class="sourceLine" id="cb846-24" title="24"><span class="cf">if</span> np.isclose(s, s_codex, rtol<span class="op">=</span><span class="fl">0.01</span>) <span class="op">==</span> <span class="va">True</span>:</a>
<a class="sourceLine" id="cb846-25" title="25">    result <span class="op">=</span> <span class="va">True</span> </a>
<a class="sourceLine" id="cb846-26" title="26"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb846-27" title="27">    result <span class="op">=</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>substructure</summary></p>
<h4 id="query-77">Query</h4>
<div class="sourceCode" id="cb848"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb848-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb848-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb848-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb848-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb848-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb848-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb848-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb848-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb848-9" title="9"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb848-10" title="10"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb848-11" title="11"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb848-12" title="12"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb848-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb848-14" title="14"></a>
<a class="sourceLine" id="cb848-15" title="15"><span class="kw">def</span> substructure(smiles, mol_list):</a>
<a class="sourceLine" id="cb848-16" title="16">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb848-17" title="17"><span class="co">    This function takes a smiles string and searches mol_list to find entries that contain the substructure. It returns the indices of these entries.</span></a>
<a class="sourceLine" id="cb848-18" title="18"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb848-19" title="19">    [insert]</a>
<a class="sourceLine" id="cb848-20" title="20">    <span class="cf">return</span> idx</a></code></pre></div>
<h4 id="run-0-77">Run 0</h4>
<div class="sourceCode" id="cb849"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb849-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb849-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb849-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb849-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb849-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb849-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb849-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb849-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb849-9" title="9"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb849-10" title="10"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb849-11" title="11"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb849-12" title="12"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb849-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb849-14" title="14"></a>
<a class="sourceLine" id="cb849-15" title="15"><span class="kw">def</span> substructure(smiles, mol_list):</a>
<a class="sourceLine" id="cb849-16" title="16">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb849-17" title="17"><span class="co">    This function takes a smiles string and searches mol_list to find entries that contain the substructure. It returns the indices of these entries.</span></a>
<a class="sourceLine" id="cb849-18" title="18"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb849-19" title="19">    idx <span class="op">=</span> []</a>
<a class="sourceLine" id="cb849-20" title="20">    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(mol_list)):</a>
<a class="sourceLine" id="cb849-21" title="21">        <span class="cf">if</span> mol_list[i].HasSubstructMatch(Chem.MolFromSmiles(smiles)):</a>
<a class="sourceLine" id="cb849-22" title="22">            idx.append(i)</a>
<a class="sourceLine" id="cb849-23" title="23">    <span class="cf">return</span> idx</a>
<a class="sourceLine" id="cb849-24" title="24"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb849-25" title="25"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb849-26" title="26"><span class="co"># Taken from rdkit Docs</span></a>
<a class="sourceLine" id="cb849-27" title="27"><span class="im">from</span> rdkit <span class="im">import</span> RDConfig, Chem</a>
<a class="sourceLine" id="cb849-28" title="28"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdSubstructLibrary</a>
<a class="sourceLine" id="cb849-29" title="29">library <span class="op">=</span> rdSubstructLibrary.SubstructLibrary()</a>
<a class="sourceLine" id="cb849-30" title="30">llibrary <span class="op">=</span> []</a>
<a class="sourceLine" id="cb849-31" title="31"><span class="cf">for</span> mol <span class="kw">in</span> Chem.SDMolSupplier(os.path.join(RDConfig.RDDataDir,</a>
<a class="sourceLine" id="cb849-32" title="32">                                           <span class="st">&#39;NCI&#39;</span>, <span class="st">&#39;first_200.props.sdf&#39;</span>)):</a>
<a class="sourceLine" id="cb849-33" title="33">    idx <span class="op">=</span> library.AddMol(mol)</a>
<a class="sourceLine" id="cb849-34" title="34">    llibrary.append(mol)</a>
<a class="sourceLine" id="cb849-35" title="35">smiles <span class="op">=</span> <span class="st">&#39;CCCCOC&#39;</span></a>
<a class="sourceLine" id="cb849-36" title="36">core <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb849-37" title="37">indices <span class="op">=</span> library.GetMatches(core)</a>
<a class="sourceLine" id="cb849-38" title="38"></a>
<a class="sourceLine" id="cb849-39" title="39">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(<span class="bu">len</span>(substructure(</a>
<a class="sourceLine" id="cb849-40" title="40">    smiles, llibrary)), <span class="bu">len</span>(indices)) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>File error: Bad input file /tmp/pip-req-build-p3aa6g65/build/temp.linux-x86_64-3.8/rdkit_install/share/RDKit/Data/NCI/first_200.props.sdf</code></pre>
<h4 id="run-1-77">Run 1</h4>
<div class="sourceCode" id="cb851"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb851-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb851-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb851-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb851-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb851-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb851-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb851-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb851-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb851-9" title="9"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb851-10" title="10"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb851-11" title="11"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb851-12" title="12"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb851-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb851-14" title="14"></a>
<a class="sourceLine" id="cb851-15" title="15"><span class="kw">def</span> substructure(smiles, mol_list):</a>
<a class="sourceLine" id="cb851-16" title="16">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb851-17" title="17"><span class="co">    This function takes a smiles string and searches mol_list to find entries that contain the substructure. It returns the indices of these entries.</span></a>
<a class="sourceLine" id="cb851-18" title="18"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb851-19" title="19">    idx <span class="op">=</span> []</a>
<a class="sourceLine" id="cb851-20" title="20">    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(mol_list)):</a>
<a class="sourceLine" id="cb851-21" title="21">        <span class="cf">if</span> mol_list[i].HasSubstructMatch(Chem.MolFromSmiles(smiles)):</a>
<a class="sourceLine" id="cb851-22" title="22">            idx.append(i)</a>
<a class="sourceLine" id="cb851-23" title="23">    <span class="cf">return</span> idx</a>
<a class="sourceLine" id="cb851-24" title="24"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb851-25" title="25"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb851-26" title="26"><span class="co"># Taken from rdkit Docs</span></a>
<a class="sourceLine" id="cb851-27" title="27"><span class="im">from</span> rdkit <span class="im">import</span> RDConfig, Chem</a>
<a class="sourceLine" id="cb851-28" title="28"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdSubstructLibrary</a>
<a class="sourceLine" id="cb851-29" title="29">library <span class="op">=</span> rdSubstructLibrary.SubstructLibrary()</a>
<a class="sourceLine" id="cb851-30" title="30">llibrary <span class="op">=</span> []</a>
<a class="sourceLine" id="cb851-31" title="31"><span class="cf">for</span> mol <span class="kw">in</span> Chem.SDMolSupplier(os.path.join(RDConfig.RDDataDir,</a>
<a class="sourceLine" id="cb851-32" title="32">                                           <span class="st">&#39;NCI&#39;</span>, <span class="st">&#39;first_200.props.sdf&#39;</span>)):</a>
<a class="sourceLine" id="cb851-33" title="33">    idx <span class="op">=</span> library.AddMol(mol)</a>
<a class="sourceLine" id="cb851-34" title="34">    llibrary.append(mol)</a>
<a class="sourceLine" id="cb851-35" title="35">smiles <span class="op">=</span> <span class="st">&#39;CCCCOC&#39;</span></a>
<a class="sourceLine" id="cb851-36" title="36">core <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb851-37" title="37">indices <span class="op">=</span> library.GetMatches(core)</a>
<a class="sourceLine" id="cb851-38" title="38"></a>
<a class="sourceLine" id="cb851-39" title="39">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(<span class="bu">len</span>(substructure(</a>
<a class="sourceLine" id="cb851-40" title="40">    smiles, llibrary)), <span class="bu">len</span>(indices)) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>File error: Bad input file /tmp/pip-req-build-p3aa6g65/build/temp.linux-x86_64-3.8/rdkit_install/share/RDKit/Data/NCI/first_200.props.sdf</code></pre>
<h4 id="run-2-77">Run 2</h4>
<div class="sourceCode" id="cb853"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb853-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb853-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb853-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb853-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb853-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb853-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb853-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb853-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb853-9" title="9"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb853-10" title="10"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb853-11" title="11"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb853-12" title="12"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb853-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb853-14" title="14"></a>
<a class="sourceLine" id="cb853-15" title="15"><span class="kw">def</span> substructure(smiles, mol_list):</a>
<a class="sourceLine" id="cb853-16" title="16">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb853-17" title="17"><span class="co">    This function takes a smiles string and searches mol_list to find entries that contain the substructure. It returns the indices of these entries.</span></a>
<a class="sourceLine" id="cb853-18" title="18"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb853-19" title="19">    idx <span class="op">=</span> []</a>
<a class="sourceLine" id="cb853-20" title="20">    <span class="cf">for</span> i, mol <span class="kw">in</span> <span class="bu">enumerate</span>(mol_list):</a>
<a class="sourceLine" id="cb853-21" title="21">        <span class="cf">if</span> mol.HasSubstructMatch(Chem.MolFromSmiles(smiles)):</a>
<a class="sourceLine" id="cb853-22" title="22">            idx.append(i)</a>
<a class="sourceLine" id="cb853-23" title="23">    <span class="cf">return</span> idx</a>
<a class="sourceLine" id="cb853-24" title="24"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb853-25" title="25"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb853-26" title="26"><span class="co"># Taken from rdkit Docs</span></a>
<a class="sourceLine" id="cb853-27" title="27"><span class="im">from</span> rdkit <span class="im">import</span> RDConfig, Chem</a>
<a class="sourceLine" id="cb853-28" title="28"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdSubstructLibrary</a>
<a class="sourceLine" id="cb853-29" title="29">library <span class="op">=</span> rdSubstructLibrary.SubstructLibrary()</a>
<a class="sourceLine" id="cb853-30" title="30">llibrary <span class="op">=</span> []</a>
<a class="sourceLine" id="cb853-31" title="31"><span class="cf">for</span> mol <span class="kw">in</span> Chem.SDMolSupplier(os.path.join(RDConfig.RDDataDir,</a>
<a class="sourceLine" id="cb853-32" title="32">                                           <span class="st">&#39;NCI&#39;</span>, <span class="st">&#39;first_200.props.sdf&#39;</span>)):</a>
<a class="sourceLine" id="cb853-33" title="33">    idx <span class="op">=</span> library.AddMol(mol)</a>
<a class="sourceLine" id="cb853-34" title="34">    llibrary.append(mol)</a>
<a class="sourceLine" id="cb853-35" title="35">smiles <span class="op">=</span> <span class="st">&#39;CCCCOC&#39;</span></a>
<a class="sourceLine" id="cb853-36" title="36">core <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb853-37" title="37">indices <span class="op">=</span> library.GetMatches(core)</a>
<a class="sourceLine" id="cb853-38" title="38"></a>
<a class="sourceLine" id="cb853-39" title="39">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(<span class="bu">len</span>(substructure(</a>
<a class="sourceLine" id="cb853-40" title="40">    smiles, llibrary)), <span class="bu">len</span>(indices)) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>File error: Bad input file /tmp/pip-req-build-p3aa6g65/build/temp.linux-x86_64-3.8/rdkit_install/share/RDKit/Data/NCI/first_200.props.sdf</code></pre>
<h4 id="run-3-77">Run 3</h4>
<div class="sourceCode" id="cb855"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb855-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb855-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb855-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb855-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb855-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb855-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb855-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb855-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb855-9" title="9"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb855-10" title="10"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb855-11" title="11"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb855-12" title="12"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb855-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb855-14" title="14"></a>
<a class="sourceLine" id="cb855-15" title="15"><span class="kw">def</span> substructure(smiles, mol_list):</a>
<a class="sourceLine" id="cb855-16" title="16">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb855-17" title="17"><span class="co">    This function takes a smiles string and searches mol_list to find entries that contain the substructure. It returns the indices of these entries.</span></a>
<a class="sourceLine" id="cb855-18" title="18"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb855-19" title="19">    idx <span class="op">=</span> []</a>
<a class="sourceLine" id="cb855-20" title="20">    <span class="cf">for</span> i, mol <span class="kw">in</span> <span class="bu">enumerate</span>(mol_list):</a>
<a class="sourceLine" id="cb855-21" title="21">        <span class="cf">if</span> mol.HasSubstructMatch(Chem.MolFromSmiles(smiles)):</a>
<a class="sourceLine" id="cb855-22" title="22">            idx.append(i)</a>
<a class="sourceLine" id="cb855-23" title="23">    <span class="cf">return</span> idx</a>
<a class="sourceLine" id="cb855-24" title="24"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb855-25" title="25"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb855-26" title="26"><span class="co"># Taken from rdkit Docs</span></a>
<a class="sourceLine" id="cb855-27" title="27"><span class="im">from</span> rdkit <span class="im">import</span> RDConfig, Chem</a>
<a class="sourceLine" id="cb855-28" title="28"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdSubstructLibrary</a>
<a class="sourceLine" id="cb855-29" title="29">library <span class="op">=</span> rdSubstructLibrary.SubstructLibrary()</a>
<a class="sourceLine" id="cb855-30" title="30">llibrary <span class="op">=</span> []</a>
<a class="sourceLine" id="cb855-31" title="31"><span class="cf">for</span> mol <span class="kw">in</span> Chem.SDMolSupplier(os.path.join(RDConfig.RDDataDir,</a>
<a class="sourceLine" id="cb855-32" title="32">                                           <span class="st">&#39;NCI&#39;</span>, <span class="st">&#39;first_200.props.sdf&#39;</span>)):</a>
<a class="sourceLine" id="cb855-33" title="33">    idx <span class="op">=</span> library.AddMol(mol)</a>
<a class="sourceLine" id="cb855-34" title="34">    llibrary.append(mol)</a>
<a class="sourceLine" id="cb855-35" title="35">smiles <span class="op">=</span> <span class="st">&#39;CCCCOC&#39;</span></a>
<a class="sourceLine" id="cb855-36" title="36">core <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb855-37" title="37">indices <span class="op">=</span> library.GetMatches(core)</a>
<a class="sourceLine" id="cb855-38" title="38"></a>
<a class="sourceLine" id="cb855-39" title="39">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(<span class="bu">len</span>(substructure(</a>
<a class="sourceLine" id="cb855-40" title="40">    smiles, llibrary)), <span class="bu">len</span>(indices)) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>File error: Bad input file /tmp/pip-req-build-p3aa6g65/build/temp.linux-x86_64-3.8/rdkit_install/share/RDKit/Data/NCI/first_200.props.sdf</code></pre>
<h4 id="run-4-77">Run 4</h4>
<div class="sourceCode" id="cb857"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb857-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb857-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb857-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb857-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb857-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb857-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb857-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb857-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb857-9" title="9"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb857-10" title="10"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb857-11" title="11"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb857-12" title="12"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb857-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb857-14" title="14"></a>
<a class="sourceLine" id="cb857-15" title="15"><span class="kw">def</span> substructure(smiles, mol_list):</a>
<a class="sourceLine" id="cb857-16" title="16">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb857-17" title="17"><span class="co">    This function takes a smiles string and searches mol_list to find entries that contain the substructure. It returns the indices of these entries.</span></a>
<a class="sourceLine" id="cb857-18" title="18"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb857-19" title="19">    idx <span class="op">=</span> []</a>
<a class="sourceLine" id="cb857-20" title="20">    <span class="cf">for</span> i, mol <span class="kw">in</span> <span class="bu">enumerate</span>(mol_list):</a>
<a class="sourceLine" id="cb857-21" title="21">        <span class="cf">if</span> mol.HasSubstructMatch(Chem.MolFromSmiles(smiles)):</a>
<a class="sourceLine" id="cb857-22" title="22">            idx.append(i)</a>
<a class="sourceLine" id="cb857-23" title="23">    <span class="cf">return</span> idx</a>
<a class="sourceLine" id="cb857-24" title="24"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb857-25" title="25"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb857-26" title="26"><span class="co"># Taken from rdkit Docs</span></a>
<a class="sourceLine" id="cb857-27" title="27"><span class="im">from</span> rdkit <span class="im">import</span> RDConfig, Chem</a>
<a class="sourceLine" id="cb857-28" title="28"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdSubstructLibrary</a>
<a class="sourceLine" id="cb857-29" title="29">library <span class="op">=</span> rdSubstructLibrary.SubstructLibrary()</a>
<a class="sourceLine" id="cb857-30" title="30">llibrary <span class="op">=</span> []</a>
<a class="sourceLine" id="cb857-31" title="31"><span class="cf">for</span> mol <span class="kw">in</span> Chem.SDMolSupplier(os.path.join(RDConfig.RDDataDir,</a>
<a class="sourceLine" id="cb857-32" title="32">                                           <span class="st">&#39;NCI&#39;</span>, <span class="st">&#39;first_200.props.sdf&#39;</span>)):</a>
<a class="sourceLine" id="cb857-33" title="33">    idx <span class="op">=</span> library.AddMol(mol)</a>
<a class="sourceLine" id="cb857-34" title="34">    llibrary.append(mol)</a>
<a class="sourceLine" id="cb857-35" title="35">smiles <span class="op">=</span> <span class="st">&#39;CCCCOC&#39;</span></a>
<a class="sourceLine" id="cb857-36" title="36">core <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb857-37" title="37">indices <span class="op">=</span> library.GetMatches(core)</a>
<a class="sourceLine" id="cb857-38" title="38"></a>
<a class="sourceLine" id="cb857-39" title="39">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(<span class="bu">len</span>(substructure(</a>
<a class="sourceLine" id="cb857-40" title="40">    smiles, llibrary)), <span class="bu">len</span>(indices)) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>File error: Bad input file /tmp/pip-req-build-p3aa6g65/build/temp.linux-x86_64-3.8/rdkit_install/share/RDKit/Data/NCI/first_200.props.sdf</code></pre>
</details>
<details>
<p><summary>tanimoto</summary></p>
<h4 id="query-78">Query</h4>
<div class="sourceCode" id="cb859"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb859-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb859-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb859-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb859-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb859-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb859-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb859-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb859-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb859-9" title="9"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb859-10" title="10"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb859-11" title="11"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb859-12" title="12"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb859-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb859-14" title="14"></a>
<a class="sourceLine" id="cb859-15" title="15"><span class="kw">def</span> tanimoto_matrix(smiles_list, bits<span class="op">=</span><span class="dv">256</span>):</a>
<a class="sourceLine" id="cb859-16" title="16">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb859-17" title="17"><span class="co">  Returns pairwise Tanimoto similarity matrix with ECFP4 fingerprints</span></a>
<a class="sourceLine" id="cb859-18" title="18"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb859-19" title="19">  [insert]</a>
<a class="sourceLine" id="cb859-20" title="20">  <span class="cf">return</span> s</a></code></pre></div>
<h4 id="run-0-78">Run 0</h4>
<div class="sourceCode" id="cb860"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb860-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb860-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb860-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb860-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb860-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb860-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb860-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb860-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb860-9" title="9"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb860-10" title="10"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb860-11" title="11"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb860-12" title="12"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb860-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb860-14" title="14"></a>
<a class="sourceLine" id="cb860-15" title="15"><span class="kw">def</span> tanimoto_matrix(smiles_list, bits<span class="op">=</span><span class="dv">256</span>):</a>
<a class="sourceLine" id="cb860-16" title="16">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb860-17" title="17"><span class="co">  Returns pairwise Tanimoto similarity matrix with ECFP4 fingerprints</span></a>
<a class="sourceLine" id="cb860-18" title="18"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb860-19" title="19">  mols <span class="op">=</span> [Chem.MolFromSmiles(smiles) <span class="cf">for</span> smiles <span class="kw">in</span> smiles_list]</a>
<a class="sourceLine" id="cb860-20" title="20">  fps <span class="op">=</span> [rdMolDescriptors.GetMorganFingerprintAsBitVect(mol, <span class="dv">2</span>, nBits<span class="op">=</span>bits) <span class="cf">for</span> mol <span class="kw">in</span> mols]</a>
<a class="sourceLine" id="cb860-21" title="21">  s <span class="op">=</span> np.zeros((<span class="bu">len</span>(fps), <span class="bu">len</span>(fps)))</a>
<a class="sourceLine" id="cb860-22" title="22">  <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(fps)):</a>
<a class="sourceLine" id="cb860-23" title="23">    <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(fps)):</a>
<a class="sourceLine" id="cb860-24" title="24">      s[i,j] <span class="op">=</span> DataStructs.FingerprintSimilarity(fps[i], fps[j])</a>
<a class="sourceLine" id="cb860-25" title="25">  <span class="cf">return</span> s</a>
<a class="sourceLine" id="cb860-26" title="26"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb860-27" title="27"><span class="im">from</span> rdkit.DataStructs.cDataStructs <span class="im">import</span> TanimotoSimilarity</a>
<a class="sourceLine" id="cb860-28" title="28"><span class="im">from</span> rdkit.Chem <span class="im">import</span> AllChem</a>
<a class="sourceLine" id="cb860-29" title="29"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb860-30" title="30"><span class="im">import</span> itertools</a>
<a class="sourceLine" id="cb860-31" title="31"></a>
<a class="sourceLine" id="cb860-32" title="32"></a>
<a class="sourceLine" id="cb860-33" title="33"><span class="kw">def</span> ref_tan_matrix(slist):</a>
<a class="sourceLine" id="cb860-34" title="34">    fp <span class="op">=</span> [AllChem.GetMorganFingerprintAsBitVect(</a>
<a class="sourceLine" id="cb860-35" title="35">        Chem.MolFromSmiles(s), <span class="dv">2</span>, nBits<span class="op">=</span><span class="dv">256</span>) <span class="cf">for</span> s <span class="kw">in</span> slist]</a>
<a class="sourceLine" id="cb860-36" title="36">    ts <span class="op">=</span> <span class="bu">list</span>(</a>
<a class="sourceLine" id="cb860-37" title="37">        TanimotoSimilarity(x, y) <span class="cf">for</span> x, y <span class="kw">in</span> itertools.product(fp, repeat<span class="op">=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb860-38" title="38">    )</a>
<a class="sourceLine" id="cb860-39" title="39">    <span class="cf">return</span> np.array(ts).reshape(<span class="bu">len</span>(fp), <span class="bu">len</span>(fp))</a>
<a class="sourceLine" id="cb860-40" title="40"></a>
<a class="sourceLine" id="cb860-41" title="41"></a>
<a class="sourceLine" id="cb860-42" title="42">mols <span class="op">=</span> [<span class="st">&#39;C1C=C(C=NC=C(C(F)(F)F)CCCCCC)C=C1C=CC=CC&#39;</span>,</a>
<a class="sourceLine" id="cb860-43" title="43">        <span class="st">&#39;CC=C=C(C(=O)N)&#39;</span>, <span class="st">&#39;C1([O-])C=CC=C1NC=CC=C&#39;</span>]</a>
<a class="sourceLine" id="cb860-44" title="44"><span class="co"># turned down tolerance because CODEX wants to compute</span></a>
<a class="sourceLine" id="cb860-45" title="45"><span class="co"># fingerprint with slightly different implementation (can&#39;t tell diff?)</span></a>
<a class="sourceLine" id="cb860-46" title="46">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.allclose(ref_tan_matrix(</a>
<a class="sourceLine" id="cb860-47" title="47">    mols), tanimoto_matrix(mols), rtol<span class="op">=</span><span class="fl">0.1</span>, atol<span class="op">=</span><span class="fl">1e-2</span>) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-78">Run 1</h4>
<div class="sourceCode" id="cb862"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb862-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb862-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb862-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb862-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb862-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb862-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb862-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb862-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb862-9" title="9"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb862-10" title="10"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb862-11" title="11"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb862-12" title="12"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb862-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb862-14" title="14"></a>
<a class="sourceLine" id="cb862-15" title="15"><span class="kw">def</span> tanimoto_matrix(smiles_list, bits<span class="op">=</span><span class="dv">256</span>):</a>
<a class="sourceLine" id="cb862-16" title="16">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb862-17" title="17"><span class="co">  Returns pairwise Tanimoto similarity matrix with ECFP4 fingerprints</span></a>
<a class="sourceLine" id="cb862-18" title="18"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb862-19" title="19">  fps <span class="op">=</span> [rdMolHash.GetMorganFingerprintAsBitVect(Chem.MolFromSmiles(smiles), bits) <span class="cf">for</span> smiles <span class="kw">in</span> smiles_list]</a>
<a class="sourceLine" id="cb862-20" title="20">  tanimoto_matrix <span class="op">=</span> np.zeros((<span class="bu">len</span>(fps), <span class="bu">len</span>(fps)))</a>
<a class="sourceLine" id="cb862-21" title="21">  <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(fps)):</a>
<a class="sourceLine" id="cb862-22" title="22">    <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(fps)):</a>
<a class="sourceLine" id="cb862-23" title="23">      tanimoto_matrix[i, j] <span class="op">=</span> DataStructs.TanimotoSimilarity(fps[i], fps[j])</a>
<a class="sourceLine" id="cb862-24" title="24">  <span class="cf">return</span> tanimoto_matrix</a>
<a class="sourceLine" id="cb862-25" title="25"></a>
<a class="sourceLine" id="cb862-26" title="26"></a>
<a class="sourceLine" id="cb862-27" title="27">  <span class="cf">return</span> s</a>
<a class="sourceLine" id="cb862-28" title="28"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb862-29" title="29"><span class="im">from</span> rdkit.DataStructs.cDataStructs <span class="im">import</span> TanimotoSimilarity</a>
<a class="sourceLine" id="cb862-30" title="30"><span class="im">from</span> rdkit.Chem <span class="im">import</span> AllChem</a>
<a class="sourceLine" id="cb862-31" title="31"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb862-32" title="32"><span class="im">import</span> itertools</a>
<a class="sourceLine" id="cb862-33" title="33"></a>
<a class="sourceLine" id="cb862-34" title="34"></a>
<a class="sourceLine" id="cb862-35" title="35"><span class="kw">def</span> ref_tan_matrix(slist):</a>
<a class="sourceLine" id="cb862-36" title="36">    fp <span class="op">=</span> [AllChem.GetMorganFingerprintAsBitVect(</a>
<a class="sourceLine" id="cb862-37" title="37">        Chem.MolFromSmiles(s), <span class="dv">2</span>, nBits<span class="op">=</span><span class="dv">256</span>) <span class="cf">for</span> s <span class="kw">in</span> slist]</a>
<a class="sourceLine" id="cb862-38" title="38">    ts <span class="op">=</span> <span class="bu">list</span>(</a>
<a class="sourceLine" id="cb862-39" title="39">        TanimotoSimilarity(x, y) <span class="cf">for</span> x, y <span class="kw">in</span> itertools.product(fp, repeat<span class="op">=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb862-40" title="40">    )</a>
<a class="sourceLine" id="cb862-41" title="41">    <span class="cf">return</span> np.array(ts).reshape(<span class="bu">len</span>(fp), <span class="bu">len</span>(fp))</a>
<a class="sourceLine" id="cb862-42" title="42"></a>
<a class="sourceLine" id="cb862-43" title="43"></a>
<a class="sourceLine" id="cb862-44" title="44">mols <span class="op">=</span> [<span class="st">&#39;C1C=C(C=NC=C(C(F)(F)F)CCCCCC)C=C1C=CC=CC&#39;</span>,</a>
<a class="sourceLine" id="cb862-45" title="45">        <span class="st">&#39;CC=C=C(C(=O)N)&#39;</span>, <span class="st">&#39;C1([O-])C=CC=C1NC=CC=C&#39;</span>]</a>
<a class="sourceLine" id="cb862-46" title="46"><span class="co"># turned down tolerance because CODEX wants to compute</span></a>
<a class="sourceLine" id="cb862-47" title="47"><span class="co"># fingerprint with slightly different implementation (can&#39;t tell diff?)</span></a>
<a class="sourceLine" id="cb862-48" title="48">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.allclose(ref_tan_matrix(</a>
<a class="sourceLine" id="cb862-49" title="49">    mols), tanimoto_matrix(mols), rtol<span class="op">=</span><span class="fl">0.1</span>, atol<span class="op">=</span><span class="fl">1e-2</span>) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>module &#39;rdkit.Chem.rdMolHash&#39; has no attribute &#39;GetMorganFingerprintAsBitVect&#39;</code></pre>
<h4 id="run-2-78">Run 2</h4>
<div class="sourceCode" id="cb864"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb864-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb864-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb864-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb864-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb864-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb864-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb864-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb864-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb864-9" title="9"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb864-10" title="10"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb864-11" title="11"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb864-12" title="12"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb864-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb864-14" title="14"></a>
<a class="sourceLine" id="cb864-15" title="15"><span class="kw">def</span> tanimoto_matrix(smiles_list, bits<span class="op">=</span><span class="dv">256</span>):</a>
<a class="sourceLine" id="cb864-16" title="16">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb864-17" title="17"><span class="co">  Returns pairwise Tanimoto similarity matrix with ECFP4 fingerprints</span></a>
<a class="sourceLine" id="cb864-18" title="18"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb864-19" title="19">  mols <span class="op">=</span> [Chem.MolFromSmiles(smiles) <span class="cf">for</span> smiles <span class="kw">in</span> smiles_list]</a>
<a class="sourceLine" id="cb864-20" title="20">  fps <span class="op">=</span> [rdMolDescriptors.GetMorganFingerprintAsBitVect(mol, <span class="dv">2</span>, nBits<span class="op">=</span>bits) <span class="cf">for</span> mol <span class="kw">in</span> mols]</a>
<a class="sourceLine" id="cb864-21" title="21">  tanimoto_matrix <span class="op">=</span> np.zeros((<span class="bu">len</span>(fps), <span class="bu">len</span>(fps)))</a>
<a class="sourceLine" id="cb864-22" title="22">  <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(fps)):</a>
<a class="sourceLine" id="cb864-23" title="23">    <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(i, <span class="bu">len</span>(fps)):</a>
<a class="sourceLine" id="cb864-24" title="24">      tanimoto_matrix[i, j] <span class="op">=</span> DataStructs.TanimotoSimilarity(fps[i], fps[j])</a>
<a class="sourceLine" id="cb864-25" title="25">      tanimoto_matrix[j, i] <span class="op">=</span> tanimoto_matrix[i, j]</a>
<a class="sourceLine" id="cb864-26" title="26">  <span class="cf">return</span> tanimoto_matrix</a>
<a class="sourceLine" id="cb864-27" title="27"></a>
<a class="sourceLine" id="cb864-28" title="28"></a>
<a class="sourceLine" id="cb864-29" title="29">  <span class="cf">return</span> s</a>
<a class="sourceLine" id="cb864-30" title="30"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb864-31" title="31"><span class="im">from</span> rdkit.DataStructs.cDataStructs <span class="im">import</span> TanimotoSimilarity</a>
<a class="sourceLine" id="cb864-32" title="32"><span class="im">from</span> rdkit.Chem <span class="im">import</span> AllChem</a>
<a class="sourceLine" id="cb864-33" title="33"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb864-34" title="34"><span class="im">import</span> itertools</a>
<a class="sourceLine" id="cb864-35" title="35"></a>
<a class="sourceLine" id="cb864-36" title="36"></a>
<a class="sourceLine" id="cb864-37" title="37"><span class="kw">def</span> ref_tan_matrix(slist):</a>
<a class="sourceLine" id="cb864-38" title="38">    fp <span class="op">=</span> [AllChem.GetMorganFingerprintAsBitVect(</a>
<a class="sourceLine" id="cb864-39" title="39">        Chem.MolFromSmiles(s), <span class="dv">2</span>, nBits<span class="op">=</span><span class="dv">256</span>) <span class="cf">for</span> s <span class="kw">in</span> slist]</a>
<a class="sourceLine" id="cb864-40" title="40">    ts <span class="op">=</span> <span class="bu">list</span>(</a>
<a class="sourceLine" id="cb864-41" title="41">        TanimotoSimilarity(x, y) <span class="cf">for</span> x, y <span class="kw">in</span> itertools.product(fp, repeat<span class="op">=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb864-42" title="42">    )</a>
<a class="sourceLine" id="cb864-43" title="43">    <span class="cf">return</span> np.array(ts).reshape(<span class="bu">len</span>(fp), <span class="bu">len</span>(fp))</a>
<a class="sourceLine" id="cb864-44" title="44"></a>
<a class="sourceLine" id="cb864-45" title="45"></a>
<a class="sourceLine" id="cb864-46" title="46">mols <span class="op">=</span> [<span class="st">&#39;C1C=C(C=NC=C(C(F)(F)F)CCCCCC)C=C1C=CC=CC&#39;</span>,</a>
<a class="sourceLine" id="cb864-47" title="47">        <span class="st">&#39;CC=C=C(C(=O)N)&#39;</span>, <span class="st">&#39;C1([O-])C=CC=C1NC=CC=C&#39;</span>]</a>
<a class="sourceLine" id="cb864-48" title="48"><span class="co"># turned down tolerance because CODEX wants to compute</span></a>
<a class="sourceLine" id="cb864-49" title="49"><span class="co"># fingerprint with slightly different implementation (can&#39;t tell diff?)</span></a>
<a class="sourceLine" id="cb864-50" title="50">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.allclose(ref_tan_matrix(</a>
<a class="sourceLine" id="cb864-51" title="51">    mols), tanimoto_matrix(mols), rtol<span class="op">=</span><span class="fl">0.1</span>, atol<span class="op">=</span><span class="fl">1e-2</span>) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-78">Run 3</h4>
<div class="sourceCode" id="cb866"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb866-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb866-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb866-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb866-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb866-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb866-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb866-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb866-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb866-9" title="9"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb866-10" title="10"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb866-11" title="11"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb866-12" title="12"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb866-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb866-14" title="14"></a>
<a class="sourceLine" id="cb866-15" title="15"><span class="kw">def</span> tanimoto_matrix(smiles_list, bits<span class="op">=</span><span class="dv">256</span>):</a>
<a class="sourceLine" id="cb866-16" title="16">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb866-17" title="17"><span class="co">  Returns pairwise Tanimoto similarity matrix with ECFP4 fingerprints</span></a>
<a class="sourceLine" id="cb866-18" title="18"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb866-19" title="19">  mols <span class="op">=</span> [Chem.MolFromSmiles(smiles) <span class="cf">for</span> smiles <span class="kw">in</span> smiles_list]</a>
<a class="sourceLine" id="cb866-20" title="20">  fps <span class="op">=</span> [rdMolDescriptors.GetMorganFingerprintAsBitVect(mol, <span class="dv">2</span>, nBits<span class="op">=</span>bits) <span class="cf">for</span> mol <span class="kw">in</span> mols]</a>
<a class="sourceLine" id="cb866-21" title="21">  tanimoto_matrix <span class="op">=</span> np.zeros((<span class="bu">len</span>(fps), <span class="bu">len</span>(fps)))</a>
<a class="sourceLine" id="cb866-22" title="22">  <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(fps)):</a>
<a class="sourceLine" id="cb866-23" title="23">    <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(fps)):</a>
<a class="sourceLine" id="cb866-24" title="24">      tanimoto_matrix[i, j] <span class="op">=</span> DataStructs.FingerprintSimilarity(fps[i], fps[j])</a>
<a class="sourceLine" id="cb866-25" title="25">  <span class="cf">return</span> tanimoto_matrix</a>
<a class="sourceLine" id="cb866-26" title="26"></a>
<a class="sourceLine" id="cb866-27" title="27"></a>
<a class="sourceLine" id="cb866-28" title="28">  <span class="cf">return</span> s</a>
<a class="sourceLine" id="cb866-29" title="29"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb866-30" title="30"><span class="im">from</span> rdkit.DataStructs.cDataStructs <span class="im">import</span> TanimotoSimilarity</a>
<a class="sourceLine" id="cb866-31" title="31"><span class="im">from</span> rdkit.Chem <span class="im">import</span> AllChem</a>
<a class="sourceLine" id="cb866-32" title="32"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb866-33" title="33"><span class="im">import</span> itertools</a>
<a class="sourceLine" id="cb866-34" title="34"></a>
<a class="sourceLine" id="cb866-35" title="35"></a>
<a class="sourceLine" id="cb866-36" title="36"><span class="kw">def</span> ref_tan_matrix(slist):</a>
<a class="sourceLine" id="cb866-37" title="37">    fp <span class="op">=</span> [AllChem.GetMorganFingerprintAsBitVect(</a>
<a class="sourceLine" id="cb866-38" title="38">        Chem.MolFromSmiles(s), <span class="dv">2</span>, nBits<span class="op">=</span><span class="dv">256</span>) <span class="cf">for</span> s <span class="kw">in</span> slist]</a>
<a class="sourceLine" id="cb866-39" title="39">    ts <span class="op">=</span> <span class="bu">list</span>(</a>
<a class="sourceLine" id="cb866-40" title="40">        TanimotoSimilarity(x, y) <span class="cf">for</span> x, y <span class="kw">in</span> itertools.product(fp, repeat<span class="op">=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb866-41" title="41">    )</a>
<a class="sourceLine" id="cb866-42" title="42">    <span class="cf">return</span> np.array(ts).reshape(<span class="bu">len</span>(fp), <span class="bu">len</span>(fp))</a>
<a class="sourceLine" id="cb866-43" title="43"></a>
<a class="sourceLine" id="cb866-44" title="44"></a>
<a class="sourceLine" id="cb866-45" title="45">mols <span class="op">=</span> [<span class="st">&#39;C1C=C(C=NC=C(C(F)(F)F)CCCCCC)C=C1C=CC=CC&#39;</span>,</a>
<a class="sourceLine" id="cb866-46" title="46">        <span class="st">&#39;CC=C=C(C(=O)N)&#39;</span>, <span class="st">&#39;C1([O-])C=CC=C1NC=CC=C&#39;</span>]</a>
<a class="sourceLine" id="cb866-47" title="47"><span class="co"># turned down tolerance because CODEX wants to compute</span></a>
<a class="sourceLine" id="cb866-48" title="48"><span class="co"># fingerprint with slightly different implementation (can&#39;t tell diff?)</span></a>
<a class="sourceLine" id="cb866-49" title="49">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.allclose(ref_tan_matrix(</a>
<a class="sourceLine" id="cb866-50" title="50">    mols), tanimoto_matrix(mols), rtol<span class="op">=</span><span class="fl">0.1</span>, atol<span class="op">=</span><span class="fl">1e-2</span>) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-78">Run 4</h4>
<div class="sourceCode" id="cb868"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb868-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb868-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb868-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb868-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb868-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb868-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb868-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb868-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb868-9" title="9"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb868-10" title="10"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb868-11" title="11"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb868-12" title="12"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Scaffolds</a>
<a class="sourceLine" id="cb868-13" title="13"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb868-14" title="14"></a>
<a class="sourceLine" id="cb868-15" title="15"><span class="kw">def</span> tanimoto_matrix(smiles_list, bits<span class="op">=</span><span class="dv">256</span>):</a>
<a class="sourceLine" id="cb868-16" title="16">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb868-17" title="17"><span class="co">  Returns pairwise Tanimoto similarity matrix with ECFP4 fingerprints</span></a>
<a class="sourceLine" id="cb868-18" title="18"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb868-19" title="19">  mols <span class="op">=</span> [Chem.MolFromSmiles(smiles) <span class="cf">for</span> smiles <span class="kw">in</span> smiles_list]</a>
<a class="sourceLine" id="cb868-20" title="20">  fps <span class="op">=</span> [rdMolDescriptors.GetMorganFingerprintAsBitVect(mol, <span class="dv">2</span>, nBits<span class="op">=</span>bits) <span class="cf">for</span> mol <span class="kw">in</span> mols]</a>
<a class="sourceLine" id="cb868-21" title="21">  tanimoto_matrix <span class="op">=</span> np.zeros((<span class="bu">len</span>(fps), <span class="bu">len</span>(fps)))</a>
<a class="sourceLine" id="cb868-22" title="22">  <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(fps)):</a>
<a class="sourceLine" id="cb868-23" title="23">    <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(i<span class="op">+</span><span class="dv">1</span>, <span class="bu">len</span>(fps)):</a>
<a class="sourceLine" id="cb868-24" title="24">      tanimoto_matrix[i,j] <span class="op">=</span> DataStructs.TanimotoSimilarity(fps[i], fps[j])</a>
<a class="sourceLine" id="cb868-25" title="25">      tanimoto_matrix[j,i] <span class="op">=</span> tanimoto_matrix[i,j]</a>
<a class="sourceLine" id="cb868-26" title="26">  <span class="cf">return</span> tanimoto_matrix</a>
<a class="sourceLine" id="cb868-27" title="27"></a>
<a class="sourceLine" id="cb868-28" title="28"></a>
<a class="sourceLine" id="cb868-29" title="29">  <span class="cf">return</span> s</a>
<a class="sourceLine" id="cb868-30" title="30"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb868-31" title="31"><span class="im">from</span> rdkit.DataStructs.cDataStructs <span class="im">import</span> TanimotoSimilarity</a>
<a class="sourceLine" id="cb868-32" title="32"><span class="im">from</span> rdkit.Chem <span class="im">import</span> AllChem</a>
<a class="sourceLine" id="cb868-33" title="33"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb868-34" title="34"><span class="im">import</span> itertools</a>
<a class="sourceLine" id="cb868-35" title="35"></a>
<a class="sourceLine" id="cb868-36" title="36"></a>
<a class="sourceLine" id="cb868-37" title="37"><span class="kw">def</span> ref_tan_matrix(slist):</a>
<a class="sourceLine" id="cb868-38" title="38">    fp <span class="op">=</span> [AllChem.GetMorganFingerprintAsBitVect(</a>
<a class="sourceLine" id="cb868-39" title="39">        Chem.MolFromSmiles(s), <span class="dv">2</span>, nBits<span class="op">=</span><span class="dv">256</span>) <span class="cf">for</span> s <span class="kw">in</span> slist]</a>
<a class="sourceLine" id="cb868-40" title="40">    ts <span class="op">=</span> <span class="bu">list</span>(</a>
<a class="sourceLine" id="cb868-41" title="41">        TanimotoSimilarity(x, y) <span class="cf">for</span> x, y <span class="kw">in</span> itertools.product(fp, repeat<span class="op">=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb868-42" title="42">    )</a>
<a class="sourceLine" id="cb868-43" title="43">    <span class="cf">return</span> np.array(ts).reshape(<span class="bu">len</span>(fp), <span class="bu">len</span>(fp))</a>
<a class="sourceLine" id="cb868-44" title="44"></a>
<a class="sourceLine" id="cb868-45" title="45"></a>
<a class="sourceLine" id="cb868-46" title="46">mols <span class="op">=</span> [<span class="st">&#39;C1C=C(C=NC=C(C(F)(F)F)CCCCCC)C=C1C=CC=CC&#39;</span>,</a>
<a class="sourceLine" id="cb868-47" title="47">        <span class="st">&#39;CC=C=C(C(=O)N)&#39;</span>, <span class="st">&#39;C1([O-])C=CC=C1NC=CC=C&#39;</span>]</a>
<a class="sourceLine" id="cb868-48" title="48"><span class="co"># turned down tolerance because CODEX wants to compute</span></a>
<a class="sourceLine" id="cb868-49" title="49"><span class="co"># fingerprint with slightly different implementation (can&#39;t tell diff?)</span></a>
<a class="sourceLine" id="cb868-50" title="50">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.allclose(ref_tan_matrix(</a>
<a class="sourceLine" id="cb868-51" title="51">    mols), tanimoto_matrix(mols), rtol<span class="op">=</span><span class="fl">0.1</span>, atol<span class="op">=</span><span class="fl">1e-2</span>) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>unbdistance</summary></p>
<h4 id="query-79">Query</h4>
<div class="sourceCode" id="cb870"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb870-1" title="1"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb870-2" title="2"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb870-3" title="3"></a>
<a class="sourceLine" id="cb870-4" title="4"><span class="kw">def</span> unbdistance(traj,lig_str):</a>
<a class="sourceLine" id="cb870-5" title="5">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb870-6" title="6"><span class="co">    This function returns a list of distances between center of mass of</span></a>
<a class="sourceLine" id="cb870-7" title="7"><span class="co">    protein and center of mass of lig_str in every frame of trajectory</span></a>
<a class="sourceLine" id="cb870-8" title="8"><span class="co">    traj</span></a>
<a class="sourceLine" id="cb870-9" title="9"></a>
<a class="sourceLine" id="cb870-10" title="10"><span class="co">    traj is an mdtraj trajectory object</span></a>
<a class="sourceLine" id="cb870-11" title="11"><span class="co">    lig_str is a string with the residue name of the ligand</span></a>
<a class="sourceLine" id="cb870-12" title="12"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb870-13" title="13">    [insert]</a>
<a class="sourceLine" id="cb870-14" title="14">    <span class="cf">return</span> result</a></code></pre></div>
<h4 id="run-0-79">Run 0</h4>
<div class="sourceCode" id="cb871"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb871-1" title="1"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb871-2" title="2"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb871-3" title="3"></a>
<a class="sourceLine" id="cb871-4" title="4"><span class="kw">def</span> unbdistance(traj,lig_str):</a>
<a class="sourceLine" id="cb871-5" title="5">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb871-6" title="6"><span class="co">    This function returns a list of distances between center of mass of</span></a>
<a class="sourceLine" id="cb871-7" title="7"><span class="co">    protein and center of mass of lig_str in every frame of trajectory</span></a>
<a class="sourceLine" id="cb871-8" title="8"><span class="co">    traj</span></a>
<a class="sourceLine" id="cb871-9" title="9"></a>
<a class="sourceLine" id="cb871-10" title="10"><span class="co">    traj is an mdtraj trajectory object</span></a>
<a class="sourceLine" id="cb871-11" title="11"><span class="co">    lig_str is a string with the residue name of the ligand</span></a>
<a class="sourceLine" id="cb871-12" title="12"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb871-13" title="13">    lig_ind <span class="op">=</span> traj.topology.select(<span class="st">&#39;resname &#39;</span><span class="op">+</span>lig_str)</a>
<a class="sourceLine" id="cb871-14" title="14">    prot_ind <span class="op">=</span> traj.topology.select(<span class="st">&#39;protein&#39;</span>)</a>
<a class="sourceLine" id="cb871-15" title="15">    lig_com <span class="op">=</span> md.compute_center_of_mass(traj.atom_slice(lig_ind))</a>
<a class="sourceLine" id="cb871-16" title="16">    prot_com <span class="op">=</span> md.compute_center_of_mass(traj.atom_slice(prot_ind))</a>
<a class="sourceLine" id="cb871-17" title="17">    result <span class="op">=</span> md.compute_distances(traj,[lig_com,prot_com],periodic<span class="op">=</span><span class="va">False</span>)</a>
<a class="sourceLine" id="cb871-18" title="18">    <span class="cf">return</span> result</a>
<a class="sourceLine" id="cb871-19" title="19"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb871-20" title="20"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb871-21" title="21"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb871-22" title="22"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb871-23" title="23"></a>
<a class="sourceLine" id="cb871-24" title="24"></a>
<a class="sourceLine" id="cb871-25" title="25"><span class="co">#_FILE_DIR_ = &#39;.&#39;</span></a>
<a class="sourceLine" id="cb871-26" title="26">lig_str <span class="op">=</span> <span class="st">&#39;TMP&#39;</span></a>
<a class="sourceLine" id="cb871-27" title="27">traj_path <span class="op">=</span> os.path.join(_FILE_DIR_, <span class="st">&#39;traj.dcd&#39;</span>) </a>
<a class="sourceLine" id="cb871-28" title="28">top_path <span class="op">=</span> os.path.join(_FILE_DIR_, <span class="st">&#39;top.pdb&#39;</span>)</a>
<a class="sourceLine" id="cb871-29" title="29">traj <span class="op">=</span> md.load(traj_path, top<span class="op">=</span>top_path)</a>
<a class="sourceLine" id="cb871-30" title="30">top <span class="op">=</span> traj.topology</a>
<a class="sourceLine" id="cb871-31" title="31">prot_idxs <span class="op">=</span> top.select(<span class="st">&#39;protein&#39;</span>)</a>
<a class="sourceLine" id="cb871-32" title="32">lig_idxs <span class="op">=</span> top.select(<span class="ss">F&#39;resname == </span><span class="sc">{</span>lig_str<span class="sc">}</span><span class="ss">&#39;</span>)</a>
<a class="sourceLine" id="cb871-33" title="33">traj2 <span class="op">=</span> md.load(traj_path, atom_indices<span class="op">=</span>prot_idxs, top<span class="op">=</span>top_path)</a>
<a class="sourceLine" id="cb871-34" title="34">traj3 <span class="op">=</span> md.load(traj_path, atom_indices<span class="op">=</span>lig_idxs, top<span class="op">=</span>top_path)</a>
<a class="sourceLine" id="cb871-35" title="35"></a>
<a class="sourceLine" id="cb871-36" title="36">dist <span class="op">=</span> []</a>
<a class="sourceLine" id="cb871-37" title="37"><span class="cf">for</span> i,j <span class="kw">in</span> <span class="bu">zip</span>(traj2,traj3):</a>
<a class="sourceLine" id="cb871-38" title="38">    com_a <span class="op">=</span> md.compute_center_of_mass(i)[<span class="dv">0</span>]</a>
<a class="sourceLine" id="cb871-39" title="39">    com_b <span class="op">=</span> md.compute_center_of_mass(j)[<span class="dv">0</span>]</a>
<a class="sourceLine" id="cb871-40" title="40">    dist.append(((com_a[<span class="dv">0</span>]<span class="op">-</span>com_b[<span class="dv">0</span>])<span class="op">**</span><span class="dv">2</span><span class="op">+</span>(com_a[<span class="dv">1</span>]<span class="op">-</span>com_b[<span class="dv">1</span>])<span class="op">**</span><span class="dv">2</span><span class="op">+</span>(com_a[<span class="dv">2</span>]<span class="op">-</span>com_b[<span class="dv">2</span>])<span class="op">**</span><span class="dv">2</span>)<span class="op">**</span><span class="fl">0.5</span>)</a>
<a class="sourceLine" id="cb871-41" title="41"></a>
<a class="sourceLine" id="cb871-42" title="42"><span class="co"># assert</span></a>
<a class="sourceLine" id="cb871-43" title="43"></a>
<a class="sourceLine" id="cb871-44" title="44">distances <span class="op">=</span> unbdistance(traj,lig_str)</a>
<a class="sourceLine" id="cb871-45" title="45"></a>
<a class="sourceLine" id="cb871-46" title="46">check <span class="op">=</span> math.isclose(dist[<span class="dv">0</span>],distances[<span class="dv">0</span>])</a>
<a class="sourceLine" id="cb871-47" title="47">check2 <span class="op">=</span> math.isclose(dist[<span class="op">-</span><span class="dv">1</span>],distances[<span class="op">-</span><span class="dv">1</span>])</a>
<a class="sourceLine" id="cb871-48" title="48">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> check <span class="kw">and</span> check2 <span class="cf">else</span> <span class="va">False</span> </a></code></pre></div>
<p>Output:</p>
<pre><code>&#39;Constant&#39; object has no attribute &#39;kind&#39;</code></pre>
<h4 id="run-1-79">Run 1</h4>
<div class="sourceCode" id="cb873"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb873-1" title="1"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb873-2" title="2"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb873-3" title="3"></a>
<a class="sourceLine" id="cb873-4" title="4"><span class="kw">def</span> unbdistance(traj,lig_str):</a>
<a class="sourceLine" id="cb873-5" title="5">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb873-6" title="6"><span class="co">    This function returns a list of distances between center of mass of</span></a>
<a class="sourceLine" id="cb873-7" title="7"><span class="co">    protein and center of mass of lig_str in every frame of trajectory</span></a>
<a class="sourceLine" id="cb873-8" title="8"><span class="co">    traj</span></a>
<a class="sourceLine" id="cb873-9" title="9"></a>
<a class="sourceLine" id="cb873-10" title="10"><span class="co">    traj is an mdtraj trajectory object</span></a>
<a class="sourceLine" id="cb873-11" title="11"><span class="co">    lig_str is a string with the residue name of the ligand</span></a>
<a class="sourceLine" id="cb873-12" title="12"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb873-13" title="13">    lig_ind <span class="op">=</span> traj.topology.select(<span class="st">&#39;resname &#39;</span><span class="op">+</span>lig_str)</a>
<a class="sourceLine" id="cb873-14" title="14">    prot_ind <span class="op">=</span> traj.topology.select(<span class="st">&#39;protein&#39;</span>)</a>
<a class="sourceLine" id="cb873-15" title="15">    result <span class="op">=</span> []</a>
<a class="sourceLine" id="cb873-16" title="16">    <span class="cf">for</span> frame <span class="kw">in</span> traj:</a>
<a class="sourceLine" id="cb873-17" title="17">        lig_com <span class="op">=</span> np.mean(frame.xyz[<span class="dv">0</span>,lig_ind],axis<span class="op">=</span><span class="dv">0</span>)</a>
<a class="sourceLine" id="cb873-18" title="18">        prot_com <span class="op">=</span> np.mean(frame.xyz[<span class="dv">0</span>,prot_ind],axis<span class="op">=</span><span class="dv">0</span>)</a>
<a class="sourceLine" id="cb873-19" title="19">        result.append(np.linalg.norm(lig_com<span class="op">-</span>prot_com))</a>
<a class="sourceLine" id="cb873-20" title="20">    <span class="cf">return</span> result</a>
<a class="sourceLine" id="cb873-21" title="21"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb873-22" title="22"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb873-23" title="23"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb873-24" title="24"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb873-25" title="25"></a>
<a class="sourceLine" id="cb873-26" title="26"></a>
<a class="sourceLine" id="cb873-27" title="27"><span class="co">#_FILE_DIR_ = &#39;.&#39;</span></a>
<a class="sourceLine" id="cb873-28" title="28">lig_str <span class="op">=</span> <span class="st">&#39;TMP&#39;</span></a>
<a class="sourceLine" id="cb873-29" title="29">traj_path <span class="op">=</span> os.path.join(_FILE_DIR_, <span class="st">&#39;traj.dcd&#39;</span>) </a>
<a class="sourceLine" id="cb873-30" title="30">top_path <span class="op">=</span> os.path.join(_FILE_DIR_, <span class="st">&#39;top.pdb&#39;</span>)</a>
<a class="sourceLine" id="cb873-31" title="31">traj <span class="op">=</span> md.load(traj_path, top<span class="op">=</span>top_path)</a>
<a class="sourceLine" id="cb873-32" title="32">top <span class="op">=</span> traj.topology</a>
<a class="sourceLine" id="cb873-33" title="33">prot_idxs <span class="op">=</span> top.select(<span class="st">&#39;protein&#39;</span>)</a>
<a class="sourceLine" id="cb873-34" title="34">lig_idxs <span class="op">=</span> top.select(<span class="ss">F&#39;resname == </span><span class="sc">{</span>lig_str<span class="sc">}</span><span class="ss">&#39;</span>)</a>
<a class="sourceLine" id="cb873-35" title="35">traj2 <span class="op">=</span> md.load(traj_path, atom_indices<span class="op">=</span>prot_idxs, top<span class="op">=</span>top_path)</a>
<a class="sourceLine" id="cb873-36" title="36">traj3 <span class="op">=</span> md.load(traj_path, atom_indices<span class="op">=</span>lig_idxs, top<span class="op">=</span>top_path)</a>
<a class="sourceLine" id="cb873-37" title="37"></a>
<a class="sourceLine" id="cb873-38" title="38">dist <span class="op">=</span> []</a>
<a class="sourceLine" id="cb873-39" title="39"><span class="cf">for</span> i,j <span class="kw">in</span> <span class="bu">zip</span>(traj2,traj3):</a>
<a class="sourceLine" id="cb873-40" title="40">    com_a <span class="op">=</span> md.compute_center_of_mass(i)[<span class="dv">0</span>]</a>
<a class="sourceLine" id="cb873-41" title="41">    com_b <span class="op">=</span> md.compute_center_of_mass(j)[<span class="dv">0</span>]</a>
<a class="sourceLine" id="cb873-42" title="42">    dist.append(((com_a[<span class="dv">0</span>]<span class="op">-</span>com_b[<span class="dv">0</span>])<span class="op">**</span><span class="dv">2</span><span class="op">+</span>(com_a[<span class="dv">1</span>]<span class="op">-</span>com_b[<span class="dv">1</span>])<span class="op">**</span><span class="dv">2</span><span class="op">+</span>(com_a[<span class="dv">2</span>]<span class="op">-</span>com_b[<span class="dv">2</span>])<span class="op">**</span><span class="dv">2</span>)<span class="op">**</span><span class="fl">0.5</span>)</a>
<a class="sourceLine" id="cb873-43" title="43"></a>
<a class="sourceLine" id="cb873-44" title="44"><span class="co"># assert</span></a>
<a class="sourceLine" id="cb873-45" title="45"></a>
<a class="sourceLine" id="cb873-46" title="46">distances <span class="op">=</span> unbdistance(traj,lig_str)</a>
<a class="sourceLine" id="cb873-47" title="47"></a>
<a class="sourceLine" id="cb873-48" title="48">check <span class="op">=</span> math.isclose(dist[<span class="dv">0</span>],distances[<span class="dv">0</span>])</a>
<a class="sourceLine" id="cb873-49" title="49">check2 <span class="op">=</span> math.isclose(dist[<span class="op">-</span><span class="dv">1</span>],distances[<span class="op">-</span><span class="dv">1</span>])</a>
<a class="sourceLine" id="cb873-50" title="50">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> check <span class="kw">and</span> check2 <span class="cf">else</span> <span class="va">False</span> </a></code></pre></div>
<p>Output:</p>
<pre><code>&#39;Constant&#39; object has no attribute &#39;kind&#39;</code></pre>
<h4 id="run-2-79">Run 2</h4>
<div class="sourceCode" id="cb875"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb875-1" title="1"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb875-2" title="2"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb875-3" title="3"></a>
<a class="sourceLine" id="cb875-4" title="4"><span class="kw">def</span> unbdistance(traj,lig_str):</a>
<a class="sourceLine" id="cb875-5" title="5">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb875-6" title="6"><span class="co">    This function returns a list of distances between center of mass of</span></a>
<a class="sourceLine" id="cb875-7" title="7"><span class="co">    protein and center of mass of lig_str in every frame of trajectory</span></a>
<a class="sourceLine" id="cb875-8" title="8"><span class="co">    traj</span></a>
<a class="sourceLine" id="cb875-9" title="9"></a>
<a class="sourceLine" id="cb875-10" title="10"><span class="co">    traj is an mdtraj trajectory object</span></a>
<a class="sourceLine" id="cb875-11" title="11"><span class="co">    lig_str is a string with the residue name of the ligand</span></a>
<a class="sourceLine" id="cb875-12" title="12"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb875-13" title="13">    <span class="co">#get the indices of the ligand</span></a>
<a class="sourceLine" id="cb875-14" title="14">    lig_ind <span class="op">=</span> traj.topology.select(<span class="st">&#39;resname &#39;</span><span class="op">+</span>lig_str)</a>
<a class="sourceLine" id="cb875-15" title="15">    <span class="co">#get the indices of the protein</span></a>
<a class="sourceLine" id="cb875-16" title="16">    prot_ind <span class="op">=</span> traj.topology.select(<span class="st">&#39;protein&#39;</span>)</a>
<a class="sourceLine" id="cb875-17" title="17">    <span class="co">#get the center of mass of the ligand</span></a>
<a class="sourceLine" id="cb875-18" title="18">    lig_com <span class="op">=</span> md.compute_center_of_mass(traj.atom_slice(lig_ind))</a>
<a class="sourceLine" id="cb875-19" title="19">    <span class="co">#get the center of mass of the protein</span></a>
<a class="sourceLine" id="cb875-20" title="20">    prot_com <span class="op">=</span> md.compute_center_of_mass(traj.atom_slice(prot_ind))</a>
<a class="sourceLine" id="cb875-21" title="21">    <span class="co">#get the distance between the two</span></a>
<a class="sourceLine" id="cb875-22" title="22">    result <span class="op">=</span> md.compute_distances(traj,[lig_com,prot_com],periodic<span class="op">=</span><span class="va">False</span>)</a>
<a class="sourceLine" id="cb875-23" title="23">    <span class="co">#return the distance</span></a>
<a class="sourceLine" id="cb875-24" title="24">    <span class="cf">return</span> result</a>
<a class="sourceLine" id="cb875-25" title="25"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb875-26" title="26"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb875-27" title="27"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb875-28" title="28"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb875-29" title="29"></a>
<a class="sourceLine" id="cb875-30" title="30"></a>
<a class="sourceLine" id="cb875-31" title="31"><span class="co">#_FILE_DIR_ = &#39;.&#39;</span></a>
<a class="sourceLine" id="cb875-32" title="32">lig_str <span class="op">=</span> <span class="st">&#39;TMP&#39;</span></a>
<a class="sourceLine" id="cb875-33" title="33">traj_path <span class="op">=</span> os.path.join(_FILE_DIR_, <span class="st">&#39;traj.dcd&#39;</span>) </a>
<a class="sourceLine" id="cb875-34" title="34">top_path <span class="op">=</span> os.path.join(_FILE_DIR_, <span class="st">&#39;top.pdb&#39;</span>)</a>
<a class="sourceLine" id="cb875-35" title="35">traj <span class="op">=</span> md.load(traj_path, top<span class="op">=</span>top_path)</a>
<a class="sourceLine" id="cb875-36" title="36">top <span class="op">=</span> traj.topology</a>
<a class="sourceLine" id="cb875-37" title="37">prot_idxs <span class="op">=</span> top.select(<span class="st">&#39;protein&#39;</span>)</a>
<a class="sourceLine" id="cb875-38" title="38">lig_idxs <span class="op">=</span> top.select(<span class="ss">F&#39;resname == </span><span class="sc">{</span>lig_str<span class="sc">}</span><span class="ss">&#39;</span>)</a>
<a class="sourceLine" id="cb875-39" title="39">traj2 <span class="op">=</span> md.load(traj_path, atom_indices<span class="op">=</span>prot_idxs, top<span class="op">=</span>top_path)</a>
<a class="sourceLine" id="cb875-40" title="40">traj3 <span class="op">=</span> md.load(traj_path, atom_indices<span class="op">=</span>lig_idxs, top<span class="op">=</span>top_path)</a>
<a class="sourceLine" id="cb875-41" title="41"></a>
<a class="sourceLine" id="cb875-42" title="42">dist <span class="op">=</span> []</a>
<a class="sourceLine" id="cb875-43" title="43"><span class="cf">for</span> i,j <span class="kw">in</span> <span class="bu">zip</span>(traj2,traj3):</a>
<a class="sourceLine" id="cb875-44" title="44">    com_a <span class="op">=</span> md.compute_center_of_mass(i)[<span class="dv">0</span>]</a>
<a class="sourceLine" id="cb875-45" title="45">    com_b <span class="op">=</span> md.compute_center_of_mass(j)[<span class="dv">0</span>]</a>
<a class="sourceLine" id="cb875-46" title="46">    dist.append(((com_a[<span class="dv">0</span>]<span class="op">-</span>com_b[<span class="dv">0</span>])<span class="op">**</span><span class="dv">2</span><span class="op">+</span>(com_a[<span class="dv">1</span>]<span class="op">-</span>com_b[<span class="dv">1</span>])<span class="op">**</span><span class="dv">2</span><span class="op">+</span>(com_a[<span class="dv">2</span>]<span class="op">-</span>com_b[<span class="dv">2</span>])<span class="op">**</span><span class="dv">2</span>)<span class="op">**</span><span class="fl">0.5</span>)</a>
<a class="sourceLine" id="cb875-47" title="47"></a>
<a class="sourceLine" id="cb875-48" title="48"><span class="co"># assert</span></a>
<a class="sourceLine" id="cb875-49" title="49"></a>
<a class="sourceLine" id="cb875-50" title="50">distances <span class="op">=</span> unbdistance(traj,lig_str)</a>
<a class="sourceLine" id="cb875-51" title="51"></a>
<a class="sourceLine" id="cb875-52" title="52">check <span class="op">=</span> math.isclose(dist[<span class="dv">0</span>],distances[<span class="dv">0</span>])</a>
<a class="sourceLine" id="cb875-53" title="53">check2 <span class="op">=</span> math.isclose(dist[<span class="op">-</span><span class="dv">1</span>],distances[<span class="op">-</span><span class="dv">1</span>])</a>
<a class="sourceLine" id="cb875-54" title="54">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> check <span class="kw">and</span> check2 <span class="cf">else</span> <span class="va">False</span> </a></code></pre></div>
<p>Output:</p>
<pre><code>&#39;Constant&#39; object has no attribute &#39;kind&#39;</code></pre>
<h4 id="run-3-79">Run 3</h4>
<div class="sourceCode" id="cb877"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb877-1" title="1"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb877-2" title="2"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb877-3" title="3"></a>
<a class="sourceLine" id="cb877-4" title="4"><span class="kw">def</span> unbdistance(traj,lig_str):</a>
<a class="sourceLine" id="cb877-5" title="5">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb877-6" title="6"><span class="co">    This function returns a list of distances between center of mass of</span></a>
<a class="sourceLine" id="cb877-7" title="7"><span class="co">    protein and center of mass of lig_str in every frame of trajectory</span></a>
<a class="sourceLine" id="cb877-8" title="8"><span class="co">    traj</span></a>
<a class="sourceLine" id="cb877-9" title="9"></a>
<a class="sourceLine" id="cb877-10" title="10"><span class="co">    traj is an mdtraj trajectory object</span></a>
<a class="sourceLine" id="cb877-11" title="11"><span class="co">    lig_str is a string with the residue name of the ligand</span></a>
<a class="sourceLine" id="cb877-12" title="12"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb877-13" title="13">    lig_sel <span class="op">=</span> traj.topology.select(<span class="st">&#39;resname &#39;</span><span class="op">+</span>lig_str)</a>
<a class="sourceLine" id="cb877-14" title="14">    lig_com <span class="op">=</span> md.compute_center_of_mass(traj.atom_slice(lig_sel))</a>
<a class="sourceLine" id="cb877-15" title="15">    prot_com <span class="op">=</span> md.compute_center_of_mass(traj.atom_slice(traj.topology.select(<span class="st">&#39;protein&#39;</span>)))</a>
<a class="sourceLine" id="cb877-16" title="16">    result <span class="op">=</span> np.linalg.norm(lig_com<span class="op">-</span>prot_com,axis<span class="op">=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb877-17" title="17">    <span class="cf">return</span> result</a>
<a class="sourceLine" id="cb877-18" title="18"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb877-19" title="19"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb877-20" title="20"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb877-21" title="21"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb877-22" title="22"></a>
<a class="sourceLine" id="cb877-23" title="23"></a>
<a class="sourceLine" id="cb877-24" title="24"><span class="co">#_FILE_DIR_ = &#39;.&#39;</span></a>
<a class="sourceLine" id="cb877-25" title="25">lig_str <span class="op">=</span> <span class="st">&#39;TMP&#39;</span></a>
<a class="sourceLine" id="cb877-26" title="26">traj_path <span class="op">=</span> os.path.join(_FILE_DIR_, <span class="st">&#39;traj.dcd&#39;</span>) </a>
<a class="sourceLine" id="cb877-27" title="27">top_path <span class="op">=</span> os.path.join(_FILE_DIR_, <span class="st">&#39;top.pdb&#39;</span>)</a>
<a class="sourceLine" id="cb877-28" title="28">traj <span class="op">=</span> md.load(traj_path, top<span class="op">=</span>top_path)</a>
<a class="sourceLine" id="cb877-29" title="29">top <span class="op">=</span> traj.topology</a>
<a class="sourceLine" id="cb877-30" title="30">prot_idxs <span class="op">=</span> top.select(<span class="st">&#39;protein&#39;</span>)</a>
<a class="sourceLine" id="cb877-31" title="31">lig_idxs <span class="op">=</span> top.select(<span class="ss">F&#39;resname == </span><span class="sc">{</span>lig_str<span class="sc">}</span><span class="ss">&#39;</span>)</a>
<a class="sourceLine" id="cb877-32" title="32">traj2 <span class="op">=</span> md.load(traj_path, atom_indices<span class="op">=</span>prot_idxs, top<span class="op">=</span>top_path)</a>
<a class="sourceLine" id="cb877-33" title="33">traj3 <span class="op">=</span> md.load(traj_path, atom_indices<span class="op">=</span>lig_idxs, top<span class="op">=</span>top_path)</a>
<a class="sourceLine" id="cb877-34" title="34"></a>
<a class="sourceLine" id="cb877-35" title="35">dist <span class="op">=</span> []</a>
<a class="sourceLine" id="cb877-36" title="36"><span class="cf">for</span> i,j <span class="kw">in</span> <span class="bu">zip</span>(traj2,traj3):</a>
<a class="sourceLine" id="cb877-37" title="37">    com_a <span class="op">=</span> md.compute_center_of_mass(i)[<span class="dv">0</span>]</a>
<a class="sourceLine" id="cb877-38" title="38">    com_b <span class="op">=</span> md.compute_center_of_mass(j)[<span class="dv">0</span>]</a>
<a class="sourceLine" id="cb877-39" title="39">    dist.append(((com_a[<span class="dv">0</span>]<span class="op">-</span>com_b[<span class="dv">0</span>])<span class="op">**</span><span class="dv">2</span><span class="op">+</span>(com_a[<span class="dv">1</span>]<span class="op">-</span>com_b[<span class="dv">1</span>])<span class="op">**</span><span class="dv">2</span><span class="op">+</span>(com_a[<span class="dv">2</span>]<span class="op">-</span>com_b[<span class="dv">2</span>])<span class="op">**</span><span class="dv">2</span>)<span class="op">**</span><span class="fl">0.5</span>)</a>
<a class="sourceLine" id="cb877-40" title="40"></a>
<a class="sourceLine" id="cb877-41" title="41"><span class="co"># assert</span></a>
<a class="sourceLine" id="cb877-42" title="42"></a>
<a class="sourceLine" id="cb877-43" title="43">distances <span class="op">=</span> unbdistance(traj,lig_str)</a>
<a class="sourceLine" id="cb877-44" title="44"></a>
<a class="sourceLine" id="cb877-45" title="45">check <span class="op">=</span> math.isclose(dist[<span class="dv">0</span>],distances[<span class="dv">0</span>])</a>
<a class="sourceLine" id="cb877-46" title="46">check2 <span class="op">=</span> math.isclose(dist[<span class="op">-</span><span class="dv">1</span>],distances[<span class="op">-</span><span class="dv">1</span>])</a>
<a class="sourceLine" id="cb877-47" title="47">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> check <span class="kw">and</span> check2 <span class="cf">else</span> <span class="va">False</span> </a></code></pre></div>
<p>Output:</p>
<pre><code>&#39;Constant&#39; object has no attribute &#39;kind&#39;</code></pre>
<h4 id="run-4-79">Run 4</h4>
<div class="sourceCode" id="cb879"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb879-1" title="1"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb879-2" title="2"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb879-3" title="3"></a>
<a class="sourceLine" id="cb879-4" title="4"><span class="kw">def</span> unbdistance(traj,lig_str):</a>
<a class="sourceLine" id="cb879-5" title="5">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb879-6" title="6"><span class="co">    This function returns a list of distances between center of mass of</span></a>
<a class="sourceLine" id="cb879-7" title="7"><span class="co">    protein and center of mass of lig_str in every frame of trajectory</span></a>
<a class="sourceLine" id="cb879-8" title="8"><span class="co">    traj</span></a>
<a class="sourceLine" id="cb879-9" title="9"></a>
<a class="sourceLine" id="cb879-10" title="10"><span class="co">    traj is an mdtraj trajectory object</span></a>
<a class="sourceLine" id="cb879-11" title="11"><span class="co">    lig_str is a string with the residue name of the ligand</span></a>
<a class="sourceLine" id="cb879-12" title="12"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb879-13" title="13">    lig_idx <span class="op">=</span> traj.topology.select(<span class="st">&#39;resname &#39;</span><span class="op">+</span>lig_str)</a>
<a class="sourceLine" id="cb879-14" title="14">    protein_idx <span class="op">=</span> traj.topology.select(<span class="st">&#39;protein&#39;</span>)</a>
<a class="sourceLine" id="cb879-15" title="15">    lig_com <span class="op">=</span> md.compute_center_of_mass(traj.atom_slice(lig_idx))</a>
<a class="sourceLine" id="cb879-16" title="16">    protein_com <span class="op">=</span> md.compute_center_of_mass(traj.atom_slice(protein_idx))</a>
<a class="sourceLine" id="cb879-17" title="17">    result <span class="op">=</span> np.linalg.norm(lig_com <span class="op">-</span> protein_com,axis<span class="op">=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb879-18" title="18">    <span class="cf">return</span> result</a>
<a class="sourceLine" id="cb879-19" title="19"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb879-20" title="20"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb879-21" title="21"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb879-22" title="22"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb879-23" title="23"></a>
<a class="sourceLine" id="cb879-24" title="24"></a>
<a class="sourceLine" id="cb879-25" title="25"><span class="co">#_FILE_DIR_ = &#39;.&#39;</span></a>
<a class="sourceLine" id="cb879-26" title="26">lig_str <span class="op">=</span> <span class="st">&#39;TMP&#39;</span></a>
<a class="sourceLine" id="cb879-27" title="27">traj_path <span class="op">=</span> os.path.join(_FILE_DIR_, <span class="st">&#39;traj.dcd&#39;</span>) </a>
<a class="sourceLine" id="cb879-28" title="28">top_path <span class="op">=</span> os.path.join(_FILE_DIR_, <span class="st">&#39;top.pdb&#39;</span>)</a>
<a class="sourceLine" id="cb879-29" title="29">traj <span class="op">=</span> md.load(traj_path, top<span class="op">=</span>top_path)</a>
<a class="sourceLine" id="cb879-30" title="30">top <span class="op">=</span> traj.topology</a>
<a class="sourceLine" id="cb879-31" title="31">prot_idxs <span class="op">=</span> top.select(<span class="st">&#39;protein&#39;</span>)</a>
<a class="sourceLine" id="cb879-32" title="32">lig_idxs <span class="op">=</span> top.select(<span class="ss">F&#39;resname == </span><span class="sc">{</span>lig_str<span class="sc">}</span><span class="ss">&#39;</span>)</a>
<a class="sourceLine" id="cb879-33" title="33">traj2 <span class="op">=</span> md.load(traj_path, atom_indices<span class="op">=</span>prot_idxs, top<span class="op">=</span>top_path)</a>
<a class="sourceLine" id="cb879-34" title="34">traj3 <span class="op">=</span> md.load(traj_path, atom_indices<span class="op">=</span>lig_idxs, top<span class="op">=</span>top_path)</a>
<a class="sourceLine" id="cb879-35" title="35"></a>
<a class="sourceLine" id="cb879-36" title="36">dist <span class="op">=</span> []</a>
<a class="sourceLine" id="cb879-37" title="37"><span class="cf">for</span> i,j <span class="kw">in</span> <span class="bu">zip</span>(traj2,traj3):</a>
<a class="sourceLine" id="cb879-38" title="38">    com_a <span class="op">=</span> md.compute_center_of_mass(i)[<span class="dv">0</span>]</a>
<a class="sourceLine" id="cb879-39" title="39">    com_b <span class="op">=</span> md.compute_center_of_mass(j)[<span class="dv">0</span>]</a>
<a class="sourceLine" id="cb879-40" title="40">    dist.append(((com_a[<span class="dv">0</span>]<span class="op">-</span>com_b[<span class="dv">0</span>])<span class="op">**</span><span class="dv">2</span><span class="op">+</span>(com_a[<span class="dv">1</span>]<span class="op">-</span>com_b[<span class="dv">1</span>])<span class="op">**</span><span class="dv">2</span><span class="op">+</span>(com_a[<span class="dv">2</span>]<span class="op">-</span>com_b[<span class="dv">2</span>])<span class="op">**</span><span class="dv">2</span>)<span class="op">**</span><span class="fl">0.5</span>)</a>
<a class="sourceLine" id="cb879-41" title="41"></a>
<a class="sourceLine" id="cb879-42" title="42"><span class="co"># assert</span></a>
<a class="sourceLine" id="cb879-43" title="43"></a>
<a class="sourceLine" id="cb879-44" title="44">distances <span class="op">=</span> unbdistance(traj,lig_str)</a>
<a class="sourceLine" id="cb879-45" title="45"></a>
<a class="sourceLine" id="cb879-46" title="46">check <span class="op">=</span> math.isclose(dist[<span class="dv">0</span>],distances[<span class="dv">0</span>])</a>
<a class="sourceLine" id="cb879-47" title="47">check2 <span class="op">=</span> math.isclose(dist[<span class="op">-</span><span class="dv">1</span>],distances[<span class="op">-</span><span class="dv">1</span>])</a>
<a class="sourceLine" id="cb879-48" title="48">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> check <span class="kw">and</span> check2 <span class="cf">else</span> <span class="va">False</span> </a></code></pre></div>
<p>Output:</p>
<pre><code>&#39;Constant&#39; object has no attribute &#39;kind&#39;</code></pre>
</details>
<h2 id="test-report-1">Test Report</h2>
<h3 id="global-parameters-1">Global Parameters</h3>
<ul class="incremental">
<li>Engine = openai/code-cushman-001</li>
<li>T = 0.2</li>
</ul>
<h3 id="code-results-1">Code Results</h3>
<table>
<thead>
<tr class="header">
<th>Test</th>
<th>Run 0</th>
<th>Run 1</th>
<th>Run 2</th>
<th>Run 3</th>
<th>Run 4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>aa_polarity</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Fail</td>
<td>Fail</td>
</tr>
<tr class="even">
<td>adiabatic_expansion</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
</tr>
<tr class="odd">
<td>alignment</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Pass</td>
</tr>
<tr class="even">
<td>angle</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
</tr>
<tr class="odd">
<td>aromatic_aa</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
</tr>
<tr class="even">
<td>arrhenius</td>
<td>Pass</td>
<td>Fail</td>
<td>Pass</td>
<td>Pass</td>
<td>Fail</td>
</tr>
<tr class="odd">
<td>bimolecular</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
</tr>
<tr class="even">
<td>bb_rad</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
</tr>
<tr class="odd">
<td>blast</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
</tr>
<tr class="even">
<td>bravais</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Pass</td>
</tr>
<tr class="odd">
<td>canonicalize</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
</tr>
<tr class="even">
<td>carnot_efficiency</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
</tr>
<tr class="odd">
<td>claussius</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
</tr>
<tr class="even">
<td>compare_electronegativity</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
</tr>
<tr class="odd">
<td>condiff_1d</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
</tr>
<tr class="even">
<td>cubes</td>
<td>Fail</td>
<td>Fail</td>
<td>Pass</td>
<td>Pass</td>
<td>Fail</td>
</tr>
<tr class="odd">
<td>de_broglie</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
</tr>
<tr class="even">
<td>derivative1d-ch</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
</tr>
<tr class="odd">
<td>derivative_2deg</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
</tr>
<tr class="even">
<td>descriptors</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
</tr>
<tr class="odd">
<td>dipole</td>
<td>Pass</td>
<td>Pass</td>
<td>Fail</td>
<td>Pass</td>
<td>Pass</td>
</tr>
<tr class="even">
<td>dou</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
</tr>
<tr class="odd">
<td>eigen-ch</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
</tr>
<tr class="even">
<td>eigen</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
</tr>
<tr class="odd">
<td>element_mass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
</tr>
<tr class="even">
<td>element_name</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
</tr>
<tr class="odd">
<td>energy_of_e</td>
<td>Fail</td>
<td>Fail</td>
<td>Pass</td>
<td>Fail</td>
<td>Fail</td>
</tr>
<tr class="even">
<td>find_indices</td>
<td>Fail</td>
<td>Fail</td>
<td>Pass</td>
<td>Fail</td>
<td>Fail</td>
</tr>
<tr class="odd">
<td>force_constant</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
</tr>
<tr class="even">
<td>fourier_1d</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Fail</td>
<td>Pass</td>
</tr>
<tr class="odd">
<td>freezing_depression</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
</tr>
<tr class="even">
<td>genpos</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
</tr>
<tr class="odd">
<td>heating_water</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
</tr>
<tr class="even">
<td>hydrophobic_res</td>
<td>Fail</td>
<td>Pass</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
</tr>
<tr class="odd">
<td>ideal_gas</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
</tr>
<tr class="even">
<td>integral</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
</tr>
<tr class="odd">
<td>trap</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
</tr>
<tr class="even">
<td>invert_matrix</td>
<td>Pass</td>
<td>Fail</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
</tr>
<tr class="odd">
<td>iupac2smiles</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
</tr>
<tr class="even">
<td>kld</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
</tr>
<tr class="odd">
<td>langevin_dynamics</td>
<td>Pass</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
</tr>
<tr class="even">
<td>lipinski_rule_of_five</td>
<td>Pass</td>
<td>Fail</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
</tr>
<tr class="odd">
<td>mape</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Pass</td>
<td>Fail</td>
</tr>
<tr class="even">
<td>mapping_operator</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
</tr>
<tr class="odd">
<td>matpow</td>
<td>Fail</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
</tr>
<tr class="even">
<td>matrix_factorial</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
</tr>
<tr class="odd">
<td>max-boltz</td>
<td>Fail</td>
<td>Fail</td>
<td>Pass</td>
<td>Pass</td>
<td>Fail</td>
</tr>
<tr class="even">
<td>michaelis</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
</tr>
<tr class="odd">
<td>mol_charge</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Fail</td>
</tr>
<tr class="even">
<td>net_charge</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
</tr>
<tr class="odd">
<td>solve_ode</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
</tr>
<tr class="even">
<td>ohe</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
</tr>
<tr class="odd">
<td>osmotic_pressure</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
</tr>
<tr class="even">
<td>pair_wise</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
</tr>
<tr class="odd">
<td>pi</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
</tr>
<tr class="even">
<td>pib_1d</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
</tr>
<tr class="odd">
<td>pred_interval</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
</tr>
<tr class="even">
<td>pubchem</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
</tr>
<tr class="odd">
<td>pyscf_energy</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
</tr>
<tr class="even">
<td>qed</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
</tr>
<tr class="odd">
<td>quantile</td>
<td>Pass</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
</tr>
<tr class="even">
<td>random_walk</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Fail</td>
<td>Pass</td>
</tr>
<tr class="odd">
<td>rank</td>
<td>Pass</td>
<td>Fail</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
</tr>
<tr class="even">
<td>rank</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
</tr>
<tr class="odd">
<td>remove-water</td>
<td>Pass</td>
<td>Pass</td>
<td>Fail</td>
<td>Pass</td>
<td>Pass</td>
</tr>
<tr class="even">
<td>rms_velocity</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
</tr>
<tr class="odd">
<td>rmse</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
</tr>
<tr class="even">
<td>rog</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
</tr>
<tr class="odd">
<td>sasa</td>
<td>Fail</td>
<td>Fail</td>
<td>Pass</td>
<td>Fail</td>
<td>Pass</td>
</tr>
<tr class="even">
<td>scaffold</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
</tr>
<tr class="odd">
<td>seq-align</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Fail</td>
</tr>
<tr class="even">
<td>seq-trans</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
</tr>
<tr class="odd">
<td>sequence</td>
<td>Fail</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
</tr>
<tr class="even">
<td>sle</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
</tr>
<tr class="odd">
<td>spectral_r</td>
<td>Fail</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
</tr>
<tr class="even">
<td>find_peaks</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
</tr>
<tr class="odd">
<td>speed_of_sound</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
</tr>
<tr class="even">
<td>substructure</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
</tr>
<tr class="odd">
<td>tanimoto</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Fail</td>
<td>Fail</td>
</tr>
<tr class="even">
<td>unbdistance</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
<td>Fail</td>
</tr>
</tbody>
</table>
<h3 id="details-1">Details</h3>
<details>
<p><summary>aa_polarity</summary></p>
<h4 id="query-80">Query</h4>
<div class="sourceCode" id="cb881"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb881-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb881-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb881-3" title="3"></a>
<a class="sourceLine" id="cb881-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb881-5" title="5"><span class="co">compute sin(pi/2)</span></a>
<a class="sourceLine" id="cb881-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb881-7" title="7">x <span class="op">=</span> math.sin(math.pi <span class="op">/</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb881-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb881-9" title="9"></a>
<a class="sourceLine" id="cb881-10" title="10"><span class="kw">def</span> polar_count(sequence):</a>
<a class="sourceLine" id="cb881-11" title="11">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb881-12" title="12"><span class="co">    This function counts the number of polar uncharged amino acids in the given sequence</span></a>
<a class="sourceLine" id="cb881-13" title="13"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb881-14" title="14">    </a></code></pre></div>
<h4 id="run-0-80">Run 0</h4>
<div class="sourceCode" id="cb882"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb882-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb882-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb882-3" title="3"></a>
<a class="sourceLine" id="cb882-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb882-5" title="5"><span class="co">compute sin(pi/2)</span></a>
<a class="sourceLine" id="cb882-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb882-7" title="7">x <span class="op">=</span> math.sin(math.pi <span class="op">/</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb882-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb882-9" title="9"></a>
<a class="sourceLine" id="cb882-10" title="10"><span class="kw">def</span> polar_count(sequence):</a>
<a class="sourceLine" id="cb882-11" title="11">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb882-12" title="12"><span class="co">    This function counts the number of polar uncharged amino acids in the given sequence</span></a>
<a class="sourceLine" id="cb882-13" title="13"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb882-14" title="14">    polar_count <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb882-15" title="15">    <span class="cf">for</span> aa <span class="kw">in</span> sequence:</a>
<a class="sourceLine" id="cb882-16" title="16">        <span class="cf">if</span> aa <span class="kw">in</span> [<span class="st">&quot;Q&quot;</span>, <span class="st">&quot;N&quot;</span>, <span class="st">&quot;H&quot;</span>, <span class="st">&quot;S&quot;</span>, <span class="st">&quot;T&quot;</span>, <span class="st">&quot;Y&quot;</span>, <span class="st">&quot;C&quot;</span>, <span class="st">&quot;M&quot;</span>]:</a>
<a class="sourceLine" id="cb882-17" title="17">            polar_count <span class="op">+=</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb882-18" title="18">    <span class="cf">return</span> polar_count</a>
<a class="sourceLine" id="cb882-19" title="19"></a>
<a class="sourceLine" id="cb882-20" title="20"></a>
<a class="sourceLine" id="cb882-21" title="21">sample_sequence <span class="op">=</span> <span class="st">&quot;AAAATTVVVVPPPSREREPPII&quot;</span></a>
<a class="sourceLine" id="cb882-22" title="22"></a>
<a class="sourceLine" id="cb882-23" title="23">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> polar_count(sample_sequence) <span class="op">==</span> <span class="dv">3</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-80">Run 1</h4>
<div class="sourceCode" id="cb884"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb884-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb884-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb884-3" title="3"></a>
<a class="sourceLine" id="cb884-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb884-5" title="5"><span class="co">compute sin(pi/2)</span></a>
<a class="sourceLine" id="cb884-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb884-7" title="7">x <span class="op">=</span> math.sin(math.pi <span class="op">/</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb884-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb884-9" title="9"></a>
<a class="sourceLine" id="cb884-10" title="10"><span class="kw">def</span> polar_count(sequence):</a>
<a class="sourceLine" id="cb884-11" title="11">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb884-12" title="12"><span class="co">    This function counts the number of polar uncharged amino acids in the given sequence</span></a>
<a class="sourceLine" id="cb884-13" title="13"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb884-14" title="14">    polar_count <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb884-15" title="15">    <span class="cf">for</span> aa <span class="kw">in</span> sequence:</a>
<a class="sourceLine" id="cb884-16" title="16">        <span class="cf">if</span> aa <span class="kw">in</span> [<span class="st">&#39;S&#39;</span>, <span class="st">&#39;T&#39;</span>, <span class="st">&#39;N&#39;</span>, <span class="st">&#39;Q&#39;</span>]:</a>
<a class="sourceLine" id="cb884-17" title="17">            polar_count <span class="op">+=</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb884-18" title="18">    <span class="cf">return</span> polar_count</a>
<a class="sourceLine" id="cb884-19" title="19"></a>
<a class="sourceLine" id="cb884-20" title="20"></a>
<a class="sourceLine" id="cb884-21" title="21">sample_sequence <span class="op">=</span> <span class="st">&quot;AAAATTVVVVPPPSREREPPII&quot;</span></a>
<a class="sourceLine" id="cb884-22" title="22"></a>
<a class="sourceLine" id="cb884-23" title="23">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> polar_count(sample_sequence) <span class="op">==</span> <span class="dv">3</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-80">Run 2</h4>
<div class="sourceCode" id="cb886"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb886-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb886-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb886-3" title="3"></a>
<a class="sourceLine" id="cb886-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb886-5" title="5"><span class="co">compute sin(pi/2)</span></a>
<a class="sourceLine" id="cb886-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb886-7" title="7">x <span class="op">=</span> math.sin(math.pi <span class="op">/</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb886-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb886-9" title="9"></a>
<a class="sourceLine" id="cb886-10" title="10"><span class="kw">def</span> polar_count(sequence):</a>
<a class="sourceLine" id="cb886-11" title="11">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb886-12" title="12"><span class="co">    This function counts the number of polar uncharged amino acids in the given sequence</span></a>
<a class="sourceLine" id="cb886-13" title="13"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb886-14" title="14">    polar_count <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb886-15" title="15">    <span class="cf">for</span> aa <span class="kw">in</span> sequence:</a>
<a class="sourceLine" id="cb886-16" title="16">        <span class="cf">if</span> aa <span class="kw">in</span> [<span class="st">&#39;S&#39;</span>, <span class="st">&#39;T&#39;</span>, <span class="st">&#39;N&#39;</span>, <span class="st">&#39;Q&#39;</span>]:</a>
<a class="sourceLine" id="cb886-17" title="17">            polar_count <span class="op">+=</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb886-18" title="18">    <span class="cf">return</span> polar_count</a>
<a class="sourceLine" id="cb886-19" title="19"></a>
<a class="sourceLine" id="cb886-20" title="20"></a>
<a class="sourceLine" id="cb886-21" title="21">sample_sequence <span class="op">=</span> <span class="st">&quot;AAAATTVVVVPPPSREREPPII&quot;</span></a>
<a class="sourceLine" id="cb886-22" title="22"></a>
<a class="sourceLine" id="cb886-23" title="23">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> polar_count(sample_sequence) <span class="op">==</span> <span class="dv">3</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-80">Run 3</h4>
<div class="sourceCode" id="cb888"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb888-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb888-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb888-3" title="3"></a>
<a class="sourceLine" id="cb888-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb888-5" title="5"><span class="co">compute sin(pi/2)</span></a>
<a class="sourceLine" id="cb888-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb888-7" title="7">x <span class="op">=</span> math.sin(math.pi <span class="op">/</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb888-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb888-9" title="9"></a>
<a class="sourceLine" id="cb888-10" title="10"><span class="kw">def</span> polar_count(sequence):</a>
<a class="sourceLine" id="cb888-11" title="11">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb888-12" title="12"><span class="co">    This function counts the number of polar uncharged amino acids in the given sequence</span></a>
<a class="sourceLine" id="cb888-13" title="13"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb888-14" title="14">    polar_count <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb888-15" title="15">    <span class="cf">for</span> aa <span class="kw">in</span> sequence:</a>
<a class="sourceLine" id="cb888-16" title="16">        <span class="cf">if</span> aa <span class="kw">in</span> [<span class="st">&#39;S&#39;</span>, <span class="st">&#39;T&#39;</span>, <span class="st">&#39;N&#39;</span>, <span class="st">&#39;Q&#39;</span>, <span class="st">&#39;H&#39;</span>, <span class="st">&#39;K&#39;</span>, <span class="st">&#39;R&#39;</span>]:</a>
<a class="sourceLine" id="cb888-17" title="17">            polar_count <span class="op">+=</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb888-18" title="18">    <span class="cf">return</span> polar_count</a>
<a class="sourceLine" id="cb888-19" title="19"></a>
<a class="sourceLine" id="cb888-20" title="20"></a>
<a class="sourceLine" id="cb888-21" title="21">sample_sequence <span class="op">=</span> <span class="st">&quot;AAAATTVVVVPPPSREREPPII&quot;</span></a>
<a class="sourceLine" id="cb888-22" title="22"></a>
<a class="sourceLine" id="cb888-23" title="23">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> polar_count(sample_sequence) <span class="op">==</span> <span class="dv">3</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-80">Run 4</h4>
<div class="sourceCode" id="cb890"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb890-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb890-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb890-3" title="3"></a>
<a class="sourceLine" id="cb890-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb890-5" title="5"><span class="co">compute sin(pi/2)</span></a>
<a class="sourceLine" id="cb890-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb890-7" title="7">x <span class="op">=</span> math.sin(math.pi <span class="op">/</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb890-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb890-9" title="9"></a>
<a class="sourceLine" id="cb890-10" title="10"><span class="kw">def</span> polar_count(sequence):</a>
<a class="sourceLine" id="cb890-11" title="11">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb890-12" title="12"><span class="co">    This function counts the number of polar uncharged amino acids in the given sequence</span></a>
<a class="sourceLine" id="cb890-13" title="13"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb890-14" title="14">    polar_count <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb890-15" title="15">    <span class="cf">for</span> amino_acid <span class="kw">in</span> sequence:</a>
<a class="sourceLine" id="cb890-16" title="16">        <span class="cf">if</span> amino_acid <span class="kw">in</span> [<span class="st">&#39;R&#39;</span>, <span class="st">&#39;K&#39;</span>, <span class="st">&#39;D&#39;</span>, <span class="st">&#39;E&#39;</span>, <span class="st">&#39;Q&#39;</span>, <span class="st">&#39;N&#39;</span>, <span class="st">&#39;H&#39;</span>, <span class="st">&#39;S&#39;</span>, <span class="st">&#39;T&#39;</span>, <span class="st">&#39;Y&#39;</span>]:</a>
<a class="sourceLine" id="cb890-17" title="17">            polar_count <span class="op">+=</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb890-18" title="18">    <span class="cf">return</span> polar_count</a>
<a class="sourceLine" id="cb890-19" title="19"></a>
<a class="sourceLine" id="cb890-20" title="20"></a>
<a class="sourceLine" id="cb890-21" title="21">sample_sequence <span class="op">=</span> <span class="st">&quot;AAAATTVVVVPPPSREREPPII&quot;</span></a>
<a class="sourceLine" id="cb890-22" title="22"></a>
<a class="sourceLine" id="cb890-23" title="23">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> polar_count(sample_sequence) <span class="op">==</span> <span class="dv">3</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>adiabatic_expansion</summary></p>
<h4 id="query-81">Query</h4>
<div class="sourceCode" id="cb892"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb892-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb892-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb892-3" title="3"></a>
<a class="sourceLine" id="cb892-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb892-5" title="5"><span class="co">compute sin(pi/2)</span></a>
<a class="sourceLine" id="cb892-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb892-7" title="7">x <span class="op">=</span> math.sin(math.pi <span class="op">/</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb892-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb892-9" title="9"></a>
<a class="sourceLine" id="cb892-10" title="10"><span class="kw">def</span> cooling(T1,P1,P2,gamma):</a>
<a class="sourceLine" id="cb892-11" title="11">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb892-12" title="12"><span class="co">   This function returns the temperature of an ideal gas expanding adiabatically from P1 to P2</span></a>
<a class="sourceLine" id="cb892-13" title="13"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb892-14" title="14">   </a></code></pre></div>
<h4 id="run-0-81">Run 0</h4>
<div class="sourceCode" id="cb893"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb893-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb893-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb893-3" title="3"></a>
<a class="sourceLine" id="cb893-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb893-5" title="5"><span class="co">compute sin(pi/2)</span></a>
<a class="sourceLine" id="cb893-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb893-7" title="7">x <span class="op">=</span> math.sin(math.pi <span class="op">/</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb893-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb893-9" title="9"></a>
<a class="sourceLine" id="cb893-10" title="10"><span class="kw">def</span> cooling(T1,P1,P2,gamma):</a>
<a class="sourceLine" id="cb893-11" title="11">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb893-12" title="12"><span class="co">   This function returns the temperature of an ideal gas expanding adiabatically from P1 to P2</span></a>
<a class="sourceLine" id="cb893-13" title="13"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb893-14" title="14">   T2 <span class="op">=</span> T1 <span class="op">*</span> (P2 <span class="op">/</span> P1)<span class="op">**</span>((gamma <span class="op">-</span> <span class="dv">1</span>) <span class="op">/</span> gamma)</a>
<a class="sourceLine" id="cb893-15" title="15">   <span class="cf">return</span> T2</a>
<a class="sourceLine" id="cb893-16" title="16"></a>
<a class="sourceLine" id="cb893-17" title="17"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb893-18" title="18">P1 <span class="op">=</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb893-19" title="19">P2 <span class="op">=</span> <span class="dv">2</span></a>
<a class="sourceLine" id="cb893-20" title="20">T1 <span class="op">=</span> <span class="dv">300</span></a>
<a class="sourceLine" id="cb893-21" title="21">gamma <span class="op">=</span> <span class="dv">5</span><span class="op">/</span><span class="dv">3</span></a>
<a class="sourceLine" id="cb893-22" title="22"></a>
<a class="sourceLine" id="cb893-23" title="23">T2 <span class="op">=</span> T1<span class="op">*</span>((P2<span class="op">/</span>P1)<span class="op">**</span>((gamma<span class="dv">-1</span>)<span class="op">/</span>gamma))</a>
<a class="sourceLine" id="cb893-24" title="24"></a>
<a class="sourceLine" id="cb893-25" title="25">T2_codex <span class="op">=</span> cooling(T1, P1, P2, gamma)</a>
<a class="sourceLine" id="cb893-26" title="26"></a>
<a class="sourceLine" id="cb893-27" title="27"><span class="co"># check </span></a>
<a class="sourceLine" id="cb893-28" title="28"><span class="cf">if</span> np.isclose(T2, T2_codex, rtol<span class="op">=</span><span class="fl">0.01</span>) <span class="op">==</span> <span class="va">True</span>:</a>
<a class="sourceLine" id="cb893-29" title="29">    result <span class="op">=</span> <span class="va">True</span> </a>
<a class="sourceLine" id="cb893-30" title="30"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb893-31" title="31">    result <span class="op">=</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-81">Run 1</h4>
<div class="sourceCode" id="cb895"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb895-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb895-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb895-3" title="3"></a>
<a class="sourceLine" id="cb895-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb895-5" title="5"><span class="co">compute sin(pi/2)</span></a>
<a class="sourceLine" id="cb895-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb895-7" title="7">x <span class="op">=</span> math.sin(math.pi <span class="op">/</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb895-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb895-9" title="9"></a>
<a class="sourceLine" id="cb895-10" title="10"><span class="kw">def</span> cooling(T1,P1,P2,gamma):</a>
<a class="sourceLine" id="cb895-11" title="11">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb895-12" title="12"><span class="co">   This function returns the temperature of an ideal gas expanding adiabatically from P1 to P2</span></a>
<a class="sourceLine" id="cb895-13" title="13"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb895-14" title="14">   T2 <span class="op">=</span> T1 <span class="op">*</span> (P2<span class="op">/</span>P1)<span class="op">**</span>((gamma<span class="dv">-1</span>)<span class="op">/</span>gamma)</a>
<a class="sourceLine" id="cb895-15" title="15">   <span class="cf">return</span> T2</a>
<a class="sourceLine" id="cb895-16" title="16"></a>
<a class="sourceLine" id="cb895-17" title="17"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb895-18" title="18">P1 <span class="op">=</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb895-19" title="19">P2 <span class="op">=</span> <span class="dv">2</span></a>
<a class="sourceLine" id="cb895-20" title="20">T1 <span class="op">=</span> <span class="dv">300</span></a>
<a class="sourceLine" id="cb895-21" title="21">gamma <span class="op">=</span> <span class="dv">5</span><span class="op">/</span><span class="dv">3</span></a>
<a class="sourceLine" id="cb895-22" title="22"></a>
<a class="sourceLine" id="cb895-23" title="23">T2 <span class="op">=</span> T1<span class="op">*</span>((P2<span class="op">/</span>P1)<span class="op">**</span>((gamma<span class="dv">-1</span>)<span class="op">/</span>gamma))</a>
<a class="sourceLine" id="cb895-24" title="24"></a>
<a class="sourceLine" id="cb895-25" title="25">T2_codex <span class="op">=</span> cooling(T1, P1, P2, gamma)</a>
<a class="sourceLine" id="cb895-26" title="26"></a>
<a class="sourceLine" id="cb895-27" title="27"><span class="co"># check </span></a>
<a class="sourceLine" id="cb895-28" title="28"><span class="cf">if</span> np.isclose(T2, T2_codex, rtol<span class="op">=</span><span class="fl">0.01</span>) <span class="op">==</span> <span class="va">True</span>:</a>
<a class="sourceLine" id="cb895-29" title="29">    result <span class="op">=</span> <span class="va">True</span> </a>
<a class="sourceLine" id="cb895-30" title="30"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb895-31" title="31">    result <span class="op">=</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-81">Run 2</h4>
<div class="sourceCode" id="cb897"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb897-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb897-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb897-3" title="3"></a>
<a class="sourceLine" id="cb897-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb897-5" title="5"><span class="co">compute sin(pi/2)</span></a>
<a class="sourceLine" id="cb897-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb897-7" title="7">x <span class="op">=</span> math.sin(math.pi <span class="op">/</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb897-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb897-9" title="9"></a>
<a class="sourceLine" id="cb897-10" title="10"><span class="kw">def</span> cooling(T1,P1,P2,gamma):</a>
<a class="sourceLine" id="cb897-11" title="11">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb897-12" title="12"><span class="co">   This function returns the temperature of an ideal gas expanding adiabatically from P1 to P2</span></a>
<a class="sourceLine" id="cb897-13" title="13"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb897-14" title="14">   T2 <span class="op">=</span> T1 <span class="op">*</span> (P2<span class="op">/</span>P1)<span class="op">**</span>((gamma<span class="dv">-1</span>)<span class="op">/</span>gamma)</a>
<a class="sourceLine" id="cb897-15" title="15">   <span class="cf">return</span> T2</a>
<a class="sourceLine" id="cb897-16" title="16"></a>
<a class="sourceLine" id="cb897-17" title="17"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb897-18" title="18">P1 <span class="op">=</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb897-19" title="19">P2 <span class="op">=</span> <span class="dv">2</span></a>
<a class="sourceLine" id="cb897-20" title="20">T1 <span class="op">=</span> <span class="dv">300</span></a>
<a class="sourceLine" id="cb897-21" title="21">gamma <span class="op">=</span> <span class="dv">5</span><span class="op">/</span><span class="dv">3</span></a>
<a class="sourceLine" id="cb897-22" title="22"></a>
<a class="sourceLine" id="cb897-23" title="23">T2 <span class="op">=</span> T1<span class="op">*</span>((P2<span class="op">/</span>P1)<span class="op">**</span>((gamma<span class="dv">-1</span>)<span class="op">/</span>gamma))</a>
<a class="sourceLine" id="cb897-24" title="24"></a>
<a class="sourceLine" id="cb897-25" title="25">T2_codex <span class="op">=</span> cooling(T1, P1, P2, gamma)</a>
<a class="sourceLine" id="cb897-26" title="26"></a>
<a class="sourceLine" id="cb897-27" title="27"><span class="co"># check </span></a>
<a class="sourceLine" id="cb897-28" title="28"><span class="cf">if</span> np.isclose(T2, T2_codex, rtol<span class="op">=</span><span class="fl">0.01</span>) <span class="op">==</span> <span class="va">True</span>:</a>
<a class="sourceLine" id="cb897-29" title="29">    result <span class="op">=</span> <span class="va">True</span> </a>
<a class="sourceLine" id="cb897-30" title="30"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb897-31" title="31">    result <span class="op">=</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-81">Run 3</h4>
<div class="sourceCode" id="cb899"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb899-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb899-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb899-3" title="3"></a>
<a class="sourceLine" id="cb899-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb899-5" title="5"><span class="co">compute sin(pi/2)</span></a>
<a class="sourceLine" id="cb899-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb899-7" title="7">x <span class="op">=</span> math.sin(math.pi <span class="op">/</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb899-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb899-9" title="9"></a>
<a class="sourceLine" id="cb899-10" title="10"><span class="kw">def</span> cooling(T1,P1,P2,gamma):</a>
<a class="sourceLine" id="cb899-11" title="11">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb899-12" title="12"><span class="co">   This function returns the temperature of an ideal gas expanding adiabatically from P1 to P2</span></a>
<a class="sourceLine" id="cb899-13" title="13"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb899-14" title="14">   T2 <span class="op">=</span> T1 <span class="op">*</span> (P2<span class="op">/</span>P1)<span class="op">**</span>((gamma <span class="op">-</span> <span class="dv">1</span>)<span class="op">/</span>gamma)</a>
<a class="sourceLine" id="cb899-15" title="15">   <span class="cf">return</span> T2</a>
<a class="sourceLine" id="cb899-16" title="16"></a>
<a class="sourceLine" id="cb899-17" title="17"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb899-18" title="18">P1 <span class="op">=</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb899-19" title="19">P2 <span class="op">=</span> <span class="dv">2</span></a>
<a class="sourceLine" id="cb899-20" title="20">T1 <span class="op">=</span> <span class="dv">300</span></a>
<a class="sourceLine" id="cb899-21" title="21">gamma <span class="op">=</span> <span class="dv">5</span><span class="op">/</span><span class="dv">3</span></a>
<a class="sourceLine" id="cb899-22" title="22"></a>
<a class="sourceLine" id="cb899-23" title="23">T2 <span class="op">=</span> T1<span class="op">*</span>((P2<span class="op">/</span>P1)<span class="op">**</span>((gamma<span class="dv">-1</span>)<span class="op">/</span>gamma))</a>
<a class="sourceLine" id="cb899-24" title="24"></a>
<a class="sourceLine" id="cb899-25" title="25">T2_codex <span class="op">=</span> cooling(T1, P1, P2, gamma)</a>
<a class="sourceLine" id="cb899-26" title="26"></a>
<a class="sourceLine" id="cb899-27" title="27"><span class="co"># check </span></a>
<a class="sourceLine" id="cb899-28" title="28"><span class="cf">if</span> np.isclose(T2, T2_codex, rtol<span class="op">=</span><span class="fl">0.01</span>) <span class="op">==</span> <span class="va">True</span>:</a>
<a class="sourceLine" id="cb899-29" title="29">    result <span class="op">=</span> <span class="va">True</span> </a>
<a class="sourceLine" id="cb899-30" title="30"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb899-31" title="31">    result <span class="op">=</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-81">Run 4</h4>
<div class="sourceCode" id="cb901"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb901-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb901-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb901-3" title="3"></a>
<a class="sourceLine" id="cb901-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb901-5" title="5"><span class="co">compute sin(pi/2)</span></a>
<a class="sourceLine" id="cb901-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb901-7" title="7">x <span class="op">=</span> math.sin(math.pi <span class="op">/</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb901-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb901-9" title="9"></a>
<a class="sourceLine" id="cb901-10" title="10"><span class="kw">def</span> cooling(T1,P1,P2,gamma):</a>
<a class="sourceLine" id="cb901-11" title="11">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb901-12" title="12"><span class="co">   This function returns the temperature of an ideal gas expanding adiabatically from P1 to P2</span></a>
<a class="sourceLine" id="cb901-13" title="13"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb901-14" title="14">   T2 <span class="op">=</span> T1 <span class="op">*</span> (P2 <span class="op">/</span> P1)<span class="op">**</span>((gamma <span class="op">-</span> <span class="dv">1</span>) <span class="op">/</span> gamma)</a>
<a class="sourceLine" id="cb901-15" title="15">   <span class="cf">return</span> T2</a>
<a class="sourceLine" id="cb901-16" title="16"></a>
<a class="sourceLine" id="cb901-17" title="17"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb901-18" title="18">P1 <span class="op">=</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb901-19" title="19">P2 <span class="op">=</span> <span class="dv">2</span></a>
<a class="sourceLine" id="cb901-20" title="20">T1 <span class="op">=</span> <span class="dv">300</span></a>
<a class="sourceLine" id="cb901-21" title="21">gamma <span class="op">=</span> <span class="dv">5</span><span class="op">/</span><span class="dv">3</span></a>
<a class="sourceLine" id="cb901-22" title="22"></a>
<a class="sourceLine" id="cb901-23" title="23">T2 <span class="op">=</span> T1<span class="op">*</span>((P2<span class="op">/</span>P1)<span class="op">**</span>((gamma<span class="dv">-1</span>)<span class="op">/</span>gamma))</a>
<a class="sourceLine" id="cb901-24" title="24"></a>
<a class="sourceLine" id="cb901-25" title="25">T2_codex <span class="op">=</span> cooling(T1, P1, P2, gamma)</a>
<a class="sourceLine" id="cb901-26" title="26"></a>
<a class="sourceLine" id="cb901-27" title="27"><span class="co"># check </span></a>
<a class="sourceLine" id="cb901-28" title="28"><span class="cf">if</span> np.isclose(T2, T2_codex, rtol<span class="op">=</span><span class="fl">0.01</span>) <span class="op">==</span> <span class="va">True</span>:</a>
<a class="sourceLine" id="cb901-29" title="29">    result <span class="op">=</span> <span class="va">True</span> </a>
<a class="sourceLine" id="cb901-30" title="30"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb901-31" title="31">    result <span class="op">=</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>alignment</summary></p>
<h4 id="query-82">Query</h4>
<div class="sourceCode" id="cb903"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb903-1" title="1"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb903-2" title="2"></a>
<a class="sourceLine" id="cb903-3" title="3"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb903-4" title="4"><span class="co">Print version string</span></a>
<a class="sourceLine" id="cb903-5" title="5"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb903-6" title="6"><span class="bu">print</span>(md.version.full_version)</a>
<a class="sourceLine" id="cb903-7" title="7"><span class="co"># end</span></a>
<a class="sourceLine" id="cb903-8" title="8"></a>
<a class="sourceLine" id="cb903-9" title="9"><span class="kw">def</span> align_traj(traj, frame_index):</a>
<a class="sourceLine" id="cb903-10" title="10">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb903-11" title="11"><span class="co">  This function aligns the given mdtraj trajectory to a specific frame</span></a>
<a class="sourceLine" id="cb903-12" title="12"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb903-13" title="13">  </a></code></pre></div>
<h4 id="run-0-82">Run 0</h4>
<div class="sourceCode" id="cb904"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb904-1" title="1"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb904-2" title="2"></a>
<a class="sourceLine" id="cb904-3" title="3"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb904-4" title="4"><span class="co">Print version string</span></a>
<a class="sourceLine" id="cb904-5" title="5"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb904-6" title="6"><span class="bu">print</span>(md.version.full_version)</a>
<a class="sourceLine" id="cb904-7" title="7"><span class="co"># end</span></a>
<a class="sourceLine" id="cb904-8" title="8"></a>
<a class="sourceLine" id="cb904-9" title="9"><span class="kw">def</span> align_traj(traj, frame_index):</a>
<a class="sourceLine" id="cb904-10" title="10">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb904-11" title="11"><span class="co">  This function aligns the given mdtraj trajectory to a specific frame</span></a>
<a class="sourceLine" id="cb904-12" title="12"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb904-13" title="13">  <span class="co"># align to frame</span></a>
<a class="sourceLine" id="cb904-14" title="14">  traj.superpose(traj, frame<span class="op">=</span>frame_index)</a>
<a class="sourceLine" id="cb904-15" title="15">  </a>
<a class="sourceLine" id="cb904-16" title="16"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb904-17" title="17"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb904-18" title="18"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb904-19" title="19"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb904-20" title="20"></a>
<a class="sourceLine" id="cb904-21" title="21">pdb_file <span class="op">=</span> os.path.join(_FILE_DIR_, <span class="st">&quot;1VII_twoframe_shifted.pdb&quot;</span>)</a>
<a class="sourceLine" id="cb904-22" title="22">trj <span class="op">=</span> md.load(pdb_file)</a>
<a class="sourceLine" id="cb904-23" title="23"></a>
<a class="sourceLine" id="cb904-24" title="24"></a>
<a class="sourceLine" id="cb904-25" title="25"><span class="kw">def</span> myrmsd(trj, frame):</a>
<a class="sourceLine" id="cb904-26" title="26">    xyz <span class="op">=</span> trj.xyz</a>
<a class="sourceLine" id="cb904-27" title="27">    xyz0 <span class="op">=</span> trj.xyz[frame]</a>
<a class="sourceLine" id="cb904-28" title="28">    dx <span class="op">=</span> xyz<span class="op">-</span>xyz0</a>
<a class="sourceLine" id="cb904-29" title="29">    dx2 <span class="op">=</span> (dx<span class="op">*</span>dx).<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb904-30" title="30">    rmsd <span class="op">=</span> np.sqrt(dx2.mean(axis<span class="op">=</span><span class="dv">1</span>))</a>
<a class="sourceLine" id="cb904-31" title="31">    <span class="cf">return</span> rmsd</a>
<a class="sourceLine" id="cb904-32" title="32"></a>
<a class="sourceLine" id="cb904-33" title="33"></a>
<a class="sourceLine" id="cb904-34" title="34"><span class="co">#print(&quot;Starting rmsd:&quot;, myrmsd(trj, 0))</span></a>
<a class="sourceLine" id="cb904-35" title="35">aligned_trj <span class="op">=</span> trj.superpose(trj, <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb904-36" title="36"></a>
<a class="sourceLine" id="cb904-37" title="37">my_rmsd <span class="op">=</span> myrmsd(aligned_trj, <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb904-38" title="38"><span class="co">#print(&quot;Aligned rmsd:&quot;, my_rmsd)</span></a>
<a class="sourceLine" id="cb904-39" title="39"></a>
<a class="sourceLine" id="cb904-40" title="40">nlcc_trj <span class="op">=</span> align_traj(trj, <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb904-41" title="41">nlcc_rmsd <span class="op">=</span> myrmsd(nlcc_trj, <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb904-42" title="42"></a>
<a class="sourceLine" id="cb904-43" title="43"><span class="co">#print(&quot;nlcc rmsd&quot;, nlcc_rmsd)</span></a>
<a class="sourceLine" id="cb904-44" title="44"></a>
<a class="sourceLine" id="cb904-45" title="45">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">all</span>(np.<span class="bu">abs</span>(my_rmsd <span class="op">-</span> nlcc_rmsd)) <span class="op">&lt;</span> <span class="fl">0.01</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>&#39;NoneType&#39; object has no attribute &#39;xyz&#39;</code></pre>
<h4 id="run-1-82">Run 1</h4>
<div class="sourceCode" id="cb906"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb906-1" title="1"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb906-2" title="2"></a>
<a class="sourceLine" id="cb906-3" title="3"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb906-4" title="4"><span class="co">Print version string</span></a>
<a class="sourceLine" id="cb906-5" title="5"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb906-6" title="6"><span class="bu">print</span>(md.version.full_version)</a>
<a class="sourceLine" id="cb906-7" title="7"><span class="co"># end</span></a>
<a class="sourceLine" id="cb906-8" title="8"></a>
<a class="sourceLine" id="cb906-9" title="9"><span class="kw">def</span> align_traj(traj, frame_index):</a>
<a class="sourceLine" id="cb906-10" title="10">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb906-11" title="11"><span class="co">  This function aligns the given mdtraj trajectory to a specific frame</span></a>
<a class="sourceLine" id="cb906-12" title="12"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb906-13" title="13">  <span class="co"># align to the first frame</span></a>
<a class="sourceLine" id="cb906-14" title="14">  traj.superpose(traj, frame<span class="op">=</span>frame_index)</a>
<a class="sourceLine" id="cb906-15" title="15">  </a>
<a class="sourceLine" id="cb906-16" title="16"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb906-17" title="17"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb906-18" title="18"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb906-19" title="19"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb906-20" title="20"></a>
<a class="sourceLine" id="cb906-21" title="21">pdb_file <span class="op">=</span> os.path.join(_FILE_DIR_, <span class="st">&quot;1VII_twoframe_shifted.pdb&quot;</span>)</a>
<a class="sourceLine" id="cb906-22" title="22">trj <span class="op">=</span> md.load(pdb_file)</a>
<a class="sourceLine" id="cb906-23" title="23"></a>
<a class="sourceLine" id="cb906-24" title="24"></a>
<a class="sourceLine" id="cb906-25" title="25"><span class="kw">def</span> myrmsd(trj, frame):</a>
<a class="sourceLine" id="cb906-26" title="26">    xyz <span class="op">=</span> trj.xyz</a>
<a class="sourceLine" id="cb906-27" title="27">    xyz0 <span class="op">=</span> trj.xyz[frame]</a>
<a class="sourceLine" id="cb906-28" title="28">    dx <span class="op">=</span> xyz<span class="op">-</span>xyz0</a>
<a class="sourceLine" id="cb906-29" title="29">    dx2 <span class="op">=</span> (dx<span class="op">*</span>dx).<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb906-30" title="30">    rmsd <span class="op">=</span> np.sqrt(dx2.mean(axis<span class="op">=</span><span class="dv">1</span>))</a>
<a class="sourceLine" id="cb906-31" title="31">    <span class="cf">return</span> rmsd</a>
<a class="sourceLine" id="cb906-32" title="32"></a>
<a class="sourceLine" id="cb906-33" title="33"></a>
<a class="sourceLine" id="cb906-34" title="34"><span class="co">#print(&quot;Starting rmsd:&quot;, myrmsd(trj, 0))</span></a>
<a class="sourceLine" id="cb906-35" title="35">aligned_trj <span class="op">=</span> trj.superpose(trj, <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb906-36" title="36"></a>
<a class="sourceLine" id="cb906-37" title="37">my_rmsd <span class="op">=</span> myrmsd(aligned_trj, <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb906-38" title="38"><span class="co">#print(&quot;Aligned rmsd:&quot;, my_rmsd)</span></a>
<a class="sourceLine" id="cb906-39" title="39"></a>
<a class="sourceLine" id="cb906-40" title="40">nlcc_trj <span class="op">=</span> align_traj(trj, <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb906-41" title="41">nlcc_rmsd <span class="op">=</span> myrmsd(nlcc_trj, <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb906-42" title="42"></a>
<a class="sourceLine" id="cb906-43" title="43"><span class="co">#print(&quot;nlcc rmsd&quot;, nlcc_rmsd)</span></a>
<a class="sourceLine" id="cb906-44" title="44"></a>
<a class="sourceLine" id="cb906-45" title="45">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">all</span>(np.<span class="bu">abs</span>(my_rmsd <span class="op">-</span> nlcc_rmsd)) <span class="op">&lt;</span> <span class="fl">0.01</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>&#39;NoneType&#39; object has no attribute &#39;xyz&#39;</code></pre>
<h4 id="run-2-82">Run 2</h4>
<div class="sourceCode" id="cb908"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb908-1" title="1"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb908-2" title="2"></a>
<a class="sourceLine" id="cb908-3" title="3"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb908-4" title="4"><span class="co">Print version string</span></a>
<a class="sourceLine" id="cb908-5" title="5"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb908-6" title="6"><span class="bu">print</span>(md.version.full_version)</a>
<a class="sourceLine" id="cb908-7" title="7"><span class="co"># end</span></a>
<a class="sourceLine" id="cb908-8" title="8"></a>
<a class="sourceLine" id="cb908-9" title="9"><span class="kw">def</span> align_traj(traj, frame_index):</a>
<a class="sourceLine" id="cb908-10" title="10">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb908-11" title="11"><span class="co">  This function aligns the given mdtraj trajectory to a specific frame</span></a>
<a class="sourceLine" id="cb908-12" title="12"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb908-13" title="13">  <span class="co"># align to the first frame</span></a>
<a class="sourceLine" id="cb908-14" title="14">  traj.superpose(traj, frame<span class="op">=</span>frame_index)</a>
<a class="sourceLine" id="cb908-15" title="15">  </a>
<a class="sourceLine" id="cb908-16" title="16"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb908-17" title="17"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb908-18" title="18"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb908-19" title="19"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb908-20" title="20"></a>
<a class="sourceLine" id="cb908-21" title="21">pdb_file <span class="op">=</span> os.path.join(_FILE_DIR_, <span class="st">&quot;1VII_twoframe_shifted.pdb&quot;</span>)</a>
<a class="sourceLine" id="cb908-22" title="22">trj <span class="op">=</span> md.load(pdb_file)</a>
<a class="sourceLine" id="cb908-23" title="23"></a>
<a class="sourceLine" id="cb908-24" title="24"></a>
<a class="sourceLine" id="cb908-25" title="25"><span class="kw">def</span> myrmsd(trj, frame):</a>
<a class="sourceLine" id="cb908-26" title="26">    xyz <span class="op">=</span> trj.xyz</a>
<a class="sourceLine" id="cb908-27" title="27">    xyz0 <span class="op">=</span> trj.xyz[frame]</a>
<a class="sourceLine" id="cb908-28" title="28">    dx <span class="op">=</span> xyz<span class="op">-</span>xyz0</a>
<a class="sourceLine" id="cb908-29" title="29">    dx2 <span class="op">=</span> (dx<span class="op">*</span>dx).<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb908-30" title="30">    rmsd <span class="op">=</span> np.sqrt(dx2.mean(axis<span class="op">=</span><span class="dv">1</span>))</a>
<a class="sourceLine" id="cb908-31" title="31">    <span class="cf">return</span> rmsd</a>
<a class="sourceLine" id="cb908-32" title="32"></a>
<a class="sourceLine" id="cb908-33" title="33"></a>
<a class="sourceLine" id="cb908-34" title="34"><span class="co">#print(&quot;Starting rmsd:&quot;, myrmsd(trj, 0))</span></a>
<a class="sourceLine" id="cb908-35" title="35">aligned_trj <span class="op">=</span> trj.superpose(trj, <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb908-36" title="36"></a>
<a class="sourceLine" id="cb908-37" title="37">my_rmsd <span class="op">=</span> myrmsd(aligned_trj, <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb908-38" title="38"><span class="co">#print(&quot;Aligned rmsd:&quot;, my_rmsd)</span></a>
<a class="sourceLine" id="cb908-39" title="39"></a>
<a class="sourceLine" id="cb908-40" title="40">nlcc_trj <span class="op">=</span> align_traj(trj, <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb908-41" title="41">nlcc_rmsd <span class="op">=</span> myrmsd(nlcc_trj, <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb908-42" title="42"></a>
<a class="sourceLine" id="cb908-43" title="43"><span class="co">#print(&quot;nlcc rmsd&quot;, nlcc_rmsd)</span></a>
<a class="sourceLine" id="cb908-44" title="44"></a>
<a class="sourceLine" id="cb908-45" title="45">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">all</span>(np.<span class="bu">abs</span>(my_rmsd <span class="op">-</span> nlcc_rmsd)) <span class="op">&lt;</span> <span class="fl">0.01</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>&#39;NoneType&#39; object has no attribute &#39;xyz&#39;</code></pre>
<h4 id="run-3-82">Run 3</h4>
<div class="sourceCode" id="cb910"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb910-1" title="1"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb910-2" title="2"></a>
<a class="sourceLine" id="cb910-3" title="3"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb910-4" title="4"><span class="co">Print version string</span></a>
<a class="sourceLine" id="cb910-5" title="5"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb910-6" title="6"><span class="bu">print</span>(md.version.full_version)</a>
<a class="sourceLine" id="cb910-7" title="7"><span class="co"># end</span></a>
<a class="sourceLine" id="cb910-8" title="8"></a>
<a class="sourceLine" id="cb910-9" title="9"><span class="kw">def</span> align_traj(traj, frame_index):</a>
<a class="sourceLine" id="cb910-10" title="10">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb910-11" title="11"><span class="co">  This function aligns the given mdtraj trajectory to a specific frame</span></a>
<a class="sourceLine" id="cb910-12" title="12"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb910-13" title="13">  <span class="co"># align to the first frame</span></a>
<a class="sourceLine" id="cb910-14" title="14">  traj.superpose(traj, frame<span class="op">=</span>frame_index)</a>
<a class="sourceLine" id="cb910-15" title="15">  </a>
<a class="sourceLine" id="cb910-16" title="16"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb910-17" title="17"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb910-18" title="18"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb910-19" title="19"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb910-20" title="20"></a>
<a class="sourceLine" id="cb910-21" title="21">pdb_file <span class="op">=</span> os.path.join(_FILE_DIR_, <span class="st">&quot;1VII_twoframe_shifted.pdb&quot;</span>)</a>
<a class="sourceLine" id="cb910-22" title="22">trj <span class="op">=</span> md.load(pdb_file)</a>
<a class="sourceLine" id="cb910-23" title="23"></a>
<a class="sourceLine" id="cb910-24" title="24"></a>
<a class="sourceLine" id="cb910-25" title="25"><span class="kw">def</span> myrmsd(trj, frame):</a>
<a class="sourceLine" id="cb910-26" title="26">    xyz <span class="op">=</span> trj.xyz</a>
<a class="sourceLine" id="cb910-27" title="27">    xyz0 <span class="op">=</span> trj.xyz[frame]</a>
<a class="sourceLine" id="cb910-28" title="28">    dx <span class="op">=</span> xyz<span class="op">-</span>xyz0</a>
<a class="sourceLine" id="cb910-29" title="29">    dx2 <span class="op">=</span> (dx<span class="op">*</span>dx).<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb910-30" title="30">    rmsd <span class="op">=</span> np.sqrt(dx2.mean(axis<span class="op">=</span><span class="dv">1</span>))</a>
<a class="sourceLine" id="cb910-31" title="31">    <span class="cf">return</span> rmsd</a>
<a class="sourceLine" id="cb910-32" title="32"></a>
<a class="sourceLine" id="cb910-33" title="33"></a>
<a class="sourceLine" id="cb910-34" title="34"><span class="co">#print(&quot;Starting rmsd:&quot;, myrmsd(trj, 0))</span></a>
<a class="sourceLine" id="cb910-35" title="35">aligned_trj <span class="op">=</span> trj.superpose(trj, <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb910-36" title="36"></a>
<a class="sourceLine" id="cb910-37" title="37">my_rmsd <span class="op">=</span> myrmsd(aligned_trj, <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb910-38" title="38"><span class="co">#print(&quot;Aligned rmsd:&quot;, my_rmsd)</span></a>
<a class="sourceLine" id="cb910-39" title="39"></a>
<a class="sourceLine" id="cb910-40" title="40">nlcc_trj <span class="op">=</span> align_traj(trj, <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb910-41" title="41">nlcc_rmsd <span class="op">=</span> myrmsd(nlcc_trj, <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb910-42" title="42"></a>
<a class="sourceLine" id="cb910-43" title="43"><span class="co">#print(&quot;nlcc rmsd&quot;, nlcc_rmsd)</span></a>
<a class="sourceLine" id="cb910-44" title="44"></a>
<a class="sourceLine" id="cb910-45" title="45">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">all</span>(np.<span class="bu">abs</span>(my_rmsd <span class="op">-</span> nlcc_rmsd)) <span class="op">&lt;</span> <span class="fl">0.01</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>&#39;NoneType&#39; object has no attribute &#39;xyz&#39;</code></pre>
<h4 id="run-4-82">Run 4</h4>
<div class="sourceCode" id="cb912"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb912-1" title="1"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb912-2" title="2"></a>
<a class="sourceLine" id="cb912-3" title="3"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb912-4" title="4"><span class="co">Print version string</span></a>
<a class="sourceLine" id="cb912-5" title="5"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb912-6" title="6"><span class="bu">print</span>(md.version.full_version)</a>
<a class="sourceLine" id="cb912-7" title="7"><span class="co"># end</span></a>
<a class="sourceLine" id="cb912-8" title="8"></a>
<a class="sourceLine" id="cb912-9" title="9"><span class="kw">def</span> align_traj(traj, frame_index):</a>
<a class="sourceLine" id="cb912-10" title="10">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb912-11" title="11"><span class="co">  This function aligns the given mdtraj trajectory to a specific frame</span></a>
<a class="sourceLine" id="cb912-12" title="12"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb912-13" title="13">  traj.superpose(traj, frame<span class="op">=</span>frame_index)</a>
<a class="sourceLine" id="cb912-14" title="14">  <span class="cf">return</span> traj</a>
<a class="sourceLine" id="cb912-15" title="15"></a>
<a class="sourceLine" id="cb912-16" title="16"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb912-17" title="17"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb912-18" title="18"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb912-19" title="19"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb912-20" title="20"></a>
<a class="sourceLine" id="cb912-21" title="21">pdb_file <span class="op">=</span> os.path.join(_FILE_DIR_, <span class="st">&quot;1VII_twoframe_shifted.pdb&quot;</span>)</a>
<a class="sourceLine" id="cb912-22" title="22">trj <span class="op">=</span> md.load(pdb_file)</a>
<a class="sourceLine" id="cb912-23" title="23"></a>
<a class="sourceLine" id="cb912-24" title="24"></a>
<a class="sourceLine" id="cb912-25" title="25"><span class="kw">def</span> myrmsd(trj, frame):</a>
<a class="sourceLine" id="cb912-26" title="26">    xyz <span class="op">=</span> trj.xyz</a>
<a class="sourceLine" id="cb912-27" title="27">    xyz0 <span class="op">=</span> trj.xyz[frame]</a>
<a class="sourceLine" id="cb912-28" title="28">    dx <span class="op">=</span> xyz<span class="op">-</span>xyz0</a>
<a class="sourceLine" id="cb912-29" title="29">    dx2 <span class="op">=</span> (dx<span class="op">*</span>dx).<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb912-30" title="30">    rmsd <span class="op">=</span> np.sqrt(dx2.mean(axis<span class="op">=</span><span class="dv">1</span>))</a>
<a class="sourceLine" id="cb912-31" title="31">    <span class="cf">return</span> rmsd</a>
<a class="sourceLine" id="cb912-32" title="32"></a>
<a class="sourceLine" id="cb912-33" title="33"></a>
<a class="sourceLine" id="cb912-34" title="34"><span class="co">#print(&quot;Starting rmsd:&quot;, myrmsd(trj, 0))</span></a>
<a class="sourceLine" id="cb912-35" title="35">aligned_trj <span class="op">=</span> trj.superpose(trj, <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb912-36" title="36"></a>
<a class="sourceLine" id="cb912-37" title="37">my_rmsd <span class="op">=</span> myrmsd(aligned_trj, <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb912-38" title="38"><span class="co">#print(&quot;Aligned rmsd:&quot;, my_rmsd)</span></a>
<a class="sourceLine" id="cb912-39" title="39"></a>
<a class="sourceLine" id="cb912-40" title="40">nlcc_trj <span class="op">=</span> align_traj(trj, <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb912-41" title="41">nlcc_rmsd <span class="op">=</span> myrmsd(nlcc_trj, <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb912-42" title="42"></a>
<a class="sourceLine" id="cb912-43" title="43"><span class="co">#print(&quot;nlcc rmsd&quot;, nlcc_rmsd)</span></a>
<a class="sourceLine" id="cb912-44" title="44"></a>
<a class="sourceLine" id="cb912-45" title="45">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">all</span>(np.<span class="bu">abs</span>(my_rmsd <span class="op">-</span> nlcc_rmsd)) <span class="op">&lt;</span> <span class="fl">0.01</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>angle</summary></p>
<h4 id="query-83">Query</h4>
<div class="sourceCode" id="cb914"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb914-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb914-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb914-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb914-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb914-5" title="5"></a>
<a class="sourceLine" id="cb914-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb914-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb914-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb914-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb914-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb914-11" title="11"></a>
<a class="sourceLine" id="cb914-12" title="12"><span class="kw">def</span> vector_angle(v1,v2):</a>
<a class="sourceLine" id="cb914-13" title="13">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb914-14" title="14"><span class="co">    This function returns the angle between vector v1 and vector v2.</span></a>
<a class="sourceLine" id="cb914-15" title="15"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb914-16" title="16">    </a></code></pre></div>
<h4 id="run-0-83">Run 0</h4>
<div class="sourceCode" id="cb915"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb915-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb915-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb915-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb915-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb915-5" title="5"></a>
<a class="sourceLine" id="cb915-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb915-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb915-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb915-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb915-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb915-11" title="11"></a>
<a class="sourceLine" id="cb915-12" title="12"><span class="kw">def</span> vector_angle(v1,v2):</a>
<a class="sourceLine" id="cb915-13" title="13">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb915-14" title="14"><span class="co">    This function returns the angle between vector v1 and vector v2.</span></a>
<a class="sourceLine" id="cb915-15" title="15"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb915-16" title="16">    <span class="co"># start</span></a>
<a class="sourceLine" id="cb915-17" title="17">    v1_u <span class="op">=</span> v1<span class="op">/</span>np.linalg.norm(v1)</a>
<a class="sourceLine" id="cb915-18" title="18">    v2_u <span class="op">=</span> v2<span class="op">/</span>np.linalg.norm(v2)</a>
<a class="sourceLine" id="cb915-19" title="19">    <span class="cf">return</span> np.arccos(np.clip(np.dot(v1_u, v2_u), <span class="fl">-1.0</span>, <span class="fl">1.0</span>))</a>
<a class="sourceLine" id="cb915-20" title="20">    </a>
<a class="sourceLine" id="cb915-21" title="21"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb915-22" title="22"></a>
<a class="sourceLine" id="cb915-23" title="23"><span class="kw">def</span> unit_vec(vector):</a>
<a class="sourceLine" id="cb915-24" title="24">    <span class="cf">return</span> vector <span class="op">/</span> np.linalg.norm(vector)</a>
<a class="sourceLine" id="cb915-25" title="25"></a>
<a class="sourceLine" id="cb915-26" title="26">v1 <span class="op">=</span>  [<span class="fl">1.2</span>,<span class="fl">0.5</span>,<span class="fl">0.5</span>]</a>
<a class="sourceLine" id="cb915-27" title="27">v2 <span class="op">=</span>  [<span class="op">-</span><span class="fl">1.5</span>,<span class="fl">2.0</span>,<span class="fl">0.0</span>]</a>
<a class="sourceLine" id="cb915-28" title="28"></a>
<a class="sourceLine" id="cb915-29" title="29">v1_u <span class="op">=</span> unit_vec(v1)</a>
<a class="sourceLine" id="cb915-30" title="30">v2_u <span class="op">=</span> unit_vec(v2)</a>
<a class="sourceLine" id="cb915-31" title="31"></a>
<a class="sourceLine" id="cb915-32" title="32">angle <span class="op">=</span> np.arccos(np.clip(np.dot(v1_u, v2_u), <span class="fl">-1.0</span>, <span class="fl">1.0</span>))</a>
<a class="sourceLine" id="cb915-33" title="33"></a>
<a class="sourceLine" id="cb915-34" title="34">angle_codex <span class="op">=</span>  vector_angle(v1,v2)</a>
<a class="sourceLine" id="cb915-35" title="35"></a>
<a class="sourceLine" id="cb915-36" title="36"><span class="cf">if</span> np.isclose(angle, angle_codex) <span class="op">==</span> <span class="va">True</span>:</a>
<a class="sourceLine" id="cb915-37" title="37">    result <span class="op">=</span> <span class="va">True</span></a>
<a class="sourceLine" id="cb915-38" title="38"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb915-39" title="39">    result <span class="op">=</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-83">Run 1</h4>
<div class="sourceCode" id="cb917"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb917-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb917-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb917-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb917-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb917-5" title="5"></a>
<a class="sourceLine" id="cb917-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb917-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb917-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb917-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb917-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb917-11" title="11"></a>
<a class="sourceLine" id="cb917-12" title="12"><span class="kw">def</span> vector_angle(v1,v2):</a>
<a class="sourceLine" id="cb917-13" title="13">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb917-14" title="14"><span class="co">    This function returns the angle between vector v1 and vector v2.</span></a>
<a class="sourceLine" id="cb917-15" title="15"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb917-16" title="16">    <span class="cf">return</span> np.arccos(np.dot(v1,v2)<span class="op">/</span>(np.linalg.norm(v1)<span class="op">*</span>np.linalg.norm(v2)))</a>
<a class="sourceLine" id="cb917-17" title="17"></a>
<a class="sourceLine" id="cb917-18" title="18"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb917-19" title="19"></a>
<a class="sourceLine" id="cb917-20" title="20"><span class="kw">def</span> unit_vec(vector):</a>
<a class="sourceLine" id="cb917-21" title="21">    <span class="cf">return</span> vector <span class="op">/</span> np.linalg.norm(vector)</a>
<a class="sourceLine" id="cb917-22" title="22"></a>
<a class="sourceLine" id="cb917-23" title="23">v1 <span class="op">=</span>  [<span class="fl">1.2</span>,<span class="fl">0.5</span>,<span class="fl">0.5</span>]</a>
<a class="sourceLine" id="cb917-24" title="24">v2 <span class="op">=</span>  [<span class="op">-</span><span class="fl">1.5</span>,<span class="fl">2.0</span>,<span class="fl">0.0</span>]</a>
<a class="sourceLine" id="cb917-25" title="25"></a>
<a class="sourceLine" id="cb917-26" title="26">v1_u <span class="op">=</span> unit_vec(v1)</a>
<a class="sourceLine" id="cb917-27" title="27">v2_u <span class="op">=</span> unit_vec(v2)</a>
<a class="sourceLine" id="cb917-28" title="28"></a>
<a class="sourceLine" id="cb917-29" title="29">angle <span class="op">=</span> np.arccos(np.clip(np.dot(v1_u, v2_u), <span class="fl">-1.0</span>, <span class="fl">1.0</span>))</a>
<a class="sourceLine" id="cb917-30" title="30"></a>
<a class="sourceLine" id="cb917-31" title="31">angle_codex <span class="op">=</span>  vector_angle(v1,v2)</a>
<a class="sourceLine" id="cb917-32" title="32"></a>
<a class="sourceLine" id="cb917-33" title="33"><span class="cf">if</span> np.isclose(angle, angle_codex) <span class="op">==</span> <span class="va">True</span>:</a>
<a class="sourceLine" id="cb917-34" title="34">    result <span class="op">=</span> <span class="va">True</span></a>
<a class="sourceLine" id="cb917-35" title="35"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb917-36" title="36">    result <span class="op">=</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-83">Run 2</h4>
<div class="sourceCode" id="cb919"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb919-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb919-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb919-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb919-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb919-5" title="5"></a>
<a class="sourceLine" id="cb919-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb919-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb919-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb919-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb919-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb919-11" title="11"></a>
<a class="sourceLine" id="cb919-12" title="12"><span class="kw">def</span> vector_angle(v1,v2):</a>
<a class="sourceLine" id="cb919-13" title="13">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb919-14" title="14"><span class="co">    This function returns the angle between vector v1 and vector v2.</span></a>
<a class="sourceLine" id="cb919-15" title="15"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb919-16" title="16">    v1_u <span class="op">=</span> v1 <span class="op">/</span> np.linalg.norm(v1)</a>
<a class="sourceLine" id="cb919-17" title="17">    v2_u <span class="op">=</span> v2 <span class="op">/</span> np.linalg.norm(v2)</a>
<a class="sourceLine" id="cb919-18" title="18">    <span class="cf">return</span> np.arccos(np.clip(np.dot(v1_u, v2_u), <span class="fl">-1.0</span>, <span class="fl">1.0</span>))</a>
<a class="sourceLine" id="cb919-19" title="19"></a>
<a class="sourceLine" id="cb919-20" title="20"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb919-21" title="21"></a>
<a class="sourceLine" id="cb919-22" title="22"><span class="kw">def</span> unit_vec(vector):</a>
<a class="sourceLine" id="cb919-23" title="23">    <span class="cf">return</span> vector <span class="op">/</span> np.linalg.norm(vector)</a>
<a class="sourceLine" id="cb919-24" title="24"></a>
<a class="sourceLine" id="cb919-25" title="25">v1 <span class="op">=</span>  [<span class="fl">1.2</span>,<span class="fl">0.5</span>,<span class="fl">0.5</span>]</a>
<a class="sourceLine" id="cb919-26" title="26">v2 <span class="op">=</span>  [<span class="op">-</span><span class="fl">1.5</span>,<span class="fl">2.0</span>,<span class="fl">0.0</span>]</a>
<a class="sourceLine" id="cb919-27" title="27"></a>
<a class="sourceLine" id="cb919-28" title="28">v1_u <span class="op">=</span> unit_vec(v1)</a>
<a class="sourceLine" id="cb919-29" title="29">v2_u <span class="op">=</span> unit_vec(v2)</a>
<a class="sourceLine" id="cb919-30" title="30"></a>
<a class="sourceLine" id="cb919-31" title="31">angle <span class="op">=</span> np.arccos(np.clip(np.dot(v1_u, v2_u), <span class="fl">-1.0</span>, <span class="fl">1.0</span>))</a>
<a class="sourceLine" id="cb919-32" title="32"></a>
<a class="sourceLine" id="cb919-33" title="33">angle_codex <span class="op">=</span>  vector_angle(v1,v2)</a>
<a class="sourceLine" id="cb919-34" title="34"></a>
<a class="sourceLine" id="cb919-35" title="35"><span class="cf">if</span> np.isclose(angle, angle_codex) <span class="op">==</span> <span class="va">True</span>:</a>
<a class="sourceLine" id="cb919-36" title="36">    result <span class="op">=</span> <span class="va">True</span></a>
<a class="sourceLine" id="cb919-37" title="37"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb919-38" title="38">    result <span class="op">=</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-83">Run 3</h4>
<div class="sourceCode" id="cb921"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb921-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb921-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb921-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb921-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb921-5" title="5"></a>
<a class="sourceLine" id="cb921-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb921-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb921-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb921-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb921-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb921-11" title="11"></a>
<a class="sourceLine" id="cb921-12" title="12"><span class="kw">def</span> vector_angle(v1,v2):</a>
<a class="sourceLine" id="cb921-13" title="13">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb921-14" title="14"><span class="co">    This function returns the angle between vector v1 and vector v2.</span></a>
<a class="sourceLine" id="cb921-15" title="15"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb921-16" title="16">    cos_angle <span class="op">=</span> np.dot(v1,v2)<span class="op">/</span>(np.linalg.norm(v1)<span class="op">*</span>np.linalg.norm(v2))</a>
<a class="sourceLine" id="cb921-17" title="17">    angle <span class="op">=</span> np.arccos(cos_angle)</a>
<a class="sourceLine" id="cb921-18" title="18">    <span class="cf">return</span> angle</a>
<a class="sourceLine" id="cb921-19" title="19"></a>
<a class="sourceLine" id="cb921-20" title="20"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb921-21" title="21"></a>
<a class="sourceLine" id="cb921-22" title="22"><span class="kw">def</span> unit_vec(vector):</a>
<a class="sourceLine" id="cb921-23" title="23">    <span class="cf">return</span> vector <span class="op">/</span> np.linalg.norm(vector)</a>
<a class="sourceLine" id="cb921-24" title="24"></a>
<a class="sourceLine" id="cb921-25" title="25">v1 <span class="op">=</span>  [<span class="fl">1.2</span>,<span class="fl">0.5</span>,<span class="fl">0.5</span>]</a>
<a class="sourceLine" id="cb921-26" title="26">v2 <span class="op">=</span>  [<span class="op">-</span><span class="fl">1.5</span>,<span class="fl">2.0</span>,<span class="fl">0.0</span>]</a>
<a class="sourceLine" id="cb921-27" title="27"></a>
<a class="sourceLine" id="cb921-28" title="28">v1_u <span class="op">=</span> unit_vec(v1)</a>
<a class="sourceLine" id="cb921-29" title="29">v2_u <span class="op">=</span> unit_vec(v2)</a>
<a class="sourceLine" id="cb921-30" title="30"></a>
<a class="sourceLine" id="cb921-31" title="31">angle <span class="op">=</span> np.arccos(np.clip(np.dot(v1_u, v2_u), <span class="fl">-1.0</span>, <span class="fl">1.0</span>))</a>
<a class="sourceLine" id="cb921-32" title="32"></a>
<a class="sourceLine" id="cb921-33" title="33">angle_codex <span class="op">=</span>  vector_angle(v1,v2)</a>
<a class="sourceLine" id="cb921-34" title="34"></a>
<a class="sourceLine" id="cb921-35" title="35"><span class="cf">if</span> np.isclose(angle, angle_codex) <span class="op">==</span> <span class="va">True</span>:</a>
<a class="sourceLine" id="cb921-36" title="36">    result <span class="op">=</span> <span class="va">True</span></a>
<a class="sourceLine" id="cb921-37" title="37"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb921-38" title="38">    result <span class="op">=</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-83">Run 4</h4>
<div class="sourceCode" id="cb923"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb923-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb923-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb923-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb923-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb923-5" title="5"></a>
<a class="sourceLine" id="cb923-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb923-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb923-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb923-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb923-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb923-11" title="11"></a>
<a class="sourceLine" id="cb923-12" title="12"><span class="kw">def</span> vector_angle(v1,v2):</a>
<a class="sourceLine" id="cb923-13" title="13">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb923-14" title="14"><span class="co">    This function returns the angle between vector v1 and vector v2.</span></a>
<a class="sourceLine" id="cb923-15" title="15"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb923-16" title="16">    <span class="co"># start</span></a>
<a class="sourceLine" id="cb923-17" title="17">    v1_u <span class="op">=</span> v1 <span class="op">/</span> np.linalg.norm(v1)</a>
<a class="sourceLine" id="cb923-18" title="18">    v2_u <span class="op">=</span> v2 <span class="op">/</span> np.linalg.norm(v2)</a>
<a class="sourceLine" id="cb923-19" title="19">    angle <span class="op">=</span> np.arccos(np.clip(np.dot(v1_u, v2_u), <span class="fl">-1.0</span>, <span class="fl">1.0</span>))</a>
<a class="sourceLine" id="cb923-20" title="20">    <span class="cf">return</span> angle</a>
<a class="sourceLine" id="cb923-21" title="21">    </a>
<a class="sourceLine" id="cb923-22" title="22"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb923-23" title="23"></a>
<a class="sourceLine" id="cb923-24" title="24"><span class="kw">def</span> unit_vec(vector):</a>
<a class="sourceLine" id="cb923-25" title="25">    <span class="cf">return</span> vector <span class="op">/</span> np.linalg.norm(vector)</a>
<a class="sourceLine" id="cb923-26" title="26"></a>
<a class="sourceLine" id="cb923-27" title="27">v1 <span class="op">=</span>  [<span class="fl">1.2</span>,<span class="fl">0.5</span>,<span class="fl">0.5</span>]</a>
<a class="sourceLine" id="cb923-28" title="28">v2 <span class="op">=</span>  [<span class="op">-</span><span class="fl">1.5</span>,<span class="fl">2.0</span>,<span class="fl">0.0</span>]</a>
<a class="sourceLine" id="cb923-29" title="29"></a>
<a class="sourceLine" id="cb923-30" title="30">v1_u <span class="op">=</span> unit_vec(v1)</a>
<a class="sourceLine" id="cb923-31" title="31">v2_u <span class="op">=</span> unit_vec(v2)</a>
<a class="sourceLine" id="cb923-32" title="32"></a>
<a class="sourceLine" id="cb923-33" title="33">angle <span class="op">=</span> np.arccos(np.clip(np.dot(v1_u, v2_u), <span class="fl">-1.0</span>, <span class="fl">1.0</span>))</a>
<a class="sourceLine" id="cb923-34" title="34"></a>
<a class="sourceLine" id="cb923-35" title="35">angle_codex <span class="op">=</span>  vector_angle(v1,v2)</a>
<a class="sourceLine" id="cb923-36" title="36"></a>
<a class="sourceLine" id="cb923-37" title="37"><span class="cf">if</span> np.isclose(angle, angle_codex) <span class="op">==</span> <span class="va">True</span>:</a>
<a class="sourceLine" id="cb923-38" title="38">    result <span class="op">=</span> <span class="va">True</span></a>
<a class="sourceLine" id="cb923-39" title="39"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb923-40" title="40">    result <span class="op">=</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>aromatic_aa</summary></p>
<h4 id="query-84">Query</h4>
<div class="sourceCode" id="cb925"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb925-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb925-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb925-3" title="3"></a>
<a class="sourceLine" id="cb925-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb925-5" title="5"><span class="co">compute sin(pi/2)</span></a>
<a class="sourceLine" id="cb925-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb925-7" title="7">x <span class="op">=</span> math.sin(math.pi <span class="op">/</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb925-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb925-9" title="9"></a>
<a class="sourceLine" id="cb925-10" title="10"><span class="kw">def</span> aromatic_aa(sequence):</a>
<a class="sourceLine" id="cb925-11" title="11">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb925-12" title="12"><span class="co">    This function takes in an amino acid sequence and returns the number of aromatic residues there are</span></a>
<a class="sourceLine" id="cb925-13" title="13"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb925-14" title="14">    </a></code></pre></div>
<h4 id="run-0-84">Run 0</h4>
<div class="sourceCode" id="cb926"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb926-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb926-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb926-3" title="3"></a>
<a class="sourceLine" id="cb926-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb926-5" title="5"><span class="co">compute sin(pi/2)</span></a>
<a class="sourceLine" id="cb926-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb926-7" title="7">x <span class="op">=</span> math.sin(math.pi <span class="op">/</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb926-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb926-9" title="9"></a>
<a class="sourceLine" id="cb926-10" title="10"><span class="kw">def</span> aromatic_aa(sequence):</a>
<a class="sourceLine" id="cb926-11" title="11">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb926-12" title="12"><span class="co">    This function takes in an amino acid sequence and returns the number of aromatic residues there are</span></a>
<a class="sourceLine" id="cb926-13" title="13"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb926-14" title="14">    <span class="co"># start</span></a>
<a class="sourceLine" id="cb926-15" title="15">    aromatic_aa_count <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb926-16" title="16">    <span class="cf">for</span> aa <span class="kw">in</span> sequence:</a>
<a class="sourceLine" id="cb926-17" title="17">        <span class="cf">if</span> aa <span class="op">==</span> <span class="st">&#39;F&#39;</span> <span class="kw">or</span> aa <span class="op">==</span> <span class="st">&#39;Y&#39;</span> <span class="kw">or</span> aa <span class="op">==</span> <span class="st">&#39;W&#39;</span> <span class="kw">or</span> aa <span class="op">==</span> <span class="st">&#39;H&#39;</span>:</a>
<a class="sourceLine" id="cb926-18" title="18">            aromatic_aa_count <span class="op">+=</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb926-19" title="19">    <span class="cf">return</span> aromatic_aa_count</a>
<a class="sourceLine" id="cb926-20" title="20">    </a>
<a class="sourceLine" id="cb926-21" title="21"></a>
<a class="sourceLine" id="cb926-22" title="22">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> aromatic_aa(<span class="st">&quot;FLRYSCV&quot;</span>)<span class="op">==</span><span class="dv">2</span> <span class="cf">else</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb926-23" title="23"></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-84">Run 1</h4>
<div class="sourceCode" id="cb928"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb928-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb928-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb928-3" title="3"></a>
<a class="sourceLine" id="cb928-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb928-5" title="5"><span class="co">compute sin(pi/2)</span></a>
<a class="sourceLine" id="cb928-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb928-7" title="7">x <span class="op">=</span> math.sin(math.pi <span class="op">/</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb928-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb928-9" title="9"></a>
<a class="sourceLine" id="cb928-10" title="10"><span class="kw">def</span> aromatic_aa(sequence):</a>
<a class="sourceLine" id="cb928-11" title="11">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb928-12" title="12"><span class="co">    This function takes in an amino acid sequence and returns the number of aromatic residues there are</span></a>
<a class="sourceLine" id="cb928-13" title="13"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb928-14" title="14">    aromatic_residues <span class="op">=</span> [<span class="st">&#39;F&#39;</span>, <span class="st">&#39;Y&#39;</span>, <span class="st">&#39;W&#39;</span>]</a>
<a class="sourceLine" id="cb928-15" title="15">    aromatic_count <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb928-16" title="16">    <span class="cf">for</span> aa <span class="kw">in</span> sequence:</a>
<a class="sourceLine" id="cb928-17" title="17">        <span class="cf">if</span> aa <span class="kw">in</span> aromatic_residues:</a>
<a class="sourceLine" id="cb928-18" title="18">            aromatic_count <span class="op">+=</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb928-19" title="19">    <span class="cf">return</span> aromatic_count</a>
<a class="sourceLine" id="cb928-20" title="20"></a>
<a class="sourceLine" id="cb928-21" title="21"></a>
<a class="sourceLine" id="cb928-22" title="22">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> aromatic_aa(<span class="st">&quot;FLRYSCV&quot;</span>)<span class="op">==</span><span class="dv">2</span> <span class="cf">else</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb928-23" title="23"></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-84">Run 2</h4>
<div class="sourceCode" id="cb930"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb930-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb930-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb930-3" title="3"></a>
<a class="sourceLine" id="cb930-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb930-5" title="5"><span class="co">compute sin(pi/2)</span></a>
<a class="sourceLine" id="cb930-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb930-7" title="7">x <span class="op">=</span> math.sin(math.pi <span class="op">/</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb930-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb930-9" title="9"></a>
<a class="sourceLine" id="cb930-10" title="10"><span class="kw">def</span> aromatic_aa(sequence):</a>
<a class="sourceLine" id="cb930-11" title="11">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb930-12" title="12"><span class="co">    This function takes in an amino acid sequence and returns the number of aromatic residues there are</span></a>
<a class="sourceLine" id="cb930-13" title="13"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb930-14" title="14">    aromatic_residues <span class="op">=</span> [<span class="st">&#39;F&#39;</span>, <span class="st">&#39;Y&#39;</span>, <span class="st">&#39;W&#39;</span>]</a>
<a class="sourceLine" id="cb930-15" title="15">    aromatic_count <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb930-16" title="16">    <span class="cf">for</span> residue <span class="kw">in</span> sequence:</a>
<a class="sourceLine" id="cb930-17" title="17">        <span class="cf">if</span> residue <span class="kw">in</span> aromatic_residues:</a>
<a class="sourceLine" id="cb930-18" title="18">            aromatic_count <span class="op">+=</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb930-19" title="19">    <span class="cf">return</span> aromatic_count</a>
<a class="sourceLine" id="cb930-20" title="20"></a>
<a class="sourceLine" id="cb930-21" title="21"></a>
<a class="sourceLine" id="cb930-22" title="22">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> aromatic_aa(<span class="st">&quot;FLRYSCV&quot;</span>)<span class="op">==</span><span class="dv">2</span> <span class="cf">else</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb930-23" title="23"></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-84">Run 3</h4>
<div class="sourceCode" id="cb932"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb932-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb932-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb932-3" title="3"></a>
<a class="sourceLine" id="cb932-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb932-5" title="5"><span class="co">compute sin(pi/2)</span></a>
<a class="sourceLine" id="cb932-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb932-7" title="7">x <span class="op">=</span> math.sin(math.pi <span class="op">/</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb932-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb932-9" title="9"></a>
<a class="sourceLine" id="cb932-10" title="10"><span class="kw">def</span> aromatic_aa(sequence):</a>
<a class="sourceLine" id="cb932-11" title="11">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb932-12" title="12"><span class="co">    This function takes in an amino acid sequence and returns the number of aromatic residues there are</span></a>
<a class="sourceLine" id="cb932-13" title="13"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb932-14" title="14">    aromatic_residues <span class="op">=</span> [<span class="st">&#39;F&#39;</span>, <span class="st">&#39;Y&#39;</span>, <span class="st">&#39;W&#39;</span>]</a>
<a class="sourceLine" id="cb932-15" title="15">    aromatic_count <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb932-16" title="16">    <span class="cf">for</span> aa <span class="kw">in</span> sequence:</a>
<a class="sourceLine" id="cb932-17" title="17">        <span class="cf">if</span> aa <span class="kw">in</span> aromatic_residues:</a>
<a class="sourceLine" id="cb932-18" title="18">            aromatic_count <span class="op">+=</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb932-19" title="19">    <span class="cf">return</span> aromatic_count</a>
<a class="sourceLine" id="cb932-20" title="20"></a>
<a class="sourceLine" id="cb932-21" title="21"></a>
<a class="sourceLine" id="cb932-22" title="22">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> aromatic_aa(<span class="st">&quot;FLRYSCV&quot;</span>)<span class="op">==</span><span class="dv">2</span> <span class="cf">else</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb932-23" title="23"></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-84">Run 4</h4>
<div class="sourceCode" id="cb934"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb934-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb934-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb934-3" title="3"></a>
<a class="sourceLine" id="cb934-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb934-5" title="5"><span class="co">compute sin(pi/2)</span></a>
<a class="sourceLine" id="cb934-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb934-7" title="7">x <span class="op">=</span> math.sin(math.pi <span class="op">/</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb934-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb934-9" title="9"></a>
<a class="sourceLine" id="cb934-10" title="10"><span class="kw">def</span> aromatic_aa(sequence):</a>
<a class="sourceLine" id="cb934-11" title="11">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb934-12" title="12"><span class="co">    This function takes in an amino acid sequence and returns the number of aromatic residues there are</span></a>
<a class="sourceLine" id="cb934-13" title="13"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb934-14" title="14">    aromatic <span class="op">=</span> [<span class="st">&#39;F&#39;</span>, <span class="st">&#39;Y&#39;</span>, <span class="st">&#39;W&#39;</span>]</a>
<a class="sourceLine" id="cb934-15" title="15">    aromatic_count <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb934-16" title="16">    <span class="cf">for</span> i <span class="kw">in</span> sequence:</a>
<a class="sourceLine" id="cb934-17" title="17">        <span class="cf">if</span> i <span class="kw">in</span> aromatic:</a>
<a class="sourceLine" id="cb934-18" title="18">            aromatic_count <span class="op">+=</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb934-19" title="19">    <span class="cf">return</span> aromatic_count</a>
<a class="sourceLine" id="cb934-20" title="20"></a>
<a class="sourceLine" id="cb934-21" title="21"></a>
<a class="sourceLine" id="cb934-22" title="22">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> aromatic_aa(<span class="st">&quot;FLRYSCV&quot;</span>)<span class="op">==</span><span class="dv">2</span> <span class="cf">else</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb934-23" title="23"></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>arrhenius</summary></p>
<h4 id="query-85">Query</h4>
<div class="sourceCode" id="cb936"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb936-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb936-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb936-3" title="3"></a>
<a class="sourceLine" id="cb936-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb936-5" title="5"><span class="co">compute sin(pi/2)</span></a>
<a class="sourceLine" id="cb936-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb936-7" title="7">x <span class="op">=</span> math.sin(math.pi <span class="op">/</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb936-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb936-9" title="9"></a>
<a class="sourceLine" id="cb936-10" title="10"><span class="kw">def</span> arrhenius(k2,T2,T1,Ea):</a>
<a class="sourceLine" id="cb936-11" title="11">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb936-12" title="12"><span class="co">   This function returns the value of the rate constant at temperature T1 using the Arrhenius equation</span></a>
<a class="sourceLine" id="cb936-13" title="13"><span class="co">   k2 is the rate constant at temperature T2.</span></a>
<a class="sourceLine" id="cb936-14" title="14"><span class="co">   Ea is the activation energy in J/mol.</span></a>
<a class="sourceLine" id="cb936-15" title="15"><span class="co">   Temperatures are given in Kelvin</span></a>
<a class="sourceLine" id="cb936-16" title="16"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb936-17" title="17">   </a></code></pre></div>
<h4 id="run-0-85">Run 0</h4>
<div class="sourceCode" id="cb937"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb937-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb937-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb937-3" title="3"></a>
<a class="sourceLine" id="cb937-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb937-5" title="5"><span class="co">compute sin(pi/2)</span></a>
<a class="sourceLine" id="cb937-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb937-7" title="7">x <span class="op">=</span> math.sin(math.pi <span class="op">/</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb937-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb937-9" title="9"></a>
<a class="sourceLine" id="cb937-10" title="10"><span class="kw">def</span> arrhenius(k2,T2,T1,Ea):</a>
<a class="sourceLine" id="cb937-11" title="11">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb937-12" title="12"><span class="co">   This function returns the value of the rate constant at temperature T1 using the Arrhenius equation</span></a>
<a class="sourceLine" id="cb937-13" title="13"><span class="co">   k2 is the rate constant at temperature T2.</span></a>
<a class="sourceLine" id="cb937-14" title="14"><span class="co">   Ea is the activation energy in J/mol.</span></a>
<a class="sourceLine" id="cb937-15" title="15"><span class="co">   Temperatures are given in Kelvin</span></a>
<a class="sourceLine" id="cb937-16" title="16"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb937-17" title="17">   R <span class="op">=</span> <span class="fl">8.314</span></a>
<a class="sourceLine" id="cb937-18" title="18">   k1 <span class="op">=</span> k2 <span class="op">*</span> math.exp((Ea<span class="op">/</span>R)<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>T2 <span class="op">-</span> <span class="dv">1</span><span class="op">/</span>T1))</a>
<a class="sourceLine" id="cb937-19" title="19">   <span class="cf">return</span> k1</a>
<a class="sourceLine" id="cb937-20" title="20"></a>
<a class="sourceLine" id="cb937-21" title="21"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb937-22" title="22"></a>
<a class="sourceLine" id="cb937-23" title="23"><span class="co"># inputs</span></a>
<a class="sourceLine" id="cb937-24" title="24">T1 <span class="op">=</span> <span class="fl">308.18</span>   <span class="co"># in K</span></a>
<a class="sourceLine" id="cb937-25" title="25">T2 <span class="op">=</span> <span class="fl">333.18</span>   <span class="co"># in K</span></a>
<a class="sourceLine" id="cb937-26" title="26">R <span class="op">=</span> <span class="fl">8.314</span>     <span class="co"># J/mol.K</span></a>
<a class="sourceLine" id="cb937-27" title="27">Ea <span class="op">=</span> <span class="dv">108000</span>   <span class="co"># J/mol</span></a>
<a class="sourceLine" id="cb937-28" title="28">k2 <span class="op">=</span> <span class="fl">1e-3</span>     <span class="co"># M-1 s-1 </span></a>
<a class="sourceLine" id="cb937-29" title="29"></a>
<a class="sourceLine" id="cb937-30" title="30">k1 <span class="op">=</span> k2<span class="op">*</span>np.exp((<span class="op">-</span>Ea<span class="op">/</span>R) <span class="op">*</span> (<span class="dv">1</span><span class="op">/</span>T1 <span class="op">-</span> <span class="dv">1</span><span class="op">/</span>T2))</a>
<a class="sourceLine" id="cb937-31" title="31">k1_codex <span class="op">=</span> arrhenius(k2,T2,T1,Ea)</a>
<a class="sourceLine" id="cb937-32" title="32"><span class="co">#print(k1,k1_codex)</span></a>
<a class="sourceLine" id="cb937-33" title="33"></a>
<a class="sourceLine" id="cb937-34" title="34"><span class="cf">if</span> np.isclose(k1,k1_codex) <span class="op">==</span> <span class="va">True</span>:</a>
<a class="sourceLine" id="cb937-35" title="35">    result <span class="op">=</span> <span class="va">True</span></a>
<a class="sourceLine" id="cb937-36" title="36"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb937-37" title="37">    result <span class="op">=</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb937-38" title="38"></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-85">Run 1</h4>
<div class="sourceCode" id="cb939"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb939-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb939-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb939-3" title="3"></a>
<a class="sourceLine" id="cb939-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb939-5" title="5"><span class="co">compute sin(pi/2)</span></a>
<a class="sourceLine" id="cb939-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb939-7" title="7">x <span class="op">=</span> math.sin(math.pi <span class="op">/</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb939-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb939-9" title="9"></a>
<a class="sourceLine" id="cb939-10" title="10"><span class="kw">def</span> arrhenius(k2,T2,T1,Ea):</a>
<a class="sourceLine" id="cb939-11" title="11">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb939-12" title="12"><span class="co">   This function returns the value of the rate constant at temperature T1 using the Arrhenius equation</span></a>
<a class="sourceLine" id="cb939-13" title="13"><span class="co">   k2 is the rate constant at temperature T2.</span></a>
<a class="sourceLine" id="cb939-14" title="14"><span class="co">   Ea is the activation energy in J/mol.</span></a>
<a class="sourceLine" id="cb939-15" title="15"><span class="co">   Temperatures are given in Kelvin</span></a>
<a class="sourceLine" id="cb939-16" title="16"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb939-17" title="17">   k1 <span class="op">=</span> k2 <span class="op">*</span> math.exp((Ea <span class="op">*</span> (<span class="dv">1</span><span class="op">/</span>T2 <span class="op">-</span> <span class="dv">1</span><span class="op">/</span>T1)) <span class="op">/</span> (<span class="fl">8.314</span> <span class="op">*</span> (<span class="dv">1</span><span class="op">/</span>T1)))</a>
<a class="sourceLine" id="cb939-18" title="18">   <span class="cf">return</span> k1</a>
<a class="sourceLine" id="cb939-19" title="19"></a>
<a class="sourceLine" id="cb939-20" title="20"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb939-21" title="21"></a>
<a class="sourceLine" id="cb939-22" title="22"><span class="co"># inputs</span></a>
<a class="sourceLine" id="cb939-23" title="23">T1 <span class="op">=</span> <span class="fl">308.18</span>   <span class="co"># in K</span></a>
<a class="sourceLine" id="cb939-24" title="24">T2 <span class="op">=</span> <span class="fl">333.18</span>   <span class="co"># in K</span></a>
<a class="sourceLine" id="cb939-25" title="25">R <span class="op">=</span> <span class="fl">8.314</span>     <span class="co"># J/mol.K</span></a>
<a class="sourceLine" id="cb939-26" title="26">Ea <span class="op">=</span> <span class="dv">108000</span>   <span class="co"># J/mol</span></a>
<a class="sourceLine" id="cb939-27" title="27">k2 <span class="op">=</span> <span class="fl">1e-3</span>     <span class="co"># M-1 s-1 </span></a>
<a class="sourceLine" id="cb939-28" title="28"></a>
<a class="sourceLine" id="cb939-29" title="29">k1 <span class="op">=</span> k2<span class="op">*</span>np.exp((<span class="op">-</span>Ea<span class="op">/</span>R) <span class="op">*</span> (<span class="dv">1</span><span class="op">/</span>T1 <span class="op">-</span> <span class="dv">1</span><span class="op">/</span>T2))</a>
<a class="sourceLine" id="cb939-30" title="30">k1_codex <span class="op">=</span> arrhenius(k2,T2,T1,Ea)</a>
<a class="sourceLine" id="cb939-31" title="31"><span class="co">#print(k1,k1_codex)</span></a>
<a class="sourceLine" id="cb939-32" title="32"></a>
<a class="sourceLine" id="cb939-33" title="33"><span class="cf">if</span> np.isclose(k1,k1_codex) <span class="op">==</span> <span class="va">True</span>:</a>
<a class="sourceLine" id="cb939-34" title="34">    result <span class="op">=</span> <span class="va">True</span></a>
<a class="sourceLine" id="cb939-35" title="35"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb939-36" title="36">    result <span class="op">=</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb939-37" title="37"></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-85">Run 2</h4>
<div class="sourceCode" id="cb941"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb941-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb941-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb941-3" title="3"></a>
<a class="sourceLine" id="cb941-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb941-5" title="5"><span class="co">compute sin(pi/2)</span></a>
<a class="sourceLine" id="cb941-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb941-7" title="7">x <span class="op">=</span> math.sin(math.pi <span class="op">/</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb941-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb941-9" title="9"></a>
<a class="sourceLine" id="cb941-10" title="10"><span class="kw">def</span> arrhenius(k2,T2,T1,Ea):</a>
<a class="sourceLine" id="cb941-11" title="11">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb941-12" title="12"><span class="co">   This function returns the value of the rate constant at temperature T1 using the Arrhenius equation</span></a>
<a class="sourceLine" id="cb941-13" title="13"><span class="co">   k2 is the rate constant at temperature T2.</span></a>
<a class="sourceLine" id="cb941-14" title="14"><span class="co">   Ea is the activation energy in J/mol.</span></a>
<a class="sourceLine" id="cb941-15" title="15"><span class="co">   Temperatures are given in Kelvin</span></a>
<a class="sourceLine" id="cb941-16" title="16"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb941-17" title="17">   R <span class="op">=</span> <span class="fl">8.314</span> <span class="co"># J/mol/K</span></a>
<a class="sourceLine" id="cb941-18" title="18">   k1 <span class="op">=</span> k2 <span class="op">*</span> math.exp((Ea<span class="op">/</span>R) <span class="op">*</span> ((<span class="dv">1</span><span class="op">/</span>T2) <span class="op">-</span> (<span class="dv">1</span><span class="op">/</span>T1)))</a>
<a class="sourceLine" id="cb941-19" title="19">   <span class="cf">return</span> k1</a>
<a class="sourceLine" id="cb941-20" title="20"></a>
<a class="sourceLine" id="cb941-21" title="21"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb941-22" title="22"></a>
<a class="sourceLine" id="cb941-23" title="23"><span class="co"># inputs</span></a>
<a class="sourceLine" id="cb941-24" title="24">T1 <span class="op">=</span> <span class="fl">308.18</span>   <span class="co"># in K</span></a>
<a class="sourceLine" id="cb941-25" title="25">T2 <span class="op">=</span> <span class="fl">333.18</span>   <span class="co"># in K</span></a>
<a class="sourceLine" id="cb941-26" title="26">R <span class="op">=</span> <span class="fl">8.314</span>     <span class="co"># J/mol.K</span></a>
<a class="sourceLine" id="cb941-27" title="27">Ea <span class="op">=</span> <span class="dv">108000</span>   <span class="co"># J/mol</span></a>
<a class="sourceLine" id="cb941-28" title="28">k2 <span class="op">=</span> <span class="fl">1e-3</span>     <span class="co"># M-1 s-1 </span></a>
<a class="sourceLine" id="cb941-29" title="29"></a>
<a class="sourceLine" id="cb941-30" title="30">k1 <span class="op">=</span> k2<span class="op">*</span>np.exp((<span class="op">-</span>Ea<span class="op">/</span>R) <span class="op">*</span> (<span class="dv">1</span><span class="op">/</span>T1 <span class="op">-</span> <span class="dv">1</span><span class="op">/</span>T2))</a>
<a class="sourceLine" id="cb941-31" title="31">k1_codex <span class="op">=</span> arrhenius(k2,T2,T1,Ea)</a>
<a class="sourceLine" id="cb941-32" title="32"><span class="co">#print(k1,k1_codex)</span></a>
<a class="sourceLine" id="cb941-33" title="33"></a>
<a class="sourceLine" id="cb941-34" title="34"><span class="cf">if</span> np.isclose(k1,k1_codex) <span class="op">==</span> <span class="va">True</span>:</a>
<a class="sourceLine" id="cb941-35" title="35">    result <span class="op">=</span> <span class="va">True</span></a>
<a class="sourceLine" id="cb941-36" title="36"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb941-37" title="37">    result <span class="op">=</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb941-38" title="38"></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-85">Run 3</h4>
<div class="sourceCode" id="cb943"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb943-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb943-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb943-3" title="3"></a>
<a class="sourceLine" id="cb943-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb943-5" title="5"><span class="co">compute sin(pi/2)</span></a>
<a class="sourceLine" id="cb943-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb943-7" title="7">x <span class="op">=</span> math.sin(math.pi <span class="op">/</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb943-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb943-9" title="9"></a>
<a class="sourceLine" id="cb943-10" title="10"><span class="kw">def</span> arrhenius(k2,T2,T1,Ea):</a>
<a class="sourceLine" id="cb943-11" title="11">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb943-12" title="12"><span class="co">   This function returns the value of the rate constant at temperature T1 using the Arrhenius equation</span></a>
<a class="sourceLine" id="cb943-13" title="13"><span class="co">   k2 is the rate constant at temperature T2.</span></a>
<a class="sourceLine" id="cb943-14" title="14"><span class="co">   Ea is the activation energy in J/mol.</span></a>
<a class="sourceLine" id="cb943-15" title="15"><span class="co">   Temperatures are given in Kelvin</span></a>
<a class="sourceLine" id="cb943-16" title="16"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb943-17" title="17">   k1 <span class="op">=</span> k2 <span class="op">*</span> math.exp((Ea<span class="op">/</span><span class="fl">8.314</span>) <span class="op">*</span> (<span class="dv">1</span><span class="op">/</span>T2 <span class="op">-</span> <span class="dv">1</span><span class="op">/</span>T1))</a>
<a class="sourceLine" id="cb943-18" title="18">   <span class="cf">return</span> k1</a>
<a class="sourceLine" id="cb943-19" title="19"></a>
<a class="sourceLine" id="cb943-20" title="20"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb943-21" title="21"></a>
<a class="sourceLine" id="cb943-22" title="22"><span class="co"># inputs</span></a>
<a class="sourceLine" id="cb943-23" title="23">T1 <span class="op">=</span> <span class="fl">308.18</span>   <span class="co"># in K</span></a>
<a class="sourceLine" id="cb943-24" title="24">T2 <span class="op">=</span> <span class="fl">333.18</span>   <span class="co"># in K</span></a>
<a class="sourceLine" id="cb943-25" title="25">R <span class="op">=</span> <span class="fl">8.314</span>     <span class="co"># J/mol.K</span></a>
<a class="sourceLine" id="cb943-26" title="26">Ea <span class="op">=</span> <span class="dv">108000</span>   <span class="co"># J/mol</span></a>
<a class="sourceLine" id="cb943-27" title="27">k2 <span class="op">=</span> <span class="fl">1e-3</span>     <span class="co"># M-1 s-1 </span></a>
<a class="sourceLine" id="cb943-28" title="28"></a>
<a class="sourceLine" id="cb943-29" title="29">k1 <span class="op">=</span> k2<span class="op">*</span>np.exp((<span class="op">-</span>Ea<span class="op">/</span>R) <span class="op">*</span> (<span class="dv">1</span><span class="op">/</span>T1 <span class="op">-</span> <span class="dv">1</span><span class="op">/</span>T2))</a>
<a class="sourceLine" id="cb943-30" title="30">k1_codex <span class="op">=</span> arrhenius(k2,T2,T1,Ea)</a>
<a class="sourceLine" id="cb943-31" title="31"><span class="co">#print(k1,k1_codex)</span></a>
<a class="sourceLine" id="cb943-32" title="32"></a>
<a class="sourceLine" id="cb943-33" title="33"><span class="cf">if</span> np.isclose(k1,k1_codex) <span class="op">==</span> <span class="va">True</span>:</a>
<a class="sourceLine" id="cb943-34" title="34">    result <span class="op">=</span> <span class="va">True</span></a>
<a class="sourceLine" id="cb943-35" title="35"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb943-36" title="36">    result <span class="op">=</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb943-37" title="37"></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-85">Run 4</h4>
<div class="sourceCode" id="cb945"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb945-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb945-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb945-3" title="3"></a>
<a class="sourceLine" id="cb945-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb945-5" title="5"><span class="co">compute sin(pi/2)</span></a>
<a class="sourceLine" id="cb945-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb945-7" title="7">x <span class="op">=</span> math.sin(math.pi <span class="op">/</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb945-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb945-9" title="9"></a>
<a class="sourceLine" id="cb945-10" title="10"><span class="kw">def</span> arrhenius(k2,T2,T1,Ea):</a>
<a class="sourceLine" id="cb945-11" title="11">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb945-12" title="12"><span class="co">   This function returns the value of the rate constant at temperature T1 using the Arrhenius equation</span></a>
<a class="sourceLine" id="cb945-13" title="13"><span class="co">   k2 is the rate constant at temperature T2.</span></a>
<a class="sourceLine" id="cb945-14" title="14"><span class="co">   Ea is the activation energy in J/mol.</span></a>
<a class="sourceLine" id="cb945-15" title="15"><span class="co">   Temperatures are given in Kelvin</span></a>
<a class="sourceLine" id="cb945-16" title="16"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb945-17" title="17">   R <span class="op">=</span> <span class="fl">8.314</span> <span class="co"># J/mol/K</span></a>
<a class="sourceLine" id="cb945-18" title="18">   k1 <span class="op">=</span> k2 <span class="op">*</span> math.exp((Ea<span class="op">/</span>R)<span class="op">*</span>((<span class="dv">1</span><span class="op">/</span>T1)<span class="op">-</span>(<span class="dv">1</span><span class="op">/</span>T2)))</a>
<a class="sourceLine" id="cb945-19" title="19">   <span class="cf">return</span> k1</a>
<a class="sourceLine" id="cb945-20" title="20"></a>
<a class="sourceLine" id="cb945-21" title="21"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb945-22" title="22"></a>
<a class="sourceLine" id="cb945-23" title="23"><span class="co"># inputs</span></a>
<a class="sourceLine" id="cb945-24" title="24">T1 <span class="op">=</span> <span class="fl">308.18</span>   <span class="co"># in K</span></a>
<a class="sourceLine" id="cb945-25" title="25">T2 <span class="op">=</span> <span class="fl">333.18</span>   <span class="co"># in K</span></a>
<a class="sourceLine" id="cb945-26" title="26">R <span class="op">=</span> <span class="fl">8.314</span>     <span class="co"># J/mol.K</span></a>
<a class="sourceLine" id="cb945-27" title="27">Ea <span class="op">=</span> <span class="dv">108000</span>   <span class="co"># J/mol</span></a>
<a class="sourceLine" id="cb945-28" title="28">k2 <span class="op">=</span> <span class="fl">1e-3</span>     <span class="co"># M-1 s-1 </span></a>
<a class="sourceLine" id="cb945-29" title="29"></a>
<a class="sourceLine" id="cb945-30" title="30">k1 <span class="op">=</span> k2<span class="op">*</span>np.exp((<span class="op">-</span>Ea<span class="op">/</span>R) <span class="op">*</span> (<span class="dv">1</span><span class="op">/</span>T1 <span class="op">-</span> <span class="dv">1</span><span class="op">/</span>T2))</a>
<a class="sourceLine" id="cb945-31" title="31">k1_codex <span class="op">=</span> arrhenius(k2,T2,T1,Ea)</a>
<a class="sourceLine" id="cb945-32" title="32"><span class="co">#print(k1,k1_codex)</span></a>
<a class="sourceLine" id="cb945-33" title="33"></a>
<a class="sourceLine" id="cb945-34" title="34"><span class="cf">if</span> np.isclose(k1,k1_codex) <span class="op">==</span> <span class="va">True</span>:</a>
<a class="sourceLine" id="cb945-35" title="35">    result <span class="op">=</span> <span class="va">True</span></a>
<a class="sourceLine" id="cb945-36" title="36"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb945-37" title="37">    result <span class="op">=</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb945-38" title="38"></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>bimolecular</summary></p>
<h4 id="query-86">Query</h4>
<div class="sourceCode" id="cb947"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb947-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb947-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb947-3" title="3"></a>
<a class="sourceLine" id="cb947-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb947-5" title="5"><span class="co">compute sin(pi/2)</span></a>
<a class="sourceLine" id="cb947-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb947-7" title="7">x <span class="op">=</span> math.sin(math.pi <span class="op">/</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb947-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb947-9" title="9"></a>
<a class="sourceLine" id="cb947-10" title="10"><span class="kw">def</span> bimolecular_rate(k,A,B):</a>
<a class="sourceLine" id="cb947-11" title="11">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb947-12" title="12"><span class="co">   This function returns the rate of reaction given the rate constant k and concentrations of species A and B</span></a>
<a class="sourceLine" id="cb947-13" title="13"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb947-14" title="14">   </a></code></pre></div>
<h4 id="run-0-86">Run 0</h4>
<div class="sourceCode" id="cb948"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb948-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb948-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb948-3" title="3"></a>
<a class="sourceLine" id="cb948-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb948-5" title="5"><span class="co">compute sin(pi/2)</span></a>
<a class="sourceLine" id="cb948-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb948-7" title="7">x <span class="op">=</span> math.sin(math.pi <span class="op">/</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb948-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb948-9" title="9"></a>
<a class="sourceLine" id="cb948-10" title="10"><span class="kw">def</span> bimolecular_rate(k,A,B):</a>
<a class="sourceLine" id="cb948-11" title="11">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb948-12" title="12"><span class="co">   This function returns the rate of reaction given the rate constant k and concentrations of species A and B</span></a>
<a class="sourceLine" id="cb948-13" title="13"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb948-14" title="14">   <span class="cf">return</span> k<span class="op">*</span>A<span class="op">*</span>B</a>
<a class="sourceLine" id="cb948-15" title="15"></a>
<a class="sourceLine" id="cb948-16" title="16"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb948-17" title="17"></a>
<a class="sourceLine" id="cb948-18" title="18">k <span class="op">=</span> <span class="dv">2</span></a>
<a class="sourceLine" id="cb948-19" title="19">A <span class="op">=</span> <span class="fl">0.1</span></a>
<a class="sourceLine" id="cb948-20" title="20">B <span class="op">=</span> <span class="fl">0.2</span></a>
<a class="sourceLine" id="cb948-21" title="21">rate <span class="op">=</span> k<span class="op">*</span>A<span class="op">*</span>B</a>
<a class="sourceLine" id="cb948-22" title="22"></a>
<a class="sourceLine" id="cb948-23" title="23">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(rate,bimolecular_rate(k,A,B)) <span class="cf">else</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb948-24" title="24"></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-86">Run 1</h4>
<div class="sourceCode" id="cb950"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb950-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb950-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb950-3" title="3"></a>
<a class="sourceLine" id="cb950-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb950-5" title="5"><span class="co">compute sin(pi/2)</span></a>
<a class="sourceLine" id="cb950-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb950-7" title="7">x <span class="op">=</span> math.sin(math.pi <span class="op">/</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb950-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb950-9" title="9"></a>
<a class="sourceLine" id="cb950-10" title="10"><span class="kw">def</span> bimolecular_rate(k,A,B):</a>
<a class="sourceLine" id="cb950-11" title="11">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb950-12" title="12"><span class="co">   This function returns the rate of reaction given the rate constant k and concentrations of species A and B</span></a>
<a class="sourceLine" id="cb950-13" title="13"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb950-14" title="14">   <span class="cf">return</span> k<span class="op">*</span>A<span class="op">*</span>B</a>
<a class="sourceLine" id="cb950-15" title="15"></a>
<a class="sourceLine" id="cb950-16" title="16"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb950-17" title="17"></a>
<a class="sourceLine" id="cb950-18" title="18">k <span class="op">=</span> <span class="dv">2</span></a>
<a class="sourceLine" id="cb950-19" title="19">A <span class="op">=</span> <span class="fl">0.1</span></a>
<a class="sourceLine" id="cb950-20" title="20">B <span class="op">=</span> <span class="fl">0.2</span></a>
<a class="sourceLine" id="cb950-21" title="21">rate <span class="op">=</span> k<span class="op">*</span>A<span class="op">*</span>B</a>
<a class="sourceLine" id="cb950-22" title="22"></a>
<a class="sourceLine" id="cb950-23" title="23">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(rate,bimolecular_rate(k,A,B)) <span class="cf">else</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb950-24" title="24"></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-86">Run 2</h4>
<div class="sourceCode" id="cb952"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb952-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb952-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb952-3" title="3"></a>
<a class="sourceLine" id="cb952-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb952-5" title="5"><span class="co">compute sin(pi/2)</span></a>
<a class="sourceLine" id="cb952-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb952-7" title="7">x <span class="op">=</span> math.sin(math.pi <span class="op">/</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb952-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb952-9" title="9"></a>
<a class="sourceLine" id="cb952-10" title="10"><span class="kw">def</span> bimolecular_rate(k,A,B):</a>
<a class="sourceLine" id="cb952-11" title="11">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb952-12" title="12"><span class="co">   This function returns the rate of reaction given the rate constant k and concentrations of species A and B</span></a>
<a class="sourceLine" id="cb952-13" title="13"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb952-14" title="14">   <span class="cf">return</span> k<span class="op">*</span>A<span class="op">*</span>B</a>
<a class="sourceLine" id="cb952-15" title="15"></a>
<a class="sourceLine" id="cb952-16" title="16"></a>
<a class="sourceLine" id="cb952-17" title="17"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb952-18" title="18"></a>
<a class="sourceLine" id="cb952-19" title="19">k <span class="op">=</span> <span class="dv">2</span></a>
<a class="sourceLine" id="cb952-20" title="20">A <span class="op">=</span> <span class="fl">0.1</span></a>
<a class="sourceLine" id="cb952-21" title="21">B <span class="op">=</span> <span class="fl">0.2</span></a>
<a class="sourceLine" id="cb952-22" title="22">rate <span class="op">=</span> k<span class="op">*</span>A<span class="op">*</span>B</a>
<a class="sourceLine" id="cb952-23" title="23"></a>
<a class="sourceLine" id="cb952-24" title="24">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(rate,bimolecular_rate(k,A,B)) <span class="cf">else</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb952-25" title="25"></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-86">Run 3</h4>
<div class="sourceCode" id="cb954"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb954-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb954-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb954-3" title="3"></a>
<a class="sourceLine" id="cb954-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb954-5" title="5"><span class="co">compute sin(pi/2)</span></a>
<a class="sourceLine" id="cb954-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb954-7" title="7">x <span class="op">=</span> math.sin(math.pi <span class="op">/</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb954-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb954-9" title="9"></a>
<a class="sourceLine" id="cb954-10" title="10"><span class="kw">def</span> bimolecular_rate(k,A,B):</a>
<a class="sourceLine" id="cb954-11" title="11">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb954-12" title="12"><span class="co">   This function returns the rate of reaction given the rate constant k and concentrations of species A and B</span></a>
<a class="sourceLine" id="cb954-13" title="13"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb954-14" title="14">   <span class="cf">return</span> k<span class="op">*</span>A<span class="op">*</span>B</a>
<a class="sourceLine" id="cb954-15" title="15"></a>
<a class="sourceLine" id="cb954-16" title="16"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb954-17" title="17"></a>
<a class="sourceLine" id="cb954-18" title="18">k <span class="op">=</span> <span class="dv">2</span></a>
<a class="sourceLine" id="cb954-19" title="19">A <span class="op">=</span> <span class="fl">0.1</span></a>
<a class="sourceLine" id="cb954-20" title="20">B <span class="op">=</span> <span class="fl">0.2</span></a>
<a class="sourceLine" id="cb954-21" title="21">rate <span class="op">=</span> k<span class="op">*</span>A<span class="op">*</span>B</a>
<a class="sourceLine" id="cb954-22" title="22"></a>
<a class="sourceLine" id="cb954-23" title="23">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(rate,bimolecular_rate(k,A,B)) <span class="cf">else</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb954-24" title="24"></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-86">Run 4</h4>
<div class="sourceCode" id="cb956"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb956-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb956-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb956-3" title="3"></a>
<a class="sourceLine" id="cb956-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb956-5" title="5"><span class="co">compute sin(pi/2)</span></a>
<a class="sourceLine" id="cb956-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb956-7" title="7">x <span class="op">=</span> math.sin(math.pi <span class="op">/</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb956-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb956-9" title="9"></a>
<a class="sourceLine" id="cb956-10" title="10"><span class="kw">def</span> bimolecular_rate(k,A,B):</a>
<a class="sourceLine" id="cb956-11" title="11">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb956-12" title="12"><span class="co">   This function returns the rate of reaction given the rate constant k and concentrations of species A and B</span></a>
<a class="sourceLine" id="cb956-13" title="13"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb956-14" title="14">   <span class="cf">return</span> k<span class="op">*</span>A<span class="op">*</span>B</a>
<a class="sourceLine" id="cb956-15" title="15"></a>
<a class="sourceLine" id="cb956-16" title="16"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb956-17" title="17"></a>
<a class="sourceLine" id="cb956-18" title="18">k <span class="op">=</span> <span class="dv">2</span></a>
<a class="sourceLine" id="cb956-19" title="19">A <span class="op">=</span> <span class="fl">0.1</span></a>
<a class="sourceLine" id="cb956-20" title="20">B <span class="op">=</span> <span class="fl">0.2</span></a>
<a class="sourceLine" id="cb956-21" title="21">rate <span class="op">=</span> k<span class="op">*</span>A<span class="op">*</span>B</a>
<a class="sourceLine" id="cb956-22" title="22"></a>
<a class="sourceLine" id="cb956-23" title="23">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(rate,bimolecular_rate(k,A,B)) <span class="cf">else</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb956-24" title="24"></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>bb_rad</summary></p>
<h4 id="query-87">Query</h4>
<div class="sourceCode" id="cb958"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb958-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb958-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb958-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb958-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb958-5" title="5"></a>
<a class="sourceLine" id="cb958-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb958-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb958-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb958-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb958-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb958-11" title="11"></a>
<a class="sourceLine" id="cb958-12" title="12"><span class="kw">def</span> bb_radiation(lam, T):</a>
<a class="sourceLine" id="cb958-13" title="13">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb958-14" title="14"><span class="co">   This function calculates and returns the spectral radiance value in SI unit for wavelength lam at temperature T, using planck&#39;s law of black body radiation.</span></a>
<a class="sourceLine" id="cb958-15" title="15"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb958-16" title="16">   </a></code></pre></div>
<h4 id="run-0-87">Run 0</h4>
<div class="sourceCode" id="cb959"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb959-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb959-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb959-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb959-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb959-5" title="5"></a>
<a class="sourceLine" id="cb959-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb959-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb959-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb959-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb959-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb959-11" title="11"></a>
<a class="sourceLine" id="cb959-12" title="12"><span class="kw">def</span> bb_radiation(lam, T):</a>
<a class="sourceLine" id="cb959-13" title="13">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb959-14" title="14"><span class="co">   This function calculates and returns the spectral radiance value in SI unit for wavelength lam at temperature T, using planck&#39;s law of black body radiation.</span></a>
<a class="sourceLine" id="cb959-15" title="15"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb959-16" title="16">   h <span class="op">=</span> <span class="fl">6.626e-34</span></a>
<a class="sourceLine" id="cb959-17" title="17">   c <span class="op">=</span> <span class="fl">3.0e+8</span></a>
<a class="sourceLine" id="cb959-18" title="18">   k <span class="op">=</span> <span class="fl">1.38e-23</span></a>
<a class="sourceLine" id="cb959-19" title="19">   <span class="cf">return</span> <span class="dv">2</span><span class="op">*</span>h<span class="op">*</span>c<span class="op">**</span><span class="dv">2</span><span class="op">/</span>lam<span class="op">**</span><span class="dv">5</span><span class="op">/</span>(np.exp(h<span class="op">*</span>c<span class="op">/</span>(lam<span class="op">*</span>k<span class="op">*</span>T))<span class="op">-</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb959-20" title="20"></a>
<a class="sourceLine" id="cb959-21" title="21"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb959-22" title="22"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb959-23" title="23"></a>
<a class="sourceLine" id="cb959-24" title="24"><span class="co"># input params</span></a>
<a class="sourceLine" id="cb959-25" title="25">h <span class="op">=</span> <span class="fl">6.634e-34</span>       <span class="co"># J.s</span></a>
<a class="sourceLine" id="cb959-26" title="26">c <span class="op">=</span> <span class="fl">3.0e8</span>           <span class="co"># m/s</span></a>
<a class="sourceLine" id="cb959-27" title="27">k <span class="op">=</span> <span class="fl">1.381e-23</span>       <span class="co"># J.K-1</span></a>
<a class="sourceLine" id="cb959-28" title="28">T <span class="op">=</span> <span class="dv">5000</span>            <span class="co"># in K</span></a>
<a class="sourceLine" id="cb959-29" title="29">lamb_val <span class="op">=</span> <span class="fl">1.0e-6</span>   <span class="co"># in m</span></a>
<a class="sourceLine" id="cb959-30" title="30"></a>
<a class="sourceLine" id="cb959-31" title="31"></a>
<a class="sourceLine" id="cb959-32" title="32"><span class="co"># spectral radiance</span></a>
<a class="sourceLine" id="cb959-33" title="33">B <span class="op">=</span> (<span class="dv">2</span><span class="op">*</span>h<span class="op">*</span>c<span class="op">**</span><span class="dv">2</span><span class="op">/</span>lamb_val<span class="op">**</span><span class="dv">5</span>) <span class="op">*</span> (<span class="dv">1</span><span class="op">/</span>(np.exp(h<span class="op">*</span>c<span class="op">/</span>(lamb_val<span class="op">*</span>k<span class="op">*</span>T)) <span class="op">-</span> <span class="dv">1</span>))</a>
<a class="sourceLine" id="cb959-34" title="34"><span class="bu">print</span>(<span class="st">&quot;spectral radiance =&quot;</span>, B)</a>
<a class="sourceLine" id="cb959-35" title="35"></a>
<a class="sourceLine" id="cb959-36" title="36">B_codex <span class="op">=</span> bb_radiation(lamb_val, T)</a>
<a class="sourceLine" id="cb959-37" title="37"><span class="bu">print</span>(<span class="st">&quot;spectral radiance from codex =&quot;</span>, B_codex)</a>
<a class="sourceLine" id="cb959-38" title="38"></a>
<a class="sourceLine" id="cb959-39" title="39"></a>
<a class="sourceLine" id="cb959-40" title="40"><span class="co"># check</span></a>
<a class="sourceLine" id="cb959-41" title="41"><span class="cf">if</span> <span class="bu">abs</span>((B <span class="op">-</span> B_codex) <span class="op">/</span> B) <span class="op">&lt;=</span> <span class="fl">1e-2</span>:</a>
<a class="sourceLine" id="cb959-42" title="42">    result <span class="op">=</span> <span class="va">True</span></a>
<a class="sourceLine" id="cb959-43" title="43"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb959-44" title="44">    result <span class="op">=</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-87">Run 1</h4>
<div class="sourceCode" id="cb961"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb961-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb961-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb961-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb961-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb961-5" title="5"></a>
<a class="sourceLine" id="cb961-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb961-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb961-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb961-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb961-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb961-11" title="11"></a>
<a class="sourceLine" id="cb961-12" title="12"><span class="kw">def</span> bb_radiation(lam, T):</a>
<a class="sourceLine" id="cb961-13" title="13">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb961-14" title="14"><span class="co">   This function calculates and returns the spectral radiance value in SI unit for wavelength lam at temperature T, using planck&#39;s law of black body radiation.</span></a>
<a class="sourceLine" id="cb961-15" title="15"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb961-16" title="16">   c <span class="op">=</span> <span class="fl">3e8</span></a>
<a class="sourceLine" id="cb961-17" title="17">   h <span class="op">=</span> <span class="fl">6.626e-34</span></a>
<a class="sourceLine" id="cb961-18" title="18">   k <span class="op">=</span> <span class="fl">1.38e-23</span></a>
<a class="sourceLine" id="cb961-19" title="19">   <span class="cf">return</span> <span class="dv">2</span><span class="op">*</span>h<span class="op">*</span>c<span class="op">**</span><span class="dv">2</span><span class="op">/</span>(lam<span class="op">**</span><span class="dv">5</span><span class="op">*</span>(np.exp(h<span class="op">*</span>c<span class="op">/</span>(lam<span class="op">*</span>k<span class="op">*</span>T))<span class="op">-</span><span class="dv">1</span>))</a>
<a class="sourceLine" id="cb961-20" title="20"></a>
<a class="sourceLine" id="cb961-21" title="21"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb961-22" title="22"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb961-23" title="23"></a>
<a class="sourceLine" id="cb961-24" title="24"><span class="co"># input params</span></a>
<a class="sourceLine" id="cb961-25" title="25">h <span class="op">=</span> <span class="fl">6.634e-34</span>       <span class="co"># J.s</span></a>
<a class="sourceLine" id="cb961-26" title="26">c <span class="op">=</span> <span class="fl">3.0e8</span>           <span class="co"># m/s</span></a>
<a class="sourceLine" id="cb961-27" title="27">k <span class="op">=</span> <span class="fl">1.381e-23</span>       <span class="co"># J.K-1</span></a>
<a class="sourceLine" id="cb961-28" title="28">T <span class="op">=</span> <span class="dv">5000</span>            <span class="co"># in K</span></a>
<a class="sourceLine" id="cb961-29" title="29">lamb_val <span class="op">=</span> <span class="fl">1.0e-6</span>   <span class="co"># in m</span></a>
<a class="sourceLine" id="cb961-30" title="30"></a>
<a class="sourceLine" id="cb961-31" title="31"></a>
<a class="sourceLine" id="cb961-32" title="32"><span class="co"># spectral radiance</span></a>
<a class="sourceLine" id="cb961-33" title="33">B <span class="op">=</span> (<span class="dv">2</span><span class="op">*</span>h<span class="op">*</span>c<span class="op">**</span><span class="dv">2</span><span class="op">/</span>lamb_val<span class="op">**</span><span class="dv">5</span>) <span class="op">*</span> (<span class="dv">1</span><span class="op">/</span>(np.exp(h<span class="op">*</span>c<span class="op">/</span>(lamb_val<span class="op">*</span>k<span class="op">*</span>T)) <span class="op">-</span> <span class="dv">1</span>))</a>
<a class="sourceLine" id="cb961-34" title="34"><span class="bu">print</span>(<span class="st">&quot;spectral radiance =&quot;</span>, B)</a>
<a class="sourceLine" id="cb961-35" title="35"></a>
<a class="sourceLine" id="cb961-36" title="36">B_codex <span class="op">=</span> bb_radiation(lamb_val, T)</a>
<a class="sourceLine" id="cb961-37" title="37"><span class="bu">print</span>(<span class="st">&quot;spectral radiance from codex =&quot;</span>, B_codex)</a>
<a class="sourceLine" id="cb961-38" title="38"></a>
<a class="sourceLine" id="cb961-39" title="39"></a>
<a class="sourceLine" id="cb961-40" title="40"><span class="co"># check</span></a>
<a class="sourceLine" id="cb961-41" title="41"><span class="cf">if</span> <span class="bu">abs</span>((B <span class="op">-</span> B_codex) <span class="op">/</span> B) <span class="op">&lt;=</span> <span class="fl">1e-2</span>:</a>
<a class="sourceLine" id="cb961-42" title="42">    result <span class="op">=</span> <span class="va">True</span></a>
<a class="sourceLine" id="cb961-43" title="43"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb961-44" title="44">    result <span class="op">=</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-87">Run 2</h4>
<div class="sourceCode" id="cb963"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb963-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb963-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb963-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb963-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb963-5" title="5"></a>
<a class="sourceLine" id="cb963-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb963-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb963-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb963-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb963-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb963-11" title="11"></a>
<a class="sourceLine" id="cb963-12" title="12"><span class="kw">def</span> bb_radiation(lam, T):</a>
<a class="sourceLine" id="cb963-13" title="13">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb963-14" title="14"><span class="co">   This function calculates and returns the spectral radiance value in SI unit for wavelength lam at temperature T, using planck&#39;s law of black body radiation.</span></a>
<a class="sourceLine" id="cb963-15" title="15"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb963-16" title="16">   <span class="co"># start</span></a>
<a class="sourceLine" id="cb963-17" title="17">   h <span class="op">=</span> <span class="fl">6.626e-34</span></a>
<a class="sourceLine" id="cb963-18" title="18">   c <span class="op">=</span> <span class="fl">3.0e+8</span></a>
<a class="sourceLine" id="cb963-19" title="19">   k <span class="op">=</span> <span class="fl">1.38e-23</span></a>
<a class="sourceLine" id="cb963-20" title="20">   B <span class="op">=</span> <span class="fl">2.0</span><span class="op">*</span>h<span class="op">*</span>c<span class="op">**</span><span class="dv">2</span><span class="op">/</span>lam<span class="op">**</span><span class="dv">5</span><span class="op">/</span>(np.exp(h<span class="op">*</span>c<span class="op">/</span>(lam<span class="op">*</span>k<span class="op">*</span>T))<span class="op">-</span><span class="fl">1.0</span>)</a>
<a class="sourceLine" id="cb963-21" title="21">   <span class="cf">return</span> B</a>
<a class="sourceLine" id="cb963-22" title="22">   </a>
<a class="sourceLine" id="cb963-23" title="23"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb963-24" title="24"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb963-25" title="25"></a>
<a class="sourceLine" id="cb963-26" title="26"><span class="co"># input params</span></a>
<a class="sourceLine" id="cb963-27" title="27">h <span class="op">=</span> <span class="fl">6.634e-34</span>       <span class="co"># J.s</span></a>
<a class="sourceLine" id="cb963-28" title="28">c <span class="op">=</span> <span class="fl">3.0e8</span>           <span class="co"># m/s</span></a>
<a class="sourceLine" id="cb963-29" title="29">k <span class="op">=</span> <span class="fl">1.381e-23</span>       <span class="co"># J.K-1</span></a>
<a class="sourceLine" id="cb963-30" title="30">T <span class="op">=</span> <span class="dv">5000</span>            <span class="co"># in K</span></a>
<a class="sourceLine" id="cb963-31" title="31">lamb_val <span class="op">=</span> <span class="fl">1.0e-6</span>   <span class="co"># in m</span></a>
<a class="sourceLine" id="cb963-32" title="32"></a>
<a class="sourceLine" id="cb963-33" title="33"></a>
<a class="sourceLine" id="cb963-34" title="34"><span class="co"># spectral radiance</span></a>
<a class="sourceLine" id="cb963-35" title="35">B <span class="op">=</span> (<span class="dv">2</span><span class="op">*</span>h<span class="op">*</span>c<span class="op">**</span><span class="dv">2</span><span class="op">/</span>lamb_val<span class="op">**</span><span class="dv">5</span>) <span class="op">*</span> (<span class="dv">1</span><span class="op">/</span>(np.exp(h<span class="op">*</span>c<span class="op">/</span>(lamb_val<span class="op">*</span>k<span class="op">*</span>T)) <span class="op">-</span> <span class="dv">1</span>))</a>
<a class="sourceLine" id="cb963-36" title="36"><span class="bu">print</span>(<span class="st">&quot;spectral radiance =&quot;</span>, B)</a>
<a class="sourceLine" id="cb963-37" title="37"></a>
<a class="sourceLine" id="cb963-38" title="38">B_codex <span class="op">=</span> bb_radiation(lamb_val, T)</a>
<a class="sourceLine" id="cb963-39" title="39"><span class="bu">print</span>(<span class="st">&quot;spectral radiance from codex =&quot;</span>, B_codex)</a>
<a class="sourceLine" id="cb963-40" title="40"></a>
<a class="sourceLine" id="cb963-41" title="41"></a>
<a class="sourceLine" id="cb963-42" title="42"><span class="co"># check</span></a>
<a class="sourceLine" id="cb963-43" title="43"><span class="cf">if</span> <span class="bu">abs</span>((B <span class="op">-</span> B_codex) <span class="op">/</span> B) <span class="op">&lt;=</span> <span class="fl">1e-2</span>:</a>
<a class="sourceLine" id="cb963-44" title="44">    result <span class="op">=</span> <span class="va">True</span></a>
<a class="sourceLine" id="cb963-45" title="45"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb963-46" title="46">    result <span class="op">=</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-87">Run 3</h4>
<div class="sourceCode" id="cb965"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb965-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb965-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb965-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb965-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb965-5" title="5"></a>
<a class="sourceLine" id="cb965-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb965-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb965-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb965-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb965-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb965-11" title="11"></a>
<a class="sourceLine" id="cb965-12" title="12"><span class="kw">def</span> bb_radiation(lam, T):</a>
<a class="sourceLine" id="cb965-13" title="13">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb965-14" title="14"><span class="co">   This function calculates and returns the spectral radiance value in SI unit for wavelength lam at temperature T, using planck&#39;s law of black body radiation.</span></a>
<a class="sourceLine" id="cb965-15" title="15"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb965-16" title="16">   h <span class="op">=</span> <span class="fl">6.626e-34</span></a>
<a class="sourceLine" id="cb965-17" title="17">   c <span class="op">=</span> <span class="fl">3.0e+8</span></a>
<a class="sourceLine" id="cb965-18" title="18">   k <span class="op">=</span> <span class="fl">1.38e-23</span></a>
<a class="sourceLine" id="cb965-19" title="19">   <span class="cf">return</span> (<span class="dv">2</span><span class="op">*</span>h<span class="op">*</span>c<span class="op">**</span><span class="dv">2</span>)<span class="op">/</span>(lam<span class="op">**</span><span class="dv">5</span><span class="op">*</span>(np.exp((h<span class="op">*</span>c)<span class="op">/</span>(lam<span class="op">*</span>k<span class="op">*</span>T))<span class="op">-</span><span class="dv">1</span>))</a>
<a class="sourceLine" id="cb965-20" title="20">   </a>
<a class="sourceLine" id="cb965-21" title="21"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb965-22" title="22"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb965-23" title="23"></a>
<a class="sourceLine" id="cb965-24" title="24"><span class="co"># input params</span></a>
<a class="sourceLine" id="cb965-25" title="25">h <span class="op">=</span> <span class="fl">6.634e-34</span>       <span class="co"># J.s</span></a>
<a class="sourceLine" id="cb965-26" title="26">c <span class="op">=</span> <span class="fl">3.0e8</span>           <span class="co"># m/s</span></a>
<a class="sourceLine" id="cb965-27" title="27">k <span class="op">=</span> <span class="fl">1.381e-23</span>       <span class="co"># J.K-1</span></a>
<a class="sourceLine" id="cb965-28" title="28">T <span class="op">=</span> <span class="dv">5000</span>            <span class="co"># in K</span></a>
<a class="sourceLine" id="cb965-29" title="29">lamb_val <span class="op">=</span> <span class="fl">1.0e-6</span>   <span class="co"># in m</span></a>
<a class="sourceLine" id="cb965-30" title="30"></a>
<a class="sourceLine" id="cb965-31" title="31"></a>
<a class="sourceLine" id="cb965-32" title="32"><span class="co"># spectral radiance</span></a>
<a class="sourceLine" id="cb965-33" title="33">B <span class="op">=</span> (<span class="dv">2</span><span class="op">*</span>h<span class="op">*</span>c<span class="op">**</span><span class="dv">2</span><span class="op">/</span>lamb_val<span class="op">**</span><span class="dv">5</span>) <span class="op">*</span> (<span class="dv">1</span><span class="op">/</span>(np.exp(h<span class="op">*</span>c<span class="op">/</span>(lamb_val<span class="op">*</span>k<span class="op">*</span>T)) <span class="op">-</span> <span class="dv">1</span>))</a>
<a class="sourceLine" id="cb965-34" title="34"><span class="bu">print</span>(<span class="st">&quot;spectral radiance =&quot;</span>, B)</a>
<a class="sourceLine" id="cb965-35" title="35"></a>
<a class="sourceLine" id="cb965-36" title="36">B_codex <span class="op">=</span> bb_radiation(lamb_val, T)</a>
<a class="sourceLine" id="cb965-37" title="37"><span class="bu">print</span>(<span class="st">&quot;spectral radiance from codex =&quot;</span>, B_codex)</a>
<a class="sourceLine" id="cb965-38" title="38"></a>
<a class="sourceLine" id="cb965-39" title="39"></a>
<a class="sourceLine" id="cb965-40" title="40"><span class="co"># check</span></a>
<a class="sourceLine" id="cb965-41" title="41"><span class="cf">if</span> <span class="bu">abs</span>((B <span class="op">-</span> B_codex) <span class="op">/</span> B) <span class="op">&lt;=</span> <span class="fl">1e-2</span>:</a>
<a class="sourceLine" id="cb965-42" title="42">    result <span class="op">=</span> <span class="va">True</span></a>
<a class="sourceLine" id="cb965-43" title="43"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb965-44" title="44">    result <span class="op">=</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-87">Run 4</h4>
<div class="sourceCode" id="cb967"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb967-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb967-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb967-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb967-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb967-5" title="5"></a>
<a class="sourceLine" id="cb967-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb967-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb967-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb967-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb967-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb967-11" title="11"></a>
<a class="sourceLine" id="cb967-12" title="12"><span class="kw">def</span> bb_radiation(lam, T):</a>
<a class="sourceLine" id="cb967-13" title="13">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb967-14" title="14"><span class="co">   This function calculates and returns the spectral radiance value in SI unit for wavelength lam at temperature T, using planck&#39;s law of black body radiation.</span></a>
<a class="sourceLine" id="cb967-15" title="15"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb967-16" title="16">   h <span class="op">=</span> <span class="fl">6.626e-34</span></a>
<a class="sourceLine" id="cb967-17" title="17">   c <span class="op">=</span> <span class="fl">3.0e+8</span></a>
<a class="sourceLine" id="cb967-18" title="18">   k <span class="op">=</span> <span class="fl">1.38e-23</span></a>
<a class="sourceLine" id="cb967-19" title="19">   <span class="cf">return</span> (<span class="fl">2.0</span> <span class="op">*</span> h <span class="op">*</span> c<span class="op">**</span><span class="dv">2</span> <span class="op">/</span> lam<span class="op">**</span><span class="dv">5</span>) <span class="op">/</span> (np.exp(h <span class="op">*</span> c <span class="op">/</span> (lam <span class="op">*</span> k <span class="op">*</span> T)) <span class="op">-</span> <span class="fl">1.0</span>)</a>
<a class="sourceLine" id="cb967-20" title="20"></a>
<a class="sourceLine" id="cb967-21" title="21"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb967-22" title="22"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb967-23" title="23"></a>
<a class="sourceLine" id="cb967-24" title="24"><span class="co"># input params</span></a>
<a class="sourceLine" id="cb967-25" title="25">h <span class="op">=</span> <span class="fl">6.634e-34</span>       <span class="co"># J.s</span></a>
<a class="sourceLine" id="cb967-26" title="26">c <span class="op">=</span> <span class="fl">3.0e8</span>           <span class="co"># m/s</span></a>
<a class="sourceLine" id="cb967-27" title="27">k <span class="op">=</span> <span class="fl">1.381e-23</span>       <span class="co"># J.K-1</span></a>
<a class="sourceLine" id="cb967-28" title="28">T <span class="op">=</span> <span class="dv">5000</span>            <span class="co"># in K</span></a>
<a class="sourceLine" id="cb967-29" title="29">lamb_val <span class="op">=</span> <span class="fl">1.0e-6</span>   <span class="co"># in m</span></a>
<a class="sourceLine" id="cb967-30" title="30"></a>
<a class="sourceLine" id="cb967-31" title="31"></a>
<a class="sourceLine" id="cb967-32" title="32"><span class="co"># spectral radiance</span></a>
<a class="sourceLine" id="cb967-33" title="33">B <span class="op">=</span> (<span class="dv">2</span><span class="op">*</span>h<span class="op">*</span>c<span class="op">**</span><span class="dv">2</span><span class="op">/</span>lamb_val<span class="op">**</span><span class="dv">5</span>) <span class="op">*</span> (<span class="dv">1</span><span class="op">/</span>(np.exp(h<span class="op">*</span>c<span class="op">/</span>(lamb_val<span class="op">*</span>k<span class="op">*</span>T)) <span class="op">-</span> <span class="dv">1</span>))</a>
<a class="sourceLine" id="cb967-34" title="34"><span class="bu">print</span>(<span class="st">&quot;spectral radiance =&quot;</span>, B)</a>
<a class="sourceLine" id="cb967-35" title="35"></a>
<a class="sourceLine" id="cb967-36" title="36">B_codex <span class="op">=</span> bb_radiation(lamb_val, T)</a>
<a class="sourceLine" id="cb967-37" title="37"><span class="bu">print</span>(<span class="st">&quot;spectral radiance from codex =&quot;</span>, B_codex)</a>
<a class="sourceLine" id="cb967-38" title="38"></a>
<a class="sourceLine" id="cb967-39" title="39"></a>
<a class="sourceLine" id="cb967-40" title="40"><span class="co"># check</span></a>
<a class="sourceLine" id="cb967-41" title="41"><span class="cf">if</span> <span class="bu">abs</span>((B <span class="op">-</span> B_codex) <span class="op">/</span> B) <span class="op">&lt;=</span> <span class="fl">1e-2</span>:</a>
<a class="sourceLine" id="cb967-42" title="42">    result <span class="op">=</span> <span class="va">True</span></a>
<a class="sourceLine" id="cb967-43" title="43"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb967-44" title="44">    result <span class="op">=</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>blast</summary></p>
<h4 id="query-88">Query</h4>
<div class="sourceCode" id="cb969"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb969-1" title="1"><span class="im">import</span> requests</a>
<a class="sourceLine" id="cb969-2" title="2"><span class="im">from</span> bs4 <span class="im">import</span> BeautifulSoup</a>
<a class="sourceLine" id="cb969-3" title="3"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb969-4" title="4"></a>
<a class="sourceLine" id="cb969-5" title="5"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb969-6" title="6"><span class="co">print requests version</span></a>
<a class="sourceLine" id="cb969-7" title="7"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb969-8" title="8"><span class="bu">print</span>(requests.__version__)</a>
<a class="sourceLine" id="cb969-9" title="9"><span class="co"># end</span></a>
<a class="sourceLine" id="cb969-10" title="10"></a>
<a class="sourceLine" id="cb969-11" title="11"><span class="kw">def</span> blast(seq):</a>
<a class="sourceLine" id="cb969-12" title="12">    <span class="co">&#39;&#39;&#39;</span></a>
<a class="sourceLine" id="cb969-13" title="13"><span class="co">    Returns MSA with a BLAST search. Uses beautiful soup</span></a>
<a class="sourceLine" id="cb969-14" title="14"><span class="co">    to parse result.</span></a>
<a class="sourceLine" id="cb969-15" title="15"></a>
<a class="sourceLine" id="cb969-16" title="16"><span class="co">    1. import packages</span></a>
<a class="sourceLine" id="cb969-17" title="17"><span class="co">    2. Submit BLAST search with sequences</span></a>
<a class="sourceLine" id="cb969-18" title="18"><span class="co">    3. Get result</span></a>
<a class="sourceLine" id="cb969-19" title="19"><span class="co">    4. Parse MSA</span></a>
<a class="sourceLine" id="cb969-20" title="20"><span class="co">    5. Return a tuple of e score, id of top match</span></a>
<a class="sourceLine" id="cb969-21" title="21"><span class="co">    &#39;&#39;&#39;</span></a>
<a class="sourceLine" id="cb969-22" title="22">    </a></code></pre></div>
<h4 id="run-0-88">Run 0</h4>
<div class="sourceCode" id="cb970"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb970-1" title="1"><span class="im">import</span> requests</a>
<a class="sourceLine" id="cb970-2" title="2"><span class="im">from</span> bs4 <span class="im">import</span> BeautifulSoup</a>
<a class="sourceLine" id="cb970-3" title="3"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb970-4" title="4"></a>
<a class="sourceLine" id="cb970-5" title="5"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb970-6" title="6"><span class="co">print requests version</span></a>
<a class="sourceLine" id="cb970-7" title="7"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb970-8" title="8"><span class="bu">print</span>(requests.__version__)</a>
<a class="sourceLine" id="cb970-9" title="9"><span class="co"># end</span></a>
<a class="sourceLine" id="cb970-10" title="10"></a>
<a class="sourceLine" id="cb970-11" title="11"><span class="kw">def</span> blast(seq):</a>
<a class="sourceLine" id="cb970-12" title="12">    <span class="co">&#39;&#39;&#39;</span></a>
<a class="sourceLine" id="cb970-13" title="13"><span class="co">    Returns MSA with a BLAST search. Uses beautiful soup</span></a>
<a class="sourceLine" id="cb970-14" title="14"><span class="co">    to parse result.</span></a>
<a class="sourceLine" id="cb970-15" title="15"></a>
<a class="sourceLine" id="cb970-16" title="16"><span class="co">    1. import packages</span></a>
<a class="sourceLine" id="cb970-17" title="17"><span class="co">    2. Submit BLAST search with sequences</span></a>
<a class="sourceLine" id="cb970-18" title="18"><span class="co">    3. Get result</span></a>
<a class="sourceLine" id="cb970-19" title="19"><span class="co">    4. Parse MSA</span></a>
<a class="sourceLine" id="cb970-20" title="20"><span class="co">    5. Return a tuple of e score, id of top match</span></a>
<a class="sourceLine" id="cb970-21" title="21"><span class="co">    &#39;&#39;&#39;</span></a>
<a class="sourceLine" id="cb970-22" title="22">    <span class="co"># 1. import packages</span></a>
<a class="sourceLine" id="cb970-23" title="23">    <span class="im">import</span> requests</a>
<a class="sourceLine" id="cb970-24" title="24">    <span class="im">from</span> bs4 <span class="im">import</span> BeautifulSoup</a>
<a class="sourceLine" id="cb970-25" title="25">    <span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb970-26" title="26"></a>
<a class="sourceLine" id="cb970-27" title="27">    <span class="co"># 2. Submit BLAST search with sequences</span></a>
<a class="sourceLine" id="cb970-28" title="28">    url <span class="op">=</span> <span class="st">&#39;http://blast.ncbi.nlm.nih.gov/Blast.cgi&#39;</span></a>
<a class="sourceLine" id="cb970-29" title="29">    params <span class="op">=</span> {<span class="st">&#39;QUERY&#39;</span>: seq, <span class="st">&#39;PROGRAM&#39;</span>: <span class="st">&#39;blastp&#39;</span>, <span class="st">&#39;DATABASE&#39;</span>: <span class="st">&#39;nr&#39;</span>, <span class="st">&#39;CMD&#39;</span>: <span class="st">&#39;Put&#39;</span>}</a>
<a class="sourceLine" id="cb970-30" title="30">    r <span class="op">=</span> requests.post(url, data<span class="op">=</span>params)</a>
<a class="sourceLine" id="cb970-31" title="31"></a>
<a class="sourceLine" id="cb970-32" title="32">    <span class="co"># 3. Get result</span></a>
<a class="sourceLine" id="cb970-33" title="33">    soup <span class="op">=</span> BeautifulSoup(r.text, <span class="st">&#39;html.parser&#39;</span>)</a>
<a class="sourceLine" id="cb970-34" title="34">    result <span class="op">=</span> soup.find(<span class="st">&#39;pre&#39;</span>)</a>
<a class="sourceLine" id="cb970-35" title="35">    <span class="co">#print result.text</span></a>
<a class="sourceLine" id="cb970-36" title="36"></a>
<a class="sourceLine" id="cb970-37" title="37">    <span class="co"># 4. Parse MSA</span></a>
<a class="sourceLine" id="cb970-38" title="38">    msa <span class="op">=</span> []</a>
<a class="sourceLine" id="cb970-39" title="39">    <span class="cf">for</span> line <span class="kw">in</span> result.text.split(<span class="st">&#39;</span><span class="ch">\n</span><span class="st">&#39;</span>):</a>
<a class="sourceLine" id="cb970-40" title="40">        <span class="cf">if</span> line.startswith(<span class="st">&#39;Query=&#39;</span>):</a>
<a class="sourceLine" id="cb970-41" title="41">            msa.append(line)</a>
<a class="sourceLine" id="cb970-42" title="42">        <span class="cf">elif</span> line.startswith(<span class="st">&#39;&gt;&#39;</span>):</a>
<a class="sourceLine" id="cb970-43" title="43">            msa.append(line)</a>
<a class="sourceLine" id="cb970-44" title="44">        <span class="cf">elif</span> line.startswith(<span class="st">&#39; Score&#39;</span>):</a>
<a class="sourceLine" id="cb970-45" title="45">            msa.append(line)</a>
<a class="sourceLine" id="cb970-46" title="46">        <span class="cf">elif</span> line.startswith(<span class="st">&#39;Query&#39;</span>):</a>
<a class="sourceLine" id="cb970-47" title="47">            msa.append(line)</a>
<a class="sourceLine" id="cb970-48" title="48">        <span class="cf">elif</span> line.startswith(<span class="st">&#39;Sbjct&#39;</span>):</a>
<a class="sourceLine" id="cb970-49" title="49">            msa.append(line)</a>
<a class="sourceLine" id="cb970-50" title="50">        <span class="cf">elif</span> line.startswith(<span class="st">&#39;Lambda&#39;</span>):</a>
<a class="sourceLine" id="cb970-51" title="51">            msa.append(line)</a>
<a class="sourceLine" id="cb970-52" title="52">        <span class="cf">elif</span> line.startswith(<span class="st">&#39;Gapped&#39;</span>):</a>
<a class="sourceLine" id="cb970-53" title="53">            msa.append(line)</a>
<a class="sourceLine" id="cb970-54" title="54">        <span class="cf">elif</span> line.startswith(<span class="st">&#39;Effective&#39;</span>):</a>
<a class="sourceLine" id="cb970-55" title="55">            msa.append(line)</a>
<a class="sourceLine" id="cb970-56" title="56">        <span class="cf">elif</span> line.startswith(<span class="st">&#39;Matrix:&#39;</span>):</a>
<a class="sourceLine" id="cb970-57" title="57">            msa.append(line)</a>
<a class="sourceLine" id="cb970-58" title="58">        <span class="cf">elif</span> line.startswith(<span class="st">&#39;Gap&#39;</span>):</a>
<a class="sourceLine" id="cb970-59" title="59">            msa.append(line)</a>
<a class="sourceLine" id="cb970-60" title="60">        <span class="cf">elif</span> line.startswith(<span class="st">&#39;Strand&#39;</span>):</a>
<a class="sourceLine" id="cb970-61" title="61">            msa.append(line)</a>
<a class="sourceLine" id="cb970-62" title="62">        <span class="cf">elif</span> line.startswith(<span class="st">&#39;Frame&#39;</span>):</a>
<a class="sourceLine" id="cb970-63" title="63">            msa.append(line)</a>
<a class="sourceLine" id="cb970-64" title="64">        <span class="cf">elif</span> line.startswith(<span class="st">&#39;Query:&#39;</span>):</a>
<a class="sourceLine" id="cb970-65" title="65">            msa.append(line)</a>
<a class="sourceLine" id="cb970-66" title="66">        <span class="cf">elif</span> line.startswith(<span class="st">&#39;Sbjct:&#39;</span>):</a>
<a class="sourceLine" id="cb970-67" title="67">            msa.append(line)</a>
<a class="sourceLine" id="cb970-68" title="68">        <span class="cf">elif</span> line.startswith(<span class="st">&#39;Length&#39;</span>):</a>
<a class="sourceLine" id="cb970-69" title="69">            msa.append(line)</a>
<a class="sourceLine" id="cb970-70" title="70">        <span class="cf">elif</span> line.startswith(<span class="st">&#39;Identities&#39;</span>):</a>
<a class="sourceLine" id="cb970-71" title="71">            msa.append(line)</a>
<a class="sourceLine" id="cb970-72" title="72">        <span class="cf">elif</span> line.startswith(<span class="st">&#39;Positives&#39;</span>):</a>
<a class="sourceLine" id="cb970-73" title="73">            msa.append(line)</a>
<a class="sourceLine" id="cb970-74" title="74">        <span class="cf">elif</span> line.startswith(<span class="st">&#39;Gaps&#39;</span>):</a>
<a class="sourceLine" id="cb970-75" title="75">            msa.append(line)</a>
<a class="sourceLine" id="cb970-76" title="76">        <span class="cf">elif</span> line.startswith(<span class="st">&#39;Strand=&#39;</span>):</a>
<a class="sourceLine" id="cb970-77" title="77">            msa.append(line)</a>
<a class="sourceLine" id="cb970-78" title="78">        <span class="cf">elif</span> line.startswith(<span class="st">&#39;Frame=&#39;</span>):</a>
<a class="sourceLine" id="cb970-79" title="79">            msa.append(line)</a>
<a class="sourceLine" id="cb970-80" title="80">        <span class="cf">elif</span> line.startswith(<span class="st">&#39;Query=&#39;</span>):</a>
<a class="sourceLine" id="cb970-81" title="81">            msa.append(line)</a>
<a class="sourceLine" id="cb970-82" title="82">        <span class="cf">elif</span> line.startswith(<span class="st">&#39;Sbjct=&#39;</span>):</a>
<a class="sourceLine" id="cb970-83" title="83">            msa.append(line)</a>
<a class="sourceLine" id="cb970-84" title="84">        <span class="cf">elif</span> line.startswith(<span class="st">&#39;Length=&#39;</span>):</a>
<a class="sourceLine" id="cb970-85" title="85">            msa.append(line)</a>
<a class="sourceLine" id="cb970-86" title="86">        <span class="cf">elif</span> line.startswith(<span class="st">&#39;Identities=&#39;</span>):</a>
<a class="sourceLine" id="cb970-87" title="87">            msa.append(line)</a>
<a class="sourceLine" id="cb970-88" title="88">        <span class="cf">elif</span> line.startswith(<span class="st">&#39;Positives=&#39;</span>):</a>
<a class="sourceLine" id="cb970-89" title="89">            msa.append(line)</a>
<a class="sourceLine" id="cb970-90" title="90">        <span class="cf">elif</span> line.startswith(<span class="st">&#39;Gaps=&#39;</span>):</a>
<a class="sourceLine" id="cb970-91" title="91">            msa.append(line)</a>
<a class="sourceLine" id="cb970-92" title="92">        <span class="cf">elif</span> line.startswith(<span class="st">&#39;Strand=&#39;</span>):</a>
<a class="sourceLine" id="cb970-93" title="93">            msa.append(line)</a>
<a class="sourceLine" id="cb970-94" title="94">        <span class="cf">elif</span> line.startswith(<span class="st">&#39;Frame=&#39;</span>):</a>
<a class="sourceLine" id="cb970-95" title="95">            msa.append(line)</a>
<a class="sourceLine" id="cb970-96" title="96">        <span class="cf">elif</span> line.startswith(<span class="st">&#39;Query=&#39;</span>):</a>
<a class="sourceLine" id="cb970-97" title="97">            msa.append(line)</a>
<a class="sourceLine" id="cb970-98" title="98">        <span class="cf">elif</span> line.startswith(<span class="st">&#39;Sbjct=&#39;</span>):</a>
<a class="sourceLine" id="cb970-99" title="99">            msa.append(line)</a>
<a class="sourceLine" id="cb970-100" title="100">        <span class="cf">elif</span> line.startswith(<span class="st">&#39;Length=&#39;</span>):</a>
<a class="sourceLine" id="cb970-101" title="101">            msa.append(line)</a>
<a class="sourceLine" id="cb970-102" title="102">        <span class="cf">elif</span> line.startsw</a>
<a class="sourceLine" id="cb970-103" title="103">e, <span class="bu">id</span> <span class="op">=</span> blast(<span class="st">&#39;&gt;seq1</span><span class="ch">\n</span><span class="st">&#39;</span></a>
<a class="sourceLine" id="cb970-104" title="104">              <span class="st">&#39;PNFYVPFSNATGVVRSPFEYPQYYLAEPWQFSMLAAYMFLLIVLGFPINFLTLYVTVQ&#39;</span>)</a>
<a class="sourceLine" id="cb970-105" title="105">result <span class="op">=</span> <span class="bu">float</span>(e) <span class="op">&lt;</span> <span class="fl">1e-30</span></a></code></pre></div>
<p>Output:</p>
<pre><code>invalid syntax (&lt;string&gt;, line 103)</code></pre>
<h4 id="run-1-88">Run 1</h4>
<div class="sourceCode" id="cb972"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb972-1" title="1"><span class="im">import</span> requests</a>
<a class="sourceLine" id="cb972-2" title="2"><span class="im">from</span> bs4 <span class="im">import</span> BeautifulSoup</a>
<a class="sourceLine" id="cb972-3" title="3"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb972-4" title="4"></a>
<a class="sourceLine" id="cb972-5" title="5"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb972-6" title="6"><span class="co">print requests version</span></a>
<a class="sourceLine" id="cb972-7" title="7"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb972-8" title="8"><span class="bu">print</span>(requests.__version__)</a>
<a class="sourceLine" id="cb972-9" title="9"><span class="co"># end</span></a>
<a class="sourceLine" id="cb972-10" title="10"></a>
<a class="sourceLine" id="cb972-11" title="11"><span class="kw">def</span> blast(seq):</a>
<a class="sourceLine" id="cb972-12" title="12">    <span class="co">&#39;&#39;&#39;</span></a>
<a class="sourceLine" id="cb972-13" title="13"><span class="co">    Returns MSA with a BLAST search. Uses beautiful soup</span></a>
<a class="sourceLine" id="cb972-14" title="14"><span class="co">    to parse result.</span></a>
<a class="sourceLine" id="cb972-15" title="15"></a>
<a class="sourceLine" id="cb972-16" title="16"><span class="co">    1. import packages</span></a>
<a class="sourceLine" id="cb972-17" title="17"><span class="co">    2. Submit BLAST search with sequences</span></a>
<a class="sourceLine" id="cb972-18" title="18"><span class="co">    3. Get result</span></a>
<a class="sourceLine" id="cb972-19" title="19"><span class="co">    4. Parse MSA</span></a>
<a class="sourceLine" id="cb972-20" title="20"><span class="co">    5. Return a tuple of e score, id of top match</span></a>
<a class="sourceLine" id="cb972-21" title="21"><span class="co">    &#39;&#39;&#39;</span></a>
<a class="sourceLine" id="cb972-22" title="22">    <span class="co"># 1. import packages</span></a>
<a class="sourceLine" id="cb972-23" title="23">    <span class="im">import</span> requests</a>
<a class="sourceLine" id="cb972-24" title="24">    <span class="im">from</span> bs4 <span class="im">import</span> BeautifulSoup</a>
<a class="sourceLine" id="cb972-25" title="25">    <span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb972-26" title="26">    </a>
<a class="sourceLine" id="cb972-27" title="27">e, <span class="bu">id</span> <span class="op">=</span> blast(<span class="st">&#39;&gt;seq1</span><span class="ch">\n</span><span class="st">&#39;</span></a>
<a class="sourceLine" id="cb972-28" title="28">              <span class="st">&#39;PNFYVPFSNATGVVRSPFEYPQYYLAEPWQFSMLAAYMFLLIVLGFPINFLTLYVTVQ&#39;</span>)</a>
<a class="sourceLine" id="cb972-29" title="29">result <span class="op">=</span> <span class="bu">float</span>(e) <span class="op">&lt;</span> <span class="fl">1e-30</span></a></code></pre></div>
<p>Output:</p>
<pre><code>cannot unpack non-iterable NoneType object</code></pre>
<h4 id="run-2-88">Run 2</h4>
<div class="sourceCode" id="cb974"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb974-1" title="1"><span class="im">import</span> requests</a>
<a class="sourceLine" id="cb974-2" title="2"><span class="im">from</span> bs4 <span class="im">import</span> BeautifulSoup</a>
<a class="sourceLine" id="cb974-3" title="3"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb974-4" title="4"></a>
<a class="sourceLine" id="cb974-5" title="5"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb974-6" title="6"><span class="co">print requests version</span></a>
<a class="sourceLine" id="cb974-7" title="7"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb974-8" title="8"><span class="bu">print</span>(requests.__version__)</a>
<a class="sourceLine" id="cb974-9" title="9"><span class="co"># end</span></a>
<a class="sourceLine" id="cb974-10" title="10"></a>
<a class="sourceLine" id="cb974-11" title="11"><span class="kw">def</span> blast(seq):</a>
<a class="sourceLine" id="cb974-12" title="12">    <span class="co">&#39;&#39;&#39;</span></a>
<a class="sourceLine" id="cb974-13" title="13"><span class="co">    Returns MSA with a BLAST search. Uses beautiful soup</span></a>
<a class="sourceLine" id="cb974-14" title="14"><span class="co">    to parse result.</span></a>
<a class="sourceLine" id="cb974-15" title="15"></a>
<a class="sourceLine" id="cb974-16" title="16"><span class="co">    1. import packages</span></a>
<a class="sourceLine" id="cb974-17" title="17"><span class="co">    2. Submit BLAST search with sequences</span></a>
<a class="sourceLine" id="cb974-18" title="18"><span class="co">    3. Get result</span></a>
<a class="sourceLine" id="cb974-19" title="19"><span class="co">    4. Parse MSA</span></a>
<a class="sourceLine" id="cb974-20" title="20"><span class="co">    5. Return a tuple of e score, id of top match</span></a>
<a class="sourceLine" id="cb974-21" title="21"><span class="co">    &#39;&#39;&#39;</span></a>
<a class="sourceLine" id="cb974-22" title="22">    <span class="co"># 1. import packages</span></a>
<a class="sourceLine" id="cb974-23" title="23">    <span class="im">import</span> requests</a>
<a class="sourceLine" id="cb974-24" title="24">    <span class="im">from</span> bs4 <span class="im">import</span> BeautifulSoup</a>
<a class="sourceLine" id="cb974-25" title="25">    <span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb974-26" title="26">    </a>
<a class="sourceLine" id="cb974-27" title="27">e, <span class="bu">id</span> <span class="op">=</span> blast(<span class="st">&#39;&gt;seq1</span><span class="ch">\n</span><span class="st">&#39;</span></a>
<a class="sourceLine" id="cb974-28" title="28">              <span class="st">&#39;PNFYVPFSNATGVVRSPFEYPQYYLAEPWQFSMLAAYMFLLIVLGFPINFLTLYVTVQ&#39;</span>)</a>
<a class="sourceLine" id="cb974-29" title="29">result <span class="op">=</span> <span class="bu">float</span>(e) <span class="op">&lt;</span> <span class="fl">1e-30</span></a></code></pre></div>
<p>Output:</p>
<pre><code>cannot unpack non-iterable NoneType object</code></pre>
<h4 id="run-3-88">Run 3</h4>
<div class="sourceCode" id="cb976"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb976-1" title="1"><span class="im">import</span> requests</a>
<a class="sourceLine" id="cb976-2" title="2"><span class="im">from</span> bs4 <span class="im">import</span> BeautifulSoup</a>
<a class="sourceLine" id="cb976-3" title="3"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb976-4" title="4"></a>
<a class="sourceLine" id="cb976-5" title="5"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb976-6" title="6"><span class="co">print requests version</span></a>
<a class="sourceLine" id="cb976-7" title="7"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb976-8" title="8"><span class="bu">print</span>(requests.__version__)</a>
<a class="sourceLine" id="cb976-9" title="9"><span class="co"># end</span></a>
<a class="sourceLine" id="cb976-10" title="10"></a>
<a class="sourceLine" id="cb976-11" title="11"><span class="kw">def</span> blast(seq):</a>
<a class="sourceLine" id="cb976-12" title="12">    <span class="co">&#39;&#39;&#39;</span></a>
<a class="sourceLine" id="cb976-13" title="13"><span class="co">    Returns MSA with a BLAST search. Uses beautiful soup</span></a>
<a class="sourceLine" id="cb976-14" title="14"><span class="co">    to parse result.</span></a>
<a class="sourceLine" id="cb976-15" title="15"></a>
<a class="sourceLine" id="cb976-16" title="16"><span class="co">    1. import packages</span></a>
<a class="sourceLine" id="cb976-17" title="17"><span class="co">    2. Submit BLAST search with sequences</span></a>
<a class="sourceLine" id="cb976-18" title="18"><span class="co">    3. Get result</span></a>
<a class="sourceLine" id="cb976-19" title="19"><span class="co">    4. Parse MSA</span></a>
<a class="sourceLine" id="cb976-20" title="20"><span class="co">    5. Return a tuple of e score, id of top match</span></a>
<a class="sourceLine" id="cb976-21" title="21"><span class="co">    &#39;&#39;&#39;</span></a>
<a class="sourceLine" id="cb976-22" title="22">    <span class="co"># 1. import packages</span></a>
<a class="sourceLine" id="cb976-23" title="23">    <span class="im">import</span> requests</a>
<a class="sourceLine" id="cb976-24" title="24">    <span class="im">from</span> bs4 <span class="im">import</span> BeautifulSoup</a>
<a class="sourceLine" id="cb976-25" title="25">    <span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb976-26" title="26"></a>
<a class="sourceLine" id="cb976-27" title="27">    <span class="co"># 2. Submit BLAST search with sequences</span></a>
<a class="sourceLine" id="cb976-28" title="28">    <span class="co"># set up parameters</span></a>
<a class="sourceLine" id="cb976-29" title="29">    url <span class="op">=</span> <span class="st">&#39;https://blast.ncbi.nlm.nih.gov/Blast.cgi&#39;</span></a>
<a class="sourceLine" id="cb976-30" title="30">    params <span class="op">=</span> {<span class="st">&#39;QUERY&#39;</span>: seq, <span class="st">&#39;DATABASE&#39;</span>: <span class="st">&#39;nr&#39;</span>, <span class="st">&#39;PROGRAM&#39;</span>: <span class="st">&#39;blastp&#39;</span>, <span class="st">&#39;CMD&#39;</span>: <span class="st">&#39;Put&#39;</span>}</a>
<a class="sourceLine" id="cb976-31" title="31">    <span class="co"># submit request</span></a>
<a class="sourceLine" id="cb976-32" title="32">    r <span class="op">=</span> requests.get(url, params<span class="op">=</span>params)</a>
<a class="sourceLine" id="cb976-33" title="33">    <span class="co"># 3. Get result</span></a>
<a class="sourceLine" id="cb976-34" title="34">    <span class="co"># get the result page</span></a>
<a class="sourceLine" id="cb976-35" title="35">    result_page <span class="op">=</span> r.text</a>
<a class="sourceLine" id="cb976-36" title="36">    <span class="co"># parse the result page</span></a>
<a class="sourceLine" id="cb976-37" title="37">    soup <span class="op">=</span> BeautifulSoup(result_page, <span class="st">&#39;html.parser&#39;</span>)</a>
<a class="sourceLine" id="cb976-38" title="38">    <span class="co"># get the MSA</span></a>
<a class="sourceLine" id="cb976-39" title="39">    msa <span class="op">=</span> soup.find(<span class="st">&#39;pre&#39;</span>).text</a>
<a class="sourceLine" id="cb976-40" title="40">    <span class="co"># 4. Parse MSA</span></a>
<a class="sourceLine" id="cb976-41" title="41">    <span class="co"># split the MSA into lines</span></a>
<a class="sourceLine" id="cb976-42" title="42">    lines <span class="op">=</span> msa.split(<span class="st">&#39;</span><span class="ch">\n</span><span class="st">&#39;</span>)</a>
<a class="sourceLine" id="cb976-43" title="43">    <span class="co"># get the number of sequences</span></a>
<a class="sourceLine" id="cb976-44" title="44">    n_seq <span class="op">=</span> <span class="bu">int</span>(lines[<span class="dv">1</span>].split()[<span class="dv">0</span>])</a>
<a class="sourceLine" id="cb976-45" title="45">    <span class="co"># get the length of the sequences</span></a>
<a class="sourceLine" id="cb976-46" title="46">    seq_len <span class="op">=</span> <span class="bu">int</span>(lines[<span class="dv">1</span>].split()[<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb976-47" title="47">    <span class="co"># get the alignment</span></a>
<a class="sourceLine" id="cb976-48" title="48">    alignment <span class="op">=</span> np.array([<span class="bu">list</span>(line) <span class="cf">for</span> line <span class="kw">in</span> lines[<span class="dv">3</span>:<span class="dv">3</span><span class="op">+</span>n_seq]])</a>
<a class="sourceLine" id="cb976-49" title="49">    <span class="co"># get the e scores</span></a>
<a class="sourceLine" id="cb976-50" title="50">    e_scores <span class="op">=</span> np.array([<span class="bu">float</span>(line.split()[<span class="op">-</span><span class="dv">1</span>]) <span class="cf">for</span> line <span class="kw">in</span> lines[<span class="dv">3</span>:<span class="dv">3</span><span class="op">+</span>n_seq]])</a>
<a class="sourceLine" id="cb976-51" title="51">    <span class="co"># 5. Return a tuple of e score, id of top match</span></a>
<a class="sourceLine" id="cb976-52" title="52">    <span class="cf">return</span> e_scores[<span class="dv">0</span>], alignment[<span class="dv">0</span>, <span class="dv">0</span>]</a>
<a class="sourceLine" id="cb976-53" title="53"></a>
<a class="sourceLine" id="cb976-54" title="54">e, <span class="bu">id</span> <span class="op">=</span> blast(<span class="st">&#39;&gt;seq1</span><span class="ch">\n</span><span class="st">&#39;</span></a>
<a class="sourceLine" id="cb976-55" title="55">              <span class="st">&#39;PNFYVPFSNATGVVRSPFEYPQYYLAEPWQFSMLAAYMFLLIVLGFPINFLTLYVTVQ&#39;</span>)</a>
<a class="sourceLine" id="cb976-56" title="56">result <span class="op">=</span> <span class="bu">float</span>(e) <span class="op">&lt;</span> <span class="fl">1e-30</span></a></code></pre></div>
<p>Output:</p>
<pre><code>&#39;NoneType&#39; object has no attribute &#39;text&#39;</code></pre>
<h4 id="run-4-88">Run 4</h4>
<div class="sourceCode" id="cb978"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb978-1" title="1"><span class="im">import</span> requests</a>
<a class="sourceLine" id="cb978-2" title="2"><span class="im">from</span> bs4 <span class="im">import</span> BeautifulSoup</a>
<a class="sourceLine" id="cb978-3" title="3"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb978-4" title="4"></a>
<a class="sourceLine" id="cb978-5" title="5"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb978-6" title="6"><span class="co">print requests version</span></a>
<a class="sourceLine" id="cb978-7" title="7"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb978-8" title="8"><span class="bu">print</span>(requests.__version__)</a>
<a class="sourceLine" id="cb978-9" title="9"><span class="co"># end</span></a>
<a class="sourceLine" id="cb978-10" title="10"></a>
<a class="sourceLine" id="cb978-11" title="11"><span class="kw">def</span> blast(seq):</a>
<a class="sourceLine" id="cb978-12" title="12">    <span class="co">&#39;&#39;&#39;</span></a>
<a class="sourceLine" id="cb978-13" title="13"><span class="co">    Returns MSA with a BLAST search. Uses beautiful soup</span></a>
<a class="sourceLine" id="cb978-14" title="14"><span class="co">    to parse result.</span></a>
<a class="sourceLine" id="cb978-15" title="15"></a>
<a class="sourceLine" id="cb978-16" title="16"><span class="co">    1. import packages</span></a>
<a class="sourceLine" id="cb978-17" title="17"><span class="co">    2. Submit BLAST search with sequences</span></a>
<a class="sourceLine" id="cb978-18" title="18"><span class="co">    3. Get result</span></a>
<a class="sourceLine" id="cb978-19" title="19"><span class="co">    4. Parse MSA</span></a>
<a class="sourceLine" id="cb978-20" title="20"><span class="co">    5. Return a tuple of e score, id of top match</span></a>
<a class="sourceLine" id="cb978-21" title="21"><span class="co">    &#39;&#39;&#39;</span></a>
<a class="sourceLine" id="cb978-22" title="22">    <span class="co"># 1. import packages</span></a>
<a class="sourceLine" id="cb978-23" title="23">    <span class="im">import</span> requests</a>
<a class="sourceLine" id="cb978-24" title="24">    <span class="im">from</span> bs4 <span class="im">import</span> BeautifulSoup</a>
<a class="sourceLine" id="cb978-25" title="25">    <span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb978-26" title="26">    <span class="co"># 2. Submit BLAST search with sequences</span></a>
<a class="sourceLine" id="cb978-27" title="27">    url <span class="op">=</span> <span class="st">&#39;http://blast.ncbi.nlm.nih.gov/Blast.cgi&#39;</span></a>
<a class="sourceLine" id="cb978-28" title="28">    payload <span class="op">=</span> {<span class="st">&#39;QUERY&#39;</span>: seq, <span class="st">&#39;PROGRAM&#39;</span>: <span class="st">&#39;blastp&#39;</span>, <span class="st">&#39;DATABASE&#39;</span>: <span class="st">&#39;nr&#39;</span>, <span class="st">&#39;CMD&#39;</span>: <span class="st">&#39;Put&#39;</span>}</a>
<a class="sourceLine" id="cb978-29" title="29">    r <span class="op">=</span> requests.post(url, data<span class="op">=</span>payload)</a>
<a class="sourceLine" id="cb978-30" title="30">    <span class="co"># 3. Get result</span></a>
<a class="sourceLine" id="cb978-31" title="31">    soup <span class="op">=</span> BeautifulSoup(r.text, <span class="st">&#39;html.parser&#39;</span>)</a>
<a class="sourceLine" id="cb978-32" title="32">    <span class="co"># 4. Parse MSA</span></a>
<a class="sourceLine" id="cb978-33" title="33">    msa <span class="op">=</span> soup.find_all(<span class="st">&#39;pre&#39;</span>)[<span class="dv">0</span>].text</a>
<a class="sourceLine" id="cb978-34" title="34">    <span class="co"># 5. Return a tuple of e score, id of top match</span></a>
<a class="sourceLine" id="cb978-35" title="35">    <span class="cf">return</span> msa</a>
<a class="sourceLine" id="cb978-36" title="36"></a>
<a class="sourceLine" id="cb978-37" title="37">e, <span class="bu">id</span> <span class="op">=</span> blast(<span class="st">&#39;&gt;seq1</span><span class="ch">\n</span><span class="st">&#39;</span></a>
<a class="sourceLine" id="cb978-38" title="38">              <span class="st">&#39;PNFYVPFSNATGVVRSPFEYPQYYLAEPWQFSMLAAYMFLLIVLGFPINFLTLYVTVQ&#39;</span>)</a>
<a class="sourceLine" id="cb978-39" title="39">result <span class="op">=</span> <span class="bu">float</span>(e) <span class="op">&lt;</span> <span class="fl">1e-30</span></a></code></pre></div>
<p>Output:</p>
<pre><code>list index out of range</code></pre>
</details>
<details>
<p><summary>bravais</summary></p>
<h4 id="query-89">Query</h4>
<div class="sourceCode" id="cb980"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb980-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb980-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb980-3" title="3"></a>
<a class="sourceLine" id="cb980-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb980-5" title="5"><span class="co">compute sin(pi/2)</span></a>
<a class="sourceLine" id="cb980-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb980-7" title="7">x <span class="op">=</span> math.sin(math.pi <span class="op">/</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb980-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb980-9" title="9"></a>
<a class="sourceLine" id="cb980-10" title="10"></a>
<a class="sourceLine" id="cb980-11" title="11"><span class="kw">def</span> bravais_lattice(group_number):</a>
<a class="sourceLine" id="cb980-12" title="12">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb980-13" title="13"><span class="co">    Return bravais lattice name given space group number</span></a>
<a class="sourceLine" id="cb980-14" title="14"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb980-15" title="15">    </a></code></pre></div>
<h4 id="run-0-89">Run 0</h4>
<div class="sourceCode" id="cb981"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb981-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb981-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb981-3" title="3"></a>
<a class="sourceLine" id="cb981-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb981-5" title="5"><span class="co">compute sin(pi/2)</span></a>
<a class="sourceLine" id="cb981-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb981-7" title="7">x <span class="op">=</span> math.sin(math.pi <span class="op">/</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb981-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb981-9" title="9"></a>
<a class="sourceLine" id="cb981-10" title="10"></a>
<a class="sourceLine" id="cb981-11" title="11"><span class="kw">def</span> bravais_lattice(group_number):</a>
<a class="sourceLine" id="cb981-12" title="12">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb981-13" title="13"><span class="co">    Return bravais lattice name given space group number</span></a>
<a class="sourceLine" id="cb981-14" title="14"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb981-15" title="15">    <span class="cf">if</span> group_number <span class="kw">in</span> [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>, <span class="dv">10</span>, <span class="dv">11</span>, <span class="dv">12</span>, <span class="dv">13</span>, <span class="dv">14</span>, <span class="dv">15</span>, <span class="dv">16</span>, <span class="dv">17</span>, <span class="dv">18</span>, <span class="dv">19</span>, <span class="dv">20</span>, <span class="dv">21</span>, <span class="dv">22</span>, <span class="dv">23</span>, <span class="dv">24</span>, <span class="dv">25</span>, <span class="dv">26</span>, <span class="dv">27</span>, <span class="dv">28</span>, <span class="dv">29</span>, <span class="dv">30</span>, <span class="dv">31</span>, <span class="dv">32</span>, <span class="dv">33</span>, <span class="dv">34</span>, <span class="dv">35</span>, <span class="dv">36</span>, <span class="dv">37</span>, <span class="dv">38</span>, <span class="dv">39</span>, <span class="dv">40</span>, <span class="dv">41</span>, <span class="dv">42</span>, <span class="dv">43</span>, <span class="dv">44</span>, <span class="dv">45</span>, <span class="dv">46</span>, <span class="dv">47</span>, <span class="dv">48</span>, <span class="dv">49</span>, <span class="dv">50</span>, <span class="dv">51</span>, <span class="dv">52</span>, <span class="dv">53</span>, <span class="dv">54</span>, <span class="dv">55</span>, <span class="dv">56</span>, <span class="dv">57</span>, <span class="dv">58</span>, <span class="dv">59</span>, <span class="dv">60</span>, <span class="dv">61</span>, <span class="dv">62</span>, <span class="dv">63</span>, <span class="dv">64</span>, <span class="dv">65</span>, <span class="dv">66</span>, <span class="dv">67</span>, <span class="dv">68</span>, <span class="dv">69</span>, <span class="dv">70</span>, <span class="dv">71</span>, <span class="dv">72</span>, <span class="dv">73</span>, <span class="dv">74</span>, <span class="dv">75</span>, <span class="dv">76</span>, <span class="dv">77</span>, <span class="dv">78</span>, <span class="dv">79</span>, <span class="dv">80</span>, <span class="dv">81</span>, <span class="dv">82</span>, <span class="dv">83</span>, <span class="dv">84</span>, <span class="dv">85</span>, <span class="dv">86</span>, <span class="dv">87</span>, <span class="dv">88</span>, <span class="dv">89</span>, <span class="dv">90</span>, <span class="dv">91</span>, <span class="dv">92</span>, <span class="dv">93</span>, <span class="dv">94</span>, <span class="dv">95</span>, <span class="dv">96</span>, <span class="dv">97</span>, <span class="dv">98</span>, <span class="dv">99</span>, <span class="dv">100</span>, <span class="dv">101</span>, <span class="dv">102</span>, <span class="dv">103</span>, <span class="dv">104</span>, <span class="dv">105</span>, <span class="dv">106</span>, <span class="dv">107</span>, <span class="dv">108</span>, <span class="dv">109</span>, <span class="dv">110</span>, <span class="dv">111</span>, <span class="dv">112</span>, <span class="dv">113</span>, <span class="dv">114</span>, <span class="dv">115</span>, <span class="dv">116</span>, <span class="dv">117</span>, <span class="dv">118</span>, <span class="dv">119</span>, <span class="dv">120</span>, <span class="dv">121</span>, <span class="dv">122</span>, <span class="dv">123</span>, <span class="dv">124</span>, <span class="dv">125</span>, <span class="dv">126</span>, <span class="dv">127</span>, <span class="dv">128</span>, <span class="dv">129</span>, <span class="dv">130</span>, <span class="dv">131</span>, <span class="dv">132</span>, <span class="dv">133</span>, <span class="dv">134</span>, <span class="dv">135</span>, <span class="dv">136</span>, <span class="dv">137</span>, <span class="dv">138</span>, <span class="dv">139</span>, <span class="dv">140</span>, <span class="dv">141</span>, <span class="dv">142</span>, <span class="dv">143</span>, <span class="dv">144</span>, <span class="dv">145</span>, <span class="dv">146</span>, <span class="dv">147</span>, <span class="dv">148</span>, <span class="dv">149</span>, <span class="dv">150</span>, <span class="dv">151</span>, <span class="dv">152</span>, <span class="dv">153</span>, <span class="dv">154</span>, <span class="dv">155</span>, <span class="dv">156</span>, <span class="dv">157</span>, <span class="dv">158</span>, <span class="dv">159</span>, <span class="dv">160</span>, <span class="dv">161</span>, <span class="dv">162</span>, <span class="dv">163</span>, <span class="dv">164</span>, <span class="dv">165</span>, <span class="dv">166</span>, <span class="dv">167</span>, <span class="dv">168</span>, <span class="dv">169</span>, <span class="dv">170</span>, <span class="dv">171</span>, <span class="dv">172</span>, <span class="dv">173</span>, <span class="dv">174</span>, <span class="dv">175</span>, <span class="dv">176</span>, <span class="dv">177</span>, <span class="dv">178</span>, <span class="dv">179</span>, <span class="dv">180</span>, <span class="dv">181</span>, <span class="dv">182</span>, <span class="dv">183</span>, <span class="dv">184</span>, <span class="dv">185</span>, <span class="dv">186</span>, <span class="dv">187</span>, <span class="dv">188</span>, <span class="dv">189</span>, <span class="dv">190</span>, <span class="dv">191</span>, <span class="dv">192</span>, <span class="dv">193</span>, <span class="dv">194</span>, <span class="dv">195</span>, <span class="dv">196</span>, <span class="dv">197</span>, <span class="dv">198</span>, <span class="dv">199</span>, <span class="dv">200</span>, <span class="dv">201</span>, <span class="dv">202</span>, <span class="dv">203</span>, <span class="dv">204</span>, <span class="dv">205</span>, <span class="dv">206</span>, <span class="dv">207</span>, <span class="dv">208</span>, <span class="dv">209</span>, <span class="dv">210</span>, <span class="dv">211</span>, <span class="dv">212</span>, <span class="dv">213</span>, <span class="dv">214</span>, <span class="dv">215</span>, <span class="dv">216</span>, <span class="dv">217</span>, <span class="dv">218</span>, <span class="dv">219</span>, <span class="dv">220</span>, <span class="dv">221</span>, <span class="dv">222</span>, <span class="dv">223</span>, <span class="dv">224</span>, <span class="dv">225</span>, <span class="dv">226</span>, <span class="dv">227</span>, <span class="dv">228</span>, <span class="dv">229</span>, <span class="dv">230</span>, <span class="dv">231</span>, <span class="dv">232</span>, <span class="dv">233</span>, <span class="dv">234</span>, <span class="dv">235</span>, <span class="dv">236</span>, <span class="dv">237</span>, <span class="dv">238</span>, <span class="dv">239</span>, <span class="dv">240</span>, <span class="dv">241</span>, <span class="dv">242</span>, <span class="dv">243</span>, <span class="dv">244</span>, <span class="dv">245</span>, <span class="dv">246</span>, <span class="dv">247</span>, <span class="dv">248</span>, <span class="dv">249</span>, <span class="dv">250</span>, <span class="dv">251</span>, <span class="dv">252</span>, <span class="dv">253</span>, <span class="dv">254</span>, <span class="dv">255</span>, <span class="dv">256</span>, <span class="dv">257</span>, <span class="dv">258</span>, <span class="dv">259</span>, <span class="dv">260</span>, <span class="dv">261</span>, <span class="dv">262</span>, <span class="dv">263</span>, <span class="dv">264</span>, <span class="dv">265</span>, <span class="dv">266</span>, <span class="dv">267</span>, <span class="dv">268</span>, <span class="dv">269</span>, <span class="dv">270</span>, <span class="dv">271</span>, <span class="dv">272</span>, <span class="dv">273</span>, <span class="dv">274</span>, <span class="dv">275</span>, <span class="dv">276</span>, <span class="dv">277</span>, <span class="dv">278</span>, <span class="dv">279</span>, <span class="dv">280</span>, <span class="dv">281</span>, <span class="dv">282</span>, <span class="dv">283</span>, <span class="dv">284</span>, <span class="dv">285</span>, <span class="dv">286</span>, <span class="dv">287</span>, <span class="dv">288</span>, <span class="dv">289</span>, <span class="dv">290</span>, <span class="dv">291</span>, <span class="dv">292</span>, <span class="dv">293</span>, <span class="dv">294</span>, <span class="dv">295</span>, <span class="dv">296</span>, <span class="dv">297</span>, <span class="dv">298</span>, <span class="dv">299</span>, <span class="dv">300</span>, <span class="dv">301</span>, <span class="dv">302</span>, <span class="dv">303</span>, <span class="dv">304</span>, <span class="dv">305</span>, <span class="dv">306</span>, <span class="dv">307</span>, <span class="dv">308</span>, <span class="dv">309</span>, <span class="dv">310</span>, <span class="dv">311</span>, <span class="dv">312</span>, <span class="dv">313</span>, <span class="dv">314</span>, <span class="dv">315</span>, <span class="dv">316</span>, <span class="dv">317</span>, <span class="dv">318</span>, <span class="dv">319</span>, <span class="dv">320</span>, <span class="dv">321</span>, <span class="dv">322</span>, <span class="dv">323</span>, <span class="dv">324</span>, <span class="dv">325</span>, <span class="dv">326</span>, <span class="dv">327</span>, <span class="dv">328</span>, <span class="dv">329</span>, <span class="dv">330</span>, <span class="dv">331</span>, <span class="dv">332</span>, <span class="dv">333</span>, <span class="dv">334</span>, <span class="dv">335</span>, <span class="dv">336</span>, <span class="dv">337</span>, <span class="dv">338</span>, <span class="dv">339</span>, <span class="dv">340</span>, <span class="dv">341</span>, <span class="dv">342</span>, <span class="dv">343</span>, <span class="dv">344</span>, <span class="dv">345</span>, <span class="dv">346</span>, <span class="dv">347</span>, <span class="dv">348</span>, <span class="dv">349</span>, <span class="dv">350</span>, <span class="dv">351</span>, <span class="dv">352</span>, <span class="dv">353</span>, <span class="dv">354</span>, <span class="dv">355</span>, <span class="dv">356</span>, <span class="dv">357</span>, <span class="dv">358</span>, <span class="dv">359</span>, <span class="dv">360</span>, <span class="dv">361</span>, <span class="dv">362</span>, <span class="dv">363</span>, <span class="dv">364</span>, <span class="dv">365</span>, <span class="dv">366</span>, <span class="dv">367</span>, <span class="dv">368</span>, <span class="dv">369</span>, <span class="dv">370</span>, <span class="dv">371</span>, <span class="dv">372</span>, <span class="dv">373</span>, <span class="dv">374</span>, <span class="dv">375</span>, <span class="dv">376</span>, <span class="dv">377</span>, <span class="dv">378</span>, <span class="dv">379</span>, <span class="dv">380</span>, <span class="dv">381</span>, <span class="dv">382</span>, <span class="dv">383</span>, <span class="dv">384</span>, <span class="dv">385</span>, <span class="dv">386</span>, <span class="dv">387</span>, <span class="dv">388</span>, <span class="dv">389</span>, <span class="dv">390</span>, <span class="dv">391</span>, <span class="dv">392</span>, <span class="dv">393</span>, <span class="dv">394</span>, <span class="dv">395</span>, <span class="dv">396</span>, <span class="dv">397</span>, <span class="dv">398</span>, <span class="dv">399</span>, <span class="dv">400</span>, <span class="dv">401</span>, <span class="dv">402</span>, <span class="dv">403</span>, <span class="dv">404</span>, <span class="dv">405</span>, <span class="dv">406</span>, <span class="dv">407</span>, <span class="dv">408</span>, <span class="dv">409</span>, <span class="dv">410</span>, <span class="dv">411</span>, <span class="dv">412</span>, <span class="dv">413</span>, <span class="dv">414</span>, <span class="dv">415</span>, <span class="dv">416</span>, <span class="dv">417</span>, <span class="dv">418</span>, <span class="dv">419</span>, <span class="dv">420</span>, <span class="dv">421</span>, <span class="dv">422</span>, <span class="dv">423</span>, <span class="dv">424</span>, <span class="dv">425</span>, <span class="dv">426</span>, <span class="dv">427</span>, <span class="dv">428</span>, <span class="dv">429</span>, <span class="dv">430</span>, <span class="dv">431</span>, <span class="dv">432</span>, <span class="dv">433</span>, <span class="dv">434</span>, <span class="dv">435</span>, <span class="dv">436</span>, <span class="dv">437</span>, <span class="dv">438</span>, <span class="dv">439</span></a>
<a class="sourceLine" id="cb981-16" title="16">m <span class="op">=</span> bravais_lattice(<span class="dv">47</span>)</a>
<a class="sourceLine" id="cb981-17" title="17">result <span class="op">=</span> m.lower() <span class="op">==</span> <span class="st">&#39;orthorhombic&#39;</span></a></code></pre></div>
<p>Output:</p>
<pre><code>invalid syntax (&lt;string&gt;, line 17)</code></pre>
<h4 id="run-1-89">Run 1</h4>
<div class="sourceCode" id="cb983"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb983-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb983-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb983-3" title="3"></a>
<a class="sourceLine" id="cb983-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb983-5" title="5"><span class="co">compute sin(pi/2)</span></a>
<a class="sourceLine" id="cb983-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb983-7" title="7">x <span class="op">=</span> math.sin(math.pi <span class="op">/</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb983-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb983-9" title="9"></a>
<a class="sourceLine" id="cb983-10" title="10"></a>
<a class="sourceLine" id="cb983-11" title="11"><span class="kw">def</span> bravais_lattice(group_number):</a>
<a class="sourceLine" id="cb983-12" title="12">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb983-13" title="13"><span class="co">    Return bravais lattice name given space group number</span></a>
<a class="sourceLine" id="cb983-14" title="14"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb983-15" title="15">    <span class="cf">if</span> group_number <span class="kw">in</span> [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>, <span class="dv">10</span>, <span class="dv">11</span>, <span class="dv">12</span>, <span class="dv">13</span>, <span class="dv">14</span>, <span class="dv">15</span>, <span class="dv">16</span>, <span class="dv">17</span>, <span class="dv">18</span>, <span class="dv">19</span>, <span class="dv">20</span>, <span class="dv">21</span>, <span class="dv">22</span>, <span class="dv">23</span>, <span class="dv">24</span>, <span class="dv">25</span>, <span class="dv">26</span>, <span class="dv">27</span>, <span class="dv">28</span>, <span class="dv">29</span>, <span class="dv">30</span>, <span class="dv">31</span>, <span class="dv">32</span>, <span class="dv">33</span>, <span class="dv">34</span>, <span class="dv">35</span>, <span class="dv">36</span>, <span class="dv">37</span>, <span class="dv">38</span>, <span class="dv">39</span>, <span class="dv">40</span>, <span class="dv">41</span>, <span class="dv">42</span>, <span class="dv">43</span>, <span class="dv">44</span>, <span class="dv">45</span>, <span class="dv">46</span>, <span class="dv">47</span>, <span class="dv">48</span>, <span class="dv">49</span>, <span class="dv">50</span>, <span class="dv">51</span>, <span class="dv">52</span>, <span class="dv">53</span>, <span class="dv">54</span>, <span class="dv">55</span>, <span class="dv">56</span>, <span class="dv">57</span>, <span class="dv">58</span>, <span class="dv">59</span>, <span class="dv">60</span>, <span class="dv">61</span>, <span class="dv">62</span>, <span class="dv">63</span>, <span class="dv">64</span>, <span class="dv">65</span>, <span class="dv">66</span>, <span class="dv">67</span>, <span class="dv">68</span>, <span class="dv">69</span>, <span class="dv">70</span>, <span class="dv">71</span>, <span class="dv">72</span>, <span class="dv">73</span>, <span class="dv">74</span>, <span class="dv">75</span>, <span class="dv">76</span>, <span class="dv">77</span>, <span class="dv">78</span>, <span class="dv">79</span>, <span class="dv">80</span>, <span class="dv">81</span>, <span class="dv">82</span>, <span class="dv">83</span>, <span class="dv">84</span>, <span class="dv">85</span>, <span class="dv">86</span>, <span class="dv">87</span>, <span class="dv">88</span>, <span class="dv">89</span>, <span class="dv">90</span>, <span class="dv">91</span>, <span class="dv">92</span>, <span class="dv">93</span>, <span class="dv">94</span>, <span class="dv">95</span>, <span class="dv">96</span>, <span class="dv">97</span>, <span class="dv">98</span>, <span class="dv">99</span>, <span class="dv">100</span>, <span class="dv">101</span>, <span class="dv">102</span>, <span class="dv">103</span>, <span class="dv">104</span>, <span class="dv">105</span>, <span class="dv">106</span>, <span class="dv">107</span>, <span class="dv">108</span>, <span class="dv">109</span>, <span class="dv">110</span>, <span class="dv">111</span>, <span class="dv">112</span>, <span class="dv">113</span>, <span class="dv">114</span>, <span class="dv">115</span>, <span class="dv">116</span>, <span class="dv">117</span>, <span class="dv">118</span>, <span class="dv">119</span>, <span class="dv">120</span>, <span class="dv">121</span>, <span class="dv">122</span>, <span class="dv">123</span>, <span class="dv">124</span>, <span class="dv">125</span>, <span class="dv">126</span>, <span class="dv">127</span>, <span class="dv">128</span>, <span class="dv">129</span>, <span class="dv">130</span>, <span class="dv">131</span>, <span class="dv">132</span>, <span class="dv">133</span>, <span class="dv">134</span>, <span class="dv">135</span>, <span class="dv">136</span>, <span class="dv">137</span>, <span class="dv">138</span>, <span class="dv">139</span>, <span class="dv">140</span>, <span class="dv">141</span>, <span class="dv">142</span>, <span class="dv">143</span>, <span class="dv">144</span>, <span class="dv">145</span>, <span class="dv">146</span>, <span class="dv">147</span>, <span class="dv">148</span>, <span class="dv">149</span>, <span class="dv">150</span>, <span class="dv">151</span>, <span class="dv">152</span>, <span class="dv">153</span>, <span class="dv">154</span>, <span class="dv">155</span>, <span class="dv">156</span>, <span class="dv">157</span>, <span class="dv">158</span>, <span class="dv">159</span>, <span class="dv">160</span>, <span class="dv">161</span>, <span class="dv">162</span>, <span class="dv">163</span>, <span class="dv">164</span>, <span class="dv">165</span>, <span class="dv">166</span>, <span class="dv">167</span>, <span class="dv">168</span>, <span class="dv">169</span>, <span class="dv">170</span>, <span class="dv">171</span>, <span class="dv">172</span>, <span class="dv">173</span>, <span class="dv">174</span>, <span class="dv">175</span>, <span class="dv">176</span>, <span class="dv">177</span>, <span class="dv">178</span>, <span class="dv">179</span>, <span class="dv">180</span>, <span class="dv">181</span>, <span class="dv">182</span>, <span class="dv">183</span>, <span class="dv">184</span>, <span class="dv">185</span>, <span class="dv">186</span>, <span class="dv">187</span>, <span class="dv">188</span>, <span class="dv">189</span>, <span class="dv">190</span>, <span class="dv">191</span>, <span class="dv">192</span>, <span class="dv">193</span>, <span class="dv">194</span>, <span class="dv">195</span>, <span class="dv">196</span>, <span class="dv">197</span>, <span class="dv">198</span>, <span class="dv">199</span>, <span class="dv">200</span>, <span class="dv">201</span>, <span class="dv">202</span>, <span class="dv">203</span>, <span class="dv">204</span>, <span class="dv">205</span>, <span class="dv">206</span>, <span class="dv">207</span>, <span class="dv">208</span>, <span class="dv">209</span>, <span class="dv">210</span>, <span class="dv">211</span>, <span class="dv">212</span>, <span class="dv">213</span>, <span class="dv">214</span>, <span class="dv">215</span>, <span class="dv">216</span>, <span class="dv">217</span>, <span class="dv">218</span>, <span class="dv">219</span>, <span class="dv">220</span>, <span class="dv">221</span>, <span class="dv">222</span>, <span class="dv">223</span>, <span class="dv">224</span>, <span class="dv">225</span>, <span class="dv">226</span>, <span class="dv">227</span>, <span class="dv">228</span>, <span class="dv">229</span>, <span class="dv">230</span>, <span class="dv">231</span>, <span class="dv">232</span>, <span class="dv">233</span>, <span class="dv">234</span>, <span class="dv">235</span>, <span class="dv">236</span>, <span class="dv">237</span>, <span class="dv">238</span>, <span class="dv">239</span>, <span class="dv">240</span>, <span class="dv">241</span>, <span class="dv">242</span>, <span class="dv">243</span>, <span class="dv">244</span>, <span class="dv">245</span>, <span class="dv">246</span>, <span class="dv">247</span>, <span class="dv">248</span>, <span class="dv">249</span>, <span class="dv">250</span>, <span class="dv">251</span>, <span class="dv">252</span>, <span class="dv">253</span>, <span class="dv">254</span>, <span class="dv">255</span>, <span class="dv">256</span>, <span class="dv">257</span>, <span class="dv">258</span>, <span class="dv">259</span>, <span class="dv">260</span>, <span class="dv">261</span>, <span class="dv">262</span>, <span class="dv">263</span>, <span class="dv">264</span>, <span class="dv">265</span>, <span class="dv">266</span>, <span class="dv">267</span>, <span class="dv">268</span>, <span class="dv">269</span>, <span class="dv">270</span>, <span class="dv">271</span>, <span class="dv">272</span>, <span class="dv">273</span>, <span class="dv">274</span>, <span class="dv">275</span>, <span class="dv">276</span>, <span class="dv">277</span>, <span class="dv">278</span>, <span class="dv">279</span>, <span class="dv">280</span>, <span class="dv">281</span>, <span class="dv">282</span>, <span class="dv">283</span>, <span class="dv">284</span>, <span class="dv">285</span>, <span class="dv">286</span>, <span class="dv">287</span>, <span class="dv">288</span>, <span class="dv">289</span>, <span class="dv">290</span>, <span class="dv">291</span>, <span class="dv">292</span>, <span class="dv">293</span>, <span class="dv">294</span>, <span class="dv">295</span>, <span class="dv">296</span>, <span class="dv">297</span>, <span class="dv">298</span>, <span class="dv">299</span>, <span class="dv">300</span>, <span class="dv">301</span>, <span class="dv">302</span>, <span class="dv">303</span>, <span class="dv">304</span>, <span class="dv">305</span>, <span class="dv">306</span>, <span class="dv">307</span>, <span class="dv">308</span>, <span class="dv">309</span>, <span class="dv">310</span>, <span class="dv">311</span>, <span class="dv">312</span>, <span class="dv">313</span>, <span class="dv">314</span>, <span class="dv">315</span>, <span class="dv">316</span>, <span class="dv">317</span>, <span class="dv">318</span>, <span class="dv">319</span>, <span class="dv">320</span>, <span class="dv">321</span>, <span class="dv">322</span>, <span class="dv">323</span>, <span class="dv">324</span>, <span class="dv">325</span>, <span class="dv">326</span>, <span class="dv">327</span>, <span class="dv">328</span>, <span class="dv">329</span>, <span class="dv">330</span>, <span class="dv">331</span>, <span class="dv">332</span>, <span class="dv">333</span>, <span class="dv">334</span>, <span class="dv">335</span>, <span class="dv">336</span>, <span class="dv">337</span>, <span class="dv">338</span>, <span class="dv">339</span>, <span class="dv">340</span>, <span class="dv">341</span>, <span class="dv">342</span>, <span class="dv">343</span>, <span class="dv">344</span>, <span class="dv">345</span>, <span class="dv">346</span>, <span class="dv">347</span>, <span class="dv">348</span>, <span class="dv">349</span>, <span class="dv">350</span>, <span class="dv">351</span>, <span class="dv">352</span>, <span class="dv">353</span>, <span class="dv">354</span>, <span class="dv">355</span>, <span class="dv">356</span>, <span class="dv">357</span>, <span class="dv">358</span>, <span class="dv">359</span>, <span class="dv">360</span>, <span class="dv">361</span>, <span class="dv">362</span>, <span class="dv">363</span>, <span class="dv">364</span>, <span class="dv">365</span>, <span class="dv">366</span>, <span class="dv">367</span>, <span class="dv">368</span>, <span class="dv">369</span>, <span class="dv">370</span>, <span class="dv">371</span>, <span class="dv">372</span>, <span class="dv">373</span>, <span class="dv">374</span>, <span class="dv">375</span>, <span class="dv">376</span>, <span class="dv">377</span>, <span class="dv">378</span>, <span class="dv">379</span>, <span class="dv">380</span>, <span class="dv">381</span>, <span class="dv">382</span>, <span class="dv">383</span>, <span class="dv">384</span>, <span class="dv">385</span>, <span class="dv">386</span>, <span class="dv">387</span>, <span class="dv">388</span>, <span class="dv">389</span>, <span class="dv">390</span>, <span class="dv">391</span>, <span class="dv">392</span>, <span class="dv">393</span>, <span class="dv">394</span>, <span class="dv">395</span>, <span class="dv">396</span>, <span class="dv">397</span>, <span class="dv">398</span>, <span class="dv">399</span>, <span class="dv">400</span>, <span class="dv">401</span>, <span class="dv">402</span>, <span class="dv">403</span>, <span class="dv">404</span>, <span class="dv">405</span>, <span class="dv">406</span>, <span class="dv">407</span>, <span class="dv">408</span>, <span class="dv">409</span>, <span class="dv">410</span>, <span class="dv">411</span>, <span class="dv">412</span>, <span class="dv">413</span>, <span class="dv">414</span>, <span class="dv">415</span>, <span class="dv">416</span>, <span class="dv">417</span>, <span class="dv">418</span>, <span class="dv">419</span>, <span class="dv">420</span>, <span class="dv">421</span>, <span class="dv">422</span>, <span class="dv">423</span>, <span class="dv">424</span>, <span class="dv">425</span>, <span class="dv">426</span>, <span class="dv">427</span>, <span class="dv">428</span>, <span class="dv">429</span>, <span class="dv">430</span>, <span class="dv">431</span>, <span class="dv">432</span>, <span class="dv">433</span>, <span class="dv">434</span>, <span class="dv">435</span>, <span class="dv">436</span>, <span class="dv">437</span>, <span class="dv">438</span>, <span class="dv">439</span></a>
<a class="sourceLine" id="cb983-16" title="16">m <span class="op">=</span> bravais_lattice(<span class="dv">47</span>)</a>
<a class="sourceLine" id="cb983-17" title="17">result <span class="op">=</span> m.lower() <span class="op">==</span> <span class="st">&#39;orthorhombic&#39;</span></a></code></pre></div>
<p>Output:</p>
<pre><code>invalid syntax (&lt;string&gt;, line 17)</code></pre>
<h4 id="run-2-89">Run 2</h4>
<div class="sourceCode" id="cb985"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb985-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb985-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb985-3" title="3"></a>
<a class="sourceLine" id="cb985-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb985-5" title="5"><span class="co">compute sin(pi/2)</span></a>
<a class="sourceLine" id="cb985-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb985-7" title="7">x <span class="op">=</span> math.sin(math.pi <span class="op">/</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb985-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb985-9" title="9"></a>
<a class="sourceLine" id="cb985-10" title="10"></a>
<a class="sourceLine" id="cb985-11" title="11"><span class="kw">def</span> bravais_lattice(group_number):</a>
<a class="sourceLine" id="cb985-12" title="12">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb985-13" title="13"><span class="co">    Return bravais lattice name given space group number</span></a>
<a class="sourceLine" id="cb985-14" title="14"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb985-15" title="15">    <span class="cf">if</span> group_number <span class="kw">in</span> [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>, <span class="dv">10</span>, <span class="dv">11</span>, <span class="dv">12</span>, <span class="dv">13</span>, <span class="dv">14</span>, <span class="dv">15</span>, <span class="dv">16</span>, <span class="dv">17</span>, <span class="dv">18</span>, <span class="dv">19</span>, <span class="dv">20</span>, <span class="dv">21</span>, <span class="dv">22</span>, <span class="dv">23</span>, <span class="dv">24</span>, <span class="dv">25</span>, <span class="dv">26</span>, <span class="dv">27</span>, <span class="dv">28</span>, <span class="dv">29</span>, <span class="dv">30</span>, <span class="dv">31</span>, <span class="dv">32</span>, <span class="dv">33</span>, <span class="dv">34</span>, <span class="dv">35</span>, <span class="dv">36</span>, <span class="dv">37</span>, <span class="dv">38</span>, <span class="dv">39</span>, <span class="dv">40</span>, <span class="dv">41</span>, <span class="dv">42</span>, <span class="dv">43</span>, <span class="dv">44</span>, <span class="dv">45</span>, <span class="dv">46</span>, <span class="dv">47</span>, <span class="dv">48</span>, <span class="dv">49</span>, <span class="dv">50</span>, <span class="dv">51</span>, <span class="dv">52</span>, <span class="dv">53</span>, <span class="dv">54</span>, <span class="dv">55</span>, <span class="dv">56</span>, <span class="dv">57</span>, <span class="dv">58</span>, <span class="dv">59</span>, <span class="dv">60</span>, <span class="dv">61</span>, <span class="dv">62</span>, <span class="dv">63</span>, <span class="dv">64</span>, <span class="dv">65</span>, <span class="dv">66</span>, <span class="dv">67</span>, <span class="dv">68</span>, <span class="dv">69</span>, <span class="dv">70</span>, <span class="dv">71</span>, <span class="dv">72</span>, <span class="dv">73</span>, <span class="dv">74</span>, <span class="dv">75</span>, <span class="dv">76</span>, <span class="dv">77</span>, <span class="dv">78</span>, <span class="dv">79</span>, <span class="dv">80</span>, <span class="dv">81</span>, <span class="dv">82</span>, <span class="dv">83</span>, <span class="dv">84</span>, <span class="dv">85</span>, <span class="dv">86</span>, <span class="dv">87</span>, <span class="dv">88</span>, <span class="dv">89</span>, <span class="dv">90</span>, <span class="dv">91</span>, <span class="dv">92</span>, <span class="dv">93</span>, <span class="dv">94</span>, <span class="dv">95</span>, <span class="dv">96</span>, <span class="dv">97</span>, <span class="dv">98</span>, <span class="dv">99</span>, <span class="dv">100</span>, <span class="dv">101</span>, <span class="dv">102</span>, <span class="dv">103</span>, <span class="dv">104</span>, <span class="dv">105</span>, <span class="dv">106</span>, <span class="dv">107</span>, <span class="dv">108</span>, <span class="dv">109</span>, <span class="dv">110</span>, <span class="dv">111</span>, <span class="dv">112</span>, <span class="dv">113</span>, <span class="dv">114</span>, <span class="dv">115</span>, <span class="dv">116</span>, <span class="dv">117</span>, <span class="dv">118</span>, <span class="dv">119</span>, <span class="dv">120</span>, <span class="dv">121</span>, <span class="dv">122</span>, <span class="dv">123</span>, <span class="dv">124</span>, <span class="dv">125</span>, <span class="dv">126</span>, <span class="dv">127</span>, <span class="dv">128</span>, <span class="dv">129</span>, <span class="dv">130</span>, <span class="dv">131</span>, <span class="dv">132</span>, <span class="dv">133</span>, <span class="dv">134</span>, <span class="dv">135</span>, <span class="dv">136</span>, <span class="dv">137</span>, <span class="dv">138</span>, <span class="dv">139</span>, <span class="dv">140</span>, <span class="dv">141</span>, <span class="dv">142</span>, <span class="dv">143</span>, <span class="dv">144</span>, <span class="dv">145</span>, <span class="dv">146</span>, <span class="dv">147</span>, <span class="dv">148</span>, <span class="dv">149</span>, <span class="dv">150</span>, <span class="dv">151</span>, <span class="dv">152</span>, <span class="dv">153</span>, <span class="dv">154</span>, <span class="dv">155</span>, <span class="dv">156</span>, <span class="dv">157</span>, <span class="dv">158</span>, <span class="dv">159</span>, <span class="dv">160</span>, <span class="dv">161</span>, <span class="dv">162</span>, <span class="dv">163</span>, <span class="dv">164</span>, <span class="dv">165</span>, <span class="dv">166</span>, <span class="dv">167</span>, <span class="dv">168</span>, <span class="dv">169</span>, <span class="dv">170</span>, <span class="dv">171</span>, <span class="dv">172</span>, <span class="dv">173</span>, <span class="dv">174</span>, <span class="dv">175</span>, <span class="dv">176</span>, <span class="dv">177</span>, <span class="dv">178</span>, <span class="dv">179</span>, <span class="dv">180</span>, <span class="dv">181</span>, <span class="dv">182</span>, <span class="dv">183</span>, <span class="dv">184</span>, <span class="dv">185</span>, <span class="dv">186</span>, <span class="dv">187</span>, <span class="dv">188</span>, <span class="dv">189</span>, <span class="dv">190</span>, <span class="dv">191</span>, <span class="dv">192</span>, <span class="dv">193</span>, <span class="dv">194</span>, <span class="dv">195</span>, <span class="dv">196</span>, <span class="dv">197</span>, <span class="dv">198</span>, <span class="dv">199</span>, <span class="dv">200</span>, <span class="dv">201</span>, <span class="dv">202</span>, <span class="dv">203</span>, <span class="dv">204</span>, <span class="dv">205</span>, <span class="dv">206</span>, <span class="dv">207</span>, <span class="dv">208</span>, <span class="dv">209</span>, <span class="dv">210</span>, <span class="dv">211</span>, <span class="dv">212</span>, <span class="dv">213</span>, <span class="dv">214</span>, <span class="dv">215</span>, <span class="dv">216</span>, <span class="dv">217</span>, <span class="dv">218</span>, <span class="dv">219</span>, <span class="dv">220</span>, <span class="dv">221</span>, <span class="dv">222</span>, <span class="dv">223</span>, <span class="dv">224</span>, <span class="dv">225</span>, <span class="dv">226</span>, <span class="dv">227</span>, <span class="dv">228</span>, <span class="dv">229</span>, <span class="dv">230</span>, <span class="dv">231</span>, <span class="dv">232</span>, <span class="dv">233</span>, <span class="dv">234</span>, <span class="dv">235</span>, <span class="dv">236</span>, <span class="dv">237</span>, <span class="dv">238</span>, <span class="dv">239</span>, <span class="dv">240</span>, <span class="dv">241</span>, <span class="dv">242</span>, <span class="dv">243</span>, <span class="dv">244</span>, <span class="dv">245</span>, <span class="dv">246</span>, <span class="dv">247</span>, <span class="dv">248</span>, <span class="dv">249</span>, <span class="dv">250</span>, <span class="dv">251</span>, <span class="dv">252</span>, <span class="dv">253</span>, <span class="dv">254</span>, <span class="dv">255</span>, <span class="dv">256</span>, <span class="dv">257</span>, <span class="dv">258</span>, <span class="dv">259</span>, <span class="dv">260</span>, <span class="dv">261</span>, <span class="dv">262</span>, <span class="dv">263</span>, <span class="dv">264</span>, <span class="dv">265</span>, <span class="dv">266</span>, <span class="dv">267</span>, <span class="dv">268</span>, <span class="dv">269</span>, <span class="dv">270</span>, <span class="dv">271</span>, <span class="dv">272</span>, <span class="dv">273</span>, <span class="dv">274</span>, <span class="dv">275</span>, <span class="dv">276</span>, <span class="dv">277</span>, <span class="dv">278</span>, <span class="dv">279</span>, <span class="dv">280</span>, <span class="dv">281</span>, <span class="dv">282</span>, <span class="dv">283</span>, <span class="dv">284</span>, <span class="dv">285</span>, <span class="dv">286</span>, <span class="dv">287</span>, <span class="dv">288</span>, <span class="dv">289</span>, <span class="dv">290</span>, <span class="dv">291</span>, <span class="dv">292</span>, <span class="dv">293</span>, <span class="dv">294</span>, <span class="dv">295</span>, <span class="dv">296</span>, <span class="dv">297</span>, <span class="dv">298</span>, <span class="dv">299</span>, <span class="dv">300</span>, <span class="dv">301</span>, <span class="dv">302</span>, <span class="dv">303</span>, <span class="dv">304</span>, <span class="dv">305</span>, <span class="dv">306</span>, <span class="dv">307</span>, <span class="dv">308</span>, <span class="dv">309</span>, <span class="dv">310</span>, <span class="dv">311</span>, <span class="dv">312</span>, <span class="dv">313</span>, <span class="dv">314</span>, <span class="dv">315</span>, <span class="dv">316</span>, <span class="dv">317</span>, <span class="dv">318</span>, <span class="dv">319</span>, <span class="dv">320</span>, <span class="dv">321</span>, <span class="dv">322</span>, <span class="dv">323</span>, <span class="dv">324</span>, <span class="dv">325</span>, <span class="dv">326</span>, <span class="dv">327</span>, <span class="dv">328</span>, <span class="dv">329</span>, <span class="dv">330</span>, <span class="dv">331</span>, <span class="dv">332</span>, <span class="dv">333</span>, <span class="dv">334</span>, <span class="dv">335</span>, <span class="dv">336</span>, <span class="dv">337</span>, <span class="dv">338</span>, <span class="dv">339</span>, <span class="dv">340</span>, <span class="dv">341</span>, <span class="dv">342</span>, <span class="dv">343</span>, <span class="dv">344</span>, <span class="dv">345</span>, <span class="dv">346</span>, <span class="dv">347</span>, <span class="dv">348</span>, <span class="dv">349</span>, <span class="dv">350</span>, <span class="dv">351</span>, <span class="dv">352</span>, <span class="dv">353</span>, <span class="dv">354</span>, <span class="dv">355</span>, <span class="dv">356</span>, <span class="dv">357</span>, <span class="dv">358</span>, <span class="dv">359</span>, <span class="dv">360</span>, <span class="dv">361</span>, <span class="dv">362</span>, <span class="dv">363</span>, <span class="dv">364</span>, <span class="dv">365</span>, <span class="dv">366</span>, <span class="dv">367</span>, <span class="dv">368</span>, <span class="dv">369</span>, <span class="dv">370</span>, <span class="dv">371</span>, <span class="dv">372</span>, <span class="dv">373</span>, <span class="dv">374</span>, <span class="dv">375</span>, <span class="dv">376</span>, <span class="dv">377</span>, <span class="dv">378</span>, <span class="dv">379</span>, <span class="dv">380</span>, <span class="dv">381</span>, <span class="dv">382</span>, <span class="dv">383</span>, <span class="dv">384</span>, <span class="dv">385</span>, <span class="dv">386</span>, <span class="dv">387</span>, <span class="dv">388</span>, <span class="dv">389</span>, <span class="dv">390</span>, <span class="dv">391</span>, <span class="dv">392</span>, <span class="dv">393</span>, <span class="dv">394</span>, <span class="dv">395</span>, <span class="dv">396</span>, <span class="dv">397</span>, <span class="dv">398</span>, <span class="dv">399</span>, <span class="dv">400</span>, <span class="dv">401</span>, <span class="dv">402</span>, <span class="dv">403</span>, <span class="dv">404</span>, <span class="dv">405</span>, <span class="dv">406</span>, <span class="dv">407</span>, <span class="dv">408</span>, <span class="dv">409</span>, <span class="dv">410</span>, <span class="dv">411</span>, <span class="dv">412</span>, <span class="dv">413</span>, <span class="dv">414</span>, <span class="dv">415</span>, <span class="dv">416</span>, <span class="dv">417</span>, <span class="dv">418</span>, <span class="dv">419</span>, <span class="dv">420</span>, <span class="dv">421</span>, <span class="dv">422</span>, <span class="dv">423</span>, <span class="dv">424</span>, <span class="dv">425</span>, <span class="dv">426</span>, <span class="dv">427</span>, <span class="dv">428</span>, <span class="dv">429</span>, <span class="dv">430</span>, <span class="dv">431</span>, <span class="dv">432</span>, <span class="dv">433</span>, <span class="dv">434</span>, <span class="dv">435</span>, <span class="dv">436</span>, <span class="dv">437</span>, <span class="dv">438</span>, <span class="dv">439</span></a>
<a class="sourceLine" id="cb985-16" title="16">m <span class="op">=</span> bravais_lattice(<span class="dv">47</span>)</a>
<a class="sourceLine" id="cb985-17" title="17">result <span class="op">=</span> m.lower() <span class="op">==</span> <span class="st">&#39;orthorhombic&#39;</span></a></code></pre></div>
<p>Output:</p>
<pre><code>invalid syntax (&lt;string&gt;, line 17)</code></pre>
<h4 id="run-3-89">Run 3</h4>
<div class="sourceCode" id="cb987"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb987-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb987-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb987-3" title="3"></a>
<a class="sourceLine" id="cb987-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb987-5" title="5"><span class="co">compute sin(pi/2)</span></a>
<a class="sourceLine" id="cb987-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb987-7" title="7">x <span class="op">=</span> math.sin(math.pi <span class="op">/</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb987-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb987-9" title="9"></a>
<a class="sourceLine" id="cb987-10" title="10"></a>
<a class="sourceLine" id="cb987-11" title="11"><span class="kw">def</span> bravais_lattice(group_number):</a>
<a class="sourceLine" id="cb987-12" title="12">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb987-13" title="13"><span class="co">    Return bravais lattice name given space group number</span></a>
<a class="sourceLine" id="cb987-14" title="14"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb987-15" title="15">    <span class="cf">if</span> group_number <span class="kw">in</span> [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>, <span class="dv">10</span>, <span class="dv">11</span>, <span class="dv">12</span>, <span class="dv">13</span>, <span class="dv">14</span>, <span class="dv">15</span>, <span class="dv">16</span>, <span class="dv">17</span>, <span class="dv">18</span>, <span class="dv">19</span>, <span class="dv">20</span>, <span class="dv">21</span>, <span class="dv">22</span>, <span class="dv">23</span>, <span class="dv">24</span>, <span class="dv">25</span>, <span class="dv">26</span>, <span class="dv">27</span>, <span class="dv">28</span>, <span class="dv">29</span>, <span class="dv">30</span>, <span class="dv">31</span>, <span class="dv">32</span>, <span class="dv">33</span>, <span class="dv">34</span>, <span class="dv">35</span>, <span class="dv">36</span>, <span class="dv">37</span>, <span class="dv">38</span>, <span class="dv">39</span>, <span class="dv">40</span>, <span class="dv">41</span>, <span class="dv">42</span>, <span class="dv">43</span>, <span class="dv">44</span>, <span class="dv">45</span>, <span class="dv">46</span>, <span class="dv">47</span>, <span class="dv">48</span>, <span class="dv">49</span>, <span class="dv">50</span>, <span class="dv">51</span>, <span class="dv">52</span>, <span class="dv">53</span>, <span class="dv">54</span>, <span class="dv">55</span>, <span class="dv">56</span>, <span class="dv">57</span>, <span class="dv">58</span>, <span class="dv">59</span>, <span class="dv">60</span>, <span class="dv">61</span>, <span class="dv">62</span>, <span class="dv">63</span>, <span class="dv">64</span>, <span class="dv">65</span>, <span class="dv">66</span>, <span class="dv">67</span>, <span class="dv">68</span>, <span class="dv">69</span>, <span class="dv">70</span>, <span class="dv">71</span>, <span class="dv">72</span>, <span class="dv">73</span>, <span class="dv">74</span>, <span class="dv">75</span>, <span class="dv">76</span>, <span class="dv">77</span>, <span class="dv">78</span>, <span class="dv">79</span>, <span class="dv">80</span>, <span class="dv">81</span>, <span class="dv">82</span>, <span class="dv">83</span>, <span class="dv">84</span>, <span class="dv">85</span>, <span class="dv">86</span>, <span class="dv">87</span>, <span class="dv">88</span>, <span class="dv">89</span>, <span class="dv">90</span>, <span class="dv">91</span>, <span class="dv">92</span>, <span class="dv">93</span>, <span class="dv">94</span>, <span class="dv">95</span>, <span class="dv">96</span>, <span class="dv">97</span>, <span class="dv">98</span>, <span class="dv">99</span>, <span class="dv">100</span>, <span class="dv">101</span>, <span class="dv">102</span>, <span class="dv">103</span>, <span class="dv">104</span>, <span class="dv">105</span>, <span class="dv">106</span>, <span class="dv">107</span>, <span class="dv">108</span>, <span class="dv">109</span>, <span class="dv">110</span>, <span class="dv">111</span>, <span class="dv">112</span>, <span class="dv">113</span>, <span class="dv">114</span>, <span class="dv">115</span>, <span class="dv">116</span>, <span class="dv">117</span>, <span class="dv">118</span>, <span class="dv">119</span>, <span class="dv">120</span>, <span class="dv">121</span>, <span class="dv">122</span>, <span class="dv">123</span>, <span class="dv">124</span>, <span class="dv">125</span>, <span class="dv">126</span>, <span class="dv">127</span>, <span class="dv">128</span>, <span class="dv">129</span>, <span class="dv">130</span>, <span class="dv">131</span>, <span class="dv">132</span>, <span class="dv">133</span>, <span class="dv">134</span>, <span class="dv">135</span>, <span class="dv">136</span>, <span class="dv">137</span>, <span class="dv">138</span>, <span class="dv">139</span>, <span class="dv">140</span>, <span class="dv">141</span>, <span class="dv">142</span>, <span class="dv">143</span>, <span class="dv">144</span>, <span class="dv">145</span>, <span class="dv">146</span>, <span class="dv">147</span>, <span class="dv">148</span>, <span class="dv">149</span>, <span class="dv">150</span>, <span class="dv">151</span>, <span class="dv">152</span>, <span class="dv">153</span>, <span class="dv">154</span>, <span class="dv">155</span>, <span class="dv">156</span>, <span class="dv">157</span>, <span class="dv">158</span>, <span class="dv">159</span>, <span class="dv">160</span>, <span class="dv">161</span>, <span class="dv">162</span>, <span class="dv">163</span>, <span class="dv">164</span>, <span class="dv">165</span>, <span class="dv">166</span>, <span class="dv">167</span>, <span class="dv">168</span>, <span class="dv">169</span>, <span class="dv">170</span>, <span class="dv">171</span>, <span class="dv">172</span>, <span class="dv">173</span>, <span class="dv">174</span>, <span class="dv">175</span>, <span class="dv">176</span>, <span class="dv">177</span>, <span class="dv">178</span>, <span class="dv">179</span>, <span class="dv">180</span>, <span class="dv">181</span>, <span class="dv">182</span>, <span class="dv">183</span>, <span class="dv">184</span>, <span class="dv">185</span>, <span class="dv">186</span>, <span class="dv">187</span>, <span class="dv">188</span>, <span class="dv">189</span>, <span class="dv">190</span>, <span class="dv">191</span>, <span class="dv">192</span>, <span class="dv">193</span>, <span class="dv">194</span>, <span class="dv">195</span>, <span class="dv">196</span>, <span class="dv">197</span>, <span class="dv">198</span>, <span class="dv">199</span>, <span class="dv">200</span>, <span class="dv">201</span>, <span class="dv">202</span>, <span class="dv">203</span>, <span class="dv">204</span>, <span class="dv">205</span>, <span class="dv">206</span>, <span class="dv">207</span>, <span class="dv">208</span>, <span class="dv">209</span>, <span class="dv">210</span>, <span class="dv">211</span>, <span class="dv">212</span>, <span class="dv">213</span>, <span class="dv">214</span>, <span class="dv">215</span>, <span class="dv">216</span>, <span class="dv">217</span>, <span class="dv">218</span>, <span class="dv">219</span>, <span class="dv">220</span>, <span class="dv">221</span>, <span class="dv">222</span>, <span class="dv">223</span>, <span class="dv">224</span>, <span class="dv">225</span>, <span class="dv">226</span>, <span class="dv">227</span>, <span class="dv">228</span>, <span class="dv">229</span>, <span class="dv">230</span>, <span class="dv">231</span>, <span class="dv">232</span>, <span class="dv">233</span>, <span class="dv">234</span>, <span class="dv">235</span>, <span class="dv">236</span>, <span class="dv">237</span>, <span class="dv">238</span>, <span class="dv">239</span>, <span class="dv">240</span>, <span class="dv">241</span>, <span class="dv">242</span>, <span class="dv">243</span>, <span class="dv">244</span>, <span class="dv">245</span>, <span class="dv">246</span>, <span class="dv">247</span>, <span class="dv">248</span>, <span class="dv">249</span>, <span class="dv">250</span>, <span class="dv">251</span>, <span class="dv">252</span>, <span class="dv">253</span>, <span class="dv">254</span>, <span class="dv">255</span>, <span class="dv">256</span>, <span class="dv">257</span>, <span class="dv">258</span>, <span class="dv">259</span>, <span class="dv">260</span>, <span class="dv">261</span>, <span class="dv">262</span>, <span class="dv">263</span>, <span class="dv">264</span>, <span class="dv">265</span>, <span class="dv">266</span>, <span class="dv">267</span>, <span class="dv">268</span>, <span class="dv">269</span>, <span class="dv">270</span>, <span class="dv">271</span>, <span class="dv">272</span>, <span class="dv">273</span>, <span class="dv">274</span>, <span class="dv">275</span>, <span class="dv">276</span>, <span class="dv">277</span>, <span class="dv">278</span>, <span class="dv">279</span>, <span class="dv">280</span>, <span class="dv">281</span>, <span class="dv">282</span>, <span class="dv">283</span>, <span class="dv">284</span>, <span class="dv">285</span>, <span class="dv">286</span>, <span class="dv">287</span>, <span class="dv">288</span>, <span class="dv">289</span>, <span class="dv">290</span>, <span class="dv">291</span>, <span class="dv">292</span>, <span class="dv">293</span>, <span class="dv">294</span>, <span class="dv">295</span>, <span class="dv">296</span>, <span class="dv">297</span>, <span class="dv">298</span>, <span class="dv">299</span>, <span class="dv">300</span>, <span class="dv">301</span>, <span class="dv">302</span>, <span class="dv">303</span>, <span class="dv">304</span>, <span class="dv">305</span>, <span class="dv">306</span>, <span class="dv">307</span>, <span class="dv">308</span>, <span class="dv">309</span>, <span class="dv">310</span>, <span class="dv">311</span>, <span class="dv">312</span>, <span class="dv">313</span>, <span class="dv">314</span>, <span class="dv">315</span>, <span class="dv">316</span>, <span class="dv">317</span>, <span class="dv">318</span>, <span class="dv">319</span>, <span class="dv">320</span>, <span class="dv">321</span>, <span class="dv">322</span>, <span class="dv">323</span>, <span class="dv">324</span>, <span class="dv">325</span>, <span class="dv">326</span>, <span class="dv">327</span>, <span class="dv">328</span>, <span class="dv">329</span>, <span class="dv">330</span>, <span class="dv">331</span>, <span class="dv">332</span>, <span class="dv">333</span>, <span class="dv">334</span>, <span class="dv">335</span>, <span class="dv">336</span>, <span class="dv">337</span>, <span class="dv">338</span>, <span class="dv">339</span>, <span class="dv">340</span>, <span class="dv">341</span>, <span class="dv">342</span>, <span class="dv">343</span>, <span class="dv">344</span>, <span class="dv">345</span>, <span class="dv">346</span>, <span class="dv">347</span>, <span class="dv">348</span>, <span class="dv">349</span>, <span class="dv">350</span>, <span class="dv">351</span>, <span class="dv">352</span>, <span class="dv">353</span>, <span class="dv">354</span>, <span class="dv">355</span>, <span class="dv">356</span>, <span class="dv">357</span>, <span class="dv">358</span>, <span class="dv">359</span>, <span class="dv">360</span>, <span class="dv">361</span>, <span class="dv">362</span>, <span class="dv">363</span>, <span class="dv">364</span>, <span class="dv">365</span>, <span class="dv">366</span>, <span class="dv">367</span>, <span class="dv">368</span>, <span class="dv">369</span>, <span class="dv">370</span>, <span class="dv">371</span>, <span class="dv">372</span>, <span class="dv">373</span>, <span class="dv">374</span>, <span class="dv">375</span>, <span class="dv">376</span>, <span class="dv">377</span>, <span class="dv">378</span>, <span class="dv">379</span>, <span class="dv">380</span>, <span class="dv">381</span>, <span class="dv">382</span>, <span class="dv">383</span>, <span class="dv">384</span>, <span class="dv">385</span>, <span class="dv">386</span>, <span class="dv">387</span>, <span class="dv">388</span>, <span class="dv">389</span>, <span class="dv">390</span>, <span class="dv">391</span>, <span class="dv">392</span>, <span class="dv">393</span>, <span class="dv">394</span>, <span class="dv">395</span>, <span class="dv">396</span>, <span class="dv">397</span>, <span class="dv">398</span>, <span class="dv">399</span>, <span class="dv">400</span>, <span class="dv">401</span>, <span class="dv">402</span>, <span class="dv">403</span>, <span class="dv">404</span>, <span class="dv">405</span>, <span class="dv">406</span>, <span class="dv">407</span>, <span class="dv">408</span>, <span class="dv">409</span>, <span class="dv">410</span>, <span class="dv">411</span>, <span class="dv">412</span>, <span class="dv">413</span>, <span class="dv">414</span>, <span class="dv">415</span>, <span class="dv">416</span>, <span class="dv">417</span>, <span class="dv">418</span>, <span class="dv">419</span>, <span class="dv">420</span>, <span class="dv">421</span>, <span class="dv">422</span>, <span class="dv">423</span>, <span class="dv">424</span>, <span class="dv">425</span>, <span class="dv">426</span>, <span class="dv">427</span>, <span class="dv">428</span>, <span class="dv">429</span>, <span class="dv">430</span>, <span class="dv">431</span>, <span class="dv">432</span>, <span class="dv">433</span>, <span class="dv">434</span>, <span class="dv">435</span>, <span class="dv">436</span>, <span class="dv">437</span>, <span class="dv">438</span>, <span class="dv">439</span></a>
<a class="sourceLine" id="cb987-16" title="16">m <span class="op">=</span> bravais_lattice(<span class="dv">47</span>)</a>
<a class="sourceLine" id="cb987-17" title="17">result <span class="op">=</span> m.lower() <span class="op">==</span> <span class="st">&#39;orthorhombic&#39;</span></a></code></pre></div>
<p>Output:</p>
<pre><code>invalid syntax (&lt;string&gt;, line 17)</code></pre>
<h4 id="run-4-89">Run 4</h4>
<div class="sourceCode" id="cb989"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb989-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb989-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb989-3" title="3"></a>
<a class="sourceLine" id="cb989-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb989-5" title="5"><span class="co">compute sin(pi/2)</span></a>
<a class="sourceLine" id="cb989-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb989-7" title="7">x <span class="op">=</span> math.sin(math.pi <span class="op">/</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb989-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb989-9" title="9"></a>
<a class="sourceLine" id="cb989-10" title="10"></a>
<a class="sourceLine" id="cb989-11" title="11"><span class="kw">def</span> bravais_lattice(group_number):</a>
<a class="sourceLine" id="cb989-12" title="12">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb989-13" title="13"><span class="co">    Return bravais lattice name given space group number</span></a>
<a class="sourceLine" id="cb989-14" title="14"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb989-15" title="15">    <span class="cf">if</span> group_number <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="dv">3</span>):</a>
<a class="sourceLine" id="cb989-16" title="16">        <span class="cf">return</span> <span class="st">&quot;triclinic&quot;</span></a>
<a class="sourceLine" id="cb989-17" title="17">    <span class="cf">elif</span> group_number <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">3</span>, <span class="dv">16</span>):</a>
<a class="sourceLine" id="cb989-18" title="18">        <span class="cf">return</span> <span class="st">&quot;monoclinic&quot;</span></a>
<a class="sourceLine" id="cb989-19" title="19">    <span class="cf">elif</span> group_number <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">16</span>, <span class="dv">75</span>):</a>
<a class="sourceLine" id="cb989-20" title="20">        <span class="cf">return</span> <span class="st">&quot;orthorhombic&quot;</span></a>
<a class="sourceLine" id="cb989-21" title="21">    <span class="cf">elif</span> group_number <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">75</span>, <span class="dv">143</span>):</a>
<a class="sourceLine" id="cb989-22" title="22">        <span class="cf">return</span> <span class="st">&quot;tetragonal&quot;</span></a>
<a class="sourceLine" id="cb989-23" title="23">    <span class="cf">elif</span> group_number <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">143</span>, <span class="dv">168</span>):</a>
<a class="sourceLine" id="cb989-24" title="24">        <span class="cf">return</span> <span class="st">&quot;trigonal&quot;</span></a>
<a class="sourceLine" id="cb989-25" title="25">    <span class="cf">elif</span> group_number <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">168</span>, <span class="dv">195</span>):</a>
<a class="sourceLine" id="cb989-26" title="26">        <span class="cf">return</span> <span class="st">&quot;hexagonal&quot;</span></a>
<a class="sourceLine" id="cb989-27" title="27">    <span class="cf">elif</span> group_number <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">195</span>, <span class="dv">231</span>):</a>
<a class="sourceLine" id="cb989-28" title="28">        <span class="cf">return</span> <span class="st">&quot;cubic&quot;</span></a>
<a class="sourceLine" id="cb989-29" title="29">    <span class="cf">else</span>:</a>
<a class="sourceLine" id="cb989-30" title="30">        <span class="cf">raise</span> <span class="pp">ValueError</span>(<span class="st">&quot;Invalid space group number&quot;</span>)</a>
<a class="sourceLine" id="cb989-31" title="31">    </a>
<a class="sourceLine" id="cb989-32" title="32">m <span class="op">=</span> bravais_lattice(<span class="dv">47</span>)</a>
<a class="sourceLine" id="cb989-33" title="33">result <span class="op">=</span> m.lower() <span class="op">==</span> <span class="st">&#39;orthorhombic&#39;</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>canonicalize</summary></p>
<h4 id="query-90">Query</h4>
<div class="sourceCode" id="cb991"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb991-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb991-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb991-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb991-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb991-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb991-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb991-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb991-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb991-9" title="9"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb991-10" title="10"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb991-11" title="11"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb991-12" title="12"></a>
<a class="sourceLine" id="cb991-13" title="13"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb991-14" title="14"><span class="co">print rdkit version</span></a>
<a class="sourceLine" id="cb991-15" title="15"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb991-16" title="16"><span class="bu">print</span>(rdkit.__version__)</a>
<a class="sourceLine" id="cb991-17" title="17"><span class="co"># end</span></a>
<a class="sourceLine" id="cb991-18" title="18"></a>
<a class="sourceLine" id="cb991-19" title="19"><span class="kw">def</span> canonical(smiles_list):</a>
<a class="sourceLine" id="cb991-20" title="20">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb991-21" title="21"><span class="co">    Returns list of canonical forms of given molecules</span></a>
<a class="sourceLine" id="cb991-22" title="22"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb991-23" title="23">    </a></code></pre></div>
<h4 id="run-0-90">Run 0</h4>
<div class="sourceCode" id="cb992"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb992-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb992-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb992-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb992-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb992-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb992-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb992-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb992-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb992-9" title="9"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb992-10" title="10"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb992-11" title="11"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb992-12" title="12"></a>
<a class="sourceLine" id="cb992-13" title="13"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb992-14" title="14"><span class="co">print rdkit version</span></a>
<a class="sourceLine" id="cb992-15" title="15"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb992-16" title="16"><span class="bu">print</span>(rdkit.__version__)</a>
<a class="sourceLine" id="cb992-17" title="17"><span class="co"># end</span></a>
<a class="sourceLine" id="cb992-18" title="18"></a>
<a class="sourceLine" id="cb992-19" title="19"><span class="kw">def</span> canonical(smiles_list):</a>
<a class="sourceLine" id="cb992-20" title="20">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb992-21" title="21"><span class="co">    Returns list of canonical forms of given molecules</span></a>
<a class="sourceLine" id="cb992-22" title="22"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb992-23" title="23">    can_list <span class="op">=</span> []</a>
<a class="sourceLine" id="cb992-24" title="24">    <span class="cf">for</span> smiles <span class="kw">in</span> smiles_list:</a>
<a class="sourceLine" id="cb992-25" title="25">        mol <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb992-26" title="26">        can_list.append(Chem.MolToSmiles(mol, isomericSmiles<span class="op">=</span><span class="va">True</span>))</a>
<a class="sourceLine" id="cb992-27" title="27">    <span class="cf">return</span> can_list</a>
<a class="sourceLine" id="cb992-28" title="28"></a>
<a class="sourceLine" id="cb992-29" title="29">smiles <span class="op">=</span> [</a>
<a class="sourceLine" id="cb992-30" title="30">    <span class="st">&#39;C1=CC=CN=C1&#39;</span>,</a>
<a class="sourceLine" id="cb992-31" title="31">    <span class="st">&#39;c1cccnc1&#39;</span>,</a>
<a class="sourceLine" id="cb992-32" title="32">    <span class="st">&#39;C([H])C&#39;</span></a>
<a class="sourceLine" id="cb992-33" title="33">]</a>
<a class="sourceLine" id="cb992-34" title="34"></a>
<a class="sourceLine" id="cb992-35" title="35">ref_csmiles <span class="op">=</span> [</a>
<a class="sourceLine" id="cb992-36" title="36">    <span class="st">&#39;c1ccncc1&#39;</span>,</a>
<a class="sourceLine" id="cb992-37" title="37">    <span class="st">&#39;c1ccncc1&#39;</span>,</a>
<a class="sourceLine" id="cb992-38" title="38">    <span class="st">&#39;CC&#39;</span></a>
<a class="sourceLine" id="cb992-39" title="39">]</a>
<a class="sourceLine" id="cb992-40" title="40"></a>
<a class="sourceLine" id="cb992-41" title="41">csmiles <span class="op">=</span> canonical(smiles)</a>
<a class="sourceLine" id="cb992-42" title="42"></a>
<a class="sourceLine" id="cb992-43" title="43"><span class="bu">print</span>(csmiles)</a>
<a class="sourceLine" id="cb992-44" title="44"><span class="bu">print</span>(ref_csmiles)</a>
<a class="sourceLine" id="cb992-45" title="45"></a>
<a class="sourceLine" id="cb992-46" title="46">result <span class="op">=</span> <span class="va">True</span></a>
<a class="sourceLine" id="cb992-47" title="47"><span class="cf">for</span> r, c <span class="kw">in</span> <span class="bu">zip</span>(ref_csmiles, csmiles):</a>
<a class="sourceLine" id="cb992-48" title="48">    result <span class="op">=</span> result <span class="kw">and</span> r <span class="op">==</span> c</a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-90">Run 1</h4>
<div class="sourceCode" id="cb994"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb994-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb994-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb994-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb994-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb994-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb994-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb994-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb994-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb994-9" title="9"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb994-10" title="10"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb994-11" title="11"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb994-12" title="12"></a>
<a class="sourceLine" id="cb994-13" title="13"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb994-14" title="14"><span class="co">print rdkit version</span></a>
<a class="sourceLine" id="cb994-15" title="15"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb994-16" title="16"><span class="bu">print</span>(rdkit.__version__)</a>
<a class="sourceLine" id="cb994-17" title="17"><span class="co"># end</span></a>
<a class="sourceLine" id="cb994-18" title="18"></a>
<a class="sourceLine" id="cb994-19" title="19"><span class="kw">def</span> canonical(smiles_list):</a>
<a class="sourceLine" id="cb994-20" title="20">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb994-21" title="21"><span class="co">    Returns list of canonical forms of given molecules</span></a>
<a class="sourceLine" id="cb994-22" title="22"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb994-23" title="23">    can_list <span class="op">=</span> []</a>
<a class="sourceLine" id="cb994-24" title="24">    <span class="cf">for</span> smiles <span class="kw">in</span> smiles_list:</a>
<a class="sourceLine" id="cb994-25" title="25">        mol <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb994-26" title="26">        can_list.append(Chem.MolToSmiles(mol, isomericSmiles<span class="op">=</span><span class="va">True</span>))</a>
<a class="sourceLine" id="cb994-27" title="27">    <span class="cf">return</span> can_list</a>
<a class="sourceLine" id="cb994-28" title="28"></a>
<a class="sourceLine" id="cb994-29" title="29">smiles <span class="op">=</span> [</a>
<a class="sourceLine" id="cb994-30" title="30">    <span class="st">&#39;C1=CC=CN=C1&#39;</span>,</a>
<a class="sourceLine" id="cb994-31" title="31">    <span class="st">&#39;c1cccnc1&#39;</span>,</a>
<a class="sourceLine" id="cb994-32" title="32">    <span class="st">&#39;C([H])C&#39;</span></a>
<a class="sourceLine" id="cb994-33" title="33">]</a>
<a class="sourceLine" id="cb994-34" title="34"></a>
<a class="sourceLine" id="cb994-35" title="35">ref_csmiles <span class="op">=</span> [</a>
<a class="sourceLine" id="cb994-36" title="36">    <span class="st">&#39;c1ccncc1&#39;</span>,</a>
<a class="sourceLine" id="cb994-37" title="37">    <span class="st">&#39;c1ccncc1&#39;</span>,</a>
<a class="sourceLine" id="cb994-38" title="38">    <span class="st">&#39;CC&#39;</span></a>
<a class="sourceLine" id="cb994-39" title="39">]</a>
<a class="sourceLine" id="cb994-40" title="40"></a>
<a class="sourceLine" id="cb994-41" title="41">csmiles <span class="op">=</span> canonical(smiles)</a>
<a class="sourceLine" id="cb994-42" title="42"></a>
<a class="sourceLine" id="cb994-43" title="43"><span class="bu">print</span>(csmiles)</a>
<a class="sourceLine" id="cb994-44" title="44"><span class="bu">print</span>(ref_csmiles)</a>
<a class="sourceLine" id="cb994-45" title="45"></a>
<a class="sourceLine" id="cb994-46" title="46">result <span class="op">=</span> <span class="va">True</span></a>
<a class="sourceLine" id="cb994-47" title="47"><span class="cf">for</span> r, c <span class="kw">in</span> <span class="bu">zip</span>(ref_csmiles, csmiles):</a>
<a class="sourceLine" id="cb994-48" title="48">    result <span class="op">=</span> result <span class="kw">and</span> r <span class="op">==</span> c</a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-90">Run 2</h4>
<div class="sourceCode" id="cb996"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb996-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb996-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb996-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb996-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb996-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb996-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb996-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb996-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb996-9" title="9"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb996-10" title="10"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb996-11" title="11"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb996-12" title="12"></a>
<a class="sourceLine" id="cb996-13" title="13"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb996-14" title="14"><span class="co">print rdkit version</span></a>
<a class="sourceLine" id="cb996-15" title="15"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb996-16" title="16"><span class="bu">print</span>(rdkit.__version__)</a>
<a class="sourceLine" id="cb996-17" title="17"><span class="co"># end</span></a>
<a class="sourceLine" id="cb996-18" title="18"></a>
<a class="sourceLine" id="cb996-19" title="19"><span class="kw">def</span> canonical(smiles_list):</a>
<a class="sourceLine" id="cb996-20" title="20">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb996-21" title="21"><span class="co">    Returns list of canonical forms of given molecules</span></a>
<a class="sourceLine" id="cb996-22" title="22"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb996-23" title="23">    canon_list <span class="op">=</span> []</a>
<a class="sourceLine" id="cb996-24" title="24">    <span class="cf">for</span> smiles <span class="kw">in</span> smiles_list:</a>
<a class="sourceLine" id="cb996-25" title="25">        mol <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb996-26" title="26">        canon_list.append(Chem.MolToSmiles(mol, isomericSmiles<span class="op">=</span><span class="va">True</span>))</a>
<a class="sourceLine" id="cb996-27" title="27">    <span class="cf">return</span> canon_list</a>
<a class="sourceLine" id="cb996-28" title="28"></a>
<a class="sourceLine" id="cb996-29" title="29">smiles <span class="op">=</span> [</a>
<a class="sourceLine" id="cb996-30" title="30">    <span class="st">&#39;C1=CC=CN=C1&#39;</span>,</a>
<a class="sourceLine" id="cb996-31" title="31">    <span class="st">&#39;c1cccnc1&#39;</span>,</a>
<a class="sourceLine" id="cb996-32" title="32">    <span class="st">&#39;C([H])C&#39;</span></a>
<a class="sourceLine" id="cb996-33" title="33">]</a>
<a class="sourceLine" id="cb996-34" title="34"></a>
<a class="sourceLine" id="cb996-35" title="35">ref_csmiles <span class="op">=</span> [</a>
<a class="sourceLine" id="cb996-36" title="36">    <span class="st">&#39;c1ccncc1&#39;</span>,</a>
<a class="sourceLine" id="cb996-37" title="37">    <span class="st">&#39;c1ccncc1&#39;</span>,</a>
<a class="sourceLine" id="cb996-38" title="38">    <span class="st">&#39;CC&#39;</span></a>
<a class="sourceLine" id="cb996-39" title="39">]</a>
<a class="sourceLine" id="cb996-40" title="40"></a>
<a class="sourceLine" id="cb996-41" title="41">csmiles <span class="op">=</span> canonical(smiles)</a>
<a class="sourceLine" id="cb996-42" title="42"></a>
<a class="sourceLine" id="cb996-43" title="43"><span class="bu">print</span>(csmiles)</a>
<a class="sourceLine" id="cb996-44" title="44"><span class="bu">print</span>(ref_csmiles)</a>
<a class="sourceLine" id="cb996-45" title="45"></a>
<a class="sourceLine" id="cb996-46" title="46">result <span class="op">=</span> <span class="va">True</span></a>
<a class="sourceLine" id="cb996-47" title="47"><span class="cf">for</span> r, c <span class="kw">in</span> <span class="bu">zip</span>(ref_csmiles, csmiles):</a>
<a class="sourceLine" id="cb996-48" title="48">    result <span class="op">=</span> result <span class="kw">and</span> r <span class="op">==</span> c</a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-90">Run 3</h4>
<div class="sourceCode" id="cb998"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb998-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb998-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb998-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb998-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb998-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb998-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb998-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb998-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb998-9" title="9"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb998-10" title="10"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb998-11" title="11"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb998-12" title="12"></a>
<a class="sourceLine" id="cb998-13" title="13"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb998-14" title="14"><span class="co">print rdkit version</span></a>
<a class="sourceLine" id="cb998-15" title="15"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb998-16" title="16"><span class="bu">print</span>(rdkit.__version__)</a>
<a class="sourceLine" id="cb998-17" title="17"><span class="co"># end</span></a>
<a class="sourceLine" id="cb998-18" title="18"></a>
<a class="sourceLine" id="cb998-19" title="19"><span class="kw">def</span> canonical(smiles_list):</a>
<a class="sourceLine" id="cb998-20" title="20">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb998-21" title="21"><span class="co">    Returns list of canonical forms of given molecules</span></a>
<a class="sourceLine" id="cb998-22" title="22"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb998-23" title="23">    can_list <span class="op">=</span> []</a>
<a class="sourceLine" id="cb998-24" title="24">    <span class="cf">for</span> smiles <span class="kw">in</span> smiles_list:</a>
<a class="sourceLine" id="cb998-25" title="25">        mol <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb998-26" title="26">        can_list.append(Chem.MolToSmiles(mol))</a>
<a class="sourceLine" id="cb998-27" title="27">    <span class="cf">return</span> can_list</a>
<a class="sourceLine" id="cb998-28" title="28"></a>
<a class="sourceLine" id="cb998-29" title="29">smiles <span class="op">=</span> [</a>
<a class="sourceLine" id="cb998-30" title="30">    <span class="st">&#39;C1=CC=CN=C1&#39;</span>,</a>
<a class="sourceLine" id="cb998-31" title="31">    <span class="st">&#39;c1cccnc1&#39;</span>,</a>
<a class="sourceLine" id="cb998-32" title="32">    <span class="st">&#39;C([H])C&#39;</span></a>
<a class="sourceLine" id="cb998-33" title="33">]</a>
<a class="sourceLine" id="cb998-34" title="34"></a>
<a class="sourceLine" id="cb998-35" title="35">ref_csmiles <span class="op">=</span> [</a>
<a class="sourceLine" id="cb998-36" title="36">    <span class="st">&#39;c1ccncc1&#39;</span>,</a>
<a class="sourceLine" id="cb998-37" title="37">    <span class="st">&#39;c1ccncc1&#39;</span>,</a>
<a class="sourceLine" id="cb998-38" title="38">    <span class="st">&#39;CC&#39;</span></a>
<a class="sourceLine" id="cb998-39" title="39">]</a>
<a class="sourceLine" id="cb998-40" title="40"></a>
<a class="sourceLine" id="cb998-41" title="41">csmiles <span class="op">=</span> canonical(smiles)</a>
<a class="sourceLine" id="cb998-42" title="42"></a>
<a class="sourceLine" id="cb998-43" title="43"><span class="bu">print</span>(csmiles)</a>
<a class="sourceLine" id="cb998-44" title="44"><span class="bu">print</span>(ref_csmiles)</a>
<a class="sourceLine" id="cb998-45" title="45"></a>
<a class="sourceLine" id="cb998-46" title="46">result <span class="op">=</span> <span class="va">True</span></a>
<a class="sourceLine" id="cb998-47" title="47"><span class="cf">for</span> r, c <span class="kw">in</span> <span class="bu">zip</span>(ref_csmiles, csmiles):</a>
<a class="sourceLine" id="cb998-48" title="48">    result <span class="op">=</span> result <span class="kw">and</span> r <span class="op">==</span> c</a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-90">Run 4</h4>
<div class="sourceCode" id="cb1000"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1000-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1000-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb1000-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb1000-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb1000-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb1000-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb1000-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb1000-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb1000-9" title="9"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb1000-10" title="10"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb1000-11" title="11"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1000-12" title="12"></a>
<a class="sourceLine" id="cb1000-13" title="13"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1000-14" title="14"><span class="co">print rdkit version</span></a>
<a class="sourceLine" id="cb1000-15" title="15"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1000-16" title="16"><span class="bu">print</span>(rdkit.__version__)</a>
<a class="sourceLine" id="cb1000-17" title="17"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1000-18" title="18"></a>
<a class="sourceLine" id="cb1000-19" title="19"><span class="kw">def</span> canonical(smiles_list):</a>
<a class="sourceLine" id="cb1000-20" title="20">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1000-21" title="21"><span class="co">    Returns list of canonical forms of given molecules</span></a>
<a class="sourceLine" id="cb1000-22" title="22"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1000-23" title="23">    can_smiles_list <span class="op">=</span> []</a>
<a class="sourceLine" id="cb1000-24" title="24">    <span class="cf">for</span> smiles <span class="kw">in</span> smiles_list:</a>
<a class="sourceLine" id="cb1000-25" title="25">        mol <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb1000-26" title="26">        can_smiles <span class="op">=</span> Chem.MolToSmiles(mol, isomericSmiles<span class="op">=</span><span class="va">True</span>)</a>
<a class="sourceLine" id="cb1000-27" title="27">        can_smiles_list.append(can_smiles)</a>
<a class="sourceLine" id="cb1000-28" title="28">    <span class="cf">return</span> can_smiles_list</a>
<a class="sourceLine" id="cb1000-29" title="29"></a>
<a class="sourceLine" id="cb1000-30" title="30">smiles <span class="op">=</span> [</a>
<a class="sourceLine" id="cb1000-31" title="31">    <span class="st">&#39;C1=CC=CN=C1&#39;</span>,</a>
<a class="sourceLine" id="cb1000-32" title="32">    <span class="st">&#39;c1cccnc1&#39;</span>,</a>
<a class="sourceLine" id="cb1000-33" title="33">    <span class="st">&#39;C([H])C&#39;</span></a>
<a class="sourceLine" id="cb1000-34" title="34">]</a>
<a class="sourceLine" id="cb1000-35" title="35"></a>
<a class="sourceLine" id="cb1000-36" title="36">ref_csmiles <span class="op">=</span> [</a>
<a class="sourceLine" id="cb1000-37" title="37">    <span class="st">&#39;c1ccncc1&#39;</span>,</a>
<a class="sourceLine" id="cb1000-38" title="38">    <span class="st">&#39;c1ccncc1&#39;</span>,</a>
<a class="sourceLine" id="cb1000-39" title="39">    <span class="st">&#39;CC&#39;</span></a>
<a class="sourceLine" id="cb1000-40" title="40">]</a>
<a class="sourceLine" id="cb1000-41" title="41"></a>
<a class="sourceLine" id="cb1000-42" title="42">csmiles <span class="op">=</span> canonical(smiles)</a>
<a class="sourceLine" id="cb1000-43" title="43"></a>
<a class="sourceLine" id="cb1000-44" title="44"><span class="bu">print</span>(csmiles)</a>
<a class="sourceLine" id="cb1000-45" title="45"><span class="bu">print</span>(ref_csmiles)</a>
<a class="sourceLine" id="cb1000-46" title="46"></a>
<a class="sourceLine" id="cb1000-47" title="47">result <span class="op">=</span> <span class="va">True</span></a>
<a class="sourceLine" id="cb1000-48" title="48"><span class="cf">for</span> r, c <span class="kw">in</span> <span class="bu">zip</span>(ref_csmiles, csmiles):</a>
<a class="sourceLine" id="cb1000-49" title="49">    result <span class="op">=</span> result <span class="kw">and</span> r <span class="op">==</span> c</a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>carnot_efficiency</summary></p>
<h4 id="query-91">Query</h4>
<div class="sourceCode" id="cb1002"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1002-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb1002-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb1002-3" title="3"></a>
<a class="sourceLine" id="cb1002-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1002-5" title="5"><span class="co">compute sin(pi/2)</span></a>
<a class="sourceLine" id="cb1002-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1002-7" title="7">x <span class="op">=</span> math.sin(math.pi <span class="op">/</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1002-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1002-9" title="9"></a>
<a class="sourceLine" id="cb1002-10" title="10"><span class="kw">def</span> carnot_efficiency(T_hot, T_cold):</a>
<a class="sourceLine" id="cb1002-11" title="11">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1002-12" title="12"><span class="co">   This function returns the efficiency of a carnot efficiency operating between two temperatures</span></a>
<a class="sourceLine" id="cb1002-13" title="13"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1002-14" title="14">   </a></code></pre></div>
<h4 id="run-0-91">Run 0</h4>
<div class="sourceCode" id="cb1003"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1003-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb1003-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb1003-3" title="3"></a>
<a class="sourceLine" id="cb1003-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1003-5" title="5"><span class="co">compute sin(pi/2)</span></a>
<a class="sourceLine" id="cb1003-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1003-7" title="7">x <span class="op">=</span> math.sin(math.pi <span class="op">/</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1003-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1003-9" title="9"></a>
<a class="sourceLine" id="cb1003-10" title="10"><span class="kw">def</span> carnot_efficiency(T_hot, T_cold):</a>
<a class="sourceLine" id="cb1003-11" title="11">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1003-12" title="12"><span class="co">   This function returns the efficiency of a carnot efficiency operating between two temperatures</span></a>
<a class="sourceLine" id="cb1003-13" title="13"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1003-14" title="14">   <span class="cf">return</span> <span class="dv">1</span> <span class="op">-</span> T_cold <span class="op">/</span> T_hot</a>
<a class="sourceLine" id="cb1003-15" title="15"></a>
<a class="sourceLine" id="cb1003-16" title="16"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1003-17" title="17"></a>
<a class="sourceLine" id="cb1003-18" title="18">T_cold <span class="op">=</span> <span class="dv">300</span></a>
<a class="sourceLine" id="cb1003-19" title="19">T_hot <span class="op">=</span> <span class="dv">600</span></a>
<a class="sourceLine" id="cb1003-20" title="20"></a>
<a class="sourceLine" id="cb1003-21" title="21">eps <span class="op">=</span> <span class="dv">1</span> <span class="op">-</span> T_cold<span class="op">/</span>T_hot</a>
<a class="sourceLine" id="cb1003-22" title="22"></a>
<a class="sourceLine" id="cb1003-23" title="23">eps_codex <span class="op">=</span> carnot_efficiency(T_hot, T_cold)</a>
<a class="sourceLine" id="cb1003-24" title="24"></a>
<a class="sourceLine" id="cb1003-25" title="25"><span class="co"># check </span></a>
<a class="sourceLine" id="cb1003-26" title="26"><span class="cf">if</span> np.isclose(eps, eps_codex, rtol<span class="op">=</span><span class="fl">0.01</span>) <span class="op">==</span> <span class="va">True</span>:</a>
<a class="sourceLine" id="cb1003-27" title="27">    result <span class="op">=</span> <span class="va">True</span> </a>
<a class="sourceLine" id="cb1003-28" title="28"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb1003-29" title="29">    result <span class="op">=</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-91">Run 1</h4>
<div class="sourceCode" id="cb1005"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1005-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb1005-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb1005-3" title="3"></a>
<a class="sourceLine" id="cb1005-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1005-5" title="5"><span class="co">compute sin(pi/2)</span></a>
<a class="sourceLine" id="cb1005-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1005-7" title="7">x <span class="op">=</span> math.sin(math.pi <span class="op">/</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1005-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1005-9" title="9"></a>
<a class="sourceLine" id="cb1005-10" title="10"><span class="kw">def</span> carnot_efficiency(T_hot, T_cold):</a>
<a class="sourceLine" id="cb1005-11" title="11">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1005-12" title="12"><span class="co">   This function returns the efficiency of a carnot efficiency operating between two temperatures</span></a>
<a class="sourceLine" id="cb1005-13" title="13"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1005-14" title="14">   <span class="cf">return</span> <span class="dv">1</span> <span class="op">-</span> T_cold <span class="op">/</span> T_hot</a>
<a class="sourceLine" id="cb1005-15" title="15"></a>
<a class="sourceLine" id="cb1005-16" title="16"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1005-17" title="17"></a>
<a class="sourceLine" id="cb1005-18" title="18">T_cold <span class="op">=</span> <span class="dv">300</span></a>
<a class="sourceLine" id="cb1005-19" title="19">T_hot <span class="op">=</span> <span class="dv">600</span></a>
<a class="sourceLine" id="cb1005-20" title="20"></a>
<a class="sourceLine" id="cb1005-21" title="21">eps <span class="op">=</span> <span class="dv">1</span> <span class="op">-</span> T_cold<span class="op">/</span>T_hot</a>
<a class="sourceLine" id="cb1005-22" title="22"></a>
<a class="sourceLine" id="cb1005-23" title="23">eps_codex <span class="op">=</span> carnot_efficiency(T_hot, T_cold)</a>
<a class="sourceLine" id="cb1005-24" title="24"></a>
<a class="sourceLine" id="cb1005-25" title="25"><span class="co"># check </span></a>
<a class="sourceLine" id="cb1005-26" title="26"><span class="cf">if</span> np.isclose(eps, eps_codex, rtol<span class="op">=</span><span class="fl">0.01</span>) <span class="op">==</span> <span class="va">True</span>:</a>
<a class="sourceLine" id="cb1005-27" title="27">    result <span class="op">=</span> <span class="va">True</span> </a>
<a class="sourceLine" id="cb1005-28" title="28"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb1005-29" title="29">    result <span class="op">=</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-91">Run 2</h4>
<div class="sourceCode" id="cb1007"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1007-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb1007-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb1007-3" title="3"></a>
<a class="sourceLine" id="cb1007-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1007-5" title="5"><span class="co">compute sin(pi/2)</span></a>
<a class="sourceLine" id="cb1007-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1007-7" title="7">x <span class="op">=</span> math.sin(math.pi <span class="op">/</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1007-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1007-9" title="9"></a>
<a class="sourceLine" id="cb1007-10" title="10"><span class="kw">def</span> carnot_efficiency(T_hot, T_cold):</a>
<a class="sourceLine" id="cb1007-11" title="11">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1007-12" title="12"><span class="co">   This function returns the efficiency of a carnot efficiency operating between two temperatures</span></a>
<a class="sourceLine" id="cb1007-13" title="13"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1007-14" title="14">   <span class="cf">return</span> <span class="dv">1</span> <span class="op">-</span> T_cold <span class="op">/</span> T_hot</a>
<a class="sourceLine" id="cb1007-15" title="15"></a>
<a class="sourceLine" id="cb1007-16" title="16"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1007-17" title="17"></a>
<a class="sourceLine" id="cb1007-18" title="18">T_cold <span class="op">=</span> <span class="dv">300</span></a>
<a class="sourceLine" id="cb1007-19" title="19">T_hot <span class="op">=</span> <span class="dv">600</span></a>
<a class="sourceLine" id="cb1007-20" title="20"></a>
<a class="sourceLine" id="cb1007-21" title="21">eps <span class="op">=</span> <span class="dv">1</span> <span class="op">-</span> T_cold<span class="op">/</span>T_hot</a>
<a class="sourceLine" id="cb1007-22" title="22"></a>
<a class="sourceLine" id="cb1007-23" title="23">eps_codex <span class="op">=</span> carnot_efficiency(T_hot, T_cold)</a>
<a class="sourceLine" id="cb1007-24" title="24"></a>
<a class="sourceLine" id="cb1007-25" title="25"><span class="co"># check </span></a>
<a class="sourceLine" id="cb1007-26" title="26"><span class="cf">if</span> np.isclose(eps, eps_codex, rtol<span class="op">=</span><span class="fl">0.01</span>) <span class="op">==</span> <span class="va">True</span>:</a>
<a class="sourceLine" id="cb1007-27" title="27">    result <span class="op">=</span> <span class="va">True</span> </a>
<a class="sourceLine" id="cb1007-28" title="28"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb1007-29" title="29">    result <span class="op">=</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-91">Run 3</h4>
<div class="sourceCode" id="cb1009"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1009-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb1009-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb1009-3" title="3"></a>
<a class="sourceLine" id="cb1009-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1009-5" title="5"><span class="co">compute sin(pi/2)</span></a>
<a class="sourceLine" id="cb1009-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1009-7" title="7">x <span class="op">=</span> math.sin(math.pi <span class="op">/</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1009-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1009-9" title="9"></a>
<a class="sourceLine" id="cb1009-10" title="10"><span class="kw">def</span> carnot_efficiency(T_hot, T_cold):</a>
<a class="sourceLine" id="cb1009-11" title="11">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1009-12" title="12"><span class="co">   This function returns the efficiency of a carnot efficiency operating between two temperatures</span></a>
<a class="sourceLine" id="cb1009-13" title="13"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1009-14" title="14">   <span class="cf">return</span> <span class="dv">1</span> <span class="op">-</span> T_cold <span class="op">/</span> T_hot</a>
<a class="sourceLine" id="cb1009-15" title="15"></a>
<a class="sourceLine" id="cb1009-16" title="16"></a>
<a class="sourceLine" id="cb1009-17" title="17"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1009-18" title="18"></a>
<a class="sourceLine" id="cb1009-19" title="19">T_cold <span class="op">=</span> <span class="dv">300</span></a>
<a class="sourceLine" id="cb1009-20" title="20">T_hot <span class="op">=</span> <span class="dv">600</span></a>
<a class="sourceLine" id="cb1009-21" title="21"></a>
<a class="sourceLine" id="cb1009-22" title="22">eps <span class="op">=</span> <span class="dv">1</span> <span class="op">-</span> T_cold<span class="op">/</span>T_hot</a>
<a class="sourceLine" id="cb1009-23" title="23"></a>
<a class="sourceLine" id="cb1009-24" title="24">eps_codex <span class="op">=</span> carnot_efficiency(T_hot, T_cold)</a>
<a class="sourceLine" id="cb1009-25" title="25"></a>
<a class="sourceLine" id="cb1009-26" title="26"><span class="co"># check </span></a>
<a class="sourceLine" id="cb1009-27" title="27"><span class="cf">if</span> np.isclose(eps, eps_codex, rtol<span class="op">=</span><span class="fl">0.01</span>) <span class="op">==</span> <span class="va">True</span>:</a>
<a class="sourceLine" id="cb1009-28" title="28">    result <span class="op">=</span> <span class="va">True</span> </a>
<a class="sourceLine" id="cb1009-29" title="29"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb1009-30" title="30">    result <span class="op">=</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-91">Run 4</h4>
<div class="sourceCode" id="cb1011"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1011-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb1011-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb1011-3" title="3"></a>
<a class="sourceLine" id="cb1011-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1011-5" title="5"><span class="co">compute sin(pi/2)</span></a>
<a class="sourceLine" id="cb1011-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1011-7" title="7">x <span class="op">=</span> math.sin(math.pi <span class="op">/</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1011-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1011-9" title="9"></a>
<a class="sourceLine" id="cb1011-10" title="10"><span class="kw">def</span> carnot_efficiency(T_hot, T_cold):</a>
<a class="sourceLine" id="cb1011-11" title="11">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1011-12" title="12"><span class="co">   This function returns the efficiency of a carnot efficiency operating between two temperatures</span></a>
<a class="sourceLine" id="cb1011-13" title="13"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1011-14" title="14">   <span class="cf">return</span> <span class="dv">1</span> <span class="op">-</span> T_cold <span class="op">/</span> T_hot</a>
<a class="sourceLine" id="cb1011-15" title="15"></a>
<a class="sourceLine" id="cb1011-16" title="16"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1011-17" title="17"></a>
<a class="sourceLine" id="cb1011-18" title="18">T_cold <span class="op">=</span> <span class="dv">300</span></a>
<a class="sourceLine" id="cb1011-19" title="19">T_hot <span class="op">=</span> <span class="dv">600</span></a>
<a class="sourceLine" id="cb1011-20" title="20"></a>
<a class="sourceLine" id="cb1011-21" title="21">eps <span class="op">=</span> <span class="dv">1</span> <span class="op">-</span> T_cold<span class="op">/</span>T_hot</a>
<a class="sourceLine" id="cb1011-22" title="22"></a>
<a class="sourceLine" id="cb1011-23" title="23">eps_codex <span class="op">=</span> carnot_efficiency(T_hot, T_cold)</a>
<a class="sourceLine" id="cb1011-24" title="24"></a>
<a class="sourceLine" id="cb1011-25" title="25"><span class="co"># check </span></a>
<a class="sourceLine" id="cb1011-26" title="26"><span class="cf">if</span> np.isclose(eps, eps_codex, rtol<span class="op">=</span><span class="fl">0.01</span>) <span class="op">==</span> <span class="va">True</span>:</a>
<a class="sourceLine" id="cb1011-27" title="27">    result <span class="op">=</span> <span class="va">True</span> </a>
<a class="sourceLine" id="cb1011-28" title="28"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb1011-29" title="29">    result <span class="op">=</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>claussius</summary></p>
<h4 id="query-92">Query</h4>
<div class="sourceCode" id="cb1013"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1013-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb1013-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb1013-3" title="3"></a>
<a class="sourceLine" id="cb1013-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1013-5" title="5"><span class="co">compute sin(pi/2)</span></a>
<a class="sourceLine" id="cb1013-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1013-7" title="7">x <span class="op">=</span> math.sin(math.pi <span class="op">/</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1013-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1013-9" title="9"></a>
<a class="sourceLine" id="cb1013-10" title="10"><span class="kw">def</span> claussius(HVap, T1, P1, T2):</a>
<a class="sourceLine" id="cb1013-11" title="11">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1013-12" title="12"><span class="co">   This function returns the phase transition pressure at temperature T2 given a heat of vaporization HVap, and and reference temperature and pressure T1 and P1</span></a>
<a class="sourceLine" id="cb1013-13" title="13"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1013-14" title="14">   </a></code></pre></div>
<h4 id="run-0-92">Run 0</h4>
<div class="sourceCode" id="cb1014"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1014-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb1014-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb1014-3" title="3"></a>
<a class="sourceLine" id="cb1014-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1014-5" title="5"><span class="co">compute sin(pi/2)</span></a>
<a class="sourceLine" id="cb1014-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1014-7" title="7">x <span class="op">=</span> math.sin(math.pi <span class="op">/</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1014-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1014-9" title="9"></a>
<a class="sourceLine" id="cb1014-10" title="10"><span class="kw">def</span> claussius(HVap, T1, P1, T2):</a>
<a class="sourceLine" id="cb1014-11" title="11">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1014-12" title="12"><span class="co">   This function returns the phase transition pressure at temperature T2 given a heat of vaporization HVap, and and reference temperature and pressure T1 and P1</span></a>
<a class="sourceLine" id="cb1014-13" title="13"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1014-14" title="14">   <span class="cf">return</span> P1 <span class="op">*</span> math.exp((HVap <span class="op">/</span> <span class="fl">8.314</span>) <span class="op">*</span> (<span class="dv">1</span> <span class="op">/</span> T1 <span class="op">-</span> <span class="dv">1</span> <span class="op">/</span> T2))</a>
<a class="sourceLine" id="cb1014-15" title="15"></a>
<a class="sourceLine" id="cb1014-16" title="16"></a>
<a class="sourceLine" id="cb1014-17" title="17"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1014-18" title="18"></a>
<a class="sourceLine" id="cb1014-19" title="19"><span class="co"># input</span></a>
<a class="sourceLine" id="cb1014-20" title="20">hvap <span class="op">=</span> <span class="dv">5000</span> <span class="co">#J/mol</span></a>
<a class="sourceLine" id="cb1014-21" title="21">P1 <span class="op">=</span> <span class="dv">1</span> <span class="co"># atm</span></a>
<a class="sourceLine" id="cb1014-22" title="22">R <span class="op">=</span> <span class="fl">8.314</span> <span class="co"># 8.314 J/k mol</span></a>
<a class="sourceLine" id="cb1014-23" title="23">T1 <span class="op">=</span> <span class="dv">300</span>     <span class="co"># in K </span></a>
<a class="sourceLine" id="cb1014-24" title="24">T2 <span class="op">=</span> <span class="dv">350</span> </a>
<a class="sourceLine" id="cb1014-25" title="25"></a>
<a class="sourceLine" id="cb1014-26" title="26">P2_codex <span class="op">=</span> claussius(hvap, T1, P1, T2)</a>
<a class="sourceLine" id="cb1014-27" title="27">P2 <span class="op">=</span> P1<span class="op">*</span>np.exp(<span class="op">-</span>hvap<span class="op">/</span>R<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>T2<span class="dv">-1</span><span class="op">/</span>T1))</a>
<a class="sourceLine" id="cb1014-28" title="28"></a>
<a class="sourceLine" id="cb1014-29" title="29"><span class="co"># check </span></a>
<a class="sourceLine" id="cb1014-30" title="30"><span class="cf">if</span> np.isclose(P2, P2_codex, rtol<span class="op">=</span><span class="fl">0.01</span>) <span class="op">==</span> <span class="va">True</span>:</a>
<a class="sourceLine" id="cb1014-31" title="31">    result <span class="op">=</span> <span class="va">True</span> </a>
<a class="sourceLine" id="cb1014-32" title="32"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb1014-33" title="33">    result <span class="op">=</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-92">Run 1</h4>
<div class="sourceCode" id="cb1016"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1016-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb1016-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb1016-3" title="3"></a>
<a class="sourceLine" id="cb1016-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1016-5" title="5"><span class="co">compute sin(pi/2)</span></a>
<a class="sourceLine" id="cb1016-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1016-7" title="7">x <span class="op">=</span> math.sin(math.pi <span class="op">/</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1016-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1016-9" title="9"></a>
<a class="sourceLine" id="cb1016-10" title="10"><span class="kw">def</span> claussius(HVap, T1, P1, T2):</a>
<a class="sourceLine" id="cb1016-11" title="11">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1016-12" title="12"><span class="co">   This function returns the phase transition pressure at temperature T2 given a heat of vaporization HVap, and and reference temperature and pressure T1 and P1</span></a>
<a class="sourceLine" id="cb1016-13" title="13"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1016-14" title="14">   R <span class="op">=</span> <span class="fl">8.314</span></a>
<a class="sourceLine" id="cb1016-15" title="15">   P2 <span class="op">=</span> P1 <span class="op">*</span> math.exp((HVap <span class="op">/</span> R) <span class="op">*</span> (<span class="dv">1</span> <span class="op">/</span> T1 <span class="op">-</span> <span class="dv">1</span> <span class="op">/</span> T2))</a>
<a class="sourceLine" id="cb1016-16" title="16">   <span class="cf">return</span> P2</a>
<a class="sourceLine" id="cb1016-17" title="17"></a>
<a class="sourceLine" id="cb1016-18" title="18"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1016-19" title="19"></a>
<a class="sourceLine" id="cb1016-20" title="20"><span class="co"># input</span></a>
<a class="sourceLine" id="cb1016-21" title="21">hvap <span class="op">=</span> <span class="dv">5000</span> <span class="co">#J/mol</span></a>
<a class="sourceLine" id="cb1016-22" title="22">P1 <span class="op">=</span> <span class="dv">1</span> <span class="co"># atm</span></a>
<a class="sourceLine" id="cb1016-23" title="23">R <span class="op">=</span> <span class="fl">8.314</span> <span class="co"># 8.314 J/k mol</span></a>
<a class="sourceLine" id="cb1016-24" title="24">T1 <span class="op">=</span> <span class="dv">300</span>     <span class="co"># in K </span></a>
<a class="sourceLine" id="cb1016-25" title="25">T2 <span class="op">=</span> <span class="dv">350</span> </a>
<a class="sourceLine" id="cb1016-26" title="26"></a>
<a class="sourceLine" id="cb1016-27" title="27">P2_codex <span class="op">=</span> claussius(hvap, T1, P1, T2)</a>
<a class="sourceLine" id="cb1016-28" title="28">P2 <span class="op">=</span> P1<span class="op">*</span>np.exp(<span class="op">-</span>hvap<span class="op">/</span>R<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>T2<span class="dv">-1</span><span class="op">/</span>T1))</a>
<a class="sourceLine" id="cb1016-29" title="29"></a>
<a class="sourceLine" id="cb1016-30" title="30"><span class="co"># check </span></a>
<a class="sourceLine" id="cb1016-31" title="31"><span class="cf">if</span> np.isclose(P2, P2_codex, rtol<span class="op">=</span><span class="fl">0.01</span>) <span class="op">==</span> <span class="va">True</span>:</a>
<a class="sourceLine" id="cb1016-32" title="32">    result <span class="op">=</span> <span class="va">True</span> </a>
<a class="sourceLine" id="cb1016-33" title="33"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb1016-34" title="34">    result <span class="op">=</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-92">Run 2</h4>
<div class="sourceCode" id="cb1018"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1018-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb1018-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb1018-3" title="3"></a>
<a class="sourceLine" id="cb1018-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1018-5" title="5"><span class="co">compute sin(pi/2)</span></a>
<a class="sourceLine" id="cb1018-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1018-7" title="7">x <span class="op">=</span> math.sin(math.pi <span class="op">/</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1018-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1018-9" title="9"></a>
<a class="sourceLine" id="cb1018-10" title="10"><span class="kw">def</span> claussius(HVap, T1, P1, T2):</a>
<a class="sourceLine" id="cb1018-11" title="11">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1018-12" title="12"><span class="co">   This function returns the phase transition pressure at temperature T2 given a heat of vaporization HVap, and and reference temperature and pressure T1 and P1</span></a>
<a class="sourceLine" id="cb1018-13" title="13"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1018-14" title="14">   <span class="cf">return</span> P1 <span class="op">*</span> math.exp(HVap <span class="op">*</span> (T2 <span class="op">-</span> T1) <span class="op">/</span> (<span class="fl">8.314</span> <span class="op">*</span> T2 <span class="op">*</span> T1))</a>
<a class="sourceLine" id="cb1018-15" title="15"></a>
<a class="sourceLine" id="cb1018-16" title="16"></a>
<a class="sourceLine" id="cb1018-17" title="17"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1018-18" title="18"></a>
<a class="sourceLine" id="cb1018-19" title="19"><span class="co"># input</span></a>
<a class="sourceLine" id="cb1018-20" title="20">hvap <span class="op">=</span> <span class="dv">5000</span> <span class="co">#J/mol</span></a>
<a class="sourceLine" id="cb1018-21" title="21">P1 <span class="op">=</span> <span class="dv">1</span> <span class="co"># atm</span></a>
<a class="sourceLine" id="cb1018-22" title="22">R <span class="op">=</span> <span class="fl">8.314</span> <span class="co"># 8.314 J/k mol</span></a>
<a class="sourceLine" id="cb1018-23" title="23">T1 <span class="op">=</span> <span class="dv">300</span>     <span class="co"># in K </span></a>
<a class="sourceLine" id="cb1018-24" title="24">T2 <span class="op">=</span> <span class="dv">350</span> </a>
<a class="sourceLine" id="cb1018-25" title="25"></a>
<a class="sourceLine" id="cb1018-26" title="26">P2_codex <span class="op">=</span> claussius(hvap, T1, P1, T2)</a>
<a class="sourceLine" id="cb1018-27" title="27">P2 <span class="op">=</span> P1<span class="op">*</span>np.exp(<span class="op">-</span>hvap<span class="op">/</span>R<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>T2<span class="dv">-1</span><span class="op">/</span>T1))</a>
<a class="sourceLine" id="cb1018-28" title="28"></a>
<a class="sourceLine" id="cb1018-29" title="29"><span class="co"># check </span></a>
<a class="sourceLine" id="cb1018-30" title="30"><span class="cf">if</span> np.isclose(P2, P2_codex, rtol<span class="op">=</span><span class="fl">0.01</span>) <span class="op">==</span> <span class="va">True</span>:</a>
<a class="sourceLine" id="cb1018-31" title="31">    result <span class="op">=</span> <span class="va">True</span> </a>
<a class="sourceLine" id="cb1018-32" title="32"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb1018-33" title="33">    result <span class="op">=</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-92">Run 3</h4>
<div class="sourceCode" id="cb1020"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1020-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb1020-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb1020-3" title="3"></a>
<a class="sourceLine" id="cb1020-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1020-5" title="5"><span class="co">compute sin(pi/2)</span></a>
<a class="sourceLine" id="cb1020-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1020-7" title="7">x <span class="op">=</span> math.sin(math.pi <span class="op">/</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1020-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1020-9" title="9"></a>
<a class="sourceLine" id="cb1020-10" title="10"><span class="kw">def</span> claussius(HVap, T1, P1, T2):</a>
<a class="sourceLine" id="cb1020-11" title="11">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1020-12" title="12"><span class="co">   This function returns the phase transition pressure at temperature T2 given a heat of vaporization HVap, and and reference temperature and pressure T1 and P1</span></a>
<a class="sourceLine" id="cb1020-13" title="13"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1020-14" title="14">   <span class="cf">return</span> P1 <span class="op">*</span> math.exp(HVap <span class="op">*</span> (<span class="dv">1</span> <span class="op">/</span> T1 <span class="op">-</span> <span class="dv">1</span> <span class="op">/</span> T2) <span class="op">/</span> <span class="fl">8.314</span>)</a>
<a class="sourceLine" id="cb1020-15" title="15"></a>
<a class="sourceLine" id="cb1020-16" title="16"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1020-17" title="17"></a>
<a class="sourceLine" id="cb1020-18" title="18"><span class="co"># input</span></a>
<a class="sourceLine" id="cb1020-19" title="19">hvap <span class="op">=</span> <span class="dv">5000</span> <span class="co">#J/mol</span></a>
<a class="sourceLine" id="cb1020-20" title="20">P1 <span class="op">=</span> <span class="dv">1</span> <span class="co"># atm</span></a>
<a class="sourceLine" id="cb1020-21" title="21">R <span class="op">=</span> <span class="fl">8.314</span> <span class="co"># 8.314 J/k mol</span></a>
<a class="sourceLine" id="cb1020-22" title="22">T1 <span class="op">=</span> <span class="dv">300</span>     <span class="co"># in K </span></a>
<a class="sourceLine" id="cb1020-23" title="23">T2 <span class="op">=</span> <span class="dv">350</span> </a>
<a class="sourceLine" id="cb1020-24" title="24"></a>
<a class="sourceLine" id="cb1020-25" title="25">P2_codex <span class="op">=</span> claussius(hvap, T1, P1, T2)</a>
<a class="sourceLine" id="cb1020-26" title="26">P2 <span class="op">=</span> P1<span class="op">*</span>np.exp(<span class="op">-</span>hvap<span class="op">/</span>R<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>T2<span class="dv">-1</span><span class="op">/</span>T1))</a>
<a class="sourceLine" id="cb1020-27" title="27"></a>
<a class="sourceLine" id="cb1020-28" title="28"><span class="co"># check </span></a>
<a class="sourceLine" id="cb1020-29" title="29"><span class="cf">if</span> np.isclose(P2, P2_codex, rtol<span class="op">=</span><span class="fl">0.01</span>) <span class="op">==</span> <span class="va">True</span>:</a>
<a class="sourceLine" id="cb1020-30" title="30">    result <span class="op">=</span> <span class="va">True</span> </a>
<a class="sourceLine" id="cb1020-31" title="31"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb1020-32" title="32">    result <span class="op">=</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-92">Run 4</h4>
<div class="sourceCode" id="cb1022"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1022-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb1022-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb1022-3" title="3"></a>
<a class="sourceLine" id="cb1022-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1022-5" title="5"><span class="co">compute sin(pi/2)</span></a>
<a class="sourceLine" id="cb1022-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1022-7" title="7">x <span class="op">=</span> math.sin(math.pi <span class="op">/</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1022-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1022-9" title="9"></a>
<a class="sourceLine" id="cb1022-10" title="10"><span class="kw">def</span> claussius(HVap, T1, P1, T2):</a>
<a class="sourceLine" id="cb1022-11" title="11">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1022-12" title="12"><span class="co">   This function returns the phase transition pressure at temperature T2 given a heat of vaporization HVap, and and reference temperature and pressure T1 and P1</span></a>
<a class="sourceLine" id="cb1022-13" title="13"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1022-14" title="14">   <span class="cf">return</span> P1 <span class="op">*</span> math.exp((HVap <span class="op">/</span> <span class="fl">8.314</span>) <span class="op">*</span> (<span class="dv">1</span> <span class="op">/</span> T1 <span class="op">-</span> <span class="dv">1</span> <span class="op">/</span> T2))</a>
<a class="sourceLine" id="cb1022-15" title="15"></a>
<a class="sourceLine" id="cb1022-16" title="16"></a>
<a class="sourceLine" id="cb1022-17" title="17"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1022-18" title="18"></a>
<a class="sourceLine" id="cb1022-19" title="19"><span class="co"># input</span></a>
<a class="sourceLine" id="cb1022-20" title="20">hvap <span class="op">=</span> <span class="dv">5000</span> <span class="co">#J/mol</span></a>
<a class="sourceLine" id="cb1022-21" title="21">P1 <span class="op">=</span> <span class="dv">1</span> <span class="co"># atm</span></a>
<a class="sourceLine" id="cb1022-22" title="22">R <span class="op">=</span> <span class="fl">8.314</span> <span class="co"># 8.314 J/k mol</span></a>
<a class="sourceLine" id="cb1022-23" title="23">T1 <span class="op">=</span> <span class="dv">300</span>     <span class="co"># in K </span></a>
<a class="sourceLine" id="cb1022-24" title="24">T2 <span class="op">=</span> <span class="dv">350</span> </a>
<a class="sourceLine" id="cb1022-25" title="25"></a>
<a class="sourceLine" id="cb1022-26" title="26">P2_codex <span class="op">=</span> claussius(hvap, T1, P1, T2)</a>
<a class="sourceLine" id="cb1022-27" title="27">P2 <span class="op">=</span> P1<span class="op">*</span>np.exp(<span class="op">-</span>hvap<span class="op">/</span>R<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>T2<span class="dv">-1</span><span class="op">/</span>T1))</a>
<a class="sourceLine" id="cb1022-28" title="28"></a>
<a class="sourceLine" id="cb1022-29" title="29"><span class="co"># check </span></a>
<a class="sourceLine" id="cb1022-30" title="30"><span class="cf">if</span> np.isclose(P2, P2_codex, rtol<span class="op">=</span><span class="fl">0.01</span>) <span class="op">==</span> <span class="va">True</span>:</a>
<a class="sourceLine" id="cb1022-31" title="31">    result <span class="op">=</span> <span class="va">True</span> </a>
<a class="sourceLine" id="cb1022-32" title="32"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb1022-33" title="33">    result <span class="op">=</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>compare_electronegativity</summary></p>
<h4 id="query-93">Query</h4>
<div class="sourceCode" id="cb1024"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1024-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb1024-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb1024-3" title="3"></a>
<a class="sourceLine" id="cb1024-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1024-5" title="5"><span class="co">compute sin(pi/2)</span></a>
<a class="sourceLine" id="cb1024-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1024-7" title="7">x <span class="op">=</span> math.sin(math.pi <span class="op">/</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1024-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1024-9" title="9"></a>
<a class="sourceLine" id="cb1024-10" title="10"><span class="kw">def</span> compare_electronegativity(element1,element2):</a>
<a class="sourceLine" id="cb1024-11" title="11">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1024-12" title="12"><span class="co">   This function returns True if element1 has a larger Pauling electronegativity than element2</span></a>
<a class="sourceLine" id="cb1024-13" title="13"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1024-14" title="14">   <span class="im">import</span> mendeleev</a>
<a class="sourceLine" id="cb1024-15" title="15">   </a></code></pre></div>
<h4 id="run-0-93">Run 0</h4>
<div class="sourceCode" id="cb1025"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1025-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb1025-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb1025-3" title="3"></a>
<a class="sourceLine" id="cb1025-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1025-5" title="5"><span class="co">compute sin(pi/2)</span></a>
<a class="sourceLine" id="cb1025-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1025-7" title="7">x <span class="op">=</span> math.sin(math.pi <span class="op">/</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1025-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1025-9" title="9"></a>
<a class="sourceLine" id="cb1025-10" title="10"><span class="kw">def</span> compare_electronegativity(element1,element2):</a>
<a class="sourceLine" id="cb1025-11" title="11">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1025-12" title="12"><span class="co">   This function returns True if element1 has a larger Pauling electronegativity than element2</span></a>
<a class="sourceLine" id="cb1025-13" title="13"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1025-14" title="14">   <span class="im">import</span> mendeleev</a>
<a class="sourceLine" id="cb1025-15" title="15">   <span class="cf">if</span> mendeleev.element(element1).pauling_en <span class="op">&gt;</span> mendeleev.element(element2).pauling_en:</a>
<a class="sourceLine" id="cb1025-16" title="16">      <span class="cf">return</span> <span class="va">True</span></a>
<a class="sourceLine" id="cb1025-17" title="17">   <span class="cf">else</span>:</a>
<a class="sourceLine" id="cb1025-18" title="18">      <span class="cf">return</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb1025-19" title="19"></a>
<a class="sourceLine" id="cb1025-20" title="20">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> compare_electronegativity(<span class="st">&quot;O&quot;</span>,<span class="st">&quot;C&quot;</span>) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>&#39;Element&#39; object has no attribute &#39;pauling_en&#39;</code></pre>
<h4 id="run-1-93">Run 1</h4>
<div class="sourceCode" id="cb1027"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1027-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb1027-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb1027-3" title="3"></a>
<a class="sourceLine" id="cb1027-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1027-5" title="5"><span class="co">compute sin(pi/2)</span></a>
<a class="sourceLine" id="cb1027-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1027-7" title="7">x <span class="op">=</span> math.sin(math.pi <span class="op">/</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1027-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1027-9" title="9"></a>
<a class="sourceLine" id="cb1027-10" title="10"><span class="kw">def</span> compare_electronegativity(element1,element2):</a>
<a class="sourceLine" id="cb1027-11" title="11">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1027-12" title="12"><span class="co">   This function returns True if element1 has a larger Pauling electronegativity than element2</span></a>
<a class="sourceLine" id="cb1027-13" title="13"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1027-14" title="14">   <span class="im">import</span> mendeleev</a>
<a class="sourceLine" id="cb1027-15" title="15">   <span class="cf">if</span> mendeleev.element(element1).pauling_electronegativity <span class="op">&gt;</span> mendeleev.element(element2).pauling_electronegativity:</a>
<a class="sourceLine" id="cb1027-16" title="16">      <span class="cf">return</span> <span class="va">True</span></a>
<a class="sourceLine" id="cb1027-17" title="17">   <span class="cf">else</span>:</a>
<a class="sourceLine" id="cb1027-18" title="18">      <span class="cf">return</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb1027-19" title="19"></a>
<a class="sourceLine" id="cb1027-20" title="20">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> compare_electronegativity(<span class="st">&quot;O&quot;</span>,<span class="st">&quot;C&quot;</span>) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>&#39;Element&#39; object has no attribute &#39;pauling_electronegativity&#39;</code></pre>
<h4 id="run-2-93">Run 2</h4>
<div class="sourceCode" id="cb1029"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1029-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb1029-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb1029-3" title="3"></a>
<a class="sourceLine" id="cb1029-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1029-5" title="5"><span class="co">compute sin(pi/2)</span></a>
<a class="sourceLine" id="cb1029-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1029-7" title="7">x <span class="op">=</span> math.sin(math.pi <span class="op">/</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1029-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1029-9" title="9"></a>
<a class="sourceLine" id="cb1029-10" title="10"><span class="kw">def</span> compare_electronegativity(element1,element2):</a>
<a class="sourceLine" id="cb1029-11" title="11">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1029-12" title="12"><span class="co">   This function returns True if element1 has a larger Pauling electronegativity than element2</span></a>
<a class="sourceLine" id="cb1029-13" title="13"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1029-14" title="14">   <span class="im">import</span> mendeleev</a>
<a class="sourceLine" id="cb1029-15" title="15">   e1 <span class="op">=</span> mendeleev.element(element1)</a>
<a class="sourceLine" id="cb1029-16" title="16">   e2 <span class="op">=</span> mendeleev.element(element2)</a>
<a class="sourceLine" id="cb1029-17" title="17">   <span class="cf">return</span> e1.electronegativity <span class="op">&gt;</span> e2.electronegativity</a>
<a class="sourceLine" id="cb1029-18" title="18"></a>
<a class="sourceLine" id="cb1029-19" title="19">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> compare_electronegativity(<span class="st">&quot;O&quot;</span>,<span class="st">&quot;C&quot;</span>) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>&#39;&gt;&#39; not supported between instances of &#39;method&#39; and &#39;method&#39;</code></pre>
<h4 id="run-3-93">Run 3</h4>
<div class="sourceCode" id="cb1031"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1031-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb1031-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb1031-3" title="3"></a>
<a class="sourceLine" id="cb1031-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1031-5" title="5"><span class="co">compute sin(pi/2)</span></a>
<a class="sourceLine" id="cb1031-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1031-7" title="7">x <span class="op">=</span> math.sin(math.pi <span class="op">/</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1031-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1031-9" title="9"></a>
<a class="sourceLine" id="cb1031-10" title="10"><span class="kw">def</span> compare_electronegativity(element1,element2):</a>
<a class="sourceLine" id="cb1031-11" title="11">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1031-12" title="12"><span class="co">   This function returns True if element1 has a larger Pauling electronegativity than element2</span></a>
<a class="sourceLine" id="cb1031-13" title="13"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1031-14" title="14">   <span class="im">import</span> mendeleev</a>
<a class="sourceLine" id="cb1031-15" title="15">   </a>
<a class="sourceLine" id="cb1031-16" title="16">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> compare_electronegativity(<span class="st">&quot;O&quot;</span>,<span class="st">&quot;C&quot;</span>) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-93">Run 4</h4>
<div class="sourceCode" id="cb1033"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1033-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb1033-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb1033-3" title="3"></a>
<a class="sourceLine" id="cb1033-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1033-5" title="5"><span class="co">compute sin(pi/2)</span></a>
<a class="sourceLine" id="cb1033-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1033-7" title="7">x <span class="op">=</span> math.sin(math.pi <span class="op">/</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1033-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1033-9" title="9"></a>
<a class="sourceLine" id="cb1033-10" title="10"><span class="kw">def</span> compare_electronegativity(element1,element2):</a>
<a class="sourceLine" id="cb1033-11" title="11">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1033-12" title="12"><span class="co">   This function returns True if element1 has a larger Pauling electronegativity than element2</span></a>
<a class="sourceLine" id="cb1033-13" title="13"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1033-14" title="14">   <span class="im">import</span> mendeleev</a>
<a class="sourceLine" id="cb1033-15" title="15">   </a>
<a class="sourceLine" id="cb1033-16" title="16">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> compare_electronegativity(<span class="st">&quot;O&quot;</span>,<span class="st">&quot;C&quot;</span>) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>condiff_1d</summary></p>
<h4 id="query-94">Query</h4>
<div class="sourceCode" id="cb1035"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1035-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1035-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1035-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1035-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1035-5" title="5"></a>
<a class="sourceLine" id="cb1035-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1035-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1035-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1035-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1035-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1035-11" title="11"></a>
<a class="sourceLine" id="cb1035-12" title="12"><span class="kw">def</span> condiff_1d(x):</a>
<a class="sourceLine" id="cb1035-13" title="13">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1035-14" title="14"><span class="co">  This function computes the difference between consecutive elements in array x.</span></a>
<a class="sourceLine" id="cb1035-15" title="15"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1035-16" title="16">  </a></code></pre></div>
<h4 id="run-0-94">Run 0</h4>
<div class="sourceCode" id="cb1036"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1036-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1036-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1036-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1036-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1036-5" title="5"></a>
<a class="sourceLine" id="cb1036-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1036-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1036-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1036-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1036-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1036-11" title="11"></a>
<a class="sourceLine" id="cb1036-12" title="12"><span class="kw">def</span> condiff_1d(x):</a>
<a class="sourceLine" id="cb1036-13" title="13">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1036-14" title="14"><span class="co">  This function computes the difference between consecutive elements in array x.</span></a>
<a class="sourceLine" id="cb1036-15" title="15"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1036-16" title="16">  <span class="cf">return</span> x[<span class="dv">1</span>:] <span class="op">-</span> x[:<span class="op">-</span><span class="dv">1</span>]</a>
<a class="sourceLine" id="cb1036-17" title="17"></a>
<a class="sourceLine" id="cb1036-18" title="18"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1036-19" title="19"></a>
<a class="sourceLine" id="cb1036-20" title="20">x <span class="op">=</span> np.array([<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">7</span>, <span class="dv">0</span>])</a>
<a class="sourceLine" id="cb1036-21" title="21"></a>
<a class="sourceLine" id="cb1036-22" title="22">true_y <span class="op">=</span> np.ediff1d(x)</a>
<a class="sourceLine" id="cb1036-23" title="23"></a>
<a class="sourceLine" id="cb1036-24" title="24">pred_y <span class="op">=</span> condiff_1d(x)</a>
<a class="sourceLine" id="cb1036-25" title="25"></a>
<a class="sourceLine" id="cb1036-26" title="26">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.allclose(true_y,pred_y) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-94">Run 1</h4>
<div class="sourceCode" id="cb1038"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1038-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1038-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1038-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1038-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1038-5" title="5"></a>
<a class="sourceLine" id="cb1038-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1038-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1038-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1038-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1038-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1038-11" title="11"></a>
<a class="sourceLine" id="cb1038-12" title="12"><span class="kw">def</span> condiff_1d(x):</a>
<a class="sourceLine" id="cb1038-13" title="13">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1038-14" title="14"><span class="co">  This function computes the difference between consecutive elements in array x.</span></a>
<a class="sourceLine" id="cb1038-15" title="15"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1038-16" title="16">  <span class="cf">return</span> np.diff(x)</a>
<a class="sourceLine" id="cb1038-17" title="17"></a>
<a class="sourceLine" id="cb1038-18" title="18"></a>
<a class="sourceLine" id="cb1038-19" title="19"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1038-20" title="20"></a>
<a class="sourceLine" id="cb1038-21" title="21">x <span class="op">=</span> np.array([<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">7</span>, <span class="dv">0</span>])</a>
<a class="sourceLine" id="cb1038-22" title="22"></a>
<a class="sourceLine" id="cb1038-23" title="23">true_y <span class="op">=</span> np.ediff1d(x)</a>
<a class="sourceLine" id="cb1038-24" title="24"></a>
<a class="sourceLine" id="cb1038-25" title="25">pred_y <span class="op">=</span> condiff_1d(x)</a>
<a class="sourceLine" id="cb1038-26" title="26"></a>
<a class="sourceLine" id="cb1038-27" title="27">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.allclose(true_y,pred_y) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-94">Run 2</h4>
<div class="sourceCode" id="cb1040"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1040-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1040-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1040-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1040-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1040-5" title="5"></a>
<a class="sourceLine" id="cb1040-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1040-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1040-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1040-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1040-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1040-11" title="11"></a>
<a class="sourceLine" id="cb1040-12" title="12"><span class="kw">def</span> condiff_1d(x):</a>
<a class="sourceLine" id="cb1040-13" title="13">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1040-14" title="14"><span class="co">  This function computes the difference between consecutive elements in array x.</span></a>
<a class="sourceLine" id="cb1040-15" title="15"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1040-16" title="16">  <span class="cf">return</span> np.diff(x)</a>
<a class="sourceLine" id="cb1040-17" title="17"></a>
<a class="sourceLine" id="cb1040-18" title="18"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1040-19" title="19"></a>
<a class="sourceLine" id="cb1040-20" title="20">x <span class="op">=</span> np.array([<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">7</span>, <span class="dv">0</span>])</a>
<a class="sourceLine" id="cb1040-21" title="21"></a>
<a class="sourceLine" id="cb1040-22" title="22">true_y <span class="op">=</span> np.ediff1d(x)</a>
<a class="sourceLine" id="cb1040-23" title="23"></a>
<a class="sourceLine" id="cb1040-24" title="24">pred_y <span class="op">=</span> condiff_1d(x)</a>
<a class="sourceLine" id="cb1040-25" title="25"></a>
<a class="sourceLine" id="cb1040-26" title="26">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.allclose(true_y,pred_y) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-94">Run 3</h4>
<div class="sourceCode" id="cb1042"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1042-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1042-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1042-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1042-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1042-5" title="5"></a>
<a class="sourceLine" id="cb1042-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1042-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1042-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1042-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1042-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1042-11" title="11"></a>
<a class="sourceLine" id="cb1042-12" title="12"><span class="kw">def</span> condiff_1d(x):</a>
<a class="sourceLine" id="cb1042-13" title="13">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1042-14" title="14"><span class="co">  This function computes the difference between consecutive elements in array x.</span></a>
<a class="sourceLine" id="cb1042-15" title="15"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1042-16" title="16">  <span class="cf">return</span> x[<span class="dv">1</span>:] <span class="op">-</span> x[:<span class="op">-</span><span class="dv">1</span>]</a>
<a class="sourceLine" id="cb1042-17" title="17"></a>
<a class="sourceLine" id="cb1042-18" title="18"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1042-19" title="19"></a>
<a class="sourceLine" id="cb1042-20" title="20">x <span class="op">=</span> np.array([<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">7</span>, <span class="dv">0</span>])</a>
<a class="sourceLine" id="cb1042-21" title="21"></a>
<a class="sourceLine" id="cb1042-22" title="22">true_y <span class="op">=</span> np.ediff1d(x)</a>
<a class="sourceLine" id="cb1042-23" title="23"></a>
<a class="sourceLine" id="cb1042-24" title="24">pred_y <span class="op">=</span> condiff_1d(x)</a>
<a class="sourceLine" id="cb1042-25" title="25"></a>
<a class="sourceLine" id="cb1042-26" title="26">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.allclose(true_y,pred_y) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-94">Run 4</h4>
<div class="sourceCode" id="cb1044"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1044-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1044-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1044-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1044-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1044-5" title="5"></a>
<a class="sourceLine" id="cb1044-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1044-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1044-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1044-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1044-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1044-11" title="11"></a>
<a class="sourceLine" id="cb1044-12" title="12"><span class="kw">def</span> condiff_1d(x):</a>
<a class="sourceLine" id="cb1044-13" title="13">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1044-14" title="14"><span class="co">  This function computes the difference between consecutive elements in array x.</span></a>
<a class="sourceLine" id="cb1044-15" title="15"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1044-16" title="16">  <span class="cf">return</span> x[<span class="dv">1</span>:] <span class="op">-</span> x[:<span class="op">-</span><span class="dv">1</span>]</a>
<a class="sourceLine" id="cb1044-17" title="17"></a>
<a class="sourceLine" id="cb1044-18" title="18"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1044-19" title="19"></a>
<a class="sourceLine" id="cb1044-20" title="20">x <span class="op">=</span> np.array([<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">7</span>, <span class="dv">0</span>])</a>
<a class="sourceLine" id="cb1044-21" title="21"></a>
<a class="sourceLine" id="cb1044-22" title="22">true_y <span class="op">=</span> np.ediff1d(x)</a>
<a class="sourceLine" id="cb1044-23" title="23"></a>
<a class="sourceLine" id="cb1044-24" title="24">pred_y <span class="op">=</span> condiff_1d(x)</a>
<a class="sourceLine" id="cb1044-25" title="25"></a>
<a class="sourceLine" id="cb1044-26" title="26">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.allclose(true_y,pred_y) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>cubes</summary></p>
<h4 id="query-95">Query</h4>
<div class="sourceCode" id="cb1046"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1046-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb1046-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb1046-3" title="3"></a>
<a class="sourceLine" id="cb1046-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1046-5" title="5"><span class="co">compute sin(pi/2)</span></a>
<a class="sourceLine" id="cb1046-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1046-7" title="7">x <span class="op">=</span> math.sin(math.pi <span class="op">/</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1046-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1046-9" title="9"></a>
<a class="sourceLine" id="cb1046-10" title="10"><span class="kw">def</span> sum_of_cubes(n):</a>
<a class="sourceLine" id="cb1046-11" title="11">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1046-12" title="12"><span class="co">  This function returns the sum of the first n cubes</span></a>
<a class="sourceLine" id="cb1046-13" title="13"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1046-14" title="14">  </a></code></pre></div>
<h4 id="run-0-95">Run 0</h4>
<div class="sourceCode" id="cb1047"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1047-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb1047-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb1047-3" title="3"></a>
<a class="sourceLine" id="cb1047-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1047-5" title="5"><span class="co">compute sin(pi/2)</span></a>
<a class="sourceLine" id="cb1047-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1047-7" title="7">x <span class="op">=</span> math.sin(math.pi <span class="op">/</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1047-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1047-9" title="9"></a>
<a class="sourceLine" id="cb1047-10" title="10"><span class="kw">def</span> sum_of_cubes(n):</a>
<a class="sourceLine" id="cb1047-11" title="11">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1047-12" title="12"><span class="co">  This function returns the sum of the first n cubes</span></a>
<a class="sourceLine" id="cb1047-13" title="13"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1047-14" title="14">  <span class="bu">sum</span> <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb1047-15" title="15">  <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n):</a>
<a class="sourceLine" id="cb1047-16" title="16">    <span class="bu">sum</span> <span class="op">+=</span> i<span class="op">**</span><span class="dv">3</span></a>
<a class="sourceLine" id="cb1047-17" title="17">  <span class="cf">return</span> <span class="bu">sum</span></a>
<a class="sourceLine" id="cb1047-18" title="18"></a>
<a class="sourceLine" id="cb1047-19" title="19">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> sum_of_cubes(<span class="dv">5</span>) <span class="op">==</span> <span class="dv">225</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-95">Run 1</h4>
<div class="sourceCode" id="cb1049"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1049-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb1049-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb1049-3" title="3"></a>
<a class="sourceLine" id="cb1049-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1049-5" title="5"><span class="co">compute sin(pi/2)</span></a>
<a class="sourceLine" id="cb1049-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1049-7" title="7">x <span class="op">=</span> math.sin(math.pi <span class="op">/</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1049-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1049-9" title="9"></a>
<a class="sourceLine" id="cb1049-10" title="10"><span class="kw">def</span> sum_of_cubes(n):</a>
<a class="sourceLine" id="cb1049-11" title="11">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1049-12" title="12"><span class="co">  This function returns the sum of the first n cubes</span></a>
<a class="sourceLine" id="cb1049-13" title="13"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1049-14" title="14">  <span class="bu">sum</span> <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb1049-15" title="15">  <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n):</a>
<a class="sourceLine" id="cb1049-16" title="16">    <span class="bu">sum</span> <span class="op">+=</span> i<span class="op">**</span><span class="dv">3</span></a>
<a class="sourceLine" id="cb1049-17" title="17">  </a>
<a class="sourceLine" id="cb1049-18" title="18">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> sum_of_cubes(<span class="dv">5</span>) <span class="op">==</span> <span class="dv">225</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-95">Run 2</h4>
<div class="sourceCode" id="cb1051"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1051-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb1051-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb1051-3" title="3"></a>
<a class="sourceLine" id="cb1051-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1051-5" title="5"><span class="co">compute sin(pi/2)</span></a>
<a class="sourceLine" id="cb1051-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1051-7" title="7">x <span class="op">=</span> math.sin(math.pi <span class="op">/</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1051-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1051-9" title="9"></a>
<a class="sourceLine" id="cb1051-10" title="10"><span class="kw">def</span> sum_of_cubes(n):</a>
<a class="sourceLine" id="cb1051-11" title="11">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1051-12" title="12"><span class="co">  This function returns the sum of the first n cubes</span></a>
<a class="sourceLine" id="cb1051-13" title="13"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1051-14" title="14">  <span class="bu">sum</span> <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb1051-15" title="15">  <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n):</a>
<a class="sourceLine" id="cb1051-16" title="16">    <span class="bu">sum</span> <span class="op">+=</span> (i <span class="op">+</span> <span class="dv">1</span>) <span class="op">**</span> <span class="dv">3</span></a>
<a class="sourceLine" id="cb1051-17" title="17">  <span class="cf">return</span> <span class="bu">sum</span></a>
<a class="sourceLine" id="cb1051-18" title="18"></a>
<a class="sourceLine" id="cb1051-19" title="19">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> sum_of_cubes(<span class="dv">5</span>) <span class="op">==</span> <span class="dv">225</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-95">Run 3</h4>
<div class="sourceCode" id="cb1053"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1053-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb1053-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb1053-3" title="3"></a>
<a class="sourceLine" id="cb1053-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1053-5" title="5"><span class="co">compute sin(pi/2)</span></a>
<a class="sourceLine" id="cb1053-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1053-7" title="7">x <span class="op">=</span> math.sin(math.pi <span class="op">/</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1053-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1053-9" title="9"></a>
<a class="sourceLine" id="cb1053-10" title="10"><span class="kw">def</span> sum_of_cubes(n):</a>
<a class="sourceLine" id="cb1053-11" title="11">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1053-12" title="12"><span class="co">  This function returns the sum of the first n cubes</span></a>
<a class="sourceLine" id="cb1053-13" title="13"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1053-14" title="14">  <span class="bu">sum</span> <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb1053-15" title="15">  <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, n <span class="op">+</span> <span class="dv">1</span>):</a>
<a class="sourceLine" id="cb1053-16" title="16">    <span class="bu">sum</span> <span class="op">+=</span> i <span class="op">**</span> <span class="dv">3</span></a>
<a class="sourceLine" id="cb1053-17" title="17">  <span class="cf">return</span> <span class="bu">sum</span></a>
<a class="sourceLine" id="cb1053-18" title="18"></a>
<a class="sourceLine" id="cb1053-19" title="19">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> sum_of_cubes(<span class="dv">5</span>) <span class="op">==</span> <span class="dv">225</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-95">Run 4</h4>
<div class="sourceCode" id="cb1055"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1055-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb1055-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb1055-3" title="3"></a>
<a class="sourceLine" id="cb1055-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1055-5" title="5"><span class="co">compute sin(pi/2)</span></a>
<a class="sourceLine" id="cb1055-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1055-7" title="7">x <span class="op">=</span> math.sin(math.pi <span class="op">/</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1055-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1055-9" title="9"></a>
<a class="sourceLine" id="cb1055-10" title="10"><span class="kw">def</span> sum_of_cubes(n):</a>
<a class="sourceLine" id="cb1055-11" title="11">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1055-12" title="12"><span class="co">  This function returns the sum of the first n cubes</span></a>
<a class="sourceLine" id="cb1055-13" title="13"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1055-14" title="14">  <span class="bu">sum</span> <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb1055-15" title="15">  <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n):</a>
<a class="sourceLine" id="cb1055-16" title="16">    <span class="bu">sum</span> <span class="op">+=</span> i<span class="op">**</span><span class="dv">3</span></a>
<a class="sourceLine" id="cb1055-17" title="17">  <span class="cf">return</span> <span class="bu">sum</span></a>
<a class="sourceLine" id="cb1055-18" title="18"></a>
<a class="sourceLine" id="cb1055-19" title="19">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> sum_of_cubes(<span class="dv">5</span>) <span class="op">==</span> <span class="dv">225</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>de_broglie</summary></p>
<h4 id="query-96">Query</h4>
<div class="sourceCode" id="cb1057"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1057-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb1057-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb1057-3" title="3"></a>
<a class="sourceLine" id="cb1057-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1057-5" title="5"><span class="co">compute sin(pi/2)</span></a>
<a class="sourceLine" id="cb1057-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1057-7" title="7">x <span class="op">=</span> math.sin(math.pi <span class="op">/</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1057-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1057-9" title="9"></a>
<a class="sourceLine" id="cb1057-10" title="10"><span class="kw">def</span> de_broglie(m,v):</a>
<a class="sourceLine" id="cb1057-11" title="11">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1057-12" title="12"><span class="co">   This function returns the de Broglie wavelength for a particle of mass m with speed v.</span></a>
<a class="sourceLine" id="cb1057-13" title="13"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1057-14" title="14">   </a></code></pre></div>
<h4 id="run-0-96">Run 0</h4>
<div class="sourceCode" id="cb1058"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1058-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb1058-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb1058-3" title="3"></a>
<a class="sourceLine" id="cb1058-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1058-5" title="5"><span class="co">compute sin(pi/2)</span></a>
<a class="sourceLine" id="cb1058-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1058-7" title="7">x <span class="op">=</span> math.sin(math.pi <span class="op">/</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1058-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1058-9" title="9"></a>
<a class="sourceLine" id="cb1058-10" title="10"><span class="kw">def</span> de_broglie(m,v):</a>
<a class="sourceLine" id="cb1058-11" title="11">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1058-12" title="12"><span class="co">   This function returns the de Broglie wavelength for a particle of mass m with speed v.</span></a>
<a class="sourceLine" id="cb1058-13" title="13"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1058-14" title="14">   h <span class="op">=</span> <span class="fl">6.6260755e-34</span> <span class="co"># Planck&#39;s constant in J s</span></a>
<a class="sourceLine" id="cb1058-15" title="15">   c <span class="op">=</span> <span class="fl">299792458.0</span>   <span class="co"># speed of light in m/s</span></a>
<a class="sourceLine" id="cb1058-16" title="16">   <span class="cf">return</span> h <span class="op">/</span> (m <span class="op">*</span> v)</a>
<a class="sourceLine" id="cb1058-17" title="17"></a>
<a class="sourceLine" id="cb1058-18" title="18"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1058-19" title="19"></a>
<a class="sourceLine" id="cb1058-20" title="20"><span class="co"># input params</span></a>
<a class="sourceLine" id="cb1058-21" title="21">h <span class="op">=</span> <span class="fl">6.626e-34</span> </a>
<a class="sourceLine" id="cb1058-22" title="22">v <span class="op">=</span> <span class="fl">1.00e6</span></a>
<a class="sourceLine" id="cb1058-23" title="23">m <span class="op">=</span> <span class="fl">9.11e-31</span></a>
<a class="sourceLine" id="cb1058-24" title="24"></a>
<a class="sourceLine" id="cb1058-25" title="25">lam  <span class="op">=</span> h<span class="op">/</span>(m<span class="op">*</span>v)</a>
<a class="sourceLine" id="cb1058-26" title="26"><span class="bu">print</span>(<span class="st">&quot;lam =&quot;</span>, lam)</a>
<a class="sourceLine" id="cb1058-27" title="27"></a>
<a class="sourceLine" id="cb1058-28" title="28">lam_codex <span class="op">=</span> de_broglie(m,v)</a>
<a class="sourceLine" id="cb1058-29" title="29"></a>
<a class="sourceLine" id="cb1058-30" title="30"><span class="co"># check </span></a>
<a class="sourceLine" id="cb1058-31" title="31"><span class="cf">if</span> np.isclose(lam, lam_codex) <span class="op">==</span>  <span class="va">True</span>:</a>
<a class="sourceLine" id="cb1058-32" title="32">    result <span class="op">=</span> <span class="va">True</span></a>
<a class="sourceLine" id="cb1058-33" title="33"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb1058-34" title="34">    result <span class="op">=</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb1058-35" title="35"></a>
<a class="sourceLine" id="cb1058-36" title="36"></a>
<a class="sourceLine" id="cb1058-37" title="37"></a>
<a class="sourceLine" id="cb1058-38" title="38"></a>
<a class="sourceLine" id="cb1058-39" title="39"></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-96">Run 1</h4>
<div class="sourceCode" id="cb1060"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1060-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb1060-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb1060-3" title="3"></a>
<a class="sourceLine" id="cb1060-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1060-5" title="5"><span class="co">compute sin(pi/2)</span></a>
<a class="sourceLine" id="cb1060-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1060-7" title="7">x <span class="op">=</span> math.sin(math.pi <span class="op">/</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1060-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1060-9" title="9"></a>
<a class="sourceLine" id="cb1060-10" title="10"><span class="kw">def</span> de_broglie(m,v):</a>
<a class="sourceLine" id="cb1060-11" title="11">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1060-12" title="12"><span class="co">   This function returns the de Broglie wavelength for a particle of mass m with speed v.</span></a>
<a class="sourceLine" id="cb1060-13" title="13"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1060-14" title="14">   h <span class="op">=</span> <span class="fl">6.626068e-34</span></a>
<a class="sourceLine" id="cb1060-15" title="15">   <span class="cf">return</span> h <span class="op">/</span> (m <span class="op">*</span> v)</a>
<a class="sourceLine" id="cb1060-16" title="16"></a>
<a class="sourceLine" id="cb1060-17" title="17"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1060-18" title="18"></a>
<a class="sourceLine" id="cb1060-19" title="19"><span class="co"># input params</span></a>
<a class="sourceLine" id="cb1060-20" title="20">h <span class="op">=</span> <span class="fl">6.626e-34</span> </a>
<a class="sourceLine" id="cb1060-21" title="21">v <span class="op">=</span> <span class="fl">1.00e6</span></a>
<a class="sourceLine" id="cb1060-22" title="22">m <span class="op">=</span> <span class="fl">9.11e-31</span></a>
<a class="sourceLine" id="cb1060-23" title="23"></a>
<a class="sourceLine" id="cb1060-24" title="24">lam  <span class="op">=</span> h<span class="op">/</span>(m<span class="op">*</span>v)</a>
<a class="sourceLine" id="cb1060-25" title="25"><span class="bu">print</span>(<span class="st">&quot;lam =&quot;</span>, lam)</a>
<a class="sourceLine" id="cb1060-26" title="26"></a>
<a class="sourceLine" id="cb1060-27" title="27">lam_codex <span class="op">=</span> de_broglie(m,v)</a>
<a class="sourceLine" id="cb1060-28" title="28"></a>
<a class="sourceLine" id="cb1060-29" title="29"><span class="co"># check </span></a>
<a class="sourceLine" id="cb1060-30" title="30"><span class="cf">if</span> np.isclose(lam, lam_codex) <span class="op">==</span>  <span class="va">True</span>:</a>
<a class="sourceLine" id="cb1060-31" title="31">    result <span class="op">=</span> <span class="va">True</span></a>
<a class="sourceLine" id="cb1060-32" title="32"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb1060-33" title="33">    result <span class="op">=</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb1060-34" title="34"></a>
<a class="sourceLine" id="cb1060-35" title="35"></a>
<a class="sourceLine" id="cb1060-36" title="36"></a>
<a class="sourceLine" id="cb1060-37" title="37"></a>
<a class="sourceLine" id="cb1060-38" title="38"></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-96">Run 2</h4>
<div class="sourceCode" id="cb1062"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1062-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb1062-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb1062-3" title="3"></a>
<a class="sourceLine" id="cb1062-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1062-5" title="5"><span class="co">compute sin(pi/2)</span></a>
<a class="sourceLine" id="cb1062-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1062-7" title="7">x <span class="op">=</span> math.sin(math.pi <span class="op">/</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1062-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1062-9" title="9"></a>
<a class="sourceLine" id="cb1062-10" title="10"><span class="kw">def</span> de_broglie(m,v):</a>
<a class="sourceLine" id="cb1062-11" title="11">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1062-12" title="12"><span class="co">   This function returns the de Broglie wavelength for a particle of mass m with speed v.</span></a>
<a class="sourceLine" id="cb1062-13" title="13"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1062-14" title="14">   h <span class="op">=</span> <span class="fl">6.62606896e-34</span></a>
<a class="sourceLine" id="cb1062-15" title="15">   c <span class="op">=</span> <span class="fl">2.99792458e8</span></a>
<a class="sourceLine" id="cb1062-16" title="16">   <span class="cf">return</span> h <span class="op">/</span> (m <span class="op">*</span> v <span class="op">*</span> c)</a>
<a class="sourceLine" id="cb1062-17" title="17"></a>
<a class="sourceLine" id="cb1062-18" title="18"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1062-19" title="19"></a>
<a class="sourceLine" id="cb1062-20" title="20"><span class="co"># input params</span></a>
<a class="sourceLine" id="cb1062-21" title="21">h <span class="op">=</span> <span class="fl">6.626e-34</span> </a>
<a class="sourceLine" id="cb1062-22" title="22">v <span class="op">=</span> <span class="fl">1.00e6</span></a>
<a class="sourceLine" id="cb1062-23" title="23">m <span class="op">=</span> <span class="fl">9.11e-31</span></a>
<a class="sourceLine" id="cb1062-24" title="24"></a>
<a class="sourceLine" id="cb1062-25" title="25">lam  <span class="op">=</span> h<span class="op">/</span>(m<span class="op">*</span>v)</a>
<a class="sourceLine" id="cb1062-26" title="26"><span class="bu">print</span>(<span class="st">&quot;lam =&quot;</span>, lam)</a>
<a class="sourceLine" id="cb1062-27" title="27"></a>
<a class="sourceLine" id="cb1062-28" title="28">lam_codex <span class="op">=</span> de_broglie(m,v)</a>
<a class="sourceLine" id="cb1062-29" title="29"></a>
<a class="sourceLine" id="cb1062-30" title="30"><span class="co"># check </span></a>
<a class="sourceLine" id="cb1062-31" title="31"><span class="cf">if</span> np.isclose(lam, lam_codex) <span class="op">==</span>  <span class="va">True</span>:</a>
<a class="sourceLine" id="cb1062-32" title="32">    result <span class="op">=</span> <span class="va">True</span></a>
<a class="sourceLine" id="cb1062-33" title="33"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb1062-34" title="34">    result <span class="op">=</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb1062-35" title="35"></a>
<a class="sourceLine" id="cb1062-36" title="36"></a>
<a class="sourceLine" id="cb1062-37" title="37"></a>
<a class="sourceLine" id="cb1062-38" title="38"></a>
<a class="sourceLine" id="cb1062-39" title="39"></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-96">Run 3</h4>
<div class="sourceCode" id="cb1064"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1064-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb1064-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb1064-3" title="3"></a>
<a class="sourceLine" id="cb1064-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1064-5" title="5"><span class="co">compute sin(pi/2)</span></a>
<a class="sourceLine" id="cb1064-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1064-7" title="7">x <span class="op">=</span> math.sin(math.pi <span class="op">/</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1064-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1064-9" title="9"></a>
<a class="sourceLine" id="cb1064-10" title="10"><span class="kw">def</span> de_broglie(m,v):</a>
<a class="sourceLine" id="cb1064-11" title="11">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1064-12" title="12"><span class="co">   This function returns the de Broglie wavelength for a particle of mass m with speed v.</span></a>
<a class="sourceLine" id="cb1064-13" title="13"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1064-14" title="14">   h <span class="op">=</span> <span class="fl">6.626068e-34</span></a>
<a class="sourceLine" id="cb1064-15" title="15">   c <span class="op">=</span> <span class="fl">299792458.0</span></a>
<a class="sourceLine" id="cb1064-16" title="16">   <span class="cf">return</span> h <span class="op">/</span> math.sqrt(m <span class="op">*</span> c <span class="op">*</span> c <span class="op">+</span> v <span class="op">*</span> v)</a>
<a class="sourceLine" id="cb1064-17" title="17"></a>
<a class="sourceLine" id="cb1064-18" title="18"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1064-19" title="19"></a>
<a class="sourceLine" id="cb1064-20" title="20"><span class="co"># input params</span></a>
<a class="sourceLine" id="cb1064-21" title="21">h <span class="op">=</span> <span class="fl">6.626e-34</span> </a>
<a class="sourceLine" id="cb1064-22" title="22">v <span class="op">=</span> <span class="fl">1.00e6</span></a>
<a class="sourceLine" id="cb1064-23" title="23">m <span class="op">=</span> <span class="fl">9.11e-31</span></a>
<a class="sourceLine" id="cb1064-24" title="24"></a>
<a class="sourceLine" id="cb1064-25" title="25">lam  <span class="op">=</span> h<span class="op">/</span>(m<span class="op">*</span>v)</a>
<a class="sourceLine" id="cb1064-26" title="26"><span class="bu">print</span>(<span class="st">&quot;lam =&quot;</span>, lam)</a>
<a class="sourceLine" id="cb1064-27" title="27"></a>
<a class="sourceLine" id="cb1064-28" title="28">lam_codex <span class="op">=</span> de_broglie(m,v)</a>
<a class="sourceLine" id="cb1064-29" title="29"></a>
<a class="sourceLine" id="cb1064-30" title="30"><span class="co"># check </span></a>
<a class="sourceLine" id="cb1064-31" title="31"><span class="cf">if</span> np.isclose(lam, lam_codex) <span class="op">==</span>  <span class="va">True</span>:</a>
<a class="sourceLine" id="cb1064-32" title="32">    result <span class="op">=</span> <span class="va">True</span></a>
<a class="sourceLine" id="cb1064-33" title="33"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb1064-34" title="34">    result <span class="op">=</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb1064-35" title="35"></a>
<a class="sourceLine" id="cb1064-36" title="36"></a>
<a class="sourceLine" id="cb1064-37" title="37"></a>
<a class="sourceLine" id="cb1064-38" title="38"></a>
<a class="sourceLine" id="cb1064-39" title="39"></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-96">Run 4</h4>
<div class="sourceCode" id="cb1066"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1066-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb1066-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb1066-3" title="3"></a>
<a class="sourceLine" id="cb1066-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1066-5" title="5"><span class="co">compute sin(pi/2)</span></a>
<a class="sourceLine" id="cb1066-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1066-7" title="7">x <span class="op">=</span> math.sin(math.pi <span class="op">/</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1066-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1066-9" title="9"></a>
<a class="sourceLine" id="cb1066-10" title="10"><span class="kw">def</span> de_broglie(m,v):</a>
<a class="sourceLine" id="cb1066-11" title="11">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1066-12" title="12"><span class="co">   This function returns the de Broglie wavelength for a particle of mass m with speed v.</span></a>
<a class="sourceLine" id="cb1066-13" title="13"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1066-14" title="14">   h <span class="op">=</span> <span class="fl">6.62606896e-34</span></a>
<a class="sourceLine" id="cb1066-15" title="15">   <span class="cf">return</span> h <span class="op">/</span> (m <span class="op">*</span> v)</a>
<a class="sourceLine" id="cb1066-16" title="16"></a>
<a class="sourceLine" id="cb1066-17" title="17"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1066-18" title="18"></a>
<a class="sourceLine" id="cb1066-19" title="19"><span class="co"># input params</span></a>
<a class="sourceLine" id="cb1066-20" title="20">h <span class="op">=</span> <span class="fl">6.626e-34</span> </a>
<a class="sourceLine" id="cb1066-21" title="21">v <span class="op">=</span> <span class="fl">1.00e6</span></a>
<a class="sourceLine" id="cb1066-22" title="22">m <span class="op">=</span> <span class="fl">9.11e-31</span></a>
<a class="sourceLine" id="cb1066-23" title="23"></a>
<a class="sourceLine" id="cb1066-24" title="24">lam  <span class="op">=</span> h<span class="op">/</span>(m<span class="op">*</span>v)</a>
<a class="sourceLine" id="cb1066-25" title="25"><span class="bu">print</span>(<span class="st">&quot;lam =&quot;</span>, lam)</a>
<a class="sourceLine" id="cb1066-26" title="26"></a>
<a class="sourceLine" id="cb1066-27" title="27">lam_codex <span class="op">=</span> de_broglie(m,v)</a>
<a class="sourceLine" id="cb1066-28" title="28"></a>
<a class="sourceLine" id="cb1066-29" title="29"><span class="co"># check </span></a>
<a class="sourceLine" id="cb1066-30" title="30"><span class="cf">if</span> np.isclose(lam, lam_codex) <span class="op">==</span>  <span class="va">True</span>:</a>
<a class="sourceLine" id="cb1066-31" title="31">    result <span class="op">=</span> <span class="va">True</span></a>
<a class="sourceLine" id="cb1066-32" title="32"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb1066-33" title="33">    result <span class="op">=</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb1066-34" title="34"></a>
<a class="sourceLine" id="cb1066-35" title="35"></a>
<a class="sourceLine" id="cb1066-36" title="36"></a>
<a class="sourceLine" id="cb1066-37" title="37"></a>
<a class="sourceLine" id="cb1066-38" title="38"></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>derivative1d-ch</summary></p>
<h4 id="query-97">Query</h4>
<div class="sourceCode" id="cb1068"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1068-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1068-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1068-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1068-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1068-5" title="5"></a>
<a class="sourceLine" id="cb1068-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1068-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1068-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1068-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1068-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1068-11" title="11"></a>
<a class="sourceLine" id="cb1068-12" title="12"><span class="kw">def</span> find_derivative(a,b,c,x):</a>
<a class="sourceLine" id="cb1068-13" title="13">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1068-14" title="14"><span class="co">  这个函数通过生成含有参数a，b，c的二阶多項式来计算x处的一阶导数。</span></a>
<a class="sourceLine" id="cb1068-15" title="15"></a>
<a class="sourceLine" id="cb1068-16" title="16"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1068-17" title="17">  </a></code></pre></div>
<h4 id="run-0-97">Run 0</h4>
<div class="sourceCode" id="cb1069"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1069-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1069-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1069-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1069-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1069-5" title="5"></a>
<a class="sourceLine" id="cb1069-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1069-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1069-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1069-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1069-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1069-11" title="11"></a>
<a class="sourceLine" id="cb1069-12" title="12"><span class="kw">def</span> find_derivative(a,b,c,x):</a>
<a class="sourceLine" id="cb1069-13" title="13">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1069-14" title="14"><span class="co">  这个函数通过生成含有参数a，b，c的二阶多項式来计算x处的一阶导数。</span></a>
<a class="sourceLine" id="cb1069-15" title="15"></a>
<a class="sourceLine" id="cb1069-16" title="16"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1069-17" title="17">  <span class="cf">return</span> <span class="dv">2</span><span class="op">*</span>a<span class="op">*</span>x <span class="op">+</span> b</a>
<a class="sourceLine" id="cb1069-18" title="18"></a>
<a class="sourceLine" id="cb1069-19" title="19"></a>
<a class="sourceLine" id="cb1069-20" title="20"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1069-21" title="21"></a>
<a class="sourceLine" id="cb1069-22" title="22">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> find_derivative(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">2</span>) <span class="op">==</span> <span class="dv">6</span> <span class="cf">else</span> <span class="va">False</span> </a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-97">Run 1</h4>
<div class="sourceCode" id="cb1071"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1071-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1071-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1071-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1071-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1071-5" title="5"></a>
<a class="sourceLine" id="cb1071-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1071-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1071-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1071-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1071-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1071-11" title="11"></a>
<a class="sourceLine" id="cb1071-12" title="12"><span class="kw">def</span> find_derivative(a,b,c,x):</a>
<a class="sourceLine" id="cb1071-13" title="13">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1071-14" title="14"><span class="co">  这个函数通过生成含有参数a，b，c的二阶多項式来计算x处的一阶导数。</span></a>
<a class="sourceLine" id="cb1071-15" title="15"></a>
<a class="sourceLine" id="cb1071-16" title="16"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1071-17" title="17">  y <span class="op">=</span> a<span class="op">*</span>x<span class="op">**</span><span class="dv">2</span> <span class="op">+</span> b<span class="op">*</span>x <span class="op">+</span> c</a>
<a class="sourceLine" id="cb1071-18" title="18">  dy <span class="op">=</span> <span class="dv">2</span><span class="op">*</span>a<span class="op">*</span>x <span class="op">+</span> b</a>
<a class="sourceLine" id="cb1071-19" title="19">  <span class="cf">return</span> dy</a>
<a class="sourceLine" id="cb1071-20" title="20"></a>
<a class="sourceLine" id="cb1071-21" title="21"></a>
<a class="sourceLine" id="cb1071-22" title="22"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1071-23" title="23"></a>
<a class="sourceLine" id="cb1071-24" title="24">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> find_derivative(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">2</span>) <span class="op">==</span> <span class="dv">6</span> <span class="cf">else</span> <span class="va">False</span> </a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-97">Run 2</h4>
<div class="sourceCode" id="cb1073"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1073-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1073-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1073-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1073-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1073-5" title="5"></a>
<a class="sourceLine" id="cb1073-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1073-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1073-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1073-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1073-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1073-11" title="11"></a>
<a class="sourceLine" id="cb1073-12" title="12"><span class="kw">def</span> find_derivative(a,b,c,x):</a>
<a class="sourceLine" id="cb1073-13" title="13">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1073-14" title="14"><span class="co">  这个函数通过生成含有参数a，b，c的二阶多項式来计算x处的一阶导数。</span></a>
<a class="sourceLine" id="cb1073-15" title="15"></a>
<a class="sourceLine" id="cb1073-16" title="16"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1073-17" title="17">  <span class="cf">return</span> <span class="dv">2</span><span class="op">*</span>a<span class="op">*</span>x <span class="op">+</span> b</a>
<a class="sourceLine" id="cb1073-18" title="18"></a>
<a class="sourceLine" id="cb1073-19" title="19"></a>
<a class="sourceLine" id="cb1073-20" title="20"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1073-21" title="21"></a>
<a class="sourceLine" id="cb1073-22" title="22">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> find_derivative(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">2</span>) <span class="op">==</span> <span class="dv">6</span> <span class="cf">else</span> <span class="va">False</span> </a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-97">Run 3</h4>
<div class="sourceCode" id="cb1075"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1075-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1075-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1075-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1075-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1075-5" title="5"></a>
<a class="sourceLine" id="cb1075-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1075-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1075-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1075-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1075-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1075-11" title="11"></a>
<a class="sourceLine" id="cb1075-12" title="12"><span class="kw">def</span> find_derivative(a,b,c,x):</a>
<a class="sourceLine" id="cb1075-13" title="13">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1075-14" title="14"><span class="co">  这个函数通过生成含有参数a，b，c的二阶多項式来计算x处的一阶导数。</span></a>
<a class="sourceLine" id="cb1075-15" title="15"></a>
<a class="sourceLine" id="cb1075-16" title="16"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1075-17" title="17">  <span class="cf">return</span> <span class="dv">2</span><span class="op">*</span>a<span class="op">*</span>x <span class="op">+</span> b</a>
<a class="sourceLine" id="cb1075-18" title="18"></a>
<a class="sourceLine" id="cb1075-19" title="19"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1075-20" title="20"><span class="co">Plot the function</span></a>
<a class="sourceLine" id="cb1075-21" title="21"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1075-22" title="22">x <span class="op">=</span> np.linspace(<span class="op">-</span><span class="dv">10</span>,<span class="dv">10</span>,<span class="dv">100</span>)</a>
<a class="sourceLine" id="cb1075-23" title="23">y <span class="op">=</span> find_derivative(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,x)</a>
<a class="sourceLine" id="cb1075-24" title="24">plt.plot(x,y)</a>
<a class="sourceLine" id="cb1075-25" title="25">plt.savefig(<span class="st">&#39;derivative.png&#39;</span>)</a>
<a class="sourceLine" id="cb1075-26" title="26"></a>
<a class="sourceLine" id="cb1075-27" title="27"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1075-28" title="28"></a>
<a class="sourceLine" id="cb1075-29" title="29">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> find_derivative(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">2</span>) <span class="op">==</span> <span class="dv">6</span> <span class="cf">else</span> <span class="va">False</span> </a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-97">Run 4</h4>
<div class="sourceCode" id="cb1077"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1077-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1077-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1077-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1077-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1077-5" title="5"></a>
<a class="sourceLine" id="cb1077-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1077-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1077-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1077-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1077-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1077-11" title="11"></a>
<a class="sourceLine" id="cb1077-12" title="12"><span class="kw">def</span> find_derivative(a,b,c,x):</a>
<a class="sourceLine" id="cb1077-13" title="13">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1077-14" title="14"><span class="co">  这个函数通过生成含有参数a，b，c的二阶多項式来计算x处的一阶导数。</span></a>
<a class="sourceLine" id="cb1077-15" title="15"></a>
<a class="sourceLine" id="cb1077-16" title="16"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1077-17" title="17">  <span class="cf">return</span> <span class="dv">2</span><span class="op">*</span>a<span class="op">*</span>x <span class="op">+</span> b</a>
<a class="sourceLine" id="cb1077-18" title="18"></a>
<a class="sourceLine" id="cb1077-19" title="19"></a>
<a class="sourceLine" id="cb1077-20" title="20"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1077-21" title="21"></a>
<a class="sourceLine" id="cb1077-22" title="22">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> find_derivative(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">2</span>) <span class="op">==</span> <span class="dv">6</span> <span class="cf">else</span> <span class="va">False</span> </a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>derivative_2deg</summary></p>
<h4 id="query-98">Query</h4>
<div class="sourceCode" id="cb1079"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1079-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1079-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1079-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1079-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1079-5" title="5"></a>
<a class="sourceLine" id="cb1079-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1079-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1079-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1079-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1079-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1079-11" title="11"></a>
<a class="sourceLine" id="cb1079-12" title="12"><span class="kw">def</span> find_derivative(a,b,c,x):</a>
<a class="sourceLine" id="cb1079-13" title="13">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1079-14" title="14"><span class="co">  This function generates a 2nd degree polynomial with coefficients a,b,c and return derivative at x</span></a>
<a class="sourceLine" id="cb1079-15" title="15"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1079-16" title="16">  </a></code></pre></div>
<h4 id="run-0-98">Run 0</h4>
<div class="sourceCode" id="cb1080"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1080-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1080-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1080-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1080-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1080-5" title="5"></a>
<a class="sourceLine" id="cb1080-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1080-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1080-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1080-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1080-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1080-11" title="11"></a>
<a class="sourceLine" id="cb1080-12" title="12"><span class="kw">def</span> find_derivative(a,b,c,x):</a>
<a class="sourceLine" id="cb1080-13" title="13">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1080-14" title="14"><span class="co">  This function generates a 2nd degree polynomial with coefficients a,b,c and return derivative at x</span></a>
<a class="sourceLine" id="cb1080-15" title="15"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1080-16" title="16">  <span class="cf">return</span> <span class="dv">2</span><span class="op">*</span>a<span class="op">*</span>x <span class="op">+</span> b</a>
<a class="sourceLine" id="cb1080-17" title="17"></a>
<a class="sourceLine" id="cb1080-18" title="18"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1080-19" title="19"></a>
<a class="sourceLine" id="cb1080-20" title="20">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> find_derivative(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">2</span>) <span class="op">==</span> <span class="dv">6</span> <span class="cf">else</span> <span class="va">False</span> </a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-98">Run 1</h4>
<div class="sourceCode" id="cb1082"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1082-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1082-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1082-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1082-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1082-5" title="5"></a>
<a class="sourceLine" id="cb1082-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1082-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1082-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1082-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1082-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1082-11" title="11"></a>
<a class="sourceLine" id="cb1082-12" title="12"><span class="kw">def</span> find_derivative(a,b,c,x):</a>
<a class="sourceLine" id="cb1082-13" title="13">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1082-14" title="14"><span class="co">  This function generates a 2nd degree polynomial with coefficients a,b,c and return derivative at x</span></a>
<a class="sourceLine" id="cb1082-15" title="15"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1082-16" title="16">  <span class="cf">return</span> <span class="dv">2</span><span class="op">*</span>a<span class="op">*</span>x <span class="op">+</span> b</a>
<a class="sourceLine" id="cb1082-17" title="17"></a>
<a class="sourceLine" id="cb1082-18" title="18"></a>
<a class="sourceLine" id="cb1082-19" title="19"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1082-20" title="20"></a>
<a class="sourceLine" id="cb1082-21" title="21">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> find_derivative(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">2</span>) <span class="op">==</span> <span class="dv">6</span> <span class="cf">else</span> <span class="va">False</span> </a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-98">Run 2</h4>
<div class="sourceCode" id="cb1084"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1084-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1084-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1084-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1084-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1084-5" title="5"></a>
<a class="sourceLine" id="cb1084-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1084-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1084-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1084-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1084-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1084-11" title="11"></a>
<a class="sourceLine" id="cb1084-12" title="12"><span class="kw">def</span> find_derivative(a,b,c,x):</a>
<a class="sourceLine" id="cb1084-13" title="13">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1084-14" title="14"><span class="co">  This function generates a 2nd degree polynomial with coefficients a,b,c and return derivative at x</span></a>
<a class="sourceLine" id="cb1084-15" title="15"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1084-16" title="16">  <span class="cf">return</span> <span class="dv">2</span><span class="op">*</span>a<span class="op">*</span>x <span class="op">+</span> b</a>
<a class="sourceLine" id="cb1084-17" title="17"></a>
<a class="sourceLine" id="cb1084-18" title="18"></a>
<a class="sourceLine" id="cb1084-19" title="19"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1084-20" title="20"></a>
<a class="sourceLine" id="cb1084-21" title="21">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> find_derivative(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">2</span>) <span class="op">==</span> <span class="dv">6</span> <span class="cf">else</span> <span class="va">False</span> </a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-98">Run 3</h4>
<div class="sourceCode" id="cb1086"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1086-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1086-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1086-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1086-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1086-5" title="5"></a>
<a class="sourceLine" id="cb1086-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1086-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1086-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1086-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1086-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1086-11" title="11"></a>
<a class="sourceLine" id="cb1086-12" title="12"><span class="kw">def</span> find_derivative(a,b,c,x):</a>
<a class="sourceLine" id="cb1086-13" title="13">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1086-14" title="14"><span class="co">  This function generates a 2nd degree polynomial with coefficients a,b,c and return derivative at x</span></a>
<a class="sourceLine" id="cb1086-15" title="15"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1086-16" title="16">  <span class="cf">return</span> <span class="dv">2</span><span class="op">*</span>a<span class="op">*</span>x <span class="op">+</span> b</a>
<a class="sourceLine" id="cb1086-17" title="17"></a>
<a class="sourceLine" id="cb1086-18" title="18"></a>
<a class="sourceLine" id="cb1086-19" title="19"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1086-20" title="20"></a>
<a class="sourceLine" id="cb1086-21" title="21">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> find_derivative(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">2</span>) <span class="op">==</span> <span class="dv">6</span> <span class="cf">else</span> <span class="va">False</span> </a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-98">Run 4</h4>
<div class="sourceCode" id="cb1088"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1088-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1088-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1088-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1088-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1088-5" title="5"></a>
<a class="sourceLine" id="cb1088-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1088-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1088-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1088-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1088-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1088-11" title="11"></a>
<a class="sourceLine" id="cb1088-12" title="12"><span class="kw">def</span> find_derivative(a,b,c,x):</a>
<a class="sourceLine" id="cb1088-13" title="13">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1088-14" title="14"><span class="co">  This function generates a 2nd degree polynomial with coefficients a,b,c and return derivative at x</span></a>
<a class="sourceLine" id="cb1088-15" title="15"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1088-16" title="16">  <span class="cf">return</span> <span class="dv">2</span><span class="op">*</span>a<span class="op">*</span>x <span class="op">+</span> b</a>
<a class="sourceLine" id="cb1088-17" title="17"></a>
<a class="sourceLine" id="cb1088-18" title="18"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1088-19" title="19"></a>
<a class="sourceLine" id="cb1088-20" title="20">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> find_derivative(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">2</span>) <span class="op">==</span> <span class="dv">6</span> <span class="cf">else</span> <span class="va">False</span> </a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>descriptors</summary></p>
<h4 id="query-99">Query</h4>
<div class="sourceCode" id="cb1090"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1090-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1090-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb1090-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb1090-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb1090-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb1090-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb1090-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb1090-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb1090-9" title="9"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb1090-10" title="10"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb1090-11" title="11"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1090-12" title="12"></a>
<a class="sourceLine" id="cb1090-13" title="13"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1090-14" title="14"><span class="co">print rdkit version</span></a>
<a class="sourceLine" id="cb1090-15" title="15"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1090-16" title="16"><span class="bu">print</span>(rdkit.__version__)</a>
<a class="sourceLine" id="cb1090-17" title="17"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1090-18" title="18"></a>
<a class="sourceLine" id="cb1090-19" title="19"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1090-20" title="20"></a>
<a class="sourceLine" id="cb1090-21" title="21"><span class="kw">def</span> get_descriptors(smiles_list):</a>
<a class="sourceLine" id="cb1090-22" title="22">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1090-23" title="23"><span class="co">    Returns an N x 8 matrix of descriptors for given SMILEs</span></a>
<a class="sourceLine" id="cb1090-24" title="24"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1090-25" title="25">    </a></code></pre></div>
<h4 id="run-0-99">Run 0</h4>
<div class="sourceCode" id="cb1091"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1091-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1091-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb1091-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb1091-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb1091-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb1091-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb1091-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb1091-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb1091-9" title="9"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb1091-10" title="10"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb1091-11" title="11"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1091-12" title="12"></a>
<a class="sourceLine" id="cb1091-13" title="13"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1091-14" title="14"><span class="co">print rdkit version</span></a>
<a class="sourceLine" id="cb1091-15" title="15"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1091-16" title="16"><span class="bu">print</span>(rdkit.__version__)</a>
<a class="sourceLine" id="cb1091-17" title="17"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1091-18" title="18"></a>
<a class="sourceLine" id="cb1091-19" title="19"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1091-20" title="20"></a>
<a class="sourceLine" id="cb1091-21" title="21"><span class="kw">def</span> get_descriptors(smiles_list):</a>
<a class="sourceLine" id="cb1091-22" title="22">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1091-23" title="23"><span class="co">    Returns an N x 8 matrix of descriptors for given SMILEs</span></a>
<a class="sourceLine" id="cb1091-24" title="24"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1091-25" title="25">    nms <span class="op">=</span> [x[<span class="dv">0</span>] <span class="cf">for</span> x <span class="kw">in</span> Descriptors._descList]</a>
<a class="sourceLine" id="cb1091-26" title="26">    calc <span class="op">=</span> MoleculeDescriptors.MolecularDescriptorCalculator(nms)</a>
<a class="sourceLine" id="cb1091-27" title="27">    descriptors <span class="op">=</span> []</a>
<a class="sourceLine" id="cb1091-28" title="28">    <span class="cf">for</span> smiles <span class="kw">in</span> smiles_list:</a>
<a class="sourceLine" id="cb1091-29" title="29">        mol <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb1091-30" title="30">        descriptors.append(calc.CalcDescriptors(mol))</a>
<a class="sourceLine" id="cb1091-31" title="31">    <span class="cf">return</span> np.array(descriptors)</a>
<a class="sourceLine" id="cb1091-32" title="32"></a>
<a class="sourceLine" id="cb1091-33" title="33"></a>
<a class="sourceLine" id="cb1091-34" title="34">s <span class="op">=</span> [<span class="st">&#39;CC=O&#39;</span>, <span class="st">&#39;CC=C=C(C(=O)N)&#39;</span>]</a>
<a class="sourceLine" id="cb1091-35" title="35">v <span class="op">=</span> get_descriptors(s)</a>
<a class="sourceLine" id="cb1091-36" title="36">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.shape(v) <span class="op">==</span> (<span class="dv">2</span>, <span class="dv">8</span>) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-99">Run 1</h4>
<div class="sourceCode" id="cb1093"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1093-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1093-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb1093-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb1093-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb1093-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb1093-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb1093-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb1093-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb1093-9" title="9"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb1093-10" title="10"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb1093-11" title="11"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1093-12" title="12"></a>
<a class="sourceLine" id="cb1093-13" title="13"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1093-14" title="14"><span class="co">print rdkit version</span></a>
<a class="sourceLine" id="cb1093-15" title="15"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1093-16" title="16"><span class="bu">print</span>(rdkit.__version__)</a>
<a class="sourceLine" id="cb1093-17" title="17"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1093-18" title="18"></a>
<a class="sourceLine" id="cb1093-19" title="19"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1093-20" title="20"></a>
<a class="sourceLine" id="cb1093-21" title="21"><span class="kw">def</span> get_descriptors(smiles_list):</a>
<a class="sourceLine" id="cb1093-22" title="22">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1093-23" title="23"><span class="co">    Returns an N x 8 matrix of descriptors for given SMILEs</span></a>
<a class="sourceLine" id="cb1093-24" title="24"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1093-25" title="25">    nms <span class="op">=</span> [x[<span class="dv">0</span>] <span class="cf">for</span> x <span class="kw">in</span> Descriptors._descList]</a>
<a class="sourceLine" id="cb1093-26" title="26">    calc <span class="op">=</span> MoleculeDescriptors.MolecularDescriptorCalculator(nms)</a>
<a class="sourceLine" id="cb1093-27" title="27">    desc_list <span class="op">=</span> []</a>
<a class="sourceLine" id="cb1093-28" title="28">    <span class="cf">for</span> smiles <span class="kw">in</span> smiles_list:</a>
<a class="sourceLine" id="cb1093-29" title="29">        m <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb1093-30" title="30">        desc_list.append(calc.CalcDescriptors(m))</a>
<a class="sourceLine" id="cb1093-31" title="31">    <span class="cf">return</span> np.array(desc_list)</a>
<a class="sourceLine" id="cb1093-32" title="32"></a>
<a class="sourceLine" id="cb1093-33" title="33"></a>
<a class="sourceLine" id="cb1093-34" title="34">s <span class="op">=</span> [<span class="st">&#39;CC=O&#39;</span>, <span class="st">&#39;CC=C=C(C(=O)N)&#39;</span>]</a>
<a class="sourceLine" id="cb1093-35" title="35">v <span class="op">=</span> get_descriptors(s)</a>
<a class="sourceLine" id="cb1093-36" title="36">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.shape(v) <span class="op">==</span> (<span class="dv">2</span>, <span class="dv">8</span>) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-99">Run 2</h4>
<div class="sourceCode" id="cb1095"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1095-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1095-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb1095-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb1095-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb1095-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb1095-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb1095-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb1095-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb1095-9" title="9"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb1095-10" title="10"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb1095-11" title="11"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1095-12" title="12"></a>
<a class="sourceLine" id="cb1095-13" title="13"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1095-14" title="14"><span class="co">print rdkit version</span></a>
<a class="sourceLine" id="cb1095-15" title="15"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1095-16" title="16"><span class="bu">print</span>(rdkit.__version__)</a>
<a class="sourceLine" id="cb1095-17" title="17"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1095-18" title="18"></a>
<a class="sourceLine" id="cb1095-19" title="19"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1095-20" title="20"></a>
<a class="sourceLine" id="cb1095-21" title="21"><span class="kw">def</span> get_descriptors(smiles_list):</a>
<a class="sourceLine" id="cb1095-22" title="22">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1095-23" title="23"><span class="co">    Returns an N x 8 matrix of descriptors for given SMILEs</span></a>
<a class="sourceLine" id="cb1095-24" title="24"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1095-25" title="25">    <span class="co"># Get the list of descriptors</span></a>
<a class="sourceLine" id="cb1095-26" title="26">    desc_list <span class="op">=</span> [x[<span class="dv">0</span>] <span class="cf">for</span> x <span class="kw">in</span> Descriptors._descList]</a>
<a class="sourceLine" id="cb1095-27" title="27">    <span class="co"># Remove the bad ones</span></a>
<a class="sourceLine" id="cb1095-28" title="28">    desc_list.remove(<span class="st">&#39;MolWt&#39;</span>)</a>
<a class="sourceLine" id="cb1095-29" title="29">    desc_list.remove(<span class="st">&#39;HeavyAtomMolWt&#39;</span>)</a>
<a class="sourceLine" id="cb1095-30" title="30">    desc_list.remove(<span class="st">&#39;ExactMolWt&#39;</span>)</a>
<a class="sourceLine" id="cb1095-31" title="31">    desc_list.remove(<span class="st">&#39;RingCount&#39;</span>)</a>
<a class="sourceLine" id="cb1095-32" title="32">    desc_list.remove(<span class="st">&#39;FractionCSP3&#39;</span>)</a>
<a class="sourceLine" id="cb1095-33" title="33">    desc_list.remove(<span class="st">&#39;LabuteASA&#39;</span>)</a>
<a class="sourceLine" id="cb1095-34" title="34">    desc_list.remove(<span class="st">&#39;TPSA&#39;</span>)</a>
<a class="sourceLine" id="cb1095-35" title="35">    desc_list.remove(<span class="st">&#39;BalabanJ&#39;</span>)</a>
<a class="sourceLine" id="cb1095-36" title="36">    desc_list.remove(<span class="st">&#39;BertzCT&#39;</span>)</a>
<a class="sourceLine" id="cb1095-37" title="37">    desc_list.remove(<span class="st">&#39;Ipc&#39;</span>)</a>
<a class="sourceLine" id="cb1095-38" title="38">    desc_list.remove(<span class="st">&#39;HallKierAlpha&#39;</span>)</a>
<a class="sourceLine" id="cb1095-39" title="39">    desc_list.remove(<span class="st">&#39;Kappa1&#39;</span>)</a>
<a class="sourceLine" id="cb1095-40" title="40">    desc_list.remove(<span class="st">&#39;Kappa2&#39;</span>)</a>
<a class="sourceLine" id="cb1095-41" title="41">    desc_list.remove(<span class="st">&#39;Kappa3&#39;</span>)</a>
<a class="sourceLine" id="cb1095-42" title="42">    desc_list.remove(<span class="st">&#39;Chi0&#39;</span>)</a>
<a class="sourceLine" id="cb1095-43" title="43">    desc_list.remove(<span class="st">&#39;Chi1&#39;</span>)</a>
<a class="sourceLine" id="cb1095-44" title="44">    desc_list.remove(<span class="st">&#39;Chi0n&#39;</span>)</a>
<a class="sourceLine" id="cb1095-45" title="45">    desc_list.remove(<span class="st">&#39;Chi1n&#39;</span>)</a>
<a class="sourceLine" id="cb1095-46" title="46">    desc_list.remove(<span class="st">&#39;Chi2n&#39;</span>)</a>
<a class="sourceLine" id="cb1095-47" title="47">    desc_list.remove(<span class="st">&#39;Chi3n&#39;</span>)</a>
<a class="sourceLine" id="cb1095-48" title="48">    desc_list.remove(<span class="st">&#39;Chi4n&#39;</span>)</a>
<a class="sourceLine" id="cb1095-49" title="49">    desc_list.remove(<span class="st">&#39;Chi0v&#39;</span>)</a>
<a class="sourceLine" id="cb1095-50" title="50">    desc_list.remove(<span class="st">&#39;Chi1v&#39;</span>)</a>
<a class="sourceLine" id="cb1095-51" title="51">    desc_list.remove(<span class="st">&#39;Chi2v&#39;</span>)</a>
<a class="sourceLine" id="cb1095-52" title="52">    desc_list.remove(<span class="st">&#39;Chi3v&#39;</span>)</a>
<a class="sourceLine" id="cb1095-53" title="53">    desc_list.remove(<span class="st">&#39;Chi4v&#39;</span>)</a>
<a class="sourceLine" id="cb1095-54" title="54">    desc_list.remove(<span class="st">&#39;MolLogP&#39;</span>)</a>
<a class="sourceLine" id="cb1095-55" title="55">    desc_list.remove(<span class="st">&#39;MolMR&#39;</span>)</a>
<a class="sourceLine" id="cb1095-56" title="56">    desc_list.remove(<span class="st">&#39;fr_Al_COO&#39;</span>)</a>
<a class="sourceLine" id="cb1095-57" title="57">    desc_list.remove(<span class="st">&#39;fr_Al_OH&#39;</span>)</a>
<a class="sourceLine" id="cb1095-58" title="58">    desc_list.remove(<span class="st">&#39;fr_Al_OH_noTert&#39;</span>)</a>
<a class="sourceLine" id="cb1095-59" title="59">    desc_list.remove(<span class="st">&#39;fr_ArN&#39;</span>)</a>
<a class="sourceLine" id="cb1095-60" title="60">    desc_list.remove(<span class="st">&#39;fr_Ar_COO&#39;</span>)</a>
<a class="sourceLine" id="cb1095-61" title="61">    desc_list.remove(<span class="st">&#39;fr_Ar_N&#39;</span>)</a>
<a class="sourceLine" id="cb1095-62" title="62">    desc_list.remove(<span class="st">&#39;fr_Ar_NH&#39;</span>)</a>
<a class="sourceLine" id="cb1095-63" title="63">    desc_list.remove(<span class="st">&#39;fr_Ar_OH&#39;</span>)</a>
<a class="sourceLine" id="cb1095-64" title="64">    desc_list.remove(<span class="st">&#39;fr_COO&#39;</span>)</a>
<a class="sourceLine" id="cb1095-65" title="65">    desc_list.remove(<span class="st">&#39;fr_COO2&#39;</span>)</a>
<a class="sourceLine" id="cb1095-66" title="66">    desc_list.remove(<span class="st">&#39;fr_C_O&#39;</span>)</a>
<a class="sourceLine" id="cb1095-67" title="67">    desc_list.remove(<span class="st">&#39;fr_C_O_noCOO&#39;</span>)</a>
<a class="sourceLine" id="cb1095-68" title="68">    desc_list.remove(<span class="st">&#39;fr_C_S&#39;</span>)</a>
<a class="sourceLine" id="cb1095-69" title="69">    desc_list.remove(<span class="st">&#39;fr_HOCCN&#39;</span>)</a>
<a class="sourceLine" id="cb1095-70" title="70">    desc_list.remove(<span class="st">&#39;fr_Imine&#39;</span>)</a>
<a class="sourceLine" id="cb1095-71" title="71">    desc_list.remove(<span class="st">&#39;fr_NH0&#39;</span>)</a>
<a class="sourceLine" id="cb1095-72" title="72">    desc_list.remove(<span class="st">&#39;fr_NH1&#39;</span>)</a>
<a class="sourceLine" id="cb1095-73" title="73">    desc_list.remove(<span class="st">&#39;fr_NH2&#39;</span>)</a>
<a class="sourceLine" id="cb1095-74" title="74">    desc_list.remove(<span class="st">&#39;fr_N_O&#39;</span>)</a>
<a class="sourceLine" id="cb1095-75" title="75">    desc_list.remove(<span class="st">&#39;fr_Ndealkylation1&#39;</span>)</a>
<a class="sourceLine" id="cb1095-76" title="76">    desc_list.remove(<span class="st">&#39;fr_Ndealkylation2&#39;</span>)</a>
<a class="sourceLine" id="cb1095-77" title="77">    desc_list.remove(<span class="st">&#39;fr_Nhpyrrole&#39;</span>)</a>
<a class="sourceLine" id="cb1095-78" title="78">    desc_list.remove(<span class="st">&#39;fr_SH&#39;</span>)</a>
<a class="sourceLine" id="cb1095-79" title="79">    desc_list.remove(<span class="st">&#39;fr_aldehyde&#39;</span>)</a>
<a class="sourceLine" id="cb1095-80" title="80">    desc_list.remove(<span class="st">&#39;fr_alkyl_carbamate&#39;</span>)</a>
<a class="sourceLine" id="cb1095-81" title="81">    desc_list.remove(<span class="st">&#39;fr_alkyl_halide&#39;</span>)</a>
<a class="sourceLine" id="cb1095-82" title="82">    desc_list.remove(<span class="st">&#39;fr_allylic_oxid&#39;</span>)</a>
<a class="sourceLine" id="cb1095-83" title="83">    desc_list.remove(<span class="st">&#39;fr_amide&#39;</span>)</a>
<a class="sourceLine" id="cb1095-84" title="84">    desc_list.remove(<span class="st">&#39;fr_amidine&#39;</span>)</a>
<a class="sourceLine" id="cb1095-85" title="85">    desc_list.remove(<span class="st">&#39;fr_aniline&#39;</span>)</a>
<a class="sourceLine" id="cb1095-86" title="86">    desc_list.remove(<span class="st">&#39;fr_aryl_methyl&#39;</span>)</a>
<a class="sourceLine" id="cb1095-87" title="87">    desc_list.remove(<span class="st">&#39;fr_azide&#39;</span>)</a>
<a class="sourceLine" id="cb1095-88" title="88">    desc_list.remove(<span class="st">&#39;fr_azo&#39;</span>)</a>
<a class="sourceLine" id="cb1095-89" title="89">    desc_list.remove(<span class="st">&#39;fr_barbitur&#39;</span>)</a>
<a class="sourceLine" id="cb1095-90" title="90">    desc_list.remove(<span class="st">&#39;fr_benzene&#39;</span>)</a>
<a class="sourceLine" id="cb1095-91" title="91">    desc_list.</a>
<a class="sourceLine" id="cb1095-92" title="92">s <span class="op">=</span> [<span class="st">&#39;CC=O&#39;</span>, <span class="st">&#39;CC=C=C(C(=O)N)&#39;</span>]</a>
<a class="sourceLine" id="cb1095-93" title="93">v <span class="op">=</span> get_descriptors(s)</a>
<a class="sourceLine" id="cb1095-94" title="94">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.shape(v) <span class="op">==</span> (<span class="dv">2</span>, <span class="dv">8</span>) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>invalid syntax (&lt;string&gt;, line 92)</code></pre>
<h4 id="run-3-99">Run 3</h4>
<div class="sourceCode" id="cb1097"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1097-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1097-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb1097-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb1097-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb1097-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb1097-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb1097-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb1097-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb1097-9" title="9"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb1097-10" title="10"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb1097-11" title="11"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1097-12" title="12"></a>
<a class="sourceLine" id="cb1097-13" title="13"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1097-14" title="14"><span class="co">print rdkit version</span></a>
<a class="sourceLine" id="cb1097-15" title="15"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1097-16" title="16"><span class="bu">print</span>(rdkit.__version__)</a>
<a class="sourceLine" id="cb1097-17" title="17"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1097-18" title="18"></a>
<a class="sourceLine" id="cb1097-19" title="19"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1097-20" title="20"></a>
<a class="sourceLine" id="cb1097-21" title="21"><span class="kw">def</span> get_descriptors(smiles_list):</a>
<a class="sourceLine" id="cb1097-22" title="22">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1097-23" title="23"><span class="co">    Returns an N x 8 matrix of descriptors for given SMILEs</span></a>
<a class="sourceLine" id="cb1097-24" title="24"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1097-25" title="25">    nms <span class="op">=</span> [x[<span class="dv">0</span>] <span class="cf">for</span> x <span class="kw">in</span> Descriptors._descList]</a>
<a class="sourceLine" id="cb1097-26" title="26">    calc <span class="op">=</span> MoleculeDescriptors.MolecularDescriptorCalculator(nms)</a>
<a class="sourceLine" id="cb1097-27" title="27">    descriptors <span class="op">=</span> []</a>
<a class="sourceLine" id="cb1097-28" title="28">    <span class="cf">for</span> smile <span class="kw">in</span> smiles_list:</a>
<a class="sourceLine" id="cb1097-29" title="29">        m <span class="op">=</span> Chem.MolFromSmiles(smile)</a>
<a class="sourceLine" id="cb1097-30" title="30">        descrs <span class="op">=</span> calc.CalcDescriptors(m)</a>
<a class="sourceLine" id="cb1097-31" title="31">        descriptors.append(descrs)</a>
<a class="sourceLine" id="cb1097-32" title="32">    <span class="cf">return</span> np.array(descriptors)</a>
<a class="sourceLine" id="cb1097-33" title="33"></a>
<a class="sourceLine" id="cb1097-34" title="34"></a>
<a class="sourceLine" id="cb1097-35" title="35">s <span class="op">=</span> [<span class="st">&#39;CC=O&#39;</span>, <span class="st">&#39;CC=C=C(C(=O)N)&#39;</span>]</a>
<a class="sourceLine" id="cb1097-36" title="36">v <span class="op">=</span> get_descriptors(s)</a>
<a class="sourceLine" id="cb1097-37" title="37">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.shape(v) <span class="op">==</span> (<span class="dv">2</span>, <span class="dv">8</span>) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-99">Run 4</h4>
<div class="sourceCode" id="cb1099"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1099-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1099-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb1099-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb1099-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb1099-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb1099-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb1099-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb1099-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb1099-9" title="9"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb1099-10" title="10"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb1099-11" title="11"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1099-12" title="12"></a>
<a class="sourceLine" id="cb1099-13" title="13"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1099-14" title="14"><span class="co">print rdkit version</span></a>
<a class="sourceLine" id="cb1099-15" title="15"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1099-16" title="16"><span class="bu">print</span>(rdkit.__version__)</a>
<a class="sourceLine" id="cb1099-17" title="17"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1099-18" title="18"></a>
<a class="sourceLine" id="cb1099-19" title="19"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1099-20" title="20"></a>
<a class="sourceLine" id="cb1099-21" title="21"><span class="kw">def</span> get_descriptors(smiles_list):</a>
<a class="sourceLine" id="cb1099-22" title="22">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1099-23" title="23"><span class="co">    Returns an N x 8 matrix of descriptors for given SMILEs</span></a>
<a class="sourceLine" id="cb1099-24" title="24"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1099-25" title="25">    nms <span class="op">=</span> [x[<span class="dv">0</span>] <span class="cf">for</span> x <span class="kw">in</span> Descriptors._descList]</a>
<a class="sourceLine" id="cb1099-26" title="26">    calc <span class="op">=</span> MoleculeDescriptors.MolecularDescriptorCalculator(nms)</a>
<a class="sourceLine" id="cb1099-27" title="27">    descriptors <span class="op">=</span> []</a>
<a class="sourceLine" id="cb1099-28" title="28">    <span class="cf">for</span> smiles <span class="kw">in</span> smiles_list:</a>
<a class="sourceLine" id="cb1099-29" title="29">        m <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb1099-30" title="30">        descrs <span class="op">=</span> calc.CalcDescriptors(m)</a>
<a class="sourceLine" id="cb1099-31" title="31">        descriptors.append(descrs)</a>
<a class="sourceLine" id="cb1099-32" title="32">    <span class="cf">return</span> np.array(descriptors)</a>
<a class="sourceLine" id="cb1099-33" title="33"></a>
<a class="sourceLine" id="cb1099-34" title="34"></a>
<a class="sourceLine" id="cb1099-35" title="35">s <span class="op">=</span> [<span class="st">&#39;CC=O&#39;</span>, <span class="st">&#39;CC=C=C(C(=O)N)&#39;</span>]</a>
<a class="sourceLine" id="cb1099-36" title="36">v <span class="op">=</span> get_descriptors(s)</a>
<a class="sourceLine" id="cb1099-37" title="37">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.shape(v) <span class="op">==</span> (<span class="dv">2</span>, <span class="dv">8</span>) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>dipole</summary></p>
<h4 id="query-100">Query</h4>
<div class="sourceCode" id="cb1101"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1101-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1101-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1101-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1101-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1101-5" title="5"></a>
<a class="sourceLine" id="cb1101-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1101-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1101-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1101-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1101-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1101-11" title="11"></a>
<a class="sourceLine" id="cb1101-12" title="12"><span class="kw">def</span> dipole_moment(coordinates, charges):</a>
<a class="sourceLine" id="cb1101-13" title="13">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1101-14" title="14"><span class="co">  This function returns the dipole moment of a molecule</span></a>
<a class="sourceLine" id="cb1101-15" title="15"></a>
<a class="sourceLine" id="cb1101-16" title="16"><span class="co">  Coordinates is a numpy array of size Nx3</span></a>
<a class="sourceLine" id="cb1101-17" title="17"><span class="co">  Charges is a numpy array of size N</span></a>
<a class="sourceLine" id="cb1101-18" title="18"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1101-19" title="19">  </a></code></pre></div>
<h4 id="run-0-100">Run 0</h4>
<div class="sourceCode" id="cb1102"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1102-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1102-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1102-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1102-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1102-5" title="5"></a>
<a class="sourceLine" id="cb1102-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1102-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1102-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1102-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1102-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1102-11" title="11"></a>
<a class="sourceLine" id="cb1102-12" title="12"><span class="kw">def</span> dipole_moment(coordinates, charges):</a>
<a class="sourceLine" id="cb1102-13" title="13">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1102-14" title="14"><span class="co">  This function returns the dipole moment of a molecule</span></a>
<a class="sourceLine" id="cb1102-15" title="15"></a>
<a class="sourceLine" id="cb1102-16" title="16"><span class="co">  Coordinates is a numpy array of size Nx3</span></a>
<a class="sourceLine" id="cb1102-17" title="17"><span class="co">  Charges is a numpy array of size N</span></a>
<a class="sourceLine" id="cb1102-18" title="18"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1102-19" title="19">  dipole_moment <span class="op">=</span> np.zeros(<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb1102-20" title="20">  <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(charges)):</a>
<a class="sourceLine" id="cb1102-21" title="21">    dipole_moment <span class="op">+=</span> charges[i] <span class="op">*</span> coordinates[i]</a>
<a class="sourceLine" id="cb1102-22" title="22">  <span class="cf">return</span> dipole_moment</a>
<a class="sourceLine" id="cb1102-23" title="23"></a>
<a class="sourceLine" id="cb1102-24" title="24"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1102-25" title="25"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb1102-26" title="26">coordinates <span class="op">=</span> np.loadtxt(os.path.join(_FILE_DIR_,<span class="st">&quot;water.xyz&quot;</span>),usecols<span class="op">=</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>))</a>
<a class="sourceLine" id="cb1102-27" title="27"><span class="co">#note, these are fake</span></a>
<a class="sourceLine" id="cb1102-28" title="28">charges <span class="op">=</span> np.loadtxt(os.path.join(_FILE_DIR_,<span class="st">&quot;charges.txt&quot;</span>))</a>
<a class="sourceLine" id="cb1102-29" title="29">my_dipole <span class="op">=</span> (coordinates.T<span class="op">*</span>charges).<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb1102-30" title="30">nl_dipole <span class="op">=</span> dipole_moment(coordinates,charges) </a>
<a class="sourceLine" id="cb1102-31" title="31"></a>
<a class="sourceLine" id="cb1102-32" title="32"><span class="co">#print(&quot;My result:&quot;,my_dipole)</span></a>
<a class="sourceLine" id="cb1102-33" title="33"><span class="co">#print(&quot;NL result:&quot;,nl_dipole)</span></a>
<a class="sourceLine" id="cb1102-34" title="34">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">all</span>(np.<span class="bu">abs</span>( my_dipole <span class="op">-</span> nl_dipole )<span class="op">&lt;</span><span class="fl">0.01</span>) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-100">Run 1</h4>
<div class="sourceCode" id="cb1104"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1104-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1104-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1104-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1104-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1104-5" title="5"></a>
<a class="sourceLine" id="cb1104-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1104-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1104-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1104-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1104-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1104-11" title="11"></a>
<a class="sourceLine" id="cb1104-12" title="12"><span class="kw">def</span> dipole_moment(coordinates, charges):</a>
<a class="sourceLine" id="cb1104-13" title="13">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1104-14" title="14"><span class="co">  This function returns the dipole moment of a molecule</span></a>
<a class="sourceLine" id="cb1104-15" title="15"></a>
<a class="sourceLine" id="cb1104-16" title="16"><span class="co">  Coordinates is a numpy array of size Nx3</span></a>
<a class="sourceLine" id="cb1104-17" title="17"><span class="co">  Charges is a numpy array of size N</span></a>
<a class="sourceLine" id="cb1104-18" title="18"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1104-19" title="19">  <span class="cf">return</span> np.<span class="bu">sum</span>(coordinates<span class="op">*</span>charges[:,np.newaxis], axis<span class="op">=</span><span class="dv">0</span>)</a>
<a class="sourceLine" id="cb1104-20" title="20"></a>
<a class="sourceLine" id="cb1104-21" title="21"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1104-22" title="22"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb1104-23" title="23">coordinates <span class="op">=</span> np.loadtxt(os.path.join(_FILE_DIR_,<span class="st">&quot;water.xyz&quot;</span>),usecols<span class="op">=</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>))</a>
<a class="sourceLine" id="cb1104-24" title="24"><span class="co">#note, these are fake</span></a>
<a class="sourceLine" id="cb1104-25" title="25">charges <span class="op">=</span> np.loadtxt(os.path.join(_FILE_DIR_,<span class="st">&quot;charges.txt&quot;</span>))</a>
<a class="sourceLine" id="cb1104-26" title="26">my_dipole <span class="op">=</span> (coordinates.T<span class="op">*</span>charges).<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb1104-27" title="27">nl_dipole <span class="op">=</span> dipole_moment(coordinates,charges) </a>
<a class="sourceLine" id="cb1104-28" title="28"></a>
<a class="sourceLine" id="cb1104-29" title="29"><span class="co">#print(&quot;My result:&quot;,my_dipole)</span></a>
<a class="sourceLine" id="cb1104-30" title="30"><span class="co">#print(&quot;NL result:&quot;,nl_dipole)</span></a>
<a class="sourceLine" id="cb1104-31" title="31">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">all</span>(np.<span class="bu">abs</span>( my_dipole <span class="op">-</span> nl_dipole )<span class="op">&lt;</span><span class="fl">0.01</span>) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-100">Run 2</h4>
<div class="sourceCode" id="cb1106"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1106-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1106-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1106-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1106-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1106-5" title="5"></a>
<a class="sourceLine" id="cb1106-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1106-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1106-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1106-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1106-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1106-11" title="11"></a>
<a class="sourceLine" id="cb1106-12" title="12"><span class="kw">def</span> dipole_moment(coordinates, charges):</a>
<a class="sourceLine" id="cb1106-13" title="13">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1106-14" title="14"><span class="co">  This function returns the dipole moment of a molecule</span></a>
<a class="sourceLine" id="cb1106-15" title="15"></a>
<a class="sourceLine" id="cb1106-16" title="16"><span class="co">  Coordinates is a numpy array of size Nx3</span></a>
<a class="sourceLine" id="cb1106-17" title="17"><span class="co">  Charges is a numpy array of size N</span></a>
<a class="sourceLine" id="cb1106-18" title="18"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1106-19" title="19">  <span class="co"># YOUR CODE HERE</span></a>
<a class="sourceLine" id="cb1106-20" title="20">  <span class="co">#raise NotImplementedError()</span></a>
<a class="sourceLine" id="cb1106-21" title="21">  </a>
<a class="sourceLine" id="cb1106-22" title="22"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1106-23" title="23"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb1106-24" title="24">coordinates <span class="op">=</span> np.loadtxt(os.path.join(_FILE_DIR_,<span class="st">&quot;water.xyz&quot;</span>),usecols<span class="op">=</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>))</a>
<a class="sourceLine" id="cb1106-25" title="25"><span class="co">#note, these are fake</span></a>
<a class="sourceLine" id="cb1106-26" title="26">charges <span class="op">=</span> np.loadtxt(os.path.join(_FILE_DIR_,<span class="st">&quot;charges.txt&quot;</span>))</a>
<a class="sourceLine" id="cb1106-27" title="27">my_dipole <span class="op">=</span> (coordinates.T<span class="op">*</span>charges).<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb1106-28" title="28">nl_dipole <span class="op">=</span> dipole_moment(coordinates,charges) </a>
<a class="sourceLine" id="cb1106-29" title="29"></a>
<a class="sourceLine" id="cb1106-30" title="30"><span class="co">#print(&quot;My result:&quot;,my_dipole)</span></a>
<a class="sourceLine" id="cb1106-31" title="31"><span class="co">#print(&quot;NL result:&quot;,nl_dipole)</span></a>
<a class="sourceLine" id="cb1106-32" title="32">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">all</span>(np.<span class="bu">abs</span>( my_dipole <span class="op">-</span> nl_dipole )<span class="op">&lt;</span><span class="fl">0.01</span>) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>unsupported operand type(s) for -: &#39;float&#39; and &#39;NoneType&#39;</code></pre>
<h4 id="run-3-100">Run 3</h4>
<div class="sourceCode" id="cb1108"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1108-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1108-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1108-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1108-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1108-5" title="5"></a>
<a class="sourceLine" id="cb1108-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1108-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1108-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1108-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1108-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1108-11" title="11"></a>
<a class="sourceLine" id="cb1108-12" title="12"><span class="kw">def</span> dipole_moment(coordinates, charges):</a>
<a class="sourceLine" id="cb1108-13" title="13">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1108-14" title="14"><span class="co">  This function returns the dipole moment of a molecule</span></a>
<a class="sourceLine" id="cb1108-15" title="15"></a>
<a class="sourceLine" id="cb1108-16" title="16"><span class="co">  Coordinates is a numpy array of size Nx3</span></a>
<a class="sourceLine" id="cb1108-17" title="17"><span class="co">  Charges is a numpy array of size N</span></a>
<a class="sourceLine" id="cb1108-18" title="18"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1108-19" title="19">  dipole_moment <span class="op">=</span> np.zeros(<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb1108-20" title="20">  <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(charges)):</a>
<a class="sourceLine" id="cb1108-21" title="21">    dipole_moment <span class="op">+=</span> charges[i] <span class="op">*</span> coordinates[i]</a>
<a class="sourceLine" id="cb1108-22" title="22">  <span class="cf">return</span> dipole_moment</a>
<a class="sourceLine" id="cb1108-23" title="23"></a>
<a class="sourceLine" id="cb1108-24" title="24"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1108-25" title="25"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb1108-26" title="26">coordinates <span class="op">=</span> np.loadtxt(os.path.join(_FILE_DIR_,<span class="st">&quot;water.xyz&quot;</span>),usecols<span class="op">=</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>))</a>
<a class="sourceLine" id="cb1108-27" title="27"><span class="co">#note, these are fake</span></a>
<a class="sourceLine" id="cb1108-28" title="28">charges <span class="op">=</span> np.loadtxt(os.path.join(_FILE_DIR_,<span class="st">&quot;charges.txt&quot;</span>))</a>
<a class="sourceLine" id="cb1108-29" title="29">my_dipole <span class="op">=</span> (coordinates.T<span class="op">*</span>charges).<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb1108-30" title="30">nl_dipole <span class="op">=</span> dipole_moment(coordinates,charges) </a>
<a class="sourceLine" id="cb1108-31" title="31"></a>
<a class="sourceLine" id="cb1108-32" title="32"><span class="co">#print(&quot;My result:&quot;,my_dipole)</span></a>
<a class="sourceLine" id="cb1108-33" title="33"><span class="co">#print(&quot;NL result:&quot;,nl_dipole)</span></a>
<a class="sourceLine" id="cb1108-34" title="34">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">all</span>(np.<span class="bu">abs</span>( my_dipole <span class="op">-</span> nl_dipole )<span class="op">&lt;</span><span class="fl">0.01</span>) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-100">Run 4</h4>
<div class="sourceCode" id="cb1110"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1110-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1110-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1110-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1110-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1110-5" title="5"></a>
<a class="sourceLine" id="cb1110-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1110-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1110-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1110-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1110-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1110-11" title="11"></a>
<a class="sourceLine" id="cb1110-12" title="12"><span class="kw">def</span> dipole_moment(coordinates, charges):</a>
<a class="sourceLine" id="cb1110-13" title="13">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1110-14" title="14"><span class="co">  This function returns the dipole moment of a molecule</span></a>
<a class="sourceLine" id="cb1110-15" title="15"></a>
<a class="sourceLine" id="cb1110-16" title="16"><span class="co">  Coordinates is a numpy array of size Nx3</span></a>
<a class="sourceLine" id="cb1110-17" title="17"><span class="co">  Charges is a numpy array of size N</span></a>
<a class="sourceLine" id="cb1110-18" title="18"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1110-19" title="19">  dipole <span class="op">=</span> np.zeros(<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb1110-20" title="20">  <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(charges)):</a>
<a class="sourceLine" id="cb1110-21" title="21">    dipole <span class="op">+=</span> charges[i] <span class="op">*</span> coordinates[i]</a>
<a class="sourceLine" id="cb1110-22" title="22">  <span class="cf">return</span> dipole</a>
<a class="sourceLine" id="cb1110-23" title="23"></a>
<a class="sourceLine" id="cb1110-24" title="24"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1110-25" title="25"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb1110-26" title="26">coordinates <span class="op">=</span> np.loadtxt(os.path.join(_FILE_DIR_,<span class="st">&quot;water.xyz&quot;</span>),usecols<span class="op">=</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>))</a>
<a class="sourceLine" id="cb1110-27" title="27"><span class="co">#note, these are fake</span></a>
<a class="sourceLine" id="cb1110-28" title="28">charges <span class="op">=</span> np.loadtxt(os.path.join(_FILE_DIR_,<span class="st">&quot;charges.txt&quot;</span>))</a>
<a class="sourceLine" id="cb1110-29" title="29">my_dipole <span class="op">=</span> (coordinates.T<span class="op">*</span>charges).<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb1110-30" title="30">nl_dipole <span class="op">=</span> dipole_moment(coordinates,charges) </a>
<a class="sourceLine" id="cb1110-31" title="31"></a>
<a class="sourceLine" id="cb1110-32" title="32"><span class="co">#print(&quot;My result:&quot;,my_dipole)</span></a>
<a class="sourceLine" id="cb1110-33" title="33"><span class="co">#print(&quot;NL result:&quot;,nl_dipole)</span></a>
<a class="sourceLine" id="cb1110-34" title="34">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">all</span>(np.<span class="bu">abs</span>( my_dipole <span class="op">-</span> nl_dipole )<span class="op">&lt;</span><span class="fl">0.01</span>) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>dou</summary></p>
<h4 id="query-101">Query</h4>
<div class="sourceCode" id="cb1112"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1112-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1112-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb1112-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb1112-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb1112-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb1112-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb1112-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb1112-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb1112-9" title="9"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb1112-10" title="10"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb1112-11" title="11"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1112-12" title="12"></a>
<a class="sourceLine" id="cb1112-13" title="13"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1112-14" title="14"><span class="co">print rdkit version</span></a>
<a class="sourceLine" id="cb1112-15" title="15"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1112-16" title="16"><span class="bu">print</span>(rdkit.__version__)</a>
<a class="sourceLine" id="cb1112-17" title="17"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1112-18" title="18"></a>
<a class="sourceLine" id="cb1112-19" title="19"><span class="kw">def</span> calc_rdbs(smiles):</a>
<a class="sourceLine" id="cb1112-20" title="20">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1112-21" title="21"><span class="co">    Return degrees of unsaturation (Double Bond Equivalent) from C, N, H, Halogen count.</span></a>
<a class="sourceLine" id="cb1112-22" title="22"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1112-23" title="23">    </a></code></pre></div>
<h4 id="run-0-101">Run 0</h4>
<div class="sourceCode" id="cb1113"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1113-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1113-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb1113-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb1113-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb1113-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb1113-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb1113-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb1113-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb1113-9" title="9"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb1113-10" title="10"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb1113-11" title="11"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1113-12" title="12"></a>
<a class="sourceLine" id="cb1113-13" title="13"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1113-14" title="14"><span class="co">print rdkit version</span></a>
<a class="sourceLine" id="cb1113-15" title="15"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1113-16" title="16"><span class="bu">print</span>(rdkit.__version__)</a>
<a class="sourceLine" id="cb1113-17" title="17"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1113-18" title="18"></a>
<a class="sourceLine" id="cb1113-19" title="19"><span class="kw">def</span> calc_rdbs(smiles):</a>
<a class="sourceLine" id="cb1113-20" title="20">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1113-21" title="21"><span class="co">    Return degrees of unsaturation (Double Bond Equivalent) from C, N, H, Halogen count.</span></a>
<a class="sourceLine" id="cb1113-22" title="22"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1113-23" title="23">    mol <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb1113-24" title="24">    <span class="cf">if</span> mol <span class="kw">is</span> <span class="va">None</span>:</a>
<a class="sourceLine" id="cb1113-25" title="25">        <span class="cf">return</span> <span class="va">None</span></a>
<a class="sourceLine" id="cb1113-26" title="26">    <span class="cf">else</span>:</a>
<a class="sourceLine" id="cb1113-27" title="27">        <span class="cf">return</span> Descriptors.NumRadicalElectrons(mol)</a>
<a class="sourceLine" id="cb1113-28" title="28"></a>
<a class="sourceLine" id="cb1113-29" title="29">d <span class="op">=</span> calc_rdbs(<span class="st">&#39;c1ccccc1&#39;</span>)</a>
<a class="sourceLine" id="cb1113-30" title="30"><span class="bu">print</span>(<span class="st">&#39;d = &#39;</span>, d)</a>
<a class="sourceLine" id="cb1113-31" title="31">result <span class="op">=</span> d <span class="op">==</span> <span class="dv">4</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-101">Run 1</h4>
<div class="sourceCode" id="cb1115"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1115-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1115-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb1115-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb1115-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb1115-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb1115-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb1115-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb1115-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb1115-9" title="9"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb1115-10" title="10"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb1115-11" title="11"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1115-12" title="12"></a>
<a class="sourceLine" id="cb1115-13" title="13"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1115-14" title="14"><span class="co">print rdkit version</span></a>
<a class="sourceLine" id="cb1115-15" title="15"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1115-16" title="16"><span class="bu">print</span>(rdkit.__version__)</a>
<a class="sourceLine" id="cb1115-17" title="17"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1115-18" title="18"></a>
<a class="sourceLine" id="cb1115-19" title="19"><span class="kw">def</span> calc_rdbs(smiles):</a>
<a class="sourceLine" id="cb1115-20" title="20">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1115-21" title="21"><span class="co">    Return degrees of unsaturation (Double Bond Equivalent) from C, N, H, Halogen count.</span></a>
<a class="sourceLine" id="cb1115-22" title="22"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1115-23" title="23">    mol <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb1115-24" title="24">    c <span class="op">=</span> mol.GetNumAtoms()</a>
<a class="sourceLine" id="cb1115-25" title="25">    n <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb1115-26" title="26">    h <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb1115-27" title="27">    hal <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb1115-28" title="28">    <span class="cf">for</span> atom <span class="kw">in</span> mol.GetAtoms():</a>
<a class="sourceLine" id="cb1115-29" title="29">        <span class="cf">if</span> atom.GetAtomicNum() <span class="op">==</span> <span class="dv">7</span>:</a>
<a class="sourceLine" id="cb1115-30" title="30">            n <span class="op">+=</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb1115-31" title="31">        <span class="cf">elif</span> atom.GetAtomicNum() <span class="op">==</span> <span class="dv">1</span>:</a>
<a class="sourceLine" id="cb1115-32" title="32">            h <span class="op">+=</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb1115-33" title="33">        <span class="cf">elif</span> atom.GetAtomicNum() <span class="op">==</span> <span class="dv">9</span> <span class="kw">or</span> atom.GetAtomicNum() <span class="op">==</span> <span class="dv">17</span> <span class="kw">or</span> atom.GetAtomicNum() <span class="op">==</span> <span class="dv">35</span> <span class="kw">or</span> atom.GetAtomicNum() <span class="op">==</span> <span class="dv">53</span>:</a>
<a class="sourceLine" id="cb1115-34" title="34">            hal <span class="op">+=</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb1115-35" title="35">    rdb <span class="op">=</span> (<span class="dv">2</span><span class="op">*</span>c <span class="op">+</span> <span class="dv">2</span> <span class="op">-</span> h <span class="op">-</span> hal) <span class="op">-</span> n</a>
<a class="sourceLine" id="cb1115-36" title="36">    <span class="cf">return</span> rdb</a>
<a class="sourceLine" id="cb1115-37" title="37"></a>
<a class="sourceLine" id="cb1115-38" title="38">d <span class="op">=</span> calc_rdbs(<span class="st">&#39;c1ccccc1&#39;</span>)</a>
<a class="sourceLine" id="cb1115-39" title="39"><span class="bu">print</span>(<span class="st">&#39;d = &#39;</span>, d)</a>
<a class="sourceLine" id="cb1115-40" title="40">result <span class="op">=</span> d <span class="op">==</span> <span class="dv">4</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-101">Run 2</h4>
<div class="sourceCode" id="cb1117"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1117-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1117-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb1117-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb1117-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb1117-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb1117-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb1117-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb1117-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb1117-9" title="9"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb1117-10" title="10"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb1117-11" title="11"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1117-12" title="12"></a>
<a class="sourceLine" id="cb1117-13" title="13"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1117-14" title="14"><span class="co">print rdkit version</span></a>
<a class="sourceLine" id="cb1117-15" title="15"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1117-16" title="16"><span class="bu">print</span>(rdkit.__version__)</a>
<a class="sourceLine" id="cb1117-17" title="17"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1117-18" title="18"></a>
<a class="sourceLine" id="cb1117-19" title="19"><span class="kw">def</span> calc_rdbs(smiles):</a>
<a class="sourceLine" id="cb1117-20" title="20">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1117-21" title="21"><span class="co">    Return degrees of unsaturation (Double Bond Equivalent) from C, N, H, Halogen count.</span></a>
<a class="sourceLine" id="cb1117-22" title="22"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1117-23" title="23">    mol <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb1117-24" title="24">    C <span class="op">=</span> mol.GetNumAtoms(<span class="dv">6</span>)</a>
<a class="sourceLine" id="cb1117-25" title="25">    N <span class="op">=</span> mol.GetNumAtoms(<span class="dv">7</span>)</a>
<a class="sourceLine" id="cb1117-26" title="26">    H <span class="op">=</span> mol.GetNumAtoms(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb1117-27" title="27">    halogen <span class="op">=</span> mol.GetNumAtoms(<span class="dv">9</span>) <span class="op">+</span> mol.GetNumAtoms(<span class="dv">17</span>) <span class="op">+</span> mol.GetNumAtoms(<span class="dv">35</span>) <span class="op">+</span> mol.GetNumAtoms(<span class="dv">53</span>)</a>
<a class="sourceLine" id="cb1117-28" title="28">    <span class="cf">return</span> (<span class="dv">2</span><span class="op">*</span>(C<span class="op">-</span>N)<span class="op">+</span>H<span class="op">-</span>halogen)<span class="op">/</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb1117-29" title="29"></a>
<a class="sourceLine" id="cb1117-30" title="30">d <span class="op">=</span> calc_rdbs(<span class="st">&#39;c1ccccc1&#39;</span>)</a>
<a class="sourceLine" id="cb1117-31" title="31"><span class="bu">print</span>(<span class="st">&#39;d = &#39;</span>, d)</a>
<a class="sourceLine" id="cb1117-32" title="32">result <span class="op">=</span> d <span class="op">==</span> <span class="dv">4</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-101">Run 3</h4>
<div class="sourceCode" id="cb1119"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1119-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1119-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb1119-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb1119-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb1119-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb1119-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb1119-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb1119-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb1119-9" title="9"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb1119-10" title="10"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb1119-11" title="11"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1119-12" title="12"></a>
<a class="sourceLine" id="cb1119-13" title="13"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1119-14" title="14"><span class="co">print rdkit version</span></a>
<a class="sourceLine" id="cb1119-15" title="15"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1119-16" title="16"><span class="bu">print</span>(rdkit.__version__)</a>
<a class="sourceLine" id="cb1119-17" title="17"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1119-18" title="18"></a>
<a class="sourceLine" id="cb1119-19" title="19"><span class="kw">def</span> calc_rdbs(smiles):</a>
<a class="sourceLine" id="cb1119-20" title="20">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1119-21" title="21"><span class="co">    Return degrees of unsaturation (Double Bond Equivalent) from C, N, H, Halogen count.</span></a>
<a class="sourceLine" id="cb1119-22" title="22"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1119-23" title="23">    mol <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb1119-24" title="24">    <span class="cf">if</span> mol <span class="kw">is</span> <span class="va">None</span>:</a>
<a class="sourceLine" id="cb1119-25" title="25">        <span class="cf">return</span> <span class="va">None</span></a>
<a class="sourceLine" id="cb1119-26" title="26">    <span class="cf">else</span>:</a>
<a class="sourceLine" id="cb1119-27" title="27">        <span class="cf">return</span> Descriptors.CalcNumRotatableBonds(mol)</a>
<a class="sourceLine" id="cb1119-28" title="28"></a>
<a class="sourceLine" id="cb1119-29" title="29">d <span class="op">=</span> calc_rdbs(<span class="st">&#39;c1ccccc1&#39;</span>)</a>
<a class="sourceLine" id="cb1119-30" title="30"><span class="bu">print</span>(<span class="st">&#39;d = &#39;</span>, d)</a>
<a class="sourceLine" id="cb1119-31" title="31">result <span class="op">=</span> d <span class="op">==</span> <span class="dv">4</span></a></code></pre></div>
<p>Output:</p>
<pre><code>module &#39;rdkit.Chem.Descriptors&#39; has no attribute &#39;CalcNumRotatableBonds&#39;</code></pre>
<h4 id="run-4-101">Run 4</h4>
<div class="sourceCode" id="cb1121"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1121-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1121-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb1121-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb1121-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb1121-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb1121-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb1121-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb1121-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb1121-9" title="9"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb1121-10" title="10"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb1121-11" title="11"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1121-12" title="12"></a>
<a class="sourceLine" id="cb1121-13" title="13"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1121-14" title="14"><span class="co">print rdkit version</span></a>
<a class="sourceLine" id="cb1121-15" title="15"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1121-16" title="16"><span class="bu">print</span>(rdkit.__version__)</a>
<a class="sourceLine" id="cb1121-17" title="17"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1121-18" title="18"></a>
<a class="sourceLine" id="cb1121-19" title="19"><span class="kw">def</span> calc_rdbs(smiles):</a>
<a class="sourceLine" id="cb1121-20" title="20">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1121-21" title="21"><span class="co">    Return degrees of unsaturation (Double Bond Equivalent) from C, N, H, Halogen count.</span></a>
<a class="sourceLine" id="cb1121-22" title="22"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1121-23" title="23">    mol <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb1121-24" title="24">    <span class="cf">if</span> mol <span class="kw">is</span> <span class="va">None</span>:</a>
<a class="sourceLine" id="cb1121-25" title="25">        <span class="cf">return</span> <span class="va">None</span></a>
<a class="sourceLine" id="cb1121-26" title="26">    <span class="cf">else</span>:</a>
<a class="sourceLine" id="cb1121-27" title="27">        <span class="cf">return</span> Descriptors.NumRadicalElectrons(mol)</a>
<a class="sourceLine" id="cb1121-28" title="28"></a>
<a class="sourceLine" id="cb1121-29" title="29">d <span class="op">=</span> calc_rdbs(<span class="st">&#39;c1ccccc1&#39;</span>)</a>
<a class="sourceLine" id="cb1121-30" title="30"><span class="bu">print</span>(<span class="st">&#39;d = &#39;</span>, d)</a>
<a class="sourceLine" id="cb1121-31" title="31">result <span class="op">=</span> d <span class="op">==</span> <span class="dv">4</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>eigen-ch</summary></p>
<h4 id="query-102">Query</h4>
<div class="sourceCode" id="cb1123"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1123-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1123-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1123-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1123-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1123-5" title="5"></a>
<a class="sourceLine" id="cb1123-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1123-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1123-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1123-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1123-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1123-11" title="11"></a>
<a class="sourceLine" id="cb1123-12" title="12"><span class="kw">def</span> eigen(M):</a>
<a class="sourceLine" id="cb1123-13" title="13">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1123-14" title="14"><span class="co">    该函数返回矩阵M的特征值和特征向量。</span></a>
<a class="sourceLine" id="cb1123-15" title="15"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1123-16" title="16">    </a></code></pre></div>
<h4 id="run-0-102">Run 0</h4>
<div class="sourceCode" id="cb1124"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1124-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1124-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1124-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1124-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1124-5" title="5"></a>
<a class="sourceLine" id="cb1124-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1124-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1124-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1124-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1124-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1124-11" title="11"></a>
<a class="sourceLine" id="cb1124-12" title="12"><span class="kw">def</span> eigen(M):</a>
<a class="sourceLine" id="cb1124-13" title="13">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1124-14" title="14"><span class="co">    该函数返回矩阵M的特征值和特征向量。</span></a>
<a class="sourceLine" id="cb1124-15" title="15"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1124-16" title="16">    eigen_value, eigen_vector <span class="op">=</span> np.linalg.eig(M)</a>
<a class="sourceLine" id="cb1124-17" title="17">    <span class="cf">return</span> eigen_value, eigen_vector</a>
<a class="sourceLine" id="cb1124-18" title="18"></a>
<a class="sourceLine" id="cb1124-19" title="19"></a>
<a class="sourceLine" id="cb1124-20" title="20"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1124-21" title="21"></a>
<a class="sourceLine" id="cb1124-22" title="22">np.random.seed(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb1124-23" title="23">M <span class="op">=</span> np.random.random((<span class="dv">5</span>,<span class="dv">5</span>))</a>
<a class="sourceLine" id="cb1124-24" title="24">w, v <span class="op">=</span> np.linalg.eig(M)</a>
<a class="sourceLine" id="cb1124-25" title="25">w1, v1 <span class="op">=</span> eigen(M)</a>
<a class="sourceLine" id="cb1124-26" title="26">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.allclose(w, w1) <span class="kw">and</span> np.allclose(v,v1) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-102">Run 1</h4>
<div class="sourceCode" id="cb1126"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1126-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1126-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1126-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1126-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1126-5" title="5"></a>
<a class="sourceLine" id="cb1126-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1126-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1126-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1126-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1126-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1126-11" title="11"></a>
<a class="sourceLine" id="cb1126-12" title="12"><span class="kw">def</span> eigen(M):</a>
<a class="sourceLine" id="cb1126-13" title="13">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1126-14" title="14"><span class="co">    该函数返回矩阵M的特征值和特征向量。</span></a>
<a class="sourceLine" id="cb1126-15" title="15"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1126-16" title="16">    eig_vals, eig_vecs <span class="op">=</span> np.linalg.eig(M)</a>
<a class="sourceLine" id="cb1126-17" title="17">    <span class="cf">return</span> eig_vals, eig_vecs</a>
<a class="sourceLine" id="cb1126-18" title="18"></a>
<a class="sourceLine" id="cb1126-19" title="19"></a>
<a class="sourceLine" id="cb1126-20" title="20"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1126-21" title="21"></a>
<a class="sourceLine" id="cb1126-22" title="22">np.random.seed(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb1126-23" title="23">M <span class="op">=</span> np.random.random((<span class="dv">5</span>,<span class="dv">5</span>))</a>
<a class="sourceLine" id="cb1126-24" title="24">w, v <span class="op">=</span> np.linalg.eig(M)</a>
<a class="sourceLine" id="cb1126-25" title="25">w1, v1 <span class="op">=</span> eigen(M)</a>
<a class="sourceLine" id="cb1126-26" title="26">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.allclose(w, w1) <span class="kw">and</span> np.allclose(v,v1) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-102">Run 2</h4>
<div class="sourceCode" id="cb1128"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1128-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1128-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1128-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1128-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1128-5" title="5"></a>
<a class="sourceLine" id="cb1128-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1128-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1128-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1128-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1128-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1128-11" title="11"></a>
<a class="sourceLine" id="cb1128-12" title="12"><span class="kw">def</span> eigen(M):</a>
<a class="sourceLine" id="cb1128-13" title="13">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1128-14" title="14"><span class="co">    该函数返回矩阵M的特征值和特征向量。</span></a>
<a class="sourceLine" id="cb1128-15" title="15"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1128-16" title="16">    eig_value, eig_vector <span class="op">=</span> np.linalg.eig(M)</a>
<a class="sourceLine" id="cb1128-17" title="17">    <span class="cf">return</span> eig_value, eig_vector</a>
<a class="sourceLine" id="cb1128-18" title="18"></a>
<a class="sourceLine" id="cb1128-19" title="19"></a>
<a class="sourceLine" id="cb1128-20" title="20"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1128-21" title="21"></a>
<a class="sourceLine" id="cb1128-22" title="22">np.random.seed(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb1128-23" title="23">M <span class="op">=</span> np.random.random((<span class="dv">5</span>,<span class="dv">5</span>))</a>
<a class="sourceLine" id="cb1128-24" title="24">w, v <span class="op">=</span> np.linalg.eig(M)</a>
<a class="sourceLine" id="cb1128-25" title="25">w1, v1 <span class="op">=</span> eigen(M)</a>
<a class="sourceLine" id="cb1128-26" title="26">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.allclose(w, w1) <span class="kw">and</span> np.allclose(v,v1) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-102">Run 3</h4>
<div class="sourceCode" id="cb1130"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1130-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1130-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1130-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1130-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1130-5" title="5"></a>
<a class="sourceLine" id="cb1130-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1130-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1130-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1130-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1130-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1130-11" title="11"></a>
<a class="sourceLine" id="cb1130-12" title="12"><span class="kw">def</span> eigen(M):</a>
<a class="sourceLine" id="cb1130-13" title="13">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1130-14" title="14"><span class="co">    该函数返回矩阵M的特征值和特征向量。</span></a>
<a class="sourceLine" id="cb1130-15" title="15"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1130-16" title="16">    <span class="co"># start</span></a>
<a class="sourceLine" id="cb1130-17" title="17">    w, v <span class="op">=</span> np.linalg.eig(M)</a>
<a class="sourceLine" id="cb1130-18" title="18">    <span class="cf">return</span> w, v</a>
<a class="sourceLine" id="cb1130-19" title="19">    </a>
<a class="sourceLine" id="cb1130-20" title="20"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1130-21" title="21"></a>
<a class="sourceLine" id="cb1130-22" title="22">np.random.seed(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb1130-23" title="23">M <span class="op">=</span> np.random.random((<span class="dv">5</span>,<span class="dv">5</span>))</a>
<a class="sourceLine" id="cb1130-24" title="24">w, v <span class="op">=</span> np.linalg.eig(M)</a>
<a class="sourceLine" id="cb1130-25" title="25">w1, v1 <span class="op">=</span> eigen(M)</a>
<a class="sourceLine" id="cb1130-26" title="26">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.allclose(w, w1) <span class="kw">and</span> np.allclose(v,v1) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-102">Run 4</h4>
<div class="sourceCode" id="cb1132"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1132-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1132-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1132-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1132-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1132-5" title="5"></a>
<a class="sourceLine" id="cb1132-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1132-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1132-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1132-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1132-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1132-11" title="11"></a>
<a class="sourceLine" id="cb1132-12" title="12"><span class="kw">def</span> eigen(M):</a>
<a class="sourceLine" id="cb1132-13" title="13">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1132-14" title="14"><span class="co">    该函数返回矩阵M的特征值和特征向量。</span></a>
<a class="sourceLine" id="cb1132-15" title="15"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1132-16" title="16">    <span class="co"># begin</span></a>
<a class="sourceLine" id="cb1132-17" title="17">    eigvals, eigvecs <span class="op">=</span> np.linalg.eig(M)</a>
<a class="sourceLine" id="cb1132-18" title="18">    <span class="cf">return</span> eigvals, eigvecs</a>
<a class="sourceLine" id="cb1132-19" title="19">    </a>
<a class="sourceLine" id="cb1132-20" title="20"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1132-21" title="21"></a>
<a class="sourceLine" id="cb1132-22" title="22">np.random.seed(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb1132-23" title="23">M <span class="op">=</span> np.random.random((<span class="dv">5</span>,<span class="dv">5</span>))</a>
<a class="sourceLine" id="cb1132-24" title="24">w, v <span class="op">=</span> np.linalg.eig(M)</a>
<a class="sourceLine" id="cb1132-25" title="25">w1, v1 <span class="op">=</span> eigen(M)</a>
<a class="sourceLine" id="cb1132-26" title="26">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.allclose(w, w1) <span class="kw">and</span> np.allclose(v,v1) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>eigen</summary></p>
<h4 id="query-103">Query</h4>
<div class="sourceCode" id="cb1134"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1134-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1134-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1134-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1134-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1134-5" title="5"></a>
<a class="sourceLine" id="cb1134-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1134-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1134-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1134-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1134-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1134-11" title="11"></a>
<a class="sourceLine" id="cb1134-12" title="12"><span class="kw">def</span> eigen(M):</a>
<a class="sourceLine" id="cb1134-13" title="13">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1134-14" title="14"><span class="co">    Return eigenvalues and eigenvectors for a square matrix M</span></a>
<a class="sourceLine" id="cb1134-15" title="15"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1134-16" title="16">    </a></code></pre></div>
<h4 id="run-0-103">Run 0</h4>
<div class="sourceCode" id="cb1135"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1135-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1135-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1135-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1135-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1135-5" title="5"></a>
<a class="sourceLine" id="cb1135-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1135-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1135-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1135-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1135-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1135-11" title="11"></a>
<a class="sourceLine" id="cb1135-12" title="12"><span class="kw">def</span> eigen(M):</a>
<a class="sourceLine" id="cb1135-13" title="13">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1135-14" title="14"><span class="co">    Return eigenvalues and eigenvectors for a square matrix M</span></a>
<a class="sourceLine" id="cb1135-15" title="15"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1135-16" title="16">    eigvals, eigvecs <span class="op">=</span> np.linalg.eig(M)</a>
<a class="sourceLine" id="cb1135-17" title="17">    <span class="cf">return</span> eigvals, eigvecs</a>
<a class="sourceLine" id="cb1135-18" title="18"></a>
<a class="sourceLine" id="cb1135-19" title="19"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1135-20" title="20"></a>
<a class="sourceLine" id="cb1135-21" title="21">np.random.seed(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb1135-22" title="22">M <span class="op">=</span> np.random.random((<span class="dv">5</span>,<span class="dv">5</span>))</a>
<a class="sourceLine" id="cb1135-23" title="23">w, v <span class="op">=</span> np.linalg.eig(M)</a>
<a class="sourceLine" id="cb1135-24" title="24">w1, v1 <span class="op">=</span> eigen(M)</a>
<a class="sourceLine" id="cb1135-25" title="25">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.allclose(w, w1) <span class="kw">and</span> np.allclose(v,v1) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-103">Run 1</h4>
<div class="sourceCode" id="cb1137"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1137-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1137-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1137-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1137-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1137-5" title="5"></a>
<a class="sourceLine" id="cb1137-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1137-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1137-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1137-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1137-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1137-11" title="11"></a>
<a class="sourceLine" id="cb1137-12" title="12"><span class="kw">def</span> eigen(M):</a>
<a class="sourceLine" id="cb1137-13" title="13">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1137-14" title="14"><span class="co">    Return eigenvalues and eigenvectors for a square matrix M</span></a>
<a class="sourceLine" id="cb1137-15" title="15"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1137-16" title="16">    <span class="cf">return</span> np.linalg.eig(M)</a>
<a class="sourceLine" id="cb1137-17" title="17"></a>
<a class="sourceLine" id="cb1137-18" title="18"></a>
<a class="sourceLine" id="cb1137-19" title="19"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1137-20" title="20"></a>
<a class="sourceLine" id="cb1137-21" title="21">np.random.seed(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb1137-22" title="22">M <span class="op">=</span> np.random.random((<span class="dv">5</span>,<span class="dv">5</span>))</a>
<a class="sourceLine" id="cb1137-23" title="23">w, v <span class="op">=</span> np.linalg.eig(M)</a>
<a class="sourceLine" id="cb1137-24" title="24">w1, v1 <span class="op">=</span> eigen(M)</a>
<a class="sourceLine" id="cb1137-25" title="25">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.allclose(w, w1) <span class="kw">and</span> np.allclose(v,v1) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-103">Run 2</h4>
<div class="sourceCode" id="cb1139"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1139-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1139-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1139-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1139-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1139-5" title="5"></a>
<a class="sourceLine" id="cb1139-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1139-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1139-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1139-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1139-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1139-11" title="11"></a>
<a class="sourceLine" id="cb1139-12" title="12"><span class="kw">def</span> eigen(M):</a>
<a class="sourceLine" id="cb1139-13" title="13">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1139-14" title="14"><span class="co">    Return eigenvalues and eigenvectors for a square matrix M</span></a>
<a class="sourceLine" id="cb1139-15" title="15"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1139-16" title="16">    eigvals, eigvecs <span class="op">=</span> np.linalg.eig(M)</a>
<a class="sourceLine" id="cb1139-17" title="17">    <span class="cf">return</span> eigvals, eigvecs</a>
<a class="sourceLine" id="cb1139-18" title="18"></a>
<a class="sourceLine" id="cb1139-19" title="19"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1139-20" title="20"></a>
<a class="sourceLine" id="cb1139-21" title="21">np.random.seed(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb1139-22" title="22">M <span class="op">=</span> np.random.random((<span class="dv">5</span>,<span class="dv">5</span>))</a>
<a class="sourceLine" id="cb1139-23" title="23">w, v <span class="op">=</span> np.linalg.eig(M)</a>
<a class="sourceLine" id="cb1139-24" title="24">w1, v1 <span class="op">=</span> eigen(M)</a>
<a class="sourceLine" id="cb1139-25" title="25">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.allclose(w, w1) <span class="kw">and</span> np.allclose(v,v1) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-103">Run 3</h4>
<div class="sourceCode" id="cb1141"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1141-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1141-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1141-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1141-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1141-5" title="5"></a>
<a class="sourceLine" id="cb1141-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1141-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1141-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1141-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1141-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1141-11" title="11"></a>
<a class="sourceLine" id="cb1141-12" title="12"><span class="kw">def</span> eigen(M):</a>
<a class="sourceLine" id="cb1141-13" title="13">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1141-14" title="14"><span class="co">    Return eigenvalues and eigenvectors for a square matrix M</span></a>
<a class="sourceLine" id="cb1141-15" title="15"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1141-16" title="16">    eigenvalues, eigenvectors <span class="op">=</span> np.linalg.eig(M)</a>
<a class="sourceLine" id="cb1141-17" title="17">    <span class="cf">return</span> eigenvalues, eigenvectors</a>
<a class="sourceLine" id="cb1141-18" title="18"></a>
<a class="sourceLine" id="cb1141-19" title="19"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1141-20" title="20"></a>
<a class="sourceLine" id="cb1141-21" title="21">np.random.seed(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb1141-22" title="22">M <span class="op">=</span> np.random.random((<span class="dv">5</span>,<span class="dv">5</span>))</a>
<a class="sourceLine" id="cb1141-23" title="23">w, v <span class="op">=</span> np.linalg.eig(M)</a>
<a class="sourceLine" id="cb1141-24" title="24">w1, v1 <span class="op">=</span> eigen(M)</a>
<a class="sourceLine" id="cb1141-25" title="25">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.allclose(w, w1) <span class="kw">and</span> np.allclose(v,v1) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-103">Run 4</h4>
<div class="sourceCode" id="cb1143"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1143-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1143-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1143-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1143-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1143-5" title="5"></a>
<a class="sourceLine" id="cb1143-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1143-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1143-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1143-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1143-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1143-11" title="11"></a>
<a class="sourceLine" id="cb1143-12" title="12"><span class="kw">def</span> eigen(M):</a>
<a class="sourceLine" id="cb1143-13" title="13">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1143-14" title="14"><span class="co">    Return eigenvalues and eigenvectors for a square matrix M</span></a>
<a class="sourceLine" id="cb1143-15" title="15"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1143-16" title="16">    <span class="cf">return</span> np.linalg.eig(M)</a>
<a class="sourceLine" id="cb1143-17" title="17"></a>
<a class="sourceLine" id="cb1143-18" title="18"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1143-19" title="19"></a>
<a class="sourceLine" id="cb1143-20" title="20">np.random.seed(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb1143-21" title="21">M <span class="op">=</span> np.random.random((<span class="dv">5</span>,<span class="dv">5</span>))</a>
<a class="sourceLine" id="cb1143-22" title="22">w, v <span class="op">=</span> np.linalg.eig(M)</a>
<a class="sourceLine" id="cb1143-23" title="23">w1, v1 <span class="op">=</span> eigen(M)</a>
<a class="sourceLine" id="cb1143-24" title="24">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.allclose(w, w1) <span class="kw">and</span> np.allclose(v,v1) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>element_mass</summary></p>
<h4 id="query-104">Query</h4>
<div class="sourceCode" id="cb1145"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1145-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb1145-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb1145-3" title="3"></a>
<a class="sourceLine" id="cb1145-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1145-5" title="5"><span class="co">compute sin(pi/2)</span></a>
<a class="sourceLine" id="cb1145-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1145-7" title="7">x <span class="op">=</span> math.sin(math.pi <span class="op">/</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1145-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1145-9" title="9"></a>
<a class="sourceLine" id="cb1145-10" title="10"><span class="kw">def</span> element_mass(element_symbol):</a>
<a class="sourceLine" id="cb1145-11" title="11">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1145-12" title="12"><span class="co">   This function returns the mass of the chemical element given by its symbol</span></a>
<a class="sourceLine" id="cb1145-13" title="13"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1145-14" title="14">   <span class="im">import</span> mendeleev</a>
<a class="sourceLine" id="cb1145-15" title="15">   </a></code></pre></div>
<h4 id="run-0-104">Run 0</h4>
<div class="sourceCode" id="cb1146"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1146-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb1146-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb1146-3" title="3"></a>
<a class="sourceLine" id="cb1146-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1146-5" title="5"><span class="co">compute sin(pi/2)</span></a>
<a class="sourceLine" id="cb1146-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1146-7" title="7">x <span class="op">=</span> math.sin(math.pi <span class="op">/</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1146-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1146-9" title="9"></a>
<a class="sourceLine" id="cb1146-10" title="10"><span class="kw">def</span> element_mass(element_symbol):</a>
<a class="sourceLine" id="cb1146-11" title="11">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1146-12" title="12"><span class="co">   This function returns the mass of the chemical element given by its symbol</span></a>
<a class="sourceLine" id="cb1146-13" title="13"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1146-14" title="14">   <span class="im">import</span> mendeleev</a>
<a class="sourceLine" id="cb1146-15" title="15">   element <span class="op">=</span> mendeleev.element(element_symbol)</a>
<a class="sourceLine" id="cb1146-16" title="16">   <span class="cf">return</span> element.mass</a>
<a class="sourceLine" id="cb1146-17" title="17"></a>
<a class="sourceLine" id="cb1146-18" title="18"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1146-19" title="19">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">abs</span>(element_mass(<span class="st">&quot;U&quot;</span>)<span class="op">-</span><span class="fl">238.03</span>)<span class="op">&lt;</span><span class="fl">0.01</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-104">Run 1</h4>
<div class="sourceCode" id="cb1148"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1148-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb1148-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb1148-3" title="3"></a>
<a class="sourceLine" id="cb1148-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1148-5" title="5"><span class="co">compute sin(pi/2)</span></a>
<a class="sourceLine" id="cb1148-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1148-7" title="7">x <span class="op">=</span> math.sin(math.pi <span class="op">/</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1148-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1148-9" title="9"></a>
<a class="sourceLine" id="cb1148-10" title="10"><span class="kw">def</span> element_mass(element_symbol):</a>
<a class="sourceLine" id="cb1148-11" title="11">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1148-12" title="12"><span class="co">   This function returns the mass of the chemical element given by its symbol</span></a>
<a class="sourceLine" id="cb1148-13" title="13"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1148-14" title="14">   <span class="im">import</span> mendeleev</a>
<a class="sourceLine" id="cb1148-15" title="15">   <span class="cf">return</span> mendeleev.element(element_symbol).mass</a>
<a class="sourceLine" id="cb1148-16" title="16"></a>
<a class="sourceLine" id="cb1148-17" title="17"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1148-18" title="18">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">abs</span>(element_mass(<span class="st">&quot;U&quot;</span>)<span class="op">-</span><span class="fl">238.03</span>)<span class="op">&lt;</span><span class="fl">0.01</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-104">Run 2</h4>
<div class="sourceCode" id="cb1150"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1150-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb1150-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb1150-3" title="3"></a>
<a class="sourceLine" id="cb1150-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1150-5" title="5"><span class="co">compute sin(pi/2)</span></a>
<a class="sourceLine" id="cb1150-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1150-7" title="7">x <span class="op">=</span> math.sin(math.pi <span class="op">/</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1150-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1150-9" title="9"></a>
<a class="sourceLine" id="cb1150-10" title="10"><span class="kw">def</span> element_mass(element_symbol):</a>
<a class="sourceLine" id="cb1150-11" title="11">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1150-12" title="12"><span class="co">   This function returns the mass of the chemical element given by its symbol</span></a>
<a class="sourceLine" id="cb1150-13" title="13"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1150-14" title="14">   <span class="im">import</span> mendeleev</a>
<a class="sourceLine" id="cb1150-15" title="15">   <span class="cf">return</span> mendeleev.element(element_symbol).mass</a>
<a class="sourceLine" id="cb1150-16" title="16"></a>
<a class="sourceLine" id="cb1150-17" title="17"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1150-18" title="18">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">abs</span>(element_mass(<span class="st">&quot;U&quot;</span>)<span class="op">-</span><span class="fl">238.03</span>)<span class="op">&lt;</span><span class="fl">0.01</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-104">Run 3</h4>
<div class="sourceCode" id="cb1152"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1152-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb1152-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb1152-3" title="3"></a>
<a class="sourceLine" id="cb1152-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1152-5" title="5"><span class="co">compute sin(pi/2)</span></a>
<a class="sourceLine" id="cb1152-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1152-7" title="7">x <span class="op">=</span> math.sin(math.pi <span class="op">/</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1152-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1152-9" title="9"></a>
<a class="sourceLine" id="cb1152-10" title="10"><span class="kw">def</span> element_mass(element_symbol):</a>
<a class="sourceLine" id="cb1152-11" title="11">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1152-12" title="12"><span class="co">   This function returns the mass of the chemical element given by its symbol</span></a>
<a class="sourceLine" id="cb1152-13" title="13"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1152-14" title="14">   <span class="im">import</span> mendeleev</a>
<a class="sourceLine" id="cb1152-15" title="15">   <span class="cf">return</span> mendeleev.element(element_symbol).mass</a>
<a class="sourceLine" id="cb1152-16" title="16"></a>
<a class="sourceLine" id="cb1152-17" title="17"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1152-18" title="18">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">abs</span>(element_mass(<span class="st">&quot;U&quot;</span>)<span class="op">-</span><span class="fl">238.03</span>)<span class="op">&lt;</span><span class="fl">0.01</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-104">Run 4</h4>
<div class="sourceCode" id="cb1154"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1154-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb1154-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb1154-3" title="3"></a>
<a class="sourceLine" id="cb1154-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1154-5" title="5"><span class="co">compute sin(pi/2)</span></a>
<a class="sourceLine" id="cb1154-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1154-7" title="7">x <span class="op">=</span> math.sin(math.pi <span class="op">/</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1154-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1154-9" title="9"></a>
<a class="sourceLine" id="cb1154-10" title="10"><span class="kw">def</span> element_mass(element_symbol):</a>
<a class="sourceLine" id="cb1154-11" title="11">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1154-12" title="12"><span class="co">   This function returns the mass of the chemical element given by its symbol</span></a>
<a class="sourceLine" id="cb1154-13" title="13"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1154-14" title="14">   <span class="im">import</span> mendeleev</a>
<a class="sourceLine" id="cb1154-15" title="15">   element <span class="op">=</span> mendeleev.element(element_symbol)</a>
<a class="sourceLine" id="cb1154-16" title="16">   <span class="cf">return</span> element.mass</a>
<a class="sourceLine" id="cb1154-17" title="17"></a>
<a class="sourceLine" id="cb1154-18" title="18"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1154-19" title="19">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">abs</span>(element_mass(<span class="st">&quot;U&quot;</span>)<span class="op">-</span><span class="fl">238.03</span>)<span class="op">&lt;</span><span class="fl">0.01</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>element_name</summary></p>
<h4 id="query-105">Query</h4>
<div class="sourceCode" id="cb1156"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1156-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb1156-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb1156-3" title="3"></a>
<a class="sourceLine" id="cb1156-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1156-5" title="5"><span class="co">compute sin(pi/2)</span></a>
<a class="sourceLine" id="cb1156-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1156-7" title="7">x <span class="op">=</span> math.sin(math.pi <span class="op">/</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1156-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1156-9" title="9"></a>
<a class="sourceLine" id="cb1156-10" title="10"><span class="kw">def</span> symbol(element_number):</a>
<a class="sourceLine" id="cb1156-11" title="11">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1156-12" title="12"><span class="co">  This function returns the two letter symbol for the chemical element given by element_number</span></a>
<a class="sourceLine" id="cb1156-13" title="13"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1156-14" title="14">  <span class="im">import</span> mendeleev</a>
<a class="sourceLine" id="cb1156-15" title="15">  </a></code></pre></div>
<h4 id="run-0-105">Run 0</h4>
<div class="sourceCode" id="cb1157"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1157-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb1157-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb1157-3" title="3"></a>
<a class="sourceLine" id="cb1157-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1157-5" title="5"><span class="co">compute sin(pi/2)</span></a>
<a class="sourceLine" id="cb1157-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1157-7" title="7">x <span class="op">=</span> math.sin(math.pi <span class="op">/</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1157-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1157-9" title="9"></a>
<a class="sourceLine" id="cb1157-10" title="10"><span class="kw">def</span> symbol(element_number):</a>
<a class="sourceLine" id="cb1157-11" title="11">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1157-12" title="12"><span class="co">  This function returns the two letter symbol for the chemical element given by element_number</span></a>
<a class="sourceLine" id="cb1157-13" title="13"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1157-14" title="14">  <span class="im">import</span> mendeleev</a>
<a class="sourceLine" id="cb1157-15" title="15">  element <span class="op">=</span> mendeleev.element(element_number)</a>
<a class="sourceLine" id="cb1157-16" title="16">  <span class="cf">return</span> element.symbol</a>
<a class="sourceLine" id="cb1157-17" title="17"></a>
<a class="sourceLine" id="cb1157-18" title="18">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> symbol(<span class="dv">26</span>).lower()<span class="op">==</span><span class="st">&quot;fe&quot;</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-105">Run 1</h4>
<div class="sourceCode" id="cb1159"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1159-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb1159-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb1159-3" title="3"></a>
<a class="sourceLine" id="cb1159-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1159-5" title="5"><span class="co">compute sin(pi/2)</span></a>
<a class="sourceLine" id="cb1159-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1159-7" title="7">x <span class="op">=</span> math.sin(math.pi <span class="op">/</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1159-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1159-9" title="9"></a>
<a class="sourceLine" id="cb1159-10" title="10"><span class="kw">def</span> symbol(element_number):</a>
<a class="sourceLine" id="cb1159-11" title="11">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1159-12" title="12"><span class="co">  This function returns the two letter symbol for the chemical element given by element_number</span></a>
<a class="sourceLine" id="cb1159-13" title="13"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1159-14" title="14">  <span class="im">import</span> mendeleev</a>
<a class="sourceLine" id="cb1159-15" title="15">  <span class="cf">return</span> mendeleev.element(element_number).symbol</a>
<a class="sourceLine" id="cb1159-16" title="16"></a>
<a class="sourceLine" id="cb1159-17" title="17">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> symbol(<span class="dv">26</span>).lower()<span class="op">==</span><span class="st">&quot;fe&quot;</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-105">Run 2</h4>
<div class="sourceCode" id="cb1161"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1161-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb1161-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb1161-3" title="3"></a>
<a class="sourceLine" id="cb1161-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1161-5" title="5"><span class="co">compute sin(pi/2)</span></a>
<a class="sourceLine" id="cb1161-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1161-7" title="7">x <span class="op">=</span> math.sin(math.pi <span class="op">/</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1161-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1161-9" title="9"></a>
<a class="sourceLine" id="cb1161-10" title="10"><span class="kw">def</span> symbol(element_number):</a>
<a class="sourceLine" id="cb1161-11" title="11">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1161-12" title="12"><span class="co">  This function returns the two letter symbol for the chemical element given by element_number</span></a>
<a class="sourceLine" id="cb1161-13" title="13"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1161-14" title="14">  <span class="im">import</span> mendeleev</a>
<a class="sourceLine" id="cb1161-15" title="15">  <span class="cf">return</span> mendeleev.element(element_number).symbol</a>
<a class="sourceLine" id="cb1161-16" title="16"></a>
<a class="sourceLine" id="cb1161-17" title="17">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> symbol(<span class="dv">26</span>).lower()<span class="op">==</span><span class="st">&quot;fe&quot;</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-105">Run 3</h4>
<div class="sourceCode" id="cb1163"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1163-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb1163-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb1163-3" title="3"></a>
<a class="sourceLine" id="cb1163-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1163-5" title="5"><span class="co">compute sin(pi/2)</span></a>
<a class="sourceLine" id="cb1163-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1163-7" title="7">x <span class="op">=</span> math.sin(math.pi <span class="op">/</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1163-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1163-9" title="9"></a>
<a class="sourceLine" id="cb1163-10" title="10"><span class="kw">def</span> symbol(element_number):</a>
<a class="sourceLine" id="cb1163-11" title="11">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1163-12" title="12"><span class="co">  This function returns the two letter symbol for the chemical element given by element_number</span></a>
<a class="sourceLine" id="cb1163-13" title="13"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1163-14" title="14">  <span class="im">import</span> mendeleev</a>
<a class="sourceLine" id="cb1163-15" title="15">  <span class="cf">return</span> mendeleev.element(element_number).symbol</a>
<a class="sourceLine" id="cb1163-16" title="16"></a>
<a class="sourceLine" id="cb1163-17" title="17">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> symbol(<span class="dv">26</span>).lower()<span class="op">==</span><span class="st">&quot;fe&quot;</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-105">Run 4</h4>
<div class="sourceCode" id="cb1165"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1165-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb1165-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb1165-3" title="3"></a>
<a class="sourceLine" id="cb1165-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1165-5" title="5"><span class="co">compute sin(pi/2)</span></a>
<a class="sourceLine" id="cb1165-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1165-7" title="7">x <span class="op">=</span> math.sin(math.pi <span class="op">/</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1165-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1165-9" title="9"></a>
<a class="sourceLine" id="cb1165-10" title="10"><span class="kw">def</span> symbol(element_number):</a>
<a class="sourceLine" id="cb1165-11" title="11">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1165-12" title="12"><span class="co">  This function returns the two letter symbol for the chemical element given by element_number</span></a>
<a class="sourceLine" id="cb1165-13" title="13"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1165-14" title="14">  <span class="im">import</span> mendeleev</a>
<a class="sourceLine" id="cb1165-15" title="15">  <span class="cf">return</span> mendeleev.element(element_number).symbol</a>
<a class="sourceLine" id="cb1165-16" title="16"></a>
<a class="sourceLine" id="cb1165-17" title="17">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> symbol(<span class="dv">26</span>).lower()<span class="op">==</span><span class="st">&quot;fe&quot;</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>energy_of_e</summary></p>
<h4 id="query-106">Query</h4>
<div class="sourceCode" id="cb1167"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1167-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb1167-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb1167-3" title="3"></a>
<a class="sourceLine" id="cb1167-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1167-5" title="5"><span class="co">compute sin(pi/2)</span></a>
<a class="sourceLine" id="cb1167-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1167-7" title="7">x <span class="op">=</span> math.sin(math.pi <span class="op">/</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1167-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1167-9" title="9"></a>
<a class="sourceLine" id="cb1167-10" title="10"><span class="kw">def</span> energy_of_e(n):</a>
<a class="sourceLine" id="cb1167-11" title="11">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1167-12" title="12"><span class="co">    This function calculates the energy in electron Volts of an electron in state n in a hydrogen atom</span></a>
<a class="sourceLine" id="cb1167-13" title="13"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1167-14" title="14">    </a></code></pre></div>
<h4 id="run-0-106">Run 0</h4>
<div class="sourceCode" id="cb1168"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1168-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb1168-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb1168-3" title="3"></a>
<a class="sourceLine" id="cb1168-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1168-5" title="5"><span class="co">compute sin(pi/2)</span></a>
<a class="sourceLine" id="cb1168-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1168-7" title="7">x <span class="op">=</span> math.sin(math.pi <span class="op">/</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1168-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1168-9" title="9"></a>
<a class="sourceLine" id="cb1168-10" title="10"><span class="kw">def</span> energy_of_e(n):</a>
<a class="sourceLine" id="cb1168-11" title="11">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1168-12" title="12"><span class="co">    This function calculates the energy in electron Volts of an electron in state n in a hydrogen atom</span></a>
<a class="sourceLine" id="cb1168-13" title="13"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1168-14" title="14">    <span class="co"># start</span></a>
<a class="sourceLine" id="cb1168-15" title="15">    energy <span class="op">=</span> <span class="fl">-13.6</span> <span class="op">*</span> (<span class="dv">1</span> <span class="op">/</span> (n <span class="op">**</span> <span class="dv">2</span>))</a>
<a class="sourceLine" id="cb1168-16" title="16">    </a>
<a class="sourceLine" id="cb1168-17" title="17"></a>
<a class="sourceLine" id="cb1168-18" title="18"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb1168-19" title="19">Rh <span class="op">=</span> <span class="fl">13.60648962</span></a>
<a class="sourceLine" id="cb1168-20" title="20">n <span class="op">=</span> <span class="dv">3</span></a>
<a class="sourceLine" id="cb1168-21" title="21">energy_true <span class="op">=</span> (<span class="op">-</span>Rh<span class="op">/</span>(n<span class="op">**</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb1168-22" title="22">energy_nlcc <span class="op">=</span> energy_of_e(n)</a>
<a class="sourceLine" id="cb1168-23" title="23"></a>
<a class="sourceLine" id="cb1168-24" title="24">result <span class="op">=</span> math.isclose(energy_true, energy_nlcc, rel_tol <span class="op">=</span><span class="fl">1e-3</span>)</a>
<a class="sourceLine" id="cb1168-25" title="25"></a></code></pre></div>
<p>Output:</p>
<pre><code>must be real number, not NoneType</code></pre>
<h4 id="run-1-106">Run 1</h4>
<div class="sourceCode" id="cb1170"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1170-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb1170-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb1170-3" title="3"></a>
<a class="sourceLine" id="cb1170-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1170-5" title="5"><span class="co">compute sin(pi/2)</span></a>
<a class="sourceLine" id="cb1170-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1170-7" title="7">x <span class="op">=</span> math.sin(math.pi <span class="op">/</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1170-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1170-9" title="9"></a>
<a class="sourceLine" id="cb1170-10" title="10"><span class="kw">def</span> energy_of_e(n):</a>
<a class="sourceLine" id="cb1170-11" title="11">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1170-12" title="12"><span class="co">    This function calculates the energy in electron Volts of an electron in state n in a hydrogen atom</span></a>
<a class="sourceLine" id="cb1170-13" title="13"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1170-14" title="14">    <span class="co"># start</span></a>
<a class="sourceLine" id="cb1170-15" title="15">    e <span class="op">=</span> <span class="fl">-13.6</span> <span class="op">*</span> (<span class="dv">1</span> <span class="op">/</span> (n <span class="op">**</span> <span class="dv">2</span>))</a>
<a class="sourceLine" id="cb1170-16" title="16">    </a>
<a class="sourceLine" id="cb1170-17" title="17"></a>
<a class="sourceLine" id="cb1170-18" title="18"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb1170-19" title="19">Rh <span class="op">=</span> <span class="fl">13.60648962</span></a>
<a class="sourceLine" id="cb1170-20" title="20">n <span class="op">=</span> <span class="dv">3</span></a>
<a class="sourceLine" id="cb1170-21" title="21">energy_true <span class="op">=</span> (<span class="op">-</span>Rh<span class="op">/</span>(n<span class="op">**</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb1170-22" title="22">energy_nlcc <span class="op">=</span> energy_of_e(n)</a>
<a class="sourceLine" id="cb1170-23" title="23"></a>
<a class="sourceLine" id="cb1170-24" title="24">result <span class="op">=</span> math.isclose(energy_true, energy_nlcc, rel_tol <span class="op">=</span><span class="fl">1e-3</span>)</a>
<a class="sourceLine" id="cb1170-25" title="25"></a></code></pre></div>
<p>Output:</p>
<pre><code>must be real number, not NoneType</code></pre>
<h4 id="run-2-106">Run 2</h4>
<div class="sourceCode" id="cb1172"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1172-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb1172-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb1172-3" title="3"></a>
<a class="sourceLine" id="cb1172-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1172-5" title="5"><span class="co">compute sin(pi/2)</span></a>
<a class="sourceLine" id="cb1172-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1172-7" title="7">x <span class="op">=</span> math.sin(math.pi <span class="op">/</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1172-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1172-9" title="9"></a>
<a class="sourceLine" id="cb1172-10" title="10"><span class="kw">def</span> energy_of_e(n):</a>
<a class="sourceLine" id="cb1172-11" title="11">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1172-12" title="12"><span class="co">    This function calculates the energy in electron Volts of an electron in state n in a hydrogen atom</span></a>
<a class="sourceLine" id="cb1172-13" title="13"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1172-14" title="14">    R <span class="op">=</span> <span class="fl">1.097e7</span></a>
<a class="sourceLine" id="cb1172-15" title="15">    E <span class="op">=</span> <span class="fl">-13.6</span> <span class="op">/</span> n<span class="op">**</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb1172-16" title="16">    <span class="cf">return</span> E</a>
<a class="sourceLine" id="cb1172-17" title="17"></a>
<a class="sourceLine" id="cb1172-18" title="18"></a>
<a class="sourceLine" id="cb1172-19" title="19"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb1172-20" title="20">Rh <span class="op">=</span> <span class="fl">13.60648962</span></a>
<a class="sourceLine" id="cb1172-21" title="21">n <span class="op">=</span> <span class="dv">3</span></a>
<a class="sourceLine" id="cb1172-22" title="22">energy_true <span class="op">=</span> (<span class="op">-</span>Rh<span class="op">/</span>(n<span class="op">**</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb1172-23" title="23">energy_nlcc <span class="op">=</span> energy_of_e(n)</a>
<a class="sourceLine" id="cb1172-24" title="24"></a>
<a class="sourceLine" id="cb1172-25" title="25">result <span class="op">=</span> math.isclose(energy_true, energy_nlcc, rel_tol <span class="op">=</span><span class="fl">1e-3</span>)</a>
<a class="sourceLine" id="cb1172-26" title="26"></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-106">Run 3</h4>
<div class="sourceCode" id="cb1174"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1174-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb1174-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb1174-3" title="3"></a>
<a class="sourceLine" id="cb1174-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1174-5" title="5"><span class="co">compute sin(pi/2)</span></a>
<a class="sourceLine" id="cb1174-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1174-7" title="7">x <span class="op">=</span> math.sin(math.pi <span class="op">/</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1174-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1174-9" title="9"></a>
<a class="sourceLine" id="cb1174-10" title="10"><span class="kw">def</span> energy_of_e(n):</a>
<a class="sourceLine" id="cb1174-11" title="11">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1174-12" title="12"><span class="co">    This function calculates the energy in electron Volts of an electron in state n in a hydrogen atom</span></a>
<a class="sourceLine" id="cb1174-13" title="13"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1174-14" title="14">    e <span class="op">=</span> <span class="fl">1.60217662</span> <span class="op">*</span> <span class="dv">10</span><span class="op">**-</span><span class="dv">19</span></a>
<a class="sourceLine" id="cb1174-15" title="15">    h <span class="op">=</span> <span class="fl">6.62607004</span> <span class="op">*</span> <span class="dv">10</span><span class="op">**-</span><span class="dv">34</span></a>
<a class="sourceLine" id="cb1174-16" title="16">    m <span class="op">=</span> <span class="fl">9.10938356</span> <span class="op">*</span> <span class="dv">10</span><span class="op">**-</span><span class="dv">31</span></a>
<a class="sourceLine" id="cb1174-17" title="17">    c <span class="op">=</span> <span class="dv">299792458</span></a>
<a class="sourceLine" id="cb1174-18" title="18">    <span class="cf">return</span> <span class="fl">-13.6</span> <span class="op">*</span> e <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> <span class="dv">1</span> <span class="op">/</span> n<span class="op">**</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1174-19" title="19"></a>
<a class="sourceLine" id="cb1174-20" title="20"></a>
<a class="sourceLine" id="cb1174-21" title="21"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb1174-22" title="22">Rh <span class="op">=</span> <span class="fl">13.60648962</span></a>
<a class="sourceLine" id="cb1174-23" title="23">n <span class="op">=</span> <span class="dv">3</span></a>
<a class="sourceLine" id="cb1174-24" title="24">energy_true <span class="op">=</span> (<span class="op">-</span>Rh<span class="op">/</span>(n<span class="op">**</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb1174-25" title="25">energy_nlcc <span class="op">=</span> energy_of_e(n)</a>
<a class="sourceLine" id="cb1174-26" title="26"></a>
<a class="sourceLine" id="cb1174-27" title="27">result <span class="op">=</span> math.isclose(energy_true, energy_nlcc, rel_tol <span class="op">=</span><span class="fl">1e-3</span>)</a>
<a class="sourceLine" id="cb1174-28" title="28"></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-106">Run 4</h4>
<div class="sourceCode" id="cb1176"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1176-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb1176-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb1176-3" title="3"></a>
<a class="sourceLine" id="cb1176-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1176-5" title="5"><span class="co">compute sin(pi/2)</span></a>
<a class="sourceLine" id="cb1176-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1176-7" title="7">x <span class="op">=</span> math.sin(math.pi <span class="op">/</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1176-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1176-9" title="9"></a>
<a class="sourceLine" id="cb1176-10" title="10"><span class="kw">def</span> energy_of_e(n):</a>
<a class="sourceLine" id="cb1176-11" title="11">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1176-12" title="12"><span class="co">    This function calculates the energy in electron Volts of an electron in state n in a hydrogen atom</span></a>
<a class="sourceLine" id="cb1176-13" title="13"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1176-14" title="14">    <span class="co"># start</span></a>
<a class="sourceLine" id="cb1176-15" title="15">    energy <span class="op">=</span> <span class="fl">-13.6</span> <span class="op">/</span> n<span class="op">**</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb1176-16" title="16">    </a>
<a class="sourceLine" id="cb1176-17" title="17"></a>
<a class="sourceLine" id="cb1176-18" title="18"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb1176-19" title="19">Rh <span class="op">=</span> <span class="fl">13.60648962</span></a>
<a class="sourceLine" id="cb1176-20" title="20">n <span class="op">=</span> <span class="dv">3</span></a>
<a class="sourceLine" id="cb1176-21" title="21">energy_true <span class="op">=</span> (<span class="op">-</span>Rh<span class="op">/</span>(n<span class="op">**</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb1176-22" title="22">energy_nlcc <span class="op">=</span> energy_of_e(n)</a>
<a class="sourceLine" id="cb1176-23" title="23"></a>
<a class="sourceLine" id="cb1176-24" title="24">result <span class="op">=</span> math.isclose(energy_true, energy_nlcc, rel_tol <span class="op">=</span><span class="fl">1e-3</span>)</a>
<a class="sourceLine" id="cb1176-25" title="25"></a></code></pre></div>
<p>Output:</p>
<pre><code>must be real number, not NoneType</code></pre>
</details>
<details>
<p><summary>find_indices</summary></p>
<h4 id="query-107">Query</h4>
<div class="sourceCode" id="cb1178"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1178-1" title="1"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb1178-2" title="2"></a>
<a class="sourceLine" id="cb1178-3" title="3"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1178-4" title="4"><span class="co">Print version string</span></a>
<a class="sourceLine" id="cb1178-5" title="5"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1178-6" title="6"><span class="bu">print</span>(md.version.full_version)</a>
<a class="sourceLine" id="cb1178-7" title="7"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1178-8" title="8"></a>
<a class="sourceLine" id="cb1178-9" title="9"><span class="kw">def</span> get_ca_indices(pdb_file):</a>
<a class="sourceLine" id="cb1178-10" title="10">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1178-11" title="11"><span class="co">  This function uploads a pdb file and find out the indices of first two alpha carbon atoms.</span></a>
<a class="sourceLine" id="cb1178-12" title="12"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1178-13" title="13">  </a></code></pre></div>
<h4 id="run-0-107">Run 0</h4>
<div class="sourceCode" id="cb1179"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1179-1" title="1"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb1179-2" title="2"></a>
<a class="sourceLine" id="cb1179-3" title="3"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1179-4" title="4"><span class="co">Print version string</span></a>
<a class="sourceLine" id="cb1179-5" title="5"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1179-6" title="6"><span class="bu">print</span>(md.version.full_version)</a>
<a class="sourceLine" id="cb1179-7" title="7"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1179-8" title="8"></a>
<a class="sourceLine" id="cb1179-9" title="9"><span class="kw">def</span> get_ca_indices(pdb_file):</a>
<a class="sourceLine" id="cb1179-10" title="10">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1179-11" title="11"><span class="co">  This function uploads a pdb file and find out the indices of first two alpha carbon atoms.</span></a>
<a class="sourceLine" id="cb1179-12" title="12"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1179-13" title="13">  <span class="co"># Load the pdb file</span></a>
<a class="sourceLine" id="cb1179-14" title="14">  traj <span class="op">=</span> md.load(pdb_file)</a>
<a class="sourceLine" id="cb1179-15" title="15">  <span class="co"># Get the indices of alpha carbon atoms</span></a>
<a class="sourceLine" id="cb1179-16" title="16">  ca_indices <span class="op">=</span> traj.topology.select(<span class="st">&#39;name CA&#39;</span>)</a>
<a class="sourceLine" id="cb1179-17" title="17">  <span class="co"># Return the indices</span></a>
<a class="sourceLine" id="cb1179-18" title="18">  <span class="cf">return</span> ca_indices</a>
<a class="sourceLine" id="cb1179-19" title="19"></a>
<a class="sourceLine" id="cb1179-20" title="20"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb1179-21" title="21"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1179-22" title="22"></a>
<a class="sourceLine" id="cb1179-23" title="23">pdb_file <span class="op">=</span> os.path.join(_FILE_DIR_,<span class="st">&quot;1l2y.pdb&quot;</span>)</a>
<a class="sourceLine" id="cb1179-24" title="24"></a>
<a class="sourceLine" id="cb1179-25" title="25"><span class="kw">def</span> get_pair_indices(pdb_file):</a>
<a class="sourceLine" id="cb1179-26" title="26">    <span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb1179-27" title="27">    pdb <span class="op">=</span> md.load(pdb_file)</a>
<a class="sourceLine" id="cb1179-28" title="28">    top <span class="op">=</span> pdb.topology</a>
<a class="sourceLine" id="cb1179-29" title="29">    CAs <span class="op">=</span> [atom.index <span class="cf">for</span> atom <span class="kw">in</span> top.atoms <span class="cf">if</span> atom.name <span class="op">==</span> <span class="st">&#39;CA&#39;</span>]</a>
<a class="sourceLine" id="cb1179-30" title="30">    indices_pair <span class="op">=</span> np.array([CAs[<span class="dv">0</span>], CAs[<span class="dv">1</span>]])</a>
<a class="sourceLine" id="cb1179-31" title="31">    <span class="cf">return</span> indices_pair</a>
<a class="sourceLine" id="cb1179-32" title="32"></a>
<a class="sourceLine" id="cb1179-33" title="33">my_indices_pair <span class="op">=</span> get_pair_indices(pdb_file)</a>
<a class="sourceLine" id="cb1179-34" title="34">prompt_indices_pair <span class="op">=</span> get_ca_indices(pdb_file)</a>
<a class="sourceLine" id="cb1179-35" title="35"></a>
<a class="sourceLine" id="cb1179-36" title="36">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">all</span>(my_indices_pair <span class="op">==</span> prompt_indices_pair) <span class="cf">else</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb1179-37" title="37"></a>
<a class="sourceLine" id="cb1179-38" title="38"></a></code></pre></div>
<p>Output:</p>
<pre><code>&#39;Constant&#39; object has no attribute &#39;kind&#39;</code></pre>
<h4 id="run-1-107">Run 1</h4>
<div class="sourceCode" id="cb1181"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1181-1" title="1"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb1181-2" title="2"></a>
<a class="sourceLine" id="cb1181-3" title="3"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1181-4" title="4"><span class="co">Print version string</span></a>
<a class="sourceLine" id="cb1181-5" title="5"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1181-6" title="6"><span class="bu">print</span>(md.version.full_version)</a>
<a class="sourceLine" id="cb1181-7" title="7"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1181-8" title="8"></a>
<a class="sourceLine" id="cb1181-9" title="9"><span class="kw">def</span> get_ca_indices(pdb_file):</a>
<a class="sourceLine" id="cb1181-10" title="10">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1181-11" title="11"><span class="co">  This function uploads a pdb file and find out the indices of first two alpha carbon atoms.</span></a>
<a class="sourceLine" id="cb1181-12" title="12"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1181-13" title="13">  traj <span class="op">=</span> md.load(pdb_file)</a>
<a class="sourceLine" id="cb1181-14" title="14">  topology <span class="op">=</span> traj.topology</a>
<a class="sourceLine" id="cb1181-15" title="15">  ca_indices <span class="op">=</span> topology.select(<span class="st">&#39;name CA&#39;</span>)</a>
<a class="sourceLine" id="cb1181-16" title="16">  <span class="cf">return</span> ca_indices[<span class="dv">0</span>], ca_indices[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb1181-17" title="17"></a>
<a class="sourceLine" id="cb1181-18" title="18"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb1181-19" title="19"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1181-20" title="20"></a>
<a class="sourceLine" id="cb1181-21" title="21">pdb_file <span class="op">=</span> os.path.join(_FILE_DIR_,<span class="st">&quot;1l2y.pdb&quot;</span>)</a>
<a class="sourceLine" id="cb1181-22" title="22"></a>
<a class="sourceLine" id="cb1181-23" title="23"><span class="kw">def</span> get_pair_indices(pdb_file):</a>
<a class="sourceLine" id="cb1181-24" title="24">    <span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb1181-25" title="25">    pdb <span class="op">=</span> md.load(pdb_file)</a>
<a class="sourceLine" id="cb1181-26" title="26">    top <span class="op">=</span> pdb.topology</a>
<a class="sourceLine" id="cb1181-27" title="27">    CAs <span class="op">=</span> [atom.index <span class="cf">for</span> atom <span class="kw">in</span> top.atoms <span class="cf">if</span> atom.name <span class="op">==</span> <span class="st">&#39;CA&#39;</span>]</a>
<a class="sourceLine" id="cb1181-28" title="28">    indices_pair <span class="op">=</span> np.array([CAs[<span class="dv">0</span>], CAs[<span class="dv">1</span>]])</a>
<a class="sourceLine" id="cb1181-29" title="29">    <span class="cf">return</span> indices_pair</a>
<a class="sourceLine" id="cb1181-30" title="30"></a>
<a class="sourceLine" id="cb1181-31" title="31">my_indices_pair <span class="op">=</span> get_pair_indices(pdb_file)</a>
<a class="sourceLine" id="cb1181-32" title="32">prompt_indices_pair <span class="op">=</span> get_ca_indices(pdb_file)</a>
<a class="sourceLine" id="cb1181-33" title="33"></a>
<a class="sourceLine" id="cb1181-34" title="34">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">all</span>(my_indices_pair <span class="op">==</span> prompt_indices_pair) <span class="cf">else</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb1181-35" title="35"></a>
<a class="sourceLine" id="cb1181-36" title="36"></a></code></pre></div>
<p>Output:</p>
<pre><code>&#39;Constant&#39; object has no attribute &#39;kind&#39;</code></pre>
<h4 id="run-2-107">Run 2</h4>
<div class="sourceCode" id="cb1183"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1183-1" title="1"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb1183-2" title="2"></a>
<a class="sourceLine" id="cb1183-3" title="3"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1183-4" title="4"><span class="co">Print version string</span></a>
<a class="sourceLine" id="cb1183-5" title="5"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1183-6" title="6"><span class="bu">print</span>(md.version.full_version)</a>
<a class="sourceLine" id="cb1183-7" title="7"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1183-8" title="8"></a>
<a class="sourceLine" id="cb1183-9" title="9"><span class="kw">def</span> get_ca_indices(pdb_file):</a>
<a class="sourceLine" id="cb1183-10" title="10">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1183-11" title="11"><span class="co">  This function uploads a pdb file and find out the indices of first two alpha carbon atoms.</span></a>
<a class="sourceLine" id="cb1183-12" title="12"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1183-13" title="13">  <span class="co"># load pdb file</span></a>
<a class="sourceLine" id="cb1183-14" title="14">  traj <span class="op">=</span> md.load(pdb_file)</a>
<a class="sourceLine" id="cb1183-15" title="15">  <span class="co"># get the indices of first two alpha carbon atoms</span></a>
<a class="sourceLine" id="cb1183-16" title="16">  ca_indices <span class="op">=</span> [a.index <span class="cf">for</span> a <span class="kw">in</span> traj.topology.atoms <span class="cf">if</span> a.name <span class="op">==</span> <span class="st">&#39;CA&#39;</span>][:<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb1183-17" title="17">  <span class="cf">return</span> ca_indices</a>
<a class="sourceLine" id="cb1183-18" title="18"></a>
<a class="sourceLine" id="cb1183-19" title="19"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb1183-20" title="20"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1183-21" title="21"></a>
<a class="sourceLine" id="cb1183-22" title="22">pdb_file <span class="op">=</span> os.path.join(_FILE_DIR_,<span class="st">&quot;1l2y.pdb&quot;</span>)</a>
<a class="sourceLine" id="cb1183-23" title="23"></a>
<a class="sourceLine" id="cb1183-24" title="24"><span class="kw">def</span> get_pair_indices(pdb_file):</a>
<a class="sourceLine" id="cb1183-25" title="25">    <span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb1183-26" title="26">    pdb <span class="op">=</span> md.load(pdb_file)</a>
<a class="sourceLine" id="cb1183-27" title="27">    top <span class="op">=</span> pdb.topology</a>
<a class="sourceLine" id="cb1183-28" title="28">    CAs <span class="op">=</span> [atom.index <span class="cf">for</span> atom <span class="kw">in</span> top.atoms <span class="cf">if</span> atom.name <span class="op">==</span> <span class="st">&#39;CA&#39;</span>]</a>
<a class="sourceLine" id="cb1183-29" title="29">    indices_pair <span class="op">=</span> np.array([CAs[<span class="dv">0</span>], CAs[<span class="dv">1</span>]])</a>
<a class="sourceLine" id="cb1183-30" title="30">    <span class="cf">return</span> indices_pair</a>
<a class="sourceLine" id="cb1183-31" title="31"></a>
<a class="sourceLine" id="cb1183-32" title="32">my_indices_pair <span class="op">=</span> get_pair_indices(pdb_file)</a>
<a class="sourceLine" id="cb1183-33" title="33">prompt_indices_pair <span class="op">=</span> get_ca_indices(pdb_file)</a>
<a class="sourceLine" id="cb1183-34" title="34"></a>
<a class="sourceLine" id="cb1183-35" title="35">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">all</span>(my_indices_pair <span class="op">==</span> prompt_indices_pair) <span class="cf">else</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb1183-36" title="36"></a>
<a class="sourceLine" id="cb1183-37" title="37"></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-107">Run 3</h4>
<div class="sourceCode" id="cb1185"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1185-1" title="1"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb1185-2" title="2"></a>
<a class="sourceLine" id="cb1185-3" title="3"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1185-4" title="4"><span class="co">Print version string</span></a>
<a class="sourceLine" id="cb1185-5" title="5"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1185-6" title="6"><span class="bu">print</span>(md.version.full_version)</a>
<a class="sourceLine" id="cb1185-7" title="7"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1185-8" title="8"></a>
<a class="sourceLine" id="cb1185-9" title="9"><span class="kw">def</span> get_ca_indices(pdb_file):</a>
<a class="sourceLine" id="cb1185-10" title="10">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1185-11" title="11"><span class="co">  This function uploads a pdb file and find out the indices of first two alpha carbon atoms.</span></a>
<a class="sourceLine" id="cb1185-12" title="12"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1185-13" title="13">  traj <span class="op">=</span> md.load(pdb_file)</a>
<a class="sourceLine" id="cb1185-14" title="14">  topology <span class="op">=</span> traj.topology</a>
<a class="sourceLine" id="cb1185-15" title="15">  ca_indices <span class="op">=</span> []</a>
<a class="sourceLine" id="cb1185-16" title="16">  <span class="cf">for</span> residue <span class="kw">in</span> topology.residues:</a>
<a class="sourceLine" id="cb1185-17" title="17">    <span class="cf">if</span> residue.name <span class="op">==</span> <span class="st">&#39;ALA&#39;</span>:</a>
<a class="sourceLine" id="cb1185-18" title="18">      <span class="cf">for</span> atom <span class="kw">in</span> residue.atoms:</a>
<a class="sourceLine" id="cb1185-19" title="19">        <span class="cf">if</span> atom.name <span class="op">==</span> <span class="st">&#39;CA&#39;</span>:</a>
<a class="sourceLine" id="cb1185-20" title="20">          ca_indices.append(atom.index)</a>
<a class="sourceLine" id="cb1185-21" title="21">  <span class="cf">return</span> ca_indices</a>
<a class="sourceLine" id="cb1185-22" title="22"></a>
<a class="sourceLine" id="cb1185-23" title="23"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb1185-24" title="24"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1185-25" title="25"></a>
<a class="sourceLine" id="cb1185-26" title="26">pdb_file <span class="op">=</span> os.path.join(_FILE_DIR_,<span class="st">&quot;1l2y.pdb&quot;</span>)</a>
<a class="sourceLine" id="cb1185-27" title="27"></a>
<a class="sourceLine" id="cb1185-28" title="28"><span class="kw">def</span> get_pair_indices(pdb_file):</a>
<a class="sourceLine" id="cb1185-29" title="29">    <span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb1185-30" title="30">    pdb <span class="op">=</span> md.load(pdb_file)</a>
<a class="sourceLine" id="cb1185-31" title="31">    top <span class="op">=</span> pdb.topology</a>
<a class="sourceLine" id="cb1185-32" title="32">    CAs <span class="op">=</span> [atom.index <span class="cf">for</span> atom <span class="kw">in</span> top.atoms <span class="cf">if</span> atom.name <span class="op">==</span> <span class="st">&#39;CA&#39;</span>]</a>
<a class="sourceLine" id="cb1185-33" title="33">    indices_pair <span class="op">=</span> np.array([CAs[<span class="dv">0</span>], CAs[<span class="dv">1</span>]])</a>
<a class="sourceLine" id="cb1185-34" title="34">    <span class="cf">return</span> indices_pair</a>
<a class="sourceLine" id="cb1185-35" title="35"></a>
<a class="sourceLine" id="cb1185-36" title="36">my_indices_pair <span class="op">=</span> get_pair_indices(pdb_file)</a>
<a class="sourceLine" id="cb1185-37" title="37">prompt_indices_pair <span class="op">=</span> get_ca_indices(pdb_file)</a>
<a class="sourceLine" id="cb1185-38" title="38"></a>
<a class="sourceLine" id="cb1185-39" title="39">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">all</span>(my_indices_pair <span class="op">==</span> prompt_indices_pair) <span class="cf">else</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb1185-40" title="40"></a>
<a class="sourceLine" id="cb1185-41" title="41"></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-107">Run 4</h4>
<div class="sourceCode" id="cb1187"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1187-1" title="1"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb1187-2" title="2"></a>
<a class="sourceLine" id="cb1187-3" title="3"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1187-4" title="4"><span class="co">Print version string</span></a>
<a class="sourceLine" id="cb1187-5" title="5"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1187-6" title="6"><span class="bu">print</span>(md.version.full_version)</a>
<a class="sourceLine" id="cb1187-7" title="7"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1187-8" title="8"></a>
<a class="sourceLine" id="cb1187-9" title="9"><span class="kw">def</span> get_ca_indices(pdb_file):</a>
<a class="sourceLine" id="cb1187-10" title="10">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1187-11" title="11"><span class="co">  This function uploads a pdb file and find out the indices of first two alpha carbon atoms.</span></a>
<a class="sourceLine" id="cb1187-12" title="12"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1187-13" title="13">  pdb <span class="op">=</span> md.load_pdb(pdb_file)</a>
<a class="sourceLine" id="cb1187-14" title="14">  topology <span class="op">=</span> pdb.topology</a>
<a class="sourceLine" id="cb1187-15" title="15">  atom_indices <span class="op">=</span> topology.select(<span class="st">&#39;name CA&#39;</span>)</a>
<a class="sourceLine" id="cb1187-16" title="16">  <span class="cf">return</span> atom_indices[<span class="dv">0</span>], atom_indices[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb1187-17" title="17"></a>
<a class="sourceLine" id="cb1187-18" title="18"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb1187-19" title="19"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1187-20" title="20"></a>
<a class="sourceLine" id="cb1187-21" title="21">pdb_file <span class="op">=</span> os.path.join(_FILE_DIR_,<span class="st">&quot;1l2y.pdb&quot;</span>)</a>
<a class="sourceLine" id="cb1187-22" title="22"></a>
<a class="sourceLine" id="cb1187-23" title="23"><span class="kw">def</span> get_pair_indices(pdb_file):</a>
<a class="sourceLine" id="cb1187-24" title="24">    <span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb1187-25" title="25">    pdb <span class="op">=</span> md.load(pdb_file)</a>
<a class="sourceLine" id="cb1187-26" title="26">    top <span class="op">=</span> pdb.topology</a>
<a class="sourceLine" id="cb1187-27" title="27">    CAs <span class="op">=</span> [atom.index <span class="cf">for</span> atom <span class="kw">in</span> top.atoms <span class="cf">if</span> atom.name <span class="op">==</span> <span class="st">&#39;CA&#39;</span>]</a>
<a class="sourceLine" id="cb1187-28" title="28">    indices_pair <span class="op">=</span> np.array([CAs[<span class="dv">0</span>], CAs[<span class="dv">1</span>]])</a>
<a class="sourceLine" id="cb1187-29" title="29">    <span class="cf">return</span> indices_pair</a>
<a class="sourceLine" id="cb1187-30" title="30"></a>
<a class="sourceLine" id="cb1187-31" title="31">my_indices_pair <span class="op">=</span> get_pair_indices(pdb_file)</a>
<a class="sourceLine" id="cb1187-32" title="32">prompt_indices_pair <span class="op">=</span> get_ca_indices(pdb_file)</a>
<a class="sourceLine" id="cb1187-33" title="33"></a>
<a class="sourceLine" id="cb1187-34" title="34">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">all</span>(my_indices_pair <span class="op">==</span> prompt_indices_pair) <span class="cf">else</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb1187-35" title="35"></a>
<a class="sourceLine" id="cb1187-36" title="36"></a></code></pre></div>
<p>Output:</p>
<pre><code>&#39;Constant&#39; object has no attribute &#39;kind&#39;</code></pre>
</details>
<details>
<p><summary>force_constant</summary></p>
<h4 id="query-108">Query</h4>
<div class="sourceCode" id="cb1189"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1189-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1189-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1189-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1189-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1189-5" title="5"></a>
<a class="sourceLine" id="cb1189-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1189-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1189-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1189-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1189-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1189-11" title="11"></a>
<a class="sourceLine" id="cb1189-12" title="12"><span class="kw">def</span> compute_k(m1,m2,wave_len):</a>
<a class="sourceLine" id="cb1189-13" title="13">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1189-14" title="14"><span class="co">    Two atom harmonic oscillator.</span></a>
<a class="sourceLine" id="cb1189-15" title="15"><span class="co">    Returns force constant in kg/s**2 units given masses m1,m2 and wave length</span></a>
<a class="sourceLine" id="cb1189-16" title="16"><span class="co">    wave_len. Masses are in kg units and wave length in cm^-1 units. Use reduced mass.</span></a>
<a class="sourceLine" id="cb1189-17" title="17"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1189-18" title="18">    </a></code></pre></div>
<h4 id="run-0-108">Run 0</h4>
<div class="sourceCode" id="cb1190"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1190-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1190-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1190-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1190-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1190-5" title="5"></a>
<a class="sourceLine" id="cb1190-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1190-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1190-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1190-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1190-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1190-11" title="11"></a>
<a class="sourceLine" id="cb1190-12" title="12"><span class="kw">def</span> compute_k(m1,m2,wave_len):</a>
<a class="sourceLine" id="cb1190-13" title="13">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1190-14" title="14"><span class="co">    Two atom harmonic oscillator.</span></a>
<a class="sourceLine" id="cb1190-15" title="15"><span class="co">    Returns force constant in kg/s**2 units given masses m1,m2 and wave length</span></a>
<a class="sourceLine" id="cb1190-16" title="16"><span class="co">    wave_len. Masses are in kg units and wave length in cm^-1 units. Use reduced mass.</span></a>
<a class="sourceLine" id="cb1190-17" title="17"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1190-18" title="18">    <span class="co"># start</span></a>
<a class="sourceLine" id="cb1190-19" title="19">    mu <span class="op">=</span> m1<span class="op">*</span>m2<span class="op">/</span>(m1<span class="op">+</span>m2)</a>
<a class="sourceLine" id="cb1190-20" title="20">    k <span class="op">=</span> (<span class="fl">1.99e-18</span>)<span class="op">*</span>wave_len<span class="op">**</span><span class="dv">2</span><span class="op">/</span>mu</a>
<a class="sourceLine" id="cb1190-21" title="21">    <span class="cf">return</span> k</a>
<a class="sourceLine" id="cb1190-22" title="22">    </a>
<a class="sourceLine" id="cb1190-23" title="23"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1190-24" title="24"></a>
<a class="sourceLine" id="cb1190-25" title="25">m1 <span class="op">=</span> <span class="fl">12.0</span> <span class="co">#amu</span></a>
<a class="sourceLine" id="cb1190-26" title="26">m2 <span class="op">=</span> <span class="fl">16.0</span> <span class="co">#amu</span></a>
<a class="sourceLine" id="cb1190-27" title="27">wave_len <span class="op">=</span> <span class="dv">2100</span> <span class="co">#1/cm</span></a>
<a class="sourceLine" id="cb1190-28" title="28">mass_fac <span class="op">=</span> <span class="fl">1.677e-27</span> <span class="co">#kg/amu</span></a>
<a class="sourceLine" id="cb1190-29" title="29">velocity <span class="op">=</span> <span class="fl">2.99e10</span> <span class="co">#cm/s</span></a>
<a class="sourceLine" id="cb1190-30" title="30">pi <span class="op">=</span> np.pi</a>
<a class="sourceLine" id="cb1190-31" title="31"></a>
<a class="sourceLine" id="cb1190-32" title="32">mu <span class="op">=</span> (m1<span class="op">*</span>m2)<span class="op">/</span>(m1<span class="op">+</span>m2)<span class="op">*</span>mass_fac </a>
<a class="sourceLine" id="cb1190-33" title="33">omega <span class="op">=</span> <span class="dv">2</span><span class="op">*</span>pi<span class="op">*</span>wave_len<span class="op">*</span>velocity </a>
<a class="sourceLine" id="cb1190-34" title="34">force_const <span class="op">=</span> mu<span class="op">*</span>omega<span class="op">**</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb1190-35" title="35"></a>
<a class="sourceLine" id="cb1190-36" title="36">force_const_codex <span class="op">=</span> compute_k(m1,m2,wave_len)</a>
<a class="sourceLine" id="cb1190-37" title="37"></a>
<a class="sourceLine" id="cb1190-38" title="38"><span class="cf">if</span> np.isclose(force_const, force_const_codex) <span class="op">==</span>  <span class="va">True</span>:</a>
<a class="sourceLine" id="cb1190-39" title="39">    result <span class="op">=</span> <span class="va">True</span></a>
<a class="sourceLine" id="cb1190-40" title="40"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb1190-41" title="41">    result <span class="op">=</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-108">Run 1</h4>
<div class="sourceCode" id="cb1192"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1192-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1192-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1192-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1192-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1192-5" title="5"></a>
<a class="sourceLine" id="cb1192-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1192-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1192-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1192-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1192-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1192-11" title="11"></a>
<a class="sourceLine" id="cb1192-12" title="12"><span class="kw">def</span> compute_k(m1,m2,wave_len):</a>
<a class="sourceLine" id="cb1192-13" title="13">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1192-14" title="14"><span class="co">    Two atom harmonic oscillator.</span></a>
<a class="sourceLine" id="cb1192-15" title="15"><span class="co">    Returns force constant in kg/s**2 units given masses m1,m2 and wave length</span></a>
<a class="sourceLine" id="cb1192-16" title="16"><span class="co">    wave_len. Masses are in kg units and wave length in cm^-1 units. Use reduced mass.</span></a>
<a class="sourceLine" id="cb1192-17" title="17"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1192-18" title="18">    <span class="cf">return</span> (<span class="fl">0.5</span><span class="op">*</span>(m1<span class="op">+</span>m2)<span class="op">*</span>(wave_len<span class="op">*</span>(<span class="fl">1.0</span><span class="op">/</span><span class="fl">100.0</span>))<span class="op">**</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1192-19" title="19"></a>
<a class="sourceLine" id="cb1192-20" title="20"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1192-21" title="21"></a>
<a class="sourceLine" id="cb1192-22" title="22">m1 <span class="op">=</span> <span class="fl">12.0</span> <span class="co">#amu</span></a>
<a class="sourceLine" id="cb1192-23" title="23">m2 <span class="op">=</span> <span class="fl">16.0</span> <span class="co">#amu</span></a>
<a class="sourceLine" id="cb1192-24" title="24">wave_len <span class="op">=</span> <span class="dv">2100</span> <span class="co">#1/cm</span></a>
<a class="sourceLine" id="cb1192-25" title="25">mass_fac <span class="op">=</span> <span class="fl">1.677e-27</span> <span class="co">#kg/amu</span></a>
<a class="sourceLine" id="cb1192-26" title="26">velocity <span class="op">=</span> <span class="fl">2.99e10</span> <span class="co">#cm/s</span></a>
<a class="sourceLine" id="cb1192-27" title="27">pi <span class="op">=</span> np.pi</a>
<a class="sourceLine" id="cb1192-28" title="28"></a>
<a class="sourceLine" id="cb1192-29" title="29">mu <span class="op">=</span> (m1<span class="op">*</span>m2)<span class="op">/</span>(m1<span class="op">+</span>m2)<span class="op">*</span>mass_fac </a>
<a class="sourceLine" id="cb1192-30" title="30">omega <span class="op">=</span> <span class="dv">2</span><span class="op">*</span>pi<span class="op">*</span>wave_len<span class="op">*</span>velocity </a>
<a class="sourceLine" id="cb1192-31" title="31">force_const <span class="op">=</span> mu<span class="op">*</span>omega<span class="op">**</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb1192-32" title="32"></a>
<a class="sourceLine" id="cb1192-33" title="33">force_const_codex <span class="op">=</span> compute_k(m1,m2,wave_len)</a>
<a class="sourceLine" id="cb1192-34" title="34"></a>
<a class="sourceLine" id="cb1192-35" title="35"><span class="cf">if</span> np.isclose(force_const, force_const_codex) <span class="op">==</span>  <span class="va">True</span>:</a>
<a class="sourceLine" id="cb1192-36" title="36">    result <span class="op">=</span> <span class="va">True</span></a>
<a class="sourceLine" id="cb1192-37" title="37"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb1192-38" title="38">    result <span class="op">=</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-108">Run 2</h4>
<div class="sourceCode" id="cb1194"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1194-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1194-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1194-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1194-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1194-5" title="5"></a>
<a class="sourceLine" id="cb1194-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1194-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1194-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1194-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1194-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1194-11" title="11"></a>
<a class="sourceLine" id="cb1194-12" title="12"><span class="kw">def</span> compute_k(m1,m2,wave_len):</a>
<a class="sourceLine" id="cb1194-13" title="13">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1194-14" title="14"><span class="co">    Two atom harmonic oscillator.</span></a>
<a class="sourceLine" id="cb1194-15" title="15"><span class="co">    Returns force constant in kg/s**2 units given masses m1,m2 and wave length</span></a>
<a class="sourceLine" id="cb1194-16" title="16"><span class="co">    wave_len. Masses are in kg units and wave length in cm^-1 units. Use reduced mass.</span></a>
<a class="sourceLine" id="cb1194-17" title="17"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1194-18" title="18">    <span class="co"># start</span></a>
<a class="sourceLine" id="cb1194-19" title="19">    <span class="cf">return</span> (<span class="fl">1.0</span><span class="op">/</span>wave_len)<span class="op">*</span>(<span class="fl">1.0</span><span class="op">/</span>wave_len)<span class="op">*</span>(m1<span class="op">*</span>m2)<span class="op">/</span>(m1<span class="op">+</span>m2)</a>
<a class="sourceLine" id="cb1194-20" title="20">    </a>
<a class="sourceLine" id="cb1194-21" title="21"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1194-22" title="22"></a>
<a class="sourceLine" id="cb1194-23" title="23">m1 <span class="op">=</span> <span class="fl">12.0</span> <span class="co">#amu</span></a>
<a class="sourceLine" id="cb1194-24" title="24">m2 <span class="op">=</span> <span class="fl">16.0</span> <span class="co">#amu</span></a>
<a class="sourceLine" id="cb1194-25" title="25">wave_len <span class="op">=</span> <span class="dv">2100</span> <span class="co">#1/cm</span></a>
<a class="sourceLine" id="cb1194-26" title="26">mass_fac <span class="op">=</span> <span class="fl">1.677e-27</span> <span class="co">#kg/amu</span></a>
<a class="sourceLine" id="cb1194-27" title="27">velocity <span class="op">=</span> <span class="fl">2.99e10</span> <span class="co">#cm/s</span></a>
<a class="sourceLine" id="cb1194-28" title="28">pi <span class="op">=</span> np.pi</a>
<a class="sourceLine" id="cb1194-29" title="29"></a>
<a class="sourceLine" id="cb1194-30" title="30">mu <span class="op">=</span> (m1<span class="op">*</span>m2)<span class="op">/</span>(m1<span class="op">+</span>m2)<span class="op">*</span>mass_fac </a>
<a class="sourceLine" id="cb1194-31" title="31">omega <span class="op">=</span> <span class="dv">2</span><span class="op">*</span>pi<span class="op">*</span>wave_len<span class="op">*</span>velocity </a>
<a class="sourceLine" id="cb1194-32" title="32">force_const <span class="op">=</span> mu<span class="op">*</span>omega<span class="op">**</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb1194-33" title="33"></a>
<a class="sourceLine" id="cb1194-34" title="34">force_const_codex <span class="op">=</span> compute_k(m1,m2,wave_len)</a>
<a class="sourceLine" id="cb1194-35" title="35"></a>
<a class="sourceLine" id="cb1194-36" title="36"><span class="cf">if</span> np.isclose(force_const, force_const_codex) <span class="op">==</span>  <span class="va">True</span>:</a>
<a class="sourceLine" id="cb1194-37" title="37">    result <span class="op">=</span> <span class="va">True</span></a>
<a class="sourceLine" id="cb1194-38" title="38"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb1194-39" title="39">    result <span class="op">=</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-108">Run 3</h4>
<div class="sourceCode" id="cb1196"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1196-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1196-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1196-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1196-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1196-5" title="5"></a>
<a class="sourceLine" id="cb1196-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1196-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1196-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1196-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1196-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1196-11" title="11"></a>
<a class="sourceLine" id="cb1196-12" title="12"><span class="kw">def</span> compute_k(m1,m2,wave_len):</a>
<a class="sourceLine" id="cb1196-13" title="13">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1196-14" title="14"><span class="co">    Two atom harmonic oscillator.</span></a>
<a class="sourceLine" id="cb1196-15" title="15"><span class="co">    Returns force constant in kg/s**2 units given masses m1,m2 and wave length</span></a>
<a class="sourceLine" id="cb1196-16" title="16"><span class="co">    wave_len. Masses are in kg units and wave length in cm^-1 units. Use reduced mass.</span></a>
<a class="sourceLine" id="cb1196-17" title="17"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1196-18" title="18">    mu <span class="op">=</span> m1<span class="op">*</span>m2<span class="op">/</span>(m1<span class="op">+</span>m2)</a>
<a class="sourceLine" id="cb1196-19" title="19">    k <span class="op">=</span> <span class="dv">4</span><span class="op">*</span>np.pi<span class="op">**</span><span class="dv">2</span><span class="op">*</span>mu<span class="op">*</span>wave_len<span class="op">**</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb1196-20" title="20">    <span class="cf">return</span> k</a>
<a class="sourceLine" id="cb1196-21" title="21"></a>
<a class="sourceLine" id="cb1196-22" title="22"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1196-23" title="23"></a>
<a class="sourceLine" id="cb1196-24" title="24">m1 <span class="op">=</span> <span class="fl">12.0</span> <span class="co">#amu</span></a>
<a class="sourceLine" id="cb1196-25" title="25">m2 <span class="op">=</span> <span class="fl">16.0</span> <span class="co">#amu</span></a>
<a class="sourceLine" id="cb1196-26" title="26">wave_len <span class="op">=</span> <span class="dv">2100</span> <span class="co">#1/cm</span></a>
<a class="sourceLine" id="cb1196-27" title="27">mass_fac <span class="op">=</span> <span class="fl">1.677e-27</span> <span class="co">#kg/amu</span></a>
<a class="sourceLine" id="cb1196-28" title="28">velocity <span class="op">=</span> <span class="fl">2.99e10</span> <span class="co">#cm/s</span></a>
<a class="sourceLine" id="cb1196-29" title="29">pi <span class="op">=</span> np.pi</a>
<a class="sourceLine" id="cb1196-30" title="30"></a>
<a class="sourceLine" id="cb1196-31" title="31">mu <span class="op">=</span> (m1<span class="op">*</span>m2)<span class="op">/</span>(m1<span class="op">+</span>m2)<span class="op">*</span>mass_fac </a>
<a class="sourceLine" id="cb1196-32" title="32">omega <span class="op">=</span> <span class="dv">2</span><span class="op">*</span>pi<span class="op">*</span>wave_len<span class="op">*</span>velocity </a>
<a class="sourceLine" id="cb1196-33" title="33">force_const <span class="op">=</span> mu<span class="op">*</span>omega<span class="op">**</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb1196-34" title="34"></a>
<a class="sourceLine" id="cb1196-35" title="35">force_const_codex <span class="op">=</span> compute_k(m1,m2,wave_len)</a>
<a class="sourceLine" id="cb1196-36" title="36"></a>
<a class="sourceLine" id="cb1196-37" title="37"><span class="cf">if</span> np.isclose(force_const, force_const_codex) <span class="op">==</span>  <span class="va">True</span>:</a>
<a class="sourceLine" id="cb1196-38" title="38">    result <span class="op">=</span> <span class="va">True</span></a>
<a class="sourceLine" id="cb1196-39" title="39"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb1196-40" title="40">    result <span class="op">=</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-108">Run 4</h4>
<div class="sourceCode" id="cb1198"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1198-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1198-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1198-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1198-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1198-5" title="5"></a>
<a class="sourceLine" id="cb1198-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1198-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1198-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1198-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1198-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1198-11" title="11"></a>
<a class="sourceLine" id="cb1198-12" title="12"><span class="kw">def</span> compute_k(m1,m2,wave_len):</a>
<a class="sourceLine" id="cb1198-13" title="13">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1198-14" title="14"><span class="co">    Two atom harmonic oscillator.</span></a>
<a class="sourceLine" id="cb1198-15" title="15"><span class="co">    Returns force constant in kg/s**2 units given masses m1,m2 and wave length</span></a>
<a class="sourceLine" id="cb1198-16" title="16"><span class="co">    wave_len. Masses are in kg units and wave length in cm^-1 units. Use reduced mass.</span></a>
<a class="sourceLine" id="cb1198-17" title="17"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1198-18" title="18">    <span class="co"># start</span></a>
<a class="sourceLine" id="cb1198-19" title="19">    <span class="cf">return</span> (<span class="fl">1.0</span><span class="op">/</span>wave_len)<span class="op">*</span>(<span class="fl">1.0</span><span class="op">/</span>wave_len)<span class="op">*</span>(m1<span class="op">*</span>m2)<span class="op">/</span>(m1<span class="op">+</span>m2)</a>
<a class="sourceLine" id="cb1198-20" title="20">    </a>
<a class="sourceLine" id="cb1198-21" title="21"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1198-22" title="22"></a>
<a class="sourceLine" id="cb1198-23" title="23">m1 <span class="op">=</span> <span class="fl">12.0</span> <span class="co">#amu</span></a>
<a class="sourceLine" id="cb1198-24" title="24">m2 <span class="op">=</span> <span class="fl">16.0</span> <span class="co">#amu</span></a>
<a class="sourceLine" id="cb1198-25" title="25">wave_len <span class="op">=</span> <span class="dv">2100</span> <span class="co">#1/cm</span></a>
<a class="sourceLine" id="cb1198-26" title="26">mass_fac <span class="op">=</span> <span class="fl">1.677e-27</span> <span class="co">#kg/amu</span></a>
<a class="sourceLine" id="cb1198-27" title="27">velocity <span class="op">=</span> <span class="fl">2.99e10</span> <span class="co">#cm/s</span></a>
<a class="sourceLine" id="cb1198-28" title="28">pi <span class="op">=</span> np.pi</a>
<a class="sourceLine" id="cb1198-29" title="29"></a>
<a class="sourceLine" id="cb1198-30" title="30">mu <span class="op">=</span> (m1<span class="op">*</span>m2)<span class="op">/</span>(m1<span class="op">+</span>m2)<span class="op">*</span>mass_fac </a>
<a class="sourceLine" id="cb1198-31" title="31">omega <span class="op">=</span> <span class="dv">2</span><span class="op">*</span>pi<span class="op">*</span>wave_len<span class="op">*</span>velocity </a>
<a class="sourceLine" id="cb1198-32" title="32">force_const <span class="op">=</span> mu<span class="op">*</span>omega<span class="op">**</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb1198-33" title="33"></a>
<a class="sourceLine" id="cb1198-34" title="34">force_const_codex <span class="op">=</span> compute_k(m1,m2,wave_len)</a>
<a class="sourceLine" id="cb1198-35" title="35"></a>
<a class="sourceLine" id="cb1198-36" title="36"><span class="cf">if</span> np.isclose(force_const, force_const_codex) <span class="op">==</span>  <span class="va">True</span>:</a>
<a class="sourceLine" id="cb1198-37" title="37">    result <span class="op">=</span> <span class="va">True</span></a>
<a class="sourceLine" id="cb1198-38" title="38"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb1198-39" title="39">    result <span class="op">=</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>fourier_1d</summary></p>
<h4 id="query-109">Query</h4>
<div class="sourceCode" id="cb1200"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1200-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1200-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1200-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1200-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1200-5" title="5"></a>
<a class="sourceLine" id="cb1200-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1200-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1200-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1200-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1200-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1200-11" title="11"></a>
<a class="sourceLine" id="cb1200-12" title="12"><span class="kw">def</span> fourier_1d(x):</a>
<a class="sourceLine" id="cb1200-13" title="13">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1200-14" title="14"><span class="co">  This function returns the one dimensional fourier transform of array x.</span></a>
<a class="sourceLine" id="cb1200-15" title="15"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1200-16" title="16">  </a></code></pre></div>
<h4 id="run-0-109">Run 0</h4>
<div class="sourceCode" id="cb1201"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1201-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1201-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1201-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1201-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1201-5" title="5"></a>
<a class="sourceLine" id="cb1201-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1201-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1201-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1201-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1201-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1201-11" title="11"></a>
<a class="sourceLine" id="cb1201-12" title="12"><span class="kw">def</span> fourier_1d(x):</a>
<a class="sourceLine" id="cb1201-13" title="13">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1201-14" title="14"><span class="co">  This function returns the one dimensional fourier transform of array x.</span></a>
<a class="sourceLine" id="cb1201-15" title="15"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1201-16" title="16">  <span class="co"># begin</span></a>
<a class="sourceLine" id="cb1201-17" title="17">  <span class="cf">return</span> np.fft.fft(x)</a>
<a class="sourceLine" id="cb1201-18" title="18">  </a>
<a class="sourceLine" id="cb1201-19" title="19"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1201-20" title="20"><span class="im">from</span> numpy.fft <span class="im">import</span> fft</a>
<a class="sourceLine" id="cb1201-21" title="21"></a>
<a class="sourceLine" id="cb1201-22" title="22">x <span class="op">=</span> np.array([<span class="fl">1.0</span>, <span class="fl">2.0</span>, <span class="fl">1.0</span>, <span class="fl">-1.0</span>, <span class="fl">1.5</span>])</a>
<a class="sourceLine" id="cb1201-23" title="23"></a>
<a class="sourceLine" id="cb1201-24" title="24">true_y <span class="op">=</span> fft(x)</a>
<a class="sourceLine" id="cb1201-25" title="25"></a>
<a class="sourceLine" id="cb1201-26" title="26">test_y <span class="op">=</span> fourier_1d(x)</a>
<a class="sourceLine" id="cb1201-27" title="27"></a>
<a class="sourceLine" id="cb1201-28" title="28">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.allclose(true_y, test_y) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-109">Run 1</h4>
<div class="sourceCode" id="cb1203"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1203-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1203-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1203-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1203-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1203-5" title="5"></a>
<a class="sourceLine" id="cb1203-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1203-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1203-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1203-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1203-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1203-11" title="11"></a>
<a class="sourceLine" id="cb1203-12" title="12"><span class="kw">def</span> fourier_1d(x):</a>
<a class="sourceLine" id="cb1203-13" title="13">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1203-14" title="14"><span class="co">  This function returns the one dimensional fourier transform of array x.</span></a>
<a class="sourceLine" id="cb1203-15" title="15"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1203-16" title="16">  <span class="co"># start</span></a>
<a class="sourceLine" id="cb1203-17" title="17">  <span class="cf">return</span> np.fft.fft(x)</a>
<a class="sourceLine" id="cb1203-18" title="18">  </a>
<a class="sourceLine" id="cb1203-19" title="19"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1203-20" title="20"><span class="im">from</span> numpy.fft <span class="im">import</span> fft</a>
<a class="sourceLine" id="cb1203-21" title="21"></a>
<a class="sourceLine" id="cb1203-22" title="22">x <span class="op">=</span> np.array([<span class="fl">1.0</span>, <span class="fl">2.0</span>, <span class="fl">1.0</span>, <span class="fl">-1.0</span>, <span class="fl">1.5</span>])</a>
<a class="sourceLine" id="cb1203-23" title="23"></a>
<a class="sourceLine" id="cb1203-24" title="24">true_y <span class="op">=</span> fft(x)</a>
<a class="sourceLine" id="cb1203-25" title="25"></a>
<a class="sourceLine" id="cb1203-26" title="26">test_y <span class="op">=</span> fourier_1d(x)</a>
<a class="sourceLine" id="cb1203-27" title="27"></a>
<a class="sourceLine" id="cb1203-28" title="28">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.allclose(true_y, test_y) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-109">Run 2</h4>
<div class="sourceCode" id="cb1205"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1205-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1205-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1205-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1205-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1205-5" title="5"></a>
<a class="sourceLine" id="cb1205-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1205-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1205-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1205-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1205-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1205-11" title="11"></a>
<a class="sourceLine" id="cb1205-12" title="12"><span class="kw">def</span> fourier_1d(x):</a>
<a class="sourceLine" id="cb1205-13" title="13">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1205-14" title="14"><span class="co">  This function returns the one dimensional fourier transform of array x.</span></a>
<a class="sourceLine" id="cb1205-15" title="15"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1205-16" title="16">  N <span class="op">=</span> <span class="bu">len</span>(x)</a>
<a class="sourceLine" id="cb1205-17" title="17">  X <span class="op">=</span> np.zeros(N, dtype<span class="op">=</span>np.<span class="bu">complex</span>)</a>
<a class="sourceLine" id="cb1205-18" title="18">  <span class="cf">for</span> k <span class="kw">in</span> <span class="bu">range</span>(N):</a>
<a class="sourceLine" id="cb1205-19" title="19">    <span class="cf">for</span> n <span class="kw">in</span> <span class="bu">range</span>(N):</a>
<a class="sourceLine" id="cb1205-20" title="20">      X[k] <span class="op">+=</span> x[n]<span class="op">*</span>np.exp(<span class="op">-</span>2j<span class="op">*</span>np.pi<span class="op">*</span>k<span class="op">*</span>n<span class="op">/</span>N)</a>
<a class="sourceLine" id="cb1205-21" title="21">  <span class="cf">return</span> X</a>
<a class="sourceLine" id="cb1205-22" title="22"></a>
<a class="sourceLine" id="cb1205-23" title="23"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1205-24" title="24"><span class="im">from</span> numpy.fft <span class="im">import</span> fft</a>
<a class="sourceLine" id="cb1205-25" title="25"></a>
<a class="sourceLine" id="cb1205-26" title="26">x <span class="op">=</span> np.array([<span class="fl">1.0</span>, <span class="fl">2.0</span>, <span class="fl">1.0</span>, <span class="fl">-1.0</span>, <span class="fl">1.5</span>])</a>
<a class="sourceLine" id="cb1205-27" title="27"></a>
<a class="sourceLine" id="cb1205-28" title="28">true_y <span class="op">=</span> fft(x)</a>
<a class="sourceLine" id="cb1205-29" title="29"></a>
<a class="sourceLine" id="cb1205-30" title="30">test_y <span class="op">=</span> fourier_1d(x)</a>
<a class="sourceLine" id="cb1205-31" title="31"></a>
<a class="sourceLine" id="cb1205-32" title="32">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.allclose(true_y, test_y) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-109">Run 3</h4>
<div class="sourceCode" id="cb1207"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1207-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1207-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1207-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1207-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1207-5" title="5"></a>
<a class="sourceLine" id="cb1207-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1207-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1207-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1207-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1207-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1207-11" title="11"></a>
<a class="sourceLine" id="cb1207-12" title="12"><span class="kw">def</span> fourier_1d(x):</a>
<a class="sourceLine" id="cb1207-13" title="13">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1207-14" title="14"><span class="co">  This function returns the one dimensional fourier transform of array x.</span></a>
<a class="sourceLine" id="cb1207-15" title="15"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1207-16" title="16">  <span class="co"># your code here</span></a>
<a class="sourceLine" id="cb1207-17" title="17">  </a>
<a class="sourceLine" id="cb1207-18" title="18"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1207-19" title="19"><span class="im">from</span> numpy.fft <span class="im">import</span> fft</a>
<a class="sourceLine" id="cb1207-20" title="20"></a>
<a class="sourceLine" id="cb1207-21" title="21">x <span class="op">=</span> np.array([<span class="fl">1.0</span>, <span class="fl">2.0</span>, <span class="fl">1.0</span>, <span class="fl">-1.0</span>, <span class="fl">1.5</span>])</a>
<a class="sourceLine" id="cb1207-22" title="22"></a>
<a class="sourceLine" id="cb1207-23" title="23">true_y <span class="op">=</span> fft(x)</a>
<a class="sourceLine" id="cb1207-24" title="24"></a>
<a class="sourceLine" id="cb1207-25" title="25">test_y <span class="op">=</span> fourier_1d(x)</a>
<a class="sourceLine" id="cb1207-26" title="26"></a>
<a class="sourceLine" id="cb1207-27" title="27">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.allclose(true_y, test_y) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>ufunc &#39;isfinite&#39; not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule &#39;&#39;safe&#39;&#39;</code></pre>
<h4 id="run-4-109">Run 4</h4>
<div class="sourceCode" id="cb1209"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1209-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1209-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1209-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1209-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1209-5" title="5"></a>
<a class="sourceLine" id="cb1209-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1209-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1209-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1209-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1209-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1209-11" title="11"></a>
<a class="sourceLine" id="cb1209-12" title="12"><span class="kw">def</span> fourier_1d(x):</a>
<a class="sourceLine" id="cb1209-13" title="13">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1209-14" title="14"><span class="co">  This function returns the one dimensional fourier transform of array x.</span></a>
<a class="sourceLine" id="cb1209-15" title="15"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1209-16" title="16">  <span class="cf">return</span> np.fft.fft(x)</a>
<a class="sourceLine" id="cb1209-17" title="17"></a>
<a class="sourceLine" id="cb1209-18" title="18"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1209-19" title="19"><span class="im">from</span> numpy.fft <span class="im">import</span> fft</a>
<a class="sourceLine" id="cb1209-20" title="20"></a>
<a class="sourceLine" id="cb1209-21" title="21">x <span class="op">=</span> np.array([<span class="fl">1.0</span>, <span class="fl">2.0</span>, <span class="fl">1.0</span>, <span class="fl">-1.0</span>, <span class="fl">1.5</span>])</a>
<a class="sourceLine" id="cb1209-22" title="22"></a>
<a class="sourceLine" id="cb1209-23" title="23">true_y <span class="op">=</span> fft(x)</a>
<a class="sourceLine" id="cb1209-24" title="24"></a>
<a class="sourceLine" id="cb1209-25" title="25">test_y <span class="op">=</span> fourier_1d(x)</a>
<a class="sourceLine" id="cb1209-26" title="26"></a>
<a class="sourceLine" id="cb1209-27" title="27">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.allclose(true_y, test_y) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>freezing_depression</summary></p>
<h4 id="query-110">Query</h4>
<div class="sourceCode" id="cb1211"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1211-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb1211-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb1211-3" title="3"></a>
<a class="sourceLine" id="cb1211-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1211-5" title="5"><span class="co">compute sin(pi/2)</span></a>
<a class="sourceLine" id="cb1211-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1211-7" title="7">x <span class="op">=</span> math.sin(math.pi <span class="op">/</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1211-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1211-9" title="9"></a>
<a class="sourceLine" id="cb1211-10" title="10"><span class="kw">def</span> freezing_depression(Kf,m):</a>
<a class="sourceLine" id="cb1211-11" title="11">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1211-12" title="12"><span class="co">   This function returns the decrease in freezing point in Kelvin</span></a>
<a class="sourceLine" id="cb1211-13" title="13"><span class="co">   The depression constant is Kf in K kg/mol and is greater than zero</span></a>
<a class="sourceLine" id="cb1211-14" title="14"><span class="co">   Molality m is given in mol/kg</span></a>
<a class="sourceLine" id="cb1211-15" title="15"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1211-16" title="16">   </a></code></pre></div>
<h4 id="run-0-110">Run 0</h4>
<div class="sourceCode" id="cb1212"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1212-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb1212-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb1212-3" title="3"></a>
<a class="sourceLine" id="cb1212-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1212-5" title="5"><span class="co">compute sin(pi/2)</span></a>
<a class="sourceLine" id="cb1212-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1212-7" title="7">x <span class="op">=</span> math.sin(math.pi <span class="op">/</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1212-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1212-9" title="9"></a>
<a class="sourceLine" id="cb1212-10" title="10"><span class="kw">def</span> freezing_depression(Kf,m):</a>
<a class="sourceLine" id="cb1212-11" title="11">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1212-12" title="12"><span class="co">   This function returns the decrease in freezing point in Kelvin</span></a>
<a class="sourceLine" id="cb1212-13" title="13"><span class="co">   The depression constant is Kf in K kg/mol and is greater than zero</span></a>
<a class="sourceLine" id="cb1212-14" title="14"><span class="co">   Molality m is given in mol/kg</span></a>
<a class="sourceLine" id="cb1212-15" title="15"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1212-16" title="16">   <span class="cf">return</span> Kf <span class="op">*</span> m</a>
<a class="sourceLine" id="cb1212-17" title="17"></a>
<a class="sourceLine" id="cb1212-18" title="18"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1212-19" title="19">molality <span class="op">=</span> <span class="fl">0.1</span></a>
<a class="sourceLine" id="cb1212-20" title="20">depression_constant <span class="op">=</span> <span class="fl">-0.512</span></a>
<a class="sourceLine" id="cb1212-21" title="21">dT <span class="op">=</span> depression_constant<span class="op">*</span>molality</a>
<a class="sourceLine" id="cb1212-22" title="22">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">abs</span>(freezing_depression(depression_constant,molality)<span class="op">-</span>dT)<span class="op">&lt;</span><span class="fl">0.01</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-110">Run 1</h4>
<div class="sourceCode" id="cb1214"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1214-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb1214-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb1214-3" title="3"></a>
<a class="sourceLine" id="cb1214-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1214-5" title="5"><span class="co">compute sin(pi/2)</span></a>
<a class="sourceLine" id="cb1214-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1214-7" title="7">x <span class="op">=</span> math.sin(math.pi <span class="op">/</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1214-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1214-9" title="9"></a>
<a class="sourceLine" id="cb1214-10" title="10"><span class="kw">def</span> freezing_depression(Kf,m):</a>
<a class="sourceLine" id="cb1214-11" title="11">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1214-12" title="12"><span class="co">   This function returns the decrease in freezing point in Kelvin</span></a>
<a class="sourceLine" id="cb1214-13" title="13"><span class="co">   The depression constant is Kf in K kg/mol and is greater than zero</span></a>
<a class="sourceLine" id="cb1214-14" title="14"><span class="co">   Molality m is given in mol/kg</span></a>
<a class="sourceLine" id="cb1214-15" title="15"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1214-16" title="16">   <span class="cf">return</span> Kf <span class="op">*</span> m</a>
<a class="sourceLine" id="cb1214-17" title="17"></a>
<a class="sourceLine" id="cb1214-18" title="18"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1214-19" title="19">molality <span class="op">=</span> <span class="fl">0.1</span></a>
<a class="sourceLine" id="cb1214-20" title="20">depression_constant <span class="op">=</span> <span class="fl">-0.512</span></a>
<a class="sourceLine" id="cb1214-21" title="21">dT <span class="op">=</span> depression_constant<span class="op">*</span>molality</a>
<a class="sourceLine" id="cb1214-22" title="22">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">abs</span>(freezing_depression(depression_constant,molality)<span class="op">-</span>dT)<span class="op">&lt;</span><span class="fl">0.01</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-110">Run 2</h4>
<div class="sourceCode" id="cb1216"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1216-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb1216-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb1216-3" title="3"></a>
<a class="sourceLine" id="cb1216-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1216-5" title="5"><span class="co">compute sin(pi/2)</span></a>
<a class="sourceLine" id="cb1216-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1216-7" title="7">x <span class="op">=</span> math.sin(math.pi <span class="op">/</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1216-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1216-9" title="9"></a>
<a class="sourceLine" id="cb1216-10" title="10"><span class="kw">def</span> freezing_depression(Kf,m):</a>
<a class="sourceLine" id="cb1216-11" title="11">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1216-12" title="12"><span class="co">   This function returns the decrease in freezing point in Kelvin</span></a>
<a class="sourceLine" id="cb1216-13" title="13"><span class="co">   The depression constant is Kf in K kg/mol and is greater than zero</span></a>
<a class="sourceLine" id="cb1216-14" title="14"><span class="co">   Molality m is given in mol/kg</span></a>
<a class="sourceLine" id="cb1216-15" title="15"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1216-16" title="16">   <span class="cf">return</span> Kf <span class="op">*</span> m</a>
<a class="sourceLine" id="cb1216-17" title="17"></a>
<a class="sourceLine" id="cb1216-18" title="18"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1216-19" title="19">molality <span class="op">=</span> <span class="fl">0.1</span></a>
<a class="sourceLine" id="cb1216-20" title="20">depression_constant <span class="op">=</span> <span class="fl">-0.512</span></a>
<a class="sourceLine" id="cb1216-21" title="21">dT <span class="op">=</span> depression_constant<span class="op">*</span>molality</a>
<a class="sourceLine" id="cb1216-22" title="22">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">abs</span>(freezing_depression(depression_constant,molality)<span class="op">-</span>dT)<span class="op">&lt;</span><span class="fl">0.01</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-110">Run 3</h4>
<div class="sourceCode" id="cb1218"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1218-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb1218-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb1218-3" title="3"></a>
<a class="sourceLine" id="cb1218-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1218-5" title="5"><span class="co">compute sin(pi/2)</span></a>
<a class="sourceLine" id="cb1218-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1218-7" title="7">x <span class="op">=</span> math.sin(math.pi <span class="op">/</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1218-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1218-9" title="9"></a>
<a class="sourceLine" id="cb1218-10" title="10"><span class="kw">def</span> freezing_depression(Kf,m):</a>
<a class="sourceLine" id="cb1218-11" title="11">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1218-12" title="12"><span class="co">   This function returns the decrease in freezing point in Kelvin</span></a>
<a class="sourceLine" id="cb1218-13" title="13"><span class="co">   The depression constant is Kf in K kg/mol and is greater than zero</span></a>
<a class="sourceLine" id="cb1218-14" title="14"><span class="co">   Molality m is given in mol/kg</span></a>
<a class="sourceLine" id="cb1218-15" title="15"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1218-16" title="16">   <span class="cf">return</span> Kf <span class="op">*</span> m</a>
<a class="sourceLine" id="cb1218-17" title="17"></a>
<a class="sourceLine" id="cb1218-18" title="18"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1218-19" title="19">molality <span class="op">=</span> <span class="fl">0.1</span></a>
<a class="sourceLine" id="cb1218-20" title="20">depression_constant <span class="op">=</span> <span class="fl">-0.512</span></a>
<a class="sourceLine" id="cb1218-21" title="21">dT <span class="op">=</span> depression_constant<span class="op">*</span>molality</a>
<a class="sourceLine" id="cb1218-22" title="22">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">abs</span>(freezing_depression(depression_constant,molality)<span class="op">-</span>dT)<span class="op">&lt;</span><span class="fl">0.01</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-110">Run 4</h4>
<div class="sourceCode" id="cb1220"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1220-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb1220-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb1220-3" title="3"></a>
<a class="sourceLine" id="cb1220-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1220-5" title="5"><span class="co">compute sin(pi/2)</span></a>
<a class="sourceLine" id="cb1220-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1220-7" title="7">x <span class="op">=</span> math.sin(math.pi <span class="op">/</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1220-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1220-9" title="9"></a>
<a class="sourceLine" id="cb1220-10" title="10"><span class="kw">def</span> freezing_depression(Kf,m):</a>
<a class="sourceLine" id="cb1220-11" title="11">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1220-12" title="12"><span class="co">   This function returns the decrease in freezing point in Kelvin</span></a>
<a class="sourceLine" id="cb1220-13" title="13"><span class="co">   The depression constant is Kf in K kg/mol and is greater than zero</span></a>
<a class="sourceLine" id="cb1220-14" title="14"><span class="co">   Molality m is given in mol/kg</span></a>
<a class="sourceLine" id="cb1220-15" title="15"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1220-16" title="16">   <span class="cf">return</span> Kf <span class="op">*</span> m</a>
<a class="sourceLine" id="cb1220-17" title="17"></a>
<a class="sourceLine" id="cb1220-18" title="18"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1220-19" title="19">molality <span class="op">=</span> <span class="fl">0.1</span></a>
<a class="sourceLine" id="cb1220-20" title="20">depression_constant <span class="op">=</span> <span class="fl">-0.512</span></a>
<a class="sourceLine" id="cb1220-21" title="21">dT <span class="op">=</span> depression_constant<span class="op">*</span>molality</a>
<a class="sourceLine" id="cb1220-22" title="22">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">abs</span>(freezing_depression(depression_constant,molality)<span class="op">-</span>dT)<span class="op">&lt;</span><span class="fl">0.01</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>genpos</summary></p>
<h4 id="query-111">Query</h4>
<div class="sourceCode" id="cb1222"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1222-1" title="1"><span class="im">import</span> requests</a>
<a class="sourceLine" id="cb1222-2" title="2"><span class="im">from</span> bs4 <span class="im">import</span> BeautifulSoup</a>
<a class="sourceLine" id="cb1222-3" title="3"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1222-4" title="4"></a>
<a class="sourceLine" id="cb1222-5" title="5"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1222-6" title="6"><span class="co">print requests version</span></a>
<a class="sourceLine" id="cb1222-7" title="7"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1222-8" title="8"><span class="bu">print</span>(requests.__version__)</a>
<a class="sourceLine" id="cb1222-9" title="9"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1222-10" title="10"></a>
<a class="sourceLine" id="cb1222-11" title="11"><span class="kw">def</span> matrix_generators(gnum):</a>
<a class="sourceLine" id="cb1222-12" title="12">    <span class="co">&quot;&quot;&quot; Returns list of matrix generators for general positions of given space group</span></a>
<a class="sourceLine" id="cb1222-13" title="13"><span class="co">    gnum -  International Tables for Crystallography space group number</span></a>
<a class="sourceLine" id="cb1222-14" title="14"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1222-15" title="15">    </a></code></pre></div>
<h4 id="run-0-111">Run 0</h4>
<div class="sourceCode" id="cb1223"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1223-1" title="1"><span class="im">import</span> requests</a>
<a class="sourceLine" id="cb1223-2" title="2"><span class="im">from</span> bs4 <span class="im">import</span> BeautifulSoup</a>
<a class="sourceLine" id="cb1223-3" title="3"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1223-4" title="4"></a>
<a class="sourceLine" id="cb1223-5" title="5"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1223-6" title="6"><span class="co">print requests version</span></a>
<a class="sourceLine" id="cb1223-7" title="7"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1223-8" title="8"><span class="bu">print</span>(requests.__version__)</a>
<a class="sourceLine" id="cb1223-9" title="9"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1223-10" title="10"></a>
<a class="sourceLine" id="cb1223-11" title="11"><span class="kw">def</span> matrix_generators(gnum):</a>
<a class="sourceLine" id="cb1223-12" title="12">    <span class="co">&quot;&quot;&quot; Returns list of matrix generators for general positions of given space group</span></a>
<a class="sourceLine" id="cb1223-13" title="13"><span class="co">    gnum -  International Tables for Crystallography space group number</span></a>
<a class="sourceLine" id="cb1223-14" title="14"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1223-15" title="15">    url <span class="op">=</span> <span class="st">&quot;http://www.cryst.ehu.es/cgi-bin/cryst/programs/nph-getgen&quot;</span></a>
<a class="sourceLine" id="cb1223-16" title="16">    payload <span class="op">=</span> {<span class="st">&#39;gnum&#39;</span>: gnum, <span class="st">&#39;format&#39;</span>: <span class="st">&#39;html&#39;</span>}</a>
<a class="sourceLine" id="cb1223-17" title="17">    r <span class="op">=</span> requests.post(url, data<span class="op">=</span>payload)</a>
<a class="sourceLine" id="cb1223-18" title="18">    soup <span class="op">=</span> BeautifulSoup(r.text, <span class="st">&#39;html.parser&#39;</span>)</a>
<a class="sourceLine" id="cb1223-19" title="19">    <span class="co">#print(soup.prettify())</span></a>
<a class="sourceLine" id="cb1223-20" title="20">    <span class="co">#print(soup.find_all(&#39;pre&#39;))</span></a>
<a class="sourceLine" id="cb1223-21" title="21">    <span class="co">#print(soup.find_all(&#39;pre&#39;)[0].get_text())</span></a>
<a class="sourceLine" id="cb1223-22" title="22">    <span class="co">#print(soup.find_all(&#39;pre&#39;)[0].get_text().split(&#39;\n&#39;))</span></a>
<a class="sourceLine" id="cb1223-23" title="23">    <span class="co">#print(soup.find_all(&#39;pre&#39;)[0].get_text().split(&#39;\n&#39;)[1:])</span></a>
<a class="sourceLine" id="cb1223-24" title="24">    <span class="co">#print(soup.find_all(&#39;pre&#39;)[0].get_text().split(&#39;\n&#39;)[1:][:-1])</span></a>
<a class="sourceLine" id="cb1223-25" title="25">    <span class="co">#print(soup.find_all(&#39;pre&#39;)[0].get_text().split(&#39;\n&#39;)[1:][:-1][0])</span></a>
<a class="sourceLine" id="cb1223-26" title="26">    <span class="co">#print(soup.find_all(&#39;pre&#39;)[0].get_text().split(&#39;\n&#39;)[1:][:-1][0].split(&#39; &#39;))</span></a>
<a class="sourceLine" id="cb1223-27" title="27">    <span class="co">#print(soup.find_all(&#39;pre&#39;)[0].get_text().split(&#39;\n&#39;)[1:][:-1][0].split(&#39; &#39;)[1:])</span></a>
<a class="sourceLine" id="cb1223-28" title="28">    <span class="co">#print(soup.find_all(&#39;pre&#39;)[0].get_text().split(&#39;\n&#39;)[1:][:-1][0].split(&#39; &#39;)[1:][0])</span></a>
<a class="sourceLine" id="cb1223-29" title="29">    <span class="co">#print(soup.find_all(&#39;pre&#39;)[0].get_text().split(&#39;\n&#39;)[1:][:-1][0].split(&#39; &#39;)[1:][0].split(&#39;/&#39;))</span></a>
<a class="sourceLine" id="cb1223-30" title="30">    <span class="co">#print(soup.find_all(&#39;pre&#39;)[0].get_text().split(&#39;\n&#39;)[1:][:-1][0].split(&#39; &#39;)[1:][0].split(&#39;/&#39;)[0])</span></a>
<a class="sourceLine" id="cb1223-31" title="31">    <span class="co">#print(soup.find_all(&#39;pre&#39;)[0].get_text().split(&#39;\n&#39;)[1:][:-1][0].split(&#39; &#39;)[1:][0].split(&#39;/&#39;)[0].split(&#39;,&#39;))</span></a>
<a class="sourceLine" id="cb1223-32" title="32">    <span class="co">#print(soup.find_all(&#39;pre&#39;)[0].get_text().split(&#39;\n&#39;)[1:][:-1][0].split(&#39; &#39;)[1:][0].split(&#39;/&#39;)[0].split(&#39;,&#39;)[0])</span></a>
<a class="sourceLine" id="cb1223-33" title="33">    <span class="co">#print(soup.find_all(&#39;pre&#39;)[0].get_text().split(&#39;\n&#39;)[1:][:-1][0].split(&#39; &#39;)[1:][0].split(&#39;/&#39;)[0].split(&#39;,&#39;)[0].split(&#39;(&#39;))</span></a>
<a class="sourceLine" id="cb1223-34" title="34">    <span class="co">#print(soup.find_all(&#39;pre&#39;)[0].get_text().split(&#39;\n&#39;)[1:][:-1][0].split(&#39; &#39;)[1:][0].split(&#39;/&#39;)[0].split(&#39;,&#39;)[0].split(&#39;(&#39;)[1])</span></a>
<a class="sourceLine" id="cb1223-35" title="35">    <span class="co">#print(soup.find_all(&#39;pre&#39;)[0].get_text().split(&#39;\n&#39;)[1:][:-1][0].split(&#39; &#39;)[1:][0].split(&#39;/&#39;)[0].split(&#39;,&#39;)[0].split(&#39;(&#39;)[1].split(&#39;)&#39;))</span></a>
<a class="sourceLine" id="cb1223-36" title="36">    <span class="co">#print(soup.find_all(&#39;pre&#39;)[0].get_text().split(&#39;\n&#39;)[1:][:-1][0].split(&#39; &#39;)[1:][0].split(&#39;/&#39;)[0].split(&#39;,&#39;)[0].split(&#39;(&#39;)[1].split(&#39;)&#39;)[0])</span></a>
<a class="sourceLine" id="cb1223-37" title="37">    <span class="co">#print(soup.find_all(&#39;pre&#39;)[0].get_text().split(&#39;\n&#39;)[1:][:-1][0].split(&#39;</span></a>
<a class="sourceLine" id="cb1223-38" title="38"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1223-39" title="39">mgs <span class="op">=</span> matrix_generators(<span class="dv">66</span>)</a>
<a class="sourceLine" id="cb1223-40" title="40">ref <span class="op">=</span> np.array([[<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span><span class="op">/</span><span class="dv">2</span>],</a>
<a class="sourceLine" id="cb1223-41" title="41">                [<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span><span class="op">/</span><span class="dv">2</span>],</a>
<a class="sourceLine" id="cb1223-42" title="42">                [<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>]])</a>
<a class="sourceLine" id="cb1223-43" title="43">result <span class="op">=</span> np.allclose(mgs[<span class="op">-</span><span class="dv">1</span>], ref)</a></code></pre></div>
<p>Output:</p>
<pre><code>&#39;NoneType&#39; object is not subscriptable</code></pre>
<h4 id="run-1-111">Run 1</h4>
<div class="sourceCode" id="cb1225"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1225-1" title="1"><span class="im">import</span> requests</a>
<a class="sourceLine" id="cb1225-2" title="2"><span class="im">from</span> bs4 <span class="im">import</span> BeautifulSoup</a>
<a class="sourceLine" id="cb1225-3" title="3"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1225-4" title="4"></a>
<a class="sourceLine" id="cb1225-5" title="5"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1225-6" title="6"><span class="co">print requests version</span></a>
<a class="sourceLine" id="cb1225-7" title="7"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1225-8" title="8"><span class="bu">print</span>(requests.__version__)</a>
<a class="sourceLine" id="cb1225-9" title="9"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1225-10" title="10"></a>
<a class="sourceLine" id="cb1225-11" title="11"><span class="kw">def</span> matrix_generators(gnum):</a>
<a class="sourceLine" id="cb1225-12" title="12">    <span class="co">&quot;&quot;&quot; Returns list of matrix generators for general positions of given space group</span></a>
<a class="sourceLine" id="cb1225-13" title="13"><span class="co">    gnum -  International Tables for Crystallography space group number</span></a>
<a class="sourceLine" id="cb1225-14" title="14"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1225-15" title="15">    url <span class="op">=</span> <span class="st">&quot;http://www.cryst.ehu.es/cgi-bin/cryst/programs/nph-geninfo?gnum=&quot;</span> <span class="op">+</span> <span class="bu">str</span>(gnum)</a>
<a class="sourceLine" id="cb1225-16" title="16">    r <span class="op">=</span> requests.get(url)</a>
<a class="sourceLine" id="cb1225-17" title="17">    soup <span class="op">=</span> BeautifulSoup(r.content, <span class="st">&quot;html.parser&quot;</span>)</a>
<a class="sourceLine" id="cb1225-18" title="18">    table <span class="op">=</span> soup.find(<span class="st">&quot;table&quot;</span>, {<span class="st">&quot;class&quot;</span>: <span class="st">&quot;matgen&quot;</span>})</a>
<a class="sourceLine" id="cb1225-19" title="19">    <span class="cf">if</span> table <span class="kw">is</span> <span class="va">None</span>:</a>
<a class="sourceLine" id="cb1225-20" title="20">        <span class="cf">return</span> <span class="va">None</span></a>
<a class="sourceLine" id="cb1225-21" title="21">    <span class="cf">else</span>:</a>
<a class="sourceLine" id="cb1225-22" title="22">        rows <span class="op">=</span> table.find_all(<span class="st">&quot;tr&quot;</span>)</a>
<a class="sourceLine" id="cb1225-23" title="23">        matrices <span class="op">=</span> []</a>
<a class="sourceLine" id="cb1225-24" title="24">        <span class="cf">for</span> row <span class="kw">in</span> rows:</a>
<a class="sourceLine" id="cb1225-25" title="25">            cols <span class="op">=</span> row.find_all(<span class="st">&quot;td&quot;</span>)</a>
<a class="sourceLine" id="cb1225-26" title="26">            cols <span class="op">=</span> [ele.text.strip() <span class="cf">for</span> ele <span class="kw">in</span> cols]</a>
<a class="sourceLine" id="cb1225-27" title="27">            matrices.append([ele <span class="cf">for</span> ele <span class="kw">in</span> cols <span class="cf">if</span> ele])</a>
<a class="sourceLine" id="cb1225-28" title="28">        <span class="cf">return</span> matrices</a>
<a class="sourceLine" id="cb1225-29" title="29"></a>
<a class="sourceLine" id="cb1225-30" title="30"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1225-31" title="31">mgs <span class="op">=</span> matrix_generators(<span class="dv">66</span>)</a>
<a class="sourceLine" id="cb1225-32" title="32">ref <span class="op">=</span> np.array([[<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span><span class="op">/</span><span class="dv">2</span>],</a>
<a class="sourceLine" id="cb1225-33" title="33">                [<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span><span class="op">/</span><span class="dv">2</span>],</a>
<a class="sourceLine" id="cb1225-34" title="34">                [<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>]])</a>
<a class="sourceLine" id="cb1225-35" title="35">result <span class="op">=</span> np.allclose(mgs[<span class="op">-</span><span class="dv">1</span>], ref)</a></code></pre></div>
<p>Output:</p>
<pre><code>&#39;NoneType&#39; object is not subscriptable</code></pre>
<h4 id="run-2-111">Run 2</h4>
<div class="sourceCode" id="cb1227"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1227-1" title="1"><span class="im">import</span> requests</a>
<a class="sourceLine" id="cb1227-2" title="2"><span class="im">from</span> bs4 <span class="im">import</span> BeautifulSoup</a>
<a class="sourceLine" id="cb1227-3" title="3"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1227-4" title="4"></a>
<a class="sourceLine" id="cb1227-5" title="5"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1227-6" title="6"><span class="co">print requests version</span></a>
<a class="sourceLine" id="cb1227-7" title="7"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1227-8" title="8"><span class="bu">print</span>(requests.__version__)</a>
<a class="sourceLine" id="cb1227-9" title="9"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1227-10" title="10"></a>
<a class="sourceLine" id="cb1227-11" title="11"><span class="kw">def</span> matrix_generators(gnum):</a>
<a class="sourceLine" id="cb1227-12" title="12">    <span class="co">&quot;&quot;&quot; Returns list of matrix generators for general positions of given space group</span></a>
<a class="sourceLine" id="cb1227-13" title="13"><span class="co">    gnum -  International Tables for Crystallography space group number</span></a>
<a class="sourceLine" id="cb1227-14" title="14"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1227-15" title="15">    url <span class="op">=</span> <span class="st">&quot;http://www.cryst.ehu.es/cgi-bin/cryst/programs/nph-geninfo?gnum=</span><span class="sc">%d</span><span class="st">&quot;</span> <span class="op">%</span> gnum</a>
<a class="sourceLine" id="cb1227-16" title="16">    r <span class="op">=</span> requests.get(url)</a>
<a class="sourceLine" id="cb1227-17" title="17">    soup <span class="op">=</span> BeautifulSoup(r.text, <span class="st">&quot;html.parser&quot;</span>)</a>
<a class="sourceLine" id="cb1227-18" title="18">    table <span class="op">=</span> soup.find_all(<span class="st">&quot;table&quot;</span>)[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb1227-19" title="19">    rows <span class="op">=</span> table.find_all(<span class="st">&quot;tr&quot;</span>)</a>
<a class="sourceLine" id="cb1227-20" title="20">    generators <span class="op">=</span> []</a>
<a class="sourceLine" id="cb1227-21" title="21">    <span class="cf">for</span> row <span class="kw">in</span> rows:</a>
<a class="sourceLine" id="cb1227-22" title="22">        cols <span class="op">=</span> row.find_all(<span class="st">&quot;td&quot;</span>)</a>
<a class="sourceLine" id="cb1227-23" title="23">        cols <span class="op">=</span> [ele.text.strip() <span class="cf">for</span> ele <span class="kw">in</span> cols]</a>
<a class="sourceLine" id="cb1227-24" title="24">        generators.append([ele <span class="cf">for</span> ele <span class="kw">in</span> cols <span class="cf">if</span> ele])</a>
<a class="sourceLine" id="cb1227-25" title="25">    <span class="cf">return</span> generators</a>
<a class="sourceLine" id="cb1227-26" title="26"></a>
<a class="sourceLine" id="cb1227-27" title="27"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1227-28" title="28">mgs <span class="op">=</span> matrix_generators(<span class="dv">66</span>)</a>
<a class="sourceLine" id="cb1227-29" title="29">ref <span class="op">=</span> np.array([[<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span><span class="op">/</span><span class="dv">2</span>],</a>
<a class="sourceLine" id="cb1227-30" title="30">                [<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span><span class="op">/</span><span class="dv">2</span>],</a>
<a class="sourceLine" id="cb1227-31" title="31">                [<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>]])</a>
<a class="sourceLine" id="cb1227-32" title="32">result <span class="op">=</span> np.allclose(mgs[<span class="op">-</span><span class="dv">1</span>], ref)</a></code></pre></div>
<p>Output:</p>
<pre><code>list index out of range</code></pre>
<h4 id="run-3-111">Run 3</h4>
<div class="sourceCode" id="cb1229"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1229-1" title="1"><span class="im">import</span> requests</a>
<a class="sourceLine" id="cb1229-2" title="2"><span class="im">from</span> bs4 <span class="im">import</span> BeautifulSoup</a>
<a class="sourceLine" id="cb1229-3" title="3"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1229-4" title="4"></a>
<a class="sourceLine" id="cb1229-5" title="5"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1229-6" title="6"><span class="co">print requests version</span></a>
<a class="sourceLine" id="cb1229-7" title="7"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1229-8" title="8"><span class="bu">print</span>(requests.__version__)</a>
<a class="sourceLine" id="cb1229-9" title="9"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1229-10" title="10"></a>
<a class="sourceLine" id="cb1229-11" title="11"><span class="kw">def</span> matrix_generators(gnum):</a>
<a class="sourceLine" id="cb1229-12" title="12">    <span class="co">&quot;&quot;&quot; Returns list of matrix generators for general positions of given space group</span></a>
<a class="sourceLine" id="cb1229-13" title="13"><span class="co">    gnum -  International Tables for Crystallography space group number</span></a>
<a class="sourceLine" id="cb1229-14" title="14"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1229-15" title="15">    <span class="co"># get html page with generators</span></a>
<a class="sourceLine" id="cb1229-16" title="16">    url <span class="op">=</span> <span class="st">&quot;http://www.cryst.ehu.es/cgi-bin/cryst/programs/nph-matgen?gnum=&quot;</span> <span class="op">+</span> <span class="bu">str</span>(gnum)</a>
<a class="sourceLine" id="cb1229-17" title="17">    r <span class="op">=</span> requests.get(url)</a>
<a class="sourceLine" id="cb1229-18" title="18">    soup <span class="op">=</span> BeautifulSoup(r.text, <span class="st">&quot;html.parser&quot;</span>)</a>
<a class="sourceLine" id="cb1229-19" title="19">    <span class="co"># get all &lt;pre&gt; tags</span></a>
<a class="sourceLine" id="cb1229-20" title="20">    pre_tags <span class="op">=</span> soup.find_all(<span class="st">&quot;pre&quot;</span>)</a>
<a class="sourceLine" id="cb1229-21" title="21">    <span class="co"># get all generators</span></a>
<a class="sourceLine" id="cb1229-22" title="22">    generators <span class="op">=</span> pre_tags[<span class="dv">1</span>].text.split(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)</a>
<a class="sourceLine" id="cb1229-23" title="23">    <span class="co"># remove empty strings</span></a>
<a class="sourceLine" id="cb1229-24" title="24">    generators <span class="op">=</span> [x <span class="cf">for</span> x <span class="kw">in</span> generators <span class="cf">if</span> x <span class="op">!=</span> <span class="st">&#39;&#39;</span>]</a>
<a class="sourceLine" id="cb1229-25" title="25">    <span class="co"># remove first and last string</span></a>
<a class="sourceLine" id="cb1229-26" title="26">    generators <span class="op">=</span> generators[<span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>]</a>
<a class="sourceLine" id="cb1229-27" title="27">    <span class="co"># remove &#39;Generators:&#39; string</span></a>
<a class="sourceLine" id="cb1229-28" title="28">    generators <span class="op">=</span> generators[<span class="dv">1</span>:]</a>
<a class="sourceLine" id="cb1229-29" title="29">    <span class="co"># remove &#39;Generators:&#39; string</span></a>
<a class="sourceLine" id="cb1229-30" title="30">    generators <span class="op">=</span> generators[:<span class="op">-</span><span class="dv">1</span>]</a>
<a class="sourceLine" id="cb1229-31" title="31">    <span class="co"># remove &#39;Generators:&#39; string</span></a>
<a class="sourceLine" id="cb1229-32" title="32">    generators <span class="op">=</span> generators[:<span class="op">-</span><span class="dv">1</span>]</a>
<a class="sourceLine" id="cb1229-33" title="33">    <span class="co"># remove &#39;Generators:&#39; string</span></a>
<a class="sourceLine" id="cb1229-34" title="34">    generators <span class="op">=</span> generators[:<span class="op">-</span><span class="dv">1</span>]</a>
<a class="sourceLine" id="cb1229-35" title="35">    <span class="co"># remove &#39;Generators:&#39; string</span></a>
<a class="sourceLine" id="cb1229-36" title="36">    generators <span class="op">=</span> generators[:<span class="op">-</span><span class="dv">1</span>]</a>
<a class="sourceLine" id="cb1229-37" title="37">    <span class="co"># remove &#39;Generators:&#39; string</span></a>
<a class="sourceLine" id="cb1229-38" title="38">    generators <span class="op">=</span> generators[:<span class="op">-</span><span class="dv">1</span>]</a>
<a class="sourceLine" id="cb1229-39" title="39">    <span class="co"># remove &#39;Generators:&#39; string</span></a>
<a class="sourceLine" id="cb1229-40" title="40">    generators <span class="op">=</span> generators[:<span class="op">-</span><span class="dv">1</span>]</a>
<a class="sourceLine" id="cb1229-41" title="41">    <span class="co"># remove &#39;Generators:&#39; string</span></a>
<a class="sourceLine" id="cb1229-42" title="42">    generators <span class="op">=</span> generators[:<span class="op">-</span><span class="dv">1</span>]</a>
<a class="sourceLine" id="cb1229-43" title="43">    <span class="co"># remove &#39;Generators:&#39; string</span></a>
<a class="sourceLine" id="cb1229-44" title="44">    generators <span class="op">=</span> generators[:<span class="op">-</span><span class="dv">1</span>]</a>
<a class="sourceLine" id="cb1229-45" title="45">    <span class="co"># remove &#39;Generators:&#39; string</span></a>
<a class="sourceLine" id="cb1229-46" title="46">    generators <span class="op">=</span> generators[:<span class="op">-</span><span class="dv">1</span>]</a>
<a class="sourceLine" id="cb1229-47" title="47">    <span class="co"># remove &#39;Generators:&#39; string</span></a>
<a class="sourceLine" id="cb1229-48" title="48">    generators <span class="op">=</span> generators[:<span class="op">-</span><span class="dv">1</span>]</a>
<a class="sourceLine" id="cb1229-49" title="49">    <span class="co"># remove &#39;Generators:&#39; string</span></a>
<a class="sourceLine" id="cb1229-50" title="50">    generators <span class="op">=</span> generators[:<span class="op">-</span><span class="dv">1</span>]</a>
<a class="sourceLine" id="cb1229-51" title="51">    <span class="co"># remove &#39;Generators:&#39; string</span></a>
<a class="sourceLine" id="cb1229-52" title="52">    generators <span class="op">=</span> generators[:<span class="op">-</span><span class="dv">1</span>]</a>
<a class="sourceLine" id="cb1229-53" title="53">    <span class="co"># remove &#39;Generators:&#39; string</span></a>
<a class="sourceLine" id="cb1229-54" title="54">    generators <span class="op">=</span> generators[:<span class="op">-</span><span class="dv">1</span>]</a>
<a class="sourceLine" id="cb1229-55" title="55">    <span class="co"># remove &#39;Generators:&#39; string</span></a>
<a class="sourceLine" id="cb1229-56" title="56">    generators <span class="op">=</span> generators[:<span class="op">-</span><span class="dv">1</span>]</a>
<a class="sourceLine" id="cb1229-57" title="57">    <span class="co"># remove &#39;Generators:&#39; string</span></a>
<a class="sourceLine" id="cb1229-58" title="58">    generators <span class="op">=</span> generators[:<span class="op">-</span><span class="dv">1</span>]</a>
<a class="sourceLine" id="cb1229-59" title="59">    <span class="co"># remove &#39;Generators:&#39; string</span></a>
<a class="sourceLine" id="cb1229-60" title="60">    generators <span class="op">=</span> generators[:<span class="op">-</span><span class="dv">1</span>]</a>
<a class="sourceLine" id="cb1229-61" title="61">    <span class="co"># remove &#39;Generators:&#39; string</span></a>
<a class="sourceLine" id="cb1229-62" title="62">    generators <span class="op">=</span> generators[:<span class="op">-</span><span class="dv">1</span>]</a>
<a class="sourceLine" id="cb1229-63" title="63">    <span class="co"># remove &#39;Generators:&#39; string</span></a>
<a class="sourceLine" id="cb1229-64" title="64">    generators <span class="op">=</span> generators[:<span class="op">-</span><span class="dv">1</span>]</a>
<a class="sourceLine" id="cb1229-65" title="65">    <span class="co"># remove &#39;Generators:&#39; string</span></a>
<a class="sourceLine" id="cb1229-66" title="66">    generators <span class="op">=</span> generators[:<span class="op">-</span><span class="dv">1</span>]</a>
<a class="sourceLine" id="cb1229-67" title="67">    <span class="co"># remove &#39;Generators:&#39; string</span></a>
<a class="sourceLine" id="cb1229-68" title="68">    generators <span class="op">=</span> generators[:<span class="op">-</span><span class="dv">1</span>]</a>
<a class="sourceLine" id="cb1229-69" title="69">    <span class="co"># remove &#39;Generators:&#39; string</span></a>
<a class="sourceLine" id="cb1229-70" title="70">    generators <span class="op">=</span> generators[:<span class="op">-</span><span class="dv">1</span>]</a>
<a class="sourceLine" id="cb1229-71" title="71">    <span class="co"># remove &#39;Generators:&#39; string</span></a>
<a class="sourceLine" id="cb1229-72" title="72">    generators <span class="op">=</span> generators[:<span class="op">-</span><span class="dv">1</span>]</a>
<a class="sourceLine" id="cb1229-73" title="73">    <span class="co"># remove &#39;Generators:&#39; string</span></a>
<a class="sourceLine" id="cb1229-74" title="74">    generators <span class="op">=</span> generators[:<span class="op">-</span><span class="dv">1</span>]</a>
<a class="sourceLine" id="cb1229-75" title="75">    <span class="co"># remove &#39;Generators:&#39; string</span></a>
<a class="sourceLine" id="cb1229-76" title="76">    generators <span class="op">=</span> generators[:<span class="op">-</span><span class="dv">1</span>]</a>
<a class="sourceLine" id="cb1229-77" title="77">    <span class="co"># remove &#39;Generators:&#39; string</span></a>
<a class="sourceLine" id="cb1229-78" title="78">    generators <span class="op">=</span> generators[:<span class="op">-</span><span class="dv">1</span>]</a>
<a class="sourceLine" id="cb1229-79" title="79">    <span class="co"># remove &#39;Generators:&#39; string</span></a>
<a class="sourceLine" id="cb1229-80" title="80">    generators <span class="op">=</span> generators[:<span class="op">-</span><span class="dv">1</span>]</a>
<a class="sourceLine" id="cb1229-81" title="81">    <span class="co"># remove &#39;Generators:&#39; string</span></a>
<a class="sourceLine" id="cb1229-82" title="82">    generators <span class="op">=</span> generators[:<span class="op">-</span><span class="dv">1</span>]</a>
<a class="sourceLine" id="cb1229-83" title="83">    <span class="co"># remove &#39;Generators:&#39; string</span></a>
<a class="sourceLine" id="cb1229-84" title="84">    generators <span class="op">=</span> generators[:<span class="op">-</span><span class="dv">1</span>]</a>
<a class="sourceLine" id="cb1229-85" title="85">    <span class="co"># remove &#39;Generators:&#39; string</span></a>
<a class="sourceLine" id="cb1229-86" title="86">    generators <span class="op">=</span> generators[:<span class="op">-</span><span class="dv">1</span>]</a>
<a class="sourceLine" id="cb1229-87" title="87">    <span class="co"># remove &#39;Generators:&#39; string</span></a>
<a class="sourceLine" id="cb1229-88" title="88">    generators <span class="op">=</span> generators[:<span class="op">-</span><span class="dv">1</span>]</a>
<a class="sourceLine" id="cb1229-89" title="89">    <span class="co"># remove &#39;Generators:&#39; string</span></a>
<a class="sourceLine" id="cb1229-90" title="90">    generators <span class="op">=</span> generators[:<span class="op">-</span><span class="dv">1</span>]</a>
<a class="sourceLine" id="cb1229-91" title="91">    <span class="co"># remove &#39;Generators:&#39; string</span></a>
<a class="sourceLine" id="cb1229-92" title="92">    generators <span class="op">=</span> generators[:<span class="op">-</span><span class="dv">1</span>]</a>
<a class="sourceLine" id="cb1229-93" title="93">    <span class="co"># remove &#39;Generators:&#39; string</span></a>
<a class="sourceLine" id="cb1229-94" title="94">    generators <span class="op">=</span> generators[:<span class="op">-</span><span class="dv">1</span>]</a>
<a class="sourceLine" id="cb1229-95" title="95">    <span class="co"># remove &#39;Generators:&#39; string</span></a>
<a class="sourceLine" id="cb1229-96" title="96">    generators <span class="op">=</span> generators[:<span class="op">-</span><span class="dv">1</span>]</a>
<a class="sourceLine" id="cb1229-97" title="97">    <span class="co"># remove &#39;Generators:&#39; string</span></a>
<a class="sourceLine" id="cb1229-98" title="98">    generators <span class="op">=</span> generators[:<span class="op">-</span><span class="dv">1</span>]</a>
<a class="sourceLine" id="cb1229-99" title="99">    <span class="co"># remove &#39;Generators:&#39; string</span></a>
<a class="sourceLine" id="cb1229-100" title="100">    generators <span class="op">=</span> generators[:<span class="op">-</span><span class="dv">1</span>]</a>
<a class="sourceLine" id="cb1229-101" title="101">    <span class="co"># remove &#39;Generators:&#39; string</span></a>
<a class="sourceLine" id="cb1229-102" title="102">    generators <span class="op">=</span> generators[:<span class="op">-</span><span class="dv">1</span>]</a>
<a class="sourceLine" id="cb1229-103" title="103">    <span class="co"># remove &#39;Generators:&#39; string</span></a>
<a class="sourceLine" id="cb1229-104" title="104">    generators <span class="op">=</span> generators[:<span class="op">-</span><span class="dv">1</span>]</a>
<a class="sourceLine" id="cb1229-105" title="105">    <span class="co"># remove &#39;Generators:&#39; string</span></a>
<a class="sourceLine" id="cb1229-106" title="106">    generators <span class="op">=</span> generators[:<span class="op">-</span><span class="dv">1</span>]</a>
<a class="sourceLine" id="cb1229-107" title="107">    <span class="co"># remove &#39;Generators:&#39; string</span></a>
<a class="sourceLine" id="cb1229-108" title="108">    generators <span class="op">=</span> generators[:<span class="op">-</span></a>
<a class="sourceLine" id="cb1229-109" title="109"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1229-110" title="110">mgs <span class="op">=</span> matrix_generators(<span class="dv">66</span>)</a>
<a class="sourceLine" id="cb1229-111" title="111">ref <span class="op">=</span> np.array([[<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span><span class="op">/</span><span class="dv">2</span>],</a>
<a class="sourceLine" id="cb1229-112" title="112">                [<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span><span class="op">/</span><span class="dv">2</span>],</a>
<a class="sourceLine" id="cb1229-113" title="113">                [<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>]])</a>
<a class="sourceLine" id="cb1229-114" title="114">result <span class="op">=</span> np.allclose(mgs[<span class="op">-</span><span class="dv">1</span>], ref)</a></code></pre></div>
<p>Output:</p>
<pre><code>invalid syntax (&lt;string&gt;, line 110)</code></pre>
<h4 id="run-4-111">Run 4</h4>
<div class="sourceCode" id="cb1231"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1231-1" title="1"><span class="im">import</span> requests</a>
<a class="sourceLine" id="cb1231-2" title="2"><span class="im">from</span> bs4 <span class="im">import</span> BeautifulSoup</a>
<a class="sourceLine" id="cb1231-3" title="3"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1231-4" title="4"></a>
<a class="sourceLine" id="cb1231-5" title="5"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1231-6" title="6"><span class="co">print requests version</span></a>
<a class="sourceLine" id="cb1231-7" title="7"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1231-8" title="8"><span class="bu">print</span>(requests.__version__)</a>
<a class="sourceLine" id="cb1231-9" title="9"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1231-10" title="10"></a>
<a class="sourceLine" id="cb1231-11" title="11"><span class="kw">def</span> matrix_generators(gnum):</a>
<a class="sourceLine" id="cb1231-12" title="12">    <span class="co">&quot;&quot;&quot; Returns list of matrix generators for general positions of given space group</span></a>
<a class="sourceLine" id="cb1231-13" title="13"><span class="co">    gnum -  International Tables for Crystallography space group number</span></a>
<a class="sourceLine" id="cb1231-14" title="14"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1231-15" title="15">    url <span class="op">=</span> <span class="st">&quot;http://www.cryst.ehu.es/cgi-bin/cryst/programs/nph-geninfo?gnum=</span><span class="sc">{}</span><span class="st">&quot;</span>.<span class="bu">format</span>(gnum)</a>
<a class="sourceLine" id="cb1231-16" title="16">    r <span class="op">=</span> requests.get(url)</a>
<a class="sourceLine" id="cb1231-17" title="17">    soup <span class="op">=</span> BeautifulSoup(r.content, <span class="st">&quot;html.parser&quot;</span>)</a>
<a class="sourceLine" id="cb1231-18" title="18">    table <span class="op">=</span> soup.find(<span class="st">&quot;table&quot;</span>)</a>
<a class="sourceLine" id="cb1231-19" title="19">    rows <span class="op">=</span> table.find_all(<span class="st">&quot;tr&quot;</span>)</a>
<a class="sourceLine" id="cb1231-20" title="20">    generators <span class="op">=</span> []</a>
<a class="sourceLine" id="cb1231-21" title="21">    <span class="cf">for</span> row <span class="kw">in</span> rows:</a>
<a class="sourceLine" id="cb1231-22" title="22">        cols <span class="op">=</span> row.find_all(<span class="st">&quot;td&quot;</span>)</a>
<a class="sourceLine" id="cb1231-23" title="23">        cols <span class="op">=</span> [ele.text.strip() <span class="cf">for</span> ele <span class="kw">in</span> cols]</a>
<a class="sourceLine" id="cb1231-24" title="24">        generators.append([ele <span class="cf">for</span> ele <span class="kw">in</span> cols <span class="cf">if</span> ele])</a>
<a class="sourceLine" id="cb1231-25" title="25">    <span class="cf">return</span> generators</a>
<a class="sourceLine" id="cb1231-26" title="26"></a>
<a class="sourceLine" id="cb1231-27" title="27"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1231-28" title="28">mgs <span class="op">=</span> matrix_generators(<span class="dv">66</span>)</a>
<a class="sourceLine" id="cb1231-29" title="29">ref <span class="op">=</span> np.array([[<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span><span class="op">/</span><span class="dv">2</span>],</a>
<a class="sourceLine" id="cb1231-30" title="30">                [<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span><span class="op">/</span><span class="dv">2</span>],</a>
<a class="sourceLine" id="cb1231-31" title="31">                [<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>]])</a>
<a class="sourceLine" id="cb1231-32" title="32">result <span class="op">=</span> np.allclose(mgs[<span class="op">-</span><span class="dv">1</span>], ref)</a></code></pre></div>
<p>Output:</p>
<pre><code>&#39;NoneType&#39; object has no attribute &#39;find_all&#39;</code></pre>
</details>
<details>
<p><summary>heating_water</summary></p>
<h4 id="query-112">Query</h4>
<div class="sourceCode" id="cb1233"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1233-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb1233-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb1233-3" title="3"></a>
<a class="sourceLine" id="cb1233-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1233-5" title="5"><span class="co">compute sin(pi/2)</span></a>
<a class="sourceLine" id="cb1233-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1233-7" title="7">x <span class="op">=</span> math.sin(math.pi <span class="op">/</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1233-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1233-9" title="9"></a>
<a class="sourceLine" id="cb1233-10" title="10"><span class="kw">def</span> heating_energy(n, T1, T2):</a>
<a class="sourceLine" id="cb1233-11" title="11">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1233-12" title="12"><span class="co">   This function returns the energy in kcal required to heat n moles of water from T1 to T2</span></a>
<a class="sourceLine" id="cb1233-13" title="13"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1233-14" title="14">   </a></code></pre></div>
<h4 id="run-0-112">Run 0</h4>
<div class="sourceCode" id="cb1234"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1234-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb1234-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb1234-3" title="3"></a>
<a class="sourceLine" id="cb1234-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1234-5" title="5"><span class="co">compute sin(pi/2)</span></a>
<a class="sourceLine" id="cb1234-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1234-7" title="7">x <span class="op">=</span> math.sin(math.pi <span class="op">/</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1234-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1234-9" title="9"></a>
<a class="sourceLine" id="cb1234-10" title="10"><span class="kw">def</span> heating_energy(n, T1, T2):</a>
<a class="sourceLine" id="cb1234-11" title="11">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1234-12" title="12"><span class="co">   This function returns the energy in kcal required to heat n moles of water from T1 to T2</span></a>
<a class="sourceLine" id="cb1234-13" title="13"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1234-14" title="14">   <span class="co"># start</span></a>
<a class="sourceLine" id="cb1234-15" title="15">   <span class="cf">return</span> n <span class="op">*</span> (T2 <span class="op">-</span> T1) <span class="op">*</span> <span class="fl">4.184</span></a>
<a class="sourceLine" id="cb1234-16" title="16">   </a>
<a class="sourceLine" id="cb1234-17" title="17"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1234-18" title="18"></a>
<a class="sourceLine" id="cb1234-19" title="19">n <span class="op">=</span> <span class="dv">2</span></a>
<a class="sourceLine" id="cb1234-20" title="20">T1 <span class="op">=</span> <span class="dv">300</span></a>
<a class="sourceLine" id="cb1234-21" title="21">T2 <span class="op">=</span> <span class="dv">350</span></a>
<a class="sourceLine" id="cb1234-22" title="22">C <span class="op">=</span> <span class="dv">1</span><span class="op">*</span><span class="fl">18.</span><span class="op">/</span><span class="dv">1000</span> <span class="co">#cal/g/deg</span></a>
<a class="sourceLine" id="cb1234-23" title="23">q <span class="op">=</span> n<span class="op">*</span>C<span class="op">*</span>(T2<span class="op">-</span>T1)</a>
<a class="sourceLine" id="cb1234-24" title="24"><span class="co"># heat in kilocalories</span></a>
<a class="sourceLine" id="cb1234-25" title="25"></a>
<a class="sourceLine" id="cb1234-26" title="26">q_codex <span class="op">=</span> heating_energy(n, T1, T2)</a>
<a class="sourceLine" id="cb1234-27" title="27"></a>
<a class="sourceLine" id="cb1234-28" title="28"><span class="co"># check </span></a>
<a class="sourceLine" id="cb1234-29" title="29"><span class="cf">if</span> np.isclose(q, q_codex, rtol<span class="op">=</span><span class="fl">0.01</span>) <span class="op">==</span> <span class="va">True</span>:</a>
<a class="sourceLine" id="cb1234-30" title="30">    result <span class="op">=</span> <span class="va">True</span> </a>
<a class="sourceLine" id="cb1234-31" title="31"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb1234-32" title="32">    result <span class="op">=</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-112">Run 1</h4>
<div class="sourceCode" id="cb1236"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1236-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb1236-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb1236-3" title="3"></a>
<a class="sourceLine" id="cb1236-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1236-5" title="5"><span class="co">compute sin(pi/2)</span></a>
<a class="sourceLine" id="cb1236-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1236-7" title="7">x <span class="op">=</span> math.sin(math.pi <span class="op">/</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1236-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1236-9" title="9"></a>
<a class="sourceLine" id="cb1236-10" title="10"><span class="kw">def</span> heating_energy(n, T1, T2):</a>
<a class="sourceLine" id="cb1236-11" title="11">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1236-12" title="12"><span class="co">   This function returns the energy in kcal required to heat n moles of water from T1 to T2</span></a>
<a class="sourceLine" id="cb1236-13" title="13"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1236-14" title="14">   <span class="cf">return</span> n <span class="op">*</span> <span class="fl">4.184</span> <span class="op">*</span> (T2 <span class="op">-</span> T1)</a>
<a class="sourceLine" id="cb1236-15" title="15"></a>
<a class="sourceLine" id="cb1236-16" title="16"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1236-17" title="17"></a>
<a class="sourceLine" id="cb1236-18" title="18">n <span class="op">=</span> <span class="dv">2</span></a>
<a class="sourceLine" id="cb1236-19" title="19">T1 <span class="op">=</span> <span class="dv">300</span></a>
<a class="sourceLine" id="cb1236-20" title="20">T2 <span class="op">=</span> <span class="dv">350</span></a>
<a class="sourceLine" id="cb1236-21" title="21">C <span class="op">=</span> <span class="dv">1</span><span class="op">*</span><span class="fl">18.</span><span class="op">/</span><span class="dv">1000</span> <span class="co">#cal/g/deg</span></a>
<a class="sourceLine" id="cb1236-22" title="22">q <span class="op">=</span> n<span class="op">*</span>C<span class="op">*</span>(T2<span class="op">-</span>T1)</a>
<a class="sourceLine" id="cb1236-23" title="23"><span class="co"># heat in kilocalories</span></a>
<a class="sourceLine" id="cb1236-24" title="24"></a>
<a class="sourceLine" id="cb1236-25" title="25">q_codex <span class="op">=</span> heating_energy(n, T1, T2)</a>
<a class="sourceLine" id="cb1236-26" title="26"></a>
<a class="sourceLine" id="cb1236-27" title="27"><span class="co"># check </span></a>
<a class="sourceLine" id="cb1236-28" title="28"><span class="cf">if</span> np.isclose(q, q_codex, rtol<span class="op">=</span><span class="fl">0.01</span>) <span class="op">==</span> <span class="va">True</span>:</a>
<a class="sourceLine" id="cb1236-29" title="29">    result <span class="op">=</span> <span class="va">True</span> </a>
<a class="sourceLine" id="cb1236-30" title="30"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb1236-31" title="31">    result <span class="op">=</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-112">Run 2</h4>
<div class="sourceCode" id="cb1238"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1238-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb1238-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb1238-3" title="3"></a>
<a class="sourceLine" id="cb1238-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1238-5" title="5"><span class="co">compute sin(pi/2)</span></a>
<a class="sourceLine" id="cb1238-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1238-7" title="7">x <span class="op">=</span> math.sin(math.pi <span class="op">/</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1238-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1238-9" title="9"></a>
<a class="sourceLine" id="cb1238-10" title="10"><span class="kw">def</span> heating_energy(n, T1, T2):</a>
<a class="sourceLine" id="cb1238-11" title="11">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1238-12" title="12"><span class="co">   This function returns the energy in kcal required to heat n moles of water from T1 to T2</span></a>
<a class="sourceLine" id="cb1238-13" title="13"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1238-14" title="14">   <span class="cf">return</span> n <span class="op">*</span> (T2 <span class="op">-</span> T1) <span class="op">*</span> <span class="fl">4.184</span></a>
<a class="sourceLine" id="cb1238-15" title="15"></a>
<a class="sourceLine" id="cb1238-16" title="16"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1238-17" title="17"></a>
<a class="sourceLine" id="cb1238-18" title="18">n <span class="op">=</span> <span class="dv">2</span></a>
<a class="sourceLine" id="cb1238-19" title="19">T1 <span class="op">=</span> <span class="dv">300</span></a>
<a class="sourceLine" id="cb1238-20" title="20">T2 <span class="op">=</span> <span class="dv">350</span></a>
<a class="sourceLine" id="cb1238-21" title="21">C <span class="op">=</span> <span class="dv">1</span><span class="op">*</span><span class="fl">18.</span><span class="op">/</span><span class="dv">1000</span> <span class="co">#cal/g/deg</span></a>
<a class="sourceLine" id="cb1238-22" title="22">q <span class="op">=</span> n<span class="op">*</span>C<span class="op">*</span>(T2<span class="op">-</span>T1)</a>
<a class="sourceLine" id="cb1238-23" title="23"><span class="co"># heat in kilocalories</span></a>
<a class="sourceLine" id="cb1238-24" title="24"></a>
<a class="sourceLine" id="cb1238-25" title="25">q_codex <span class="op">=</span> heating_energy(n, T1, T2)</a>
<a class="sourceLine" id="cb1238-26" title="26"></a>
<a class="sourceLine" id="cb1238-27" title="27"><span class="co"># check </span></a>
<a class="sourceLine" id="cb1238-28" title="28"><span class="cf">if</span> np.isclose(q, q_codex, rtol<span class="op">=</span><span class="fl">0.01</span>) <span class="op">==</span> <span class="va">True</span>:</a>
<a class="sourceLine" id="cb1238-29" title="29">    result <span class="op">=</span> <span class="va">True</span> </a>
<a class="sourceLine" id="cb1238-30" title="30"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb1238-31" title="31">    result <span class="op">=</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-112">Run 3</h4>
<div class="sourceCode" id="cb1240"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1240-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb1240-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb1240-3" title="3"></a>
<a class="sourceLine" id="cb1240-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1240-5" title="5"><span class="co">compute sin(pi/2)</span></a>
<a class="sourceLine" id="cb1240-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1240-7" title="7">x <span class="op">=</span> math.sin(math.pi <span class="op">/</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1240-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1240-9" title="9"></a>
<a class="sourceLine" id="cb1240-10" title="10"><span class="kw">def</span> heating_energy(n, T1, T2):</a>
<a class="sourceLine" id="cb1240-11" title="11">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1240-12" title="12"><span class="co">   This function returns the energy in kcal required to heat n moles of water from T1 to T2</span></a>
<a class="sourceLine" id="cb1240-13" title="13"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1240-14" title="14">   <span class="cf">return</span> n <span class="op">*</span> (T2 <span class="op">-</span> T1) <span class="op">*</span> <span class="fl">4.184</span></a>
<a class="sourceLine" id="cb1240-15" title="15"></a>
<a class="sourceLine" id="cb1240-16" title="16"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1240-17" title="17"></a>
<a class="sourceLine" id="cb1240-18" title="18">n <span class="op">=</span> <span class="dv">2</span></a>
<a class="sourceLine" id="cb1240-19" title="19">T1 <span class="op">=</span> <span class="dv">300</span></a>
<a class="sourceLine" id="cb1240-20" title="20">T2 <span class="op">=</span> <span class="dv">350</span></a>
<a class="sourceLine" id="cb1240-21" title="21">C <span class="op">=</span> <span class="dv">1</span><span class="op">*</span><span class="fl">18.</span><span class="op">/</span><span class="dv">1000</span> <span class="co">#cal/g/deg</span></a>
<a class="sourceLine" id="cb1240-22" title="22">q <span class="op">=</span> n<span class="op">*</span>C<span class="op">*</span>(T2<span class="op">-</span>T1)</a>
<a class="sourceLine" id="cb1240-23" title="23"><span class="co"># heat in kilocalories</span></a>
<a class="sourceLine" id="cb1240-24" title="24"></a>
<a class="sourceLine" id="cb1240-25" title="25">q_codex <span class="op">=</span> heating_energy(n, T1, T2)</a>
<a class="sourceLine" id="cb1240-26" title="26"></a>
<a class="sourceLine" id="cb1240-27" title="27"><span class="co"># check </span></a>
<a class="sourceLine" id="cb1240-28" title="28"><span class="cf">if</span> np.isclose(q, q_codex, rtol<span class="op">=</span><span class="fl">0.01</span>) <span class="op">==</span> <span class="va">True</span>:</a>
<a class="sourceLine" id="cb1240-29" title="29">    result <span class="op">=</span> <span class="va">True</span> </a>
<a class="sourceLine" id="cb1240-30" title="30"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb1240-31" title="31">    result <span class="op">=</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-112">Run 4</h4>
<div class="sourceCode" id="cb1242"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1242-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb1242-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb1242-3" title="3"></a>
<a class="sourceLine" id="cb1242-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1242-5" title="5"><span class="co">compute sin(pi/2)</span></a>
<a class="sourceLine" id="cb1242-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1242-7" title="7">x <span class="op">=</span> math.sin(math.pi <span class="op">/</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1242-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1242-9" title="9"></a>
<a class="sourceLine" id="cb1242-10" title="10"><span class="kw">def</span> heating_energy(n, T1, T2):</a>
<a class="sourceLine" id="cb1242-11" title="11">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1242-12" title="12"><span class="co">   This function returns the energy in kcal required to heat n moles of water from T1 to T2</span></a>
<a class="sourceLine" id="cb1242-13" title="13"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1242-14" title="14">   <span class="cf">return</span> n <span class="op">*</span> <span class="fl">4.184</span> <span class="op">*</span> (T2 <span class="op">-</span> T1)</a>
<a class="sourceLine" id="cb1242-15" title="15"></a>
<a class="sourceLine" id="cb1242-16" title="16"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1242-17" title="17"></a>
<a class="sourceLine" id="cb1242-18" title="18">n <span class="op">=</span> <span class="dv">2</span></a>
<a class="sourceLine" id="cb1242-19" title="19">T1 <span class="op">=</span> <span class="dv">300</span></a>
<a class="sourceLine" id="cb1242-20" title="20">T2 <span class="op">=</span> <span class="dv">350</span></a>
<a class="sourceLine" id="cb1242-21" title="21">C <span class="op">=</span> <span class="dv">1</span><span class="op">*</span><span class="fl">18.</span><span class="op">/</span><span class="dv">1000</span> <span class="co">#cal/g/deg</span></a>
<a class="sourceLine" id="cb1242-22" title="22">q <span class="op">=</span> n<span class="op">*</span>C<span class="op">*</span>(T2<span class="op">-</span>T1)</a>
<a class="sourceLine" id="cb1242-23" title="23"><span class="co"># heat in kilocalories</span></a>
<a class="sourceLine" id="cb1242-24" title="24"></a>
<a class="sourceLine" id="cb1242-25" title="25">q_codex <span class="op">=</span> heating_energy(n, T1, T2)</a>
<a class="sourceLine" id="cb1242-26" title="26"></a>
<a class="sourceLine" id="cb1242-27" title="27"><span class="co"># check </span></a>
<a class="sourceLine" id="cb1242-28" title="28"><span class="cf">if</span> np.isclose(q, q_codex, rtol<span class="op">=</span><span class="fl">0.01</span>) <span class="op">==</span> <span class="va">True</span>:</a>
<a class="sourceLine" id="cb1242-29" title="29">    result <span class="op">=</span> <span class="va">True</span> </a>
<a class="sourceLine" id="cb1242-30" title="30"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb1242-31" title="31">    result <span class="op">=</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>hydrophobic_res</summary></p>
<h4 id="query-113">Query</h4>
<div class="sourceCode" id="cb1244"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1244-1" title="1"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb1244-2" title="2"></a>
<a class="sourceLine" id="cb1244-3" title="3"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1244-4" title="4"><span class="co">Print version string</span></a>
<a class="sourceLine" id="cb1244-5" title="5"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1244-6" title="6"><span class="bu">print</span>(md.version.full_version)</a>
<a class="sourceLine" id="cb1244-7" title="7"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1244-8" title="8"></a>
<a class="sourceLine" id="cb1244-9" title="9"><span class="kw">def</span> get_hydrophobic_residues(pdb_filename):</a>
<a class="sourceLine" id="cb1244-10" title="10">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1244-11" title="11"><span class="co">  Returns list of hydrophobic residues indices</span></a>
<a class="sourceLine" id="cb1244-12" title="12"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1244-13" title="13">  </a></code></pre></div>
<h4 id="run-0-113">Run 0</h4>
<div class="sourceCode" id="cb1245"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1245-1" title="1"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb1245-2" title="2"></a>
<a class="sourceLine" id="cb1245-3" title="3"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1245-4" title="4"><span class="co">Print version string</span></a>
<a class="sourceLine" id="cb1245-5" title="5"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1245-6" title="6"><span class="bu">print</span>(md.version.full_version)</a>
<a class="sourceLine" id="cb1245-7" title="7"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1245-8" title="8"></a>
<a class="sourceLine" id="cb1245-9" title="9"><span class="kw">def</span> get_hydrophobic_residues(pdb_filename):</a>
<a class="sourceLine" id="cb1245-10" title="10">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1245-11" title="11"><span class="co">  Returns list of hydrophobic residues indices</span></a>
<a class="sourceLine" id="cb1245-12" title="12"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1245-13" title="13">  <span class="co"># load pdb file</span></a>
<a class="sourceLine" id="cb1245-14" title="14">  pdb <span class="op">=</span> md.load_pdb(pdb_filename)</a>
<a class="sourceLine" id="cb1245-15" title="15">  <span class="co"># get list of hydrophobic residues</span></a>
<a class="sourceLine" id="cb1245-16" title="16">  hydrophobic_residues <span class="op">=</span> [residue.index <span class="cf">for</span> residue <span class="kw">in</span> pdb.topology.residues <span class="cf">if</span> residue.is_hydrophobic]</a>
<a class="sourceLine" id="cb1245-17" title="17">  <span class="co"># return list of hydrophobic residues</span></a>
<a class="sourceLine" id="cb1245-18" title="18">  <span class="cf">return</span> hydrophobic_residues</a>
<a class="sourceLine" id="cb1245-19" title="19"></a>
<a class="sourceLine" id="cb1245-20" title="20"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb1245-21" title="21">t <span class="op">=</span> md.load(os.path.join(_FILE_DIR_, <span class="st">&#39;e22g.pdb&#39;</span>))</a>
<a class="sourceLine" id="cb1245-22" title="22">top <span class="op">=</span> t.topology</a>
<a class="sourceLine" id="cb1245-23" title="23">hp_res_list <span class="op">=</span> [<span class="st">&#39;ALA&#39;</span>, <span class="st">&#39;VAL&#39;</span>, <span class="st">&#39;LEU&#39;</span>, <span class="st">&#39;ILE&#39;</span>, <span class="st">&#39;PRO&#39;</span>, <span class="st">&#39;PHE&#39;</span>, <span class="st">&#39;CYS&#39;</span>]</a>
<a class="sourceLine" id="cb1245-24" title="24">hydrophobic_res <span class="op">=</span> [res.index <span class="cf">for</span> res <span class="kw">in</span> top.residues <span class="cf">if</span> <span class="bu">str</span>(res)[</a>
<a class="sourceLine" id="cb1245-25" title="25">    :<span class="dv">3</span>] <span class="kw">in</span> hp_res_list]</a>
<a class="sourceLine" id="cb1245-26" title="26"><span class="bu">print</span>(hydrophobic_res)</a>
<a class="sourceLine" id="cb1245-27" title="27">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> get_hydrophobic_residues(os.path.join(</a>
<a class="sourceLine" id="cb1245-28" title="28">    _FILE_DIR_, <span class="st">&#39;e22g.pdb&#39;</span>)) <span class="op">==</span> hydrophobic_res <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>&#39;Residue&#39; object has no attribute &#39;is_hydrophobic&#39;</code></pre>
<h4 id="run-1-113">Run 1</h4>
<div class="sourceCode" id="cb1247"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1247-1" title="1"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb1247-2" title="2"></a>
<a class="sourceLine" id="cb1247-3" title="3"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1247-4" title="4"><span class="co">Print version string</span></a>
<a class="sourceLine" id="cb1247-5" title="5"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1247-6" title="6"><span class="bu">print</span>(md.version.full_version)</a>
<a class="sourceLine" id="cb1247-7" title="7"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1247-8" title="8"></a>
<a class="sourceLine" id="cb1247-9" title="9"><span class="kw">def</span> get_hydrophobic_residues(pdb_filename):</a>
<a class="sourceLine" id="cb1247-10" title="10">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1247-11" title="11"><span class="co">  Returns list of hydrophobic residues indices</span></a>
<a class="sourceLine" id="cb1247-12" title="12"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1247-13" title="13">  <span class="co"># load pdb file</span></a>
<a class="sourceLine" id="cb1247-14" title="14">  traj <span class="op">=</span> md.load(pdb_filename)</a>
<a class="sourceLine" id="cb1247-15" title="15">  <span class="co"># get topology</span></a>
<a class="sourceLine" id="cb1247-16" title="16">  topology <span class="op">=</span> traj.topology</a>
<a class="sourceLine" id="cb1247-17" title="17">  <span class="co"># get residues</span></a>
<a class="sourceLine" id="cb1247-18" title="18">  residues <span class="op">=</span> topology.residues</a>
<a class="sourceLine" id="cb1247-19" title="19">  <span class="co"># get residue names</span></a>
<a class="sourceLine" id="cb1247-20" title="20">  residue_names <span class="op">=</span> [residue.name <span class="cf">for</span> residue <span class="kw">in</span> residues]</a>
<a class="sourceLine" id="cb1247-21" title="21">  <span class="co"># get hydrophobic residues</span></a>
<a class="sourceLine" id="cb1247-22" title="22">  hydrophobic_residues <span class="op">=</span> [residue_name <span class="cf">for</span> residue_name <span class="kw">in</span> residue_names <span class="cf">if</span> residue_name <span class="kw">in</span> [<span class="st">&#39;ALA&#39;</span>, <span class="st">&#39;VAL&#39;</span>, <span class="st">&#39;ILE&#39;</span>, <span class="st">&#39;LEU&#39;</span>, <span class="st">&#39;PHE&#39;</span>, <span class="st">&#39;TYR&#39;</span>, <span class="st">&#39;TRP&#39;</span>]]</a>
<a class="sourceLine" id="cb1247-23" title="23">  <span class="co"># get hydrophobic residues indices</span></a>
<a class="sourceLine" id="cb1247-24" title="24">  hydrophobic_residues_indices <span class="op">=</span> [residue_index <span class="cf">for</span> residue_index, residue_name <span class="kw">in</span> <span class="bu">enumerate</span>(residue_names) <span class="cf">if</span> residue_name <span class="kw">in</span> hydrophobic_residues]</a>
<a class="sourceLine" id="cb1247-25" title="25">  <span class="co"># return hydrophobic residues indices</span></a>
<a class="sourceLine" id="cb1247-26" title="26">  <span class="cf">return</span> hydrophobic_residues_indices</a>
<a class="sourceLine" id="cb1247-27" title="27"></a>
<a class="sourceLine" id="cb1247-28" title="28"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb1247-29" title="29">t <span class="op">=</span> md.load(os.path.join(_FILE_DIR_, <span class="st">&#39;e22g.pdb&#39;</span>))</a>
<a class="sourceLine" id="cb1247-30" title="30">top <span class="op">=</span> t.topology</a>
<a class="sourceLine" id="cb1247-31" title="31">hp_res_list <span class="op">=</span> [<span class="st">&#39;ALA&#39;</span>, <span class="st">&#39;VAL&#39;</span>, <span class="st">&#39;LEU&#39;</span>, <span class="st">&#39;ILE&#39;</span>, <span class="st">&#39;PRO&#39;</span>, <span class="st">&#39;PHE&#39;</span>, <span class="st">&#39;CYS&#39;</span>]</a>
<a class="sourceLine" id="cb1247-32" title="32">hydrophobic_res <span class="op">=</span> [res.index <span class="cf">for</span> res <span class="kw">in</span> top.residues <span class="cf">if</span> <span class="bu">str</span>(res)[</a>
<a class="sourceLine" id="cb1247-33" title="33">    :<span class="dv">3</span>] <span class="kw">in</span> hp_res_list]</a>
<a class="sourceLine" id="cb1247-34" title="34"><span class="bu">print</span>(hydrophobic_res)</a>
<a class="sourceLine" id="cb1247-35" title="35">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> get_hydrophobic_residues(os.path.join(</a>
<a class="sourceLine" id="cb1247-36" title="36">    _FILE_DIR_, <span class="st">&#39;e22g.pdb&#39;</span>)) <span class="op">==</span> hydrophobic_res <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-113">Run 2</h4>
<div class="sourceCode" id="cb1249"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1249-1" title="1"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb1249-2" title="2"></a>
<a class="sourceLine" id="cb1249-3" title="3"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1249-4" title="4"><span class="co">Print version string</span></a>
<a class="sourceLine" id="cb1249-5" title="5"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1249-6" title="6"><span class="bu">print</span>(md.version.full_version)</a>
<a class="sourceLine" id="cb1249-7" title="7"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1249-8" title="8"></a>
<a class="sourceLine" id="cb1249-9" title="9"><span class="kw">def</span> get_hydrophobic_residues(pdb_filename):</a>
<a class="sourceLine" id="cb1249-10" title="10">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1249-11" title="11"><span class="co">  Returns list of hydrophobic residues indices</span></a>
<a class="sourceLine" id="cb1249-12" title="12"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1249-13" title="13">  <span class="co"># load pdb file</span></a>
<a class="sourceLine" id="cb1249-14" title="14">  pdb_file <span class="op">=</span> md.load_pdb(pdb_filename)</a>
<a class="sourceLine" id="cb1249-15" title="15">  <span class="co"># get list of hydrophobic residues</span></a>
<a class="sourceLine" id="cb1249-16" title="16">  hydrophobic_residues <span class="op">=</span> [residue.index <span class="cf">for</span> residue <span class="kw">in</span> pdb_file.topology.residues <span class="cf">if</span> residue.is_hydrophobic]</a>
<a class="sourceLine" id="cb1249-17" title="17">  <span class="co"># return list of hydrophobic residues</span></a>
<a class="sourceLine" id="cb1249-18" title="18">  <span class="cf">return</span> hydrophobic_residues</a>
<a class="sourceLine" id="cb1249-19" title="19"></a>
<a class="sourceLine" id="cb1249-20" title="20"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb1249-21" title="21">t <span class="op">=</span> md.load(os.path.join(_FILE_DIR_, <span class="st">&#39;e22g.pdb&#39;</span>))</a>
<a class="sourceLine" id="cb1249-22" title="22">top <span class="op">=</span> t.topology</a>
<a class="sourceLine" id="cb1249-23" title="23">hp_res_list <span class="op">=</span> [<span class="st">&#39;ALA&#39;</span>, <span class="st">&#39;VAL&#39;</span>, <span class="st">&#39;LEU&#39;</span>, <span class="st">&#39;ILE&#39;</span>, <span class="st">&#39;PRO&#39;</span>, <span class="st">&#39;PHE&#39;</span>, <span class="st">&#39;CYS&#39;</span>]</a>
<a class="sourceLine" id="cb1249-24" title="24">hydrophobic_res <span class="op">=</span> [res.index <span class="cf">for</span> res <span class="kw">in</span> top.residues <span class="cf">if</span> <span class="bu">str</span>(res)[</a>
<a class="sourceLine" id="cb1249-25" title="25">    :<span class="dv">3</span>] <span class="kw">in</span> hp_res_list]</a>
<a class="sourceLine" id="cb1249-26" title="26"><span class="bu">print</span>(hydrophobic_res)</a>
<a class="sourceLine" id="cb1249-27" title="27">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> get_hydrophobic_residues(os.path.join(</a>
<a class="sourceLine" id="cb1249-28" title="28">    _FILE_DIR_, <span class="st">&#39;e22g.pdb&#39;</span>)) <span class="op">==</span> hydrophobic_res <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>&#39;Residue&#39; object has no attribute &#39;is_hydrophobic&#39;</code></pre>
<h4 id="run-3-113">Run 3</h4>
<div class="sourceCode" id="cb1251"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1251-1" title="1"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb1251-2" title="2"></a>
<a class="sourceLine" id="cb1251-3" title="3"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1251-4" title="4"><span class="co">Print version string</span></a>
<a class="sourceLine" id="cb1251-5" title="5"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1251-6" title="6"><span class="bu">print</span>(md.version.full_version)</a>
<a class="sourceLine" id="cb1251-7" title="7"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1251-8" title="8"></a>
<a class="sourceLine" id="cb1251-9" title="9"><span class="kw">def</span> get_hydrophobic_residues(pdb_filename):</a>
<a class="sourceLine" id="cb1251-10" title="10">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1251-11" title="11"><span class="co">  Returns list of hydrophobic residues indices</span></a>
<a class="sourceLine" id="cb1251-12" title="12"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1251-13" title="13">  <span class="co"># Load PDB file</span></a>
<a class="sourceLine" id="cb1251-14" title="14">  pdb <span class="op">=</span> md.load_pdb(pdb_filename)</a>
<a class="sourceLine" id="cb1251-15" title="15">  <span class="co"># Get list of all residues</span></a>
<a class="sourceLine" id="cb1251-16" title="16">  residues <span class="op">=</span> pdb.topology.residues</a>
<a class="sourceLine" id="cb1251-17" title="17">  <span class="co"># Get list of hydrophobic residues</span></a>
<a class="sourceLine" id="cb1251-18" title="18">  hydrophobic_residues <span class="op">=</span> [residue.index <span class="cf">for</span> residue <span class="kw">in</span> residues <span class="cf">if</span> residue.is_hydrophobic]</a>
<a class="sourceLine" id="cb1251-19" title="19">  <span class="co"># Return list of hydrophobic residues</span></a>
<a class="sourceLine" id="cb1251-20" title="20">  <span class="cf">return</span> hydrophobic_residues</a>
<a class="sourceLine" id="cb1251-21" title="21"></a>
<a class="sourceLine" id="cb1251-22" title="22"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb1251-23" title="23">t <span class="op">=</span> md.load(os.path.join(_FILE_DIR_, <span class="st">&#39;e22g.pdb&#39;</span>))</a>
<a class="sourceLine" id="cb1251-24" title="24">top <span class="op">=</span> t.topology</a>
<a class="sourceLine" id="cb1251-25" title="25">hp_res_list <span class="op">=</span> [<span class="st">&#39;ALA&#39;</span>, <span class="st">&#39;VAL&#39;</span>, <span class="st">&#39;LEU&#39;</span>, <span class="st">&#39;ILE&#39;</span>, <span class="st">&#39;PRO&#39;</span>, <span class="st">&#39;PHE&#39;</span>, <span class="st">&#39;CYS&#39;</span>]</a>
<a class="sourceLine" id="cb1251-26" title="26">hydrophobic_res <span class="op">=</span> [res.index <span class="cf">for</span> res <span class="kw">in</span> top.residues <span class="cf">if</span> <span class="bu">str</span>(res)[</a>
<a class="sourceLine" id="cb1251-27" title="27">    :<span class="dv">3</span>] <span class="kw">in</span> hp_res_list]</a>
<a class="sourceLine" id="cb1251-28" title="28"><span class="bu">print</span>(hydrophobic_res)</a>
<a class="sourceLine" id="cb1251-29" title="29">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> get_hydrophobic_residues(os.path.join(</a>
<a class="sourceLine" id="cb1251-30" title="30">    _FILE_DIR_, <span class="st">&#39;e22g.pdb&#39;</span>)) <span class="op">==</span> hydrophobic_res <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>&#39;Residue&#39; object has no attribute &#39;is_hydrophobic&#39;</code></pre>
<h4 id="run-4-113">Run 4</h4>
<div class="sourceCode" id="cb1253"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1253-1" title="1"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb1253-2" title="2"></a>
<a class="sourceLine" id="cb1253-3" title="3"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1253-4" title="4"><span class="co">Print version string</span></a>
<a class="sourceLine" id="cb1253-5" title="5"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1253-6" title="6"><span class="bu">print</span>(md.version.full_version)</a>
<a class="sourceLine" id="cb1253-7" title="7"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1253-8" title="8"></a>
<a class="sourceLine" id="cb1253-9" title="9"><span class="kw">def</span> get_hydrophobic_residues(pdb_filename):</a>
<a class="sourceLine" id="cb1253-10" title="10">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1253-11" title="11"><span class="co">  Returns list of hydrophobic residues indices</span></a>
<a class="sourceLine" id="cb1253-12" title="12"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1253-13" title="13">  <span class="co"># Load PDB file</span></a>
<a class="sourceLine" id="cb1253-14" title="14">  pdb <span class="op">=</span> md.load_pdb(pdb_filename)</a>
<a class="sourceLine" id="cb1253-15" title="15">  <span class="co"># Get residue names</span></a>
<a class="sourceLine" id="cb1253-16" title="16">  residue_names <span class="op">=</span> pdb.topology.residue_names</a>
<a class="sourceLine" id="cb1253-17" title="17">  <span class="co"># Get hydrophobic residues</span></a>
<a class="sourceLine" id="cb1253-18" title="18">  hydrophobic_residues <span class="op">=</span> []</a>
<a class="sourceLine" id="cb1253-19" title="19">  <span class="cf">for</span> i, residue <span class="kw">in</span> <span class="bu">enumerate</span>(residue_names):</a>
<a class="sourceLine" id="cb1253-20" title="20">    <span class="cf">if</span> residue <span class="kw">in</span> [<span class="st">&#39;ALA&#39;</span>, <span class="st">&#39;VAL&#39;</span>, <span class="st">&#39;LEU&#39;</span>, <span class="st">&#39;ILE&#39;</span>, <span class="st">&#39;MET&#39;</span>, <span class="st">&#39;PHE&#39;</span>, <span class="st">&#39;TRP&#39;</span>, <span class="st">&#39;PRO&#39;</span>]:</a>
<a class="sourceLine" id="cb1253-21" title="21">      hydrophobic_residues.append(i)</a>
<a class="sourceLine" id="cb1253-22" title="22">  <span class="co"># Return hydrophobic residues</span></a>
<a class="sourceLine" id="cb1253-23" title="23">  <span class="cf">return</span> hydrophobic_residues</a>
<a class="sourceLine" id="cb1253-24" title="24"></a>
<a class="sourceLine" id="cb1253-25" title="25"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb1253-26" title="26">t <span class="op">=</span> md.load(os.path.join(_FILE_DIR_, <span class="st">&#39;e22g.pdb&#39;</span>))</a>
<a class="sourceLine" id="cb1253-27" title="27">top <span class="op">=</span> t.topology</a>
<a class="sourceLine" id="cb1253-28" title="28">hp_res_list <span class="op">=</span> [<span class="st">&#39;ALA&#39;</span>, <span class="st">&#39;VAL&#39;</span>, <span class="st">&#39;LEU&#39;</span>, <span class="st">&#39;ILE&#39;</span>, <span class="st">&#39;PRO&#39;</span>, <span class="st">&#39;PHE&#39;</span>, <span class="st">&#39;CYS&#39;</span>]</a>
<a class="sourceLine" id="cb1253-29" title="29">hydrophobic_res <span class="op">=</span> [res.index <span class="cf">for</span> res <span class="kw">in</span> top.residues <span class="cf">if</span> <span class="bu">str</span>(res)[</a>
<a class="sourceLine" id="cb1253-30" title="30">    :<span class="dv">3</span>] <span class="kw">in</span> hp_res_list]</a>
<a class="sourceLine" id="cb1253-31" title="31"><span class="bu">print</span>(hydrophobic_res)</a>
<a class="sourceLine" id="cb1253-32" title="32">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> get_hydrophobic_residues(os.path.join(</a>
<a class="sourceLine" id="cb1253-33" title="33">    _FILE_DIR_, <span class="st">&#39;e22g.pdb&#39;</span>)) <span class="op">==</span> hydrophobic_res <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>&#39;Topology&#39; object has no attribute &#39;residue_names&#39;</code></pre>
</details>
<details>
<p><summary>ideal_gas</summary></p>
<h4 id="query-114">Query</h4>
<div class="sourceCode" id="cb1255"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1255-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb1255-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb1255-3" title="3"></a>
<a class="sourceLine" id="cb1255-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1255-5" title="5"><span class="co">compute sin(pi/2)</span></a>
<a class="sourceLine" id="cb1255-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1255-7" title="7">x <span class="op">=</span> math.sin(math.pi <span class="op">/</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1255-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1255-9" title="9"></a>
<a class="sourceLine" id="cb1255-10" title="10"><span class="kw">def</span> ideal_gas_pressure(n,V,T):</a>
<a class="sourceLine" id="cb1255-11" title="11">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1255-12" title="12"><span class="co">   This function returns the pressure for n moles of an ideal gas at temperature T and volume V, using the ideal gas equation of state.</span></a>
<a class="sourceLine" id="cb1255-13" title="13"><span class="co">   The pressure returned is in atm units.</span></a>
<a class="sourceLine" id="cb1255-14" title="14"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1255-15" title="15">   </a></code></pre></div>
<h4 id="run-0-114">Run 0</h4>
<div class="sourceCode" id="cb1256"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1256-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb1256-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb1256-3" title="3"></a>
<a class="sourceLine" id="cb1256-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1256-5" title="5"><span class="co">compute sin(pi/2)</span></a>
<a class="sourceLine" id="cb1256-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1256-7" title="7">x <span class="op">=</span> math.sin(math.pi <span class="op">/</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1256-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1256-9" title="9"></a>
<a class="sourceLine" id="cb1256-10" title="10"><span class="kw">def</span> ideal_gas_pressure(n,V,T):</a>
<a class="sourceLine" id="cb1256-11" title="11">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1256-12" title="12"><span class="co">   This function returns the pressure for n moles of an ideal gas at temperature T and volume V, using the ideal gas equation of state.</span></a>
<a class="sourceLine" id="cb1256-13" title="13"><span class="co">   The pressure returned is in atm units.</span></a>
<a class="sourceLine" id="cb1256-14" title="14"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1256-15" title="15">   R <span class="op">=</span> <span class="fl">0.08205746</span> <span class="co"># atm L / mol K</span></a>
<a class="sourceLine" id="cb1256-16" title="16">   <span class="cf">return</span> n <span class="op">*</span> R <span class="op">*</span> T <span class="op">/</span> V</a>
<a class="sourceLine" id="cb1256-17" title="17"></a>
<a class="sourceLine" id="cb1256-18" title="18"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1256-19" title="19"></a>
<a class="sourceLine" id="cb1256-20" title="20"><span class="co"># input</span></a>
<a class="sourceLine" id="cb1256-21" title="21">V <span class="op">=</span> <span class="fl">20.0</span>    <span class="co"># volume (in L)</span></a>
<a class="sourceLine" id="cb1256-22" title="22">n <span class="op">=</span> <span class="fl">10.0</span>    <span class="co"># in moles</span></a>
<a class="sourceLine" id="cb1256-23" title="23">R <span class="op">=</span> <span class="fl">0.08206</span>  <span class="co"># in L.atm/mol.K</span></a>
<a class="sourceLine" id="cb1256-24" title="24">T <span class="op">=</span> <span class="dv">350</span>     <span class="co"># in K </span></a>
<a class="sourceLine" id="cb1256-25" title="25"></a>
<a class="sourceLine" id="cb1256-26" title="26">P <span class="op">=</span> n<span class="op">*</span>R<span class="op">*</span>T<span class="op">/</span>V</a>
<a class="sourceLine" id="cb1256-27" title="27"><span class="co">#print(&quot;Pressure =&quot;, P)</span></a>
<a class="sourceLine" id="cb1256-28" title="28"></a>
<a class="sourceLine" id="cb1256-29" title="29">codex_pressure <span class="op">=</span> ideal_gas_pressure(n,V,T)</a>
<a class="sourceLine" id="cb1256-30" title="30"><span class="co">#print(&quot;Codex pressure =&quot;, codex_pressure)</span></a>
<a class="sourceLine" id="cb1256-31" title="31"><span class="co"># check </span></a>
<a class="sourceLine" id="cb1256-32" title="32"><span class="cf">if</span> np.isclose(P, codex_pressure, rtol<span class="op">=</span><span class="fl">0.01</span>) <span class="op">==</span> <span class="va">True</span>:</a>
<a class="sourceLine" id="cb1256-33" title="33">    result <span class="op">=</span> <span class="va">True</span> </a>
<a class="sourceLine" id="cb1256-34" title="34"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb1256-35" title="35">    result <span class="op">=</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-114">Run 1</h4>
<div class="sourceCode" id="cb1258"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1258-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb1258-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb1258-3" title="3"></a>
<a class="sourceLine" id="cb1258-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1258-5" title="5"><span class="co">compute sin(pi/2)</span></a>
<a class="sourceLine" id="cb1258-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1258-7" title="7">x <span class="op">=</span> math.sin(math.pi <span class="op">/</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1258-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1258-9" title="9"></a>
<a class="sourceLine" id="cb1258-10" title="10"><span class="kw">def</span> ideal_gas_pressure(n,V,T):</a>
<a class="sourceLine" id="cb1258-11" title="11">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1258-12" title="12"><span class="co">   This function returns the pressure for n moles of an ideal gas at temperature T and volume V, using the ideal gas equation of state.</span></a>
<a class="sourceLine" id="cb1258-13" title="13"><span class="co">   The pressure returned is in atm units.</span></a>
<a class="sourceLine" id="cb1258-14" title="14"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1258-15" title="15">   R <span class="op">=</span> <span class="fl">0.08205746</span> <span class="co"># atm L / mol K</span></a>
<a class="sourceLine" id="cb1258-16" title="16">   <span class="cf">return</span> n <span class="op">*</span> R <span class="op">*</span> T <span class="op">/</span> V</a>
<a class="sourceLine" id="cb1258-17" title="17"></a>
<a class="sourceLine" id="cb1258-18" title="18"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1258-19" title="19"></a>
<a class="sourceLine" id="cb1258-20" title="20"><span class="co"># input</span></a>
<a class="sourceLine" id="cb1258-21" title="21">V <span class="op">=</span> <span class="fl">20.0</span>    <span class="co"># volume (in L)</span></a>
<a class="sourceLine" id="cb1258-22" title="22">n <span class="op">=</span> <span class="fl">10.0</span>    <span class="co"># in moles</span></a>
<a class="sourceLine" id="cb1258-23" title="23">R <span class="op">=</span> <span class="fl">0.08206</span>  <span class="co"># in L.atm/mol.K</span></a>
<a class="sourceLine" id="cb1258-24" title="24">T <span class="op">=</span> <span class="dv">350</span>     <span class="co"># in K </span></a>
<a class="sourceLine" id="cb1258-25" title="25"></a>
<a class="sourceLine" id="cb1258-26" title="26">P <span class="op">=</span> n<span class="op">*</span>R<span class="op">*</span>T<span class="op">/</span>V</a>
<a class="sourceLine" id="cb1258-27" title="27"><span class="co">#print(&quot;Pressure =&quot;, P)</span></a>
<a class="sourceLine" id="cb1258-28" title="28"></a>
<a class="sourceLine" id="cb1258-29" title="29">codex_pressure <span class="op">=</span> ideal_gas_pressure(n,V,T)</a>
<a class="sourceLine" id="cb1258-30" title="30"><span class="co">#print(&quot;Codex pressure =&quot;, codex_pressure)</span></a>
<a class="sourceLine" id="cb1258-31" title="31"><span class="co"># check </span></a>
<a class="sourceLine" id="cb1258-32" title="32"><span class="cf">if</span> np.isclose(P, codex_pressure, rtol<span class="op">=</span><span class="fl">0.01</span>) <span class="op">==</span> <span class="va">True</span>:</a>
<a class="sourceLine" id="cb1258-33" title="33">    result <span class="op">=</span> <span class="va">True</span> </a>
<a class="sourceLine" id="cb1258-34" title="34"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb1258-35" title="35">    result <span class="op">=</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-114">Run 2</h4>
<div class="sourceCode" id="cb1260"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1260-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb1260-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb1260-3" title="3"></a>
<a class="sourceLine" id="cb1260-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1260-5" title="5"><span class="co">compute sin(pi/2)</span></a>
<a class="sourceLine" id="cb1260-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1260-7" title="7">x <span class="op">=</span> math.sin(math.pi <span class="op">/</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1260-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1260-9" title="9"></a>
<a class="sourceLine" id="cb1260-10" title="10"><span class="kw">def</span> ideal_gas_pressure(n,V,T):</a>
<a class="sourceLine" id="cb1260-11" title="11">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1260-12" title="12"><span class="co">   This function returns the pressure for n moles of an ideal gas at temperature T and volume V, using the ideal gas equation of state.</span></a>
<a class="sourceLine" id="cb1260-13" title="13"><span class="co">   The pressure returned is in atm units.</span></a>
<a class="sourceLine" id="cb1260-14" title="14"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1260-15" title="15">   R <span class="op">=</span> <span class="fl">0.08205746</span> <span class="co"># atm L / mol K</span></a>
<a class="sourceLine" id="cb1260-16" title="16">   <span class="cf">return</span> n <span class="op">*</span> R <span class="op">*</span> T <span class="op">/</span> V</a>
<a class="sourceLine" id="cb1260-17" title="17"></a>
<a class="sourceLine" id="cb1260-18" title="18"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1260-19" title="19"></a>
<a class="sourceLine" id="cb1260-20" title="20"><span class="co"># input</span></a>
<a class="sourceLine" id="cb1260-21" title="21">V <span class="op">=</span> <span class="fl">20.0</span>    <span class="co"># volume (in L)</span></a>
<a class="sourceLine" id="cb1260-22" title="22">n <span class="op">=</span> <span class="fl">10.0</span>    <span class="co"># in moles</span></a>
<a class="sourceLine" id="cb1260-23" title="23">R <span class="op">=</span> <span class="fl">0.08206</span>  <span class="co"># in L.atm/mol.K</span></a>
<a class="sourceLine" id="cb1260-24" title="24">T <span class="op">=</span> <span class="dv">350</span>     <span class="co"># in K </span></a>
<a class="sourceLine" id="cb1260-25" title="25"></a>
<a class="sourceLine" id="cb1260-26" title="26">P <span class="op">=</span> n<span class="op">*</span>R<span class="op">*</span>T<span class="op">/</span>V</a>
<a class="sourceLine" id="cb1260-27" title="27"><span class="co">#print(&quot;Pressure =&quot;, P)</span></a>
<a class="sourceLine" id="cb1260-28" title="28"></a>
<a class="sourceLine" id="cb1260-29" title="29">codex_pressure <span class="op">=</span> ideal_gas_pressure(n,V,T)</a>
<a class="sourceLine" id="cb1260-30" title="30"><span class="co">#print(&quot;Codex pressure =&quot;, codex_pressure)</span></a>
<a class="sourceLine" id="cb1260-31" title="31"><span class="co"># check </span></a>
<a class="sourceLine" id="cb1260-32" title="32"><span class="cf">if</span> np.isclose(P, codex_pressure, rtol<span class="op">=</span><span class="fl">0.01</span>) <span class="op">==</span> <span class="va">True</span>:</a>
<a class="sourceLine" id="cb1260-33" title="33">    result <span class="op">=</span> <span class="va">True</span> </a>
<a class="sourceLine" id="cb1260-34" title="34"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb1260-35" title="35">    result <span class="op">=</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-114">Run 3</h4>
<div class="sourceCode" id="cb1262"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1262-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb1262-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb1262-3" title="3"></a>
<a class="sourceLine" id="cb1262-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1262-5" title="5"><span class="co">compute sin(pi/2)</span></a>
<a class="sourceLine" id="cb1262-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1262-7" title="7">x <span class="op">=</span> math.sin(math.pi <span class="op">/</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1262-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1262-9" title="9"></a>
<a class="sourceLine" id="cb1262-10" title="10"><span class="kw">def</span> ideal_gas_pressure(n,V,T):</a>
<a class="sourceLine" id="cb1262-11" title="11">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1262-12" title="12"><span class="co">   This function returns the pressure for n moles of an ideal gas at temperature T and volume V, using the ideal gas equation of state.</span></a>
<a class="sourceLine" id="cb1262-13" title="13"><span class="co">   The pressure returned is in atm units.</span></a>
<a class="sourceLine" id="cb1262-14" title="14"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1262-15" title="15">   R <span class="op">=</span> <span class="fl">0.08205746</span> <span class="co"># atm L / mol K</span></a>
<a class="sourceLine" id="cb1262-16" title="16">   <span class="cf">return</span> n <span class="op">*</span> R <span class="op">*</span> T <span class="op">/</span> V</a>
<a class="sourceLine" id="cb1262-17" title="17"></a>
<a class="sourceLine" id="cb1262-18" title="18"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1262-19" title="19"></a>
<a class="sourceLine" id="cb1262-20" title="20"><span class="co"># input</span></a>
<a class="sourceLine" id="cb1262-21" title="21">V <span class="op">=</span> <span class="fl">20.0</span>    <span class="co"># volume (in L)</span></a>
<a class="sourceLine" id="cb1262-22" title="22">n <span class="op">=</span> <span class="fl">10.0</span>    <span class="co"># in moles</span></a>
<a class="sourceLine" id="cb1262-23" title="23">R <span class="op">=</span> <span class="fl">0.08206</span>  <span class="co"># in L.atm/mol.K</span></a>
<a class="sourceLine" id="cb1262-24" title="24">T <span class="op">=</span> <span class="dv">350</span>     <span class="co"># in K </span></a>
<a class="sourceLine" id="cb1262-25" title="25"></a>
<a class="sourceLine" id="cb1262-26" title="26">P <span class="op">=</span> n<span class="op">*</span>R<span class="op">*</span>T<span class="op">/</span>V</a>
<a class="sourceLine" id="cb1262-27" title="27"><span class="co">#print(&quot;Pressure =&quot;, P)</span></a>
<a class="sourceLine" id="cb1262-28" title="28"></a>
<a class="sourceLine" id="cb1262-29" title="29">codex_pressure <span class="op">=</span> ideal_gas_pressure(n,V,T)</a>
<a class="sourceLine" id="cb1262-30" title="30"><span class="co">#print(&quot;Codex pressure =&quot;, codex_pressure)</span></a>
<a class="sourceLine" id="cb1262-31" title="31"><span class="co"># check </span></a>
<a class="sourceLine" id="cb1262-32" title="32"><span class="cf">if</span> np.isclose(P, codex_pressure, rtol<span class="op">=</span><span class="fl">0.01</span>) <span class="op">==</span> <span class="va">True</span>:</a>
<a class="sourceLine" id="cb1262-33" title="33">    result <span class="op">=</span> <span class="va">True</span> </a>
<a class="sourceLine" id="cb1262-34" title="34"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb1262-35" title="35">    result <span class="op">=</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-114">Run 4</h4>
<div class="sourceCode" id="cb1264"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1264-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb1264-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb1264-3" title="3"></a>
<a class="sourceLine" id="cb1264-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1264-5" title="5"><span class="co">compute sin(pi/2)</span></a>
<a class="sourceLine" id="cb1264-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1264-7" title="7">x <span class="op">=</span> math.sin(math.pi <span class="op">/</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1264-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1264-9" title="9"></a>
<a class="sourceLine" id="cb1264-10" title="10"><span class="kw">def</span> ideal_gas_pressure(n,V,T):</a>
<a class="sourceLine" id="cb1264-11" title="11">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1264-12" title="12"><span class="co">   This function returns the pressure for n moles of an ideal gas at temperature T and volume V, using the ideal gas equation of state.</span></a>
<a class="sourceLine" id="cb1264-13" title="13"><span class="co">   The pressure returned is in atm units.</span></a>
<a class="sourceLine" id="cb1264-14" title="14"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1264-15" title="15">   R <span class="op">=</span> <span class="fl">0.08205746</span> <span class="co"># L atm / mol K</span></a>
<a class="sourceLine" id="cb1264-16" title="16">   <span class="cf">return</span> n <span class="op">*</span> R <span class="op">*</span> T <span class="op">/</span> V</a>
<a class="sourceLine" id="cb1264-17" title="17"></a>
<a class="sourceLine" id="cb1264-18" title="18"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1264-19" title="19"></a>
<a class="sourceLine" id="cb1264-20" title="20"><span class="co"># input</span></a>
<a class="sourceLine" id="cb1264-21" title="21">V <span class="op">=</span> <span class="fl">20.0</span>    <span class="co"># volume (in L)</span></a>
<a class="sourceLine" id="cb1264-22" title="22">n <span class="op">=</span> <span class="fl">10.0</span>    <span class="co"># in moles</span></a>
<a class="sourceLine" id="cb1264-23" title="23">R <span class="op">=</span> <span class="fl">0.08206</span>  <span class="co"># in L.atm/mol.K</span></a>
<a class="sourceLine" id="cb1264-24" title="24">T <span class="op">=</span> <span class="dv">350</span>     <span class="co"># in K </span></a>
<a class="sourceLine" id="cb1264-25" title="25"></a>
<a class="sourceLine" id="cb1264-26" title="26">P <span class="op">=</span> n<span class="op">*</span>R<span class="op">*</span>T<span class="op">/</span>V</a>
<a class="sourceLine" id="cb1264-27" title="27"><span class="co">#print(&quot;Pressure =&quot;, P)</span></a>
<a class="sourceLine" id="cb1264-28" title="28"></a>
<a class="sourceLine" id="cb1264-29" title="29">codex_pressure <span class="op">=</span> ideal_gas_pressure(n,V,T)</a>
<a class="sourceLine" id="cb1264-30" title="30"><span class="co">#print(&quot;Codex pressure =&quot;, codex_pressure)</span></a>
<a class="sourceLine" id="cb1264-31" title="31"><span class="co"># check </span></a>
<a class="sourceLine" id="cb1264-32" title="32"><span class="cf">if</span> np.isclose(P, codex_pressure, rtol<span class="op">=</span><span class="fl">0.01</span>) <span class="op">==</span> <span class="va">True</span>:</a>
<a class="sourceLine" id="cb1264-33" title="33">    result <span class="op">=</span> <span class="va">True</span> </a>
<a class="sourceLine" id="cb1264-34" title="34"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb1264-35" title="35">    result <span class="op">=</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>integral</summary></p>
<h4 id="query-115">Query</h4>
<div class="sourceCode" id="cb1266"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1266-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1266-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1266-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1266-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1266-5" title="5"></a>
<a class="sourceLine" id="cb1266-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1266-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1266-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1266-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1266-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1266-11" title="11"></a>
<a class="sourceLine" id="cb1266-12" title="12"><span class="kw">def</span> find_integral(a,b,c,d):</a>
<a class="sourceLine" id="cb1266-13" title="13">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1266-14" title="14"><span class="co">  This function generates a one dimensional polynomial with coefficients a,b,c,d and returns its integral.</span></a>
<a class="sourceLine" id="cb1266-15" title="15"></a>
<a class="sourceLine" id="cb1266-16" title="16"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1266-17" title="17">  </a></code></pre></div>
<h4 id="run-0-115">Run 0</h4>
<div class="sourceCode" id="cb1267"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1267-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1267-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1267-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1267-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1267-5" title="5"></a>
<a class="sourceLine" id="cb1267-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1267-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1267-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1267-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1267-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1267-11" title="11"></a>
<a class="sourceLine" id="cb1267-12" title="12"><span class="kw">def</span> find_integral(a,b,c,d):</a>
<a class="sourceLine" id="cb1267-13" title="13">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1267-14" title="14"><span class="co">  This function generates a one dimensional polynomial with coefficients a,b,c,d and returns its integral.</span></a>
<a class="sourceLine" id="cb1267-15" title="15"></a>
<a class="sourceLine" id="cb1267-16" title="16"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1267-17" title="17">  <span class="cf">return</span> a<span class="op">*</span>d <span class="op">+</span> b<span class="op">*</span>c <span class="op">+</span> c<span class="op">**</span><span class="dv">2</span><span class="op">/</span><span class="dv">2</span> <span class="op">+</span> d<span class="op">**</span><span class="dv">3</span><span class="op">/</span><span class="dv">3</span></a>
<a class="sourceLine" id="cb1267-18" title="18"></a>
<a class="sourceLine" id="cb1267-19" title="19"></a>
<a class="sourceLine" id="cb1267-20" title="20"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1267-21" title="21"></a>
<a class="sourceLine" id="cb1267-22" title="22">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> find_integral(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>) <span class="op">==</span> np.poly1d([<span class="dv">1</span><span class="op">/</span><span class="dv">4</span>, <span class="dv">2</span><span class="op">/</span><span class="dv">3</span>, <span class="dv">3</span><span class="op">/</span><span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">0</span>]) <span class="cf">else</span> <span class="va">False</span> </a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-115">Run 1</h4>
<div class="sourceCode" id="cb1269"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1269-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1269-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1269-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1269-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1269-5" title="5"></a>
<a class="sourceLine" id="cb1269-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1269-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1269-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1269-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1269-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1269-11" title="11"></a>
<a class="sourceLine" id="cb1269-12" title="12"><span class="kw">def</span> find_integral(a,b,c,d):</a>
<a class="sourceLine" id="cb1269-13" title="13">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1269-14" title="14"><span class="co">  This function generates a one dimensional polynomial with coefficients a,b,c,d and returns its integral.</span></a>
<a class="sourceLine" id="cb1269-15" title="15"></a>
<a class="sourceLine" id="cb1269-16" title="16"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1269-17" title="17">  <span class="cf">return</span> a<span class="op">*</span>(b<span class="op">+</span><span class="dv">1</span>)<span class="op">/</span><span class="dv">2</span> <span class="op">+</span> b<span class="op">*</span>(c<span class="op">+</span><span class="dv">1</span>)<span class="op">/</span><span class="dv">2</span> <span class="op">+</span> c<span class="op">*</span>(d<span class="op">+</span><span class="dv">1</span>)<span class="op">/</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb1269-18" title="18"></a>
<a class="sourceLine" id="cb1269-19" title="19"></a>
<a class="sourceLine" id="cb1269-20" title="20"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1269-21" title="21"></a>
<a class="sourceLine" id="cb1269-22" title="22">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> find_integral(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>) <span class="op">==</span> np.poly1d([<span class="dv">1</span><span class="op">/</span><span class="dv">4</span>, <span class="dv">2</span><span class="op">/</span><span class="dv">3</span>, <span class="dv">3</span><span class="op">/</span><span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">0</span>]) <span class="cf">else</span> <span class="va">False</span> </a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-115">Run 2</h4>
<div class="sourceCode" id="cb1271"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1271-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1271-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1271-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1271-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1271-5" title="5"></a>
<a class="sourceLine" id="cb1271-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1271-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1271-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1271-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1271-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1271-11" title="11"></a>
<a class="sourceLine" id="cb1271-12" title="12"><span class="kw">def</span> find_integral(a,b,c,d):</a>
<a class="sourceLine" id="cb1271-13" title="13">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1271-14" title="14"><span class="co">  This function generates a one dimensional polynomial with coefficients a,b,c,d and returns its integral.</span></a>
<a class="sourceLine" id="cb1271-15" title="15"></a>
<a class="sourceLine" id="cb1271-16" title="16"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1271-17" title="17">  <span class="cf">return</span> a<span class="op">*</span>d<span class="op">**</span><span class="dv">3</span><span class="op">/</span><span class="dv">4</span> <span class="op">+</span> b<span class="op">*</span>d<span class="op">**</span><span class="dv">2</span><span class="op">/</span><span class="dv">3</span> <span class="op">+</span> c<span class="op">*</span>d</a>
<a class="sourceLine" id="cb1271-18" title="18"></a>
<a class="sourceLine" id="cb1271-19" title="19"></a>
<a class="sourceLine" id="cb1271-20" title="20"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1271-21" title="21"></a>
<a class="sourceLine" id="cb1271-22" title="22">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> find_integral(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>) <span class="op">==</span> np.poly1d([<span class="dv">1</span><span class="op">/</span><span class="dv">4</span>, <span class="dv">2</span><span class="op">/</span><span class="dv">3</span>, <span class="dv">3</span><span class="op">/</span><span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">0</span>]) <span class="cf">else</span> <span class="va">False</span> </a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-115">Run 3</h4>
<div class="sourceCode" id="cb1273"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1273-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1273-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1273-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1273-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1273-5" title="5"></a>
<a class="sourceLine" id="cb1273-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1273-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1273-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1273-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1273-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1273-11" title="11"></a>
<a class="sourceLine" id="cb1273-12" title="12"><span class="kw">def</span> find_integral(a,b,c,d):</a>
<a class="sourceLine" id="cb1273-13" title="13">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1273-14" title="14"><span class="co">  This function generates a one dimensional polynomial with coefficients a,b,c,d and returns its integral.</span></a>
<a class="sourceLine" id="cb1273-15" title="15"></a>
<a class="sourceLine" id="cb1273-16" title="16"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1273-17" title="17">  <span class="cf">return</span> (a<span class="op">/</span><span class="dv">4</span>)<span class="op">*</span>x<span class="op">**</span><span class="dv">4</span> <span class="op">+</span> (b<span class="op">/</span><span class="dv">3</span>)<span class="op">*</span>x<span class="op">**</span><span class="dv">3</span> <span class="op">+</span> (c<span class="op">/</span><span class="dv">2</span>)<span class="op">*</span>x<span class="op">**</span><span class="dv">2</span> <span class="op">+</span> d<span class="op">*</span>x</a>
<a class="sourceLine" id="cb1273-18" title="18"></a>
<a class="sourceLine" id="cb1273-19" title="19"></a>
<a class="sourceLine" id="cb1273-20" title="20"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1273-21" title="21"></a>
<a class="sourceLine" id="cb1273-22" title="22">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> find_integral(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>) <span class="op">==</span> np.poly1d([<span class="dv">1</span><span class="op">/</span><span class="dv">4</span>, <span class="dv">2</span><span class="op">/</span><span class="dv">3</span>, <span class="dv">3</span><span class="op">/</span><span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">0</span>]) <span class="cf">else</span> <span class="va">False</span> </a></code></pre></div>
<p>Output:</p>
<pre><code>name &#39;x&#39; is not defined</code></pre>
<h4 id="run-4-115">Run 4</h4>
<div class="sourceCode" id="cb1275"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1275-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1275-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1275-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1275-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1275-5" title="5"></a>
<a class="sourceLine" id="cb1275-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1275-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1275-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1275-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1275-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1275-11" title="11"></a>
<a class="sourceLine" id="cb1275-12" title="12"><span class="kw">def</span> find_integral(a,b,c,d):</a>
<a class="sourceLine" id="cb1275-13" title="13">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1275-14" title="14"><span class="co">  This function generates a one dimensional polynomial with coefficients a,b,c,d and returns its integral.</span></a>
<a class="sourceLine" id="cb1275-15" title="15"></a>
<a class="sourceLine" id="cb1275-16" title="16"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1275-17" title="17">  <span class="cf">return</span> a<span class="op">*</span>d<span class="op">**</span><span class="dv">3</span><span class="op">/</span><span class="dv">4</span> <span class="op">+</span> b<span class="op">*</span>d<span class="op">**</span><span class="dv">2</span><span class="op">/</span><span class="dv">3</span> <span class="op">+</span> c<span class="op">*</span>d</a>
<a class="sourceLine" id="cb1275-18" title="18"></a>
<a class="sourceLine" id="cb1275-19" title="19"></a>
<a class="sourceLine" id="cb1275-20" title="20"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1275-21" title="21"></a>
<a class="sourceLine" id="cb1275-22" title="22">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> find_integral(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>) <span class="op">==</span> np.poly1d([<span class="dv">1</span><span class="op">/</span><span class="dv">4</span>, <span class="dv">2</span><span class="op">/</span><span class="dv">3</span>, <span class="dv">3</span><span class="op">/</span><span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">0</span>]) <span class="cf">else</span> <span class="va">False</span> </a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>trap</summary></p>
<h4 id="query-116">Query</h4>
<div class="sourceCode" id="cb1277"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1277-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1277-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1277-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1277-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1277-5" title="5"></a>
<a class="sourceLine" id="cb1277-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1277-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1277-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1277-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1277-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1277-11" title="11"></a>
<a class="sourceLine" id="cb1277-12" title="12"><span class="kw">def</span> trap(f, n, a, b):</a>
<a class="sourceLine" id="cb1277-13" title="13">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1277-14" title="14"><span class="co">  This function evaluates the integral of a univariate function f from a to b with n itervals using the composite trapezoidal rule.</span></a>
<a class="sourceLine" id="cb1277-15" title="15"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1277-16" title="16">  </a></code></pre></div>
<h4 id="run-0-116">Run 0</h4>
<div class="sourceCode" id="cb1278"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1278-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1278-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1278-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1278-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1278-5" title="5"></a>
<a class="sourceLine" id="cb1278-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1278-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1278-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1278-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1278-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1278-11" title="11"></a>
<a class="sourceLine" id="cb1278-12" title="12"><span class="kw">def</span> trap(f, n, a, b):</a>
<a class="sourceLine" id="cb1278-13" title="13">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1278-14" title="14"><span class="co">  This function evaluates the integral of a univariate function f from a to b with n itervals using the composite trapezoidal rule.</span></a>
<a class="sourceLine" id="cb1278-15" title="15"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1278-16" title="16">  h <span class="op">=</span> (b <span class="op">-</span> a) <span class="op">/</span> n</a>
<a class="sourceLine" id="cb1278-17" title="17">  s <span class="op">=</span> <span class="fl">0.5</span> <span class="op">*</span> f(a) <span class="op">+</span> <span class="fl">0.5</span> <span class="op">*</span> f(b)</a>
<a class="sourceLine" id="cb1278-18" title="18">  <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, n):</a>
<a class="sourceLine" id="cb1278-19" title="19">    s <span class="op">+=</span> f(a <span class="op">+</span> i <span class="op">*</span> h)</a>
<a class="sourceLine" id="cb1278-20" title="20">  <span class="cf">return</span> h <span class="op">*</span> s</a>
<a class="sourceLine" id="cb1278-21" title="21"></a>
<a class="sourceLine" id="cb1278-22" title="22"><span class="im">import</span> numpy</a>
<a class="sourceLine" id="cb1278-23" title="23"></a>
<a class="sourceLine" id="cb1278-24" title="24"><span class="kw">def</span> f(x):</a>
<a class="sourceLine" id="cb1278-25" title="25">    <span class="cf">return</span> x <span class="op">**</span> <span class="dv">4</span> <span class="op">*</span> np.log(x <span class="op">+</span> np.sqrt(x <span class="op">**</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">1</span>))</a>
<a class="sourceLine" id="cb1278-26" title="26"></a>
<a class="sourceLine" id="cb1278-27" title="27">a <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb1278-28" title="28">b <span class="op">=</span> <span class="dv">5</span></a>
<a class="sourceLine" id="cb1278-29" title="29">n <span class="op">=</span> <span class="dv">100</span></a>
<a class="sourceLine" id="cb1278-30" title="30"></a>
<a class="sourceLine" id="cb1278-31" title="31">x <span class="op">=</span> np.linspace(a,b,num<span class="op">=</span>n)</a>
<a class="sourceLine" id="cb1278-32" title="32">test_intgr <span class="op">=</span> np.trapz(f(x), x<span class="op">=</span>x)</a>
<a class="sourceLine" id="cb1278-33" title="33"></a>
<a class="sourceLine" id="cb1278-34" title="34">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(trap(f,n,a,b),test_intgr) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-116">Run 1</h4>
<div class="sourceCode" id="cb1280"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1280-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1280-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1280-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1280-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1280-5" title="5"></a>
<a class="sourceLine" id="cb1280-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1280-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1280-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1280-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1280-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1280-11" title="11"></a>
<a class="sourceLine" id="cb1280-12" title="12"><span class="kw">def</span> trap(f, n, a, b):</a>
<a class="sourceLine" id="cb1280-13" title="13">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1280-14" title="14"><span class="co">  This function evaluates the integral of a univariate function f from a to b with n itervals using the composite trapezoidal rule.</span></a>
<a class="sourceLine" id="cb1280-15" title="15"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1280-16" title="16">  h <span class="op">=</span> (b<span class="op">-</span>a)<span class="op">/</span>n</a>
<a class="sourceLine" id="cb1280-17" title="17">  <span class="bu">sum</span> <span class="op">=</span> <span class="fl">0.5</span><span class="op">*</span>f(a) <span class="op">+</span> <span class="fl">0.5</span><span class="op">*</span>f(b)</a>
<a class="sourceLine" id="cb1280-18" title="18">  <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>,n):</a>
<a class="sourceLine" id="cb1280-19" title="19">    <span class="bu">sum</span> <span class="op">+=</span> f(a<span class="op">+</span>i<span class="op">*</span>h)</a>
<a class="sourceLine" id="cb1280-20" title="20">  <span class="cf">return</span> h<span class="op">*</span><span class="bu">sum</span></a>
<a class="sourceLine" id="cb1280-21" title="21"></a>
<a class="sourceLine" id="cb1280-22" title="22"><span class="im">import</span> numpy</a>
<a class="sourceLine" id="cb1280-23" title="23"></a>
<a class="sourceLine" id="cb1280-24" title="24"><span class="kw">def</span> f(x):</a>
<a class="sourceLine" id="cb1280-25" title="25">    <span class="cf">return</span> x <span class="op">**</span> <span class="dv">4</span> <span class="op">*</span> np.log(x <span class="op">+</span> np.sqrt(x <span class="op">**</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">1</span>))</a>
<a class="sourceLine" id="cb1280-26" title="26"></a>
<a class="sourceLine" id="cb1280-27" title="27">a <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb1280-28" title="28">b <span class="op">=</span> <span class="dv">5</span></a>
<a class="sourceLine" id="cb1280-29" title="29">n <span class="op">=</span> <span class="dv">100</span></a>
<a class="sourceLine" id="cb1280-30" title="30"></a>
<a class="sourceLine" id="cb1280-31" title="31">x <span class="op">=</span> np.linspace(a,b,num<span class="op">=</span>n)</a>
<a class="sourceLine" id="cb1280-32" title="32">test_intgr <span class="op">=</span> np.trapz(f(x), x<span class="op">=</span>x)</a>
<a class="sourceLine" id="cb1280-33" title="33"></a>
<a class="sourceLine" id="cb1280-34" title="34">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(trap(f,n,a,b),test_intgr) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-116">Run 2</h4>
<div class="sourceCode" id="cb1282"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1282-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1282-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1282-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1282-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1282-5" title="5"></a>
<a class="sourceLine" id="cb1282-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1282-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1282-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1282-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1282-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1282-11" title="11"></a>
<a class="sourceLine" id="cb1282-12" title="12"><span class="kw">def</span> trap(f, n, a, b):</a>
<a class="sourceLine" id="cb1282-13" title="13">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1282-14" title="14"><span class="co">  This function evaluates the integral of a univariate function f from a to b with n itervals using the composite trapezoidal rule.</span></a>
<a class="sourceLine" id="cb1282-15" title="15"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1282-16" title="16">  h <span class="op">=</span> (b<span class="op">-</span>a)<span class="op">/</span>n</a>
<a class="sourceLine" id="cb1282-17" title="17">  x <span class="op">=</span> np.linspace(a, b, n<span class="op">+</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb1282-18" title="18">  y <span class="op">=</span> f(x)</a>
<a class="sourceLine" id="cb1282-19" title="19">  <span class="cf">return</span> h<span class="op">*</span>(<span class="fl">0.5</span><span class="op">*</span>y[<span class="dv">0</span>] <span class="op">+</span> <span class="fl">0.5</span><span class="op">*</span>y[<span class="op">-</span><span class="dv">1</span>] <span class="op">+</span> np.<span class="bu">sum</span>(y[<span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>]))</a>
<a class="sourceLine" id="cb1282-20" title="20"></a>
<a class="sourceLine" id="cb1282-21" title="21"><span class="im">import</span> numpy</a>
<a class="sourceLine" id="cb1282-22" title="22"></a>
<a class="sourceLine" id="cb1282-23" title="23"><span class="kw">def</span> f(x):</a>
<a class="sourceLine" id="cb1282-24" title="24">    <span class="cf">return</span> x <span class="op">**</span> <span class="dv">4</span> <span class="op">*</span> np.log(x <span class="op">+</span> np.sqrt(x <span class="op">**</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">1</span>))</a>
<a class="sourceLine" id="cb1282-25" title="25"></a>
<a class="sourceLine" id="cb1282-26" title="26">a <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb1282-27" title="27">b <span class="op">=</span> <span class="dv">5</span></a>
<a class="sourceLine" id="cb1282-28" title="28">n <span class="op">=</span> <span class="dv">100</span></a>
<a class="sourceLine" id="cb1282-29" title="29"></a>
<a class="sourceLine" id="cb1282-30" title="30">x <span class="op">=</span> np.linspace(a,b,num<span class="op">=</span>n)</a>
<a class="sourceLine" id="cb1282-31" title="31">test_intgr <span class="op">=</span> np.trapz(f(x), x<span class="op">=</span>x)</a>
<a class="sourceLine" id="cb1282-32" title="32"></a>
<a class="sourceLine" id="cb1282-33" title="33">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(trap(f,n,a,b),test_intgr) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-116">Run 3</h4>
<div class="sourceCode" id="cb1284"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1284-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1284-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1284-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1284-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1284-5" title="5"></a>
<a class="sourceLine" id="cb1284-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1284-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1284-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1284-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1284-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1284-11" title="11"></a>
<a class="sourceLine" id="cb1284-12" title="12"><span class="kw">def</span> trap(f, n, a, b):</a>
<a class="sourceLine" id="cb1284-13" title="13">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1284-14" title="14"><span class="co">  This function evaluates the integral of a univariate function f from a to b with n itervals using the composite trapezoidal rule.</span></a>
<a class="sourceLine" id="cb1284-15" title="15"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1284-16" title="16">  h <span class="op">=</span> (b <span class="op">-</span> a) <span class="op">/</span> n</a>
<a class="sourceLine" id="cb1284-17" title="17">  s <span class="op">=</span> <span class="fl">0.5</span> <span class="op">*</span> (f(a) <span class="op">+</span> f(b))</a>
<a class="sourceLine" id="cb1284-18" title="18">  <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, n):</a>
<a class="sourceLine" id="cb1284-19" title="19">    s <span class="op">+=</span> f(a <span class="op">+</span> i <span class="op">*</span> h)</a>
<a class="sourceLine" id="cb1284-20" title="20">  <span class="cf">return</span> h <span class="op">*</span> s</a>
<a class="sourceLine" id="cb1284-21" title="21"></a>
<a class="sourceLine" id="cb1284-22" title="22"></a>
<a class="sourceLine" id="cb1284-23" title="23"><span class="im">import</span> numpy</a>
<a class="sourceLine" id="cb1284-24" title="24"></a>
<a class="sourceLine" id="cb1284-25" title="25"><span class="kw">def</span> f(x):</a>
<a class="sourceLine" id="cb1284-26" title="26">    <span class="cf">return</span> x <span class="op">**</span> <span class="dv">4</span> <span class="op">*</span> np.log(x <span class="op">+</span> np.sqrt(x <span class="op">**</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">1</span>))</a>
<a class="sourceLine" id="cb1284-27" title="27"></a>
<a class="sourceLine" id="cb1284-28" title="28">a <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb1284-29" title="29">b <span class="op">=</span> <span class="dv">5</span></a>
<a class="sourceLine" id="cb1284-30" title="30">n <span class="op">=</span> <span class="dv">100</span></a>
<a class="sourceLine" id="cb1284-31" title="31"></a>
<a class="sourceLine" id="cb1284-32" title="32">x <span class="op">=</span> np.linspace(a,b,num<span class="op">=</span>n)</a>
<a class="sourceLine" id="cb1284-33" title="33">test_intgr <span class="op">=</span> np.trapz(f(x), x<span class="op">=</span>x)</a>
<a class="sourceLine" id="cb1284-34" title="34"></a>
<a class="sourceLine" id="cb1284-35" title="35">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(trap(f,n,a,b),test_intgr) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-116">Run 4</h4>
<div class="sourceCode" id="cb1286"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1286-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1286-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1286-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1286-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1286-5" title="5"></a>
<a class="sourceLine" id="cb1286-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1286-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1286-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1286-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1286-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1286-11" title="11"></a>
<a class="sourceLine" id="cb1286-12" title="12"><span class="kw">def</span> trap(f, n, a, b):</a>
<a class="sourceLine" id="cb1286-13" title="13">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1286-14" title="14"><span class="co">  This function evaluates the integral of a univariate function f from a to b with n itervals using the composite trapezoidal rule.</span></a>
<a class="sourceLine" id="cb1286-15" title="15"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1286-16" title="16">  h <span class="op">=</span> (b <span class="op">-</span> a) <span class="op">/</span> n</a>
<a class="sourceLine" id="cb1286-17" title="17">  s <span class="op">=</span> <span class="fl">0.5</span> <span class="op">*</span> (f(a) <span class="op">+</span> f(b))</a>
<a class="sourceLine" id="cb1286-18" title="18">  <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, n):</a>
<a class="sourceLine" id="cb1286-19" title="19">    s <span class="op">+=</span> f(a <span class="op">+</span> i <span class="op">*</span> h)</a>
<a class="sourceLine" id="cb1286-20" title="20">  <span class="cf">return</span> h <span class="op">*</span> s</a>
<a class="sourceLine" id="cb1286-21" title="21"></a>
<a class="sourceLine" id="cb1286-22" title="22"><span class="im">import</span> numpy</a>
<a class="sourceLine" id="cb1286-23" title="23"></a>
<a class="sourceLine" id="cb1286-24" title="24"><span class="kw">def</span> f(x):</a>
<a class="sourceLine" id="cb1286-25" title="25">    <span class="cf">return</span> x <span class="op">**</span> <span class="dv">4</span> <span class="op">*</span> np.log(x <span class="op">+</span> np.sqrt(x <span class="op">**</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">1</span>))</a>
<a class="sourceLine" id="cb1286-26" title="26"></a>
<a class="sourceLine" id="cb1286-27" title="27">a <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb1286-28" title="28">b <span class="op">=</span> <span class="dv">5</span></a>
<a class="sourceLine" id="cb1286-29" title="29">n <span class="op">=</span> <span class="dv">100</span></a>
<a class="sourceLine" id="cb1286-30" title="30"></a>
<a class="sourceLine" id="cb1286-31" title="31">x <span class="op">=</span> np.linspace(a,b,num<span class="op">=</span>n)</a>
<a class="sourceLine" id="cb1286-32" title="32">test_intgr <span class="op">=</span> np.trapz(f(x), x<span class="op">=</span>x)</a>
<a class="sourceLine" id="cb1286-33" title="33"></a>
<a class="sourceLine" id="cb1286-34" title="34">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(trap(f,n,a,b),test_intgr) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>invert_matrix</summary></p>
<h4 id="query-117">Query</h4>
<div class="sourceCode" id="cb1288"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1288-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1288-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1288-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1288-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1288-5" title="5"></a>
<a class="sourceLine" id="cb1288-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1288-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1288-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1288-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1288-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1288-11" title="11"></a>
<a class="sourceLine" id="cb1288-12" title="12"><span class="kw">def</span> invert_matrix(A):</a>
<a class="sourceLine" id="cb1288-13" title="13">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1288-14" title="14"><span class="co">    This function computes the inverse of matrix A</span></a>
<a class="sourceLine" id="cb1288-15" title="15"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1288-16" title="16">    </a></code></pre></div>
<h4 id="run-0-117">Run 0</h4>
<div class="sourceCode" id="cb1289"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1289-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1289-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1289-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1289-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1289-5" title="5"></a>
<a class="sourceLine" id="cb1289-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1289-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1289-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1289-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1289-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1289-11" title="11"></a>
<a class="sourceLine" id="cb1289-12" title="12"><span class="kw">def</span> invert_matrix(A):</a>
<a class="sourceLine" id="cb1289-13" title="13">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1289-14" title="14"><span class="co">    This function computes the inverse of matrix A</span></a>
<a class="sourceLine" id="cb1289-15" title="15"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1289-16" title="16">    <span class="cf">return</span> np.linalg.inv(A)</a>
<a class="sourceLine" id="cb1289-17" title="17"></a>
<a class="sourceLine" id="cb1289-18" title="18"></a>
<a class="sourceLine" id="cb1289-19" title="19"></a>
<a class="sourceLine" id="cb1289-20" title="20"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1289-21" title="21"></a>
<a class="sourceLine" id="cb1289-22" title="22">x <span class="op">=</span> np.array([[<span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>], [<span class="dv">2</span>,<span class="dv">6</span>]])</a>
<a class="sourceLine" id="cb1289-23" title="23">m_i <span class="op">=</span> invert_matrix(x)</a>
<a class="sourceLine" id="cb1289-24" title="24">x_i <span class="op">=</span> np.array([[<span class="fl">0.75</span>,<span class="fl">0.125</span>], [<span class="op">-</span><span class="fl">0.25</span>,<span class="fl">0.125</span>]])</a>
<a class="sourceLine" id="cb1289-25" title="25"></a>
<a class="sourceLine" id="cb1289-26" title="26">result <span class="op">=</span> np.array_equal(m_i,x_i)</a>
<a class="sourceLine" id="cb1289-27" title="27"></a>
<a class="sourceLine" id="cb1289-28" title="28"></a>
<a class="sourceLine" id="cb1289-29" title="29"></a>
<a class="sourceLine" id="cb1289-30" title="30"></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-117">Run 1</h4>
<div class="sourceCode" id="cb1291"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1291-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1291-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1291-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1291-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1291-5" title="5"></a>
<a class="sourceLine" id="cb1291-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1291-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1291-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1291-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1291-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1291-11" title="11"></a>
<a class="sourceLine" id="cb1291-12" title="12"><span class="kw">def</span> invert_matrix(A):</a>
<a class="sourceLine" id="cb1291-13" title="13">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1291-14" title="14"><span class="co">    This function computes the inverse of matrix A</span></a>
<a class="sourceLine" id="cb1291-15" title="15"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1291-16" title="16">    <span class="co"># start</span></a>
<a class="sourceLine" id="cb1291-17" title="17">    A_inv <span class="op">=</span> np.linalg.inv(A)</a>
<a class="sourceLine" id="cb1291-18" title="18">    </a>
<a class="sourceLine" id="cb1291-19" title="19"></a>
<a class="sourceLine" id="cb1291-20" title="20"></a>
<a class="sourceLine" id="cb1291-21" title="21"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1291-22" title="22"></a>
<a class="sourceLine" id="cb1291-23" title="23">x <span class="op">=</span> np.array([[<span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>], [<span class="dv">2</span>,<span class="dv">6</span>]])</a>
<a class="sourceLine" id="cb1291-24" title="24">m_i <span class="op">=</span> invert_matrix(x)</a>
<a class="sourceLine" id="cb1291-25" title="25">x_i <span class="op">=</span> np.array([[<span class="fl">0.75</span>,<span class="fl">0.125</span>], [<span class="op">-</span><span class="fl">0.25</span>,<span class="fl">0.125</span>]])</a>
<a class="sourceLine" id="cb1291-26" title="26"></a>
<a class="sourceLine" id="cb1291-27" title="27">result <span class="op">=</span> np.array_equal(m_i,x_i)</a>
<a class="sourceLine" id="cb1291-28" title="28"></a>
<a class="sourceLine" id="cb1291-29" title="29"></a>
<a class="sourceLine" id="cb1291-30" title="30"></a>
<a class="sourceLine" id="cb1291-31" title="31"></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-117">Run 2</h4>
<div class="sourceCode" id="cb1293"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1293-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1293-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1293-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1293-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1293-5" title="5"></a>
<a class="sourceLine" id="cb1293-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1293-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1293-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1293-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1293-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1293-11" title="11"></a>
<a class="sourceLine" id="cb1293-12" title="12"><span class="kw">def</span> invert_matrix(A):</a>
<a class="sourceLine" id="cb1293-13" title="13">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1293-14" title="14"><span class="co">    This function computes the inverse of matrix A</span></a>
<a class="sourceLine" id="cb1293-15" title="15"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1293-16" title="16">    A_inv <span class="op">=</span> np.linalg.inv(A)</a>
<a class="sourceLine" id="cb1293-17" title="17">    <span class="cf">return</span> A_inv</a>
<a class="sourceLine" id="cb1293-18" title="18"></a>
<a class="sourceLine" id="cb1293-19" title="19"></a>
<a class="sourceLine" id="cb1293-20" title="20"></a>
<a class="sourceLine" id="cb1293-21" title="21"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1293-22" title="22"></a>
<a class="sourceLine" id="cb1293-23" title="23">x <span class="op">=</span> np.array([[<span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>], [<span class="dv">2</span>,<span class="dv">6</span>]])</a>
<a class="sourceLine" id="cb1293-24" title="24">m_i <span class="op">=</span> invert_matrix(x)</a>
<a class="sourceLine" id="cb1293-25" title="25">x_i <span class="op">=</span> np.array([[<span class="fl">0.75</span>,<span class="fl">0.125</span>], [<span class="op">-</span><span class="fl">0.25</span>,<span class="fl">0.125</span>]])</a>
<a class="sourceLine" id="cb1293-26" title="26"></a>
<a class="sourceLine" id="cb1293-27" title="27">result <span class="op">=</span> np.array_equal(m_i,x_i)</a>
<a class="sourceLine" id="cb1293-28" title="28"></a>
<a class="sourceLine" id="cb1293-29" title="29"></a>
<a class="sourceLine" id="cb1293-30" title="30"></a>
<a class="sourceLine" id="cb1293-31" title="31"></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-117">Run 3</h4>
<div class="sourceCode" id="cb1295"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1295-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1295-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1295-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1295-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1295-5" title="5"></a>
<a class="sourceLine" id="cb1295-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1295-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1295-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1295-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1295-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1295-11" title="11"></a>
<a class="sourceLine" id="cb1295-12" title="12"><span class="kw">def</span> invert_matrix(A):</a>
<a class="sourceLine" id="cb1295-13" title="13">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1295-14" title="14"><span class="co">    This function computes the inverse of matrix A</span></a>
<a class="sourceLine" id="cb1295-15" title="15"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1295-16" title="16">    <span class="cf">return</span> np.linalg.inv(A)</a>
<a class="sourceLine" id="cb1295-17" title="17"></a>
<a class="sourceLine" id="cb1295-18" title="18"></a>
<a class="sourceLine" id="cb1295-19" title="19"></a>
<a class="sourceLine" id="cb1295-20" title="20"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1295-21" title="21"></a>
<a class="sourceLine" id="cb1295-22" title="22">x <span class="op">=</span> np.array([[<span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>], [<span class="dv">2</span>,<span class="dv">6</span>]])</a>
<a class="sourceLine" id="cb1295-23" title="23">m_i <span class="op">=</span> invert_matrix(x)</a>
<a class="sourceLine" id="cb1295-24" title="24">x_i <span class="op">=</span> np.array([[<span class="fl">0.75</span>,<span class="fl">0.125</span>], [<span class="op">-</span><span class="fl">0.25</span>,<span class="fl">0.125</span>]])</a>
<a class="sourceLine" id="cb1295-25" title="25"></a>
<a class="sourceLine" id="cb1295-26" title="26">result <span class="op">=</span> np.array_equal(m_i,x_i)</a>
<a class="sourceLine" id="cb1295-27" title="27"></a>
<a class="sourceLine" id="cb1295-28" title="28"></a>
<a class="sourceLine" id="cb1295-29" title="29"></a>
<a class="sourceLine" id="cb1295-30" title="30"></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-117">Run 4</h4>
<div class="sourceCode" id="cb1297"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1297-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1297-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1297-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1297-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1297-5" title="5"></a>
<a class="sourceLine" id="cb1297-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1297-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1297-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1297-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1297-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1297-11" title="11"></a>
<a class="sourceLine" id="cb1297-12" title="12"><span class="kw">def</span> invert_matrix(A):</a>
<a class="sourceLine" id="cb1297-13" title="13">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1297-14" title="14"><span class="co">    This function computes the inverse of matrix A</span></a>
<a class="sourceLine" id="cb1297-15" title="15"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1297-16" title="16">    <span class="cf">return</span> np.linalg.inv(A)</a>
<a class="sourceLine" id="cb1297-17" title="17"></a>
<a class="sourceLine" id="cb1297-18" title="18"></a>
<a class="sourceLine" id="cb1297-19" title="19"></a>
<a class="sourceLine" id="cb1297-20" title="20"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1297-21" title="21"></a>
<a class="sourceLine" id="cb1297-22" title="22">x <span class="op">=</span> np.array([[<span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>], [<span class="dv">2</span>,<span class="dv">6</span>]])</a>
<a class="sourceLine" id="cb1297-23" title="23">m_i <span class="op">=</span> invert_matrix(x)</a>
<a class="sourceLine" id="cb1297-24" title="24">x_i <span class="op">=</span> np.array([[<span class="fl">0.75</span>,<span class="fl">0.125</span>], [<span class="op">-</span><span class="fl">0.25</span>,<span class="fl">0.125</span>]])</a>
<a class="sourceLine" id="cb1297-25" title="25"></a>
<a class="sourceLine" id="cb1297-26" title="26">result <span class="op">=</span> np.array_equal(m_i,x_i)</a>
<a class="sourceLine" id="cb1297-27" title="27"></a>
<a class="sourceLine" id="cb1297-28" title="28"></a>
<a class="sourceLine" id="cb1297-29" title="29"></a>
<a class="sourceLine" id="cb1297-30" title="30"></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>iupac2smiles</summary></p>
<h4 id="query-118">Query</h4>
<div class="sourceCode" id="cb1299"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1299-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1299-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb1299-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb1299-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb1299-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb1299-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb1299-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb1299-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb1299-9" title="9"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb1299-10" title="10"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb1299-11" title="11"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1299-12" title="12"></a>
<a class="sourceLine" id="cb1299-13" title="13"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1299-14" title="14"><span class="co">print rdkit version</span></a>
<a class="sourceLine" id="cb1299-15" title="15"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1299-16" title="16"><span class="bu">print</span>(rdkit.__version__)</a>
<a class="sourceLine" id="cb1299-17" title="17"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1299-18" title="18"></a>
<a class="sourceLine" id="cb1299-19" title="19"><span class="kw">def</span> iupac2smiles(IUPAC):</a>
<a class="sourceLine" id="cb1299-20" title="20">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1299-21" title="21"><span class="co">    This function takes in the IUPAC name string and converts it to a SMILES string</span></a>
<a class="sourceLine" id="cb1299-22" title="22"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1299-23" title="23">    </a></code></pre></div>
<h4 id="run-0-118">Run 0</h4>
<div class="sourceCode" id="cb1300"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1300-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1300-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb1300-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb1300-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb1300-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb1300-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb1300-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb1300-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb1300-9" title="9"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb1300-10" title="10"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb1300-11" title="11"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1300-12" title="12"></a>
<a class="sourceLine" id="cb1300-13" title="13"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1300-14" title="14"><span class="co">print rdkit version</span></a>
<a class="sourceLine" id="cb1300-15" title="15"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1300-16" title="16"><span class="bu">print</span>(rdkit.__version__)</a>
<a class="sourceLine" id="cb1300-17" title="17"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1300-18" title="18"></a>
<a class="sourceLine" id="cb1300-19" title="19"><span class="kw">def</span> iupac2smiles(IUPAC):</a>
<a class="sourceLine" id="cb1300-20" title="20">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1300-21" title="21"><span class="co">    This function takes in the IUPAC name string and converts it to a SMILES string</span></a>
<a class="sourceLine" id="cb1300-22" title="22"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1300-23" title="23">    mol <span class="op">=</span> Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolTo</a>
<a class="sourceLine" id="cb1300-24" title="24"></a>
<a class="sourceLine" id="cb1300-25" title="25">iupac <span class="op">=</span> <span class="st">&quot;2,5,5-trimethyl-2-hexene&quot;</span></a>
<a class="sourceLine" id="cb1300-26" title="26">smiles <span class="op">=</span> <span class="st">&quot;CC(C)=CCC(C)(C)C&quot;</span></a>
<a class="sourceLine" id="cb1300-27" title="27"></a>
<a class="sourceLine" id="cb1300-28" title="28">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> iupac2smiles(iupac) <span class="op">==</span> smiles <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code></code></pre>
<h4 id="run-1-118">Run 1</h4>
<div class="sourceCode" id="cb1302"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1302-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1302-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb1302-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb1302-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb1302-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb1302-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb1302-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb1302-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb1302-9" title="9"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb1302-10" title="10"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb1302-11" title="11"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1302-12" title="12"></a>
<a class="sourceLine" id="cb1302-13" title="13"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1302-14" title="14"><span class="co">print rdkit version</span></a>
<a class="sourceLine" id="cb1302-15" title="15"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1302-16" title="16"><span class="bu">print</span>(rdkit.__version__)</a>
<a class="sourceLine" id="cb1302-17" title="17"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1302-18" title="18"></a>
<a class="sourceLine" id="cb1302-19" title="19"><span class="kw">def</span> iupac2smiles(IUPAC):</a>
<a class="sourceLine" id="cb1302-20" title="20">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1302-21" title="21"><span class="co">    This function takes in the IUPAC name string and converts it to a SMILES string</span></a>
<a class="sourceLine" id="cb1302-22" title="22"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1302-23" title="23">    mol <span class="op">=</span> Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolTo</a>
<a class="sourceLine" id="cb1302-24" title="24"></a>
<a class="sourceLine" id="cb1302-25" title="25">iupac <span class="op">=</span> <span class="st">&quot;2,5,5-trimethyl-2-hexene&quot;</span></a>
<a class="sourceLine" id="cb1302-26" title="26">smiles <span class="op">=</span> <span class="st">&quot;CC(C)=CCC(C)(C)C&quot;</span></a>
<a class="sourceLine" id="cb1302-27" title="27"></a>
<a class="sourceLine" id="cb1302-28" title="28">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> iupac2smiles(iupac) <span class="op">==</span> smiles <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code></code></pre>
<h4 id="run-2-118">Run 2</h4>
<div class="sourceCode" id="cb1304"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1304-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1304-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb1304-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb1304-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb1304-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb1304-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb1304-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb1304-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb1304-9" title="9"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb1304-10" title="10"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb1304-11" title="11"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1304-12" title="12"></a>
<a class="sourceLine" id="cb1304-13" title="13"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1304-14" title="14"><span class="co">print rdkit version</span></a>
<a class="sourceLine" id="cb1304-15" title="15"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1304-16" title="16"><span class="bu">print</span>(rdkit.__version__)</a>
<a class="sourceLine" id="cb1304-17" title="17"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1304-18" title="18"></a>
<a class="sourceLine" id="cb1304-19" title="19"><span class="kw">def</span> iupac2smiles(IUPAC):</a>
<a class="sourceLine" id="cb1304-20" title="20">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1304-21" title="21"><span class="co">    This function takes in the IUPAC name string and converts it to a SMILES string</span></a>
<a class="sourceLine" id="cb1304-22" title="22"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1304-23" title="23">    mol <span class="op">=</span> Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(Chem.MolTo</a>
<a class="sourceLine" id="cb1304-24" title="24"></a>
<a class="sourceLine" id="cb1304-25" title="25">iupac <span class="op">=</span> <span class="st">&quot;2,5,5-trimethyl-2-hexene&quot;</span></a>
<a class="sourceLine" id="cb1304-26" title="26">smiles <span class="op">=</span> <span class="st">&quot;CC(C)=CCC(C)(C)C&quot;</span></a>
<a class="sourceLine" id="cb1304-27" title="27"></a>
<a class="sourceLine" id="cb1304-28" title="28">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> iupac2smiles(iupac) <span class="op">==</span> smiles <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code></code></pre>
<h4 id="run-3-118">Run 3</h4>
<div class="sourceCode" id="cb1306"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1306-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1306-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb1306-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb1306-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb1306-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb1306-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb1306-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb1306-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb1306-9" title="9"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb1306-10" title="10"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb1306-11" title="11"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1306-12" title="12"></a>
<a class="sourceLine" id="cb1306-13" title="13"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1306-14" title="14"><span class="co">print rdkit version</span></a>
<a class="sourceLine" id="cb1306-15" title="15"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1306-16" title="16"><span class="bu">print</span>(rdkit.__version__)</a>
<a class="sourceLine" id="cb1306-17" title="17"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1306-18" title="18"></a>
<a class="sourceLine" id="cb1306-19" title="19"><span class="kw">def</span> iupac2smiles(IUPAC):</a>
<a class="sourceLine" id="cb1306-20" title="20">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1306-21" title="21"><span class="co">    This function takes in the IUPAC name string and converts it to a SMILES string</span></a>
<a class="sourceLine" id="cb1306-22" title="22"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1306-23" title="23">    <span class="co"># convert IUPAC name to SMILES string</span></a>
<a class="sourceLine" id="cb1306-24" title="24">    mol <span class="op">=</span> Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(IUPAC)))</a>
<a class="sourceLine" id="cb1306-25" title="25">    </a>
<a class="sourceLine" id="cb1306-26" title="26"></a>
<a class="sourceLine" id="cb1306-27" title="27">iupac <span class="op">=</span> <span class="st">&quot;2,5,5-trimethyl-2-hexene&quot;</span></a>
<a class="sourceLine" id="cb1306-28" title="28">smiles <span class="op">=</span> <span class="st">&quot;CC(C)=CCC(C)(C)C&quot;</span></a>
<a class="sourceLine" id="cb1306-29" title="29"></a>
<a class="sourceLine" id="cb1306-30" title="30">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> iupac2smiles(iupac) <span class="op">==</span> smiles <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Python argument types in
    rdkit.Chem.rdmolfiles.MolToSmiles(NoneType)
did not match C++ signature:
    MolToSmiles(RDKit::ROMol mol, bool isomericSmiles=True, bool kekuleSmiles=False, int rootedAtAtom=-1, bool canonical=True, bool allBondsExplicit=False, bool allHsExplicit=False, bool doRandom=False)</code></pre>
<h4 id="run-4-118">Run 4</h4>
<div class="sourceCode" id="cb1308"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1308-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1308-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb1308-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb1308-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb1308-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb1308-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb1308-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb1308-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb1308-9" title="9"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb1308-10" title="10"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb1308-11" title="11"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1308-12" title="12"></a>
<a class="sourceLine" id="cb1308-13" title="13"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1308-14" title="14"><span class="co">print rdkit version</span></a>
<a class="sourceLine" id="cb1308-15" title="15"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1308-16" title="16"><span class="bu">print</span>(rdkit.__version__)</a>
<a class="sourceLine" id="cb1308-17" title="17"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1308-18" title="18"></a>
<a class="sourceLine" id="cb1308-19" title="19"><span class="kw">def</span> iupac2smiles(IUPAC):</a>
<a class="sourceLine" id="cb1308-20" title="20">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1308-21" title="21"><span class="co">    This function takes in the IUPAC name string and converts it to a SMILES string</span></a>
<a class="sourceLine" id="cb1308-22" title="22"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1308-23" title="23">    mol <span class="op">=</span> Chem.MolFromSmiles(Chem.MolToSmiles(Chem.MolFromSmiles(IUPAC)))</a>
<a class="sourceLine" id="cb1308-24" title="24">    <span class="cf">return</span> Chem.MolToSmiles(mol)</a>
<a class="sourceLine" id="cb1308-25" title="25"></a>
<a class="sourceLine" id="cb1308-26" title="26"></a>
<a class="sourceLine" id="cb1308-27" title="27">iupac <span class="op">=</span> <span class="st">&quot;2,5,5-trimethyl-2-hexene&quot;</span></a>
<a class="sourceLine" id="cb1308-28" title="28">smiles <span class="op">=</span> <span class="st">&quot;CC(C)=CCC(C)(C)C&quot;</span></a>
<a class="sourceLine" id="cb1308-29" title="29"></a>
<a class="sourceLine" id="cb1308-30" title="30">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> iupac2smiles(iupac) <span class="op">==</span> smiles <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Python argument types in
    rdkit.Chem.rdmolfiles.MolToSmiles(NoneType)
did not match C++ signature:
    MolToSmiles(RDKit::ROMol mol, bool isomericSmiles=True, bool kekuleSmiles=False, int rootedAtAtom=-1, bool canonical=True, bool allBondsExplicit=False, bool allHsExplicit=False, bool doRandom=False)</code></pre>
</details>
<details>
<p><summary>kld</summary></p>
<h4 id="query-119">Query</h4>
<div class="sourceCode" id="cb1310"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1310-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1310-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1310-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1310-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1310-5" title="5"></a>
<a class="sourceLine" id="cb1310-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1310-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1310-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1310-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1310-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1310-11" title="11"></a>
<a class="sourceLine" id="cb1310-12" title="12"><span class="kw">def</span> kld(true_data, predicted_data):</a>
<a class="sourceLine" id="cb1310-13" title="13">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1310-14" title="14"><span class="co">  This function calculates the Kullback–Leibler (KL) divergence loss between true_data and predicted_data.</span></a>
<a class="sourceLine" id="cb1310-15" title="15"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1310-16" title="16">  </a></code></pre></div>
<h4 id="run-0-119">Run 0</h4>
<div class="sourceCode" id="cb1311"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1311-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1311-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1311-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1311-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1311-5" title="5"></a>
<a class="sourceLine" id="cb1311-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1311-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1311-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1311-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1311-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1311-11" title="11"></a>
<a class="sourceLine" id="cb1311-12" title="12"><span class="kw">def</span> kld(true_data, predicted_data):</a>
<a class="sourceLine" id="cb1311-13" title="13">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1311-14" title="14"><span class="co">  This function calculates the Kullback–Leibler (KL) divergence loss between true_data and predicted_data.</span></a>
<a class="sourceLine" id="cb1311-15" title="15"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1311-16" title="16">  <span class="co"># start</span></a>
<a class="sourceLine" id="cb1311-17" title="17">  kl_loss <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb1311-18" title="18">  <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(true_data)):</a>
<a class="sourceLine" id="cb1311-19" title="19">    kl_loss <span class="op">+=</span> true_data[i] <span class="op">*</span> np.log(true_data[i] <span class="op">/</span> predicted_data[i])</a>
<a class="sourceLine" id="cb1311-20" title="20">  </a>
<a class="sourceLine" id="cb1311-21" title="21"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1311-22" title="22"></a>
<a class="sourceLine" id="cb1311-23" title="23">np.random.seed(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb1311-24" title="24">M <span class="op">=</span> <span class="dv">100</span></a>
<a class="sourceLine" id="cb1311-25" title="25">targets <span class="op">=</span> np.random.rand(M)</a>
<a class="sourceLine" id="cb1311-26" title="26">predictions <span class="op">=</span> targets <span class="op">*</span> <span class="fl">0.9</span></a>
<a class="sourceLine" id="cb1311-27" title="27">kld_loss <span class="op">=</span> <span class="op">-</span>np.<span class="bu">sum</span>(targets<span class="op">*</span>np.log(</a>
<a class="sourceLine" id="cb1311-28" title="28">    np.divide(predictions, targets) <span class="op">+</span> <span class="fl">1e-10</span>))</a>
<a class="sourceLine" id="cb1311-29" title="29"></a>
<a class="sourceLine" id="cb1311-30" title="30">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(kld(targets, predictions), kld_loss) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>ufunc &#39;isfinite&#39; not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule &#39;&#39;safe&#39;&#39;</code></pre>
<h4 id="run-1-119">Run 1</h4>
<div class="sourceCode" id="cb1313"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1313-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1313-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1313-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1313-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1313-5" title="5"></a>
<a class="sourceLine" id="cb1313-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1313-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1313-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1313-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1313-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1313-11" title="11"></a>
<a class="sourceLine" id="cb1313-12" title="12"><span class="kw">def</span> kld(true_data, predicted_data):</a>
<a class="sourceLine" id="cb1313-13" title="13">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1313-14" title="14"><span class="co">  This function calculates the Kullback–Leibler (KL) divergence loss between true_data and predicted_data.</span></a>
<a class="sourceLine" id="cb1313-15" title="15"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1313-16" title="16">  <span class="co"># start</span></a>
<a class="sourceLine" id="cb1313-17" title="17">  kl_divergence <span class="op">=</span> np.<span class="bu">sum</span>(np.where(true_data <span class="op">!=</span> <span class="dv">0</span>, true_data <span class="op">*</span> np.log(true_data <span class="op">/</span> predicted_data), <span class="dv">0</span>))</a>
<a class="sourceLine" id="cb1313-18" title="18">  </a>
<a class="sourceLine" id="cb1313-19" title="19"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1313-20" title="20"></a>
<a class="sourceLine" id="cb1313-21" title="21">np.random.seed(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb1313-22" title="22">M <span class="op">=</span> <span class="dv">100</span></a>
<a class="sourceLine" id="cb1313-23" title="23">targets <span class="op">=</span> np.random.rand(M)</a>
<a class="sourceLine" id="cb1313-24" title="24">predictions <span class="op">=</span> targets <span class="op">*</span> <span class="fl">0.9</span></a>
<a class="sourceLine" id="cb1313-25" title="25">kld_loss <span class="op">=</span> <span class="op">-</span>np.<span class="bu">sum</span>(targets<span class="op">*</span>np.log(</a>
<a class="sourceLine" id="cb1313-26" title="26">    np.divide(predictions, targets) <span class="op">+</span> <span class="fl">1e-10</span>))</a>
<a class="sourceLine" id="cb1313-27" title="27"></a>
<a class="sourceLine" id="cb1313-28" title="28">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(kld(targets, predictions), kld_loss) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>ufunc &#39;isfinite&#39; not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule &#39;&#39;safe&#39;&#39;</code></pre>
<h4 id="run-2-119">Run 2</h4>
<div class="sourceCode" id="cb1315"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1315-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1315-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1315-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1315-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1315-5" title="5"></a>
<a class="sourceLine" id="cb1315-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1315-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1315-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1315-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1315-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1315-11" title="11"></a>
<a class="sourceLine" id="cb1315-12" title="12"><span class="kw">def</span> kld(true_data, predicted_data):</a>
<a class="sourceLine" id="cb1315-13" title="13">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1315-14" title="14"><span class="co">  This function calculates the Kullback–Leibler (KL) divergence loss between true_data and predicted_data.</span></a>
<a class="sourceLine" id="cb1315-15" title="15"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1315-16" title="16">  <span class="co"># start</span></a>
<a class="sourceLine" id="cb1315-17" title="17">  kl_loss <span class="op">=</span> np.<span class="bu">sum</span>(np.multiply(true_data, np.log(np.divide(true_data, predicted_data))))</a>
<a class="sourceLine" id="cb1315-18" title="18">  </a>
<a class="sourceLine" id="cb1315-19" title="19"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1315-20" title="20"></a>
<a class="sourceLine" id="cb1315-21" title="21">np.random.seed(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb1315-22" title="22">M <span class="op">=</span> <span class="dv">100</span></a>
<a class="sourceLine" id="cb1315-23" title="23">targets <span class="op">=</span> np.random.rand(M)</a>
<a class="sourceLine" id="cb1315-24" title="24">predictions <span class="op">=</span> targets <span class="op">*</span> <span class="fl">0.9</span></a>
<a class="sourceLine" id="cb1315-25" title="25">kld_loss <span class="op">=</span> <span class="op">-</span>np.<span class="bu">sum</span>(targets<span class="op">*</span>np.log(</a>
<a class="sourceLine" id="cb1315-26" title="26">    np.divide(predictions, targets) <span class="op">+</span> <span class="fl">1e-10</span>))</a>
<a class="sourceLine" id="cb1315-27" title="27"></a>
<a class="sourceLine" id="cb1315-28" title="28">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(kld(targets, predictions), kld_loss) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>ufunc &#39;isfinite&#39; not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule &#39;&#39;safe&#39;&#39;</code></pre>
<h4 id="run-3-119">Run 3</h4>
<div class="sourceCode" id="cb1317"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1317-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1317-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1317-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1317-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1317-5" title="5"></a>
<a class="sourceLine" id="cb1317-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1317-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1317-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1317-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1317-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1317-11" title="11"></a>
<a class="sourceLine" id="cb1317-12" title="12"><span class="kw">def</span> kld(true_data, predicted_data):</a>
<a class="sourceLine" id="cb1317-13" title="13">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1317-14" title="14"><span class="co">  This function calculates the Kullback–Leibler (KL) divergence loss between true_data and predicted_data.</span></a>
<a class="sourceLine" id="cb1317-15" title="15"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1317-16" title="16">  <span class="co"># start</span></a>
<a class="sourceLine" id="cb1317-17" title="17">  </a>
<a class="sourceLine" id="cb1317-18" title="18"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1317-19" title="19"></a>
<a class="sourceLine" id="cb1317-20" title="20">np.random.seed(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb1317-21" title="21">M <span class="op">=</span> <span class="dv">100</span></a>
<a class="sourceLine" id="cb1317-22" title="22">targets <span class="op">=</span> np.random.rand(M)</a>
<a class="sourceLine" id="cb1317-23" title="23">predictions <span class="op">=</span> targets <span class="op">*</span> <span class="fl">0.9</span></a>
<a class="sourceLine" id="cb1317-24" title="24">kld_loss <span class="op">=</span> <span class="op">-</span>np.<span class="bu">sum</span>(targets<span class="op">*</span>np.log(</a>
<a class="sourceLine" id="cb1317-25" title="25">    np.divide(predictions, targets) <span class="op">+</span> <span class="fl">1e-10</span>))</a>
<a class="sourceLine" id="cb1317-26" title="26"></a>
<a class="sourceLine" id="cb1317-27" title="27">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(kld(targets, predictions), kld_loss) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>ufunc &#39;isfinite&#39; not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule &#39;&#39;safe&#39;&#39;</code></pre>
<h4 id="run-4-119">Run 4</h4>
<div class="sourceCode" id="cb1319"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1319-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1319-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1319-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1319-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1319-5" title="5"></a>
<a class="sourceLine" id="cb1319-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1319-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1319-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1319-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1319-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1319-11" title="11"></a>
<a class="sourceLine" id="cb1319-12" title="12"><span class="kw">def</span> kld(true_data, predicted_data):</a>
<a class="sourceLine" id="cb1319-13" title="13">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1319-14" title="14"><span class="co">  This function calculates the Kullback–Leibler (KL) divergence loss between true_data and predicted_data.</span></a>
<a class="sourceLine" id="cb1319-15" title="15"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1319-16" title="16">  <span class="co"># start</span></a>
<a class="sourceLine" id="cb1319-17" title="17">  </a>
<a class="sourceLine" id="cb1319-18" title="18"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1319-19" title="19"></a>
<a class="sourceLine" id="cb1319-20" title="20">np.random.seed(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb1319-21" title="21">M <span class="op">=</span> <span class="dv">100</span></a>
<a class="sourceLine" id="cb1319-22" title="22">targets <span class="op">=</span> np.random.rand(M)</a>
<a class="sourceLine" id="cb1319-23" title="23">predictions <span class="op">=</span> targets <span class="op">*</span> <span class="fl">0.9</span></a>
<a class="sourceLine" id="cb1319-24" title="24">kld_loss <span class="op">=</span> <span class="op">-</span>np.<span class="bu">sum</span>(targets<span class="op">*</span>np.log(</a>
<a class="sourceLine" id="cb1319-25" title="25">    np.divide(predictions, targets) <span class="op">+</span> <span class="fl">1e-10</span>))</a>
<a class="sourceLine" id="cb1319-26" title="26"></a>
<a class="sourceLine" id="cb1319-27" title="27">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(kld(targets, predictions), kld_loss) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>ufunc &#39;isfinite&#39; not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule &#39;&#39;safe&#39;&#39;</code></pre>
</details>
<details>
<p><summary>langevin_dynamics</summary></p>
<h4 id="query-120">Query</h4>
<div class="sourceCode" id="cb1321"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1321-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1321-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1321-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1321-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1321-5" title="5"></a>
<a class="sourceLine" id="cb1321-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1321-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1321-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1321-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1321-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1321-11" title="11"></a>
<a class="sourceLine" id="cb1321-12" title="12"><span class="kw">def</span> run_langevin_dynamics(x0,v0,gamma,F,n_steps,dt<span class="op">=</span><span class="fl">0.003</span>,T<span class="op">=</span><span class="fl">1.0</span>,m<span class="op">=</span><span class="dv">1</span>):</a>
<a class="sourceLine" id="cb1321-13" title="13">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1321-14" title="14"><span class="co">    This function runs a Langevin dynamics simulation in 1d in an external potential</span></a>
<a class="sourceLine" id="cb1321-15" title="15"><span class="co">    It returns the trajectory of x and v.</span></a>
<a class="sourceLine" id="cb1321-16" title="16"></a>
<a class="sourceLine" id="cb1321-17" title="17"><span class="co">    The initial position is x0</span></a>
<a class="sourceLine" id="cb1321-18" title="18"><span class="co">    The initial velocity is v0</span></a>
<a class="sourceLine" id="cb1321-19" title="19"><span class="co">    The temperature is T</span></a>
<a class="sourceLine" id="cb1321-20" title="20"><span class="co">    m is the mass</span></a>
<a class="sourceLine" id="cb1321-21" title="21"><span class="co">    F(x) is a function that returns the external force</span></a>
<a class="sourceLine" id="cb1321-22" title="22"><span class="co">    gamma is the drag coefficient</span></a>
<a class="sourceLine" id="cb1321-23" title="23"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1321-24" title="24">    x_traj <span class="op">=</span> np.zeros(n_steps)</a>
<a class="sourceLine" id="cb1321-25" title="25">    v_traj <span class="op">=</span> np.zeros(n_steps)</a>
<a class="sourceLine" id="cb1321-26" title="26">    </a></code></pre></div>
<h4 id="run-0-120">Run 0</h4>
<div class="sourceCode" id="cb1322"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1322-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1322-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1322-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1322-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1322-5" title="5"></a>
<a class="sourceLine" id="cb1322-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1322-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1322-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1322-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1322-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1322-11" title="11"></a>
<a class="sourceLine" id="cb1322-12" title="12"><span class="kw">def</span> run_langevin_dynamics(x0,v0,gamma,F,n_steps,dt<span class="op">=</span><span class="fl">0.003</span>,T<span class="op">=</span><span class="fl">1.0</span>,m<span class="op">=</span><span class="dv">1</span>):</a>
<a class="sourceLine" id="cb1322-13" title="13">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1322-14" title="14"><span class="co">    This function runs a Langevin dynamics simulation in 1d in an external potential</span></a>
<a class="sourceLine" id="cb1322-15" title="15"><span class="co">    It returns the trajectory of x and v.</span></a>
<a class="sourceLine" id="cb1322-16" title="16"></a>
<a class="sourceLine" id="cb1322-17" title="17"><span class="co">    The initial position is x0</span></a>
<a class="sourceLine" id="cb1322-18" title="18"><span class="co">    The initial velocity is v0</span></a>
<a class="sourceLine" id="cb1322-19" title="19"><span class="co">    The temperature is T</span></a>
<a class="sourceLine" id="cb1322-20" title="20"><span class="co">    m is the mass</span></a>
<a class="sourceLine" id="cb1322-21" title="21"><span class="co">    F(x) is a function that returns the external force</span></a>
<a class="sourceLine" id="cb1322-22" title="22"><span class="co">    gamma is the drag coefficient</span></a>
<a class="sourceLine" id="cb1322-23" title="23"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1322-24" title="24">    x_traj <span class="op">=</span> np.zeros(n_steps)</a>
<a class="sourceLine" id="cb1322-25" title="25">    v_traj <span class="op">=</span> np.zeros(n_steps)</a>
<a class="sourceLine" id="cb1322-26" title="26">    x <span class="op">=</span> x0</a>
<a class="sourceLine" id="cb1322-27" title="27">    v <span class="op">=</span> v0</a>
<a class="sourceLine" id="cb1322-28" title="28">    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n_steps):</a>
<a class="sourceLine" id="cb1322-29" title="29">        x_traj[i] <span class="op">=</span> x</a>
<a class="sourceLine" id="cb1322-30" title="30">        v_traj[i] <span class="op">=</span> v</a>
<a class="sourceLine" id="cb1322-31" title="31">        v <span class="op">=</span> v <span class="op">+</span> (F(x)<span class="op">-</span>gamma<span class="op">*</span>v)<span class="op">/</span>m<span class="op">*</span>dt <span class="op">+</span> np.sqrt(<span class="dv">2</span><span class="op">*</span>gamma<span class="op">*</span>T<span class="op">/</span>m)<span class="op">*</span>np.random.normal()<span class="op">*</span>np.sqrt(dt)</a>
<a class="sourceLine" id="cb1322-32" title="32">        x <span class="op">=</span> x <span class="op">+</span> v<span class="op">*</span>dt</a>
<a class="sourceLine" id="cb1322-33" title="33">    <span class="cf">return</span> x_traj,v_traj</a>
<a class="sourceLine" id="cb1322-34" title="34"></a>
<a class="sourceLine" id="cb1322-35" title="35"></a>
<a class="sourceLine" id="cb1322-36" title="36"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1322-37" title="37"><span class="im">import</span> pylab <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1322-38" title="38"><span class="co">#def PE(q):</span></a>
<a class="sourceLine" id="cb1322-39" title="39"><span class="co">#    return (q**2-1.0)**2</span></a>
<a class="sourceLine" id="cb1322-40" title="40"><span class="co">#def F(q):</span></a>
<a class="sourceLine" id="cb1322-41" title="41"><span class="co">#    return -4.0 * q * (q**2-1.0)</span></a>
<a class="sourceLine" id="cb1322-42" title="42"><span class="kw">def</span> F(q,k<span class="op">=</span><span class="dv">2</span>):</a>
<a class="sourceLine" id="cb1322-43" title="43">    <span class="cf">return</span> <span class="op">-</span>k<span class="op">*</span>q</a>
<a class="sourceLine" id="cb1322-44" title="44"></a>
<a class="sourceLine" id="cb1322-45" title="45">x_traj, v_traj <span class="op">=</span> run_langevin_dynamics(<span class="fl">0.1</span>,<span class="op">-</span><span class="fl">0.1</span>,<span class="fl">0.1</span>,F,<span class="dv">100000</span>)</a>
<a class="sourceLine" id="cb1322-46" title="46">plt.plot(x_traj)</a>
<a class="sourceLine" id="cb1322-47" title="47">plt.show()</a>
<a class="sourceLine" id="cb1322-48" title="48">v_traj_half <span class="op">=</span> np.array(v_traj)[<span class="bu">len</span>(v_traj)<span class="op">//</span><span class="dv">2</span>:]</a>
<a class="sourceLine" id="cb1322-49" title="49">msv <span class="op">=</span> v_traj_half.var()</a>
<a class="sourceLine" id="cb1322-50" title="50">ideal_msv <span class="op">=</span> <span class="dv">1</span> <span class="co">#kT/m</span></a>
<a class="sourceLine" id="cb1322-51" title="51"></a>
<a class="sourceLine" id="cb1322-52" title="52">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">abs</span>(msv<span class="op">-</span>ideal_msv)<span class="op">/</span>ideal_msv <span class="op">&lt;</span> <span class="fl">0.2</span> <span class="kw">and</span> np.<span class="bu">abs</span>(np.mean(x_traj[<span class="bu">len</span>(x_traj)<span class="op">//</span><span class="dv">2</span>:]))<span class="op">&lt;</span><span class="fl">0.1</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-120">Run 1</h4>
<div class="sourceCode" id="cb1324"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1324-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1324-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1324-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1324-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1324-5" title="5"></a>
<a class="sourceLine" id="cb1324-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1324-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1324-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1324-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1324-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1324-11" title="11"></a>
<a class="sourceLine" id="cb1324-12" title="12"><span class="kw">def</span> run_langevin_dynamics(x0,v0,gamma,F,n_steps,dt<span class="op">=</span><span class="fl">0.003</span>,T<span class="op">=</span><span class="fl">1.0</span>,m<span class="op">=</span><span class="dv">1</span>):</a>
<a class="sourceLine" id="cb1324-13" title="13">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1324-14" title="14"><span class="co">    This function runs a Langevin dynamics simulation in 1d in an external potential</span></a>
<a class="sourceLine" id="cb1324-15" title="15"><span class="co">    It returns the trajectory of x and v.</span></a>
<a class="sourceLine" id="cb1324-16" title="16"></a>
<a class="sourceLine" id="cb1324-17" title="17"><span class="co">    The initial position is x0</span></a>
<a class="sourceLine" id="cb1324-18" title="18"><span class="co">    The initial velocity is v0</span></a>
<a class="sourceLine" id="cb1324-19" title="19"><span class="co">    The temperature is T</span></a>
<a class="sourceLine" id="cb1324-20" title="20"><span class="co">    m is the mass</span></a>
<a class="sourceLine" id="cb1324-21" title="21"><span class="co">    F(x) is a function that returns the external force</span></a>
<a class="sourceLine" id="cb1324-22" title="22"><span class="co">    gamma is the drag coefficient</span></a>
<a class="sourceLine" id="cb1324-23" title="23"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1324-24" title="24">    x_traj <span class="op">=</span> np.zeros(n_steps)</a>
<a class="sourceLine" id="cb1324-25" title="25">    v_traj <span class="op">=</span> np.zeros(n_steps)</a>
<a class="sourceLine" id="cb1324-26" title="26">    x_traj[<span class="dv">0</span>] <span class="op">=</span> x0</a>
<a class="sourceLine" id="cb1324-27" title="27">    v_traj[<span class="dv">0</span>] <span class="op">=</span> v0</a>
<a class="sourceLine" id="cb1324-28" title="28">    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n_steps<span class="dv">-1</span>):</a>
<a class="sourceLine" id="cb1324-29" title="29">        v_traj[i<span class="op">+</span><span class="dv">1</span>] <span class="op">=</span> v_traj[i] <span class="op">+</span> (<span class="op">-</span>gamma<span class="op">*</span>v_traj[i] <span class="op">+</span> F(x_traj[i]) <span class="op">-</span> T<span class="op">*</span>gamma<span class="op">*</span>np.random.randn()<span class="op">/</span>m)<span class="op">*</span>dt</a>
<a class="sourceLine" id="cb1324-30" title="30">        x_traj[i<span class="op">+</span><span class="dv">1</span>] <span class="op">=</span> x_traj[i] <span class="op">+</span> v_traj[i<span class="op">+</span><span class="dv">1</span>]<span class="op">*</span>dt</a>
<a class="sourceLine" id="cb1324-31" title="31">    <span class="cf">return</span> x_traj,v_traj</a>
<a class="sourceLine" id="cb1324-32" title="32"></a>
<a class="sourceLine" id="cb1324-33" title="33"></a>
<a class="sourceLine" id="cb1324-34" title="34"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1324-35" title="35"><span class="im">import</span> pylab <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1324-36" title="36"><span class="co">#def PE(q):</span></a>
<a class="sourceLine" id="cb1324-37" title="37"><span class="co">#    return (q**2-1.0)**2</span></a>
<a class="sourceLine" id="cb1324-38" title="38"><span class="co">#def F(q):</span></a>
<a class="sourceLine" id="cb1324-39" title="39"><span class="co">#    return -4.0 * q * (q**2-1.0)</span></a>
<a class="sourceLine" id="cb1324-40" title="40"><span class="kw">def</span> F(q,k<span class="op">=</span><span class="dv">2</span>):</a>
<a class="sourceLine" id="cb1324-41" title="41">    <span class="cf">return</span> <span class="op">-</span>k<span class="op">*</span>q</a>
<a class="sourceLine" id="cb1324-42" title="42"></a>
<a class="sourceLine" id="cb1324-43" title="43">x_traj, v_traj <span class="op">=</span> run_langevin_dynamics(<span class="fl">0.1</span>,<span class="op">-</span><span class="fl">0.1</span>,<span class="fl">0.1</span>,F,<span class="dv">100000</span>)</a>
<a class="sourceLine" id="cb1324-44" title="44">plt.plot(x_traj)</a>
<a class="sourceLine" id="cb1324-45" title="45">plt.show()</a>
<a class="sourceLine" id="cb1324-46" title="46">v_traj_half <span class="op">=</span> np.array(v_traj)[<span class="bu">len</span>(v_traj)<span class="op">//</span><span class="dv">2</span>:]</a>
<a class="sourceLine" id="cb1324-47" title="47">msv <span class="op">=</span> v_traj_half.var()</a>
<a class="sourceLine" id="cb1324-48" title="48">ideal_msv <span class="op">=</span> <span class="dv">1</span> <span class="co">#kT/m</span></a>
<a class="sourceLine" id="cb1324-49" title="49"></a>
<a class="sourceLine" id="cb1324-50" title="50">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">abs</span>(msv<span class="op">-</span>ideal_msv)<span class="op">/</span>ideal_msv <span class="op">&lt;</span> <span class="fl">0.2</span> <span class="kw">and</span> np.<span class="bu">abs</span>(np.mean(x_traj[<span class="bu">len</span>(x_traj)<span class="op">//</span><span class="dv">2</span>:]))<span class="op">&lt;</span><span class="fl">0.1</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-120">Run 2</h4>
<div class="sourceCode" id="cb1326"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1326-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1326-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1326-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1326-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1326-5" title="5"></a>
<a class="sourceLine" id="cb1326-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1326-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1326-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1326-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1326-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1326-11" title="11"></a>
<a class="sourceLine" id="cb1326-12" title="12"><span class="kw">def</span> run_langevin_dynamics(x0,v0,gamma,F,n_steps,dt<span class="op">=</span><span class="fl">0.003</span>,T<span class="op">=</span><span class="fl">1.0</span>,m<span class="op">=</span><span class="dv">1</span>):</a>
<a class="sourceLine" id="cb1326-13" title="13">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1326-14" title="14"><span class="co">    This function runs a Langevin dynamics simulation in 1d in an external potential</span></a>
<a class="sourceLine" id="cb1326-15" title="15"><span class="co">    It returns the trajectory of x and v.</span></a>
<a class="sourceLine" id="cb1326-16" title="16"></a>
<a class="sourceLine" id="cb1326-17" title="17"><span class="co">    The initial position is x0</span></a>
<a class="sourceLine" id="cb1326-18" title="18"><span class="co">    The initial velocity is v0</span></a>
<a class="sourceLine" id="cb1326-19" title="19"><span class="co">    The temperature is T</span></a>
<a class="sourceLine" id="cb1326-20" title="20"><span class="co">    m is the mass</span></a>
<a class="sourceLine" id="cb1326-21" title="21"><span class="co">    F(x) is a function that returns the external force</span></a>
<a class="sourceLine" id="cb1326-22" title="22"><span class="co">    gamma is the drag coefficient</span></a>
<a class="sourceLine" id="cb1326-23" title="23"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1326-24" title="24">    x_traj <span class="op">=</span> np.zeros(n_steps)</a>
<a class="sourceLine" id="cb1326-25" title="25">    v_traj <span class="op">=</span> np.zeros(n_steps)</a>
<a class="sourceLine" id="cb1326-26" title="26">    x_traj[<span class="dv">0</span>] <span class="op">=</span> x0</a>
<a class="sourceLine" id="cb1326-27" title="27">    v_traj[<span class="dv">0</span>] <span class="op">=</span> v0</a>
<a class="sourceLine" id="cb1326-28" title="28">    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n_steps<span class="dv">-1</span>):</a>
<a class="sourceLine" id="cb1326-29" title="29">        v_traj[i<span class="op">+</span><span class="dv">1</span>] <span class="op">=</span> v_traj[i] <span class="op">-</span> (gamma<span class="op">/</span>m)<span class="op">*</span>v_traj[i]<span class="op">*</span>dt <span class="op">-</span> (F(x_traj[i])<span class="op">/</span>m)<span class="op">*</span>dt <span class="op">+</span> np.sqrt(<span class="dv">2</span><span class="op">*</span>gamma<span class="op">*</span>T<span class="op">/</span>m)<span class="op">*</span>np.random.normal(<span class="dv">0</span>,<span class="dv">1</span>)<span class="op">*</span>np.sqrt(dt)</a>
<a class="sourceLine" id="cb1326-30" title="30">        x_traj[i<span class="op">+</span><span class="dv">1</span>] <span class="op">=</span> x_traj[i] <span class="op">+</span> v_traj[i<span class="op">+</span><span class="dv">1</span>]<span class="op">*</span>dt</a>
<a class="sourceLine" id="cb1326-31" title="31">    <span class="cf">return</span> x_traj,v_traj</a>
<a class="sourceLine" id="cb1326-32" title="32"></a>
<a class="sourceLine" id="cb1326-33" title="33"></a>
<a class="sourceLine" id="cb1326-34" title="34"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1326-35" title="35"><span class="im">import</span> pylab <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1326-36" title="36"><span class="co">#def PE(q):</span></a>
<a class="sourceLine" id="cb1326-37" title="37"><span class="co">#    return (q**2-1.0)**2</span></a>
<a class="sourceLine" id="cb1326-38" title="38"><span class="co">#def F(q):</span></a>
<a class="sourceLine" id="cb1326-39" title="39"><span class="co">#    return -4.0 * q * (q**2-1.0)</span></a>
<a class="sourceLine" id="cb1326-40" title="40"><span class="kw">def</span> F(q,k<span class="op">=</span><span class="dv">2</span>):</a>
<a class="sourceLine" id="cb1326-41" title="41">    <span class="cf">return</span> <span class="op">-</span>k<span class="op">*</span>q</a>
<a class="sourceLine" id="cb1326-42" title="42"></a>
<a class="sourceLine" id="cb1326-43" title="43">x_traj, v_traj <span class="op">=</span> run_langevin_dynamics(<span class="fl">0.1</span>,<span class="op">-</span><span class="fl">0.1</span>,<span class="fl">0.1</span>,F,<span class="dv">100000</span>)</a>
<a class="sourceLine" id="cb1326-44" title="44">plt.plot(x_traj)</a>
<a class="sourceLine" id="cb1326-45" title="45">plt.show()</a>
<a class="sourceLine" id="cb1326-46" title="46">v_traj_half <span class="op">=</span> np.array(v_traj)[<span class="bu">len</span>(v_traj)<span class="op">//</span><span class="dv">2</span>:]</a>
<a class="sourceLine" id="cb1326-47" title="47">msv <span class="op">=</span> v_traj_half.var()</a>
<a class="sourceLine" id="cb1326-48" title="48">ideal_msv <span class="op">=</span> <span class="dv">1</span> <span class="co">#kT/m</span></a>
<a class="sourceLine" id="cb1326-49" title="49"></a>
<a class="sourceLine" id="cb1326-50" title="50">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">abs</span>(msv<span class="op">-</span>ideal_msv)<span class="op">/</span>ideal_msv <span class="op">&lt;</span> <span class="fl">0.2</span> <span class="kw">and</span> np.<span class="bu">abs</span>(np.mean(x_traj[<span class="bu">len</span>(x_traj)<span class="op">//</span><span class="dv">2</span>:]))<span class="op">&lt;</span><span class="fl">0.1</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-120">Run 3</h4>
<div class="sourceCode" id="cb1328"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1328-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1328-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1328-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1328-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1328-5" title="5"></a>
<a class="sourceLine" id="cb1328-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1328-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1328-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1328-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1328-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1328-11" title="11"></a>
<a class="sourceLine" id="cb1328-12" title="12"><span class="kw">def</span> run_langevin_dynamics(x0,v0,gamma,F,n_steps,dt<span class="op">=</span><span class="fl">0.003</span>,T<span class="op">=</span><span class="fl">1.0</span>,m<span class="op">=</span><span class="dv">1</span>):</a>
<a class="sourceLine" id="cb1328-13" title="13">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1328-14" title="14"><span class="co">    This function runs a Langevin dynamics simulation in 1d in an external potential</span></a>
<a class="sourceLine" id="cb1328-15" title="15"><span class="co">    It returns the trajectory of x and v.</span></a>
<a class="sourceLine" id="cb1328-16" title="16"></a>
<a class="sourceLine" id="cb1328-17" title="17"><span class="co">    The initial position is x0</span></a>
<a class="sourceLine" id="cb1328-18" title="18"><span class="co">    The initial velocity is v0</span></a>
<a class="sourceLine" id="cb1328-19" title="19"><span class="co">    The temperature is T</span></a>
<a class="sourceLine" id="cb1328-20" title="20"><span class="co">    m is the mass</span></a>
<a class="sourceLine" id="cb1328-21" title="21"><span class="co">    F(x) is a function that returns the external force</span></a>
<a class="sourceLine" id="cb1328-22" title="22"><span class="co">    gamma is the drag coefficient</span></a>
<a class="sourceLine" id="cb1328-23" title="23"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1328-24" title="24">    x_traj <span class="op">=</span> np.zeros(n_steps)</a>
<a class="sourceLine" id="cb1328-25" title="25">    v_traj <span class="op">=</span> np.zeros(n_steps)</a>
<a class="sourceLine" id="cb1328-26" title="26">    x_traj[<span class="dv">0</span>] <span class="op">=</span> x0</a>
<a class="sourceLine" id="cb1328-27" title="27">    v_traj[<span class="dv">0</span>] <span class="op">=</span> v0</a>
<a class="sourceLine" id="cb1328-28" title="28">    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n_steps<span class="dv">-1</span>):</a>
<a class="sourceLine" id="cb1328-29" title="29">        x_traj[i<span class="op">+</span><span class="dv">1</span>] <span class="op">=</span> x_traj[i] <span class="op">+</span> v_traj[i]<span class="op">*</span>dt <span class="op">+</span> <span class="fl">0.5</span><span class="op">*</span>F(x_traj[i])<span class="op">*</span>dt<span class="op">**</span><span class="dv">2</span><span class="op">/</span>m</a>
<a class="sourceLine" id="cb1328-30" title="30">        v_traj[i<span class="op">+</span><span class="dv">1</span>] <span class="op">=</span> v_traj[i] <span class="op">+</span> <span class="fl">0.5</span><span class="op">*</span>(F(x_traj[i])<span class="op">/</span>m <span class="op">+</span> F(x_traj[i<span class="op">+</span><span class="dv">1</span>])<span class="op">/</span>m)<span class="op">*</span>dt <span class="op">-</span> gamma<span class="op">*</span>v_traj[i]<span class="op">*</span>dt <span class="op">+</span> np.sqrt(<span class="dv">2</span><span class="op">*</span>gamma<span class="op">*</span>T<span class="op">*</span>dt)<span class="op">*</span>np.random.normal()</a>
<a class="sourceLine" id="cb1328-31" title="31">    <span class="cf">return</span> x_traj, v_traj</a>
<a class="sourceLine" id="cb1328-32" title="32"></a>
<a class="sourceLine" id="cb1328-33" title="33"></a>
<a class="sourceLine" id="cb1328-34" title="34"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1328-35" title="35"><span class="im">import</span> pylab <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1328-36" title="36"><span class="co">#def PE(q):</span></a>
<a class="sourceLine" id="cb1328-37" title="37"><span class="co">#    return (q**2-1.0)**2</span></a>
<a class="sourceLine" id="cb1328-38" title="38"><span class="co">#def F(q):</span></a>
<a class="sourceLine" id="cb1328-39" title="39"><span class="co">#    return -4.0 * q * (q**2-1.0)</span></a>
<a class="sourceLine" id="cb1328-40" title="40"><span class="kw">def</span> F(q,k<span class="op">=</span><span class="dv">2</span>):</a>
<a class="sourceLine" id="cb1328-41" title="41">    <span class="cf">return</span> <span class="op">-</span>k<span class="op">*</span>q</a>
<a class="sourceLine" id="cb1328-42" title="42"></a>
<a class="sourceLine" id="cb1328-43" title="43">x_traj, v_traj <span class="op">=</span> run_langevin_dynamics(<span class="fl">0.1</span>,<span class="op">-</span><span class="fl">0.1</span>,<span class="fl">0.1</span>,F,<span class="dv">100000</span>)</a>
<a class="sourceLine" id="cb1328-44" title="44">plt.plot(x_traj)</a>
<a class="sourceLine" id="cb1328-45" title="45">plt.show()</a>
<a class="sourceLine" id="cb1328-46" title="46">v_traj_half <span class="op">=</span> np.array(v_traj)[<span class="bu">len</span>(v_traj)<span class="op">//</span><span class="dv">2</span>:]</a>
<a class="sourceLine" id="cb1328-47" title="47">msv <span class="op">=</span> v_traj_half.var()</a>
<a class="sourceLine" id="cb1328-48" title="48">ideal_msv <span class="op">=</span> <span class="dv">1</span> <span class="co">#kT/m</span></a>
<a class="sourceLine" id="cb1328-49" title="49"></a>
<a class="sourceLine" id="cb1328-50" title="50">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">abs</span>(msv<span class="op">-</span>ideal_msv)<span class="op">/</span>ideal_msv <span class="op">&lt;</span> <span class="fl">0.2</span> <span class="kw">and</span> np.<span class="bu">abs</span>(np.mean(x_traj[<span class="bu">len</span>(x_traj)<span class="op">//</span><span class="dv">2</span>:]))<span class="op">&lt;</span><span class="fl">0.1</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-120">Run 4</h4>
<div class="sourceCode" id="cb1330"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1330-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1330-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1330-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1330-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1330-5" title="5"></a>
<a class="sourceLine" id="cb1330-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1330-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1330-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1330-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1330-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1330-11" title="11"></a>
<a class="sourceLine" id="cb1330-12" title="12"><span class="kw">def</span> run_langevin_dynamics(x0,v0,gamma,F,n_steps,dt<span class="op">=</span><span class="fl">0.003</span>,T<span class="op">=</span><span class="fl">1.0</span>,m<span class="op">=</span><span class="dv">1</span>):</a>
<a class="sourceLine" id="cb1330-13" title="13">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1330-14" title="14"><span class="co">    This function runs a Langevin dynamics simulation in 1d in an external potential</span></a>
<a class="sourceLine" id="cb1330-15" title="15"><span class="co">    It returns the trajectory of x and v.</span></a>
<a class="sourceLine" id="cb1330-16" title="16"></a>
<a class="sourceLine" id="cb1330-17" title="17"><span class="co">    The initial position is x0</span></a>
<a class="sourceLine" id="cb1330-18" title="18"><span class="co">    The initial velocity is v0</span></a>
<a class="sourceLine" id="cb1330-19" title="19"><span class="co">    The temperature is T</span></a>
<a class="sourceLine" id="cb1330-20" title="20"><span class="co">    m is the mass</span></a>
<a class="sourceLine" id="cb1330-21" title="21"><span class="co">    F(x) is a function that returns the external force</span></a>
<a class="sourceLine" id="cb1330-22" title="22"><span class="co">    gamma is the drag coefficient</span></a>
<a class="sourceLine" id="cb1330-23" title="23"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1330-24" title="24">    x_traj <span class="op">=</span> np.zeros(n_steps)</a>
<a class="sourceLine" id="cb1330-25" title="25">    v_traj <span class="op">=</span> np.zeros(n_steps)</a>
<a class="sourceLine" id="cb1330-26" title="26">    x_traj[<span class="dv">0</span>] <span class="op">=</span> x0</a>
<a class="sourceLine" id="cb1330-27" title="27">    v_traj[<span class="dv">0</span>] <span class="op">=</span> v0</a>
<a class="sourceLine" id="cb1330-28" title="28">    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n_steps<span class="dv">-1</span>):</a>
<a class="sourceLine" id="cb1330-29" title="29">        x_traj[i<span class="op">+</span><span class="dv">1</span>] <span class="op">=</span> x_traj[i] <span class="op">+</span> v_traj[i]<span class="op">*</span>dt</a>
<a class="sourceLine" id="cb1330-30" title="30">        v_traj[i<span class="op">+</span><span class="dv">1</span>] <span class="op">=</span> v_traj[i] <span class="op">+</span> (F(x_traj[i])<span class="op">/</span>m <span class="op">-</span> gamma<span class="op">*</span>v_traj[i]<span class="op">/</span>m <span class="op">+</span> np.sqrt(<span class="dv">2</span><span class="op">*</span>gamma<span class="op">*</span>T<span class="op">/</span>m)<span class="op">*</span>np.random.normal(<span class="dv">0</span>,<span class="dv">1</span>))<span class="op">*</span>dt</a>
<a class="sourceLine" id="cb1330-31" title="31">    <span class="cf">return</span> x_traj, v_traj</a>
<a class="sourceLine" id="cb1330-32" title="32"></a>
<a class="sourceLine" id="cb1330-33" title="33"></a>
<a class="sourceLine" id="cb1330-34" title="34"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1330-35" title="35"><span class="im">import</span> pylab <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1330-36" title="36"><span class="co">#def PE(q):</span></a>
<a class="sourceLine" id="cb1330-37" title="37"><span class="co">#    return (q**2-1.0)**2</span></a>
<a class="sourceLine" id="cb1330-38" title="38"><span class="co">#def F(q):</span></a>
<a class="sourceLine" id="cb1330-39" title="39"><span class="co">#    return -4.0 * q * (q**2-1.0)</span></a>
<a class="sourceLine" id="cb1330-40" title="40"><span class="kw">def</span> F(q,k<span class="op">=</span><span class="dv">2</span>):</a>
<a class="sourceLine" id="cb1330-41" title="41">    <span class="cf">return</span> <span class="op">-</span>k<span class="op">*</span>q</a>
<a class="sourceLine" id="cb1330-42" title="42"></a>
<a class="sourceLine" id="cb1330-43" title="43">x_traj, v_traj <span class="op">=</span> run_langevin_dynamics(<span class="fl">0.1</span>,<span class="op">-</span><span class="fl">0.1</span>,<span class="fl">0.1</span>,F,<span class="dv">100000</span>)</a>
<a class="sourceLine" id="cb1330-44" title="44">plt.plot(x_traj)</a>
<a class="sourceLine" id="cb1330-45" title="45">plt.show()</a>
<a class="sourceLine" id="cb1330-46" title="46">v_traj_half <span class="op">=</span> np.array(v_traj)[<span class="bu">len</span>(v_traj)<span class="op">//</span><span class="dv">2</span>:]</a>
<a class="sourceLine" id="cb1330-47" title="47">msv <span class="op">=</span> v_traj_half.var()</a>
<a class="sourceLine" id="cb1330-48" title="48">ideal_msv <span class="op">=</span> <span class="dv">1</span> <span class="co">#kT/m</span></a>
<a class="sourceLine" id="cb1330-49" title="49"></a>
<a class="sourceLine" id="cb1330-50" title="50">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">abs</span>(msv<span class="op">-</span>ideal_msv)<span class="op">/</span>ideal_msv <span class="op">&lt;</span> <span class="fl">0.2</span> <span class="kw">and</span> np.<span class="bu">abs</span>(np.mean(x_traj[<span class="bu">len</span>(x_traj)<span class="op">//</span><span class="dv">2</span>:]))<span class="op">&lt;</span><span class="fl">0.1</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>lipinski_rule_of_five</summary></p>
<h4 id="query-121">Query</h4>
<div class="sourceCode" id="cb1332"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1332-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1332-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb1332-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb1332-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb1332-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb1332-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb1332-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb1332-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb1332-9" title="9"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb1332-10" title="10"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb1332-11" title="11"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1332-12" title="12"></a>
<a class="sourceLine" id="cb1332-13" title="13"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1332-14" title="14"><span class="co">print rdkit version</span></a>
<a class="sourceLine" id="cb1332-15" title="15"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1332-16" title="16"><span class="bu">print</span>(rdkit.__version__)</a>
<a class="sourceLine" id="cb1332-17" title="17"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1332-18" title="18"></a>
<a class="sourceLine" id="cb1332-19" title="19"><span class="kw">def</span> lipinski_rule_of_five(smiles):</a>
<a class="sourceLine" id="cb1332-20" title="20">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1332-21" title="21"><span class="co">    This function calculates the Lipinski descriptors of the given SMILES string and returns a boolean to indicate if Lipinski&#39;s rule of five was satisfied.</span></a>
<a class="sourceLine" id="cb1332-22" title="22"></a>
<a class="sourceLine" id="cb1332-23" title="23"><span class="co">    Lipinski&#39;s rules are:</span></a>
<a class="sourceLine" id="cb1332-24" title="24"><span class="co">    Hydrogen bond donors &lt;= 5</span></a>
<a class="sourceLine" id="cb1332-25" title="25"><span class="co">    Hydrogen bond acceptors &lt;= 10</span></a>
<a class="sourceLine" id="cb1332-26" title="26"><span class="co">    Molecular weight &lt; 500 daltons</span></a>
<a class="sourceLine" id="cb1332-27" title="27"><span class="co">    logP &lt; 5</span></a>
<a class="sourceLine" id="cb1332-28" title="28"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1332-29" title="29">    </a></code></pre></div>
<h4 id="run-0-121">Run 0</h4>
<div class="sourceCode" id="cb1333"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1333-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1333-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb1333-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb1333-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb1333-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb1333-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb1333-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb1333-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb1333-9" title="9"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb1333-10" title="10"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb1333-11" title="11"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1333-12" title="12"></a>
<a class="sourceLine" id="cb1333-13" title="13"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1333-14" title="14"><span class="co">print rdkit version</span></a>
<a class="sourceLine" id="cb1333-15" title="15"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1333-16" title="16"><span class="bu">print</span>(rdkit.__version__)</a>
<a class="sourceLine" id="cb1333-17" title="17"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1333-18" title="18"></a>
<a class="sourceLine" id="cb1333-19" title="19"><span class="kw">def</span> lipinski_rule_of_five(smiles):</a>
<a class="sourceLine" id="cb1333-20" title="20">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1333-21" title="21"><span class="co">    This function calculates the Lipinski descriptors of the given SMILES string and returns a boolean to indicate if Lipinski&#39;s rule of five was satisfied.</span></a>
<a class="sourceLine" id="cb1333-22" title="22"></a>
<a class="sourceLine" id="cb1333-23" title="23"><span class="co">    Lipinski&#39;s rules are:</span></a>
<a class="sourceLine" id="cb1333-24" title="24"><span class="co">    Hydrogen bond donors &lt;= 5</span></a>
<a class="sourceLine" id="cb1333-25" title="25"><span class="co">    Hydrogen bond acceptors &lt;= 10</span></a>
<a class="sourceLine" id="cb1333-26" title="26"><span class="co">    Molecular weight &lt; 500 daltons</span></a>
<a class="sourceLine" id="cb1333-27" title="27"><span class="co">    logP &lt; 5</span></a>
<a class="sourceLine" id="cb1333-28" title="28"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1333-29" title="29">    mol <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb1333-30" title="30">    <span class="cf">if</span> mol <span class="kw">is</span> <span class="va">None</span>:</a>
<a class="sourceLine" id="cb1333-31" title="31">        <span class="cf">return</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb1333-32" title="32">    <span class="cf">if</span> rdMolDescriptors.CalcNumHBD(mol) <span class="op">&gt;</span> <span class="dv">5</span>:</a>
<a class="sourceLine" id="cb1333-33" title="33">        <span class="cf">return</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb1333-34" title="34">    <span class="cf">if</span> rdMolDescriptors.CalcNumHBA(mol) <span class="op">&gt;</span> <span class="dv">10</span>:</a>
<a class="sourceLine" id="cb1333-35" title="35">        <span class="cf">return</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb1333-36" title="36">    <span class="cf">if</span> Descriptors.MolWt(mol) <span class="op">&gt;</span> <span class="dv">500</span>:</a>
<a class="sourceLine" id="cb1333-37" title="37">        <span class="cf">return</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb1333-38" title="38">    <span class="cf">if</span> Crippen.MolLogP(mol) <span class="op">&gt;</span> <span class="dv">5</span>:</a>
<a class="sourceLine" id="cb1333-39" title="39">        <span class="cf">return</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb1333-40" title="40">    <span class="cf">return</span> <span class="va">True</span></a>
<a class="sourceLine" id="cb1333-41" title="41"></a>
<a class="sourceLine" id="cb1333-42" title="42"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb1333-43" title="43">smiles <span class="op">=</span> <span class="st">&#39;CC1=CN=C(C(=C1OC)C)CS(=O)C2=NC3=C(N2)C=C(C=C3)OC&#39;</span>  <span class="co"># omeprazole</span></a>
<a class="sourceLine" id="cb1333-44" title="44">m <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb1333-45" title="45">hbd <span class="op">=</span> Chem.rdMolDescriptors.CalcNumHBD(m)</a>
<a class="sourceLine" id="cb1333-46" title="46">hba <span class="op">=</span> Chem.rdMolDescriptors.CalcNumHBA(m)</a>
<a class="sourceLine" id="cb1333-47" title="47">wt <span class="op">=</span> Chem.rdMolDescriptors.CalcExactMolWt(m)</a>
<a class="sourceLine" id="cb1333-48" title="48">logp <span class="op">=</span> Chem.Crippen.MolLogP(m)</a>
<a class="sourceLine" id="cb1333-49" title="49"></a>
<a class="sourceLine" id="cb1333-50" title="50"><span class="cf">if</span> hbd <span class="op">&lt;</span> <span class="dv">5</span> <span class="kw">and</span> hba <span class="op">&lt;</span> <span class="dv">10</span> <span class="kw">and</span> wt <span class="op">&lt;</span> <span class="dv">500</span> <span class="kw">and</span> logp <span class="op">&lt;</span> <span class="dv">5</span>:</a>
<a class="sourceLine" id="cb1333-51" title="51">    passed <span class="op">=</span> <span class="va">True</span></a>
<a class="sourceLine" id="cb1333-52" title="52"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb1333-53" title="53">    passed <span class="op">=</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb1333-54" title="54"></a>
<a class="sourceLine" id="cb1333-55" title="55">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> lipinski_rule_of_five(smiles) <span class="op">==</span> passed <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-121">Run 1</h4>
<div class="sourceCode" id="cb1335"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1335-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1335-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb1335-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb1335-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb1335-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb1335-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb1335-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb1335-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb1335-9" title="9"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb1335-10" title="10"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb1335-11" title="11"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1335-12" title="12"></a>
<a class="sourceLine" id="cb1335-13" title="13"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1335-14" title="14"><span class="co">print rdkit version</span></a>
<a class="sourceLine" id="cb1335-15" title="15"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1335-16" title="16"><span class="bu">print</span>(rdkit.__version__)</a>
<a class="sourceLine" id="cb1335-17" title="17"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1335-18" title="18"></a>
<a class="sourceLine" id="cb1335-19" title="19"><span class="kw">def</span> lipinski_rule_of_five(smiles):</a>
<a class="sourceLine" id="cb1335-20" title="20">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1335-21" title="21"><span class="co">    This function calculates the Lipinski descriptors of the given SMILES string and returns a boolean to indicate if Lipinski&#39;s rule of five was satisfied.</span></a>
<a class="sourceLine" id="cb1335-22" title="22"></a>
<a class="sourceLine" id="cb1335-23" title="23"><span class="co">    Lipinski&#39;s rules are:</span></a>
<a class="sourceLine" id="cb1335-24" title="24"><span class="co">    Hydrogen bond donors &lt;= 5</span></a>
<a class="sourceLine" id="cb1335-25" title="25"><span class="co">    Hydrogen bond acceptors &lt;= 10</span></a>
<a class="sourceLine" id="cb1335-26" title="26"><span class="co">    Molecular weight &lt; 500 daltons</span></a>
<a class="sourceLine" id="cb1335-27" title="27"><span class="co">    logP &lt; 5</span></a>
<a class="sourceLine" id="cb1335-28" title="28"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1335-29" title="29">    mol <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb1335-30" title="30">    <span class="cf">if</span> mol <span class="kw">is</span> <span class="va">None</span>:</a>
<a class="sourceLine" id="cb1335-31" title="31">        <span class="cf">return</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb1335-32" title="32">    </a>
<a class="sourceLine" id="cb1335-33" title="33"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb1335-34" title="34">smiles <span class="op">=</span> <span class="st">&#39;CC1=CN=C(C(=C1OC)C)CS(=O)C2=NC3=C(N2)C=C(C=C3)OC&#39;</span>  <span class="co"># omeprazole</span></a>
<a class="sourceLine" id="cb1335-35" title="35">m <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb1335-36" title="36">hbd <span class="op">=</span> Chem.rdMolDescriptors.CalcNumHBD(m)</a>
<a class="sourceLine" id="cb1335-37" title="37">hba <span class="op">=</span> Chem.rdMolDescriptors.CalcNumHBA(m)</a>
<a class="sourceLine" id="cb1335-38" title="38">wt <span class="op">=</span> Chem.rdMolDescriptors.CalcExactMolWt(m)</a>
<a class="sourceLine" id="cb1335-39" title="39">logp <span class="op">=</span> Chem.Crippen.MolLogP(m)</a>
<a class="sourceLine" id="cb1335-40" title="40"></a>
<a class="sourceLine" id="cb1335-41" title="41"><span class="cf">if</span> hbd <span class="op">&lt;</span> <span class="dv">5</span> <span class="kw">and</span> hba <span class="op">&lt;</span> <span class="dv">10</span> <span class="kw">and</span> wt <span class="op">&lt;</span> <span class="dv">500</span> <span class="kw">and</span> logp <span class="op">&lt;</span> <span class="dv">5</span>:</a>
<a class="sourceLine" id="cb1335-42" title="42">    passed <span class="op">=</span> <span class="va">True</span></a>
<a class="sourceLine" id="cb1335-43" title="43"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb1335-44" title="44">    passed <span class="op">=</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb1335-45" title="45"></a>
<a class="sourceLine" id="cb1335-46" title="46">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> lipinski_rule_of_five(smiles) <span class="op">==</span> passed <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-121">Run 2</h4>
<div class="sourceCode" id="cb1337"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1337-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1337-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb1337-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb1337-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb1337-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb1337-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb1337-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb1337-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb1337-9" title="9"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb1337-10" title="10"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb1337-11" title="11"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1337-12" title="12"></a>
<a class="sourceLine" id="cb1337-13" title="13"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1337-14" title="14"><span class="co">print rdkit version</span></a>
<a class="sourceLine" id="cb1337-15" title="15"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1337-16" title="16"><span class="bu">print</span>(rdkit.__version__)</a>
<a class="sourceLine" id="cb1337-17" title="17"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1337-18" title="18"></a>
<a class="sourceLine" id="cb1337-19" title="19"><span class="kw">def</span> lipinski_rule_of_five(smiles):</a>
<a class="sourceLine" id="cb1337-20" title="20">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1337-21" title="21"><span class="co">    This function calculates the Lipinski descriptors of the given SMILES string and returns a boolean to indicate if Lipinski&#39;s rule of five was satisfied.</span></a>
<a class="sourceLine" id="cb1337-22" title="22"></a>
<a class="sourceLine" id="cb1337-23" title="23"><span class="co">    Lipinski&#39;s rules are:</span></a>
<a class="sourceLine" id="cb1337-24" title="24"><span class="co">    Hydrogen bond donors &lt;= 5</span></a>
<a class="sourceLine" id="cb1337-25" title="25"><span class="co">    Hydrogen bond acceptors &lt;= 10</span></a>
<a class="sourceLine" id="cb1337-26" title="26"><span class="co">    Molecular weight &lt; 500 daltons</span></a>
<a class="sourceLine" id="cb1337-27" title="27"><span class="co">    logP &lt; 5</span></a>
<a class="sourceLine" id="cb1337-28" title="28"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1337-29" title="29">    mol <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb1337-30" title="30">    <span class="cf">if</span> mol <span class="kw">is</span> <span class="va">None</span>:</a>
<a class="sourceLine" id="cb1337-31" title="31">        <span class="cf">return</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb1337-32" title="32">    <span class="cf">if</span> rdMolDescriptors.CalcNumHBD(mol) <span class="op">&gt;</span> <span class="dv">5</span>:</a>
<a class="sourceLine" id="cb1337-33" title="33">        <span class="cf">return</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb1337-34" title="34">    <span class="cf">if</span> rdMolDescriptors.CalcNumHBA(mol) <span class="op">&gt;</span> <span class="dv">10</span>:</a>
<a class="sourceLine" id="cb1337-35" title="35">        <span class="cf">return</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb1337-36" title="36">    <span class="cf">if</span> Descriptors.MolWt(mol) <span class="op">&gt;</span> <span class="dv">500</span>:</a>
<a class="sourceLine" id="cb1337-37" title="37">        <span class="cf">return</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb1337-38" title="38">    <span class="cf">if</span> Crippen.MolLogP(mol) <span class="op">&gt;</span> <span class="dv">5</span>:</a>
<a class="sourceLine" id="cb1337-39" title="39">        <span class="cf">return</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb1337-40" title="40">    <span class="cf">return</span> <span class="va">True</span></a>
<a class="sourceLine" id="cb1337-41" title="41"></a>
<a class="sourceLine" id="cb1337-42" title="42"></a>
<a class="sourceLine" id="cb1337-43" title="43"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb1337-44" title="44">smiles <span class="op">=</span> <span class="st">&#39;CC1=CN=C(C(=C1OC)C)CS(=O)C2=NC3=C(N2)C=C(C=C3)OC&#39;</span>  <span class="co"># omeprazole</span></a>
<a class="sourceLine" id="cb1337-45" title="45">m <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb1337-46" title="46">hbd <span class="op">=</span> Chem.rdMolDescriptors.CalcNumHBD(m)</a>
<a class="sourceLine" id="cb1337-47" title="47">hba <span class="op">=</span> Chem.rdMolDescriptors.CalcNumHBA(m)</a>
<a class="sourceLine" id="cb1337-48" title="48">wt <span class="op">=</span> Chem.rdMolDescriptors.CalcExactMolWt(m)</a>
<a class="sourceLine" id="cb1337-49" title="49">logp <span class="op">=</span> Chem.Crippen.MolLogP(m)</a>
<a class="sourceLine" id="cb1337-50" title="50"></a>
<a class="sourceLine" id="cb1337-51" title="51"><span class="cf">if</span> hbd <span class="op">&lt;</span> <span class="dv">5</span> <span class="kw">and</span> hba <span class="op">&lt;</span> <span class="dv">10</span> <span class="kw">and</span> wt <span class="op">&lt;</span> <span class="dv">500</span> <span class="kw">and</span> logp <span class="op">&lt;</span> <span class="dv">5</span>:</a>
<a class="sourceLine" id="cb1337-52" title="52">    passed <span class="op">=</span> <span class="va">True</span></a>
<a class="sourceLine" id="cb1337-53" title="53"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb1337-54" title="54">    passed <span class="op">=</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb1337-55" title="55"></a>
<a class="sourceLine" id="cb1337-56" title="56">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> lipinski_rule_of_five(smiles) <span class="op">==</span> passed <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-121">Run 3</h4>
<div class="sourceCode" id="cb1339"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1339-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1339-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb1339-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb1339-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb1339-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb1339-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb1339-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb1339-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb1339-9" title="9"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb1339-10" title="10"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb1339-11" title="11"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1339-12" title="12"></a>
<a class="sourceLine" id="cb1339-13" title="13"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1339-14" title="14"><span class="co">print rdkit version</span></a>
<a class="sourceLine" id="cb1339-15" title="15"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1339-16" title="16"><span class="bu">print</span>(rdkit.__version__)</a>
<a class="sourceLine" id="cb1339-17" title="17"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1339-18" title="18"></a>
<a class="sourceLine" id="cb1339-19" title="19"><span class="kw">def</span> lipinski_rule_of_five(smiles):</a>
<a class="sourceLine" id="cb1339-20" title="20">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1339-21" title="21"><span class="co">    This function calculates the Lipinski descriptors of the given SMILES string and returns a boolean to indicate if Lipinski&#39;s rule of five was satisfied.</span></a>
<a class="sourceLine" id="cb1339-22" title="22"></a>
<a class="sourceLine" id="cb1339-23" title="23"><span class="co">    Lipinski&#39;s rules are:</span></a>
<a class="sourceLine" id="cb1339-24" title="24"><span class="co">    Hydrogen bond donors &lt;= 5</span></a>
<a class="sourceLine" id="cb1339-25" title="25"><span class="co">    Hydrogen bond acceptors &lt;= 10</span></a>
<a class="sourceLine" id="cb1339-26" title="26"><span class="co">    Molecular weight &lt; 500 daltons</span></a>
<a class="sourceLine" id="cb1339-27" title="27"><span class="co">    logP &lt; 5</span></a>
<a class="sourceLine" id="cb1339-28" title="28"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1339-29" title="29">    <span class="co"># create a molecule from the SMILES string</span></a>
<a class="sourceLine" id="cb1339-30" title="30">    mol <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb1339-31" title="31">    <span class="co"># calculate the number of hydrogen bond donors</span></a>
<a class="sourceLine" id="cb1339-32" title="32">    hbd <span class="op">=</span> rdMolDescriptors.CalcNumHBD(mol)</a>
<a class="sourceLine" id="cb1339-33" title="33">    <span class="co"># calculate the number of hydrogen bond acceptors</span></a>
<a class="sourceLine" id="cb1339-34" title="34">    hba <span class="op">=</span> rdMolDescriptors.CalcNumHBA(mol)</a>
<a class="sourceLine" id="cb1339-35" title="35">    <span class="co"># calculate the molecular weight</span></a>
<a class="sourceLine" id="cb1339-36" title="36">    mw <span class="op">=</span> Descriptors.MolWt(mol)</a>
<a class="sourceLine" id="cb1339-37" title="37">    <span class="co"># calculate the logP</span></a>
<a class="sourceLine" id="cb1339-38" title="38">    logp <span class="op">=</span> Crippen.MolLogP(mol)</a>
<a class="sourceLine" id="cb1339-39" title="39">    <span class="co"># return a boolean indicating if the molecule satisfies Lipinski&#39;s rule of five</span></a>
<a class="sourceLine" id="cb1339-40" title="40">    <span class="cf">return</span> (hbd <span class="op">&lt;=</span> <span class="dv">5</span>) <span class="kw">and</span> (hba <span class="op">&lt;=</span> <span class="dv">10</span>) <span class="kw">and</span> (mw <span class="op">&lt;</span> <span class="dv">500</span>) <span class="kw">and</span> (logp <span class="op">&lt;</span> <span class="dv">5</span>)</a>
<a class="sourceLine" id="cb1339-41" title="41"></a>
<a class="sourceLine" id="cb1339-42" title="42"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb1339-43" title="43">smiles <span class="op">=</span> <span class="st">&#39;CC1=CN=C(C(=C1OC)C)CS(=O)C2=NC3=C(N2)C=C(C=C3)OC&#39;</span>  <span class="co"># omeprazole</span></a>
<a class="sourceLine" id="cb1339-44" title="44">m <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb1339-45" title="45">hbd <span class="op">=</span> Chem.rdMolDescriptors.CalcNumHBD(m)</a>
<a class="sourceLine" id="cb1339-46" title="46">hba <span class="op">=</span> Chem.rdMolDescriptors.CalcNumHBA(m)</a>
<a class="sourceLine" id="cb1339-47" title="47">wt <span class="op">=</span> Chem.rdMolDescriptors.CalcExactMolWt(m)</a>
<a class="sourceLine" id="cb1339-48" title="48">logp <span class="op">=</span> Chem.Crippen.MolLogP(m)</a>
<a class="sourceLine" id="cb1339-49" title="49"></a>
<a class="sourceLine" id="cb1339-50" title="50"><span class="cf">if</span> hbd <span class="op">&lt;</span> <span class="dv">5</span> <span class="kw">and</span> hba <span class="op">&lt;</span> <span class="dv">10</span> <span class="kw">and</span> wt <span class="op">&lt;</span> <span class="dv">500</span> <span class="kw">and</span> logp <span class="op">&lt;</span> <span class="dv">5</span>:</a>
<a class="sourceLine" id="cb1339-51" title="51">    passed <span class="op">=</span> <span class="va">True</span></a>
<a class="sourceLine" id="cb1339-52" title="52"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb1339-53" title="53">    passed <span class="op">=</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb1339-54" title="54"></a>
<a class="sourceLine" id="cb1339-55" title="55">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> lipinski_rule_of_five(smiles) <span class="op">==</span> passed <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-121">Run 4</h4>
<div class="sourceCode" id="cb1341"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1341-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1341-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb1341-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb1341-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb1341-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb1341-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb1341-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb1341-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb1341-9" title="9"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb1341-10" title="10"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb1341-11" title="11"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1341-12" title="12"></a>
<a class="sourceLine" id="cb1341-13" title="13"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1341-14" title="14"><span class="co">print rdkit version</span></a>
<a class="sourceLine" id="cb1341-15" title="15"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1341-16" title="16"><span class="bu">print</span>(rdkit.__version__)</a>
<a class="sourceLine" id="cb1341-17" title="17"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1341-18" title="18"></a>
<a class="sourceLine" id="cb1341-19" title="19"><span class="kw">def</span> lipinski_rule_of_five(smiles):</a>
<a class="sourceLine" id="cb1341-20" title="20">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1341-21" title="21"><span class="co">    This function calculates the Lipinski descriptors of the given SMILES string and returns a boolean to indicate if Lipinski&#39;s rule of five was satisfied.</span></a>
<a class="sourceLine" id="cb1341-22" title="22"></a>
<a class="sourceLine" id="cb1341-23" title="23"><span class="co">    Lipinski&#39;s rules are:</span></a>
<a class="sourceLine" id="cb1341-24" title="24"><span class="co">    Hydrogen bond donors &lt;= 5</span></a>
<a class="sourceLine" id="cb1341-25" title="25"><span class="co">    Hydrogen bond acceptors &lt;= 10</span></a>
<a class="sourceLine" id="cb1341-26" title="26"><span class="co">    Molecular weight &lt; 500 daltons</span></a>
<a class="sourceLine" id="cb1341-27" title="27"><span class="co">    logP &lt; 5</span></a>
<a class="sourceLine" id="cb1341-28" title="28"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1341-29" title="29">    m <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb1341-30" title="30">    hbd <span class="op">=</span> rdMolDescriptors.CalcNumHBD(m)</a>
<a class="sourceLine" id="cb1341-31" title="31">    hba <span class="op">=</span> rdMolDescriptors.CalcNumHBA(m)</a>
<a class="sourceLine" id="cb1341-32" title="32">    mw <span class="op">=</span> Descriptors.MolWt(m)</a>
<a class="sourceLine" id="cb1341-33" title="33">    logp <span class="op">=</span> Crippen.MolLogP(m)</a>
<a class="sourceLine" id="cb1341-34" title="34">    <span class="cf">if</span> hbd <span class="op">&lt;=</span> <span class="dv">5</span> <span class="kw">and</span> hba <span class="op">&lt;=</span> <span class="dv">10</span> <span class="kw">and</span> mw <span class="op">&lt;</span> <span class="dv">500</span> <span class="kw">and</span> logp <span class="op">&lt;</span> <span class="dv">5</span>:</a>
<a class="sourceLine" id="cb1341-35" title="35">        <span class="cf">return</span> <span class="va">True</span></a>
<a class="sourceLine" id="cb1341-36" title="36">    <span class="cf">else</span>:</a>
<a class="sourceLine" id="cb1341-37" title="37">        <span class="cf">return</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb1341-38" title="38">    </a>
<a class="sourceLine" id="cb1341-39" title="39"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb1341-40" title="40">smiles <span class="op">=</span> <span class="st">&#39;CC1=CN=C(C(=C1OC)C)CS(=O)C2=NC3=C(N2)C=C(C=C3)OC&#39;</span>  <span class="co"># omeprazole</span></a>
<a class="sourceLine" id="cb1341-41" title="41">m <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb1341-42" title="42">hbd <span class="op">=</span> Chem.rdMolDescriptors.CalcNumHBD(m)</a>
<a class="sourceLine" id="cb1341-43" title="43">hba <span class="op">=</span> Chem.rdMolDescriptors.CalcNumHBA(m)</a>
<a class="sourceLine" id="cb1341-44" title="44">wt <span class="op">=</span> Chem.rdMolDescriptors.CalcExactMolWt(m)</a>
<a class="sourceLine" id="cb1341-45" title="45">logp <span class="op">=</span> Chem.Crippen.MolLogP(m)</a>
<a class="sourceLine" id="cb1341-46" title="46"></a>
<a class="sourceLine" id="cb1341-47" title="47"><span class="cf">if</span> hbd <span class="op">&lt;</span> <span class="dv">5</span> <span class="kw">and</span> hba <span class="op">&lt;</span> <span class="dv">10</span> <span class="kw">and</span> wt <span class="op">&lt;</span> <span class="dv">500</span> <span class="kw">and</span> logp <span class="op">&lt;</span> <span class="dv">5</span>:</a>
<a class="sourceLine" id="cb1341-48" title="48">    passed <span class="op">=</span> <span class="va">True</span></a>
<a class="sourceLine" id="cb1341-49" title="49"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb1341-50" title="50">    passed <span class="op">=</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb1341-51" title="51"></a>
<a class="sourceLine" id="cb1341-52" title="52">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> lipinski_rule_of_five(smiles) <span class="op">==</span> passed <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>mape</summary></p>
<h4 id="query-122">Query</h4>
<div class="sourceCode" id="cb1343"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1343-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb1343-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb1343-3" title="3"></a>
<a class="sourceLine" id="cb1343-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1343-5" title="5"><span class="co">compute sin(pi/2)</span></a>
<a class="sourceLine" id="cb1343-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1343-7" title="7">x <span class="op">=</span> math.sin(math.pi <span class="op">/</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1343-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1343-9" title="9"></a>
<a class="sourceLine" id="cb1343-10" title="10"><span class="kw">def</span> mape(y_hat,y):</a>
<a class="sourceLine" id="cb1343-11" title="11">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1343-12" title="12"><span class="co">  This function computes the mean absolute percentage error (mape) between y_hat and y.</span></a>
<a class="sourceLine" id="cb1343-13" title="13"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1343-14" title="14">  </a></code></pre></div>
<h4 id="run-0-122">Run 0</h4>
<div class="sourceCode" id="cb1344"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1344-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb1344-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb1344-3" title="3"></a>
<a class="sourceLine" id="cb1344-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1344-5" title="5"><span class="co">compute sin(pi/2)</span></a>
<a class="sourceLine" id="cb1344-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1344-7" title="7">x <span class="op">=</span> math.sin(math.pi <span class="op">/</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1344-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1344-9" title="9"></a>
<a class="sourceLine" id="cb1344-10" title="10"><span class="kw">def</span> mape(y_hat,y):</a>
<a class="sourceLine" id="cb1344-11" title="11">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1344-12" title="12"><span class="co">  This function computes the mean absolute percentage error (mape) between y_hat and y.</span></a>
<a class="sourceLine" id="cb1344-13" title="13"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1344-14" title="14">  <span class="co"># start</span></a>
<a class="sourceLine" id="cb1344-15" title="15">  mape <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb1344-16" title="16">  <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(y)):</a>
<a class="sourceLine" id="cb1344-17" title="17">    mape <span class="op">+=</span> <span class="bu">abs</span>(y_hat[i] <span class="op">-</span> y[i]) <span class="op">/</span> y[i]</a>
<a class="sourceLine" id="cb1344-18" title="18">  mape <span class="op">=</span> mape <span class="op">/</span> <span class="bu">len</span>(y)</a>
<a class="sourceLine" id="cb1344-19" title="19">  </a>
<a class="sourceLine" id="cb1344-20" title="20"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1344-21" title="21"></a>
<a class="sourceLine" id="cb1344-22" title="22">np.random.seed(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb1344-23" title="23">M<span class="op">=</span><span class="dv">100</span></a>
<a class="sourceLine" id="cb1344-24" title="24">y_hat <span class="op">=</span> np.random.normal(loc<span class="op">=</span><span class="dv">10</span>,scale<span class="op">=</span><span class="dv">3</span>,size<span class="op">=</span>(M,))</a>
<a class="sourceLine" id="cb1344-25" title="25">y <span class="op">=</span> np.random.normal(loc<span class="op">=</span><span class="dv">9</span>, scale<span class="op">=</span><span class="dv">2</span>, size<span class="op">=</span>(M,))</a>
<a class="sourceLine" id="cb1344-26" title="26"></a>
<a class="sourceLine" id="cb1344-27" title="27">test_mape <span class="op">=</span> <span class="bu">abs</span>((y <span class="op">-</span> y_hat)<span class="op">*</span><span class="dv">100</span><span class="op">/</span> y).mean()</a>
<a class="sourceLine" id="cb1344-28" title="28">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(mape(y_hat,y),test_mape) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>ufunc &#39;isfinite&#39; not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule &#39;&#39;safe&#39;&#39;</code></pre>
<h4 id="run-1-122">Run 1</h4>
<div class="sourceCode" id="cb1346"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1346-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb1346-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb1346-3" title="3"></a>
<a class="sourceLine" id="cb1346-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1346-5" title="5"><span class="co">compute sin(pi/2)</span></a>
<a class="sourceLine" id="cb1346-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1346-7" title="7">x <span class="op">=</span> math.sin(math.pi <span class="op">/</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1346-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1346-9" title="9"></a>
<a class="sourceLine" id="cb1346-10" title="10"><span class="kw">def</span> mape(y_hat,y):</a>
<a class="sourceLine" id="cb1346-11" title="11">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1346-12" title="12"><span class="co">  This function computes the mean absolute percentage error (mape) between y_hat and y.</span></a>
<a class="sourceLine" id="cb1346-13" title="13"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1346-14" title="14">  <span class="cf">return</span> np.mean(np.<span class="bu">abs</span>((y<span class="op">-</span>y_hat)<span class="op">/</span>y))</a>
<a class="sourceLine" id="cb1346-15" title="15"></a>
<a class="sourceLine" id="cb1346-16" title="16"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1346-17" title="17"></a>
<a class="sourceLine" id="cb1346-18" title="18">np.random.seed(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb1346-19" title="19">M<span class="op">=</span><span class="dv">100</span></a>
<a class="sourceLine" id="cb1346-20" title="20">y_hat <span class="op">=</span> np.random.normal(loc<span class="op">=</span><span class="dv">10</span>,scale<span class="op">=</span><span class="dv">3</span>,size<span class="op">=</span>(M,))</a>
<a class="sourceLine" id="cb1346-21" title="21">y <span class="op">=</span> np.random.normal(loc<span class="op">=</span><span class="dv">9</span>, scale<span class="op">=</span><span class="dv">2</span>, size<span class="op">=</span>(M,))</a>
<a class="sourceLine" id="cb1346-22" title="22"></a>
<a class="sourceLine" id="cb1346-23" title="23">test_mape <span class="op">=</span> <span class="bu">abs</span>((y <span class="op">-</span> y_hat)<span class="op">*</span><span class="dv">100</span><span class="op">/</span> y).mean()</a>
<a class="sourceLine" id="cb1346-24" title="24">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(mape(y_hat,y),test_mape) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-122">Run 2</h4>
<div class="sourceCode" id="cb1348"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1348-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb1348-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb1348-3" title="3"></a>
<a class="sourceLine" id="cb1348-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1348-5" title="5"><span class="co">compute sin(pi/2)</span></a>
<a class="sourceLine" id="cb1348-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1348-7" title="7">x <span class="op">=</span> math.sin(math.pi <span class="op">/</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1348-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1348-9" title="9"></a>
<a class="sourceLine" id="cb1348-10" title="10"><span class="kw">def</span> mape(y_hat,y):</a>
<a class="sourceLine" id="cb1348-11" title="11">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1348-12" title="12"><span class="co">  This function computes the mean absolute percentage error (mape) between y_hat and y.</span></a>
<a class="sourceLine" id="cb1348-13" title="13"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1348-14" title="14">  <span class="co"># start</span></a>
<a class="sourceLine" id="cb1348-15" title="15">  mape <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb1348-16" title="16">  <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(y)):</a>
<a class="sourceLine" id="cb1348-17" title="17">    mape <span class="op">+=</span> <span class="bu">abs</span>(y_hat[i] <span class="op">-</span> y[i]) <span class="op">/</span> y[i]</a>
<a class="sourceLine" id="cb1348-18" title="18">  mape <span class="op">/=</span> <span class="bu">len</span>(y)</a>
<a class="sourceLine" id="cb1348-19" title="19">  <span class="cf">return</span> mape</a>
<a class="sourceLine" id="cb1348-20" title="20">  </a>
<a class="sourceLine" id="cb1348-21" title="21"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1348-22" title="22"></a>
<a class="sourceLine" id="cb1348-23" title="23">np.random.seed(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb1348-24" title="24">M<span class="op">=</span><span class="dv">100</span></a>
<a class="sourceLine" id="cb1348-25" title="25">y_hat <span class="op">=</span> np.random.normal(loc<span class="op">=</span><span class="dv">10</span>,scale<span class="op">=</span><span class="dv">3</span>,size<span class="op">=</span>(M,))</a>
<a class="sourceLine" id="cb1348-26" title="26">y <span class="op">=</span> np.random.normal(loc<span class="op">=</span><span class="dv">9</span>, scale<span class="op">=</span><span class="dv">2</span>, size<span class="op">=</span>(M,))</a>
<a class="sourceLine" id="cb1348-27" title="27"></a>
<a class="sourceLine" id="cb1348-28" title="28">test_mape <span class="op">=</span> <span class="bu">abs</span>((y <span class="op">-</span> y_hat)<span class="op">*</span><span class="dv">100</span><span class="op">/</span> y).mean()</a>
<a class="sourceLine" id="cb1348-29" title="29">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(mape(y_hat,y),test_mape) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-122">Run 3</h4>
<div class="sourceCode" id="cb1350"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1350-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb1350-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb1350-3" title="3"></a>
<a class="sourceLine" id="cb1350-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1350-5" title="5"><span class="co">compute sin(pi/2)</span></a>
<a class="sourceLine" id="cb1350-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1350-7" title="7">x <span class="op">=</span> math.sin(math.pi <span class="op">/</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1350-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1350-9" title="9"></a>
<a class="sourceLine" id="cb1350-10" title="10"><span class="kw">def</span> mape(y_hat,y):</a>
<a class="sourceLine" id="cb1350-11" title="11">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1350-12" title="12"><span class="co">  This function computes the mean absolute percentage error (mape) between y_hat and y.</span></a>
<a class="sourceLine" id="cb1350-13" title="13"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1350-14" title="14">  <span class="cf">return</span> np.mean(np.<span class="bu">abs</span>((y <span class="op">-</span> y_hat) <span class="op">/</span> y)) <span class="op">*</span> <span class="dv">100</span></a>
<a class="sourceLine" id="cb1350-15" title="15"></a>
<a class="sourceLine" id="cb1350-16" title="16"></a>
<a class="sourceLine" id="cb1350-17" title="17"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1350-18" title="18"></a>
<a class="sourceLine" id="cb1350-19" title="19">np.random.seed(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb1350-20" title="20">M<span class="op">=</span><span class="dv">100</span></a>
<a class="sourceLine" id="cb1350-21" title="21">y_hat <span class="op">=</span> np.random.normal(loc<span class="op">=</span><span class="dv">10</span>,scale<span class="op">=</span><span class="dv">3</span>,size<span class="op">=</span>(M,))</a>
<a class="sourceLine" id="cb1350-22" title="22">y <span class="op">=</span> np.random.normal(loc<span class="op">=</span><span class="dv">9</span>, scale<span class="op">=</span><span class="dv">2</span>, size<span class="op">=</span>(M,))</a>
<a class="sourceLine" id="cb1350-23" title="23"></a>
<a class="sourceLine" id="cb1350-24" title="24">test_mape <span class="op">=</span> <span class="bu">abs</span>((y <span class="op">-</span> y_hat)<span class="op">*</span><span class="dv">100</span><span class="op">/</span> y).mean()</a>
<a class="sourceLine" id="cb1350-25" title="25">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(mape(y_hat,y),test_mape) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-122">Run 4</h4>
<div class="sourceCode" id="cb1352"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1352-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb1352-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb1352-3" title="3"></a>
<a class="sourceLine" id="cb1352-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1352-5" title="5"><span class="co">compute sin(pi/2)</span></a>
<a class="sourceLine" id="cb1352-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1352-7" title="7">x <span class="op">=</span> math.sin(math.pi <span class="op">/</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1352-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1352-9" title="9"></a>
<a class="sourceLine" id="cb1352-10" title="10"><span class="kw">def</span> mape(y_hat,y):</a>
<a class="sourceLine" id="cb1352-11" title="11">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1352-12" title="12"><span class="co">  This function computes the mean absolute percentage error (mape) between y_hat and y.</span></a>
<a class="sourceLine" id="cb1352-13" title="13"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1352-14" title="14">  <span class="co"># start</span></a>
<a class="sourceLine" id="cb1352-15" title="15">  mape <span class="op">=</span> np.mean(np.<span class="bu">abs</span>((y <span class="op">-</span> y_hat) <span class="op">/</span> y)) <span class="op">*</span> <span class="dv">100</span></a>
<a class="sourceLine" id="cb1352-16" title="16">  </a>
<a class="sourceLine" id="cb1352-17" title="17"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1352-18" title="18"></a>
<a class="sourceLine" id="cb1352-19" title="19">np.random.seed(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb1352-20" title="20">M<span class="op">=</span><span class="dv">100</span></a>
<a class="sourceLine" id="cb1352-21" title="21">y_hat <span class="op">=</span> np.random.normal(loc<span class="op">=</span><span class="dv">10</span>,scale<span class="op">=</span><span class="dv">3</span>,size<span class="op">=</span>(M,))</a>
<a class="sourceLine" id="cb1352-22" title="22">y <span class="op">=</span> np.random.normal(loc<span class="op">=</span><span class="dv">9</span>, scale<span class="op">=</span><span class="dv">2</span>, size<span class="op">=</span>(M,))</a>
<a class="sourceLine" id="cb1352-23" title="23"></a>
<a class="sourceLine" id="cb1352-24" title="24">test_mape <span class="op">=</span> <span class="bu">abs</span>((y <span class="op">-</span> y_hat)<span class="op">*</span><span class="dv">100</span><span class="op">/</span> y).mean()</a>
<a class="sourceLine" id="cb1352-25" title="25">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(mape(y_hat,y),test_mape) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>ufunc &#39;isfinite&#39; not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule &#39;&#39;safe&#39;&#39;</code></pre>
</details>
<details>
<p><summary>mapping_operator</summary></p>
<h4 id="query-123">Query</h4>
<div class="sourceCode" id="cb1354"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1354-1" title="1"><span class="im">import</span> MDAnalysis</a>
<a class="sourceLine" id="cb1354-2" title="2"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1354-3" title="3"></a>
<a class="sourceLine" id="cb1354-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1354-5" title="5"><span class="co">Print version string</span></a>
<a class="sourceLine" id="cb1354-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1354-7" title="7"><span class="bu">print</span>(MDAnalysis.__version__)</a>
<a class="sourceLine" id="cb1354-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1354-9" title="9"></a>
<a class="sourceLine" id="cb1354-10" title="10"><span class="kw">def</span> mapping_operator(molecule, beads_mappings):</a>
<a class="sourceLine" id="cb1354-11" title="11">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1354-12" title="12"><span class="co">  This function generates a mass-mass weighted mapping matrix given an MD analysis molecule</span></a>
<a class="sourceLine" id="cb1354-13" title="13"><span class="co">  and atom selections for the beads.</span></a>
<a class="sourceLine" id="cb1354-14" title="14"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1354-15" title="15">  </a></code></pre></div>
<h4 id="run-0-123">Run 0</h4>
<div class="sourceCode" id="cb1355"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1355-1" title="1"><span class="im">import</span> MDAnalysis</a>
<a class="sourceLine" id="cb1355-2" title="2"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1355-3" title="3"></a>
<a class="sourceLine" id="cb1355-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1355-5" title="5"><span class="co">Print version string</span></a>
<a class="sourceLine" id="cb1355-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1355-7" title="7"><span class="bu">print</span>(MDAnalysis.__version__)</a>
<a class="sourceLine" id="cb1355-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1355-9" title="9"></a>
<a class="sourceLine" id="cb1355-10" title="10"><span class="kw">def</span> mapping_operator(molecule, beads_mappings):</a>
<a class="sourceLine" id="cb1355-11" title="11">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1355-12" title="12"><span class="co">  This function generates a mass-mass weighted mapping matrix given an MD analysis molecule</span></a>
<a class="sourceLine" id="cb1355-13" title="13"><span class="co">  and atom selections for the beads.</span></a>
<a class="sourceLine" id="cb1355-14" title="14"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1355-15" title="15">  <span class="co"># Get the number of beads</span></a>
<a class="sourceLine" id="cb1355-16" title="16">  nbeads <span class="op">=</span> <span class="bu">len</span>(beads_mappings)</a>
<a class="sourceLine" id="cb1355-17" title="17">  <span class="co"># Get the number of atoms</span></a>
<a class="sourceLine" id="cb1355-18" title="18">  natoms <span class="op">=</span> molecule.atoms.n_atoms</a>
<a class="sourceLine" id="cb1355-19" title="19">  <span class="co"># Create the mapping matrix</span></a>
<a class="sourceLine" id="cb1355-20" title="20">  mapping <span class="op">=</span> np.zeros((nbeads, natoms))</a>
<a class="sourceLine" id="cb1355-21" title="21">  <span class="co"># Loop over the beads</span></a>
<a class="sourceLine" id="cb1355-22" title="22">  <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(nbeads):</a>
<a class="sourceLine" id="cb1355-23" title="23">    <span class="co"># Get the atoms in the bead</span></a>
<a class="sourceLine" id="cb1355-24" title="24">    atoms <span class="op">=</span> beads_mappings[i].atoms</a>
<a class="sourceLine" id="cb1355-25" title="25">    <span class="co"># Get the indices of the atoms</span></a>
<a class="sourceLine" id="cb1355-26" title="26">    indices <span class="op">=</span> atoms.indices</a>
<a class="sourceLine" id="cb1355-27" title="27">    <span class="co"># Set the mapping</span></a>
<a class="sourceLine" id="cb1355-28" title="28">    mapping[i, indices] <span class="op">=</span> <span class="fl">1.0</span></a>
<a class="sourceLine" id="cb1355-29" title="29">  <span class="co"># Return the mapping</span></a>
<a class="sourceLine" id="cb1355-30" title="30">  <span class="cf">return</span> mapping</a>
<a class="sourceLine" id="cb1355-31" title="31"></a>
<a class="sourceLine" id="cb1355-32" title="32"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1355-33" title="33"><span class="im">import</span> MDAnalysis <span class="im">as</span> mda</a>
<a class="sourceLine" id="cb1355-34" title="34"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb1355-35" title="35"></a>
<a class="sourceLine" id="cb1355-36" title="36"><span class="co"># read molecule</span></a>
<a class="sourceLine" id="cb1355-37" title="37">u <span class="op">=</span> mda.Universe(os.path.join(_FILE_DIR_, <span class="st">&#39;water.gro&#39;</span>))</a>
<a class="sourceLine" id="cb1355-38" title="38">molecule <span class="op">=</span> u.atoms</a>
<a class="sourceLine" id="cb1355-39" title="39"><span class="co"># define atoms that belong to the a single bead</span></a>
<a class="sourceLine" id="cb1355-40" title="40">beads_mappings <span class="op">=</span> [[<span class="st">&#39;OW&#39;</span>, <span class="st">&#39;HW1&#39;</span>, <span class="st">&#39;HW2&#39;</span>]]</a>
<a class="sourceLine" id="cb1355-41" title="41">Mws_dict <span class="op">=</span> <span class="bu">dict</span>(<span class="bu">zip</span>(molecule.names, molecule.masses))</a>
<a class="sourceLine" id="cb1355-42" title="42">M, N <span class="op">=</span> <span class="bu">len</span>(beads_mappings), <span class="bu">len</span>(molecule)</a>
<a class="sourceLine" id="cb1355-43" title="43">CG_matrix <span class="op">=</span> np.zeros((M, N))</a>
<a class="sourceLine" id="cb1355-44" title="44">index <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb1355-45" title="45"><span class="cf">for</span> s <span class="kw">in</span> <span class="bu">range</span>(M):</a>
<a class="sourceLine" id="cb1355-46" title="46">    <span class="cf">for</span> i, atom <span class="kw">in</span> <span class="bu">enumerate</span>(beads_mappings[s]):</a>
<a class="sourceLine" id="cb1355-47" title="47">        CG_matrix[s, i <span class="op">+</span> index] <span class="op">=</span> [v <span class="cf">for</span> k,</a>
<a class="sourceLine" id="cb1355-48" title="48">                                   v <span class="kw">in</span> Mws_dict.items() <span class="cf">if</span> atom <span class="kw">in</span> k][<span class="dv">0</span>]</a>
<a class="sourceLine" id="cb1355-49" title="49">    index <span class="op">+=</span> np.count_nonzero(CG_matrix[s])</a>
<a class="sourceLine" id="cb1355-50" title="50">    CG_matrix[s] <span class="op">=</span> CG_matrix[s] <span class="op">/</span> np.<span class="bu">sum</span>(CG_matrix[s])</a>
<a class="sourceLine" id="cb1355-51" title="51"></a>
<a class="sourceLine" id="cb1355-52" title="52">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(</a>
<a class="sourceLine" id="cb1355-53" title="53">    CG_matrix, mapping_operator(molecule, beads_mappings)).<span class="bu">all</span>() <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>&#39;list&#39; object has no attribute &#39;atoms&#39;</code></pre>
<h4 id="run-1-123">Run 1</h4>
<div class="sourceCode" id="cb1357"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1357-1" title="1"><span class="im">import</span> MDAnalysis</a>
<a class="sourceLine" id="cb1357-2" title="2"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1357-3" title="3"></a>
<a class="sourceLine" id="cb1357-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1357-5" title="5"><span class="co">Print version string</span></a>
<a class="sourceLine" id="cb1357-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1357-7" title="7"><span class="bu">print</span>(MDAnalysis.__version__)</a>
<a class="sourceLine" id="cb1357-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1357-9" title="9"></a>
<a class="sourceLine" id="cb1357-10" title="10"><span class="kw">def</span> mapping_operator(molecule, beads_mappings):</a>
<a class="sourceLine" id="cb1357-11" title="11">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1357-12" title="12"><span class="co">  This function generates a mass-mass weighted mapping matrix given an MD analysis molecule</span></a>
<a class="sourceLine" id="cb1357-13" title="13"><span class="co">  and atom selections for the beads.</span></a>
<a class="sourceLine" id="cb1357-14" title="14"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1357-15" title="15">  <span class="co"># get the masses of the atoms</span></a>
<a class="sourceLine" id="cb1357-16" title="16">  masses <span class="op">=</span> molecule.masses</a>
<a class="sourceLine" id="cb1357-17" title="17">  <span class="co"># get the number of atoms</span></a>
<a class="sourceLine" id="cb1357-18" title="18">  num_atoms <span class="op">=</span> <span class="bu">len</span>(masses)</a>
<a class="sourceLine" id="cb1357-19" title="19">  <span class="co"># get the number of beads</span></a>
<a class="sourceLine" id="cb1357-20" title="20">  num_beads <span class="op">=</span> <span class="bu">len</span>(beads_mappings)</a>
<a class="sourceLine" id="cb1357-21" title="21">  <span class="co"># create the mapping matrix</span></a>
<a class="sourceLine" id="cb1357-22" title="22">  mapping_matrix <span class="op">=</span> np.zeros((num_beads, num_atoms))</a>
<a class="sourceLine" id="cb1357-23" title="23">  <span class="co"># loop over the beads</span></a>
<a class="sourceLine" id="cb1357-24" title="24">  <span class="cf">for</span> bead_index <span class="kw">in</span> <span class="bu">range</span>(num_beads):</a>
<a class="sourceLine" id="cb1357-25" title="25">    <span class="co"># get the atoms for this bead</span></a>
<a class="sourceLine" id="cb1357-26" title="26">    bead_atoms <span class="op">=</span> beads_mappings[bead_index]</a>
<a class="sourceLine" id="cb1357-27" title="27">    <span class="co"># loop over the atoms</span></a>
<a class="sourceLine" id="cb1357-28" title="28">    <span class="cf">for</span> atom_index <span class="kw">in</span> bead_atoms:</a>
<a class="sourceLine" id="cb1357-29" title="29">      <span class="co"># set the mapping matrix</span></a>
<a class="sourceLine" id="cb1357-30" title="30">      mapping_matrix[bead_index, atom_index] <span class="op">=</span> masses[atom_index]</a>
<a class="sourceLine" id="cb1357-31" title="31">  <span class="co"># return the mapping matrix</span></a>
<a class="sourceLine" id="cb1357-32" title="32">  <span class="cf">return</span> mapping_matrix</a>
<a class="sourceLine" id="cb1357-33" title="33"></a>
<a class="sourceLine" id="cb1357-34" title="34"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1357-35" title="35"><span class="im">import</span> MDAnalysis <span class="im">as</span> mda</a>
<a class="sourceLine" id="cb1357-36" title="36"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb1357-37" title="37"></a>
<a class="sourceLine" id="cb1357-38" title="38"><span class="co"># read molecule</span></a>
<a class="sourceLine" id="cb1357-39" title="39">u <span class="op">=</span> mda.Universe(os.path.join(_FILE_DIR_, <span class="st">&#39;water.gro&#39;</span>))</a>
<a class="sourceLine" id="cb1357-40" title="40">molecule <span class="op">=</span> u.atoms</a>
<a class="sourceLine" id="cb1357-41" title="41"><span class="co"># define atoms that belong to the a single bead</span></a>
<a class="sourceLine" id="cb1357-42" title="42">beads_mappings <span class="op">=</span> [[<span class="st">&#39;OW&#39;</span>, <span class="st">&#39;HW1&#39;</span>, <span class="st">&#39;HW2&#39;</span>]]</a>
<a class="sourceLine" id="cb1357-43" title="43">Mws_dict <span class="op">=</span> <span class="bu">dict</span>(<span class="bu">zip</span>(molecule.names, molecule.masses))</a>
<a class="sourceLine" id="cb1357-44" title="44">M, N <span class="op">=</span> <span class="bu">len</span>(beads_mappings), <span class="bu">len</span>(molecule)</a>
<a class="sourceLine" id="cb1357-45" title="45">CG_matrix <span class="op">=</span> np.zeros((M, N))</a>
<a class="sourceLine" id="cb1357-46" title="46">index <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb1357-47" title="47"><span class="cf">for</span> s <span class="kw">in</span> <span class="bu">range</span>(M):</a>
<a class="sourceLine" id="cb1357-48" title="48">    <span class="cf">for</span> i, atom <span class="kw">in</span> <span class="bu">enumerate</span>(beads_mappings[s]):</a>
<a class="sourceLine" id="cb1357-49" title="49">        CG_matrix[s, i <span class="op">+</span> index] <span class="op">=</span> [v <span class="cf">for</span> k,</a>
<a class="sourceLine" id="cb1357-50" title="50">                                   v <span class="kw">in</span> Mws_dict.items() <span class="cf">if</span> atom <span class="kw">in</span> k][<span class="dv">0</span>]</a>
<a class="sourceLine" id="cb1357-51" title="51">    index <span class="op">+=</span> np.count_nonzero(CG_matrix[s])</a>
<a class="sourceLine" id="cb1357-52" title="52">    CG_matrix[s] <span class="op">=</span> CG_matrix[s] <span class="op">/</span> np.<span class="bu">sum</span>(CG_matrix[s])</a>
<a class="sourceLine" id="cb1357-53" title="53"></a>
<a class="sourceLine" id="cb1357-54" title="54">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(</a>
<a class="sourceLine" id="cb1357-55" title="55">    CG_matrix, mapping_operator(molecule, beads_mappings)).<span class="bu">all</span>() <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>only integers, slices (`:`), ellipsis (`...`), numpy.newaxis (`None`) and integer or boolean arrays are valid indices</code></pre>
<h4 id="run-2-123">Run 2</h4>
<div class="sourceCode" id="cb1359"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1359-1" title="1"><span class="im">import</span> MDAnalysis</a>
<a class="sourceLine" id="cb1359-2" title="2"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1359-3" title="3"></a>
<a class="sourceLine" id="cb1359-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1359-5" title="5"><span class="co">Print version string</span></a>
<a class="sourceLine" id="cb1359-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1359-7" title="7"><span class="bu">print</span>(MDAnalysis.__version__)</a>
<a class="sourceLine" id="cb1359-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1359-9" title="9"></a>
<a class="sourceLine" id="cb1359-10" title="10"><span class="kw">def</span> mapping_operator(molecule, beads_mappings):</a>
<a class="sourceLine" id="cb1359-11" title="11">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1359-12" title="12"><span class="co">  This function generates a mass-mass weighted mapping matrix given an MD analysis molecule</span></a>
<a class="sourceLine" id="cb1359-13" title="13"><span class="co">  and atom selections for the beads.</span></a>
<a class="sourceLine" id="cb1359-14" title="14"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1359-15" title="15">  <span class="co"># Get the number of beads</span></a>
<a class="sourceLine" id="cb1359-16" title="16">  n_beads <span class="op">=</span> <span class="bu">len</span>(beads_mappings)</a>
<a class="sourceLine" id="cb1359-17" title="17">  <span class="co"># Get the number of atoms</span></a>
<a class="sourceLine" id="cb1359-18" title="18">  n_atoms <span class="op">=</span> molecule.n_atoms</a>
<a class="sourceLine" id="cb1359-19" title="19">  <span class="co"># Initialize the mapping matrix</span></a>
<a class="sourceLine" id="cb1359-20" title="20">  mapping_matrix <span class="op">=</span> np.zeros((n_beads, n_atoms))</a>
<a class="sourceLine" id="cb1359-21" title="21">  <span class="co"># Loop over the beads</span></a>
<a class="sourceLine" id="cb1359-22" title="22">  <span class="cf">for</span> bead_index, bead_mapping <span class="kw">in</span> <span class="bu">enumerate</span>(beads_mappings):</a>
<a class="sourceLine" id="cb1359-23" title="23">    <span class="co"># Get the mass of the bead</span></a>
<a class="sourceLine" id="cb1359-24" title="24">    bead_mass <span class="op">=</span> bead_mapping.masses.<span class="bu">sum</span>()</a>
<a class="sourceLine" id="cb1359-25" title="25">    <span class="co"># Get the atoms in the bead</span></a>
<a class="sourceLine" id="cb1359-26" title="26">    bead_atoms <span class="op">=</span> bead_mapping.atoms</a>
<a class="sourceLine" id="cb1359-27" title="27">    <span class="co"># Get the masses of the atoms in the bead</span></a>
<a class="sourceLine" id="cb1359-28" title="28">    bead_atom_masses <span class="op">=</span> bead_atoms.masses</a>
<a class="sourceLine" id="cb1359-29" title="29">    <span class="co"># Get the indices of the atoms in the bead</span></a>
<a class="sourceLine" id="cb1359-30" title="30">    bead_atom_indices <span class="op">=</span> bead_atoms.indices</a>
<a class="sourceLine" id="cb1359-31" title="31">    <span class="co"># Get the number of atoms in the bead</span></a>
<a class="sourceLine" id="cb1359-32" title="32">    n_bead_atoms <span class="op">=</span> <span class="bu">len</span>(bead_atom_indices)</a>
<a class="sourceLine" id="cb1359-33" title="33">    <span class="co"># Loop over the atoms in the bead</span></a>
<a class="sourceLine" id="cb1359-34" title="34">    <span class="cf">for</span> bead_atom_index <span class="kw">in</span> <span class="bu">range</span>(n_bead_atoms):</a>
<a class="sourceLine" id="cb1359-35" title="35">      <span class="co"># Get the index of the atom</span></a>
<a class="sourceLine" id="cb1359-36" title="36">      atom_index <span class="op">=</span> bead_atom_indices[bead_atom_index]</a>
<a class="sourceLine" id="cb1359-37" title="37">      <span class="co"># Get the mass of the atom</span></a>
<a class="sourceLine" id="cb1359-38" title="38">      atom_mass <span class="op">=</span> bead_atom_masses[bead_atom_index]</a>
<a class="sourceLine" id="cb1359-39" title="39">      <span class="co"># Compute the mass-mass weighted mapping</span></a>
<a class="sourceLine" id="cb1359-40" title="40">      mapping_matrix[bead_index, atom_index] <span class="op">=</span> atom_mass <span class="op">/</span> bead_mass</a>
<a class="sourceLine" id="cb1359-41" title="41">  <span class="co"># Return the mapping matrix</span></a>
<a class="sourceLine" id="cb1359-42" title="42">  <span class="cf">return</span> mapping_matrix</a>
<a class="sourceLine" id="cb1359-43" title="43"></a>
<a class="sourceLine" id="cb1359-44" title="44"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1359-45" title="45"><span class="im">import</span> MDAnalysis <span class="im">as</span> mda</a>
<a class="sourceLine" id="cb1359-46" title="46"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb1359-47" title="47"></a>
<a class="sourceLine" id="cb1359-48" title="48"><span class="co"># read molecule</span></a>
<a class="sourceLine" id="cb1359-49" title="49">u <span class="op">=</span> mda.Universe(os.path.join(_FILE_DIR_, <span class="st">&#39;water.gro&#39;</span>))</a>
<a class="sourceLine" id="cb1359-50" title="50">molecule <span class="op">=</span> u.atoms</a>
<a class="sourceLine" id="cb1359-51" title="51"><span class="co"># define atoms that belong to the a single bead</span></a>
<a class="sourceLine" id="cb1359-52" title="52">beads_mappings <span class="op">=</span> [[<span class="st">&#39;OW&#39;</span>, <span class="st">&#39;HW1&#39;</span>, <span class="st">&#39;HW2&#39;</span>]]</a>
<a class="sourceLine" id="cb1359-53" title="53">Mws_dict <span class="op">=</span> <span class="bu">dict</span>(<span class="bu">zip</span>(molecule.names, molecule.masses))</a>
<a class="sourceLine" id="cb1359-54" title="54">M, N <span class="op">=</span> <span class="bu">len</span>(beads_mappings), <span class="bu">len</span>(molecule)</a>
<a class="sourceLine" id="cb1359-55" title="55">CG_matrix <span class="op">=</span> np.zeros((M, N))</a>
<a class="sourceLine" id="cb1359-56" title="56">index <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb1359-57" title="57"><span class="cf">for</span> s <span class="kw">in</span> <span class="bu">range</span>(M):</a>
<a class="sourceLine" id="cb1359-58" title="58">    <span class="cf">for</span> i, atom <span class="kw">in</span> <span class="bu">enumerate</span>(beads_mappings[s]):</a>
<a class="sourceLine" id="cb1359-59" title="59">        CG_matrix[s, i <span class="op">+</span> index] <span class="op">=</span> [v <span class="cf">for</span> k,</a>
<a class="sourceLine" id="cb1359-60" title="60">                                   v <span class="kw">in</span> Mws_dict.items() <span class="cf">if</span> atom <span class="kw">in</span> k][<span class="dv">0</span>]</a>
<a class="sourceLine" id="cb1359-61" title="61">    index <span class="op">+=</span> np.count_nonzero(CG_matrix[s])</a>
<a class="sourceLine" id="cb1359-62" title="62">    CG_matrix[s] <span class="op">=</span> CG_matrix[s] <span class="op">/</span> np.<span class="bu">sum</span>(CG_matrix[s])</a>
<a class="sourceLine" id="cb1359-63" title="63"></a>
<a class="sourceLine" id="cb1359-64" title="64">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(</a>
<a class="sourceLine" id="cb1359-65" title="65">    CG_matrix, mapping_operator(molecule, beads_mappings)).<span class="bu">all</span>() <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>&#39;list&#39; object has no attribute &#39;masses&#39;</code></pre>
<h4 id="run-3-123">Run 3</h4>
<div class="sourceCode" id="cb1361"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1361-1" title="1"><span class="im">import</span> MDAnalysis</a>
<a class="sourceLine" id="cb1361-2" title="2"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1361-3" title="3"></a>
<a class="sourceLine" id="cb1361-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1361-5" title="5"><span class="co">Print version string</span></a>
<a class="sourceLine" id="cb1361-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1361-7" title="7"><span class="bu">print</span>(MDAnalysis.__version__)</a>
<a class="sourceLine" id="cb1361-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1361-9" title="9"></a>
<a class="sourceLine" id="cb1361-10" title="10"><span class="kw">def</span> mapping_operator(molecule, beads_mappings):</a>
<a class="sourceLine" id="cb1361-11" title="11">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1361-12" title="12"><span class="co">  This function generates a mass-mass weighted mapping matrix given an MD analysis molecule</span></a>
<a class="sourceLine" id="cb1361-13" title="13"><span class="co">  and atom selections for the beads.</span></a>
<a class="sourceLine" id="cb1361-14" title="14"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1361-15" title="15">  <span class="co"># get the number of beads</span></a>
<a class="sourceLine" id="cb1361-16" title="16">  n_beads <span class="op">=</span> <span class="bu">len</span>(beads_mappings)</a>
<a class="sourceLine" id="cb1361-17" title="17">  <span class="co"># get the number of atoms</span></a>
<a class="sourceLine" id="cb1361-18" title="18">  n_atoms <span class="op">=</span> molecule.n_atoms</a>
<a class="sourceLine" id="cb1361-19" title="19">  <span class="co"># create the mapping matrix</span></a>
<a class="sourceLine" id="cb1361-20" title="20">  mapping_matrix <span class="op">=</span> np.zeros((n_beads, n_atoms))</a>
<a class="sourceLine" id="cb1361-21" title="21">  <span class="co"># loop over the beads</span></a>
<a class="sourceLine" id="cb1361-22" title="22">  <span class="cf">for</span> bead_index <span class="kw">in</span> <span class="bu">range</span>(n_beads):</a>
<a class="sourceLine" id="cb1361-23" title="23">    <span class="co"># get the bead selection</span></a>
<a class="sourceLine" id="cb1361-24" title="24">    bead_selection <span class="op">=</span> beads_mappings[bead_index]</a>
<a class="sourceLine" id="cb1361-25" title="25">    <span class="co"># get the bead mass</span></a>
<a class="sourceLine" id="cb1361-26" title="26">    bead_mass <span class="op">=</span> molecule.select_atoms(bead_selection).masses.<span class="bu">sum</span>()</a>
<a class="sourceLine" id="cb1361-27" title="27">    <span class="co"># get the atom selection</span></a>
<a class="sourceLine" id="cb1361-28" title="28">    atom_selection <span class="op">=</span> bead_selection <span class="op">+</span> <span class="st">&quot; and not type H&quot;</span></a>
<a class="sourceLine" id="cb1361-29" title="29">    <span class="co"># get the atom masses</span></a>
<a class="sourceLine" id="cb1361-30" title="30">    atom_masses <span class="op">=</span> molecule.select_atoms(atom_selection).masses</a>
<a class="sourceLine" id="cb1361-31" title="31">    <span class="co"># get the atom masses weighted by the bead mass</span></a>
<a class="sourceLine" id="cb1361-32" title="32">    atom_masses_weighted <span class="op">=</span> atom_masses <span class="op">/</span> bead_mass</a>
<a class="sourceLine" id="cb1361-33" title="33">    <span class="co"># get the atom indices</span></a>
<a class="sourceLine" id="cb1361-34" title="34">    atom_indices <span class="op">=</span> molecule.select_atoms(atom_selection).indices</a>
<a class="sourceLine" id="cb1361-35" title="35">    <span class="co"># set the mapping matrix</span></a>
<a class="sourceLine" id="cb1361-36" title="36">    mapping_matrix[bead_index, atom_indices] <span class="op">=</span> atom_masses_weighted</a>
<a class="sourceLine" id="cb1361-37" title="37">  <span class="co"># return the mapping matrix</span></a>
<a class="sourceLine" id="cb1361-38" title="38">  <span class="cf">return</span> mapping_matrix</a>
<a class="sourceLine" id="cb1361-39" title="39"></a>
<a class="sourceLine" id="cb1361-40" title="40"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1361-41" title="41"><span class="im">import</span> MDAnalysis <span class="im">as</span> mda</a>
<a class="sourceLine" id="cb1361-42" title="42"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb1361-43" title="43"></a>
<a class="sourceLine" id="cb1361-44" title="44"><span class="co"># read molecule</span></a>
<a class="sourceLine" id="cb1361-45" title="45">u <span class="op">=</span> mda.Universe(os.path.join(_FILE_DIR_, <span class="st">&#39;water.gro&#39;</span>))</a>
<a class="sourceLine" id="cb1361-46" title="46">molecule <span class="op">=</span> u.atoms</a>
<a class="sourceLine" id="cb1361-47" title="47"><span class="co"># define atoms that belong to the a single bead</span></a>
<a class="sourceLine" id="cb1361-48" title="48">beads_mappings <span class="op">=</span> [[<span class="st">&#39;OW&#39;</span>, <span class="st">&#39;HW1&#39;</span>, <span class="st">&#39;HW2&#39;</span>]]</a>
<a class="sourceLine" id="cb1361-49" title="49">Mws_dict <span class="op">=</span> <span class="bu">dict</span>(<span class="bu">zip</span>(molecule.names, molecule.masses))</a>
<a class="sourceLine" id="cb1361-50" title="50">M, N <span class="op">=</span> <span class="bu">len</span>(beads_mappings), <span class="bu">len</span>(molecule)</a>
<a class="sourceLine" id="cb1361-51" title="51">CG_matrix <span class="op">=</span> np.zeros((M, N))</a>
<a class="sourceLine" id="cb1361-52" title="52">index <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb1361-53" title="53"><span class="cf">for</span> s <span class="kw">in</span> <span class="bu">range</span>(M):</a>
<a class="sourceLine" id="cb1361-54" title="54">    <span class="cf">for</span> i, atom <span class="kw">in</span> <span class="bu">enumerate</span>(beads_mappings[s]):</a>
<a class="sourceLine" id="cb1361-55" title="55">        CG_matrix[s, i <span class="op">+</span> index] <span class="op">=</span> [v <span class="cf">for</span> k,</a>
<a class="sourceLine" id="cb1361-56" title="56">                                   v <span class="kw">in</span> Mws_dict.items() <span class="cf">if</span> atom <span class="kw">in</span> k][<span class="dv">0</span>]</a>
<a class="sourceLine" id="cb1361-57" title="57">    index <span class="op">+=</span> np.count_nonzero(CG_matrix[s])</a>
<a class="sourceLine" id="cb1361-58" title="58">    CG_matrix[s] <span class="op">=</span> CG_matrix[s] <span class="op">/</span> np.<span class="bu">sum</span>(CG_matrix[s])</a>
<a class="sourceLine" id="cb1361-59" title="59"></a>
<a class="sourceLine" id="cb1361-60" title="60">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(</a>
<a class="sourceLine" id="cb1361-61" title="61">    CG_matrix, mapping_operator(molecule, beads_mappings)).<span class="bu">all</span>() <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>&#39;list&#39; object has no attribute &#39;replace&#39;</code></pre>
<h4 id="run-4-123">Run 4</h4>
<div class="sourceCode" id="cb1363"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1363-1" title="1"><span class="im">import</span> MDAnalysis</a>
<a class="sourceLine" id="cb1363-2" title="2"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1363-3" title="3"></a>
<a class="sourceLine" id="cb1363-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1363-5" title="5"><span class="co">Print version string</span></a>
<a class="sourceLine" id="cb1363-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1363-7" title="7"><span class="bu">print</span>(MDAnalysis.__version__)</a>
<a class="sourceLine" id="cb1363-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1363-9" title="9"></a>
<a class="sourceLine" id="cb1363-10" title="10"><span class="kw">def</span> mapping_operator(molecule, beads_mappings):</a>
<a class="sourceLine" id="cb1363-11" title="11">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1363-12" title="12"><span class="co">  This function generates a mass-mass weighted mapping matrix given an MD analysis molecule</span></a>
<a class="sourceLine" id="cb1363-13" title="13"><span class="co">  and atom selections for the beads.</span></a>
<a class="sourceLine" id="cb1363-14" title="14"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1363-15" title="15">  <span class="co"># Get the number of beads</span></a>
<a class="sourceLine" id="cb1363-16" title="16">  n_beads <span class="op">=</span> <span class="bu">len</span>(beads_mappings)</a>
<a class="sourceLine" id="cb1363-17" title="17"></a>
<a class="sourceLine" id="cb1363-18" title="18">  <span class="co"># Get the number of atoms</span></a>
<a class="sourceLine" id="cb1363-19" title="19">  n_atoms <span class="op">=</span> molecule.n_atoms</a>
<a class="sourceLine" id="cb1363-20" title="20"></a>
<a class="sourceLine" id="cb1363-21" title="21">  <span class="co"># Create a mapping matrix</span></a>
<a class="sourceLine" id="cb1363-22" title="22">  mapping_matrix <span class="op">=</span> np.zeros((n_beads, n_atoms))</a>
<a class="sourceLine" id="cb1363-23" title="23"></a>
<a class="sourceLine" id="cb1363-24" title="24">  <span class="co"># Loop over beads</span></a>
<a class="sourceLine" id="cb1363-25" title="25">  <span class="cf">for</span> bead_index, bead_mapping <span class="kw">in</span> <span class="bu">enumerate</span>(beads_mappings):</a>
<a class="sourceLine" id="cb1363-26" title="26">    <span class="co"># Get the bead</span></a>
<a class="sourceLine" id="cb1363-27" title="27">    bead <span class="op">=</span> molecule.select_atoms(bead_mapping)</a>
<a class="sourceLine" id="cb1363-28" title="28"></a>
<a class="sourceLine" id="cb1363-29" title="29">    <span class="co"># Get the bead mass</span></a>
<a class="sourceLine" id="cb1363-30" title="30">    bead_mass <span class="op">=</span> bead.masses.<span class="bu">sum</span>()</a>
<a class="sourceLine" id="cb1363-31" title="31"></a>
<a class="sourceLine" id="cb1363-32" title="32">    <span class="co"># Get the bead atoms</span></a>
<a class="sourceLine" id="cb1363-33" title="33">    bead_atoms <span class="op">=</span> bead.atoms</a>
<a class="sourceLine" id="cb1363-34" title="34"></a>
<a class="sourceLine" id="cb1363-35" title="35">    <span class="co"># Loop over atoms</span></a>
<a class="sourceLine" id="cb1363-36" title="36">    <span class="cf">for</span> atom <span class="kw">in</span> bead_atoms:</a>
<a class="sourceLine" id="cb1363-37" title="37">      <span class="co"># Get the atom index</span></a>
<a class="sourceLine" id="cb1363-38" title="38">      atom_index <span class="op">=</span> atom.index</a>
<a class="sourceLine" id="cb1363-39" title="39"></a>
<a class="sourceLine" id="cb1363-40" title="40">      <span class="co"># Get the atom mass</span></a>
<a class="sourceLine" id="cb1363-41" title="41">      atom_mass <span class="op">=</span> atom.mass</a>
<a class="sourceLine" id="cb1363-42" title="42"></a>
<a class="sourceLine" id="cb1363-43" title="43">      <span class="co"># Set the mapping matrix value</span></a>
<a class="sourceLine" id="cb1363-44" title="44">      mapping_matrix[bead_index, atom_index] <span class="op">=</span> atom_mass <span class="op">/</span> bead_mass</a>
<a class="sourceLine" id="cb1363-45" title="45"></a>
<a class="sourceLine" id="cb1363-46" title="46">  <span class="co"># Return the mapping matrix</span></a>
<a class="sourceLine" id="cb1363-47" title="47">  <span class="cf">return</span> mapping_matrix</a>
<a class="sourceLine" id="cb1363-48" title="48"></a>
<a class="sourceLine" id="cb1363-49" title="49"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1363-50" title="50"><span class="im">import</span> MDAnalysis <span class="im">as</span> mda</a>
<a class="sourceLine" id="cb1363-51" title="51"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb1363-52" title="52"></a>
<a class="sourceLine" id="cb1363-53" title="53"><span class="co"># read molecule</span></a>
<a class="sourceLine" id="cb1363-54" title="54">u <span class="op">=</span> mda.Universe(os.path.join(_FILE_DIR_, <span class="st">&#39;water.gro&#39;</span>))</a>
<a class="sourceLine" id="cb1363-55" title="55">molecule <span class="op">=</span> u.atoms</a>
<a class="sourceLine" id="cb1363-56" title="56"><span class="co"># define atoms that belong to the a single bead</span></a>
<a class="sourceLine" id="cb1363-57" title="57">beads_mappings <span class="op">=</span> [[<span class="st">&#39;OW&#39;</span>, <span class="st">&#39;HW1&#39;</span>, <span class="st">&#39;HW2&#39;</span>]]</a>
<a class="sourceLine" id="cb1363-58" title="58">Mws_dict <span class="op">=</span> <span class="bu">dict</span>(<span class="bu">zip</span>(molecule.names, molecule.masses))</a>
<a class="sourceLine" id="cb1363-59" title="59">M, N <span class="op">=</span> <span class="bu">len</span>(beads_mappings), <span class="bu">len</span>(molecule)</a>
<a class="sourceLine" id="cb1363-60" title="60">CG_matrix <span class="op">=</span> np.zeros((M, N))</a>
<a class="sourceLine" id="cb1363-61" title="61">index <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb1363-62" title="62"><span class="cf">for</span> s <span class="kw">in</span> <span class="bu">range</span>(M):</a>
<a class="sourceLine" id="cb1363-63" title="63">    <span class="cf">for</span> i, atom <span class="kw">in</span> <span class="bu">enumerate</span>(beads_mappings[s]):</a>
<a class="sourceLine" id="cb1363-64" title="64">        CG_matrix[s, i <span class="op">+</span> index] <span class="op">=</span> [v <span class="cf">for</span> k,</a>
<a class="sourceLine" id="cb1363-65" title="65">                                   v <span class="kw">in</span> Mws_dict.items() <span class="cf">if</span> atom <span class="kw">in</span> k][<span class="dv">0</span>]</a>
<a class="sourceLine" id="cb1363-66" title="66">    index <span class="op">+=</span> np.count_nonzero(CG_matrix[s])</a>
<a class="sourceLine" id="cb1363-67" title="67">    CG_matrix[s] <span class="op">=</span> CG_matrix[s] <span class="op">/</span> np.<span class="bu">sum</span>(CG_matrix[s])</a>
<a class="sourceLine" id="cb1363-68" title="68"></a>
<a class="sourceLine" id="cb1363-69" title="69">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(</a>
<a class="sourceLine" id="cb1363-70" title="70">    CG_matrix, mapping_operator(molecule, beads_mappings)).<span class="bu">all</span>() <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>&#39;list&#39; object has no attribute &#39;replace&#39;</code></pre>
</details>
<details>
<p><summary>matpow</summary></p>
<h4 id="query-124">Query</h4>
<div class="sourceCode" id="cb1365"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1365-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1365-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1365-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1365-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1365-5" title="5"></a>
<a class="sourceLine" id="cb1365-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1365-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1365-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1365-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1365-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1365-11" title="11"></a>
<a class="sourceLine" id="cb1365-12" title="12"><span class="kw">def</span> matpow(x,n):</a>
<a class="sourceLine" id="cb1365-13" title="13">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1365-14" title="14"><span class="co">  This function computes matrix x raised to the power n.</span></a>
<a class="sourceLine" id="cb1365-15" title="15"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1365-16" title="16">  </a></code></pre></div>
<h4 id="run-0-124">Run 0</h4>
<div class="sourceCode" id="cb1366"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1366-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1366-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1366-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1366-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1366-5" title="5"></a>
<a class="sourceLine" id="cb1366-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1366-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1366-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1366-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1366-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1366-11" title="11"></a>
<a class="sourceLine" id="cb1366-12" title="12"><span class="kw">def</span> matpow(x,n):</a>
<a class="sourceLine" id="cb1366-13" title="13">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1366-14" title="14"><span class="co">  This function computes matrix x raised to the power n.</span></a>
<a class="sourceLine" id="cb1366-15" title="15"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1366-16" title="16">  <span class="cf">if</span> n <span class="op">==</span> <span class="dv">0</span>:</a>
<a class="sourceLine" id="cb1366-17" title="17">    <span class="cf">return</span> np.identity(x.shape[<span class="dv">0</span>])</a>
<a class="sourceLine" id="cb1366-18" title="18">  <span class="cf">elif</span> n <span class="op">==</span> <span class="dv">1</span>:</a>
<a class="sourceLine" id="cb1366-19" title="19">    <span class="cf">return</span> x</a>
<a class="sourceLine" id="cb1366-20" title="20">  <span class="cf">elif</span> n<span class="op">%</span><span class="dv">2</span> <span class="op">==</span> <span class="dv">0</span>:</a>
<a class="sourceLine" id="cb1366-21" title="21">    <span class="cf">return</span> matpow(np.dot(x,x),n<span class="op">/</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1366-22" title="22">  <span class="cf">else</span>:</a>
<a class="sourceLine" id="cb1366-23" title="23">    <span class="cf">return</span> np.dot(x,matpow(np.dot(x,x),(n<span class="dv">-1</span>)<span class="op">/</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb1366-24" title="24"></a>
<a class="sourceLine" id="cb1366-25" title="25"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1366-26" title="26"><span class="co">Compute matrix power</span></a>
<a class="sourceLine" id="cb1366-27" title="27"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1366-28" title="28">b <span class="op">=</span> matpow(a,<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb1366-29" title="29"></a>
<a class="sourceLine" id="cb1366-30" title="30"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1366-31" title="31"></a>
<a class="sourceLine" id="cb1366-32" title="32"></a>
<a class="sourceLine" id="cb1366-33" title="33">x <span class="op">=</span> np.array([[<span class="dv">0</span>, <span class="dv">1</span>], [<span class="op">-</span><span class="dv">1</span>, <span class="dv">0</span>]])</a>
<a class="sourceLine" id="cb1366-34" title="34"></a>
<a class="sourceLine" id="cb1366-35" title="35">true_y <span class="op">=</span> np.linalg.matrix_power(x,<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb1366-36" title="36"></a>
<a class="sourceLine" id="cb1366-37" title="37">pred_y <span class="op">=</span> matpow(x,<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb1366-38" title="38"></a>
<a class="sourceLine" id="cb1366-39" title="39">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.allclose(true_y,pred_y) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>shapes (5,10) and (5,10) not aligned: 10 (dim 1) != 5 (dim 0)</code></pre>
<h4 id="run-1-124">Run 1</h4>
<div class="sourceCode" id="cb1368"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1368-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1368-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1368-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1368-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1368-5" title="5"></a>
<a class="sourceLine" id="cb1368-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1368-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1368-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1368-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1368-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1368-11" title="11"></a>
<a class="sourceLine" id="cb1368-12" title="12"><span class="kw">def</span> matpow(x,n):</a>
<a class="sourceLine" id="cb1368-13" title="13">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1368-14" title="14"><span class="co">  This function computes matrix x raised to the power n.</span></a>
<a class="sourceLine" id="cb1368-15" title="15"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1368-16" title="16">  <span class="cf">if</span> n <span class="op">==</span> <span class="dv">0</span>:</a>
<a class="sourceLine" id="cb1368-17" title="17">    <span class="cf">return</span> np.eye(x.shape[<span class="dv">0</span>])</a>
<a class="sourceLine" id="cb1368-18" title="18">  <span class="cf">elif</span> n <span class="op">==</span> <span class="dv">1</span>:</a>
<a class="sourceLine" id="cb1368-19" title="19">    <span class="cf">return</span> x</a>
<a class="sourceLine" id="cb1368-20" title="20">  <span class="cf">elif</span> n <span class="op">%</span> <span class="dv">2</span> <span class="op">==</span> <span class="dv">0</span>:</a>
<a class="sourceLine" id="cb1368-21" title="21">    <span class="cf">return</span> matpow(np.dot(x,x), n<span class="op">/</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1368-22" title="22">  <span class="cf">else</span>:</a>
<a class="sourceLine" id="cb1368-23" title="23">    <span class="cf">return</span> np.dot(x, matpow(np.dot(x,x), (n<span class="dv">-1</span>)<span class="op">/</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb1368-24" title="24"></a>
<a class="sourceLine" id="cb1368-25" title="25"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1368-26" title="26"></a>
<a class="sourceLine" id="cb1368-27" title="27"></a>
<a class="sourceLine" id="cb1368-28" title="28">x <span class="op">=</span> np.array([[<span class="dv">0</span>, <span class="dv">1</span>], [<span class="op">-</span><span class="dv">1</span>, <span class="dv">0</span>]])</a>
<a class="sourceLine" id="cb1368-29" title="29"></a>
<a class="sourceLine" id="cb1368-30" title="30">true_y <span class="op">=</span> np.linalg.matrix_power(x,<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb1368-31" title="31"></a>
<a class="sourceLine" id="cb1368-32" title="32">pred_y <span class="op">=</span> matpow(x,<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb1368-33" title="33"></a>
<a class="sourceLine" id="cb1368-34" title="34">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.allclose(true_y,pred_y) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-124">Run 2</h4>
<div class="sourceCode" id="cb1370"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1370-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1370-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1370-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1370-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1370-5" title="5"></a>
<a class="sourceLine" id="cb1370-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1370-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1370-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1370-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1370-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1370-11" title="11"></a>
<a class="sourceLine" id="cb1370-12" title="12"><span class="kw">def</span> matpow(x,n):</a>
<a class="sourceLine" id="cb1370-13" title="13">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1370-14" title="14"><span class="co">  This function computes matrix x raised to the power n.</span></a>
<a class="sourceLine" id="cb1370-15" title="15"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1370-16" title="16">  <span class="cf">if</span> n <span class="op">==</span> <span class="dv">0</span>:</a>
<a class="sourceLine" id="cb1370-17" title="17">    <span class="cf">return</span> np.eye(x.shape[<span class="dv">0</span>])</a>
<a class="sourceLine" id="cb1370-18" title="18">  <span class="cf">elif</span> n <span class="op">==</span> <span class="dv">1</span>:</a>
<a class="sourceLine" id="cb1370-19" title="19">    <span class="cf">return</span> x</a>
<a class="sourceLine" id="cb1370-20" title="20">  <span class="cf">elif</span> n <span class="op">%</span> <span class="dv">2</span> <span class="op">==</span> <span class="dv">0</span>:</a>
<a class="sourceLine" id="cb1370-21" title="21">    <span class="cf">return</span> matpow(x.dot(x), n<span class="op">/</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1370-22" title="22">  <span class="cf">else</span>:</a>
<a class="sourceLine" id="cb1370-23" title="23">    <span class="cf">return</span> x.dot(matpow(x, n<span class="dv">-1</span>))</a>
<a class="sourceLine" id="cb1370-24" title="24"></a>
<a class="sourceLine" id="cb1370-25" title="25"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1370-26" title="26"></a>
<a class="sourceLine" id="cb1370-27" title="27"></a>
<a class="sourceLine" id="cb1370-28" title="28">x <span class="op">=</span> np.array([[<span class="dv">0</span>, <span class="dv">1</span>], [<span class="op">-</span><span class="dv">1</span>, <span class="dv">0</span>]])</a>
<a class="sourceLine" id="cb1370-29" title="29"></a>
<a class="sourceLine" id="cb1370-30" title="30">true_y <span class="op">=</span> np.linalg.matrix_power(x,<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb1370-31" title="31"></a>
<a class="sourceLine" id="cb1370-32" title="32">pred_y <span class="op">=</span> matpow(x,<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb1370-33" title="33"></a>
<a class="sourceLine" id="cb1370-34" title="34">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.allclose(true_y,pred_y) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-124">Run 3</h4>
<div class="sourceCode" id="cb1372"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1372-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1372-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1372-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1372-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1372-5" title="5"></a>
<a class="sourceLine" id="cb1372-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1372-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1372-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1372-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1372-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1372-11" title="11"></a>
<a class="sourceLine" id="cb1372-12" title="12"><span class="kw">def</span> matpow(x,n):</a>
<a class="sourceLine" id="cb1372-13" title="13">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1372-14" title="14"><span class="co">  This function computes matrix x raised to the power n.</span></a>
<a class="sourceLine" id="cb1372-15" title="15"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1372-16" title="16">  <span class="cf">if</span> n <span class="op">==</span> <span class="dv">0</span>:</a>
<a class="sourceLine" id="cb1372-17" title="17">    <span class="cf">return</span> np.eye(x.shape[<span class="dv">0</span>])</a>
<a class="sourceLine" id="cb1372-18" title="18">  <span class="cf">elif</span> n <span class="op">==</span> <span class="dv">1</span>:</a>
<a class="sourceLine" id="cb1372-19" title="19">    <span class="cf">return</span> x</a>
<a class="sourceLine" id="cb1372-20" title="20">  <span class="cf">elif</span> n <span class="op">%</span> <span class="dv">2</span> <span class="op">==</span> <span class="dv">0</span>:</a>
<a class="sourceLine" id="cb1372-21" title="21">    <span class="cf">return</span> matpow(np.dot(x,x),n<span class="op">/</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1372-22" title="22">  <span class="cf">else</span>:</a>
<a class="sourceLine" id="cb1372-23" title="23">    <span class="cf">return</span> np.dot(x,matpow(np.dot(x,x),(n<span class="dv">-1</span>)<span class="op">/</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb1372-24" title="24"></a>
<a class="sourceLine" id="cb1372-25" title="25"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1372-26" title="26"></a>
<a class="sourceLine" id="cb1372-27" title="27"></a>
<a class="sourceLine" id="cb1372-28" title="28">x <span class="op">=</span> np.array([[<span class="dv">0</span>, <span class="dv">1</span>], [<span class="op">-</span><span class="dv">1</span>, <span class="dv">0</span>]])</a>
<a class="sourceLine" id="cb1372-29" title="29"></a>
<a class="sourceLine" id="cb1372-30" title="30">true_y <span class="op">=</span> np.linalg.matrix_power(x,<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb1372-31" title="31"></a>
<a class="sourceLine" id="cb1372-32" title="32">pred_y <span class="op">=</span> matpow(x,<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb1372-33" title="33"></a>
<a class="sourceLine" id="cb1372-34" title="34">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.allclose(true_y,pred_y) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-124">Run 4</h4>
<div class="sourceCode" id="cb1374"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1374-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1374-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1374-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1374-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1374-5" title="5"></a>
<a class="sourceLine" id="cb1374-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1374-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1374-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1374-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1374-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1374-11" title="11"></a>
<a class="sourceLine" id="cb1374-12" title="12"><span class="kw">def</span> matpow(x,n):</a>
<a class="sourceLine" id="cb1374-13" title="13">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1374-14" title="14"><span class="co">  This function computes matrix x raised to the power n.</span></a>
<a class="sourceLine" id="cb1374-15" title="15"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1374-16" title="16">  <span class="cf">if</span> n <span class="op">==</span> <span class="dv">0</span>:</a>
<a class="sourceLine" id="cb1374-17" title="17">    <span class="cf">return</span> np.eye(x.shape[<span class="dv">0</span>])</a>
<a class="sourceLine" id="cb1374-18" title="18">  <span class="cf">elif</span> n <span class="op">==</span> <span class="dv">1</span>:</a>
<a class="sourceLine" id="cb1374-19" title="19">    <span class="cf">return</span> x</a>
<a class="sourceLine" id="cb1374-20" title="20">  <span class="cf">elif</span> n <span class="op">%</span> <span class="dv">2</span> <span class="op">==</span> <span class="dv">0</span>:</a>
<a class="sourceLine" id="cb1374-21" title="21">    <span class="cf">return</span> matpow(x.dot(x), n<span class="op">/</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1374-22" title="22">  <span class="cf">else</span>:</a>
<a class="sourceLine" id="cb1374-23" title="23">    <span class="cf">return</span> x.dot(matpow(x.dot(x), (n<span class="dv">-1</span>)<span class="op">/</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb1374-24" title="24"></a>
<a class="sourceLine" id="cb1374-25" title="25"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1374-26" title="26"></a>
<a class="sourceLine" id="cb1374-27" title="27"></a>
<a class="sourceLine" id="cb1374-28" title="28">x <span class="op">=</span> np.array([[<span class="dv">0</span>, <span class="dv">1</span>], [<span class="op">-</span><span class="dv">1</span>, <span class="dv">0</span>]])</a>
<a class="sourceLine" id="cb1374-29" title="29"></a>
<a class="sourceLine" id="cb1374-30" title="30">true_y <span class="op">=</span> np.linalg.matrix_power(x,<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb1374-31" title="31"></a>
<a class="sourceLine" id="cb1374-32" title="32">pred_y <span class="op">=</span> matpow(x,<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb1374-33" title="33"></a>
<a class="sourceLine" id="cb1374-34" title="34">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.allclose(true_y,pred_y) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>matrix_factorial</summary></p>
<h4 id="query-125">Query</h4>
<div class="sourceCode" id="cb1376"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1376-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1376-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1376-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1376-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1376-5" title="5"></a>
<a class="sourceLine" id="cb1376-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1376-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1376-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1376-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1376-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1376-11" title="11"></a>
<a class="sourceLine" id="cb1376-12" title="12"><span class="kw">def</span> matrix_factorial(n):</a>
<a class="sourceLine" id="cb1376-13" title="13">     <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1376-14" title="14"><span class="co">     This function calculates and returns the factorial of a matrix (array) element wise</span></a>
<a class="sourceLine" id="cb1376-15" title="15"><span class="co">     &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1376-16" title="16">     </a></code></pre></div>
<h4 id="run-0-125">Run 0</h4>
<div class="sourceCode" id="cb1377"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1377-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1377-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1377-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1377-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1377-5" title="5"></a>
<a class="sourceLine" id="cb1377-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1377-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1377-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1377-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1377-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1377-11" title="11"></a>
<a class="sourceLine" id="cb1377-12" title="12"><span class="kw">def</span> matrix_factorial(n):</a>
<a class="sourceLine" id="cb1377-13" title="13">     <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1377-14" title="14"><span class="co">     This function calculates and returns the factorial of a matrix (array) element wise</span></a>
<a class="sourceLine" id="cb1377-15" title="15"><span class="co">     &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1377-16" title="16">     <span class="co"># start</span></a>
<a class="sourceLine" id="cb1377-17" title="17">     <span class="cf">return</span> np.prod(np.arange(<span class="dv">1</span>,n<span class="op">+</span><span class="dv">1</span>))</a>
<a class="sourceLine" id="cb1377-18" title="18">     </a>
<a class="sourceLine" id="cb1377-19" title="19"></a>
<a class="sourceLine" id="cb1377-20" title="20"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1377-21" title="21"></a>
<a class="sourceLine" id="cb1377-22" title="22">x <span class="op">=</span> np.array([[<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>], [<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>]])</a>
<a class="sourceLine" id="cb1377-23" title="23">m_f <span class="op">=</span> matrix_factorial(x)</a>
<a class="sourceLine" id="cb1377-24" title="24">x_f <span class="op">=</span> np.array([[<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">6</span>], [<span class="dv">24</span>,<span class="dv">120</span>,<span class="dv">720</span>]])</a>
<a class="sourceLine" id="cb1377-25" title="25"></a>
<a class="sourceLine" id="cb1377-26" title="26">result <span class="op">=</span> np.array_equal(x_f,m_f) </a>
<a class="sourceLine" id="cb1377-27" title="27"></a></code></pre></div>
<p>Output:</p>
<pre><code>The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()</code></pre>
<h4 id="run-1-125">Run 1</h4>
<div class="sourceCode" id="cb1379"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1379-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1379-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1379-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1379-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1379-5" title="5"></a>
<a class="sourceLine" id="cb1379-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1379-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1379-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1379-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1379-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1379-11" title="11"></a>
<a class="sourceLine" id="cb1379-12" title="12"><span class="kw">def</span> matrix_factorial(n):</a>
<a class="sourceLine" id="cb1379-13" title="13">     <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1379-14" title="14"><span class="co">     This function calculates and returns the factorial of a matrix (array) element wise</span></a>
<a class="sourceLine" id="cb1379-15" title="15"><span class="co">     &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1379-16" title="16">     <span class="cf">if</span> n <span class="op">==</span> <span class="dv">0</span>:</a>
<a class="sourceLine" id="cb1379-17" title="17">          <span class="cf">return</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb1379-18" title="18">     <span class="cf">else</span>:</a>
<a class="sourceLine" id="cb1379-19" title="19">          <span class="cf">return</span> n <span class="op">*</span> matrix_factorial(n<span class="dv">-1</span>)</a>
<a class="sourceLine" id="cb1379-20" title="20"></a>
<a class="sourceLine" id="cb1379-21" title="21"></a>
<a class="sourceLine" id="cb1379-22" title="22"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1379-23" title="23"></a>
<a class="sourceLine" id="cb1379-24" title="24">x <span class="op">=</span> np.array([[<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>], [<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>]])</a>
<a class="sourceLine" id="cb1379-25" title="25">m_f <span class="op">=</span> matrix_factorial(x)</a>
<a class="sourceLine" id="cb1379-26" title="26">x_f <span class="op">=</span> np.array([[<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">6</span>], [<span class="dv">24</span>,<span class="dv">120</span>,<span class="dv">720</span>]])</a>
<a class="sourceLine" id="cb1379-27" title="27"></a>
<a class="sourceLine" id="cb1379-28" title="28">result <span class="op">=</span> np.array_equal(x_f,m_f) </a>
<a class="sourceLine" id="cb1379-29" title="29"></a></code></pre></div>
<p>Output:</p>
<pre><code>The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()</code></pre>
<h4 id="run-2-125">Run 2</h4>
<div class="sourceCode" id="cb1381"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1381-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1381-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1381-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1381-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1381-5" title="5"></a>
<a class="sourceLine" id="cb1381-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1381-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1381-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1381-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1381-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1381-11" title="11"></a>
<a class="sourceLine" id="cb1381-12" title="12"><span class="kw">def</span> matrix_factorial(n):</a>
<a class="sourceLine" id="cb1381-13" title="13">     <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1381-14" title="14"><span class="co">     This function calculates and returns the factorial of a matrix (array) element wise</span></a>
<a class="sourceLine" id="cb1381-15" title="15"><span class="co">     &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1381-16" title="16">     <span class="cf">if</span> n <span class="op">&lt;</span> <span class="dv">0</span>:</a>
<a class="sourceLine" id="cb1381-17" title="17">          <span class="cf">return</span> <span class="va">None</span></a>
<a class="sourceLine" id="cb1381-18" title="18">     <span class="cf">elif</span> n <span class="op">==</span> <span class="dv">0</span>:</a>
<a class="sourceLine" id="cb1381-19" title="19">          <span class="cf">return</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb1381-20" title="20">     <span class="cf">else</span>:</a>
<a class="sourceLine" id="cb1381-21" title="21">          <span class="cf">return</span> n <span class="op">*</span> matrix_factorial(n<span class="dv">-1</span>)</a>
<a class="sourceLine" id="cb1381-22" title="22"></a>
<a class="sourceLine" id="cb1381-23" title="23"></a>
<a class="sourceLine" id="cb1381-24" title="24"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1381-25" title="25"></a>
<a class="sourceLine" id="cb1381-26" title="26">x <span class="op">=</span> np.array([[<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>], [<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>]])</a>
<a class="sourceLine" id="cb1381-27" title="27">m_f <span class="op">=</span> matrix_factorial(x)</a>
<a class="sourceLine" id="cb1381-28" title="28">x_f <span class="op">=</span> np.array([[<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">6</span>], [<span class="dv">24</span>,<span class="dv">120</span>,<span class="dv">720</span>]])</a>
<a class="sourceLine" id="cb1381-29" title="29"></a>
<a class="sourceLine" id="cb1381-30" title="30">result <span class="op">=</span> np.array_equal(x_f,m_f) </a>
<a class="sourceLine" id="cb1381-31" title="31"></a></code></pre></div>
<p>Output:</p>
<pre><code>The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()</code></pre>
<h4 id="run-3-125">Run 3</h4>
<div class="sourceCode" id="cb1383"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1383-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1383-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1383-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1383-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1383-5" title="5"></a>
<a class="sourceLine" id="cb1383-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1383-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1383-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1383-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1383-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1383-11" title="11"></a>
<a class="sourceLine" id="cb1383-12" title="12"><span class="kw">def</span> matrix_factorial(n):</a>
<a class="sourceLine" id="cb1383-13" title="13">     <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1383-14" title="14"><span class="co">     This function calculates and returns the factorial of a matrix (array) element wise</span></a>
<a class="sourceLine" id="cb1383-15" title="15"><span class="co">     &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1383-16" title="16">     <span class="co"># start</span></a>
<a class="sourceLine" id="cb1383-17" title="17">     <span class="cf">return</span> np.exp(np.log(np.arange(<span class="dv">1</span>,n<span class="op">+</span><span class="dv">1</span>)).<span class="bu">sum</span>())</a>
<a class="sourceLine" id="cb1383-18" title="18">     </a>
<a class="sourceLine" id="cb1383-19" title="19"></a>
<a class="sourceLine" id="cb1383-20" title="20"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1383-21" title="21"></a>
<a class="sourceLine" id="cb1383-22" title="22">x <span class="op">=</span> np.array([[<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>], [<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>]])</a>
<a class="sourceLine" id="cb1383-23" title="23">m_f <span class="op">=</span> matrix_factorial(x)</a>
<a class="sourceLine" id="cb1383-24" title="24">x_f <span class="op">=</span> np.array([[<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">6</span>], [<span class="dv">24</span>,<span class="dv">120</span>,<span class="dv">720</span>]])</a>
<a class="sourceLine" id="cb1383-25" title="25"></a>
<a class="sourceLine" id="cb1383-26" title="26">result <span class="op">=</span> np.array_equal(x_f,m_f) </a>
<a class="sourceLine" id="cb1383-27" title="27"></a></code></pre></div>
<p>Output:</p>
<pre><code>The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()</code></pre>
<h4 id="run-4-125">Run 4</h4>
<div class="sourceCode" id="cb1385"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1385-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1385-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1385-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1385-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1385-5" title="5"></a>
<a class="sourceLine" id="cb1385-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1385-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1385-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1385-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1385-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1385-11" title="11"></a>
<a class="sourceLine" id="cb1385-12" title="12"><span class="kw">def</span> matrix_factorial(n):</a>
<a class="sourceLine" id="cb1385-13" title="13">     <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1385-14" title="14"><span class="co">     This function calculates and returns the factorial of a matrix (array) element wise</span></a>
<a class="sourceLine" id="cb1385-15" title="15"><span class="co">     &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1385-16" title="16">     <span class="co"># start</span></a>
<a class="sourceLine" id="cb1385-17" title="17">     <span class="cf">return</span> np.prod(np.arange(<span class="dv">1</span>,n<span class="op">+</span><span class="dv">1</span>))</a>
<a class="sourceLine" id="cb1385-18" title="18">     </a>
<a class="sourceLine" id="cb1385-19" title="19"></a>
<a class="sourceLine" id="cb1385-20" title="20"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1385-21" title="21"></a>
<a class="sourceLine" id="cb1385-22" title="22">x <span class="op">=</span> np.array([[<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>], [<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>]])</a>
<a class="sourceLine" id="cb1385-23" title="23">m_f <span class="op">=</span> matrix_factorial(x)</a>
<a class="sourceLine" id="cb1385-24" title="24">x_f <span class="op">=</span> np.array([[<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">6</span>], [<span class="dv">24</span>,<span class="dv">120</span>,<span class="dv">720</span>]])</a>
<a class="sourceLine" id="cb1385-25" title="25"></a>
<a class="sourceLine" id="cb1385-26" title="26">result <span class="op">=</span> np.array_equal(x_f,m_f) </a>
<a class="sourceLine" id="cb1385-27" title="27"></a></code></pre></div>
<p>Output:</p>
<pre><code>The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()</code></pre>
</details>
<details>
<p><summary>max-boltz</summary></p>
<h4 id="query-126">Query</h4>
<div class="sourceCode" id="cb1387"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1387-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb1387-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb1387-3" title="3"></a>
<a class="sourceLine" id="cb1387-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1387-5" title="5"><span class="co">compute sin(pi/2)</span></a>
<a class="sourceLine" id="cb1387-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1387-7" title="7">x <span class="op">=</span> math.sin(math.pi <span class="op">/</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1387-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1387-9" title="9"></a>
<a class="sourceLine" id="cb1387-10" title="10"><span class="kw">def</span> max_boltz_rms_speed(T,M):</a>
<a class="sourceLine" id="cb1387-11" title="11">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1387-12" title="12"><span class="co">   This function returns the rms speed of a molecule in m/s</span></a>
<a class="sourceLine" id="cb1387-13" title="13"></a>
<a class="sourceLine" id="cb1387-14" title="14"><span class="co">   The temperature is T in Kelvin</span></a>
<a class="sourceLine" id="cb1387-15" title="15"><span class="co">   The molecule has mass M in kiolograms</span></a>
<a class="sourceLine" id="cb1387-16" title="16"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1387-17" title="17">   </a></code></pre></div>
<h4 id="run-0-126">Run 0</h4>
<div class="sourceCode" id="cb1388"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1388-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb1388-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb1388-3" title="3"></a>
<a class="sourceLine" id="cb1388-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1388-5" title="5"><span class="co">compute sin(pi/2)</span></a>
<a class="sourceLine" id="cb1388-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1388-7" title="7">x <span class="op">=</span> math.sin(math.pi <span class="op">/</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1388-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1388-9" title="9"></a>
<a class="sourceLine" id="cb1388-10" title="10"><span class="kw">def</span> max_boltz_rms_speed(T,M):</a>
<a class="sourceLine" id="cb1388-11" title="11">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1388-12" title="12"><span class="co">   This function returns the rms speed of a molecule in m/s</span></a>
<a class="sourceLine" id="cb1388-13" title="13"></a>
<a class="sourceLine" id="cb1388-14" title="14"><span class="co">   The temperature is T in Kelvin</span></a>
<a class="sourceLine" id="cb1388-15" title="15"><span class="co">   The molecule has mass M in kiolograms</span></a>
<a class="sourceLine" id="cb1388-16" title="16"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1388-17" title="17">   k <span class="op">=</span> <span class="fl">1.3806488e-23</span></a>
<a class="sourceLine" id="cb1388-18" title="18">   <span class="cf">return</span> math.sqrt(k<span class="op">*</span>T<span class="op">/</span>M)</a>
<a class="sourceLine" id="cb1388-19" title="19"></a>
<a class="sourceLine" id="cb1388-20" title="20"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1388-21" title="21"></a>
<a class="sourceLine" id="cb1388-22" title="22"><span class="co"># input params</span></a>
<a class="sourceLine" id="cb1388-23" title="23">M <span class="op">=</span> <span class="fl">32e-3</span>           <span class="co"># for O2, kg/mol</span></a>
<a class="sourceLine" id="cb1388-24" title="24">R <span class="op">=</span> <span class="fl">8.314</span>           <span class="co"># J/mol.K</span></a>
<a class="sourceLine" id="cb1388-25" title="25">T <span class="op">=</span> <span class="dv">300</span></a>
<a class="sourceLine" id="cb1388-26" title="26"></a>
<a class="sourceLine" id="cb1388-27" title="27">c_rms <span class="op">=</span> np.sqrt(<span class="fl">3.0</span><span class="op">*</span>R<span class="op">*</span>T<span class="op">/</span>M)</a>
<a class="sourceLine" id="cb1388-28" title="28"><span class="co">#print(&quot;rms speeds :&quot;, c_rms)</span></a>
<a class="sourceLine" id="cb1388-29" title="29"></a>
<a class="sourceLine" id="cb1388-30" title="30">M_in_kg <span class="op">=</span> M<span class="op">/</span><span class="fl">6.022e23</span></a>
<a class="sourceLine" id="cb1388-31" title="31"></a>
<a class="sourceLine" id="cb1388-32" title="32">c_rms_codex <span class="op">=</span> max_boltz_rms_speed(T,M_in_kg)</a>
<a class="sourceLine" id="cb1388-33" title="33"><span class="co">#print(&quot;rms speeds from codex :&quot;, c_rms_codex)</span></a>
<a class="sourceLine" id="cb1388-34" title="34"></a>
<a class="sourceLine" id="cb1388-35" title="35"><span class="co"># check</span></a>
<a class="sourceLine" id="cb1388-36" title="36"><span class="cf">if</span> np.isclose(c_rms,c_rms_codex,rtol<span class="op">=</span><span class="fl">0.01</span>):</a>
<a class="sourceLine" id="cb1388-37" title="37">    result <span class="op">=</span> <span class="va">True</span> </a>
<a class="sourceLine" id="cb1388-38" title="38"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb1388-39" title="39">    result <span class="op">=</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-126">Run 1</h4>
<div class="sourceCode" id="cb1390"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1390-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb1390-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb1390-3" title="3"></a>
<a class="sourceLine" id="cb1390-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1390-5" title="5"><span class="co">compute sin(pi/2)</span></a>
<a class="sourceLine" id="cb1390-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1390-7" title="7">x <span class="op">=</span> math.sin(math.pi <span class="op">/</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1390-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1390-9" title="9"></a>
<a class="sourceLine" id="cb1390-10" title="10"><span class="kw">def</span> max_boltz_rms_speed(T,M):</a>
<a class="sourceLine" id="cb1390-11" title="11">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1390-12" title="12"><span class="co">   This function returns the rms speed of a molecule in m/s</span></a>
<a class="sourceLine" id="cb1390-13" title="13"></a>
<a class="sourceLine" id="cb1390-14" title="14"><span class="co">   The temperature is T in Kelvin</span></a>
<a class="sourceLine" id="cb1390-15" title="15"><span class="co">   The molecule has mass M in kiolograms</span></a>
<a class="sourceLine" id="cb1390-16" title="16"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1390-17" title="17">   k <span class="op">=</span> <span class="fl">1.3806503e-23</span> <span class="co"># Boltzmann constant</span></a>
<a class="sourceLine" id="cb1390-18" title="18">   <span class="cf">return</span> math.sqrt(k <span class="op">*</span> T <span class="op">/</span> M)</a>
<a class="sourceLine" id="cb1390-19" title="19"></a>
<a class="sourceLine" id="cb1390-20" title="20"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1390-21" title="21"></a>
<a class="sourceLine" id="cb1390-22" title="22"><span class="co"># input params</span></a>
<a class="sourceLine" id="cb1390-23" title="23">M <span class="op">=</span> <span class="fl">32e-3</span>           <span class="co"># for O2, kg/mol</span></a>
<a class="sourceLine" id="cb1390-24" title="24">R <span class="op">=</span> <span class="fl">8.314</span>           <span class="co"># J/mol.K</span></a>
<a class="sourceLine" id="cb1390-25" title="25">T <span class="op">=</span> <span class="dv">300</span></a>
<a class="sourceLine" id="cb1390-26" title="26"></a>
<a class="sourceLine" id="cb1390-27" title="27">c_rms <span class="op">=</span> np.sqrt(<span class="fl">3.0</span><span class="op">*</span>R<span class="op">*</span>T<span class="op">/</span>M)</a>
<a class="sourceLine" id="cb1390-28" title="28"><span class="co">#print(&quot;rms speeds :&quot;, c_rms)</span></a>
<a class="sourceLine" id="cb1390-29" title="29"></a>
<a class="sourceLine" id="cb1390-30" title="30">M_in_kg <span class="op">=</span> M<span class="op">/</span><span class="fl">6.022e23</span></a>
<a class="sourceLine" id="cb1390-31" title="31"></a>
<a class="sourceLine" id="cb1390-32" title="32">c_rms_codex <span class="op">=</span> max_boltz_rms_speed(T,M_in_kg)</a>
<a class="sourceLine" id="cb1390-33" title="33"><span class="co">#print(&quot;rms speeds from codex :&quot;, c_rms_codex)</span></a>
<a class="sourceLine" id="cb1390-34" title="34"></a>
<a class="sourceLine" id="cb1390-35" title="35"><span class="co"># check</span></a>
<a class="sourceLine" id="cb1390-36" title="36"><span class="cf">if</span> np.isclose(c_rms,c_rms_codex,rtol<span class="op">=</span><span class="fl">0.01</span>):</a>
<a class="sourceLine" id="cb1390-37" title="37">    result <span class="op">=</span> <span class="va">True</span> </a>
<a class="sourceLine" id="cb1390-38" title="38"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb1390-39" title="39">    result <span class="op">=</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-126">Run 2</h4>
<div class="sourceCode" id="cb1392"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1392-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb1392-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb1392-3" title="3"></a>
<a class="sourceLine" id="cb1392-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1392-5" title="5"><span class="co">compute sin(pi/2)</span></a>
<a class="sourceLine" id="cb1392-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1392-7" title="7">x <span class="op">=</span> math.sin(math.pi <span class="op">/</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1392-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1392-9" title="9"></a>
<a class="sourceLine" id="cb1392-10" title="10"><span class="kw">def</span> max_boltz_rms_speed(T,M):</a>
<a class="sourceLine" id="cb1392-11" title="11">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1392-12" title="12"><span class="co">   This function returns the rms speed of a molecule in m/s</span></a>
<a class="sourceLine" id="cb1392-13" title="13"></a>
<a class="sourceLine" id="cb1392-14" title="14"><span class="co">   The temperature is T in Kelvin</span></a>
<a class="sourceLine" id="cb1392-15" title="15"><span class="co">   The molecule has mass M in kiolograms</span></a>
<a class="sourceLine" id="cb1392-16" title="16"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1392-17" title="17">   k <span class="op">=</span> <span class="fl">1.38064852e-23</span> <span class="co"># Boltzmann constant</span></a>
<a class="sourceLine" id="cb1392-18" title="18">   <span class="cf">return</span> math.sqrt(<span class="dv">3</span> <span class="op">*</span> k <span class="op">*</span> T <span class="op">/</span> M)</a>
<a class="sourceLine" id="cb1392-19" title="19"></a>
<a class="sourceLine" id="cb1392-20" title="20"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1392-21" title="21"></a>
<a class="sourceLine" id="cb1392-22" title="22"><span class="co"># input params</span></a>
<a class="sourceLine" id="cb1392-23" title="23">M <span class="op">=</span> <span class="fl">32e-3</span>           <span class="co"># for O2, kg/mol</span></a>
<a class="sourceLine" id="cb1392-24" title="24">R <span class="op">=</span> <span class="fl">8.314</span>           <span class="co"># J/mol.K</span></a>
<a class="sourceLine" id="cb1392-25" title="25">T <span class="op">=</span> <span class="dv">300</span></a>
<a class="sourceLine" id="cb1392-26" title="26"></a>
<a class="sourceLine" id="cb1392-27" title="27">c_rms <span class="op">=</span> np.sqrt(<span class="fl">3.0</span><span class="op">*</span>R<span class="op">*</span>T<span class="op">/</span>M)</a>
<a class="sourceLine" id="cb1392-28" title="28"><span class="co">#print(&quot;rms speeds :&quot;, c_rms)</span></a>
<a class="sourceLine" id="cb1392-29" title="29"></a>
<a class="sourceLine" id="cb1392-30" title="30">M_in_kg <span class="op">=</span> M<span class="op">/</span><span class="fl">6.022e23</span></a>
<a class="sourceLine" id="cb1392-31" title="31"></a>
<a class="sourceLine" id="cb1392-32" title="32">c_rms_codex <span class="op">=</span> max_boltz_rms_speed(T,M_in_kg)</a>
<a class="sourceLine" id="cb1392-33" title="33"><span class="co">#print(&quot;rms speeds from codex :&quot;, c_rms_codex)</span></a>
<a class="sourceLine" id="cb1392-34" title="34"></a>
<a class="sourceLine" id="cb1392-35" title="35"><span class="co"># check</span></a>
<a class="sourceLine" id="cb1392-36" title="36"><span class="cf">if</span> np.isclose(c_rms,c_rms_codex,rtol<span class="op">=</span><span class="fl">0.01</span>):</a>
<a class="sourceLine" id="cb1392-37" title="37">    result <span class="op">=</span> <span class="va">True</span> </a>
<a class="sourceLine" id="cb1392-38" title="38"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb1392-39" title="39">    result <span class="op">=</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-126">Run 3</h4>
<div class="sourceCode" id="cb1394"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1394-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb1394-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb1394-3" title="3"></a>
<a class="sourceLine" id="cb1394-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1394-5" title="5"><span class="co">compute sin(pi/2)</span></a>
<a class="sourceLine" id="cb1394-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1394-7" title="7">x <span class="op">=</span> math.sin(math.pi <span class="op">/</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1394-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1394-9" title="9"></a>
<a class="sourceLine" id="cb1394-10" title="10"><span class="kw">def</span> max_boltz_rms_speed(T,M):</a>
<a class="sourceLine" id="cb1394-11" title="11">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1394-12" title="12"><span class="co">   This function returns the rms speed of a molecule in m/s</span></a>
<a class="sourceLine" id="cb1394-13" title="13"></a>
<a class="sourceLine" id="cb1394-14" title="14"><span class="co">   The temperature is T in Kelvin</span></a>
<a class="sourceLine" id="cb1394-15" title="15"><span class="co">   The molecule has mass M in kiolograms</span></a>
<a class="sourceLine" id="cb1394-16" title="16"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1394-17" title="17">   k <span class="op">=</span> <span class="fl">1.38064852e-23</span> <span class="co"># J/K</span></a>
<a class="sourceLine" id="cb1394-18" title="18">   <span class="cf">return</span> math.sqrt(<span class="dv">3</span><span class="op">*</span>k<span class="op">*</span>T<span class="op">/</span>M)</a>
<a class="sourceLine" id="cb1394-19" title="19"></a>
<a class="sourceLine" id="cb1394-20" title="20"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1394-21" title="21"></a>
<a class="sourceLine" id="cb1394-22" title="22"><span class="co"># input params</span></a>
<a class="sourceLine" id="cb1394-23" title="23">M <span class="op">=</span> <span class="fl">32e-3</span>           <span class="co"># for O2, kg/mol</span></a>
<a class="sourceLine" id="cb1394-24" title="24">R <span class="op">=</span> <span class="fl">8.314</span>           <span class="co"># J/mol.K</span></a>
<a class="sourceLine" id="cb1394-25" title="25">T <span class="op">=</span> <span class="dv">300</span></a>
<a class="sourceLine" id="cb1394-26" title="26"></a>
<a class="sourceLine" id="cb1394-27" title="27">c_rms <span class="op">=</span> np.sqrt(<span class="fl">3.0</span><span class="op">*</span>R<span class="op">*</span>T<span class="op">/</span>M)</a>
<a class="sourceLine" id="cb1394-28" title="28"><span class="co">#print(&quot;rms speeds :&quot;, c_rms)</span></a>
<a class="sourceLine" id="cb1394-29" title="29"></a>
<a class="sourceLine" id="cb1394-30" title="30">M_in_kg <span class="op">=</span> M<span class="op">/</span><span class="fl">6.022e23</span></a>
<a class="sourceLine" id="cb1394-31" title="31"></a>
<a class="sourceLine" id="cb1394-32" title="32">c_rms_codex <span class="op">=</span> max_boltz_rms_speed(T,M_in_kg)</a>
<a class="sourceLine" id="cb1394-33" title="33"><span class="co">#print(&quot;rms speeds from codex :&quot;, c_rms_codex)</span></a>
<a class="sourceLine" id="cb1394-34" title="34"></a>
<a class="sourceLine" id="cb1394-35" title="35"><span class="co"># check</span></a>
<a class="sourceLine" id="cb1394-36" title="36"><span class="cf">if</span> np.isclose(c_rms,c_rms_codex,rtol<span class="op">=</span><span class="fl">0.01</span>):</a>
<a class="sourceLine" id="cb1394-37" title="37">    result <span class="op">=</span> <span class="va">True</span> </a>
<a class="sourceLine" id="cb1394-38" title="38"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb1394-39" title="39">    result <span class="op">=</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-126">Run 4</h4>
<div class="sourceCode" id="cb1396"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1396-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb1396-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb1396-3" title="3"></a>
<a class="sourceLine" id="cb1396-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1396-5" title="5"><span class="co">compute sin(pi/2)</span></a>
<a class="sourceLine" id="cb1396-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1396-7" title="7">x <span class="op">=</span> math.sin(math.pi <span class="op">/</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1396-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1396-9" title="9"></a>
<a class="sourceLine" id="cb1396-10" title="10"><span class="kw">def</span> max_boltz_rms_speed(T,M):</a>
<a class="sourceLine" id="cb1396-11" title="11">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1396-12" title="12"><span class="co">   This function returns the rms speed of a molecule in m/s</span></a>
<a class="sourceLine" id="cb1396-13" title="13"></a>
<a class="sourceLine" id="cb1396-14" title="14"><span class="co">   The temperature is T in Kelvin</span></a>
<a class="sourceLine" id="cb1396-15" title="15"><span class="co">   The molecule has mass M in kiolograms</span></a>
<a class="sourceLine" id="cb1396-16" title="16"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1396-17" title="17">   k <span class="op">=</span> <span class="fl">1.38064852e-23</span> <span class="co"># Boltzmann constant in m^2 kg s^-2 K-1</span></a>
<a class="sourceLine" id="cb1396-18" title="18">   <span class="cf">return</span> math.sqrt(k<span class="op">*</span>T<span class="op">/</span>M)</a>
<a class="sourceLine" id="cb1396-19" title="19"></a>
<a class="sourceLine" id="cb1396-20" title="20"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1396-21" title="21"></a>
<a class="sourceLine" id="cb1396-22" title="22"><span class="co"># input params</span></a>
<a class="sourceLine" id="cb1396-23" title="23">M <span class="op">=</span> <span class="fl">32e-3</span>           <span class="co"># for O2, kg/mol</span></a>
<a class="sourceLine" id="cb1396-24" title="24">R <span class="op">=</span> <span class="fl">8.314</span>           <span class="co"># J/mol.K</span></a>
<a class="sourceLine" id="cb1396-25" title="25">T <span class="op">=</span> <span class="dv">300</span></a>
<a class="sourceLine" id="cb1396-26" title="26"></a>
<a class="sourceLine" id="cb1396-27" title="27">c_rms <span class="op">=</span> np.sqrt(<span class="fl">3.0</span><span class="op">*</span>R<span class="op">*</span>T<span class="op">/</span>M)</a>
<a class="sourceLine" id="cb1396-28" title="28"><span class="co">#print(&quot;rms speeds :&quot;, c_rms)</span></a>
<a class="sourceLine" id="cb1396-29" title="29"></a>
<a class="sourceLine" id="cb1396-30" title="30">M_in_kg <span class="op">=</span> M<span class="op">/</span><span class="fl">6.022e23</span></a>
<a class="sourceLine" id="cb1396-31" title="31"></a>
<a class="sourceLine" id="cb1396-32" title="32">c_rms_codex <span class="op">=</span> max_boltz_rms_speed(T,M_in_kg)</a>
<a class="sourceLine" id="cb1396-33" title="33"><span class="co">#print(&quot;rms speeds from codex :&quot;, c_rms_codex)</span></a>
<a class="sourceLine" id="cb1396-34" title="34"></a>
<a class="sourceLine" id="cb1396-35" title="35"><span class="co"># check</span></a>
<a class="sourceLine" id="cb1396-36" title="36"><span class="cf">if</span> np.isclose(c_rms,c_rms_codex,rtol<span class="op">=</span><span class="fl">0.01</span>):</a>
<a class="sourceLine" id="cb1396-37" title="37">    result <span class="op">=</span> <span class="va">True</span> </a>
<a class="sourceLine" id="cb1396-38" title="38"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb1396-39" title="39">    result <span class="op">=</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>michaelis</summary></p>
<h4 id="query-127">Query</h4>
<div class="sourceCode" id="cb1398"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1398-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb1398-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb1398-3" title="3"></a>
<a class="sourceLine" id="cb1398-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1398-5" title="5"><span class="co">compute sin(pi/2)</span></a>
<a class="sourceLine" id="cb1398-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1398-7" title="7">x <span class="op">=</span> math.sin(math.pi <span class="op">/</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1398-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1398-9" title="9"></a>
<a class="sourceLine" id="cb1398-10" title="10"><span class="kw">def</span> reaction_velocity(Vmax, S, Km):</a>
<a class="sourceLine" id="cb1398-11" title="11">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1398-12" title="12"><span class="co">   This function returns the initial reaction rate according to Michaelis-Menten kinetics</span></a>
<a class="sourceLine" id="cb1398-13" title="13"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1398-14" title="14">   </a></code></pre></div>
<h4 id="run-0-127">Run 0</h4>
<div class="sourceCode" id="cb1399"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1399-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb1399-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb1399-3" title="3"></a>
<a class="sourceLine" id="cb1399-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1399-5" title="5"><span class="co">compute sin(pi/2)</span></a>
<a class="sourceLine" id="cb1399-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1399-7" title="7">x <span class="op">=</span> math.sin(math.pi <span class="op">/</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1399-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1399-9" title="9"></a>
<a class="sourceLine" id="cb1399-10" title="10"><span class="kw">def</span> reaction_velocity(Vmax, S, Km):</a>
<a class="sourceLine" id="cb1399-11" title="11">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1399-12" title="12"><span class="co">   This function returns the initial reaction rate according to Michaelis-Menten kinetics</span></a>
<a class="sourceLine" id="cb1399-13" title="13"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1399-14" title="14">   <span class="cf">return</span> Vmax <span class="op">*</span> S <span class="op">/</span> (Km <span class="op">+</span> S)</a>
<a class="sourceLine" id="cb1399-15" title="15"></a>
<a class="sourceLine" id="cb1399-16" title="16"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1399-17" title="17"></a>
<a class="sourceLine" id="cb1399-18" title="18">Vmax<span class="op">=</span><span class="dv">10</span></a>
<a class="sourceLine" id="cb1399-19" title="19">K_M <span class="op">=</span> <span class="dv">2</span></a>
<a class="sourceLine" id="cb1399-20" title="20">S <span class="op">=</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb1399-21" title="21">v<span class="op">=</span>Vmax<span class="op">*</span>S<span class="op">/</span>(S<span class="op">+</span>K_M)</a>
<a class="sourceLine" id="cb1399-22" title="22"></a>
<a class="sourceLine" id="cb1399-23" title="23">v_codex <span class="op">=</span> reaction_velocity(Vmax, S, K_M)</a>
<a class="sourceLine" id="cb1399-24" title="24"></a>
<a class="sourceLine" id="cb1399-25" title="25"><span class="co"># check </span></a>
<a class="sourceLine" id="cb1399-26" title="26"><span class="cf">if</span> np.isclose(v, v_codex, rtol<span class="op">=</span><span class="fl">0.01</span>) <span class="op">==</span> <span class="va">True</span>:</a>
<a class="sourceLine" id="cb1399-27" title="27">    result <span class="op">=</span> <span class="va">True</span> </a>
<a class="sourceLine" id="cb1399-28" title="28"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb1399-29" title="29">    result <span class="op">=</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-127">Run 1</h4>
<div class="sourceCode" id="cb1401"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1401-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb1401-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb1401-3" title="3"></a>
<a class="sourceLine" id="cb1401-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1401-5" title="5"><span class="co">compute sin(pi/2)</span></a>
<a class="sourceLine" id="cb1401-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1401-7" title="7">x <span class="op">=</span> math.sin(math.pi <span class="op">/</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1401-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1401-9" title="9"></a>
<a class="sourceLine" id="cb1401-10" title="10"><span class="kw">def</span> reaction_velocity(Vmax, S, Km):</a>
<a class="sourceLine" id="cb1401-11" title="11">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1401-12" title="12"><span class="co">   This function returns the initial reaction rate according to Michaelis-Menten kinetics</span></a>
<a class="sourceLine" id="cb1401-13" title="13"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1401-14" title="14">   <span class="cf">return</span> Vmax <span class="op">*</span> S <span class="op">/</span> (Km <span class="op">+</span> S)</a>
<a class="sourceLine" id="cb1401-15" title="15"></a>
<a class="sourceLine" id="cb1401-16" title="16"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1401-17" title="17"></a>
<a class="sourceLine" id="cb1401-18" title="18">Vmax<span class="op">=</span><span class="dv">10</span></a>
<a class="sourceLine" id="cb1401-19" title="19">K_M <span class="op">=</span> <span class="dv">2</span></a>
<a class="sourceLine" id="cb1401-20" title="20">S <span class="op">=</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb1401-21" title="21">v<span class="op">=</span>Vmax<span class="op">*</span>S<span class="op">/</span>(S<span class="op">+</span>K_M)</a>
<a class="sourceLine" id="cb1401-22" title="22"></a>
<a class="sourceLine" id="cb1401-23" title="23">v_codex <span class="op">=</span> reaction_velocity(Vmax, S, K_M)</a>
<a class="sourceLine" id="cb1401-24" title="24"></a>
<a class="sourceLine" id="cb1401-25" title="25"><span class="co"># check </span></a>
<a class="sourceLine" id="cb1401-26" title="26"><span class="cf">if</span> np.isclose(v, v_codex, rtol<span class="op">=</span><span class="fl">0.01</span>) <span class="op">==</span> <span class="va">True</span>:</a>
<a class="sourceLine" id="cb1401-27" title="27">    result <span class="op">=</span> <span class="va">True</span> </a>
<a class="sourceLine" id="cb1401-28" title="28"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb1401-29" title="29">    result <span class="op">=</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-127">Run 2</h4>
<div class="sourceCode" id="cb1403"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1403-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb1403-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb1403-3" title="3"></a>
<a class="sourceLine" id="cb1403-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1403-5" title="5"><span class="co">compute sin(pi/2)</span></a>
<a class="sourceLine" id="cb1403-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1403-7" title="7">x <span class="op">=</span> math.sin(math.pi <span class="op">/</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1403-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1403-9" title="9"></a>
<a class="sourceLine" id="cb1403-10" title="10"><span class="kw">def</span> reaction_velocity(Vmax, S, Km):</a>
<a class="sourceLine" id="cb1403-11" title="11">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1403-12" title="12"><span class="co">   This function returns the initial reaction rate according to Michaelis-Menten kinetics</span></a>
<a class="sourceLine" id="cb1403-13" title="13"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1403-14" title="14">   <span class="cf">return</span> Vmax <span class="op">*</span> S <span class="op">/</span> (Km <span class="op">+</span> S)</a>
<a class="sourceLine" id="cb1403-15" title="15"></a>
<a class="sourceLine" id="cb1403-16" title="16"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1403-17" title="17"></a>
<a class="sourceLine" id="cb1403-18" title="18">Vmax<span class="op">=</span><span class="dv">10</span></a>
<a class="sourceLine" id="cb1403-19" title="19">K_M <span class="op">=</span> <span class="dv">2</span></a>
<a class="sourceLine" id="cb1403-20" title="20">S <span class="op">=</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb1403-21" title="21">v<span class="op">=</span>Vmax<span class="op">*</span>S<span class="op">/</span>(S<span class="op">+</span>K_M)</a>
<a class="sourceLine" id="cb1403-22" title="22"></a>
<a class="sourceLine" id="cb1403-23" title="23">v_codex <span class="op">=</span> reaction_velocity(Vmax, S, K_M)</a>
<a class="sourceLine" id="cb1403-24" title="24"></a>
<a class="sourceLine" id="cb1403-25" title="25"><span class="co"># check </span></a>
<a class="sourceLine" id="cb1403-26" title="26"><span class="cf">if</span> np.isclose(v, v_codex, rtol<span class="op">=</span><span class="fl">0.01</span>) <span class="op">==</span> <span class="va">True</span>:</a>
<a class="sourceLine" id="cb1403-27" title="27">    result <span class="op">=</span> <span class="va">True</span> </a>
<a class="sourceLine" id="cb1403-28" title="28"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb1403-29" title="29">    result <span class="op">=</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-127">Run 3</h4>
<div class="sourceCode" id="cb1405"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1405-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb1405-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb1405-3" title="3"></a>
<a class="sourceLine" id="cb1405-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1405-5" title="5"><span class="co">compute sin(pi/2)</span></a>
<a class="sourceLine" id="cb1405-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1405-7" title="7">x <span class="op">=</span> math.sin(math.pi <span class="op">/</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1405-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1405-9" title="9"></a>
<a class="sourceLine" id="cb1405-10" title="10"><span class="kw">def</span> reaction_velocity(Vmax, S, Km):</a>
<a class="sourceLine" id="cb1405-11" title="11">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1405-12" title="12"><span class="co">   This function returns the initial reaction rate according to Michaelis-Menten kinetics</span></a>
<a class="sourceLine" id="cb1405-13" title="13"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1405-14" title="14">   <span class="cf">return</span> Vmax <span class="op">*</span> S <span class="op">/</span> (Km <span class="op">+</span> S)</a>
<a class="sourceLine" id="cb1405-15" title="15"></a>
<a class="sourceLine" id="cb1405-16" title="16"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1405-17" title="17"></a>
<a class="sourceLine" id="cb1405-18" title="18">Vmax<span class="op">=</span><span class="dv">10</span></a>
<a class="sourceLine" id="cb1405-19" title="19">K_M <span class="op">=</span> <span class="dv">2</span></a>
<a class="sourceLine" id="cb1405-20" title="20">S <span class="op">=</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb1405-21" title="21">v<span class="op">=</span>Vmax<span class="op">*</span>S<span class="op">/</span>(S<span class="op">+</span>K_M)</a>
<a class="sourceLine" id="cb1405-22" title="22"></a>
<a class="sourceLine" id="cb1405-23" title="23">v_codex <span class="op">=</span> reaction_velocity(Vmax, S, K_M)</a>
<a class="sourceLine" id="cb1405-24" title="24"></a>
<a class="sourceLine" id="cb1405-25" title="25"><span class="co"># check </span></a>
<a class="sourceLine" id="cb1405-26" title="26"><span class="cf">if</span> np.isclose(v, v_codex, rtol<span class="op">=</span><span class="fl">0.01</span>) <span class="op">==</span> <span class="va">True</span>:</a>
<a class="sourceLine" id="cb1405-27" title="27">    result <span class="op">=</span> <span class="va">True</span> </a>
<a class="sourceLine" id="cb1405-28" title="28"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb1405-29" title="29">    result <span class="op">=</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-127">Run 4</h4>
<div class="sourceCode" id="cb1407"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1407-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb1407-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb1407-3" title="3"></a>
<a class="sourceLine" id="cb1407-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1407-5" title="5"><span class="co">compute sin(pi/2)</span></a>
<a class="sourceLine" id="cb1407-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1407-7" title="7">x <span class="op">=</span> math.sin(math.pi <span class="op">/</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1407-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1407-9" title="9"></a>
<a class="sourceLine" id="cb1407-10" title="10"><span class="kw">def</span> reaction_velocity(Vmax, S, Km):</a>
<a class="sourceLine" id="cb1407-11" title="11">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1407-12" title="12"><span class="co">   This function returns the initial reaction rate according to Michaelis-Menten kinetics</span></a>
<a class="sourceLine" id="cb1407-13" title="13"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1407-14" title="14">   <span class="cf">return</span> Vmax <span class="op">*</span> S <span class="op">/</span> (S <span class="op">+</span> Km)</a>
<a class="sourceLine" id="cb1407-15" title="15"></a>
<a class="sourceLine" id="cb1407-16" title="16"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1407-17" title="17"></a>
<a class="sourceLine" id="cb1407-18" title="18">Vmax<span class="op">=</span><span class="dv">10</span></a>
<a class="sourceLine" id="cb1407-19" title="19">K_M <span class="op">=</span> <span class="dv">2</span></a>
<a class="sourceLine" id="cb1407-20" title="20">S <span class="op">=</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb1407-21" title="21">v<span class="op">=</span>Vmax<span class="op">*</span>S<span class="op">/</span>(S<span class="op">+</span>K_M)</a>
<a class="sourceLine" id="cb1407-22" title="22"></a>
<a class="sourceLine" id="cb1407-23" title="23">v_codex <span class="op">=</span> reaction_velocity(Vmax, S, K_M)</a>
<a class="sourceLine" id="cb1407-24" title="24"></a>
<a class="sourceLine" id="cb1407-25" title="25"><span class="co"># check </span></a>
<a class="sourceLine" id="cb1407-26" title="26"><span class="cf">if</span> np.isclose(v, v_codex, rtol<span class="op">=</span><span class="fl">0.01</span>) <span class="op">==</span> <span class="va">True</span>:</a>
<a class="sourceLine" id="cb1407-27" title="27">    result <span class="op">=</span> <span class="va">True</span> </a>
<a class="sourceLine" id="cb1407-28" title="28"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb1407-29" title="29">    result <span class="op">=</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>mol_charge</summary></p>
<h4 id="query-128">Query</h4>
<div class="sourceCode" id="cb1409"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1409-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1409-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb1409-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb1409-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb1409-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb1409-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb1409-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb1409-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb1409-9" title="9"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb1409-10" title="10"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb1409-11" title="11"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1409-12" title="12"></a>
<a class="sourceLine" id="cb1409-13" title="13"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1409-14" title="14"><span class="co">print rdkit version</span></a>
<a class="sourceLine" id="cb1409-15" title="15"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1409-16" title="16"><span class="bu">print</span>(rdkit.__version__)</a>
<a class="sourceLine" id="cb1409-17" title="17"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1409-18" title="18"></a>
<a class="sourceLine" id="cb1409-19" title="19"><span class="kw">def</span> net_charge(smiles):</a>
<a class="sourceLine" id="cb1409-20" title="20">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1409-21" title="21"><span class="co">    This function returns net charge of given molecule</span></a>
<a class="sourceLine" id="cb1409-22" title="22"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1409-23" title="23">    </a></code></pre></div>
<h4 id="run-0-128">Run 0</h4>
<div class="sourceCode" id="cb1410"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1410-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1410-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb1410-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb1410-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb1410-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb1410-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb1410-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb1410-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb1410-9" title="9"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb1410-10" title="10"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb1410-11" title="11"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1410-12" title="12"></a>
<a class="sourceLine" id="cb1410-13" title="13"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1410-14" title="14"><span class="co">print rdkit version</span></a>
<a class="sourceLine" id="cb1410-15" title="15"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1410-16" title="16"><span class="bu">print</span>(rdkit.__version__)</a>
<a class="sourceLine" id="cb1410-17" title="17"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1410-18" title="18"></a>
<a class="sourceLine" id="cb1410-19" title="19"><span class="kw">def</span> net_charge(smiles):</a>
<a class="sourceLine" id="cb1410-20" title="20">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1410-21" title="21"><span class="co">    This function returns net charge of given molecule</span></a>
<a class="sourceLine" id="cb1410-22" title="22"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1410-23" title="23">    mol <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb1410-24" title="24">    <span class="cf">return</span> Chem.GetFormalCharge(mol)</a>
<a class="sourceLine" id="cb1410-25" title="25"></a>
<a class="sourceLine" id="cb1410-26" title="26"></a>
<a class="sourceLine" id="cb1410-27" title="27">s <span class="op">=</span> <span class="st">&#39;C1([O-])C=CC=C1NC2CCCCCC2C3=CC=CC=C3&#39;</span></a>
<a class="sourceLine" id="cb1410-28" title="28">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> net_charge(s) <span class="op">==</span> <span class="dv">-1</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-128">Run 1</h4>
<div class="sourceCode" id="cb1412"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1412-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1412-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb1412-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb1412-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb1412-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb1412-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb1412-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb1412-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb1412-9" title="9"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb1412-10" title="10"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb1412-11" title="11"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1412-12" title="12"></a>
<a class="sourceLine" id="cb1412-13" title="13"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1412-14" title="14"><span class="co">print rdkit version</span></a>
<a class="sourceLine" id="cb1412-15" title="15"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1412-16" title="16"><span class="bu">print</span>(rdkit.__version__)</a>
<a class="sourceLine" id="cb1412-17" title="17"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1412-18" title="18"></a>
<a class="sourceLine" id="cb1412-19" title="19"><span class="kw">def</span> net_charge(smiles):</a>
<a class="sourceLine" id="cb1412-20" title="20">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1412-21" title="21"><span class="co">    This function returns net charge of given molecule</span></a>
<a class="sourceLine" id="cb1412-22" title="22"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1412-23" title="23">    mol <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb1412-24" title="24">    <span class="cf">return</span> Chem.GetFormalCharge(mol)</a>
<a class="sourceLine" id="cb1412-25" title="25"></a>
<a class="sourceLine" id="cb1412-26" title="26"></a>
<a class="sourceLine" id="cb1412-27" title="27"></a>
<a class="sourceLine" id="cb1412-28" title="28">s <span class="op">=</span> <span class="st">&#39;C1([O-])C=CC=C1NC2CCCCCC2C3=CC=CC=C3&#39;</span></a>
<a class="sourceLine" id="cb1412-29" title="29">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> net_charge(s) <span class="op">==</span> <span class="dv">-1</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-128">Run 2</h4>
<div class="sourceCode" id="cb1414"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1414-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1414-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb1414-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb1414-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb1414-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb1414-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb1414-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb1414-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb1414-9" title="9"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb1414-10" title="10"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb1414-11" title="11"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1414-12" title="12"></a>
<a class="sourceLine" id="cb1414-13" title="13"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1414-14" title="14"><span class="co">print rdkit version</span></a>
<a class="sourceLine" id="cb1414-15" title="15"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1414-16" title="16"><span class="bu">print</span>(rdkit.__version__)</a>
<a class="sourceLine" id="cb1414-17" title="17"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1414-18" title="18"></a>
<a class="sourceLine" id="cb1414-19" title="19"><span class="kw">def</span> net_charge(smiles):</a>
<a class="sourceLine" id="cb1414-20" title="20">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1414-21" title="21"><span class="co">    This function returns net charge of given molecule</span></a>
<a class="sourceLine" id="cb1414-22" title="22"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1414-23" title="23">    mol <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb1414-24" title="24">    <span class="cf">return</span> Chem.GetFormalCharge(mol)</a>
<a class="sourceLine" id="cb1414-25" title="25"></a>
<a class="sourceLine" id="cb1414-26" title="26"></a>
<a class="sourceLine" id="cb1414-27" title="27">s <span class="op">=</span> <span class="st">&#39;C1([O-])C=CC=C1NC2CCCCCC2C3=CC=CC=C3&#39;</span></a>
<a class="sourceLine" id="cb1414-28" title="28">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> net_charge(s) <span class="op">==</span> <span class="dv">-1</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-128">Run 3</h4>
<div class="sourceCode" id="cb1416"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1416-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1416-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb1416-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb1416-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb1416-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb1416-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb1416-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb1416-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb1416-9" title="9"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb1416-10" title="10"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb1416-11" title="11"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1416-12" title="12"></a>
<a class="sourceLine" id="cb1416-13" title="13"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1416-14" title="14"><span class="co">print rdkit version</span></a>
<a class="sourceLine" id="cb1416-15" title="15"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1416-16" title="16"><span class="bu">print</span>(rdkit.__version__)</a>
<a class="sourceLine" id="cb1416-17" title="17"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1416-18" title="18"></a>
<a class="sourceLine" id="cb1416-19" title="19"><span class="kw">def</span> net_charge(smiles):</a>
<a class="sourceLine" id="cb1416-20" title="20">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1416-21" title="21"><span class="co">    This function returns net charge of given molecule</span></a>
<a class="sourceLine" id="cb1416-22" title="22"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1416-23" title="23">    mol <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb1416-24" title="24">    <span class="cf">return</span> Chem.GetFormalCharge(mol)</a>
<a class="sourceLine" id="cb1416-25" title="25"></a>
<a class="sourceLine" id="cb1416-26" title="26"></a>
<a class="sourceLine" id="cb1416-27" title="27">s <span class="op">=</span> <span class="st">&#39;C1([O-])C=CC=C1NC2CCCCCC2C3=CC=CC=C3&#39;</span></a>
<a class="sourceLine" id="cb1416-28" title="28">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> net_charge(s) <span class="op">==</span> <span class="dv">-1</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-128">Run 4</h4>
<div class="sourceCode" id="cb1418"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1418-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1418-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb1418-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb1418-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb1418-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb1418-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb1418-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb1418-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb1418-9" title="9"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb1418-10" title="10"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb1418-11" title="11"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1418-12" title="12"></a>
<a class="sourceLine" id="cb1418-13" title="13"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1418-14" title="14"><span class="co">print rdkit version</span></a>
<a class="sourceLine" id="cb1418-15" title="15"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1418-16" title="16"><span class="bu">print</span>(rdkit.__version__)</a>
<a class="sourceLine" id="cb1418-17" title="17"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1418-18" title="18"></a>
<a class="sourceLine" id="cb1418-19" title="19"><span class="kw">def</span> net_charge(smiles):</a>
<a class="sourceLine" id="cb1418-20" title="20">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1418-21" title="21"><span class="co">    This function returns net charge of given molecule</span></a>
<a class="sourceLine" id="cb1418-22" title="22"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1418-23" title="23">    mol <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb1418-24" title="24">    <span class="cf">return</span> mol.GetFormalCharge()</a>
<a class="sourceLine" id="cb1418-25" title="25"></a>
<a class="sourceLine" id="cb1418-26" title="26"></a>
<a class="sourceLine" id="cb1418-27" title="27"></a>
<a class="sourceLine" id="cb1418-28" title="28">s <span class="op">=</span> <span class="st">&#39;C1([O-])C=CC=C1NC2CCCCCC2C3=CC=CC=C3&#39;</span></a>
<a class="sourceLine" id="cb1418-29" title="29">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> net_charge(s) <span class="op">==</span> <span class="dv">-1</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>&#39;Mol&#39; object has no attribute &#39;GetFormalCharge&#39;</code></pre>
</details>
<details>
<p><summary>net_charge</summary></p>
<h4 id="query-129">Query</h4>
<div class="sourceCode" id="cb1420"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1420-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb1420-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb1420-3" title="3"></a>
<a class="sourceLine" id="cb1420-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1420-5" title="5"><span class="co">compute sin(pi/2)</span></a>
<a class="sourceLine" id="cb1420-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1420-7" title="7">x <span class="op">=</span> math.sin(math.pi <span class="op">/</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1420-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1420-9" title="9"></a>
<a class="sourceLine" id="cb1420-10" title="10"><span class="kw">def</span> net_charge(sequence):</a>
<a class="sourceLine" id="cb1420-11" title="11">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1420-12" title="12"><span class="co">    This function returns net charge of amino acid sequence</span></a>
<a class="sourceLine" id="cb1420-13" title="13"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1420-14" title="14">    </a></code></pre></div>
<h4 id="run-0-129">Run 0</h4>
<div class="sourceCode" id="cb1421"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1421-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb1421-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb1421-3" title="3"></a>
<a class="sourceLine" id="cb1421-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1421-5" title="5"><span class="co">compute sin(pi/2)</span></a>
<a class="sourceLine" id="cb1421-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1421-7" title="7">x <span class="op">=</span> math.sin(math.pi <span class="op">/</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1421-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1421-9" title="9"></a>
<a class="sourceLine" id="cb1421-10" title="10"><span class="kw">def</span> net_charge(sequence):</a>
<a class="sourceLine" id="cb1421-11" title="11">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1421-12" title="12"><span class="co">    This function returns net charge of amino acid sequence</span></a>
<a class="sourceLine" id="cb1421-13" title="13"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1421-14" title="14">    <span class="co"># start</span></a>
<a class="sourceLine" id="cb1421-15" title="15">    charge <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb1421-16" title="16">    <span class="cf">for</span> aa <span class="kw">in</span> sequence:</a>
<a class="sourceLine" id="cb1421-17" title="17">        <span class="cf">if</span> aa <span class="op">==</span> <span class="st">&#39;K&#39;</span> <span class="kw">or</span> aa <span class="op">==</span> <span class="st">&#39;R&#39;</span>:</a>
<a class="sourceLine" id="cb1421-18" title="18">            charge <span class="op">+=</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb1421-19" title="19">        <span class="cf">elif</span> aa <span class="op">==</span> <span class="st">&#39;D&#39;</span> <span class="kw">or</span> aa <span class="op">==</span> <span class="st">&#39;E&#39;</span>:</a>
<a class="sourceLine" id="cb1421-20" title="20">            charge <span class="op">-=</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb1421-21" title="21">    <span class="cf">return</span> charge</a>
<a class="sourceLine" id="cb1421-22" title="22">    </a>
<a class="sourceLine" id="cb1421-23" title="23"></a>
<a class="sourceLine" id="cb1421-24" title="24">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> net_charge(<span class="st">&quot;DSAVRCPQD&quot;</span>) <span class="op">==</span> <span class="dv">-1</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-129">Run 1</h4>
<div class="sourceCode" id="cb1423"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1423-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb1423-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb1423-3" title="3"></a>
<a class="sourceLine" id="cb1423-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1423-5" title="5"><span class="co">compute sin(pi/2)</span></a>
<a class="sourceLine" id="cb1423-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1423-7" title="7">x <span class="op">=</span> math.sin(math.pi <span class="op">/</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1423-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1423-9" title="9"></a>
<a class="sourceLine" id="cb1423-10" title="10"><span class="kw">def</span> net_charge(sequence):</a>
<a class="sourceLine" id="cb1423-11" title="11">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1423-12" title="12"><span class="co">    This function returns net charge of amino acid sequence</span></a>
<a class="sourceLine" id="cb1423-13" title="13"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1423-14" title="14">    <span class="co"># start</span></a>
<a class="sourceLine" id="cb1423-15" title="15">    charge <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb1423-16" title="16">    <span class="cf">for</span> aa <span class="kw">in</span> sequence:</a>
<a class="sourceLine" id="cb1423-17" title="17">        <span class="cf">if</span> aa <span class="op">==</span> <span class="st">&#39;K&#39;</span>:</a>
<a class="sourceLine" id="cb1423-18" title="18">            charge <span class="op">+=</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb1423-19" title="19">        <span class="cf">elif</span> aa <span class="op">==</span> <span class="st">&#39;R&#39;</span>:</a>
<a class="sourceLine" id="cb1423-20" title="20">            charge <span class="op">+=</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb1423-21" title="21">        <span class="cf">elif</span> aa <span class="op">==</span> <span class="st">&#39;D&#39;</span>:</a>
<a class="sourceLine" id="cb1423-22" title="22">            charge <span class="op">-=</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb1423-23" title="23">        <span class="cf">elif</span> aa <span class="op">==</span> <span class="st">&#39;E&#39;</span>:</a>
<a class="sourceLine" id="cb1423-24" title="24">            charge <span class="op">-=</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb1423-25" title="25">    <span class="cf">return</span> charge</a>
<a class="sourceLine" id="cb1423-26" title="26">    </a>
<a class="sourceLine" id="cb1423-27" title="27"></a>
<a class="sourceLine" id="cb1423-28" title="28">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> net_charge(<span class="st">&quot;DSAVRCPQD&quot;</span>) <span class="op">==</span> <span class="dv">-1</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-129">Run 2</h4>
<div class="sourceCode" id="cb1425"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1425-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb1425-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb1425-3" title="3"></a>
<a class="sourceLine" id="cb1425-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1425-5" title="5"><span class="co">compute sin(pi/2)</span></a>
<a class="sourceLine" id="cb1425-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1425-7" title="7">x <span class="op">=</span> math.sin(math.pi <span class="op">/</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1425-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1425-9" title="9"></a>
<a class="sourceLine" id="cb1425-10" title="10"><span class="kw">def</span> net_charge(sequence):</a>
<a class="sourceLine" id="cb1425-11" title="11">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1425-12" title="12"><span class="co">    This function returns net charge of amino acid sequence</span></a>
<a class="sourceLine" id="cb1425-13" title="13"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1425-14" title="14">    charge <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb1425-15" title="15">    <span class="cf">for</span> i <span class="kw">in</span> sequence:</a>
<a class="sourceLine" id="cb1425-16" title="16">        <span class="cf">if</span> i <span class="op">==</span> <span class="st">&#39;K&#39;</span> <span class="kw">or</span> i <span class="op">==</span> <span class="st">&#39;R&#39;</span>:</a>
<a class="sourceLine" id="cb1425-17" title="17">            charge <span class="op">+=</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb1425-18" title="18">        <span class="cf">elif</span> i <span class="op">==</span> <span class="st">&#39;D&#39;</span> <span class="kw">or</span> i <span class="op">==</span> <span class="st">&#39;E&#39;</span>:</a>
<a class="sourceLine" id="cb1425-19" title="19">            charge <span class="op">-=</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb1425-20" title="20">    <span class="cf">return</span> charge</a>
<a class="sourceLine" id="cb1425-21" title="21"></a>
<a class="sourceLine" id="cb1425-22" title="22"></a>
<a class="sourceLine" id="cb1425-23" title="23">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> net_charge(<span class="st">&quot;DSAVRCPQD&quot;</span>) <span class="op">==</span> <span class="dv">-1</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-129">Run 3</h4>
<div class="sourceCode" id="cb1427"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1427-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb1427-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb1427-3" title="3"></a>
<a class="sourceLine" id="cb1427-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1427-5" title="5"><span class="co">compute sin(pi/2)</span></a>
<a class="sourceLine" id="cb1427-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1427-7" title="7">x <span class="op">=</span> math.sin(math.pi <span class="op">/</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1427-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1427-9" title="9"></a>
<a class="sourceLine" id="cb1427-10" title="10"><span class="kw">def</span> net_charge(sequence):</a>
<a class="sourceLine" id="cb1427-11" title="11">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1427-12" title="12"><span class="co">    This function returns net charge of amino acid sequence</span></a>
<a class="sourceLine" id="cb1427-13" title="13"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1427-14" title="14">    charge <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb1427-15" title="15">    <span class="cf">for</span> aa <span class="kw">in</span> sequence:</a>
<a class="sourceLine" id="cb1427-16" title="16">        <span class="cf">if</span> aa <span class="op">==</span> <span class="st">&#39;K&#39;</span> <span class="kw">or</span> aa <span class="op">==</span> <span class="st">&#39;R&#39;</span>:</a>
<a class="sourceLine" id="cb1427-17" title="17">            charge <span class="op">+=</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb1427-18" title="18">        <span class="cf">elif</span> aa <span class="op">==</span> <span class="st">&#39;D&#39;</span> <span class="kw">or</span> aa <span class="op">==</span> <span class="st">&#39;E&#39;</span>:</a>
<a class="sourceLine" id="cb1427-19" title="19">            charge <span class="op">-=</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb1427-20" title="20">    <span class="cf">return</span> charge</a>
<a class="sourceLine" id="cb1427-21" title="21"></a>
<a class="sourceLine" id="cb1427-22" title="22"></a>
<a class="sourceLine" id="cb1427-23" title="23"></a>
<a class="sourceLine" id="cb1427-24" title="24">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> net_charge(<span class="st">&quot;DSAVRCPQD&quot;</span>) <span class="op">==</span> <span class="dv">-1</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-129">Run 4</h4>
<div class="sourceCode" id="cb1429"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1429-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb1429-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb1429-3" title="3"></a>
<a class="sourceLine" id="cb1429-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1429-5" title="5"><span class="co">compute sin(pi/2)</span></a>
<a class="sourceLine" id="cb1429-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1429-7" title="7">x <span class="op">=</span> math.sin(math.pi <span class="op">/</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1429-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1429-9" title="9"></a>
<a class="sourceLine" id="cb1429-10" title="10"><span class="kw">def</span> net_charge(sequence):</a>
<a class="sourceLine" id="cb1429-11" title="11">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1429-12" title="12"><span class="co">    This function returns net charge of amino acid sequence</span></a>
<a class="sourceLine" id="cb1429-13" title="13"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1429-14" title="14">    charge <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb1429-15" title="15">    <span class="cf">for</span> i <span class="kw">in</span> sequence:</a>
<a class="sourceLine" id="cb1429-16" title="16">        <span class="cf">if</span> i <span class="op">==</span> <span class="st">&quot;K&quot;</span> <span class="kw">or</span> i <span class="op">==</span> <span class="st">&quot;R&quot;</span>:</a>
<a class="sourceLine" id="cb1429-17" title="17">            charge <span class="op">+=</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb1429-18" title="18">        <span class="cf">elif</span> i <span class="op">==</span> <span class="st">&quot;D&quot;</span> <span class="kw">or</span> i <span class="op">==</span> <span class="st">&quot;E&quot;</span>:</a>
<a class="sourceLine" id="cb1429-19" title="19">            charge <span class="op">-=</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb1429-20" title="20">        <span class="cf">else</span>:</a>
<a class="sourceLine" id="cb1429-21" title="21">            charge <span class="op">+=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb1429-22" title="22">    <span class="cf">return</span> charge</a>
<a class="sourceLine" id="cb1429-23" title="23"></a>
<a class="sourceLine" id="cb1429-24" title="24"></a>
<a class="sourceLine" id="cb1429-25" title="25"></a>
<a class="sourceLine" id="cb1429-26" title="26">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> net_charge(<span class="st">&quot;DSAVRCPQD&quot;</span>) <span class="op">==</span> <span class="dv">-1</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>solve_ode</summary></p>
<h4 id="query-130">Query</h4>
<div class="sourceCode" id="cb1431"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1431-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1431-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1431-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1431-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1431-5" title="5"></a>
<a class="sourceLine" id="cb1431-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1431-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1431-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1431-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1431-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1431-11" title="11"></a>
<a class="sourceLine" id="cb1431-12" title="12"><span class="kw">def</span> solve_ode(fn, t, y0):</a>
<a class="sourceLine" id="cb1431-13" title="13">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1431-14" title="14"><span class="co">    Solve an initial value problem for system of Ordinary Differential Equations using the Explicit Runge-Kutta method of order 5. t is a 1D vector and dy/dt=fn(t,y). Returns the values of the solution y at t.</span></a>
<a class="sourceLine" id="cb1431-15" title="15"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1431-16" title="16">    </a></code></pre></div>
<h4 id="run-0-130">Run 0</h4>
<div class="sourceCode" id="cb1432"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1432-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1432-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1432-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1432-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1432-5" title="5"></a>
<a class="sourceLine" id="cb1432-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1432-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1432-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1432-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1432-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1432-11" title="11"></a>
<a class="sourceLine" id="cb1432-12" title="12"><span class="kw">def</span> solve_ode(fn, t, y0):</a>
<a class="sourceLine" id="cb1432-13" title="13">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1432-14" title="14"><span class="co">    Solve an initial value problem for system of Ordinary Differential Equations using the Explicit Runge-Kutta method of order 5. t is a 1D vector and dy/dt=fn(t,y). Returns the values of the solution y at t.</span></a>
<a class="sourceLine" id="cb1432-15" title="15"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1432-16" title="16">    y <span class="op">=</span> np.zeros((<span class="bu">len</span>(t), <span class="bu">len</span>(y0)))</a>
<a class="sourceLine" id="cb1432-17" title="17">    y[<span class="dv">0</span>,:] <span class="op">=</span> y0</a>
<a class="sourceLine" id="cb1432-18" title="18">    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(t)<span class="op">-</span><span class="dv">1</span>):</a>
<a class="sourceLine" id="cb1432-19" title="19">        h <span class="op">=</span> t[i<span class="op">+</span><span class="dv">1</span>] <span class="op">-</span> t[i]</a>
<a class="sourceLine" id="cb1432-20" title="20">        k1 <span class="op">=</span> h<span class="op">*</span>fn(t[i], y[i,:])</a>
<a class="sourceLine" id="cb1432-21" title="21">        k2 <span class="op">=</span> h<span class="op">*</span>fn(t[i] <span class="op">+</span> h<span class="op">/</span><span class="dv">4</span>, y[i,:] <span class="op">+</span> k1<span class="op">/</span><span class="dv">4</span>)</a>
<a class="sourceLine" id="cb1432-22" title="22">        k3 <span class="op">=</span> h<span class="op">*</span>fn(t[i] <span class="op">+</span> <span class="dv">3</span><span class="op">*</span>h<span class="op">/</span><span class="dv">8</span>, y[i,:] <span class="op">+</span> <span class="dv">3</span><span class="op">*</span>k1<span class="op">/</span><span class="dv">32</span> <span class="op">+</span> <span class="dv">9</span><span class="op">*</span>k2<span class="op">/</span><span class="dv">32</span>)</a>
<a class="sourceLine" id="cb1432-23" title="23">        k4 <span class="op">=</span> h<span class="op">*</span>fn(t[i] <span class="op">+</span> <span class="dv">12</span><span class="op">*</span>h<span class="op">/</span><span class="dv">13</span>, y[i,:] <span class="op">+</span> <span class="dv">1932</span><span class="op">*</span>k1<span class="op">/</span><span class="dv">2197</span> <span class="op">-</span> <span class="dv">7200</span><span class="op">*</span>k2<span class="op">/</span><span class="dv">2197</span> <span class="op">+</span> <span class="dv">7296</span><span class="op">*</span>k3<span class="op">/</span><span class="dv">2197</span>)</a>
<a class="sourceLine" id="cb1432-24" title="24">        k5 <span class="op">=</span> h<span class="op">*</span>fn(t[i] <span class="op">+</span> h, y[i,:] <span class="op">+</span> <span class="dv">439</span><span class="op">*</span>k1<span class="op">/</span><span class="dv">216</span> <span class="op">-</span> <span class="dv">8</span><span class="op">*</span>k2 <span class="op">+</span> <span class="dv">3680</span><span class="op">*</span>k3<span class="op">/</span><span class="dv">513</span> <span class="op">-</span> <span class="dv">845</span><span class="op">*</span>k4<span class="op">/</span><span class="dv">4104</span>)</a>
<a class="sourceLine" id="cb1432-25" title="25">        k6 <span class="op">=</span> h<span class="op">*</span>fn(t[i] <span class="op">+</span> h<span class="op">/</span><span class="dv">2</span>, y[i,:] <span class="op">-</span> <span class="dv">8</span><span class="op">*</span>k1<span class="op">/</span><span class="dv">27</span> <span class="op">+</span> <span class="dv">2</span><span class="op">*</span>k2 <span class="op">-</span> <span class="dv">3544</span><span class="op">*</span>k3<span class="op">/</span><span class="dv">2565</span> <span class="op">+</span> <span class="dv">1859</span><span class="op">*</span>k4<span class="op">/</span><span class="dv">4104</span> <span class="op">-</span> <span class="dv">11</span><span class="op">*</span>k5<span class="op">/</span><span class="dv">40</span>)</a>
<a class="sourceLine" id="cb1432-26" title="26">        y[i<span class="op">+</span><span class="dv">1</span>,:] <span class="op">=</span> y[i,:] <span class="op">+</span> <span class="dv">25</span><span class="op">*</span>k1<span class="op">/</span><span class="dv">216</span> <span class="op">+</span> <span class="dv">1408</span><span class="op">*</span>k3<span class="op">/</span><span class="dv">2565</span> <span class="op">+</span> <span class="dv">2197</span><span class="op">*</span>k4<span class="op">/</span><span class="dv">4104</span> <span class="op">-</span> k5<span class="op">/</span><span class="dv">5</span></a>
<a class="sourceLine" id="cb1432-27" title="27">    <span class="cf">return</span> y</a>
<a class="sourceLine" id="cb1432-28" title="28"></a>
<a class="sourceLine" id="cb1432-29" title="29"><span class="im">from</span> scipy.integrate <span class="im">import</span> solve_ivp</a>
<a class="sourceLine" id="cb1432-30" title="30"><span class="kw">def</span> exponential_decay(t, y): </a>
<a class="sourceLine" id="cb1432-31" title="31">    <span class="cf">return</span> <span class="fl">-0.5</span> <span class="op">*</span> y</a>
<a class="sourceLine" id="cb1432-32" title="32">solution <span class="op">=</span> solve_ivp(exponential_decay, [<span class="dv">0</span>, <span class="dv">10</span>], [<span class="dv">4</span>], t_eval<span class="op">=</span>[<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">8</span>])</a>
<a class="sourceLine" id="cb1432-33" title="33"></a>
<a class="sourceLine" id="cb1432-34" title="34">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.allclose(solution, solve_ode(exponential_decay, [<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">8</span>], [<span class="dv">4</span>])) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>ufunc &#39;isfinite&#39; not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule &#39;&#39;safe&#39;&#39;</code></pre>
<h4 id="run-1-130">Run 1</h4>
<div class="sourceCode" id="cb1434"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1434-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1434-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1434-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1434-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1434-5" title="5"></a>
<a class="sourceLine" id="cb1434-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1434-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1434-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1434-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1434-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1434-11" title="11"></a>
<a class="sourceLine" id="cb1434-12" title="12"><span class="kw">def</span> solve_ode(fn, t, y0):</a>
<a class="sourceLine" id="cb1434-13" title="13">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1434-14" title="14"><span class="co">    Solve an initial value problem for system of Ordinary Differential Equations using the Explicit Runge-Kutta method of order 5. t is a 1D vector and dy/dt=fn(t,y). Returns the values of the solution y at t.</span></a>
<a class="sourceLine" id="cb1434-15" title="15"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1434-16" title="16">    y <span class="op">=</span> np.zeros((<span class="bu">len</span>(t), <span class="bu">len</span>(y0)))</a>
<a class="sourceLine" id="cb1434-17" title="17">    y[<span class="dv">0</span>] <span class="op">=</span> y0</a>
<a class="sourceLine" id="cb1434-18" title="18">    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(t)<span class="op">-</span><span class="dv">1</span>):</a>
<a class="sourceLine" id="cb1434-19" title="19">        h <span class="op">=</span> t[i<span class="op">+</span><span class="dv">1</span>] <span class="op">-</span> t[i]</a>
<a class="sourceLine" id="cb1434-20" title="20">        k1 <span class="op">=</span> fn(t[i], y[i])</a>
<a class="sourceLine" id="cb1434-21" title="21">        k2 <span class="op">=</span> fn(t[i] <span class="op">+</span> h<span class="op">/</span><span class="dv">4</span>, y[i] <span class="op">+</span> h<span class="op">/</span><span class="dv">4</span><span class="op">*</span>k1)</a>
<a class="sourceLine" id="cb1434-22" title="22">        k3 <span class="op">=</span> fn(t[i] <span class="op">+</span> <span class="dv">3</span><span class="op">*</span>h<span class="op">/</span><span class="dv">8</span>, y[i] <span class="op">+</span> <span class="dv">3</span><span class="op">*</span>h<span class="op">/</span><span class="dv">32</span><span class="op">*</span>k1 <span class="op">+</span> <span class="dv">9</span><span class="op">*</span>h<span class="op">/</span><span class="dv">32</span><span class="op">*</span>k2)</a>
<a class="sourceLine" id="cb1434-23" title="23">        k4 <span class="op">=</span> fn(t[i] <span class="op">+</span> <span class="dv">12</span><span class="op">*</span>h<span class="op">/</span><span class="dv">13</span>, y[i] <span class="op">+</span> <span class="dv">1932</span><span class="op">*</span>h<span class="op">/</span><span class="dv">2197</span><span class="op">*</span>k1 <span class="op">-</span> <span class="dv">7200</span><span class="op">*</span>h<span class="op">/</span><span class="dv">2197</span><span class="op">*</span>k2 <span class="op">+</span> <span class="dv">7296</span><span class="op">*</span>h<span class="op">/</span><span class="dv">2197</span><span class="op">*</span>k3)</a>
<a class="sourceLine" id="cb1434-24" title="24">        k5 <span class="op">=</span> fn(t[i] <span class="op">+</span> h, y[i] <span class="op">+</span> <span class="dv">439</span><span class="op">*</span>h<span class="op">/</span><span class="dv">216</span><span class="op">*</span>k1 <span class="op">-</span> <span class="dv">8</span><span class="op">*</span>h<span class="op">*</span>k2 <span class="op">+</span> <span class="dv">3680</span><span class="op">*</span>h<span class="op">/</span><span class="dv">513</span><span class="op">*</span>k3 <span class="op">-</span> <span class="dv">845</span><span class="op">*</span>h<span class="op">/</span><span class="dv">4104</span><span class="op">*</span>k4)</a>
<a class="sourceLine" id="cb1434-25" title="25">        k6 <span class="op">=</span> fn(t[i] <span class="op">+</span> h<span class="op">/</span><span class="dv">2</span>, y[i] <span class="op">-</span> <span class="dv">8</span><span class="op">*</span>h<span class="op">/</span><span class="dv">27</span><span class="op">*</span>k1 <span class="op">+</span> <span class="dv">2</span><span class="op">*</span>h<span class="op">*</span>k2 <span class="op">-</span> <span class="dv">3544</span><span class="op">*</span>h<span class="op">/</span><span class="dv">2565</span><span class="op">*</span>k3 <span class="op">+</span> <span class="dv">1859</span><span class="op">*</span>h<span class="op">/</span><span class="dv">4104</span><span class="op">*</span>k4 <span class="op">-</span> <span class="dv">11</span><span class="op">*</span>h<span class="op">/</span><span class="dv">40</span><span class="op">*</span>k5)</a>
<a class="sourceLine" id="cb1434-26" title="26">        y[i<span class="op">+</span><span class="dv">1</span>] <span class="op">=</span> y[i] <span class="op">+</span> h<span class="op">/</span><span class="dv">6</span><span class="op">*</span>(<span class="dv">25</span><span class="op">*</span>k1<span class="op">/</span><span class="dv">216</span> <span class="op">+</span> <span class="dv">1408</span><span class="op">*</span>k3<span class="op">/</span><span class="dv">2565</span> <span class="op">+</span> <span class="dv">2197</span><span class="op">*</span>k4<span class="op">/</span><span class="dv">4104</span> <span class="op">-</span> k5<span class="op">/</span><span class="dv">5</span>)</a>
<a class="sourceLine" id="cb1434-27" title="27">    <span class="cf">return</span> y</a>
<a class="sourceLine" id="cb1434-28" title="28"></a>
<a class="sourceLine" id="cb1434-29" title="29"><span class="im">from</span> scipy.integrate <span class="im">import</span> solve_ivp</a>
<a class="sourceLine" id="cb1434-30" title="30"><span class="kw">def</span> exponential_decay(t, y): </a>
<a class="sourceLine" id="cb1434-31" title="31">    <span class="cf">return</span> <span class="fl">-0.5</span> <span class="op">*</span> y</a>
<a class="sourceLine" id="cb1434-32" title="32">solution <span class="op">=</span> solve_ivp(exponential_decay, [<span class="dv">0</span>, <span class="dv">10</span>], [<span class="dv">4</span>], t_eval<span class="op">=</span>[<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">8</span>])</a>
<a class="sourceLine" id="cb1434-33" title="33"></a>
<a class="sourceLine" id="cb1434-34" title="34">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.allclose(solution, solve_ode(exponential_decay, [<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">8</span>], [<span class="dv">4</span>])) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>ufunc &#39;isfinite&#39; not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule &#39;&#39;safe&#39;&#39;</code></pre>
<h4 id="run-2-130">Run 2</h4>
<div class="sourceCode" id="cb1436"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1436-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1436-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1436-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1436-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1436-5" title="5"></a>
<a class="sourceLine" id="cb1436-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1436-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1436-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1436-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1436-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1436-11" title="11"></a>
<a class="sourceLine" id="cb1436-12" title="12"><span class="kw">def</span> solve_ode(fn, t, y0):</a>
<a class="sourceLine" id="cb1436-13" title="13">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1436-14" title="14"><span class="co">    Solve an initial value problem for system of Ordinary Differential Equations using the Explicit Runge-Kutta method of order 5. t is a 1D vector and dy/dt=fn(t,y). Returns the values of the solution y at t.</span></a>
<a class="sourceLine" id="cb1436-15" title="15"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1436-16" title="16">    y <span class="op">=</span> np.zeros((<span class="bu">len</span>(t), <span class="bu">len</span>(y0)))</a>
<a class="sourceLine" id="cb1436-17" title="17">    y[<span class="dv">0</span>] <span class="op">=</span> y0</a>
<a class="sourceLine" id="cb1436-18" title="18">    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(t)<span class="op">-</span><span class="dv">1</span>):</a>
<a class="sourceLine" id="cb1436-19" title="19">        h <span class="op">=</span> t[i<span class="op">+</span><span class="dv">1</span>] <span class="op">-</span> t[i]</a>
<a class="sourceLine" id="cb1436-20" title="20">        k1 <span class="op">=</span> h <span class="op">*</span> fn(t[i], y[i])</a>
<a class="sourceLine" id="cb1436-21" title="21">        k2 <span class="op">=</span> h <span class="op">*</span> fn(t[i] <span class="op">+</span> h<span class="op">/</span><span class="dv">4</span>, y[i] <span class="op">+</span> k1<span class="op">/</span><span class="dv">4</span>)</a>
<a class="sourceLine" id="cb1436-22" title="22">        k3 <span class="op">=</span> h <span class="op">*</span> fn(t[i] <span class="op">+</span> <span class="dv">3</span><span class="op">*</span>h<span class="op">/</span><span class="dv">8</span>, y[i] <span class="op">+</span> <span class="dv">3</span><span class="op">*</span>k1<span class="op">/</span><span class="dv">32</span> <span class="op">+</span> <span class="dv">9</span><span class="op">*</span>k2<span class="op">/</span><span class="dv">32</span>)</a>
<a class="sourceLine" id="cb1436-23" title="23">        k4 <span class="op">=</span> h <span class="op">*</span> fn(t[i] <span class="op">+</span> <span class="dv">12</span><span class="op">*</span>h<span class="op">/</span><span class="dv">13</span>, y[i] <span class="op">+</span> <span class="dv">1932</span><span class="op">*</span>k1<span class="op">/</span><span class="dv">2197</span> <span class="op">-</span> <span class="dv">7200</span><span class="op">*</span>k2<span class="op">/</span><span class="dv">2197</span> <span class="op">+</span> <span class="dv">7296</span><span class="op">*</span>k3<span class="op">/</span><span class="dv">2197</span>)</a>
<a class="sourceLine" id="cb1436-24" title="24">        k5 <span class="op">=</span> h <span class="op">*</span> fn(t[i] <span class="op">+</span> h, y[i] <span class="op">+</span> <span class="dv">439</span><span class="op">*</span>k1<span class="op">/</span><span class="dv">216</span> <span class="op">-</span> <span class="dv">8</span><span class="op">*</span>k2 <span class="op">+</span> <span class="dv">3680</span><span class="op">*</span>k3<span class="op">/</span><span class="dv">513</span> <span class="op">-</span> <span class="dv">845</span><span class="op">*</span>k4<span class="op">/</span><span class="dv">4104</span>)</a>
<a class="sourceLine" id="cb1436-25" title="25">        k6 <span class="op">=</span> h <span class="op">*</span> fn(t[i] <span class="op">+</span> h<span class="op">/</span><span class="dv">2</span>, y[i] <span class="op">-</span> <span class="dv">8</span><span class="op">*</span>k1<span class="op">/</span><span class="dv">27</span> <span class="op">+</span> <span class="dv">2</span><span class="op">*</span>k2 <span class="op">-</span> <span class="dv">3544</span><span class="op">*</span>k3<span class="op">/</span><span class="dv">2565</span> <span class="op">+</span> <span class="dv">1859</span><span class="op">*</span>k4<span class="op">/</span><span class="dv">4104</span> <span class="op">-</span> <span class="dv">11</span><span class="op">*</span>k5<span class="op">/</span><span class="dv">40</span>)</a>
<a class="sourceLine" id="cb1436-26" title="26">        y[i<span class="op">+</span><span class="dv">1</span>] <span class="op">=</span> y[i] <span class="op">+</span> <span class="dv">25</span><span class="op">*</span>k1<span class="op">/</span><span class="dv">216</span> <span class="op">+</span> <span class="dv">1408</span><span class="op">*</span>k3<span class="op">/</span><span class="dv">2565</span> <span class="op">+</span> <span class="dv">2197</span><span class="op">*</span>k4<span class="op">/</span><span class="dv">4104</span> <span class="op">-</span> k5<span class="op">/</span><span class="dv">5</span></a>
<a class="sourceLine" id="cb1436-27" title="27">    <span class="cf">return</span> y</a>
<a class="sourceLine" id="cb1436-28" title="28"></a>
<a class="sourceLine" id="cb1436-29" title="29"><span class="im">from</span> scipy.integrate <span class="im">import</span> solve_ivp</a>
<a class="sourceLine" id="cb1436-30" title="30"><span class="kw">def</span> exponential_decay(t, y): </a>
<a class="sourceLine" id="cb1436-31" title="31">    <span class="cf">return</span> <span class="fl">-0.5</span> <span class="op">*</span> y</a>
<a class="sourceLine" id="cb1436-32" title="32">solution <span class="op">=</span> solve_ivp(exponential_decay, [<span class="dv">0</span>, <span class="dv">10</span>], [<span class="dv">4</span>], t_eval<span class="op">=</span>[<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">8</span>])</a>
<a class="sourceLine" id="cb1436-33" title="33"></a>
<a class="sourceLine" id="cb1436-34" title="34">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.allclose(solution, solve_ode(exponential_decay, [<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">8</span>], [<span class="dv">4</span>])) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>ufunc &#39;isfinite&#39; not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule &#39;&#39;safe&#39;&#39;</code></pre>
<h4 id="run-3-130">Run 3</h4>
<div class="sourceCode" id="cb1438"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1438-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1438-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1438-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1438-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1438-5" title="5"></a>
<a class="sourceLine" id="cb1438-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1438-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1438-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1438-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1438-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1438-11" title="11"></a>
<a class="sourceLine" id="cb1438-12" title="12"><span class="kw">def</span> solve_ode(fn, t, y0):</a>
<a class="sourceLine" id="cb1438-13" title="13">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1438-14" title="14"><span class="co">    Solve an initial value problem for system of Ordinary Differential Equations using the Explicit Runge-Kutta method of order 5. t is a 1D vector and dy/dt=fn(t,y). Returns the values of the solution y at t.</span></a>
<a class="sourceLine" id="cb1438-15" title="15"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1438-16" title="16">    y <span class="op">=</span> np.zeros((<span class="bu">len</span>(t), <span class="bu">len</span>(y0)))</a>
<a class="sourceLine" id="cb1438-17" title="17">    y[<span class="dv">0</span>,:] <span class="op">=</span> y0</a>
<a class="sourceLine" id="cb1438-18" title="18">    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(t)<span class="op">-</span><span class="dv">1</span>):</a>
<a class="sourceLine" id="cb1438-19" title="19">        h <span class="op">=</span> t[i<span class="op">+</span><span class="dv">1</span>] <span class="op">-</span> t[i]</a>
<a class="sourceLine" id="cb1438-20" title="20">        k1 <span class="op">=</span> h<span class="op">*</span>fn(t[i], y[i,:])</a>
<a class="sourceLine" id="cb1438-21" title="21">        k2 <span class="op">=</span> h<span class="op">*</span>fn(t[i] <span class="op">+</span> h<span class="op">/</span><span class="dv">4</span>, y[i,:] <span class="op">+</span> k1<span class="op">/</span><span class="dv">4</span>)</a>
<a class="sourceLine" id="cb1438-22" title="22">        k3 <span class="op">=</span> h<span class="op">*</span>fn(t[i] <span class="op">+</span> <span class="dv">3</span><span class="op">*</span>h<span class="op">/</span><span class="dv">8</span>, y[i,:] <span class="op">+</span> <span class="dv">3</span><span class="op">*</span>k1<span class="op">/</span><span class="dv">32</span> <span class="op">+</span> <span class="dv">9</span><span class="op">*</span>k2<span class="op">/</span><span class="dv">32</span>)</a>
<a class="sourceLine" id="cb1438-23" title="23">        k4 <span class="op">=</span> h<span class="op">*</span>fn(t[i] <span class="op">+</span> <span class="dv">12</span><span class="op">*</span>h<span class="op">/</span><span class="dv">13</span>, y[i,:] <span class="op">+</span> <span class="dv">1932</span><span class="op">*</span>k1<span class="op">/</span><span class="dv">2197</span> <span class="op">-</span> <span class="dv">7200</span><span class="op">*</span>k2<span class="op">/</span><span class="dv">2197</span> <span class="op">+</span> <span class="dv">7296</span><span class="op">*</span>k3<span class="op">/</span><span class="dv">2197</span>)</a>
<a class="sourceLine" id="cb1438-24" title="24">        k5 <span class="op">=</span> h<span class="op">*</span>fn(t[i] <span class="op">+</span> h, y[i,:] <span class="op">+</span> <span class="dv">439</span><span class="op">*</span>k1<span class="op">/</span><span class="dv">216</span> <span class="op">-</span> <span class="dv">8</span><span class="op">*</span>k2 <span class="op">+</span> <span class="dv">3680</span><span class="op">*</span>k3<span class="op">/</span><span class="dv">513</span> <span class="op">-</span> <span class="dv">845</span><span class="op">*</span>k4<span class="op">/</span><span class="dv">4104</span>)</a>
<a class="sourceLine" id="cb1438-25" title="25">        k6 <span class="op">=</span> h<span class="op">*</span>fn(t[i] <span class="op">+</span> h<span class="op">/</span><span class="dv">2</span>, y[i,:] <span class="op">-</span> <span class="dv">8</span><span class="op">*</span>k1<span class="op">/</span><span class="dv">27</span> <span class="op">+</span> <span class="dv">2</span><span class="op">*</span>k2 <span class="op">-</span> <span class="dv">3544</span><span class="op">*</span>k3<span class="op">/</span><span class="dv">2565</span> <span class="op">+</span> <span class="dv">1859</span><span class="op">*</span>k4<span class="op">/</span><span class="dv">4104</span> <span class="op">-</span> <span class="dv">11</span><span class="op">*</span>k5<span class="op">/</span><span class="dv">40</span>)</a>
<a class="sourceLine" id="cb1438-26" title="26">        y[i<span class="op">+</span><span class="dv">1</span>,:] <span class="op">=</span> y[i,:] <span class="op">+</span> <span class="dv">25</span><span class="op">*</span>k1<span class="op">/</span><span class="dv">216</span> <span class="op">+</span> <span class="dv">1408</span><span class="op">*</span>k3<span class="op">/</span><span class="dv">2565</span> <span class="op">+</span> <span class="dv">2197</span><span class="op">*</span>k4<span class="op">/</span><span class="dv">4104</span> <span class="op">-</span> k5<span class="op">/</span><span class="dv">5</span></a>
<a class="sourceLine" id="cb1438-27" title="27">    <span class="cf">return</span> y</a>
<a class="sourceLine" id="cb1438-28" title="28"></a>
<a class="sourceLine" id="cb1438-29" title="29"><span class="im">from</span> scipy.integrate <span class="im">import</span> solve_ivp</a>
<a class="sourceLine" id="cb1438-30" title="30"><span class="kw">def</span> exponential_decay(t, y): </a>
<a class="sourceLine" id="cb1438-31" title="31">    <span class="cf">return</span> <span class="fl">-0.5</span> <span class="op">*</span> y</a>
<a class="sourceLine" id="cb1438-32" title="32">solution <span class="op">=</span> solve_ivp(exponential_decay, [<span class="dv">0</span>, <span class="dv">10</span>], [<span class="dv">4</span>], t_eval<span class="op">=</span>[<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">8</span>])</a>
<a class="sourceLine" id="cb1438-33" title="33"></a>
<a class="sourceLine" id="cb1438-34" title="34">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.allclose(solution, solve_ode(exponential_decay, [<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">8</span>], [<span class="dv">4</span>])) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>ufunc &#39;isfinite&#39; not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule &#39;&#39;safe&#39;&#39;</code></pre>
<h4 id="run-4-130">Run 4</h4>
<div class="sourceCode" id="cb1440"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1440-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1440-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1440-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1440-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1440-5" title="5"></a>
<a class="sourceLine" id="cb1440-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1440-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1440-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1440-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1440-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1440-11" title="11"></a>
<a class="sourceLine" id="cb1440-12" title="12"><span class="kw">def</span> solve_ode(fn, t, y0):</a>
<a class="sourceLine" id="cb1440-13" title="13">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1440-14" title="14"><span class="co">    Solve an initial value problem for system of Ordinary Differential Equations using the Explicit Runge-Kutta method of order 5. t is a 1D vector and dy/dt=fn(t,y). Returns the values of the solution y at t.</span></a>
<a class="sourceLine" id="cb1440-15" title="15"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1440-16" title="16">    y <span class="op">=</span> np.zeros((<span class="bu">len</span>(t), <span class="bu">len</span>(y0)))</a>
<a class="sourceLine" id="cb1440-17" title="17">    y[<span class="dv">0</span>] <span class="op">=</span> y0</a>
<a class="sourceLine" id="cb1440-18" title="18">    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(t)<span class="op">-</span><span class="dv">1</span>):</a>
<a class="sourceLine" id="cb1440-19" title="19">        h <span class="op">=</span> t[i<span class="op">+</span><span class="dv">1</span>] <span class="op">-</span> t[i]</a>
<a class="sourceLine" id="cb1440-20" title="20">        k1 <span class="op">=</span> h<span class="op">*</span>fn(t[i], y[i])</a>
<a class="sourceLine" id="cb1440-21" title="21">        k2 <span class="op">=</span> h<span class="op">*</span>fn(t[i] <span class="op">+</span> h<span class="op">/</span><span class="dv">4</span>, y[i] <span class="op">+</span> k1<span class="op">/</span><span class="dv">4</span>)</a>
<a class="sourceLine" id="cb1440-22" title="22">        k3 <span class="op">=</span> h<span class="op">*</span>fn(t[i] <span class="op">+</span> <span class="dv">3</span><span class="op">*</span>h<span class="op">/</span><span class="dv">8</span>, y[i] <span class="op">+</span> <span class="dv">3</span><span class="op">*</span>k1<span class="op">/</span><span class="dv">32</span> <span class="op">+</span> <span class="dv">9</span><span class="op">*</span>k2<span class="op">/</span><span class="dv">32</span>)</a>
<a class="sourceLine" id="cb1440-23" title="23">        k4 <span class="op">=</span> h<span class="op">*</span>fn(t[i] <span class="op">+</span> <span class="dv">12</span><span class="op">*</span>h<span class="op">/</span><span class="dv">13</span>, y[i] <span class="op">+</span> <span class="dv">1932</span><span class="op">*</span>k1<span class="op">/</span><span class="dv">2197</span> <span class="op">-</span> <span class="dv">7200</span><span class="op">*</span>k2<span class="op">/</span><span class="dv">2197</span> <span class="op">+</span> <span class="dv">7296</span><span class="op">*</span>k3<span class="op">/</span><span class="dv">2197</span>)</a>
<a class="sourceLine" id="cb1440-24" title="24">        k5 <span class="op">=</span> h<span class="op">*</span>fn(t[i] <span class="op">+</span> h, y[i] <span class="op">+</span> <span class="dv">439</span><span class="op">*</span>k1<span class="op">/</span><span class="dv">216</span> <span class="op">-</span> <span class="dv">8</span><span class="op">*</span>k2 <span class="op">+</span> <span class="dv">3680</span><span class="op">*</span>k3<span class="op">/</span><span class="dv">513</span> <span class="op">-</span> <span class="dv">845</span><span class="op">*</span>k4<span class="op">/</span><span class="dv">4104</span>)</a>
<a class="sourceLine" id="cb1440-25" title="25">        k6 <span class="op">=</span> h<span class="op">*</span>fn(t[i] <span class="op">+</span> h<span class="op">/</span><span class="dv">2</span>, y[i] <span class="op">-</span> <span class="dv">8</span><span class="op">*</span>k1<span class="op">/</span><span class="dv">27</span> <span class="op">+</span> <span class="dv">2</span><span class="op">*</span>k2 <span class="op">-</span> <span class="dv">3544</span><span class="op">*</span>k3<span class="op">/</span><span class="dv">2565</span> <span class="op">+</span> <span class="dv">1859</span><span class="op">*</span>k4<span class="op">/</span><span class="dv">4104</span> <span class="op">-</span> <span class="dv">11</span><span class="op">*</span>k5<span class="op">/</span><span class="dv">40</span>)</a>
<a class="sourceLine" id="cb1440-26" title="26">        y[i<span class="op">+</span><span class="dv">1</span>] <span class="op">=</span> y[i] <span class="op">+</span> <span class="dv">25</span><span class="op">*</span>k1<span class="op">/</span><span class="dv">216</span> <span class="op">+</span> <span class="dv">1408</span><span class="op">*</span>k3<span class="op">/</span><span class="dv">2565</span> <span class="op">+</span> <span class="dv">2197</span><span class="op">*</span>k4<span class="op">/</span><span class="dv">4104</span> <span class="op">-</span> k5<span class="op">/</span><span class="dv">5</span></a>
<a class="sourceLine" id="cb1440-27" title="27">    <span class="cf">return</span> y</a>
<a class="sourceLine" id="cb1440-28" title="28"></a>
<a class="sourceLine" id="cb1440-29" title="29"><span class="im">from</span> scipy.integrate <span class="im">import</span> solve_ivp</a>
<a class="sourceLine" id="cb1440-30" title="30"><span class="kw">def</span> exponential_decay(t, y): </a>
<a class="sourceLine" id="cb1440-31" title="31">    <span class="cf">return</span> <span class="fl">-0.5</span> <span class="op">*</span> y</a>
<a class="sourceLine" id="cb1440-32" title="32">solution <span class="op">=</span> solve_ivp(exponential_decay, [<span class="dv">0</span>, <span class="dv">10</span>], [<span class="dv">4</span>], t_eval<span class="op">=</span>[<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">8</span>])</a>
<a class="sourceLine" id="cb1440-33" title="33"></a>
<a class="sourceLine" id="cb1440-34" title="34">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.allclose(solution, solve_ode(exponential_decay, [<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">8</span>], [<span class="dv">4</span>])) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>ufunc &#39;isfinite&#39; not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule &#39;&#39;safe&#39;&#39;</code></pre>
</details>
<details>
<p><summary>ohe</summary></p>
<h4 id="query-131">Query</h4>
<div class="sourceCode" id="cb1442"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1442-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1442-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1442-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1442-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1442-5" title="5"></a>
<a class="sourceLine" id="cb1442-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1442-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1442-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1442-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1442-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1442-11" title="11"></a>
<a class="sourceLine" id="cb1442-12" title="12"><span class="kw">def</span> ohe(a):</a>
<a class="sourceLine" id="cb1442-13" title="13">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1442-14" title="14"><span class="co">  This function generates one-hot encodings for</span></a>
<a class="sourceLine" id="cb1442-15" title="15"><span class="co">  the class names in the given list of strings.</span></a>
<a class="sourceLine" id="cb1442-16" title="16"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1442-17" title="17">  </a></code></pre></div>
<h4 id="run-0-131">Run 0</h4>
<div class="sourceCode" id="cb1443"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1443-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1443-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1443-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1443-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1443-5" title="5"></a>
<a class="sourceLine" id="cb1443-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1443-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1443-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1443-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1443-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1443-11" title="11"></a>
<a class="sourceLine" id="cb1443-12" title="12"><span class="kw">def</span> ohe(a):</a>
<a class="sourceLine" id="cb1443-13" title="13">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1443-14" title="14"><span class="co">  This function generates one-hot encodings for</span></a>
<a class="sourceLine" id="cb1443-15" title="15"><span class="co">  the class names in the given list of strings.</span></a>
<a class="sourceLine" id="cb1443-16" title="16"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1443-17" title="17">  <span class="co"># YOUR CODE HERE</span></a>
<a class="sourceLine" id="cb1443-18" title="18">  <span class="co"># raise NotImplementedError()</span></a>
<a class="sourceLine" id="cb1443-19" title="19">  </a>
<a class="sourceLine" id="cb1443-20" title="20"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1443-21" title="21"></a>
<a class="sourceLine" id="cb1443-22" title="22">dog_breeds <span class="op">=</span> [<span class="st">&#39;German Shepherd&#39;</span>, <span class="st">&#39;Husky&#39;</span>,</a>
<a class="sourceLine" id="cb1443-23" title="23">              <span class="st">&#39;Bulldog&#39;</span>, <span class="st">&#39;Dobermann&#39;</span>, <span class="st">&#39;Great Dane&#39;</span>, <span class="st">&#39;Husky&#39;</span>, <span class="st">&#39;Bulldog&#39;</span>, <span class="st">&#39;German Shepherd&#39;</span>, <span class="st">&#39;Great Dane&#39;</span>, <span class="st">&#39;German Shepherd&#39;</span>]</a>
<a class="sourceLine" id="cb1443-24" title="24"></a>
<a class="sourceLine" id="cb1443-25" title="25">unique_list <span class="op">=</span> <span class="bu">sorted</span>(<span class="bu">list</span>(<span class="bu">set</span>(dog_breeds)))</a>
<a class="sourceLine" id="cb1443-26" title="26">n <span class="op">=</span> <span class="bu">len</span>(dog_breeds)</a>
<a class="sourceLine" id="cb1443-27" title="27">m <span class="op">=</span> <span class="bu">len</span>(unique_list)</a>
<a class="sourceLine" id="cb1443-28" title="28">ohe_array <span class="op">=</span> np.zeros((n, m))</a>
<a class="sourceLine" id="cb1443-29" title="29">j <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb1443-30" title="30"><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n):</a>
<a class="sourceLine" id="cb1443-31" title="31">        ohe_array[j, unique_list.index(dog_breeds[i])] <span class="op">=</span> <span class="fl">1.</span></a>
<a class="sourceLine" id="cb1443-32" title="32">        j <span class="op">+=</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb1443-33" title="33"></a>
<a class="sourceLine" id="cb1443-34" title="34">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(ohe(dog_breeds), ohe_array).<span class="bu">all</span>() <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>ufunc &#39;isfinite&#39; not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule &#39;&#39;safe&#39;&#39;</code></pre>
<h4 id="run-1-131">Run 1</h4>
<div class="sourceCode" id="cb1445"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1445-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1445-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1445-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1445-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1445-5" title="5"></a>
<a class="sourceLine" id="cb1445-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1445-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1445-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1445-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1445-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1445-11" title="11"></a>
<a class="sourceLine" id="cb1445-12" title="12"><span class="kw">def</span> ohe(a):</a>
<a class="sourceLine" id="cb1445-13" title="13">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1445-14" title="14"><span class="co">  This function generates one-hot encodings for</span></a>
<a class="sourceLine" id="cb1445-15" title="15"><span class="co">  the class names in the given list of strings.</span></a>
<a class="sourceLine" id="cb1445-16" title="16"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1445-17" title="17">  <span class="co"># start</span></a>
<a class="sourceLine" id="cb1445-18" title="18">  </a>
<a class="sourceLine" id="cb1445-19" title="19"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1445-20" title="20"></a>
<a class="sourceLine" id="cb1445-21" title="21">dog_breeds <span class="op">=</span> [<span class="st">&#39;German Shepherd&#39;</span>, <span class="st">&#39;Husky&#39;</span>,</a>
<a class="sourceLine" id="cb1445-22" title="22">              <span class="st">&#39;Bulldog&#39;</span>, <span class="st">&#39;Dobermann&#39;</span>, <span class="st">&#39;Great Dane&#39;</span>, <span class="st">&#39;Husky&#39;</span>, <span class="st">&#39;Bulldog&#39;</span>, <span class="st">&#39;German Shepherd&#39;</span>, <span class="st">&#39;Great Dane&#39;</span>, <span class="st">&#39;German Shepherd&#39;</span>]</a>
<a class="sourceLine" id="cb1445-23" title="23"></a>
<a class="sourceLine" id="cb1445-24" title="24">unique_list <span class="op">=</span> <span class="bu">sorted</span>(<span class="bu">list</span>(<span class="bu">set</span>(dog_breeds)))</a>
<a class="sourceLine" id="cb1445-25" title="25">n <span class="op">=</span> <span class="bu">len</span>(dog_breeds)</a>
<a class="sourceLine" id="cb1445-26" title="26">m <span class="op">=</span> <span class="bu">len</span>(unique_list)</a>
<a class="sourceLine" id="cb1445-27" title="27">ohe_array <span class="op">=</span> np.zeros((n, m))</a>
<a class="sourceLine" id="cb1445-28" title="28">j <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb1445-29" title="29"><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n):</a>
<a class="sourceLine" id="cb1445-30" title="30">        ohe_array[j, unique_list.index(dog_breeds[i])] <span class="op">=</span> <span class="fl">1.</span></a>
<a class="sourceLine" id="cb1445-31" title="31">        j <span class="op">+=</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb1445-32" title="32"></a>
<a class="sourceLine" id="cb1445-33" title="33">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(ohe(dog_breeds), ohe_array).<span class="bu">all</span>() <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>ufunc &#39;isfinite&#39; not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule &#39;&#39;safe&#39;&#39;</code></pre>
<h4 id="run-2-131">Run 2</h4>
<div class="sourceCode" id="cb1447"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1447-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1447-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1447-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1447-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1447-5" title="5"></a>
<a class="sourceLine" id="cb1447-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1447-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1447-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1447-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1447-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1447-11" title="11"></a>
<a class="sourceLine" id="cb1447-12" title="12"><span class="kw">def</span> ohe(a):</a>
<a class="sourceLine" id="cb1447-13" title="13">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1447-14" title="14"><span class="co">  This function generates one-hot encodings for</span></a>
<a class="sourceLine" id="cb1447-15" title="15"><span class="co">  the class names in the given list of strings.</span></a>
<a class="sourceLine" id="cb1447-16" title="16"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1447-17" title="17">  <span class="co"># YOUR CODE HERE</span></a>
<a class="sourceLine" id="cb1447-18" title="18">  <span class="co"># raise NotImplementedError()</span></a>
<a class="sourceLine" id="cb1447-19" title="19">  </a>
<a class="sourceLine" id="cb1447-20" title="20"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1447-21" title="21"></a>
<a class="sourceLine" id="cb1447-22" title="22">dog_breeds <span class="op">=</span> [<span class="st">&#39;German Shepherd&#39;</span>, <span class="st">&#39;Husky&#39;</span>,</a>
<a class="sourceLine" id="cb1447-23" title="23">              <span class="st">&#39;Bulldog&#39;</span>, <span class="st">&#39;Dobermann&#39;</span>, <span class="st">&#39;Great Dane&#39;</span>, <span class="st">&#39;Husky&#39;</span>, <span class="st">&#39;Bulldog&#39;</span>, <span class="st">&#39;German Shepherd&#39;</span>, <span class="st">&#39;Great Dane&#39;</span>, <span class="st">&#39;German Shepherd&#39;</span>]</a>
<a class="sourceLine" id="cb1447-24" title="24"></a>
<a class="sourceLine" id="cb1447-25" title="25">unique_list <span class="op">=</span> <span class="bu">sorted</span>(<span class="bu">list</span>(<span class="bu">set</span>(dog_breeds)))</a>
<a class="sourceLine" id="cb1447-26" title="26">n <span class="op">=</span> <span class="bu">len</span>(dog_breeds)</a>
<a class="sourceLine" id="cb1447-27" title="27">m <span class="op">=</span> <span class="bu">len</span>(unique_list)</a>
<a class="sourceLine" id="cb1447-28" title="28">ohe_array <span class="op">=</span> np.zeros((n, m))</a>
<a class="sourceLine" id="cb1447-29" title="29">j <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb1447-30" title="30"><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n):</a>
<a class="sourceLine" id="cb1447-31" title="31">        ohe_array[j, unique_list.index(dog_breeds[i])] <span class="op">=</span> <span class="fl">1.</span></a>
<a class="sourceLine" id="cb1447-32" title="32">        j <span class="op">+=</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb1447-33" title="33"></a>
<a class="sourceLine" id="cb1447-34" title="34">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(ohe(dog_breeds), ohe_array).<span class="bu">all</span>() <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>ufunc &#39;isfinite&#39; not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule &#39;&#39;safe&#39;&#39;</code></pre>
<h4 id="run-3-131">Run 3</h4>
<div class="sourceCode" id="cb1449"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1449-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1449-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1449-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1449-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1449-5" title="5"></a>
<a class="sourceLine" id="cb1449-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1449-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1449-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1449-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1449-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1449-11" title="11"></a>
<a class="sourceLine" id="cb1449-12" title="12"><span class="kw">def</span> ohe(a):</a>
<a class="sourceLine" id="cb1449-13" title="13">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1449-14" title="14"><span class="co">  This function generates one-hot encodings for</span></a>
<a class="sourceLine" id="cb1449-15" title="15"><span class="co">  the class names in the given list of strings.</span></a>
<a class="sourceLine" id="cb1449-16" title="16"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1449-17" title="17">  <span class="co"># YOUR CODE HERE</span></a>
<a class="sourceLine" id="cb1449-18" title="18">  <span class="co">#raise NotImplementedError()</span></a>
<a class="sourceLine" id="cb1449-19" title="19">  </a>
<a class="sourceLine" id="cb1449-20" title="20"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1449-21" title="21"></a>
<a class="sourceLine" id="cb1449-22" title="22">dog_breeds <span class="op">=</span> [<span class="st">&#39;German Shepherd&#39;</span>, <span class="st">&#39;Husky&#39;</span>,</a>
<a class="sourceLine" id="cb1449-23" title="23">              <span class="st">&#39;Bulldog&#39;</span>, <span class="st">&#39;Dobermann&#39;</span>, <span class="st">&#39;Great Dane&#39;</span>, <span class="st">&#39;Husky&#39;</span>, <span class="st">&#39;Bulldog&#39;</span>, <span class="st">&#39;German Shepherd&#39;</span>, <span class="st">&#39;Great Dane&#39;</span>, <span class="st">&#39;German Shepherd&#39;</span>]</a>
<a class="sourceLine" id="cb1449-24" title="24"></a>
<a class="sourceLine" id="cb1449-25" title="25">unique_list <span class="op">=</span> <span class="bu">sorted</span>(<span class="bu">list</span>(<span class="bu">set</span>(dog_breeds)))</a>
<a class="sourceLine" id="cb1449-26" title="26">n <span class="op">=</span> <span class="bu">len</span>(dog_breeds)</a>
<a class="sourceLine" id="cb1449-27" title="27">m <span class="op">=</span> <span class="bu">len</span>(unique_list)</a>
<a class="sourceLine" id="cb1449-28" title="28">ohe_array <span class="op">=</span> np.zeros((n, m))</a>
<a class="sourceLine" id="cb1449-29" title="29">j <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb1449-30" title="30"><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n):</a>
<a class="sourceLine" id="cb1449-31" title="31">        ohe_array[j, unique_list.index(dog_breeds[i])] <span class="op">=</span> <span class="fl">1.</span></a>
<a class="sourceLine" id="cb1449-32" title="32">        j <span class="op">+=</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb1449-33" title="33"></a>
<a class="sourceLine" id="cb1449-34" title="34">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(ohe(dog_breeds), ohe_array).<span class="bu">all</span>() <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>ufunc &#39;isfinite&#39; not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule &#39;&#39;safe&#39;&#39;</code></pre>
<h4 id="run-4-131">Run 4</h4>
<div class="sourceCode" id="cb1451"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1451-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1451-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1451-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1451-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1451-5" title="5"></a>
<a class="sourceLine" id="cb1451-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1451-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1451-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1451-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1451-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1451-11" title="11"></a>
<a class="sourceLine" id="cb1451-12" title="12"><span class="kw">def</span> ohe(a):</a>
<a class="sourceLine" id="cb1451-13" title="13">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1451-14" title="14"><span class="co">  This function generates one-hot encodings for</span></a>
<a class="sourceLine" id="cb1451-15" title="15"><span class="co">  the class names in the given list of strings.</span></a>
<a class="sourceLine" id="cb1451-16" title="16"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1451-17" title="17">  <span class="co"># YOUR CODE HERE</span></a>
<a class="sourceLine" id="cb1451-18" title="18">  <span class="co">#raise NotImplementedError()</span></a>
<a class="sourceLine" id="cb1451-19" title="19">  </a>
<a class="sourceLine" id="cb1451-20" title="20"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1451-21" title="21"></a>
<a class="sourceLine" id="cb1451-22" title="22">dog_breeds <span class="op">=</span> [<span class="st">&#39;German Shepherd&#39;</span>, <span class="st">&#39;Husky&#39;</span>,</a>
<a class="sourceLine" id="cb1451-23" title="23">              <span class="st">&#39;Bulldog&#39;</span>, <span class="st">&#39;Dobermann&#39;</span>, <span class="st">&#39;Great Dane&#39;</span>, <span class="st">&#39;Husky&#39;</span>, <span class="st">&#39;Bulldog&#39;</span>, <span class="st">&#39;German Shepherd&#39;</span>, <span class="st">&#39;Great Dane&#39;</span>, <span class="st">&#39;German Shepherd&#39;</span>]</a>
<a class="sourceLine" id="cb1451-24" title="24"></a>
<a class="sourceLine" id="cb1451-25" title="25">unique_list <span class="op">=</span> <span class="bu">sorted</span>(<span class="bu">list</span>(<span class="bu">set</span>(dog_breeds)))</a>
<a class="sourceLine" id="cb1451-26" title="26">n <span class="op">=</span> <span class="bu">len</span>(dog_breeds)</a>
<a class="sourceLine" id="cb1451-27" title="27">m <span class="op">=</span> <span class="bu">len</span>(unique_list)</a>
<a class="sourceLine" id="cb1451-28" title="28">ohe_array <span class="op">=</span> np.zeros((n, m))</a>
<a class="sourceLine" id="cb1451-29" title="29">j <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb1451-30" title="30"><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n):</a>
<a class="sourceLine" id="cb1451-31" title="31">        ohe_array[j, unique_list.index(dog_breeds[i])] <span class="op">=</span> <span class="fl">1.</span></a>
<a class="sourceLine" id="cb1451-32" title="32">        j <span class="op">+=</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb1451-33" title="33"></a>
<a class="sourceLine" id="cb1451-34" title="34">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(ohe(dog_breeds), ohe_array).<span class="bu">all</span>() <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>ufunc &#39;isfinite&#39; not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule &#39;&#39;safe&#39;&#39;</code></pre>
</details>
<details>
<p><summary>osmotic_pressure</summary></p>
<h4 id="query-132">Query</h4>
<div class="sourceCode" id="cb1453"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1453-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb1453-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb1453-3" title="3"></a>
<a class="sourceLine" id="cb1453-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1453-5" title="5"><span class="co">compute sin(pi/2)</span></a>
<a class="sourceLine" id="cb1453-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1453-7" title="7">x <span class="op">=</span> math.sin(math.pi <span class="op">/</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1453-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1453-9" title="9"></a>
<a class="sourceLine" id="cb1453-10" title="10"><span class="kw">def</span> osmotic_pressure_concentration(Pi,T):</a>
<a class="sourceLine" id="cb1453-11" title="11">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1453-12" title="12"><span class="co">   This function returns the concentration in mol/l given an osmotic pressure Pi and temperature T</span></a>
<a class="sourceLine" id="cb1453-13" title="13"><span class="co">   T is in K</span></a>
<a class="sourceLine" id="cb1453-14" title="14"><span class="co">   Pi is in atm</span></a>
<a class="sourceLine" id="cb1453-15" title="15"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1453-16" title="16">   R <span class="op">=</span> <span class="fl">0.08206</span> <span class="co"># l atm /K /mol</span></a>
<a class="sourceLine" id="cb1453-17" title="17">   </a></code></pre></div>
<h4 id="run-0-132">Run 0</h4>
<div class="sourceCode" id="cb1454"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1454-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb1454-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb1454-3" title="3"></a>
<a class="sourceLine" id="cb1454-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1454-5" title="5"><span class="co">compute sin(pi/2)</span></a>
<a class="sourceLine" id="cb1454-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1454-7" title="7">x <span class="op">=</span> math.sin(math.pi <span class="op">/</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1454-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1454-9" title="9"></a>
<a class="sourceLine" id="cb1454-10" title="10"><span class="kw">def</span> osmotic_pressure_concentration(Pi,T):</a>
<a class="sourceLine" id="cb1454-11" title="11">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1454-12" title="12"><span class="co">   This function returns the concentration in mol/l given an osmotic pressure Pi and temperature T</span></a>
<a class="sourceLine" id="cb1454-13" title="13"><span class="co">   T is in K</span></a>
<a class="sourceLine" id="cb1454-14" title="14"><span class="co">   Pi is in atm</span></a>
<a class="sourceLine" id="cb1454-15" title="15"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1454-16" title="16">   R <span class="op">=</span> <span class="fl">0.08206</span> <span class="co"># l atm /K /mol</span></a>
<a class="sourceLine" id="cb1454-17" title="17">   <span class="cf">return</span> Pi<span class="op">/</span>(R<span class="op">*</span>T)</a>
<a class="sourceLine" id="cb1454-18" title="18"></a>
<a class="sourceLine" id="cb1454-19" title="19"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1454-20" title="20">pressure <span class="op">=</span> <span class="fl">0.02</span> <span class="co">#atm</span></a>
<a class="sourceLine" id="cb1454-21" title="21">temperature <span class="op">=</span> <span class="dv">310</span> <span class="co">#K </span></a>
<a class="sourceLine" id="cb1454-22" title="22">c <span class="op">=</span> pressure<span class="op">/</span>(<span class="fl">0.08206</span><span class="op">*</span>temperature)</a>
<a class="sourceLine" id="cb1454-23" title="23">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">abs</span>(osmotic_pressure_concentration(pressure,temperature)<span class="op">-</span>c)<span class="op">&lt;</span><span class="fl">0.01</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-132">Run 1</h4>
<div class="sourceCode" id="cb1456"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1456-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb1456-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb1456-3" title="3"></a>
<a class="sourceLine" id="cb1456-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1456-5" title="5"><span class="co">compute sin(pi/2)</span></a>
<a class="sourceLine" id="cb1456-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1456-7" title="7">x <span class="op">=</span> math.sin(math.pi <span class="op">/</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1456-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1456-9" title="9"></a>
<a class="sourceLine" id="cb1456-10" title="10"><span class="kw">def</span> osmotic_pressure_concentration(Pi,T):</a>
<a class="sourceLine" id="cb1456-11" title="11">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1456-12" title="12"><span class="co">   This function returns the concentration in mol/l given an osmotic pressure Pi and temperature T</span></a>
<a class="sourceLine" id="cb1456-13" title="13"><span class="co">   T is in K</span></a>
<a class="sourceLine" id="cb1456-14" title="14"><span class="co">   Pi is in atm</span></a>
<a class="sourceLine" id="cb1456-15" title="15"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1456-16" title="16">   R <span class="op">=</span> <span class="fl">0.08206</span> <span class="co"># l atm /K /mol</span></a>
<a class="sourceLine" id="cb1456-17" title="17">   <span class="cf">return</span> Pi<span class="op">/</span>(R<span class="op">*</span>T)</a>
<a class="sourceLine" id="cb1456-18" title="18"></a>
<a class="sourceLine" id="cb1456-19" title="19"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1456-20" title="20">pressure <span class="op">=</span> <span class="fl">0.02</span> <span class="co">#atm</span></a>
<a class="sourceLine" id="cb1456-21" title="21">temperature <span class="op">=</span> <span class="dv">310</span> <span class="co">#K </span></a>
<a class="sourceLine" id="cb1456-22" title="22">c <span class="op">=</span> pressure<span class="op">/</span>(<span class="fl">0.08206</span><span class="op">*</span>temperature)</a>
<a class="sourceLine" id="cb1456-23" title="23">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">abs</span>(osmotic_pressure_concentration(pressure,temperature)<span class="op">-</span>c)<span class="op">&lt;</span><span class="fl">0.01</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-132">Run 2</h4>
<div class="sourceCode" id="cb1458"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1458-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb1458-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb1458-3" title="3"></a>
<a class="sourceLine" id="cb1458-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1458-5" title="5"><span class="co">compute sin(pi/2)</span></a>
<a class="sourceLine" id="cb1458-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1458-7" title="7">x <span class="op">=</span> math.sin(math.pi <span class="op">/</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1458-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1458-9" title="9"></a>
<a class="sourceLine" id="cb1458-10" title="10"><span class="kw">def</span> osmotic_pressure_concentration(Pi,T):</a>
<a class="sourceLine" id="cb1458-11" title="11">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1458-12" title="12"><span class="co">   This function returns the concentration in mol/l given an osmotic pressure Pi and temperature T</span></a>
<a class="sourceLine" id="cb1458-13" title="13"><span class="co">   T is in K</span></a>
<a class="sourceLine" id="cb1458-14" title="14"><span class="co">   Pi is in atm</span></a>
<a class="sourceLine" id="cb1458-15" title="15"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1458-16" title="16">   R <span class="op">=</span> <span class="fl">0.08206</span> <span class="co"># l atm /K /mol</span></a>
<a class="sourceLine" id="cb1458-17" title="17">   <span class="cf">return</span> Pi <span class="op">/</span> (R <span class="op">*</span> T)</a>
<a class="sourceLine" id="cb1458-18" title="18"></a>
<a class="sourceLine" id="cb1458-19" title="19"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1458-20" title="20">pressure <span class="op">=</span> <span class="fl">0.02</span> <span class="co">#atm</span></a>
<a class="sourceLine" id="cb1458-21" title="21">temperature <span class="op">=</span> <span class="dv">310</span> <span class="co">#K </span></a>
<a class="sourceLine" id="cb1458-22" title="22">c <span class="op">=</span> pressure<span class="op">/</span>(<span class="fl">0.08206</span><span class="op">*</span>temperature)</a>
<a class="sourceLine" id="cb1458-23" title="23">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">abs</span>(osmotic_pressure_concentration(pressure,temperature)<span class="op">-</span>c)<span class="op">&lt;</span><span class="fl">0.01</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-132">Run 3</h4>
<div class="sourceCode" id="cb1460"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1460-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb1460-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb1460-3" title="3"></a>
<a class="sourceLine" id="cb1460-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1460-5" title="5"><span class="co">compute sin(pi/2)</span></a>
<a class="sourceLine" id="cb1460-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1460-7" title="7">x <span class="op">=</span> math.sin(math.pi <span class="op">/</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1460-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1460-9" title="9"></a>
<a class="sourceLine" id="cb1460-10" title="10"><span class="kw">def</span> osmotic_pressure_concentration(Pi,T):</a>
<a class="sourceLine" id="cb1460-11" title="11">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1460-12" title="12"><span class="co">   This function returns the concentration in mol/l given an osmotic pressure Pi and temperature T</span></a>
<a class="sourceLine" id="cb1460-13" title="13"><span class="co">   T is in K</span></a>
<a class="sourceLine" id="cb1460-14" title="14"><span class="co">   Pi is in atm</span></a>
<a class="sourceLine" id="cb1460-15" title="15"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1460-16" title="16">   R <span class="op">=</span> <span class="fl">0.08206</span> <span class="co"># l atm /K /mol</span></a>
<a class="sourceLine" id="cb1460-17" title="17">   <span class="cf">return</span> Pi <span class="op">/</span> (R <span class="op">*</span> T)</a>
<a class="sourceLine" id="cb1460-18" title="18"></a>
<a class="sourceLine" id="cb1460-19" title="19"></a>
<a class="sourceLine" id="cb1460-20" title="20"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1460-21" title="21">pressure <span class="op">=</span> <span class="fl">0.02</span> <span class="co">#atm</span></a>
<a class="sourceLine" id="cb1460-22" title="22">temperature <span class="op">=</span> <span class="dv">310</span> <span class="co">#K </span></a>
<a class="sourceLine" id="cb1460-23" title="23">c <span class="op">=</span> pressure<span class="op">/</span>(<span class="fl">0.08206</span><span class="op">*</span>temperature)</a>
<a class="sourceLine" id="cb1460-24" title="24">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">abs</span>(osmotic_pressure_concentration(pressure,temperature)<span class="op">-</span>c)<span class="op">&lt;</span><span class="fl">0.01</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-132">Run 4</h4>
<div class="sourceCode" id="cb1462"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1462-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb1462-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb1462-3" title="3"></a>
<a class="sourceLine" id="cb1462-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1462-5" title="5"><span class="co">compute sin(pi/2)</span></a>
<a class="sourceLine" id="cb1462-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1462-7" title="7">x <span class="op">=</span> math.sin(math.pi <span class="op">/</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1462-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1462-9" title="9"></a>
<a class="sourceLine" id="cb1462-10" title="10"><span class="kw">def</span> osmotic_pressure_concentration(Pi,T):</a>
<a class="sourceLine" id="cb1462-11" title="11">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1462-12" title="12"><span class="co">   This function returns the concentration in mol/l given an osmotic pressure Pi and temperature T</span></a>
<a class="sourceLine" id="cb1462-13" title="13"><span class="co">   T is in K</span></a>
<a class="sourceLine" id="cb1462-14" title="14"><span class="co">   Pi is in atm</span></a>
<a class="sourceLine" id="cb1462-15" title="15"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1462-16" title="16">   R <span class="op">=</span> <span class="fl">0.08206</span> <span class="co"># l atm /K /mol</span></a>
<a class="sourceLine" id="cb1462-17" title="17">   <span class="cf">return</span> Pi<span class="op">/</span>(R<span class="op">*</span>T)</a>
<a class="sourceLine" id="cb1462-18" title="18"></a>
<a class="sourceLine" id="cb1462-19" title="19"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1462-20" title="20">pressure <span class="op">=</span> <span class="fl">0.02</span> <span class="co">#atm</span></a>
<a class="sourceLine" id="cb1462-21" title="21">temperature <span class="op">=</span> <span class="dv">310</span> <span class="co">#K </span></a>
<a class="sourceLine" id="cb1462-22" title="22">c <span class="op">=</span> pressure<span class="op">/</span>(<span class="fl">0.08206</span><span class="op">*</span>temperature)</a>
<a class="sourceLine" id="cb1462-23" title="23">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">abs</span>(osmotic_pressure_concentration(pressure,temperature)<span class="op">-</span>c)<span class="op">&lt;</span><span class="fl">0.01</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>pair_wise</summary></p>
<h4 id="query-133">Query</h4>
<div class="sourceCode" id="cb1464"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1464-1" title="1"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb1464-2" title="2"></a>
<a class="sourceLine" id="cb1464-3" title="3"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1464-4" title="4"><span class="co">Print version string</span></a>
<a class="sourceLine" id="cb1464-5" title="5"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1464-6" title="6"><span class="bu">print</span>(md.version.full_version)</a>
<a class="sourceLine" id="cb1464-7" title="7"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1464-8" title="8"></a>
<a class="sourceLine" id="cb1464-9" title="9"><span class="kw">def</span> pairwise_dist(pdb_file):</a>
<a class="sourceLine" id="cb1464-10" title="10">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1464-11" title="11"><span class="co">  1 This function loads a pdb</span></a>
<a class="sourceLine" id="cb1464-12" title="12"><span class="co">  2 Selects only the alpha carbons</span></a>
<a class="sourceLine" id="cb1464-13" title="13"><span class="co">  3 Calculates the number of unique alpha carbon pairs</span></a>
<a class="sourceLine" id="cb1464-14" title="14"><span class="co">  4 Returns the distances between each alpha carbon pair</span></a>
<a class="sourceLine" id="cb1464-15" title="15"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1464-16" title="16">  </a></code></pre></div>
<h4 id="run-0-133">Run 0</h4>
<div class="sourceCode" id="cb1465"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1465-1" title="1"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb1465-2" title="2"></a>
<a class="sourceLine" id="cb1465-3" title="3"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1465-4" title="4"><span class="co">Print version string</span></a>
<a class="sourceLine" id="cb1465-5" title="5"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1465-6" title="6"><span class="bu">print</span>(md.version.full_version)</a>
<a class="sourceLine" id="cb1465-7" title="7"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1465-8" title="8"></a>
<a class="sourceLine" id="cb1465-9" title="9"><span class="kw">def</span> pairwise_dist(pdb_file):</a>
<a class="sourceLine" id="cb1465-10" title="10">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1465-11" title="11"><span class="co">  1 This function loads a pdb</span></a>
<a class="sourceLine" id="cb1465-12" title="12"><span class="co">  2 Selects only the alpha carbons</span></a>
<a class="sourceLine" id="cb1465-13" title="13"><span class="co">  3 Calculates the number of unique alpha carbon pairs</span></a>
<a class="sourceLine" id="cb1465-14" title="14"><span class="co">  4 Returns the distances between each alpha carbon pair</span></a>
<a class="sourceLine" id="cb1465-15" title="15"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1465-16" title="16">  <span class="co"># 1</span></a>
<a class="sourceLine" id="cb1465-17" title="17">  traj <span class="op">=</span> md.load(pdb_file)</a>
<a class="sourceLine" id="cb1465-18" title="18">  <span class="co"># 2</span></a>
<a class="sourceLine" id="cb1465-19" title="19">  alpha_carbons <span class="op">=</span> traj.topology.select(<span class="st">&#39;name CA&#39;</span>)</a>
<a class="sourceLine" id="cb1465-20" title="20">  <span class="co"># 3</span></a>
<a class="sourceLine" id="cb1465-21" title="21">  alpha_pairs <span class="op">=</span> <span class="bu">list</span>(itertools.combinations(alpha_carbons, <span class="dv">2</span>))</a>
<a class="sourceLine" id="cb1465-22" title="22">  <span class="co"># 4</span></a>
<a class="sourceLine" id="cb1465-23" title="23">  distances <span class="op">=</span> md.compute_distances(traj, alpha_pairs)</a>
<a class="sourceLine" id="cb1465-24" title="24">  <span class="cf">return</span> distances</a>
<a class="sourceLine" id="cb1465-25" title="25"></a>
<a class="sourceLine" id="cb1465-26" title="26"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1465-27" title="27"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb1465-28" title="28"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb1465-29" title="29"></a>
<a class="sourceLine" id="cb1465-30" title="30">pdb_file <span class="op">=</span> os.path.join(_FILE_DIR_, <span class="st">&quot;1VII.pdb&quot;</span>)</a>
<a class="sourceLine" id="cb1465-31" title="31"></a>
<a class="sourceLine" id="cb1465-32" title="32"></a>
<a class="sourceLine" id="cb1465-33" title="33"><span class="kw">def</span> pairwise(pdb_file):</a>
<a class="sourceLine" id="cb1465-34" title="34">    <span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb1465-35" title="35">    <span class="im">from</span> itertools <span class="im">import</span> combinations</a>
<a class="sourceLine" id="cb1465-36" title="36">    pdb <span class="op">=</span> md.load(pdb_file)</a>
<a class="sourceLine" id="cb1465-37" title="37">    cas <span class="op">=</span> pdb.top.select(<span class="st">&quot;name CA&quot;</span>)</a>
<a class="sourceLine" id="cb1465-38" title="38">    distances <span class="op">=</span> []</a>
<a class="sourceLine" id="cb1465-39" title="39">    comb <span class="op">=</span> combinations(cas, <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1465-40" title="40">    distances <span class="op">=</span> md.compute_distances(pdb, comb, periodic<span class="op">=</span><span class="va">True</span>)</a>
<a class="sourceLine" id="cb1465-41" title="41">    <span class="cf">return</span> distances</a>
<a class="sourceLine" id="cb1465-42" title="42"></a>
<a class="sourceLine" id="cb1465-43" title="43"></a>
<a class="sourceLine" id="cb1465-44" title="44">my_result <span class="op">=</span> pairwise(pdb_file)</a>
<a class="sourceLine" id="cb1465-45" title="45">nlcc_result <span class="op">=</span> pairwise_dist(pdb_file)</a>
<a class="sourceLine" id="cb1465-46" title="46"></a>
<a class="sourceLine" id="cb1465-47" title="47"><span class="co">#print(&quot;My result:&quot;, my_result)</span></a>
<a class="sourceLine" id="cb1465-48" title="48"><span class="co">#print(&quot;nlcc result&quot;, nlcc_result)</span></a>
<a class="sourceLine" id="cb1465-49" title="49"></a>
<a class="sourceLine" id="cb1465-50" title="50">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">abs</span>(np.mean(my_result) <span class="op">-</span></a>
<a class="sourceLine" id="cb1465-51" title="51">                        np.mean(nlcc_result)) <span class="op">&lt;</span> <span class="fl">0.01</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>&#39;Constant&#39; object has no attribute &#39;kind&#39;</code></pre>
<h4 id="run-1-133">Run 1</h4>
<div class="sourceCode" id="cb1467"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1467-1" title="1"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb1467-2" title="2"></a>
<a class="sourceLine" id="cb1467-3" title="3"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1467-4" title="4"><span class="co">Print version string</span></a>
<a class="sourceLine" id="cb1467-5" title="5"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1467-6" title="6"><span class="bu">print</span>(md.version.full_version)</a>
<a class="sourceLine" id="cb1467-7" title="7"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1467-8" title="8"></a>
<a class="sourceLine" id="cb1467-9" title="9"><span class="kw">def</span> pairwise_dist(pdb_file):</a>
<a class="sourceLine" id="cb1467-10" title="10">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1467-11" title="11"><span class="co">  1 This function loads a pdb</span></a>
<a class="sourceLine" id="cb1467-12" title="12"><span class="co">  2 Selects only the alpha carbons</span></a>
<a class="sourceLine" id="cb1467-13" title="13"><span class="co">  3 Calculates the number of unique alpha carbon pairs</span></a>
<a class="sourceLine" id="cb1467-14" title="14"><span class="co">  4 Returns the distances between each alpha carbon pair</span></a>
<a class="sourceLine" id="cb1467-15" title="15"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1467-16" title="16">  <span class="co"># 1</span></a>
<a class="sourceLine" id="cb1467-17" title="17">  traj <span class="op">=</span> md.load(pdb_file)</a>
<a class="sourceLine" id="cb1467-18" title="18">  <span class="co"># 2</span></a>
<a class="sourceLine" id="cb1467-19" title="19">  alpha_carbons <span class="op">=</span> traj.topology.select(<span class="st">&quot;name CA&quot;</span>)</a>
<a class="sourceLine" id="cb1467-20" title="20">  <span class="co"># 3</span></a>
<a class="sourceLine" id="cb1467-21" title="21">  alpha_pairs <span class="op">=</span> <span class="bu">list</span>(itertools.combinations(alpha_carbons, <span class="dv">2</span>))</a>
<a class="sourceLine" id="cb1467-22" title="22">  <span class="co"># 4</span></a>
<a class="sourceLine" id="cb1467-23" title="23">  distances <span class="op">=</span> md.compute_distances(traj, alpha_pairs)</a>
<a class="sourceLine" id="cb1467-24" title="24">  <span class="cf">return</span> distances</a>
<a class="sourceLine" id="cb1467-25" title="25"></a>
<a class="sourceLine" id="cb1467-26" title="26"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1467-27" title="27"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb1467-28" title="28"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb1467-29" title="29"></a>
<a class="sourceLine" id="cb1467-30" title="30">pdb_file <span class="op">=</span> os.path.join(_FILE_DIR_, <span class="st">&quot;1VII.pdb&quot;</span>)</a>
<a class="sourceLine" id="cb1467-31" title="31"></a>
<a class="sourceLine" id="cb1467-32" title="32"></a>
<a class="sourceLine" id="cb1467-33" title="33"><span class="kw">def</span> pairwise(pdb_file):</a>
<a class="sourceLine" id="cb1467-34" title="34">    <span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb1467-35" title="35">    <span class="im">from</span> itertools <span class="im">import</span> combinations</a>
<a class="sourceLine" id="cb1467-36" title="36">    pdb <span class="op">=</span> md.load(pdb_file)</a>
<a class="sourceLine" id="cb1467-37" title="37">    cas <span class="op">=</span> pdb.top.select(<span class="st">&quot;name CA&quot;</span>)</a>
<a class="sourceLine" id="cb1467-38" title="38">    distances <span class="op">=</span> []</a>
<a class="sourceLine" id="cb1467-39" title="39">    comb <span class="op">=</span> combinations(cas, <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1467-40" title="40">    distances <span class="op">=</span> md.compute_distances(pdb, comb, periodic<span class="op">=</span><span class="va">True</span>)</a>
<a class="sourceLine" id="cb1467-41" title="41">    <span class="cf">return</span> distances</a>
<a class="sourceLine" id="cb1467-42" title="42"></a>
<a class="sourceLine" id="cb1467-43" title="43"></a>
<a class="sourceLine" id="cb1467-44" title="44">my_result <span class="op">=</span> pairwise(pdb_file)</a>
<a class="sourceLine" id="cb1467-45" title="45">nlcc_result <span class="op">=</span> pairwise_dist(pdb_file)</a>
<a class="sourceLine" id="cb1467-46" title="46"></a>
<a class="sourceLine" id="cb1467-47" title="47"><span class="co">#print(&quot;My result:&quot;, my_result)</span></a>
<a class="sourceLine" id="cb1467-48" title="48"><span class="co">#print(&quot;nlcc result&quot;, nlcc_result)</span></a>
<a class="sourceLine" id="cb1467-49" title="49"></a>
<a class="sourceLine" id="cb1467-50" title="50">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">abs</span>(np.mean(my_result) <span class="op">-</span></a>
<a class="sourceLine" id="cb1467-51" title="51">                        np.mean(nlcc_result)) <span class="op">&lt;</span> <span class="fl">0.01</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>&#39;Constant&#39; object has no attribute &#39;kind&#39;</code></pre>
<h4 id="run-2-133">Run 2</h4>
<div class="sourceCode" id="cb1469"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1469-1" title="1"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb1469-2" title="2"></a>
<a class="sourceLine" id="cb1469-3" title="3"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1469-4" title="4"><span class="co">Print version string</span></a>
<a class="sourceLine" id="cb1469-5" title="5"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1469-6" title="6"><span class="bu">print</span>(md.version.full_version)</a>
<a class="sourceLine" id="cb1469-7" title="7"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1469-8" title="8"></a>
<a class="sourceLine" id="cb1469-9" title="9"><span class="kw">def</span> pairwise_dist(pdb_file):</a>
<a class="sourceLine" id="cb1469-10" title="10">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1469-11" title="11"><span class="co">  1 This function loads a pdb</span></a>
<a class="sourceLine" id="cb1469-12" title="12"><span class="co">  2 Selects only the alpha carbons</span></a>
<a class="sourceLine" id="cb1469-13" title="13"><span class="co">  3 Calculates the number of unique alpha carbon pairs</span></a>
<a class="sourceLine" id="cb1469-14" title="14"><span class="co">  4 Returns the distances between each alpha carbon pair</span></a>
<a class="sourceLine" id="cb1469-15" title="15"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1469-16" title="16">  <span class="co"># 1</span></a>
<a class="sourceLine" id="cb1469-17" title="17">  pdb <span class="op">=</span> md.load_pdb(pdb_file)</a>
<a class="sourceLine" id="cb1469-18" title="18">  <span class="co"># 2</span></a>
<a class="sourceLine" id="cb1469-19" title="19">  pdb_alpha <span class="op">=</span> pdb.atom_slice(pdb.top.select(<span class="st">&#39;name CA&#39;</span>))</a>
<a class="sourceLine" id="cb1469-20" title="20">  <span class="co"># 3</span></a>
<a class="sourceLine" id="cb1469-21" title="21">  n_pairs <span class="op">=</span> pdb_alpha.n_atoms <span class="op">*</span> (pdb_alpha.n_atoms <span class="op">-</span> <span class="dv">1</span>) <span class="op">/</span> <span class="dv">2</span></a>
<a class="sourceLine" id="cb1469-22" title="22">  <span class="co"># 4</span></a>
<a class="sourceLine" id="cb1469-23" title="23">  <span class="cf">return</span> md.compute_distances(pdb_alpha, [[i, j] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(pdb_alpha.n_atoms) <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(i)])</a>
<a class="sourceLine" id="cb1469-24" title="24"></a>
<a class="sourceLine" id="cb1469-25" title="25"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1469-26" title="26"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb1469-27" title="27"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb1469-28" title="28"></a>
<a class="sourceLine" id="cb1469-29" title="29">pdb_file <span class="op">=</span> os.path.join(_FILE_DIR_, <span class="st">&quot;1VII.pdb&quot;</span>)</a>
<a class="sourceLine" id="cb1469-30" title="30"></a>
<a class="sourceLine" id="cb1469-31" title="31"></a>
<a class="sourceLine" id="cb1469-32" title="32"><span class="kw">def</span> pairwise(pdb_file):</a>
<a class="sourceLine" id="cb1469-33" title="33">    <span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb1469-34" title="34">    <span class="im">from</span> itertools <span class="im">import</span> combinations</a>
<a class="sourceLine" id="cb1469-35" title="35">    pdb <span class="op">=</span> md.load(pdb_file)</a>
<a class="sourceLine" id="cb1469-36" title="36">    cas <span class="op">=</span> pdb.top.select(<span class="st">&quot;name CA&quot;</span>)</a>
<a class="sourceLine" id="cb1469-37" title="37">    distances <span class="op">=</span> []</a>
<a class="sourceLine" id="cb1469-38" title="38">    comb <span class="op">=</span> combinations(cas, <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1469-39" title="39">    distances <span class="op">=</span> md.compute_distances(pdb, comb, periodic<span class="op">=</span><span class="va">True</span>)</a>
<a class="sourceLine" id="cb1469-40" title="40">    <span class="cf">return</span> distances</a>
<a class="sourceLine" id="cb1469-41" title="41"></a>
<a class="sourceLine" id="cb1469-42" title="42"></a>
<a class="sourceLine" id="cb1469-43" title="43">my_result <span class="op">=</span> pairwise(pdb_file)</a>
<a class="sourceLine" id="cb1469-44" title="44">nlcc_result <span class="op">=</span> pairwise_dist(pdb_file)</a>
<a class="sourceLine" id="cb1469-45" title="45"></a>
<a class="sourceLine" id="cb1469-46" title="46"><span class="co">#print(&quot;My result:&quot;, my_result)</span></a>
<a class="sourceLine" id="cb1469-47" title="47"><span class="co">#print(&quot;nlcc result&quot;, nlcc_result)</span></a>
<a class="sourceLine" id="cb1469-48" title="48"></a>
<a class="sourceLine" id="cb1469-49" title="49">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">abs</span>(np.mean(my_result) <span class="op">-</span></a>
<a class="sourceLine" id="cb1469-50" title="50">                        np.mean(nlcc_result)) <span class="op">&lt;</span> <span class="fl">0.01</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>&#39;Constant&#39; object has no attribute &#39;kind&#39;</code></pre>
<h4 id="run-3-133">Run 3</h4>
<div class="sourceCode" id="cb1471"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1471-1" title="1"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb1471-2" title="2"></a>
<a class="sourceLine" id="cb1471-3" title="3"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1471-4" title="4"><span class="co">Print version string</span></a>
<a class="sourceLine" id="cb1471-5" title="5"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1471-6" title="6"><span class="bu">print</span>(md.version.full_version)</a>
<a class="sourceLine" id="cb1471-7" title="7"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1471-8" title="8"></a>
<a class="sourceLine" id="cb1471-9" title="9"><span class="kw">def</span> pairwise_dist(pdb_file):</a>
<a class="sourceLine" id="cb1471-10" title="10">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1471-11" title="11"><span class="co">  1 This function loads a pdb</span></a>
<a class="sourceLine" id="cb1471-12" title="12"><span class="co">  2 Selects only the alpha carbons</span></a>
<a class="sourceLine" id="cb1471-13" title="13"><span class="co">  3 Calculates the number of unique alpha carbon pairs</span></a>
<a class="sourceLine" id="cb1471-14" title="14"><span class="co">  4 Returns the distances between each alpha carbon pair</span></a>
<a class="sourceLine" id="cb1471-15" title="15"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1471-16" title="16">  <span class="co"># 1</span></a>
<a class="sourceLine" id="cb1471-17" title="17">  traj <span class="op">=</span> md.load(pdb_file)</a>
<a class="sourceLine" id="cb1471-18" title="18">  <span class="co"># 2</span></a>
<a class="sourceLine" id="cb1471-19" title="19">  traj.atom_slice(traj.top.select(<span class="st">&#39;name CA&#39;</span>), inplace<span class="op">=</span><span class="va">True</span>)</a>
<a class="sourceLine" id="cb1471-20" title="20">  <span class="co"># 3</span></a>
<a class="sourceLine" id="cb1471-21" title="21">  pairs <span class="op">=</span> traj.top.select_pairs(<span class="st">&#39;name CA&#39;</span>, <span class="st">&#39;name CA&#39;</span>)</a>
<a class="sourceLine" id="cb1471-22" title="22">  <span class="co"># 4</span></a>
<a class="sourceLine" id="cb1471-23" title="23">  distances <span class="op">=</span> md.compute_distances(traj, pairs)</a>
<a class="sourceLine" id="cb1471-24" title="24">  <span class="cf">return</span> distances</a>
<a class="sourceLine" id="cb1471-25" title="25"></a>
<a class="sourceLine" id="cb1471-26" title="26"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1471-27" title="27"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb1471-28" title="28"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb1471-29" title="29"></a>
<a class="sourceLine" id="cb1471-30" title="30">pdb_file <span class="op">=</span> os.path.join(_FILE_DIR_, <span class="st">&quot;1VII.pdb&quot;</span>)</a>
<a class="sourceLine" id="cb1471-31" title="31"></a>
<a class="sourceLine" id="cb1471-32" title="32"></a>
<a class="sourceLine" id="cb1471-33" title="33"><span class="kw">def</span> pairwise(pdb_file):</a>
<a class="sourceLine" id="cb1471-34" title="34">    <span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb1471-35" title="35">    <span class="im">from</span> itertools <span class="im">import</span> combinations</a>
<a class="sourceLine" id="cb1471-36" title="36">    pdb <span class="op">=</span> md.load(pdb_file)</a>
<a class="sourceLine" id="cb1471-37" title="37">    cas <span class="op">=</span> pdb.top.select(<span class="st">&quot;name CA&quot;</span>)</a>
<a class="sourceLine" id="cb1471-38" title="38">    distances <span class="op">=</span> []</a>
<a class="sourceLine" id="cb1471-39" title="39">    comb <span class="op">=</span> combinations(cas, <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1471-40" title="40">    distances <span class="op">=</span> md.compute_distances(pdb, comb, periodic<span class="op">=</span><span class="va">True</span>)</a>
<a class="sourceLine" id="cb1471-41" title="41">    <span class="cf">return</span> distances</a>
<a class="sourceLine" id="cb1471-42" title="42"></a>
<a class="sourceLine" id="cb1471-43" title="43"></a>
<a class="sourceLine" id="cb1471-44" title="44">my_result <span class="op">=</span> pairwise(pdb_file)</a>
<a class="sourceLine" id="cb1471-45" title="45">nlcc_result <span class="op">=</span> pairwise_dist(pdb_file)</a>
<a class="sourceLine" id="cb1471-46" title="46"></a>
<a class="sourceLine" id="cb1471-47" title="47"><span class="co">#print(&quot;My result:&quot;, my_result)</span></a>
<a class="sourceLine" id="cb1471-48" title="48"><span class="co">#print(&quot;nlcc result&quot;, nlcc_result)</span></a>
<a class="sourceLine" id="cb1471-49" title="49"></a>
<a class="sourceLine" id="cb1471-50" title="50">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">abs</span>(np.mean(my_result) <span class="op">-</span></a>
<a class="sourceLine" id="cb1471-51" title="51">                        np.mean(nlcc_result)) <span class="op">&lt;</span> <span class="fl">0.01</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>&#39;Constant&#39; object has no attribute &#39;kind&#39;</code></pre>
<h4 id="run-4-133">Run 4</h4>
<div class="sourceCode" id="cb1473"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1473-1" title="1"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb1473-2" title="2"></a>
<a class="sourceLine" id="cb1473-3" title="3"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1473-4" title="4"><span class="co">Print version string</span></a>
<a class="sourceLine" id="cb1473-5" title="5"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1473-6" title="6"><span class="bu">print</span>(md.version.full_version)</a>
<a class="sourceLine" id="cb1473-7" title="7"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1473-8" title="8"></a>
<a class="sourceLine" id="cb1473-9" title="9"><span class="kw">def</span> pairwise_dist(pdb_file):</a>
<a class="sourceLine" id="cb1473-10" title="10">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1473-11" title="11"><span class="co">  1 This function loads a pdb</span></a>
<a class="sourceLine" id="cb1473-12" title="12"><span class="co">  2 Selects only the alpha carbons</span></a>
<a class="sourceLine" id="cb1473-13" title="13"><span class="co">  3 Calculates the number of unique alpha carbon pairs</span></a>
<a class="sourceLine" id="cb1473-14" title="14"><span class="co">  4 Returns the distances between each alpha carbon pair</span></a>
<a class="sourceLine" id="cb1473-15" title="15"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1473-16" title="16">  <span class="co"># Load the pdb file</span></a>
<a class="sourceLine" id="cb1473-17" title="17">  traj <span class="op">=</span> md.load(pdb_file)</a>
<a class="sourceLine" id="cb1473-18" title="18">  <span class="co"># Select only the alpha carbons</span></a>
<a class="sourceLine" id="cb1473-19" title="19">  alpha_carbons <span class="op">=</span> traj.topology.select(<span class="st">&#39;name CA&#39;</span>)</a>
<a class="sourceLine" id="cb1473-20" title="20">  <span class="co"># Calculate the number of unique alpha carbon pairs</span></a>
<a class="sourceLine" id="cb1473-21" title="21">  num_pairs <span class="op">=</span> <span class="bu">len</span>(alpha_carbons) <span class="op">*</span> (<span class="bu">len</span>(alpha_carbons) <span class="op">-</span> <span class="dv">1</span>) <span class="op">/</span> <span class="dv">2</span></a>
<a class="sourceLine" id="cb1473-22" title="22">  <span class="co"># Calculate the distances between each alpha carbon pair</span></a>
<a class="sourceLine" id="cb1473-23" title="23">  distances <span class="op">=</span> md.compute_distances(traj, alpha_carbons, alpha_carbons)</a>
<a class="sourceLine" id="cb1473-24" title="24">  <span class="co"># Return the distances</span></a>
<a class="sourceLine" id="cb1473-25" title="25">  <span class="cf">return</span> distances</a>
<a class="sourceLine" id="cb1473-26" title="26"></a>
<a class="sourceLine" id="cb1473-27" title="27"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1473-28" title="28"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb1473-29" title="29"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb1473-30" title="30"></a>
<a class="sourceLine" id="cb1473-31" title="31">pdb_file <span class="op">=</span> os.path.join(_FILE_DIR_, <span class="st">&quot;1VII.pdb&quot;</span>)</a>
<a class="sourceLine" id="cb1473-32" title="32"></a>
<a class="sourceLine" id="cb1473-33" title="33"></a>
<a class="sourceLine" id="cb1473-34" title="34"><span class="kw">def</span> pairwise(pdb_file):</a>
<a class="sourceLine" id="cb1473-35" title="35">    <span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb1473-36" title="36">    <span class="im">from</span> itertools <span class="im">import</span> combinations</a>
<a class="sourceLine" id="cb1473-37" title="37">    pdb <span class="op">=</span> md.load(pdb_file)</a>
<a class="sourceLine" id="cb1473-38" title="38">    cas <span class="op">=</span> pdb.top.select(<span class="st">&quot;name CA&quot;</span>)</a>
<a class="sourceLine" id="cb1473-39" title="39">    distances <span class="op">=</span> []</a>
<a class="sourceLine" id="cb1473-40" title="40">    comb <span class="op">=</span> combinations(cas, <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1473-41" title="41">    distances <span class="op">=</span> md.compute_distances(pdb, comb, periodic<span class="op">=</span><span class="va">True</span>)</a>
<a class="sourceLine" id="cb1473-42" title="42">    <span class="cf">return</span> distances</a>
<a class="sourceLine" id="cb1473-43" title="43"></a>
<a class="sourceLine" id="cb1473-44" title="44"></a>
<a class="sourceLine" id="cb1473-45" title="45">my_result <span class="op">=</span> pairwise(pdb_file)</a>
<a class="sourceLine" id="cb1473-46" title="46">nlcc_result <span class="op">=</span> pairwise_dist(pdb_file)</a>
<a class="sourceLine" id="cb1473-47" title="47"></a>
<a class="sourceLine" id="cb1473-48" title="48"><span class="co">#print(&quot;My result:&quot;, my_result)</span></a>
<a class="sourceLine" id="cb1473-49" title="49"><span class="co">#print(&quot;nlcc result&quot;, nlcc_result)</span></a>
<a class="sourceLine" id="cb1473-50" title="50"></a>
<a class="sourceLine" id="cb1473-51" title="51">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">abs</span>(np.mean(my_result) <span class="op">-</span></a>
<a class="sourceLine" id="cb1473-52" title="52">                        np.mean(nlcc_result)) <span class="op">&lt;</span> <span class="fl">0.01</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>&#39;Constant&#39; object has no attribute &#39;kind&#39;</code></pre>
</details>
<details>
<p><summary>pi</summary></p>
<h4 id="query-134">Query</h4>
<div class="sourceCode" id="cb1475"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1475-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1475-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1475-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1475-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1475-5" title="5"></a>
<a class="sourceLine" id="cb1475-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1475-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1475-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1475-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1475-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1475-11" title="11"></a>
<a class="sourceLine" id="cb1475-12" title="12"><span class="kw">def</span> pi(nsamples):</a>
<a class="sourceLine" id="cb1475-13" title="13">    <span class="co">&quot;&quot;&quot; This function returns the value of pi by monte carlo sampling &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1475-14" title="14">    </a></code></pre></div>
<h4 id="run-0-134">Run 0</h4>
<div class="sourceCode" id="cb1476"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1476-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1476-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1476-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1476-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1476-5" title="5"></a>
<a class="sourceLine" id="cb1476-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1476-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1476-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1476-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1476-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1476-11" title="11"></a>
<a class="sourceLine" id="cb1476-12" title="12"><span class="kw">def</span> pi(nsamples):</a>
<a class="sourceLine" id="cb1476-13" title="13">    <span class="co">&quot;&quot;&quot; This function returns the value of pi by monte carlo sampling &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1476-14" title="14">    x <span class="op">=</span> np.random.uniform(<span class="dv">0</span>,<span class="dv">1</span>,nsamples)</a>
<a class="sourceLine" id="cb1476-15" title="15">    y <span class="op">=</span> np.random.uniform(<span class="dv">0</span>,<span class="dv">1</span>,nsamples)</a>
<a class="sourceLine" id="cb1476-16" title="16">    r <span class="op">=</span> np.sqrt(x<span class="op">**</span><span class="dv">2</span> <span class="op">+</span> y<span class="op">**</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1476-17" title="17">    <span class="cf">return</span> <span class="dv">4</span><span class="op">*</span>np.<span class="bu">sum</span>(r<span class="op">&lt;</span><span class="dv">1</span>)<span class="op">/</span>nsamples</a>
<a class="sourceLine" id="cb1476-18" title="18"></a>
<a class="sourceLine" id="cb1476-19" title="19"></a>
<a class="sourceLine" id="cb1476-20" title="20">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">abs</span>(pi(<span class="dv">10000</span>)<span class="op">-</span><span class="fl">3.14159265</span>)<span class="op">&lt;</span><span class="fl">0.1</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-134">Run 1</h4>
<div class="sourceCode" id="cb1478"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1478-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1478-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1478-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1478-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1478-5" title="5"></a>
<a class="sourceLine" id="cb1478-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1478-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1478-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1478-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1478-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1478-11" title="11"></a>
<a class="sourceLine" id="cb1478-12" title="12"><span class="kw">def</span> pi(nsamples):</a>
<a class="sourceLine" id="cb1478-13" title="13">    <span class="co">&quot;&quot;&quot; This function returns the value of pi by monte carlo sampling &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1478-14" title="14">    nhits <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb1478-15" title="15">    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(nsamples):</a>
<a class="sourceLine" id="cb1478-16" title="16">        x <span class="op">=</span> np.random.uniform(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb1478-17" title="17">        y <span class="op">=</span> np.random.uniform(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb1478-18" title="18">        <span class="cf">if</span> x<span class="op">**</span><span class="dv">2</span> <span class="op">+</span> y<span class="op">**</span><span class="dv">2</span> <span class="op">&lt;</span> <span class="dv">1</span>:</a>
<a class="sourceLine" id="cb1478-19" title="19">            nhits <span class="op">+=</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb1478-20" title="20">    <span class="cf">return</span> <span class="dv">4</span><span class="op">*</span>nhits<span class="op">/</span>nsamples</a>
<a class="sourceLine" id="cb1478-21" title="21"></a>
<a class="sourceLine" id="cb1478-22" title="22"></a>
<a class="sourceLine" id="cb1478-23" title="23">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">abs</span>(pi(<span class="dv">10000</span>)<span class="op">-</span><span class="fl">3.14159265</span>)<span class="op">&lt;</span><span class="fl">0.1</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-134">Run 2</h4>
<div class="sourceCode" id="cb1480"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1480-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1480-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1480-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1480-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1480-5" title="5"></a>
<a class="sourceLine" id="cb1480-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1480-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1480-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1480-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1480-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1480-11" title="11"></a>
<a class="sourceLine" id="cb1480-12" title="12"><span class="kw">def</span> pi(nsamples):</a>
<a class="sourceLine" id="cb1480-13" title="13">    <span class="co">&quot;&quot;&quot; This function returns the value of pi by monte carlo sampling &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1480-14" title="14">    x <span class="op">=</span> np.random.uniform(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>,nsamples)</a>
<a class="sourceLine" id="cb1480-15" title="15">    y <span class="op">=</span> np.random.uniform(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>,nsamples)</a>
<a class="sourceLine" id="cb1480-16" title="16">    r <span class="op">=</span> np.sqrt(x<span class="op">**</span><span class="dv">2</span> <span class="op">+</span> y<span class="op">**</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1480-17" title="17">    <span class="cf">return</span> <span class="dv">4</span><span class="op">*</span>np.<span class="bu">sum</span>(r<span class="op">&lt;</span><span class="dv">1</span>)<span class="op">/</span>nsamples</a>
<a class="sourceLine" id="cb1480-18" title="18"></a>
<a class="sourceLine" id="cb1480-19" title="19"></a>
<a class="sourceLine" id="cb1480-20" title="20">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">abs</span>(pi(<span class="dv">10000</span>)<span class="op">-</span><span class="fl">3.14159265</span>)<span class="op">&lt;</span><span class="fl">0.1</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-134">Run 3</h4>
<div class="sourceCode" id="cb1482"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1482-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1482-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1482-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1482-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1482-5" title="5"></a>
<a class="sourceLine" id="cb1482-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1482-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1482-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1482-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1482-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1482-11" title="11"></a>
<a class="sourceLine" id="cb1482-12" title="12"><span class="kw">def</span> pi(nsamples):</a>
<a class="sourceLine" id="cb1482-13" title="13">    <span class="co">&quot;&quot;&quot; This function returns the value of pi by monte carlo sampling &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1482-14" title="14">    x <span class="op">=</span> np.random.rand(nsamples)</a>
<a class="sourceLine" id="cb1482-15" title="15">    y <span class="op">=</span> np.random.rand(nsamples)</a>
<a class="sourceLine" id="cb1482-16" title="16">    r <span class="op">=</span> np.sqrt(x<span class="op">**</span><span class="dv">2</span> <span class="op">+</span> y<span class="op">**</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1482-17" title="17">    <span class="cf">return</span> <span class="fl">4.0</span> <span class="op">*</span> np.<span class="bu">sum</span>(r <span class="op">&lt;</span> <span class="fl">1.0</span>) <span class="op">/</span> nsamples</a>
<a class="sourceLine" id="cb1482-18" title="18"></a>
<a class="sourceLine" id="cb1482-19" title="19"></a>
<a class="sourceLine" id="cb1482-20" title="20">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">abs</span>(pi(<span class="dv">10000</span>)<span class="op">-</span><span class="fl">3.14159265</span>)<span class="op">&lt;</span><span class="fl">0.1</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-134">Run 4</h4>
<div class="sourceCode" id="cb1484"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1484-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1484-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1484-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1484-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1484-5" title="5"></a>
<a class="sourceLine" id="cb1484-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1484-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1484-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1484-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1484-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1484-11" title="11"></a>
<a class="sourceLine" id="cb1484-12" title="12"><span class="kw">def</span> pi(nsamples):</a>
<a class="sourceLine" id="cb1484-13" title="13">    <span class="co">&quot;&quot;&quot; This function returns the value of pi by monte carlo sampling &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1484-14" title="14">    x <span class="op">=</span> np.random.uniform(<span class="dv">0</span>,<span class="dv">1</span>,nsamples)</a>
<a class="sourceLine" id="cb1484-15" title="15">    y <span class="op">=</span> np.random.uniform(<span class="dv">0</span>,<span class="dv">1</span>,nsamples)</a>
<a class="sourceLine" id="cb1484-16" title="16">    r <span class="op">=</span> np.sqrt(x<span class="op">**</span><span class="dv">2</span> <span class="op">+</span> y<span class="op">**</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1484-17" title="17">    <span class="cf">return</span> <span class="dv">4</span><span class="op">*</span>np.<span class="bu">sum</span>(r<span class="op">&lt;</span><span class="dv">1</span>)<span class="op">/</span>nsamples</a>
<a class="sourceLine" id="cb1484-18" title="18"></a>
<a class="sourceLine" id="cb1484-19" title="19"></a>
<a class="sourceLine" id="cb1484-20" title="20">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">abs</span>(pi(<span class="dv">10000</span>)<span class="op">-</span><span class="fl">3.14159265</span>)<span class="op">&lt;</span><span class="fl">0.1</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>pib_1d</summary></p>
<h4 id="query-135">Query</h4>
<div class="sourceCode" id="cb1486"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1486-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb1486-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb1486-3" title="3"></a>
<a class="sourceLine" id="cb1486-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1486-5" title="5"><span class="co">compute sin(pi/2)</span></a>
<a class="sourceLine" id="cb1486-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1486-7" title="7">x <span class="op">=</span> math.sin(math.pi <span class="op">/</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1486-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1486-9" title="9"></a>
<a class="sourceLine" id="cb1486-10" title="10"><span class="kw">def</span> particle_in_box(n,m,L,hbar<span class="op">=</span><span class="dv">1</span>):</a>
<a class="sourceLine" id="cb1486-11" title="11">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1486-12" title="12"><span class="co">   This function returns the energy for a quantum particle in a 1d box</span></a>
<a class="sourceLine" id="cb1486-13" title="13"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1486-14" title="14">   </a></code></pre></div>
<h4 id="run-0-135">Run 0</h4>
<div class="sourceCode" id="cb1487"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1487-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb1487-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb1487-3" title="3"></a>
<a class="sourceLine" id="cb1487-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1487-5" title="5"><span class="co">compute sin(pi/2)</span></a>
<a class="sourceLine" id="cb1487-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1487-7" title="7">x <span class="op">=</span> math.sin(math.pi <span class="op">/</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1487-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1487-9" title="9"></a>
<a class="sourceLine" id="cb1487-10" title="10"><span class="kw">def</span> particle_in_box(n,m,L,hbar<span class="op">=</span><span class="dv">1</span>):</a>
<a class="sourceLine" id="cb1487-11" title="11">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1487-12" title="12"><span class="co">   This function returns the energy for a quantum particle in a 1d box</span></a>
<a class="sourceLine" id="cb1487-13" title="13"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1487-14" title="14">   <span class="cf">return</span> (n<span class="op">**</span><span class="dv">2</span> <span class="op">*</span> math.pi<span class="op">**</span><span class="dv">2</span> <span class="op">*</span> hbar<span class="op">**</span><span class="dv">2</span>)<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>m<span class="op">*</span>L<span class="op">**</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1487-15" title="15"></a>
<a class="sourceLine" id="cb1487-16" title="16"></a>
<a class="sourceLine" id="cb1487-17" title="17"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1487-18" title="18"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1487-19" title="19"></a>
<a class="sourceLine" id="cb1487-20" title="20"><span class="co"># input params </span></a>
<a class="sourceLine" id="cb1487-21" title="21">L <span class="op">=</span> <span class="dv">10</span>     <span class="co"># length of the box</span></a>
<a class="sourceLine" id="cb1487-22" title="22">m <span class="op">=</span> <span class="dv">1</span>      <span class="co"># masss of the particle</span></a>
<a class="sourceLine" id="cb1487-23" title="23">n <span class="op">=</span> <span class="dv">10</span>     <span class="co"># quantum number </span></a>
<a class="sourceLine" id="cb1487-24" title="24">hbar <span class="op">=</span> <span class="dv">1</span>      <span class="co"># planck constant</span></a>
<a class="sourceLine" id="cb1487-25" title="25"></a>
<a class="sourceLine" id="cb1487-26" title="26"><span class="co"># energy</span></a>
<a class="sourceLine" id="cb1487-27" title="27">e_n <span class="op">=</span> ((n<span class="op">**</span><span class="dv">2</span>)<span class="op">*</span>(hbar<span class="op">**</span><span class="dv">2</span>)<span class="op">*</span>(np.pi<span class="op">**</span><span class="dv">2</span>))<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>m<span class="op">*</span>L<span class="op">**</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1487-28" title="28"><span class="bu">print</span>(<span class="st">&quot;energy =&quot;</span>, e_n)</a>
<a class="sourceLine" id="cb1487-29" title="29"></a>
<a class="sourceLine" id="cb1487-30" title="30">e_n_codex <span class="op">=</span> particle_in_box(n,m,L)  </a>
<a class="sourceLine" id="cb1487-31" title="31"><span class="bu">print</span>(<span class="st">&quot;energy from codex =&quot;</span>, e_n_codex)</a>
<a class="sourceLine" id="cb1487-32" title="32"></a>
<a class="sourceLine" id="cb1487-33" title="33"></a>
<a class="sourceLine" id="cb1487-34" title="34"><span class="co"># check</span></a>
<a class="sourceLine" id="cb1487-35" title="35"><span class="cf">if</span> <span class="bu">abs</span>(e_n <span class="op">-</span> e_n_codex) <span class="op">&lt;=</span> <span class="fl">1e-3</span>:</a>
<a class="sourceLine" id="cb1487-36" title="36">    result <span class="op">=</span> <span class="va">True</span> </a>
<a class="sourceLine" id="cb1487-37" title="37"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb1487-38" title="38">    result <span class="op">=</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb1487-39" title="39"></a>
<a class="sourceLine" id="cb1487-40" title="40"></a>
<a class="sourceLine" id="cb1487-41" title="41"></a>
<a class="sourceLine" id="cb1487-42" title="42"></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-135">Run 1</h4>
<div class="sourceCode" id="cb1489"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1489-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb1489-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb1489-3" title="3"></a>
<a class="sourceLine" id="cb1489-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1489-5" title="5"><span class="co">compute sin(pi/2)</span></a>
<a class="sourceLine" id="cb1489-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1489-7" title="7">x <span class="op">=</span> math.sin(math.pi <span class="op">/</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1489-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1489-9" title="9"></a>
<a class="sourceLine" id="cb1489-10" title="10"><span class="kw">def</span> particle_in_box(n,m,L,hbar<span class="op">=</span><span class="dv">1</span>):</a>
<a class="sourceLine" id="cb1489-11" title="11">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1489-12" title="12"><span class="co">   This function returns the energy for a quantum particle in a 1d box</span></a>
<a class="sourceLine" id="cb1489-13" title="13"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1489-14" title="14">   <span class="cf">return</span> (n<span class="op">**</span><span class="dv">2</span> <span class="op">*</span> math.pi<span class="op">**</span><span class="dv">2</span> <span class="op">*</span> hbar<span class="op">**</span><span class="dv">2</span>)<span class="op">/</span>(<span class="dv">2</span> <span class="op">*</span> m <span class="op">*</span> L<span class="op">**</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1489-15" title="15"></a>
<a class="sourceLine" id="cb1489-16" title="16"></a>
<a class="sourceLine" id="cb1489-17" title="17"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1489-18" title="18"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1489-19" title="19"></a>
<a class="sourceLine" id="cb1489-20" title="20"><span class="co"># input params </span></a>
<a class="sourceLine" id="cb1489-21" title="21">L <span class="op">=</span> <span class="dv">10</span>     <span class="co"># length of the box</span></a>
<a class="sourceLine" id="cb1489-22" title="22">m <span class="op">=</span> <span class="dv">1</span>      <span class="co"># masss of the particle</span></a>
<a class="sourceLine" id="cb1489-23" title="23">n <span class="op">=</span> <span class="dv">10</span>     <span class="co"># quantum number </span></a>
<a class="sourceLine" id="cb1489-24" title="24">hbar <span class="op">=</span> <span class="dv">1</span>      <span class="co"># planck constant</span></a>
<a class="sourceLine" id="cb1489-25" title="25"></a>
<a class="sourceLine" id="cb1489-26" title="26"><span class="co"># energy</span></a>
<a class="sourceLine" id="cb1489-27" title="27">e_n <span class="op">=</span> ((n<span class="op">**</span><span class="dv">2</span>)<span class="op">*</span>(hbar<span class="op">**</span><span class="dv">2</span>)<span class="op">*</span>(np.pi<span class="op">**</span><span class="dv">2</span>))<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>m<span class="op">*</span>L<span class="op">**</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1489-28" title="28"><span class="bu">print</span>(<span class="st">&quot;energy =&quot;</span>, e_n)</a>
<a class="sourceLine" id="cb1489-29" title="29"></a>
<a class="sourceLine" id="cb1489-30" title="30">e_n_codex <span class="op">=</span> particle_in_box(n,m,L)  </a>
<a class="sourceLine" id="cb1489-31" title="31"><span class="bu">print</span>(<span class="st">&quot;energy from codex =&quot;</span>, e_n_codex)</a>
<a class="sourceLine" id="cb1489-32" title="32"></a>
<a class="sourceLine" id="cb1489-33" title="33"></a>
<a class="sourceLine" id="cb1489-34" title="34"><span class="co"># check</span></a>
<a class="sourceLine" id="cb1489-35" title="35"><span class="cf">if</span> <span class="bu">abs</span>(e_n <span class="op">-</span> e_n_codex) <span class="op">&lt;=</span> <span class="fl">1e-3</span>:</a>
<a class="sourceLine" id="cb1489-36" title="36">    result <span class="op">=</span> <span class="va">True</span> </a>
<a class="sourceLine" id="cb1489-37" title="37"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb1489-38" title="38">    result <span class="op">=</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb1489-39" title="39"></a>
<a class="sourceLine" id="cb1489-40" title="40"></a>
<a class="sourceLine" id="cb1489-41" title="41"></a>
<a class="sourceLine" id="cb1489-42" title="42"></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-135">Run 2</h4>
<div class="sourceCode" id="cb1491"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1491-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb1491-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb1491-3" title="3"></a>
<a class="sourceLine" id="cb1491-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1491-5" title="5"><span class="co">compute sin(pi/2)</span></a>
<a class="sourceLine" id="cb1491-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1491-7" title="7">x <span class="op">=</span> math.sin(math.pi <span class="op">/</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1491-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1491-9" title="9"></a>
<a class="sourceLine" id="cb1491-10" title="10"><span class="kw">def</span> particle_in_box(n,m,L,hbar<span class="op">=</span><span class="dv">1</span>):</a>
<a class="sourceLine" id="cb1491-11" title="11">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1491-12" title="12"><span class="co">   This function returns the energy for a quantum particle in a 1d box</span></a>
<a class="sourceLine" id="cb1491-13" title="13"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1491-14" title="14">   <span class="cf">return</span> (n<span class="op">**</span><span class="dv">2</span> <span class="op">*</span> math.pi<span class="op">**</span><span class="dv">2</span> <span class="op">*</span> hbar<span class="op">**</span><span class="dv">2</span>) <span class="op">/</span> (<span class="dv">2</span> <span class="op">*</span> m <span class="op">*</span> L<span class="op">**</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1491-15" title="15"></a>
<a class="sourceLine" id="cb1491-16" title="16"></a>
<a class="sourceLine" id="cb1491-17" title="17"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1491-18" title="18"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1491-19" title="19"></a>
<a class="sourceLine" id="cb1491-20" title="20"><span class="co"># input params </span></a>
<a class="sourceLine" id="cb1491-21" title="21">L <span class="op">=</span> <span class="dv">10</span>     <span class="co"># length of the box</span></a>
<a class="sourceLine" id="cb1491-22" title="22">m <span class="op">=</span> <span class="dv">1</span>      <span class="co"># masss of the particle</span></a>
<a class="sourceLine" id="cb1491-23" title="23">n <span class="op">=</span> <span class="dv">10</span>     <span class="co"># quantum number </span></a>
<a class="sourceLine" id="cb1491-24" title="24">hbar <span class="op">=</span> <span class="dv">1</span>      <span class="co"># planck constant</span></a>
<a class="sourceLine" id="cb1491-25" title="25"></a>
<a class="sourceLine" id="cb1491-26" title="26"><span class="co"># energy</span></a>
<a class="sourceLine" id="cb1491-27" title="27">e_n <span class="op">=</span> ((n<span class="op">**</span><span class="dv">2</span>)<span class="op">*</span>(hbar<span class="op">**</span><span class="dv">2</span>)<span class="op">*</span>(np.pi<span class="op">**</span><span class="dv">2</span>))<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>m<span class="op">*</span>L<span class="op">**</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1491-28" title="28"><span class="bu">print</span>(<span class="st">&quot;energy =&quot;</span>, e_n)</a>
<a class="sourceLine" id="cb1491-29" title="29"></a>
<a class="sourceLine" id="cb1491-30" title="30">e_n_codex <span class="op">=</span> particle_in_box(n,m,L)  </a>
<a class="sourceLine" id="cb1491-31" title="31"><span class="bu">print</span>(<span class="st">&quot;energy from codex =&quot;</span>, e_n_codex)</a>
<a class="sourceLine" id="cb1491-32" title="32"></a>
<a class="sourceLine" id="cb1491-33" title="33"></a>
<a class="sourceLine" id="cb1491-34" title="34"><span class="co"># check</span></a>
<a class="sourceLine" id="cb1491-35" title="35"><span class="cf">if</span> <span class="bu">abs</span>(e_n <span class="op">-</span> e_n_codex) <span class="op">&lt;=</span> <span class="fl">1e-3</span>:</a>
<a class="sourceLine" id="cb1491-36" title="36">    result <span class="op">=</span> <span class="va">True</span> </a>
<a class="sourceLine" id="cb1491-37" title="37"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb1491-38" title="38">    result <span class="op">=</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb1491-39" title="39"></a>
<a class="sourceLine" id="cb1491-40" title="40"></a>
<a class="sourceLine" id="cb1491-41" title="41"></a>
<a class="sourceLine" id="cb1491-42" title="42"></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-135">Run 3</h4>
<div class="sourceCode" id="cb1493"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1493-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb1493-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb1493-3" title="3"></a>
<a class="sourceLine" id="cb1493-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1493-5" title="5"><span class="co">compute sin(pi/2)</span></a>
<a class="sourceLine" id="cb1493-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1493-7" title="7">x <span class="op">=</span> math.sin(math.pi <span class="op">/</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1493-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1493-9" title="9"></a>
<a class="sourceLine" id="cb1493-10" title="10"><span class="kw">def</span> particle_in_box(n,m,L,hbar<span class="op">=</span><span class="dv">1</span>):</a>
<a class="sourceLine" id="cb1493-11" title="11">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1493-12" title="12"><span class="co">   This function returns the energy for a quantum particle in a 1d box</span></a>
<a class="sourceLine" id="cb1493-13" title="13"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1493-14" title="14">   <span class="cf">return</span> (n<span class="op">**</span><span class="dv">2</span> <span class="op">*</span> math.pi<span class="op">**</span><span class="dv">2</span> <span class="op">*</span> hbar<span class="op">**</span><span class="dv">2</span>) <span class="op">/</span> (<span class="dv">2</span> <span class="op">*</span> m <span class="op">*</span> L<span class="op">**</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1493-15" title="15"></a>
<a class="sourceLine" id="cb1493-16" title="16"></a>
<a class="sourceLine" id="cb1493-17" title="17"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1493-18" title="18"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1493-19" title="19"></a>
<a class="sourceLine" id="cb1493-20" title="20"><span class="co"># input params </span></a>
<a class="sourceLine" id="cb1493-21" title="21">L <span class="op">=</span> <span class="dv">10</span>     <span class="co"># length of the box</span></a>
<a class="sourceLine" id="cb1493-22" title="22">m <span class="op">=</span> <span class="dv">1</span>      <span class="co"># masss of the particle</span></a>
<a class="sourceLine" id="cb1493-23" title="23">n <span class="op">=</span> <span class="dv">10</span>     <span class="co"># quantum number </span></a>
<a class="sourceLine" id="cb1493-24" title="24">hbar <span class="op">=</span> <span class="dv">1</span>      <span class="co"># planck constant</span></a>
<a class="sourceLine" id="cb1493-25" title="25"></a>
<a class="sourceLine" id="cb1493-26" title="26"><span class="co"># energy</span></a>
<a class="sourceLine" id="cb1493-27" title="27">e_n <span class="op">=</span> ((n<span class="op">**</span><span class="dv">2</span>)<span class="op">*</span>(hbar<span class="op">**</span><span class="dv">2</span>)<span class="op">*</span>(np.pi<span class="op">**</span><span class="dv">2</span>))<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>m<span class="op">*</span>L<span class="op">**</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1493-28" title="28"><span class="bu">print</span>(<span class="st">&quot;energy =&quot;</span>, e_n)</a>
<a class="sourceLine" id="cb1493-29" title="29"></a>
<a class="sourceLine" id="cb1493-30" title="30">e_n_codex <span class="op">=</span> particle_in_box(n,m,L)  </a>
<a class="sourceLine" id="cb1493-31" title="31"><span class="bu">print</span>(<span class="st">&quot;energy from codex =&quot;</span>, e_n_codex)</a>
<a class="sourceLine" id="cb1493-32" title="32"></a>
<a class="sourceLine" id="cb1493-33" title="33"></a>
<a class="sourceLine" id="cb1493-34" title="34"><span class="co"># check</span></a>
<a class="sourceLine" id="cb1493-35" title="35"><span class="cf">if</span> <span class="bu">abs</span>(e_n <span class="op">-</span> e_n_codex) <span class="op">&lt;=</span> <span class="fl">1e-3</span>:</a>
<a class="sourceLine" id="cb1493-36" title="36">    result <span class="op">=</span> <span class="va">True</span> </a>
<a class="sourceLine" id="cb1493-37" title="37"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb1493-38" title="38">    result <span class="op">=</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb1493-39" title="39"></a>
<a class="sourceLine" id="cb1493-40" title="40"></a>
<a class="sourceLine" id="cb1493-41" title="41"></a>
<a class="sourceLine" id="cb1493-42" title="42"></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-135">Run 4</h4>
<div class="sourceCode" id="cb1495"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1495-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb1495-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb1495-3" title="3"></a>
<a class="sourceLine" id="cb1495-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1495-5" title="5"><span class="co">compute sin(pi/2)</span></a>
<a class="sourceLine" id="cb1495-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1495-7" title="7">x <span class="op">=</span> math.sin(math.pi <span class="op">/</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1495-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1495-9" title="9"></a>
<a class="sourceLine" id="cb1495-10" title="10"><span class="kw">def</span> particle_in_box(n,m,L,hbar<span class="op">=</span><span class="dv">1</span>):</a>
<a class="sourceLine" id="cb1495-11" title="11">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1495-12" title="12"><span class="co">   This function returns the energy for a quantum particle in a 1d box</span></a>
<a class="sourceLine" id="cb1495-13" title="13"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1495-14" title="14">   <span class="cf">return</span> (n<span class="op">**</span><span class="dv">2</span> <span class="op">*</span> math.pi<span class="op">**</span><span class="dv">2</span> <span class="op">*</span> hbar<span class="op">**</span><span class="dv">2</span>) <span class="op">/</span> (<span class="dv">2</span> <span class="op">*</span> m <span class="op">*</span> L<span class="op">**</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1495-15" title="15"></a>
<a class="sourceLine" id="cb1495-16" title="16"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1495-17" title="17"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1495-18" title="18"></a>
<a class="sourceLine" id="cb1495-19" title="19"><span class="co"># input params </span></a>
<a class="sourceLine" id="cb1495-20" title="20">L <span class="op">=</span> <span class="dv">10</span>     <span class="co"># length of the box</span></a>
<a class="sourceLine" id="cb1495-21" title="21">m <span class="op">=</span> <span class="dv">1</span>      <span class="co"># masss of the particle</span></a>
<a class="sourceLine" id="cb1495-22" title="22">n <span class="op">=</span> <span class="dv">10</span>     <span class="co"># quantum number </span></a>
<a class="sourceLine" id="cb1495-23" title="23">hbar <span class="op">=</span> <span class="dv">1</span>      <span class="co"># planck constant</span></a>
<a class="sourceLine" id="cb1495-24" title="24"></a>
<a class="sourceLine" id="cb1495-25" title="25"><span class="co"># energy</span></a>
<a class="sourceLine" id="cb1495-26" title="26">e_n <span class="op">=</span> ((n<span class="op">**</span><span class="dv">2</span>)<span class="op">*</span>(hbar<span class="op">**</span><span class="dv">2</span>)<span class="op">*</span>(np.pi<span class="op">**</span><span class="dv">2</span>))<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>m<span class="op">*</span>L<span class="op">**</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1495-27" title="27"><span class="bu">print</span>(<span class="st">&quot;energy =&quot;</span>, e_n)</a>
<a class="sourceLine" id="cb1495-28" title="28"></a>
<a class="sourceLine" id="cb1495-29" title="29">e_n_codex <span class="op">=</span> particle_in_box(n,m,L)  </a>
<a class="sourceLine" id="cb1495-30" title="30"><span class="bu">print</span>(<span class="st">&quot;energy from codex =&quot;</span>, e_n_codex)</a>
<a class="sourceLine" id="cb1495-31" title="31"></a>
<a class="sourceLine" id="cb1495-32" title="32"></a>
<a class="sourceLine" id="cb1495-33" title="33"><span class="co"># check</span></a>
<a class="sourceLine" id="cb1495-34" title="34"><span class="cf">if</span> <span class="bu">abs</span>(e_n <span class="op">-</span> e_n_codex) <span class="op">&lt;=</span> <span class="fl">1e-3</span>:</a>
<a class="sourceLine" id="cb1495-35" title="35">    result <span class="op">=</span> <span class="va">True</span> </a>
<a class="sourceLine" id="cb1495-36" title="36"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb1495-37" title="37">    result <span class="op">=</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb1495-38" title="38"></a>
<a class="sourceLine" id="cb1495-39" title="39"></a>
<a class="sourceLine" id="cb1495-40" title="40"></a>
<a class="sourceLine" id="cb1495-41" title="41"></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>pred_interval</summary></p>
<h4 id="query-136">Query</h4>
<div class="sourceCode" id="cb1497"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1497-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1497-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1497-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1497-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1497-5" title="5"></a>
<a class="sourceLine" id="cb1497-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1497-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1497-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1497-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1497-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1497-11" title="11"></a>
<a class="sourceLine" id="cb1497-12" title="12"><span class="kw">def</span> num_trials(pred_level, p):</a>
<a class="sourceLine" id="cb1497-13" title="13">   <span class="co">&quot;&quot;&quot;Returns the minimum number of trials needed to achieve</span></a>
<a class="sourceLine" id="cb1497-14" title="14"><span class="co">      a probability given by pred_level in a geometric distribution</span></a>
<a class="sourceLine" id="cb1497-15" title="15"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1497-16" title="16">   </a></code></pre></div>
<h4 id="run-0-136">Run 0</h4>
<div class="sourceCode" id="cb1498"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1498-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1498-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1498-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1498-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1498-5" title="5"></a>
<a class="sourceLine" id="cb1498-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1498-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1498-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1498-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1498-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1498-11" title="11"></a>
<a class="sourceLine" id="cb1498-12" title="12"><span class="kw">def</span> num_trials(pred_level, p):</a>
<a class="sourceLine" id="cb1498-13" title="13">   <span class="co">&quot;&quot;&quot;Returns the minimum number of trials needed to achieve</span></a>
<a class="sourceLine" id="cb1498-14" title="14"><span class="co">      a probability given by pred_level in a geometric distribution</span></a>
<a class="sourceLine" id="cb1498-15" title="15"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1498-16" title="16">   <span class="cf">return</span> <span class="bu">int</span>(np.ceil(np.log(<span class="dv">1</span><span class="op">-</span>pred_level)<span class="op">/</span>np.log(<span class="dv">1</span><span class="op">-</span>p)))</a>
<a class="sourceLine" id="cb1498-17" title="17"></a>
<a class="sourceLine" id="cb1498-18" title="18"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1498-19" title="19"></a>
<a class="sourceLine" id="cb1498-20" title="20">prediction_level <span class="op">=</span> <span class="fl">0.9</span></a>
<a class="sourceLine" id="cb1498-21" title="21">samples <span class="op">=</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="dv">100</span>)</a>
<a class="sourceLine" id="cb1498-22" title="22">p <span class="op">=</span> <span class="fl">0.1</span></a>
<a class="sourceLine" id="cb1498-23" title="23">psum <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb1498-24" title="24"><span class="cf">for</span> n <span class="kw">in</span> samples:</a>
<a class="sourceLine" id="cb1498-25" title="25">    psum <span class="op">+=</span> (<span class="dv">1</span> <span class="op">-</span> p) <span class="op">**</span> (n <span class="op">-</span> <span class="dv">1</span>) <span class="op">*</span> p</a>
<a class="sourceLine" id="cb1498-26" title="26">    <span class="cf">if</span>(psum <span class="op">&gt;=</span> prediction_level):</a>
<a class="sourceLine" id="cb1498-27" title="27">        <span class="cf">break</span></a>
<a class="sourceLine" id="cb1498-28" title="28"></a>
<a class="sourceLine" id="cb1498-29" title="29">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> num_trials(prediction_level, p) <span class="op">==</span> n <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-136">Run 1</h4>
<div class="sourceCode" id="cb1500"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1500-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1500-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1500-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1500-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1500-5" title="5"></a>
<a class="sourceLine" id="cb1500-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1500-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1500-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1500-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1500-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1500-11" title="11"></a>
<a class="sourceLine" id="cb1500-12" title="12"><span class="kw">def</span> num_trials(pred_level, p):</a>
<a class="sourceLine" id="cb1500-13" title="13">   <span class="co">&quot;&quot;&quot;Returns the minimum number of trials needed to achieve</span></a>
<a class="sourceLine" id="cb1500-14" title="14"><span class="co">      a probability given by pred_level in a geometric distribution</span></a>
<a class="sourceLine" id="cb1500-15" title="15"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1500-16" title="16">   <span class="cf">return</span> <span class="bu">int</span>(np.ceil(np.log(<span class="dv">1</span><span class="op">-</span>pred_level)<span class="op">/</span>np.log(<span class="dv">1</span><span class="op">-</span>p)))</a>
<a class="sourceLine" id="cb1500-17" title="17"></a>
<a class="sourceLine" id="cb1500-18" title="18"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1500-19" title="19"></a>
<a class="sourceLine" id="cb1500-20" title="20">prediction_level <span class="op">=</span> <span class="fl">0.9</span></a>
<a class="sourceLine" id="cb1500-21" title="21">samples <span class="op">=</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="dv">100</span>)</a>
<a class="sourceLine" id="cb1500-22" title="22">p <span class="op">=</span> <span class="fl">0.1</span></a>
<a class="sourceLine" id="cb1500-23" title="23">psum <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb1500-24" title="24"><span class="cf">for</span> n <span class="kw">in</span> samples:</a>
<a class="sourceLine" id="cb1500-25" title="25">    psum <span class="op">+=</span> (<span class="dv">1</span> <span class="op">-</span> p) <span class="op">**</span> (n <span class="op">-</span> <span class="dv">1</span>) <span class="op">*</span> p</a>
<a class="sourceLine" id="cb1500-26" title="26">    <span class="cf">if</span>(psum <span class="op">&gt;=</span> prediction_level):</a>
<a class="sourceLine" id="cb1500-27" title="27">        <span class="cf">break</span></a>
<a class="sourceLine" id="cb1500-28" title="28"></a>
<a class="sourceLine" id="cb1500-29" title="29">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> num_trials(prediction_level, p) <span class="op">==</span> n <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-136">Run 2</h4>
<div class="sourceCode" id="cb1502"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1502-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1502-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1502-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1502-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1502-5" title="5"></a>
<a class="sourceLine" id="cb1502-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1502-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1502-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1502-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1502-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1502-11" title="11"></a>
<a class="sourceLine" id="cb1502-12" title="12"><span class="kw">def</span> num_trials(pred_level, p):</a>
<a class="sourceLine" id="cb1502-13" title="13">   <span class="co">&quot;&quot;&quot;Returns the minimum number of trials needed to achieve</span></a>
<a class="sourceLine" id="cb1502-14" title="14"><span class="co">      a probability given by pred_level in a geometric distribution</span></a>
<a class="sourceLine" id="cb1502-15" title="15"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1502-16" title="16">   <span class="cf">return</span> np.ceil(np.log(<span class="dv">1</span><span class="op">-</span>pred_level)<span class="op">/</span>np.log(<span class="dv">1</span><span class="op">-</span>p))</a>
<a class="sourceLine" id="cb1502-17" title="17"></a>
<a class="sourceLine" id="cb1502-18" title="18"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1502-19" title="19"></a>
<a class="sourceLine" id="cb1502-20" title="20">prediction_level <span class="op">=</span> <span class="fl">0.9</span></a>
<a class="sourceLine" id="cb1502-21" title="21">samples <span class="op">=</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="dv">100</span>)</a>
<a class="sourceLine" id="cb1502-22" title="22">p <span class="op">=</span> <span class="fl">0.1</span></a>
<a class="sourceLine" id="cb1502-23" title="23">psum <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb1502-24" title="24"><span class="cf">for</span> n <span class="kw">in</span> samples:</a>
<a class="sourceLine" id="cb1502-25" title="25">    psum <span class="op">+=</span> (<span class="dv">1</span> <span class="op">-</span> p) <span class="op">**</span> (n <span class="op">-</span> <span class="dv">1</span>) <span class="op">*</span> p</a>
<a class="sourceLine" id="cb1502-26" title="26">    <span class="cf">if</span>(psum <span class="op">&gt;=</span> prediction_level):</a>
<a class="sourceLine" id="cb1502-27" title="27">        <span class="cf">break</span></a>
<a class="sourceLine" id="cb1502-28" title="28"></a>
<a class="sourceLine" id="cb1502-29" title="29">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> num_trials(prediction_level, p) <span class="op">==</span> n <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-136">Run 3</h4>
<div class="sourceCode" id="cb1504"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1504-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1504-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1504-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1504-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1504-5" title="5"></a>
<a class="sourceLine" id="cb1504-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1504-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1504-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1504-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1504-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1504-11" title="11"></a>
<a class="sourceLine" id="cb1504-12" title="12"><span class="kw">def</span> num_trials(pred_level, p):</a>
<a class="sourceLine" id="cb1504-13" title="13">   <span class="co">&quot;&quot;&quot;Returns the minimum number of trials needed to achieve</span></a>
<a class="sourceLine" id="cb1504-14" title="14"><span class="co">      a probability given by pred_level in a geometric distribution</span></a>
<a class="sourceLine" id="cb1504-15" title="15"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1504-16" title="16">   <span class="cf">return</span> np.ceil(np.log(<span class="dv">1</span><span class="op">-</span>pred_level)<span class="op">/</span>np.log(<span class="dv">1</span><span class="op">-</span>p))</a>
<a class="sourceLine" id="cb1504-17" title="17"></a>
<a class="sourceLine" id="cb1504-18" title="18"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1504-19" title="19"></a>
<a class="sourceLine" id="cb1504-20" title="20">prediction_level <span class="op">=</span> <span class="fl">0.9</span></a>
<a class="sourceLine" id="cb1504-21" title="21">samples <span class="op">=</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="dv">100</span>)</a>
<a class="sourceLine" id="cb1504-22" title="22">p <span class="op">=</span> <span class="fl">0.1</span></a>
<a class="sourceLine" id="cb1504-23" title="23">psum <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb1504-24" title="24"><span class="cf">for</span> n <span class="kw">in</span> samples:</a>
<a class="sourceLine" id="cb1504-25" title="25">    psum <span class="op">+=</span> (<span class="dv">1</span> <span class="op">-</span> p) <span class="op">**</span> (n <span class="op">-</span> <span class="dv">1</span>) <span class="op">*</span> p</a>
<a class="sourceLine" id="cb1504-26" title="26">    <span class="cf">if</span>(psum <span class="op">&gt;=</span> prediction_level):</a>
<a class="sourceLine" id="cb1504-27" title="27">        <span class="cf">break</span></a>
<a class="sourceLine" id="cb1504-28" title="28"></a>
<a class="sourceLine" id="cb1504-29" title="29">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> num_trials(prediction_level, p) <span class="op">==</span> n <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-136">Run 4</h4>
<div class="sourceCode" id="cb1506"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1506-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1506-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1506-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1506-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1506-5" title="5"></a>
<a class="sourceLine" id="cb1506-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1506-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1506-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1506-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1506-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1506-11" title="11"></a>
<a class="sourceLine" id="cb1506-12" title="12"><span class="kw">def</span> num_trials(pred_level, p):</a>
<a class="sourceLine" id="cb1506-13" title="13">   <span class="co">&quot;&quot;&quot;Returns the minimum number of trials needed to achieve</span></a>
<a class="sourceLine" id="cb1506-14" title="14"><span class="co">      a probability given by pred_level in a geometric distribution</span></a>
<a class="sourceLine" id="cb1506-15" title="15"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1506-16" title="16">   <span class="cf">return</span> np.ceil(np.log(<span class="dv">1</span><span class="op">-</span>pred_level)<span class="op">/</span>np.log(<span class="dv">1</span><span class="op">-</span>p))</a>
<a class="sourceLine" id="cb1506-17" title="17"></a>
<a class="sourceLine" id="cb1506-18" title="18"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1506-19" title="19"></a>
<a class="sourceLine" id="cb1506-20" title="20">prediction_level <span class="op">=</span> <span class="fl">0.9</span></a>
<a class="sourceLine" id="cb1506-21" title="21">samples <span class="op">=</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="dv">100</span>)</a>
<a class="sourceLine" id="cb1506-22" title="22">p <span class="op">=</span> <span class="fl">0.1</span></a>
<a class="sourceLine" id="cb1506-23" title="23">psum <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb1506-24" title="24"><span class="cf">for</span> n <span class="kw">in</span> samples:</a>
<a class="sourceLine" id="cb1506-25" title="25">    psum <span class="op">+=</span> (<span class="dv">1</span> <span class="op">-</span> p) <span class="op">**</span> (n <span class="op">-</span> <span class="dv">1</span>) <span class="op">*</span> p</a>
<a class="sourceLine" id="cb1506-26" title="26">    <span class="cf">if</span>(psum <span class="op">&gt;=</span> prediction_level):</a>
<a class="sourceLine" id="cb1506-27" title="27">        <span class="cf">break</span></a>
<a class="sourceLine" id="cb1506-28" title="28"></a>
<a class="sourceLine" id="cb1506-29" title="29">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> num_trials(prediction_level, p) <span class="op">==</span> n <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>pubchem</summary></p>
<h4 id="query-137">Query</h4>
<div class="sourceCode" id="cb1508"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1508-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1508-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb1508-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb1508-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb1508-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb1508-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb1508-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb1508-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb1508-9" title="9"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb1508-10" title="10"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb1508-11" title="11"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1508-12" title="12"></a>
<a class="sourceLine" id="cb1508-13" title="13"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1508-14" title="14"><span class="co">print rdkit version</span></a>
<a class="sourceLine" id="cb1508-15" title="15"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1508-16" title="16"><span class="bu">print</span>(rdkit.__version__)</a>
<a class="sourceLine" id="cb1508-17" title="17"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1508-18" title="18"></a>
<a class="sourceLine" id="cb1508-19" title="19"><span class="im">import</span> requests</a>
<a class="sourceLine" id="cb1508-20" title="20"></a>
<a class="sourceLine" id="cb1508-21" title="21"><span class="kw">def</span> find_similar(smiles):</a>
<a class="sourceLine" id="cb1508-22" title="22">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1508-23" title="23"><span class="co">  Returns a set of molecules with greater than 80% similarity using the PubChem REST API.</span></a>
<a class="sourceLine" id="cb1508-24" title="24"><span class="co">  The returned molecules are SMILES strings, not CIDs.</span></a>
<a class="sourceLine" id="cb1508-25" title="25"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1508-26" title="26">  </a></code></pre></div>
<h4 id="run-0-137">Run 0</h4>
<div class="sourceCode" id="cb1509"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1509-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1509-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb1509-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb1509-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb1509-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb1509-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb1509-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb1509-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb1509-9" title="9"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb1509-10" title="10"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb1509-11" title="11"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1509-12" title="12"></a>
<a class="sourceLine" id="cb1509-13" title="13"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1509-14" title="14"><span class="co">print rdkit version</span></a>
<a class="sourceLine" id="cb1509-15" title="15"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1509-16" title="16"><span class="bu">print</span>(rdkit.__version__)</a>
<a class="sourceLine" id="cb1509-17" title="17"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1509-18" title="18"></a>
<a class="sourceLine" id="cb1509-19" title="19"><span class="im">import</span> requests</a>
<a class="sourceLine" id="cb1509-20" title="20"></a>
<a class="sourceLine" id="cb1509-21" title="21"><span class="kw">def</span> find_similar(smiles):</a>
<a class="sourceLine" id="cb1509-22" title="22">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1509-23" title="23"><span class="co">  Returns a set of molecules with greater than 80% similarity using the PubChem REST API.</span></a>
<a class="sourceLine" id="cb1509-24" title="24"><span class="co">  The returned molecules are SMILES strings, not CIDs.</span></a>
<a class="sourceLine" id="cb1509-25" title="25"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1509-26" title="26">  url <span class="op">=</span> <span class="st">&quot;https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/smiles/</span><span class="sc">%s</span><span class="st">/cids/TXT&quot;</span> <span class="op">%</span> smiles</a>
<a class="sourceLine" id="cb1509-27" title="27">  r <span class="op">=</span> requests.get(url)</a>
<a class="sourceLine" id="cb1509-28" title="28">  cids <span class="op">=</span> r.text.split()</a>
<a class="sourceLine" id="cb1509-29" title="29">  cids <span class="op">=</span> <span class="st">&quot;,&quot;</span>.join(cids)</a>
<a class="sourceLine" id="cb1509-30" title="30">  url <span class="op">=</span> <span class="st">&quot;https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/cid/</span><span class="sc">%s</span><span class="st">/property/CanonicalSMILES/TXT&quot;</span> <span class="op">%</span> cids</a>
<a class="sourceLine" id="cb1509-31" title="31">  r <span class="op">=</span> requests.get(url)</a>
<a class="sourceLine" id="cb1509-32" title="32">  <span class="cf">return</span> <span class="bu">set</span>(r.text.split())</a>
<a class="sourceLine" id="cb1509-33" title="33"></a>
<a class="sourceLine" id="cb1509-34" title="34"></a>
<a class="sourceLine" id="cb1509-35" title="35"><span class="im">import</span> requests</a>
<a class="sourceLine" id="cb1509-36" title="36"><span class="im">import</span> time</a>
<a class="sourceLine" id="cb1509-37" title="37"></a>
<a class="sourceLine" id="cb1509-38" title="38">time.sleep(<span class="fl">0.5</span>)</a>
<a class="sourceLine" id="cb1509-39" title="39"></a>
<a class="sourceLine" id="cb1509-40" title="40"></a>
<a class="sourceLine" id="cb1509-41" title="41"><span class="kw">def</span> ref_find_similar(s):</a>
<a class="sourceLine" id="cb1509-42" title="42">    url <span class="op">=</span> <span class="ss">f&quot;https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/fastsimilarity_2d/smiles/</span><span class="sc">{s}</span><span class="ss">/property/CanonicalSMILES/JSON&quot;</span></a>
<a class="sourceLine" id="cb1509-43" title="43">    reply <span class="op">=</span> requests.get(</a>
<a class="sourceLine" id="cb1509-44" title="44">        url,</a>
<a class="sourceLine" id="cb1509-45" title="45">        params<span class="op">=</span>{<span class="st">&quot;Threshold&quot;</span>: <span class="dv">80</span>, <span class="st">&quot;MaxRecords&quot;</span>: <span class="dv">100</span>},</a>
<a class="sourceLine" id="cb1509-46" title="46">        headers<span class="op">=</span>{<span class="st">&quot;accept&quot;</span>: <span class="st">&quot;text/json&quot;</span>},</a>
<a class="sourceLine" id="cb1509-47" title="47">        timeout<span class="op">=</span><span class="dv">10</span>,</a>
<a class="sourceLine" id="cb1509-48" title="48">    )</a>
<a class="sourceLine" id="cb1509-49" title="49">    data <span class="op">=</span> reply.json()</a>
<a class="sourceLine" id="cb1509-50" title="50">    smiles <span class="op">=</span> [d[<span class="st">&quot;CanonicalSMILES&quot;</span>]</a>
<a class="sourceLine" id="cb1509-51" title="51">              <span class="cf">for</span> d <span class="kw">in</span> data[<span class="st">&quot;PropertyTable&quot;</span>][<span class="st">&quot;Properties&quot;</span>]]</a>
<a class="sourceLine" id="cb1509-52" title="52">    smiles <span class="op">=</span> <span class="bu">set</span>(smiles)</a>
<a class="sourceLine" id="cb1509-53" title="53">    <span class="cf">return</span> smiles</a>
<a class="sourceLine" id="cb1509-54" title="54"></a>
<a class="sourceLine" id="cb1509-55" title="55"></a>
<a class="sourceLine" id="cb1509-56" title="56">s <span class="op">=</span> <span class="st">&#39;CC=C=C(C(=O)N)&#39;</span></a>
<a class="sourceLine" id="cb1509-57" title="57">ref_sim <span class="op">=</span> ref_find_similar(s)</a>
<a class="sourceLine" id="cb1509-58" title="58">sim <span class="op">=</span> find_similar(s)</a>
<a class="sourceLine" id="cb1509-59" title="59">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> ref_sim <span class="op">==</span> <span class="bu">set</span>(sim) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-137">Run 1</h4>
<div class="sourceCode" id="cb1511"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1511-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1511-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb1511-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb1511-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb1511-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb1511-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb1511-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb1511-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb1511-9" title="9"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb1511-10" title="10"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb1511-11" title="11"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1511-12" title="12"></a>
<a class="sourceLine" id="cb1511-13" title="13"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1511-14" title="14"><span class="co">print rdkit version</span></a>
<a class="sourceLine" id="cb1511-15" title="15"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1511-16" title="16"><span class="bu">print</span>(rdkit.__version__)</a>
<a class="sourceLine" id="cb1511-17" title="17"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1511-18" title="18"></a>
<a class="sourceLine" id="cb1511-19" title="19"><span class="im">import</span> requests</a>
<a class="sourceLine" id="cb1511-20" title="20"></a>
<a class="sourceLine" id="cb1511-21" title="21"><span class="kw">def</span> find_similar(smiles):</a>
<a class="sourceLine" id="cb1511-22" title="22">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1511-23" title="23"><span class="co">  Returns a set of molecules with greater than 80% similarity using the PubChem REST API.</span></a>
<a class="sourceLine" id="cb1511-24" title="24"><span class="co">  The returned molecules are SMILES strings, not CIDs.</span></a>
<a class="sourceLine" id="cb1511-25" title="25"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1511-26" title="26">  url <span class="op">=</span> <span class="st">&quot;https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/smiles/</span><span class="sc">%s</span><span class="st">/cids/TXT&quot;</span> <span class="op">%</span> smiles</a>
<a class="sourceLine" id="cb1511-27" title="27">  response <span class="op">=</span> requests.get(url)</a>
<a class="sourceLine" id="cb1511-28" title="28">  cids <span class="op">=</span> response.text.split()</a>
<a class="sourceLine" id="cb1511-29" title="29">  cids <span class="op">=</span> <span class="st">&quot;,&quot;</span>.join(cids)</a>
<a class="sourceLine" id="cb1511-30" title="30">  url <span class="op">=</span> <span class="st">&quot;https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/cid/</span><span class="sc">%s</span><span class="st">/property/CanonicalSMILES/TXT&quot;</span> <span class="op">%</span> cids</a>
<a class="sourceLine" id="cb1511-31" title="31">  response <span class="op">=</span> requests.get(url)</a>
<a class="sourceLine" id="cb1511-32" title="32">  <span class="cf">return</span> <span class="bu">set</span>(response.text.split())</a>
<a class="sourceLine" id="cb1511-33" title="33"></a>
<a class="sourceLine" id="cb1511-34" title="34"></a>
<a class="sourceLine" id="cb1511-35" title="35"><span class="im">import</span> requests</a>
<a class="sourceLine" id="cb1511-36" title="36"><span class="im">import</span> time</a>
<a class="sourceLine" id="cb1511-37" title="37"></a>
<a class="sourceLine" id="cb1511-38" title="38">time.sleep(<span class="fl">0.5</span>)</a>
<a class="sourceLine" id="cb1511-39" title="39"></a>
<a class="sourceLine" id="cb1511-40" title="40"></a>
<a class="sourceLine" id="cb1511-41" title="41"><span class="kw">def</span> ref_find_similar(s):</a>
<a class="sourceLine" id="cb1511-42" title="42">    url <span class="op">=</span> <span class="ss">f&quot;https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/fastsimilarity_2d/smiles/</span><span class="sc">{s}</span><span class="ss">/property/CanonicalSMILES/JSON&quot;</span></a>
<a class="sourceLine" id="cb1511-43" title="43">    reply <span class="op">=</span> requests.get(</a>
<a class="sourceLine" id="cb1511-44" title="44">        url,</a>
<a class="sourceLine" id="cb1511-45" title="45">        params<span class="op">=</span>{<span class="st">&quot;Threshold&quot;</span>: <span class="dv">80</span>, <span class="st">&quot;MaxRecords&quot;</span>: <span class="dv">100</span>},</a>
<a class="sourceLine" id="cb1511-46" title="46">        headers<span class="op">=</span>{<span class="st">&quot;accept&quot;</span>: <span class="st">&quot;text/json&quot;</span>},</a>
<a class="sourceLine" id="cb1511-47" title="47">        timeout<span class="op">=</span><span class="dv">10</span>,</a>
<a class="sourceLine" id="cb1511-48" title="48">    )</a>
<a class="sourceLine" id="cb1511-49" title="49">    data <span class="op">=</span> reply.json()</a>
<a class="sourceLine" id="cb1511-50" title="50">    smiles <span class="op">=</span> [d[<span class="st">&quot;CanonicalSMILES&quot;</span>]</a>
<a class="sourceLine" id="cb1511-51" title="51">              <span class="cf">for</span> d <span class="kw">in</span> data[<span class="st">&quot;PropertyTable&quot;</span>][<span class="st">&quot;Properties&quot;</span>]]</a>
<a class="sourceLine" id="cb1511-52" title="52">    smiles <span class="op">=</span> <span class="bu">set</span>(smiles)</a>
<a class="sourceLine" id="cb1511-53" title="53">    <span class="cf">return</span> smiles</a>
<a class="sourceLine" id="cb1511-54" title="54"></a>
<a class="sourceLine" id="cb1511-55" title="55"></a>
<a class="sourceLine" id="cb1511-56" title="56">s <span class="op">=</span> <span class="st">&#39;CC=C=C(C(=O)N)&#39;</span></a>
<a class="sourceLine" id="cb1511-57" title="57">ref_sim <span class="op">=</span> ref_find_similar(s)</a>
<a class="sourceLine" id="cb1511-58" title="58">sim <span class="op">=</span> find_similar(s)</a>
<a class="sourceLine" id="cb1511-59" title="59">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> ref_sim <span class="op">==</span> <span class="bu">set</span>(sim) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-137">Run 2</h4>
<div class="sourceCode" id="cb1513"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1513-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1513-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb1513-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb1513-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb1513-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb1513-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb1513-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb1513-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb1513-9" title="9"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb1513-10" title="10"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb1513-11" title="11"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1513-12" title="12"></a>
<a class="sourceLine" id="cb1513-13" title="13"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1513-14" title="14"><span class="co">print rdkit version</span></a>
<a class="sourceLine" id="cb1513-15" title="15"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1513-16" title="16"><span class="bu">print</span>(rdkit.__version__)</a>
<a class="sourceLine" id="cb1513-17" title="17"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1513-18" title="18"></a>
<a class="sourceLine" id="cb1513-19" title="19"><span class="im">import</span> requests</a>
<a class="sourceLine" id="cb1513-20" title="20"></a>
<a class="sourceLine" id="cb1513-21" title="21"><span class="kw">def</span> find_similar(smiles):</a>
<a class="sourceLine" id="cb1513-22" title="22">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1513-23" title="23"><span class="co">  Returns a set of molecules with greater than 80% similarity using the PubChem REST API.</span></a>
<a class="sourceLine" id="cb1513-24" title="24"><span class="co">  The returned molecules are SMILES strings, not CIDs.</span></a>
<a class="sourceLine" id="cb1513-25" title="25"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1513-26" title="26">  url <span class="op">=</span> <span class="st">&#39;https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/smiles/</span><span class="sc">%s</span><span class="st">/cids/TXT&#39;</span> <span class="op">%</span> smiles</a>
<a class="sourceLine" id="cb1513-27" title="27">  response <span class="op">=</span> requests.get(url)</a>
<a class="sourceLine" id="cb1513-28" title="28">  cids <span class="op">=</span> response.text.split()</a>
<a class="sourceLine" id="cb1513-29" title="29">  cids <span class="op">=</span> <span class="st">&#39;,&#39;</span>.join(cids)</a>
<a class="sourceLine" id="cb1513-30" title="30">  url <span class="op">=</span> <span class="st">&#39;https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/cid/</span><span class="sc">%s</span><span class="st">/property/CanonicalSMILES/TXT&#39;</span> <span class="op">%</span> cids</a>
<a class="sourceLine" id="cb1513-31" title="31">  response <span class="op">=</span> requests.get(url)</a>
<a class="sourceLine" id="cb1513-32" title="32">  <span class="cf">return</span> response.text.split()</a>
<a class="sourceLine" id="cb1513-33" title="33"></a>
<a class="sourceLine" id="cb1513-34" title="34"></a>
<a class="sourceLine" id="cb1513-35" title="35"><span class="im">import</span> requests</a>
<a class="sourceLine" id="cb1513-36" title="36"><span class="im">import</span> time</a>
<a class="sourceLine" id="cb1513-37" title="37"></a>
<a class="sourceLine" id="cb1513-38" title="38">time.sleep(<span class="fl">0.5</span>)</a>
<a class="sourceLine" id="cb1513-39" title="39"></a>
<a class="sourceLine" id="cb1513-40" title="40"></a>
<a class="sourceLine" id="cb1513-41" title="41"><span class="kw">def</span> ref_find_similar(s):</a>
<a class="sourceLine" id="cb1513-42" title="42">    url <span class="op">=</span> <span class="ss">f&quot;https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/fastsimilarity_2d/smiles/</span><span class="sc">{s}</span><span class="ss">/property/CanonicalSMILES/JSON&quot;</span></a>
<a class="sourceLine" id="cb1513-43" title="43">    reply <span class="op">=</span> requests.get(</a>
<a class="sourceLine" id="cb1513-44" title="44">        url,</a>
<a class="sourceLine" id="cb1513-45" title="45">        params<span class="op">=</span>{<span class="st">&quot;Threshold&quot;</span>: <span class="dv">80</span>, <span class="st">&quot;MaxRecords&quot;</span>: <span class="dv">100</span>},</a>
<a class="sourceLine" id="cb1513-46" title="46">        headers<span class="op">=</span>{<span class="st">&quot;accept&quot;</span>: <span class="st">&quot;text/json&quot;</span>},</a>
<a class="sourceLine" id="cb1513-47" title="47">        timeout<span class="op">=</span><span class="dv">10</span>,</a>
<a class="sourceLine" id="cb1513-48" title="48">    )</a>
<a class="sourceLine" id="cb1513-49" title="49">    data <span class="op">=</span> reply.json()</a>
<a class="sourceLine" id="cb1513-50" title="50">    smiles <span class="op">=</span> [d[<span class="st">&quot;CanonicalSMILES&quot;</span>]</a>
<a class="sourceLine" id="cb1513-51" title="51">              <span class="cf">for</span> d <span class="kw">in</span> data[<span class="st">&quot;PropertyTable&quot;</span>][<span class="st">&quot;Properties&quot;</span>]]</a>
<a class="sourceLine" id="cb1513-52" title="52">    smiles <span class="op">=</span> <span class="bu">set</span>(smiles)</a>
<a class="sourceLine" id="cb1513-53" title="53">    <span class="cf">return</span> smiles</a>
<a class="sourceLine" id="cb1513-54" title="54"></a>
<a class="sourceLine" id="cb1513-55" title="55"></a>
<a class="sourceLine" id="cb1513-56" title="56">s <span class="op">=</span> <span class="st">&#39;CC=C=C(C(=O)N)&#39;</span></a>
<a class="sourceLine" id="cb1513-57" title="57">ref_sim <span class="op">=</span> ref_find_similar(s)</a>
<a class="sourceLine" id="cb1513-58" title="58">sim <span class="op">=</span> find_similar(s)</a>
<a class="sourceLine" id="cb1513-59" title="59">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> ref_sim <span class="op">==</span> <span class="bu">set</span>(sim) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-137">Run 3</h4>
<div class="sourceCode" id="cb1515"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1515-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1515-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb1515-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb1515-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb1515-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb1515-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb1515-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb1515-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb1515-9" title="9"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb1515-10" title="10"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb1515-11" title="11"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1515-12" title="12"></a>
<a class="sourceLine" id="cb1515-13" title="13"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1515-14" title="14"><span class="co">print rdkit version</span></a>
<a class="sourceLine" id="cb1515-15" title="15"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1515-16" title="16"><span class="bu">print</span>(rdkit.__version__)</a>
<a class="sourceLine" id="cb1515-17" title="17"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1515-18" title="18"></a>
<a class="sourceLine" id="cb1515-19" title="19"><span class="im">import</span> requests</a>
<a class="sourceLine" id="cb1515-20" title="20"></a>
<a class="sourceLine" id="cb1515-21" title="21"><span class="kw">def</span> find_similar(smiles):</a>
<a class="sourceLine" id="cb1515-22" title="22">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1515-23" title="23"><span class="co">  Returns a set of molecules with greater than 80% similarity using the PubChem REST API.</span></a>
<a class="sourceLine" id="cb1515-24" title="24"><span class="co">  The returned molecules are SMILES strings, not CIDs.</span></a>
<a class="sourceLine" id="cb1515-25" title="25"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1515-26" title="26">  url <span class="op">=</span> <span class="st">&quot;https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/smiles/</span><span class="sc">%s</span><span class="st">/cids/TXT&quot;</span> <span class="op">%</span> smiles</a>
<a class="sourceLine" id="cb1515-27" title="27">  response <span class="op">=</span> requests.get(url)</a>
<a class="sourceLine" id="cb1515-28" title="28">  cids <span class="op">=</span> response.text.split()</a>
<a class="sourceLine" id="cb1515-29" title="29">  url <span class="op">=</span> <span class="st">&quot;https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/cid/</span><span class="sc">%s</span><span class="st">/property/CanonicalSMILES/TXT&quot;</span> <span class="op">%</span> <span class="st">&quot;,&quot;</span>.join(cids)</a>
<a class="sourceLine" id="cb1515-30" title="30">  response <span class="op">=</span> requests.get(url)</a>
<a class="sourceLine" id="cb1515-31" title="31">  <span class="cf">return</span> <span class="bu">set</span>(response.text.split())</a>
<a class="sourceLine" id="cb1515-32" title="32"></a>
<a class="sourceLine" id="cb1515-33" title="33"></a>
<a class="sourceLine" id="cb1515-34" title="34"><span class="im">import</span> requests</a>
<a class="sourceLine" id="cb1515-35" title="35"><span class="im">import</span> time</a>
<a class="sourceLine" id="cb1515-36" title="36"></a>
<a class="sourceLine" id="cb1515-37" title="37">time.sleep(<span class="fl">0.5</span>)</a>
<a class="sourceLine" id="cb1515-38" title="38"></a>
<a class="sourceLine" id="cb1515-39" title="39"></a>
<a class="sourceLine" id="cb1515-40" title="40"><span class="kw">def</span> ref_find_similar(s):</a>
<a class="sourceLine" id="cb1515-41" title="41">    url <span class="op">=</span> <span class="ss">f&quot;https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/fastsimilarity_2d/smiles/</span><span class="sc">{s}</span><span class="ss">/property/CanonicalSMILES/JSON&quot;</span></a>
<a class="sourceLine" id="cb1515-42" title="42">    reply <span class="op">=</span> requests.get(</a>
<a class="sourceLine" id="cb1515-43" title="43">        url,</a>
<a class="sourceLine" id="cb1515-44" title="44">        params<span class="op">=</span>{<span class="st">&quot;Threshold&quot;</span>: <span class="dv">80</span>, <span class="st">&quot;MaxRecords&quot;</span>: <span class="dv">100</span>},</a>
<a class="sourceLine" id="cb1515-45" title="45">        headers<span class="op">=</span>{<span class="st">&quot;accept&quot;</span>: <span class="st">&quot;text/json&quot;</span>},</a>
<a class="sourceLine" id="cb1515-46" title="46">        timeout<span class="op">=</span><span class="dv">10</span>,</a>
<a class="sourceLine" id="cb1515-47" title="47">    )</a>
<a class="sourceLine" id="cb1515-48" title="48">    data <span class="op">=</span> reply.json()</a>
<a class="sourceLine" id="cb1515-49" title="49">    smiles <span class="op">=</span> [d[<span class="st">&quot;CanonicalSMILES&quot;</span>]</a>
<a class="sourceLine" id="cb1515-50" title="50">              <span class="cf">for</span> d <span class="kw">in</span> data[<span class="st">&quot;PropertyTable&quot;</span>][<span class="st">&quot;Properties&quot;</span>]]</a>
<a class="sourceLine" id="cb1515-51" title="51">    smiles <span class="op">=</span> <span class="bu">set</span>(smiles)</a>
<a class="sourceLine" id="cb1515-52" title="52">    <span class="cf">return</span> smiles</a>
<a class="sourceLine" id="cb1515-53" title="53"></a>
<a class="sourceLine" id="cb1515-54" title="54"></a>
<a class="sourceLine" id="cb1515-55" title="55">s <span class="op">=</span> <span class="st">&#39;CC=C=C(C(=O)N)&#39;</span></a>
<a class="sourceLine" id="cb1515-56" title="56">ref_sim <span class="op">=</span> ref_find_similar(s)</a>
<a class="sourceLine" id="cb1515-57" title="57">sim <span class="op">=</span> find_similar(s)</a>
<a class="sourceLine" id="cb1515-58" title="58">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> ref_sim <span class="op">==</span> <span class="bu">set</span>(sim) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-137">Run 4</h4>
<div class="sourceCode" id="cb1517"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1517-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1517-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb1517-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb1517-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb1517-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb1517-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb1517-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb1517-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb1517-9" title="9"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb1517-10" title="10"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb1517-11" title="11"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1517-12" title="12"></a>
<a class="sourceLine" id="cb1517-13" title="13"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1517-14" title="14"><span class="co">print rdkit version</span></a>
<a class="sourceLine" id="cb1517-15" title="15"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1517-16" title="16"><span class="bu">print</span>(rdkit.__version__)</a>
<a class="sourceLine" id="cb1517-17" title="17"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1517-18" title="18"></a>
<a class="sourceLine" id="cb1517-19" title="19"><span class="im">import</span> requests</a>
<a class="sourceLine" id="cb1517-20" title="20"></a>
<a class="sourceLine" id="cb1517-21" title="21"><span class="kw">def</span> find_similar(smiles):</a>
<a class="sourceLine" id="cb1517-22" title="22">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1517-23" title="23"><span class="co">  Returns a set of molecules with greater than 80% similarity using the PubChem REST API.</span></a>
<a class="sourceLine" id="cb1517-24" title="24"><span class="co">  The returned molecules are SMILES strings, not CIDs.</span></a>
<a class="sourceLine" id="cb1517-25" title="25"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1517-26" title="26">  url <span class="op">=</span> <span class="st">&quot;https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/smiles/</span><span class="sc">%s</span><span class="st">/cids/TXT&quot;</span> <span class="op">%</span> smiles</a>
<a class="sourceLine" id="cb1517-27" title="27">  response <span class="op">=</span> requests.get(url)</a>
<a class="sourceLine" id="cb1517-28" title="28">  cids <span class="op">=</span> response.text.split()</a>
<a class="sourceLine" id="cb1517-29" title="29">  cids <span class="op">=</span> <span class="st">&quot;,&quot;</span>.join(cids)</a>
<a class="sourceLine" id="cb1517-30" title="30">  url <span class="op">=</span> <span class="st">&quot;https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/cid/</span><span class="sc">%s</span><span class="st">/property/CanonicalSMILES/TXT&quot;</span> <span class="op">%</span> cids</a>
<a class="sourceLine" id="cb1517-31" title="31">  response <span class="op">=</span> requests.get(url)</a>
<a class="sourceLine" id="cb1517-32" title="32">  <span class="cf">return</span> <span class="bu">set</span>(response.text.split())</a>
<a class="sourceLine" id="cb1517-33" title="33"></a>
<a class="sourceLine" id="cb1517-34" title="34"></a>
<a class="sourceLine" id="cb1517-35" title="35"><span class="im">import</span> requests</a>
<a class="sourceLine" id="cb1517-36" title="36"><span class="im">import</span> time</a>
<a class="sourceLine" id="cb1517-37" title="37"></a>
<a class="sourceLine" id="cb1517-38" title="38">time.sleep(<span class="fl">0.5</span>)</a>
<a class="sourceLine" id="cb1517-39" title="39"></a>
<a class="sourceLine" id="cb1517-40" title="40"></a>
<a class="sourceLine" id="cb1517-41" title="41"><span class="kw">def</span> ref_find_similar(s):</a>
<a class="sourceLine" id="cb1517-42" title="42">    url <span class="op">=</span> <span class="ss">f&quot;https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/fastsimilarity_2d/smiles/</span><span class="sc">{s}</span><span class="ss">/property/CanonicalSMILES/JSON&quot;</span></a>
<a class="sourceLine" id="cb1517-43" title="43">    reply <span class="op">=</span> requests.get(</a>
<a class="sourceLine" id="cb1517-44" title="44">        url,</a>
<a class="sourceLine" id="cb1517-45" title="45">        params<span class="op">=</span>{<span class="st">&quot;Threshold&quot;</span>: <span class="dv">80</span>, <span class="st">&quot;MaxRecords&quot;</span>: <span class="dv">100</span>},</a>
<a class="sourceLine" id="cb1517-46" title="46">        headers<span class="op">=</span>{<span class="st">&quot;accept&quot;</span>: <span class="st">&quot;text/json&quot;</span>},</a>
<a class="sourceLine" id="cb1517-47" title="47">        timeout<span class="op">=</span><span class="dv">10</span>,</a>
<a class="sourceLine" id="cb1517-48" title="48">    )</a>
<a class="sourceLine" id="cb1517-49" title="49">    data <span class="op">=</span> reply.json()</a>
<a class="sourceLine" id="cb1517-50" title="50">    smiles <span class="op">=</span> [d[<span class="st">&quot;CanonicalSMILES&quot;</span>]</a>
<a class="sourceLine" id="cb1517-51" title="51">              <span class="cf">for</span> d <span class="kw">in</span> data[<span class="st">&quot;PropertyTable&quot;</span>][<span class="st">&quot;Properties&quot;</span>]]</a>
<a class="sourceLine" id="cb1517-52" title="52">    smiles <span class="op">=</span> <span class="bu">set</span>(smiles)</a>
<a class="sourceLine" id="cb1517-53" title="53">    <span class="cf">return</span> smiles</a>
<a class="sourceLine" id="cb1517-54" title="54"></a>
<a class="sourceLine" id="cb1517-55" title="55"></a>
<a class="sourceLine" id="cb1517-56" title="56">s <span class="op">=</span> <span class="st">&#39;CC=C=C(C(=O)N)&#39;</span></a>
<a class="sourceLine" id="cb1517-57" title="57">ref_sim <span class="op">=</span> ref_find_similar(s)</a>
<a class="sourceLine" id="cb1517-58" title="58">sim <span class="op">=</span> find_similar(s)</a>
<a class="sourceLine" id="cb1517-59" title="59">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> ref_sim <span class="op">==</span> <span class="bu">set</span>(sim) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>pyscf_energy</summary></p>
<h4 id="query-138">Query</h4>
<div class="sourceCode" id="cb1519"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1519-1" title="1"><span class="im">import</span> pyscf</a>
<a class="sourceLine" id="cb1519-2" title="2"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1519-3" title="3"></a>
<a class="sourceLine" id="cb1519-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1519-5" title="5"><span class="co">Print pyscf version string</span></a>
<a class="sourceLine" id="cb1519-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1519-7" title="7"><span class="bu">print</span>(pyscf.__version__)</a>
<a class="sourceLine" id="cb1519-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1519-9" title="9"></a>
<a class="sourceLine" id="cb1519-10" title="10"><span class="kw">def</span> calc_molecule_energy(atom,basis):</a>
<a class="sourceLine" id="cb1519-11" title="11">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1519-12" title="12"><span class="co">    This function returns the ground state energy for atom using restricted Hartree-Fock in the given basis</span></a>
<a class="sourceLine" id="cb1519-13" title="13"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1519-14" title="14">    </a></code></pre></div>
<h4 id="run-0-138">Run 0</h4>
<div class="sourceCode" id="cb1520"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1520-1" title="1"><span class="im">import</span> pyscf</a>
<a class="sourceLine" id="cb1520-2" title="2"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1520-3" title="3"></a>
<a class="sourceLine" id="cb1520-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1520-5" title="5"><span class="co">Print pyscf version string</span></a>
<a class="sourceLine" id="cb1520-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1520-7" title="7"><span class="bu">print</span>(pyscf.__version__)</a>
<a class="sourceLine" id="cb1520-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1520-9" title="9"></a>
<a class="sourceLine" id="cb1520-10" title="10"><span class="kw">def</span> calc_molecule_energy(atom,basis):</a>
<a class="sourceLine" id="cb1520-11" title="11">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1520-12" title="12"><span class="co">    This function returns the ground state energy for atom using restricted Hartree-Fock in the given basis</span></a>
<a class="sourceLine" id="cb1520-13" title="13"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1520-14" title="14">    mol <span class="op">=</span> pyscf.gto.M(atom<span class="op">=</span>atom, basis<span class="op">=</span>basis)</a>
<a class="sourceLine" id="cb1520-15" title="15">    mf <span class="op">=</span> pyscf.scf.RHF(mol)</a>
<a class="sourceLine" id="cb1520-16" title="16">    mf.scf()</a>
<a class="sourceLine" id="cb1520-17" title="17">    <span class="cf">return</span> mf.e_tot</a>
<a class="sourceLine" id="cb1520-18" title="18"></a>
<a class="sourceLine" id="cb1520-19" title="19">atom_coordinates <span class="op">=</span> <span class="st">&quot;H 0 0 0; F 0 0 1&quot;</span></a>
<a class="sourceLine" id="cb1520-20" title="20">basis <span class="op">=</span> <span class="st">&quot;sto-3g&quot;</span></a>
<a class="sourceLine" id="cb1520-21" title="21"></a>
<a class="sourceLine" id="cb1520-22" title="22"><span class="co">#so that it doesn&#39;t fail b/c not importing these in prompt:</span></a>
<a class="sourceLine" id="cb1520-23" title="23"><span class="im">from</span> pyscf <span class="im">import</span> gto, scf</a>
<a class="sourceLine" id="cb1520-24" title="24"></a>
<a class="sourceLine" id="cb1520-25" title="25"><span class="kw">def</span> calc_molecule_energy_test(atom_coordinates,basis):</a>
<a class="sourceLine" id="cb1520-26" title="26">    mol <span class="op">=</span> gto.M(atom<span class="op">=</span>atom_coordinates,basis<span class="op">=</span>basis)</a>
<a class="sourceLine" id="cb1520-27" title="27">    mf <span class="op">=</span> scf.RHF(mol)</a>
<a class="sourceLine" id="cb1520-28" title="28">    <span class="cf">return</span> mf.kernel()</a>
<a class="sourceLine" id="cb1520-29" title="29"></a>
<a class="sourceLine" id="cb1520-30" title="30">my_energy <span class="op">=</span> calc_molecule_energy_test(atom_coordinates,basis)</a>
<a class="sourceLine" id="cb1520-31" title="31">nlcc_energy <span class="op">=</span> calc_molecule_energy(atom_coordinates,basis)</a>
<a class="sourceLine" id="cb1520-32" title="32"></a>
<a class="sourceLine" id="cb1520-33" title="33"><span class="bu">print</span>(<span class="st">&quot;My result:&quot;</span>, my_energy)</a>
<a class="sourceLine" id="cb1520-34" title="34"><span class="bu">print</span>(<span class="st">&quot;nlcc result:&quot;</span>, nlcc_energy)</a>
<a class="sourceLine" id="cb1520-35" title="35"></a>
<a class="sourceLine" id="cb1520-36" title="36">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">abs</span>( my_energy <span class="op">-</span> nlcc_energy )<span class="op">&lt;</span><span class="fl">0.1</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>&#39;NoneType&#39; object has no attribute &#39;write&#39;</code></pre>
<h4 id="run-1-138">Run 1</h4>
<div class="sourceCode" id="cb1522"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1522-1" title="1"><span class="im">import</span> pyscf</a>
<a class="sourceLine" id="cb1522-2" title="2"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1522-3" title="3"></a>
<a class="sourceLine" id="cb1522-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1522-5" title="5"><span class="co">Print pyscf version string</span></a>
<a class="sourceLine" id="cb1522-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1522-7" title="7"><span class="bu">print</span>(pyscf.__version__)</a>
<a class="sourceLine" id="cb1522-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1522-9" title="9"></a>
<a class="sourceLine" id="cb1522-10" title="10"><span class="kw">def</span> calc_molecule_energy(atom,basis):</a>
<a class="sourceLine" id="cb1522-11" title="11">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1522-12" title="12"><span class="co">    This function returns the ground state energy for atom using restricted Hartree-Fock in the given basis</span></a>
<a class="sourceLine" id="cb1522-13" title="13"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1522-14" title="14">    mol <span class="op">=</span> pyscf.gto.Mole()</a>
<a class="sourceLine" id="cb1522-15" title="15">    mol.atom <span class="op">=</span> atom</a>
<a class="sourceLine" id="cb1522-16" title="16">    mol.basis <span class="op">=</span> basis</a>
<a class="sourceLine" id="cb1522-17" title="17">    mol.build()</a>
<a class="sourceLine" id="cb1522-18" title="18">    mf <span class="op">=</span> pyscf.scf.RHF(mol)</a>
<a class="sourceLine" id="cb1522-19" title="19">    mf.scf()</a>
<a class="sourceLine" id="cb1522-20" title="20">    <span class="cf">return</span> mf.e_tot</a>
<a class="sourceLine" id="cb1522-21" title="21"></a>
<a class="sourceLine" id="cb1522-22" title="22">atom_coordinates <span class="op">=</span> <span class="st">&quot;H 0 0 0; F 0 0 1&quot;</span></a>
<a class="sourceLine" id="cb1522-23" title="23">basis <span class="op">=</span> <span class="st">&quot;sto-3g&quot;</span></a>
<a class="sourceLine" id="cb1522-24" title="24"></a>
<a class="sourceLine" id="cb1522-25" title="25"><span class="co">#so that it doesn&#39;t fail b/c not importing these in prompt:</span></a>
<a class="sourceLine" id="cb1522-26" title="26"><span class="im">from</span> pyscf <span class="im">import</span> gto, scf</a>
<a class="sourceLine" id="cb1522-27" title="27"></a>
<a class="sourceLine" id="cb1522-28" title="28"><span class="kw">def</span> calc_molecule_energy_test(atom_coordinates,basis):</a>
<a class="sourceLine" id="cb1522-29" title="29">    mol <span class="op">=</span> gto.M(atom<span class="op">=</span>atom_coordinates,basis<span class="op">=</span>basis)</a>
<a class="sourceLine" id="cb1522-30" title="30">    mf <span class="op">=</span> scf.RHF(mol)</a>
<a class="sourceLine" id="cb1522-31" title="31">    <span class="cf">return</span> mf.kernel()</a>
<a class="sourceLine" id="cb1522-32" title="32"></a>
<a class="sourceLine" id="cb1522-33" title="33">my_energy <span class="op">=</span> calc_molecule_energy_test(atom_coordinates,basis)</a>
<a class="sourceLine" id="cb1522-34" title="34">nlcc_energy <span class="op">=</span> calc_molecule_energy(atom_coordinates,basis)</a>
<a class="sourceLine" id="cb1522-35" title="35"></a>
<a class="sourceLine" id="cb1522-36" title="36"><span class="bu">print</span>(<span class="st">&quot;My result:&quot;</span>, my_energy)</a>
<a class="sourceLine" id="cb1522-37" title="37"><span class="bu">print</span>(<span class="st">&quot;nlcc result:&quot;</span>, nlcc_energy)</a>
<a class="sourceLine" id="cb1522-38" title="38"></a>
<a class="sourceLine" id="cb1522-39" title="39">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">abs</span>( my_energy <span class="op">-</span> nlcc_energy )<span class="op">&lt;</span><span class="fl">0.1</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>&#39;NoneType&#39; object has no attribute &#39;write&#39;</code></pre>
<h4 id="run-2-138">Run 2</h4>
<div class="sourceCode" id="cb1524"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1524-1" title="1"><span class="im">import</span> pyscf</a>
<a class="sourceLine" id="cb1524-2" title="2"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1524-3" title="3"></a>
<a class="sourceLine" id="cb1524-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1524-5" title="5"><span class="co">Print pyscf version string</span></a>
<a class="sourceLine" id="cb1524-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1524-7" title="7"><span class="bu">print</span>(pyscf.__version__)</a>
<a class="sourceLine" id="cb1524-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1524-9" title="9"></a>
<a class="sourceLine" id="cb1524-10" title="10"><span class="kw">def</span> calc_molecule_energy(atom,basis):</a>
<a class="sourceLine" id="cb1524-11" title="11">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1524-12" title="12"><span class="co">    This function returns the ground state energy for atom using restricted Hartree-Fock in the given basis</span></a>
<a class="sourceLine" id="cb1524-13" title="13"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1524-14" title="14">    mol <span class="op">=</span> pyscf.gto.M(atom<span class="op">=</span>atom,basis<span class="op">=</span>basis)</a>
<a class="sourceLine" id="cb1524-15" title="15">    mf <span class="op">=</span> pyscf.scf.RHF(mol)</a>
<a class="sourceLine" id="cb1524-16" title="16">    mf.kernel()</a>
<a class="sourceLine" id="cb1524-17" title="17">    <span class="cf">return</span> mf.e_tot</a>
<a class="sourceLine" id="cb1524-18" title="18"></a>
<a class="sourceLine" id="cb1524-19" title="19">atom_coordinates <span class="op">=</span> <span class="st">&quot;H 0 0 0; F 0 0 1&quot;</span></a>
<a class="sourceLine" id="cb1524-20" title="20">basis <span class="op">=</span> <span class="st">&quot;sto-3g&quot;</span></a>
<a class="sourceLine" id="cb1524-21" title="21"></a>
<a class="sourceLine" id="cb1524-22" title="22"><span class="co">#so that it doesn&#39;t fail b/c not importing these in prompt:</span></a>
<a class="sourceLine" id="cb1524-23" title="23"><span class="im">from</span> pyscf <span class="im">import</span> gto, scf</a>
<a class="sourceLine" id="cb1524-24" title="24"></a>
<a class="sourceLine" id="cb1524-25" title="25"><span class="kw">def</span> calc_molecule_energy_test(atom_coordinates,basis):</a>
<a class="sourceLine" id="cb1524-26" title="26">    mol <span class="op">=</span> gto.M(atom<span class="op">=</span>atom_coordinates,basis<span class="op">=</span>basis)</a>
<a class="sourceLine" id="cb1524-27" title="27">    mf <span class="op">=</span> scf.RHF(mol)</a>
<a class="sourceLine" id="cb1524-28" title="28">    <span class="cf">return</span> mf.kernel()</a>
<a class="sourceLine" id="cb1524-29" title="29"></a>
<a class="sourceLine" id="cb1524-30" title="30">my_energy <span class="op">=</span> calc_molecule_energy_test(atom_coordinates,basis)</a>
<a class="sourceLine" id="cb1524-31" title="31">nlcc_energy <span class="op">=</span> calc_molecule_energy(atom_coordinates,basis)</a>
<a class="sourceLine" id="cb1524-32" title="32"></a>
<a class="sourceLine" id="cb1524-33" title="33"><span class="bu">print</span>(<span class="st">&quot;My result:&quot;</span>, my_energy)</a>
<a class="sourceLine" id="cb1524-34" title="34"><span class="bu">print</span>(<span class="st">&quot;nlcc result:&quot;</span>, nlcc_energy)</a>
<a class="sourceLine" id="cb1524-35" title="35"></a>
<a class="sourceLine" id="cb1524-36" title="36">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">abs</span>( my_energy <span class="op">-</span> nlcc_energy )<span class="op">&lt;</span><span class="fl">0.1</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>&#39;NoneType&#39; object has no attribute &#39;write&#39;</code></pre>
<h4 id="run-3-138">Run 3</h4>
<div class="sourceCode" id="cb1526"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1526-1" title="1"><span class="im">import</span> pyscf</a>
<a class="sourceLine" id="cb1526-2" title="2"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1526-3" title="3"></a>
<a class="sourceLine" id="cb1526-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1526-5" title="5"><span class="co">Print pyscf version string</span></a>
<a class="sourceLine" id="cb1526-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1526-7" title="7"><span class="bu">print</span>(pyscf.__version__)</a>
<a class="sourceLine" id="cb1526-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1526-9" title="9"></a>
<a class="sourceLine" id="cb1526-10" title="10"><span class="kw">def</span> calc_molecule_energy(atom,basis):</a>
<a class="sourceLine" id="cb1526-11" title="11">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1526-12" title="12"><span class="co">    This function returns the ground state energy for atom using restricted Hartree-Fock in the given basis</span></a>
<a class="sourceLine" id="cb1526-13" title="13"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1526-14" title="14">    mol <span class="op">=</span> pyscf.gto.Mole()</a>
<a class="sourceLine" id="cb1526-15" title="15">    mol.atom <span class="op">=</span> atom</a>
<a class="sourceLine" id="cb1526-16" title="16">    mol.basis <span class="op">=</span> basis</a>
<a class="sourceLine" id="cb1526-17" title="17">    mol.build()</a>
<a class="sourceLine" id="cb1526-18" title="18">    mf <span class="op">=</span> pyscf.scf.RHF(mol)</a>
<a class="sourceLine" id="cb1526-19" title="19">    mf.scf()</a>
<a class="sourceLine" id="cb1526-20" title="20">    <span class="cf">return</span> mf.e_tot</a>
<a class="sourceLine" id="cb1526-21" title="21"></a>
<a class="sourceLine" id="cb1526-22" title="22">atom_coordinates <span class="op">=</span> <span class="st">&quot;H 0 0 0; F 0 0 1&quot;</span></a>
<a class="sourceLine" id="cb1526-23" title="23">basis <span class="op">=</span> <span class="st">&quot;sto-3g&quot;</span></a>
<a class="sourceLine" id="cb1526-24" title="24"></a>
<a class="sourceLine" id="cb1526-25" title="25"><span class="co">#so that it doesn&#39;t fail b/c not importing these in prompt:</span></a>
<a class="sourceLine" id="cb1526-26" title="26"><span class="im">from</span> pyscf <span class="im">import</span> gto, scf</a>
<a class="sourceLine" id="cb1526-27" title="27"></a>
<a class="sourceLine" id="cb1526-28" title="28"><span class="kw">def</span> calc_molecule_energy_test(atom_coordinates,basis):</a>
<a class="sourceLine" id="cb1526-29" title="29">    mol <span class="op">=</span> gto.M(atom<span class="op">=</span>atom_coordinates,basis<span class="op">=</span>basis)</a>
<a class="sourceLine" id="cb1526-30" title="30">    mf <span class="op">=</span> scf.RHF(mol)</a>
<a class="sourceLine" id="cb1526-31" title="31">    <span class="cf">return</span> mf.kernel()</a>
<a class="sourceLine" id="cb1526-32" title="32"></a>
<a class="sourceLine" id="cb1526-33" title="33">my_energy <span class="op">=</span> calc_molecule_energy_test(atom_coordinates,basis)</a>
<a class="sourceLine" id="cb1526-34" title="34">nlcc_energy <span class="op">=</span> calc_molecule_energy(atom_coordinates,basis)</a>
<a class="sourceLine" id="cb1526-35" title="35"></a>
<a class="sourceLine" id="cb1526-36" title="36"><span class="bu">print</span>(<span class="st">&quot;My result:&quot;</span>, my_energy)</a>
<a class="sourceLine" id="cb1526-37" title="37"><span class="bu">print</span>(<span class="st">&quot;nlcc result:&quot;</span>, nlcc_energy)</a>
<a class="sourceLine" id="cb1526-38" title="38"></a>
<a class="sourceLine" id="cb1526-39" title="39">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">abs</span>( my_energy <span class="op">-</span> nlcc_energy )<span class="op">&lt;</span><span class="fl">0.1</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>&#39;NoneType&#39; object has no attribute &#39;write&#39;</code></pre>
<h4 id="run-4-138">Run 4</h4>
<div class="sourceCode" id="cb1528"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1528-1" title="1"><span class="im">import</span> pyscf</a>
<a class="sourceLine" id="cb1528-2" title="2"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1528-3" title="3"></a>
<a class="sourceLine" id="cb1528-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1528-5" title="5"><span class="co">Print pyscf version string</span></a>
<a class="sourceLine" id="cb1528-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1528-7" title="7"><span class="bu">print</span>(pyscf.__version__)</a>
<a class="sourceLine" id="cb1528-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1528-9" title="9"></a>
<a class="sourceLine" id="cb1528-10" title="10"><span class="kw">def</span> calc_molecule_energy(atom,basis):</a>
<a class="sourceLine" id="cb1528-11" title="11">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1528-12" title="12"><span class="co">    This function returns the ground state energy for atom using restricted Hartree-Fock in the given basis</span></a>
<a class="sourceLine" id="cb1528-13" title="13"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1528-14" title="14">    mol <span class="op">=</span> pyscf.gto.M(atom<span class="op">=</span>atom, basis<span class="op">=</span>basis)</a>
<a class="sourceLine" id="cb1528-15" title="15">    mf <span class="op">=</span> pyscf.scf.RHF(mol)</a>
<a class="sourceLine" id="cb1528-16" title="16">    mf.kernel()</a>
<a class="sourceLine" id="cb1528-17" title="17">    <span class="cf">return</span> mf.e_tot</a>
<a class="sourceLine" id="cb1528-18" title="18"></a>
<a class="sourceLine" id="cb1528-19" title="19">atom_coordinates <span class="op">=</span> <span class="st">&quot;H 0 0 0; F 0 0 1&quot;</span></a>
<a class="sourceLine" id="cb1528-20" title="20">basis <span class="op">=</span> <span class="st">&quot;sto-3g&quot;</span></a>
<a class="sourceLine" id="cb1528-21" title="21"></a>
<a class="sourceLine" id="cb1528-22" title="22"><span class="co">#so that it doesn&#39;t fail b/c not importing these in prompt:</span></a>
<a class="sourceLine" id="cb1528-23" title="23"><span class="im">from</span> pyscf <span class="im">import</span> gto, scf</a>
<a class="sourceLine" id="cb1528-24" title="24"></a>
<a class="sourceLine" id="cb1528-25" title="25"><span class="kw">def</span> calc_molecule_energy_test(atom_coordinates,basis):</a>
<a class="sourceLine" id="cb1528-26" title="26">    mol <span class="op">=</span> gto.M(atom<span class="op">=</span>atom_coordinates,basis<span class="op">=</span>basis)</a>
<a class="sourceLine" id="cb1528-27" title="27">    mf <span class="op">=</span> scf.RHF(mol)</a>
<a class="sourceLine" id="cb1528-28" title="28">    <span class="cf">return</span> mf.kernel()</a>
<a class="sourceLine" id="cb1528-29" title="29"></a>
<a class="sourceLine" id="cb1528-30" title="30">my_energy <span class="op">=</span> calc_molecule_energy_test(atom_coordinates,basis)</a>
<a class="sourceLine" id="cb1528-31" title="31">nlcc_energy <span class="op">=</span> calc_molecule_energy(atom_coordinates,basis)</a>
<a class="sourceLine" id="cb1528-32" title="32"></a>
<a class="sourceLine" id="cb1528-33" title="33"><span class="bu">print</span>(<span class="st">&quot;My result:&quot;</span>, my_energy)</a>
<a class="sourceLine" id="cb1528-34" title="34"><span class="bu">print</span>(<span class="st">&quot;nlcc result:&quot;</span>, nlcc_energy)</a>
<a class="sourceLine" id="cb1528-35" title="35"></a>
<a class="sourceLine" id="cb1528-36" title="36">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">abs</span>( my_energy <span class="op">-</span> nlcc_energy )<span class="op">&lt;</span><span class="fl">0.1</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>&#39;NoneType&#39; object has no attribute &#39;write&#39;</code></pre>
</details>
<details>
<p><summary>qed</summary></p>
<h4 id="query-139">Query</h4>
<div class="sourceCode" id="cb1530"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1530-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1530-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb1530-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb1530-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb1530-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb1530-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb1530-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb1530-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb1530-9" title="9"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb1530-10" title="10"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb1530-11" title="11"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1530-12" title="12"></a>
<a class="sourceLine" id="cb1530-13" title="13"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1530-14" title="14"><span class="co">print rdkit version</span></a>
<a class="sourceLine" id="cb1530-15" title="15"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1530-16" title="16"><span class="bu">print</span>(rdkit.__version__)</a>
<a class="sourceLine" id="cb1530-17" title="17"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1530-18" title="18"></a>
<a class="sourceLine" id="cb1530-19" title="19"><span class="kw">def</span> qed(smiles):</a>
<a class="sourceLine" id="cb1530-20" title="20">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1530-21" title="21"><span class="co">    This function takes a SMILES string and returns the quantitative estimation of drug-likeness for the molecule.</span></a>
<a class="sourceLine" id="cb1530-22" title="22"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1530-23" title="23">    </a></code></pre></div>
<h4 id="run-0-139">Run 0</h4>
<div class="sourceCode" id="cb1531"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1531-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1531-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb1531-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb1531-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb1531-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb1531-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb1531-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb1531-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb1531-9" title="9"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb1531-10" title="10"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb1531-11" title="11"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1531-12" title="12"></a>
<a class="sourceLine" id="cb1531-13" title="13"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1531-14" title="14"><span class="co">print rdkit version</span></a>
<a class="sourceLine" id="cb1531-15" title="15"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1531-16" title="16"><span class="bu">print</span>(rdkit.__version__)</a>
<a class="sourceLine" id="cb1531-17" title="17"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1531-18" title="18"></a>
<a class="sourceLine" id="cb1531-19" title="19"><span class="kw">def</span> qed(smiles):</a>
<a class="sourceLine" id="cb1531-20" title="20">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1531-21" title="21"><span class="co">    This function takes a SMILES string and returns the quantitative estimation of drug-likeness for the molecule.</span></a>
<a class="sourceLine" id="cb1531-22" title="22"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1531-23" title="23">    mol <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb1531-24" title="24">    <span class="cf">return</span> Descriptors.qed(mol)</a>
<a class="sourceLine" id="cb1531-25" title="25"></a>
<a class="sourceLine" id="cb1531-26" title="26"><span class="im">from</span> rdkit.Chem <span class="im">import</span> QED</a>
<a class="sourceLine" id="cb1531-27" title="27">smiles <span class="op">=</span> <span class="st">&#39;CC1=CN=C(C(=C1OC)C)CS(=O)C2=NC3=C(N2)C=C(C=C3)OC&#39;</span> <span class="co"># omeprazole</span></a>
<a class="sourceLine" id="cb1531-28" title="28">m <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb1531-29" title="29">q <span class="op">=</span> QED.qed(m)</a>
<a class="sourceLine" id="cb1531-30" title="30"></a>
<a class="sourceLine" id="cb1531-31" title="31">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(qed(smiles), q) <span class="cf">else</span> <span class="va">False</span> </a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-139">Run 1</h4>
<div class="sourceCode" id="cb1533"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1533-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1533-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb1533-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb1533-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb1533-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb1533-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb1533-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb1533-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb1533-9" title="9"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb1533-10" title="10"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb1533-11" title="11"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1533-12" title="12"></a>
<a class="sourceLine" id="cb1533-13" title="13"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1533-14" title="14"><span class="co">print rdkit version</span></a>
<a class="sourceLine" id="cb1533-15" title="15"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1533-16" title="16"><span class="bu">print</span>(rdkit.__version__)</a>
<a class="sourceLine" id="cb1533-17" title="17"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1533-18" title="18"></a>
<a class="sourceLine" id="cb1533-19" title="19"><span class="kw">def</span> qed(smiles):</a>
<a class="sourceLine" id="cb1533-20" title="20">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1533-21" title="21"><span class="co">    This function takes a SMILES string and returns the quantitative estimation of drug-likeness for the molecule.</span></a>
<a class="sourceLine" id="cb1533-22" title="22"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1533-23" title="23">    mol <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb1533-24" title="24">    <span class="cf">return</span> Descriptors.qed(mol)</a>
<a class="sourceLine" id="cb1533-25" title="25"></a>
<a class="sourceLine" id="cb1533-26" title="26"><span class="im">from</span> rdkit.Chem <span class="im">import</span> QED</a>
<a class="sourceLine" id="cb1533-27" title="27">smiles <span class="op">=</span> <span class="st">&#39;CC1=CN=C(C(=C1OC)C)CS(=O)C2=NC3=C(N2)C=C(C=C3)OC&#39;</span> <span class="co"># omeprazole</span></a>
<a class="sourceLine" id="cb1533-28" title="28">m <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb1533-29" title="29">q <span class="op">=</span> QED.qed(m)</a>
<a class="sourceLine" id="cb1533-30" title="30"></a>
<a class="sourceLine" id="cb1533-31" title="31">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(qed(smiles), q) <span class="cf">else</span> <span class="va">False</span> </a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-139">Run 2</h4>
<div class="sourceCode" id="cb1535"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1535-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1535-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb1535-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb1535-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb1535-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb1535-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb1535-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb1535-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb1535-9" title="9"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb1535-10" title="10"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb1535-11" title="11"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1535-12" title="12"></a>
<a class="sourceLine" id="cb1535-13" title="13"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1535-14" title="14"><span class="co">print rdkit version</span></a>
<a class="sourceLine" id="cb1535-15" title="15"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1535-16" title="16"><span class="bu">print</span>(rdkit.__version__)</a>
<a class="sourceLine" id="cb1535-17" title="17"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1535-18" title="18"></a>
<a class="sourceLine" id="cb1535-19" title="19"><span class="kw">def</span> qed(smiles):</a>
<a class="sourceLine" id="cb1535-20" title="20">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1535-21" title="21"><span class="co">    This function takes a SMILES string and returns the quantitative estimation of drug-likeness for the molecule.</span></a>
<a class="sourceLine" id="cb1535-22" title="22"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1535-23" title="23">    mol <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb1535-24" title="24">    <span class="cf">return</span> Descriptors.qed(mol)</a>
<a class="sourceLine" id="cb1535-25" title="25"></a>
<a class="sourceLine" id="cb1535-26" title="26"></a>
<a class="sourceLine" id="cb1535-27" title="27"><span class="im">from</span> rdkit.Chem <span class="im">import</span> QED</a>
<a class="sourceLine" id="cb1535-28" title="28">smiles <span class="op">=</span> <span class="st">&#39;CC1=CN=C(C(=C1OC)C)CS(=O)C2=NC3=C(N2)C=C(C=C3)OC&#39;</span> <span class="co"># omeprazole</span></a>
<a class="sourceLine" id="cb1535-29" title="29">m <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb1535-30" title="30">q <span class="op">=</span> QED.qed(m)</a>
<a class="sourceLine" id="cb1535-31" title="31"></a>
<a class="sourceLine" id="cb1535-32" title="32">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(qed(smiles), q) <span class="cf">else</span> <span class="va">False</span> </a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-139">Run 3</h4>
<div class="sourceCode" id="cb1537"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1537-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1537-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb1537-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb1537-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb1537-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb1537-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb1537-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb1537-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb1537-9" title="9"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb1537-10" title="10"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb1537-11" title="11"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1537-12" title="12"></a>
<a class="sourceLine" id="cb1537-13" title="13"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1537-14" title="14"><span class="co">print rdkit version</span></a>
<a class="sourceLine" id="cb1537-15" title="15"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1537-16" title="16"><span class="bu">print</span>(rdkit.__version__)</a>
<a class="sourceLine" id="cb1537-17" title="17"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1537-18" title="18"></a>
<a class="sourceLine" id="cb1537-19" title="19"><span class="kw">def</span> qed(smiles):</a>
<a class="sourceLine" id="cb1537-20" title="20">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1537-21" title="21"><span class="co">    This function takes a SMILES string and returns the quantitative estimation of drug-likeness for the molecule.</span></a>
<a class="sourceLine" id="cb1537-22" title="22"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1537-23" title="23">    mol <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb1537-24" title="24">    <span class="cf">return</span> Descriptors.qed(mol)</a>
<a class="sourceLine" id="cb1537-25" title="25"></a>
<a class="sourceLine" id="cb1537-26" title="26"><span class="im">from</span> rdkit.Chem <span class="im">import</span> QED</a>
<a class="sourceLine" id="cb1537-27" title="27">smiles <span class="op">=</span> <span class="st">&#39;CC1=CN=C(C(=C1OC)C)CS(=O)C2=NC3=C(N2)C=C(C=C3)OC&#39;</span> <span class="co"># omeprazole</span></a>
<a class="sourceLine" id="cb1537-28" title="28">m <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb1537-29" title="29">q <span class="op">=</span> QED.qed(m)</a>
<a class="sourceLine" id="cb1537-30" title="30"></a>
<a class="sourceLine" id="cb1537-31" title="31">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(qed(smiles), q) <span class="cf">else</span> <span class="va">False</span> </a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-139">Run 4</h4>
<div class="sourceCode" id="cb1539"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1539-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1539-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb1539-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb1539-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb1539-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb1539-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb1539-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb1539-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb1539-9" title="9"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb1539-10" title="10"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb1539-11" title="11"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1539-12" title="12"></a>
<a class="sourceLine" id="cb1539-13" title="13"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1539-14" title="14"><span class="co">print rdkit version</span></a>
<a class="sourceLine" id="cb1539-15" title="15"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1539-16" title="16"><span class="bu">print</span>(rdkit.__version__)</a>
<a class="sourceLine" id="cb1539-17" title="17"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1539-18" title="18"></a>
<a class="sourceLine" id="cb1539-19" title="19"><span class="kw">def</span> qed(smiles):</a>
<a class="sourceLine" id="cb1539-20" title="20">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1539-21" title="21"><span class="co">    This function takes a SMILES string and returns the quantitative estimation of drug-likeness for the molecule.</span></a>
<a class="sourceLine" id="cb1539-22" title="22"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1539-23" title="23">    mol <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb1539-24" title="24">    <span class="cf">return</span> Descriptors.qed(mol)</a>
<a class="sourceLine" id="cb1539-25" title="25"></a>
<a class="sourceLine" id="cb1539-26" title="26"><span class="im">from</span> rdkit.Chem <span class="im">import</span> QED</a>
<a class="sourceLine" id="cb1539-27" title="27">smiles <span class="op">=</span> <span class="st">&#39;CC1=CN=C(C(=C1OC)C)CS(=O)C2=NC3=C(N2)C=C(C=C3)OC&#39;</span> <span class="co"># omeprazole</span></a>
<a class="sourceLine" id="cb1539-28" title="28">m <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb1539-29" title="29">q <span class="op">=</span> QED.qed(m)</a>
<a class="sourceLine" id="cb1539-30" title="30"></a>
<a class="sourceLine" id="cb1539-31" title="31">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(qed(smiles), q) <span class="cf">else</span> <span class="va">False</span> </a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>quantile</summary></p>
<h4 id="query-140">Query</h4>
<div class="sourceCode" id="cb1541"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1541-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1541-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1541-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1541-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1541-5" title="5"></a>
<a class="sourceLine" id="cb1541-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1541-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1541-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1541-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1541-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1541-11" title="11"></a>
<a class="sourceLine" id="cb1541-12" title="12"><span class="kw">def</span> quantile(a, q):</a>
<a class="sourceLine" id="cb1541-13" title="13">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1541-14" title="14"><span class="co">  This function computes the q-th quantile of the numpy array a. q can be a sequence of quantiles with values between 0 and 1 inclusive.</span></a>
<a class="sourceLine" id="cb1541-15" title="15"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1541-16" title="16">  </a></code></pre></div>
<h4 id="run-0-140">Run 0</h4>
<div class="sourceCode" id="cb1542"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1542-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1542-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1542-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1542-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1542-5" title="5"></a>
<a class="sourceLine" id="cb1542-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1542-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1542-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1542-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1542-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1542-11" title="11"></a>
<a class="sourceLine" id="cb1542-12" title="12"><span class="kw">def</span> quantile(a, q):</a>
<a class="sourceLine" id="cb1542-13" title="13">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1542-14" title="14"><span class="co">  This function computes the q-th quantile of the numpy array a. q can be a sequence of quantiles with values between 0 and 1 inclusive.</span></a>
<a class="sourceLine" id="cb1542-15" title="15"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1542-16" title="16">  <span class="co"># begin</span></a>
<a class="sourceLine" id="cb1542-17" title="17">  <span class="cf">return</span> np.quantile(a, q)</a>
<a class="sourceLine" id="cb1542-18" title="18">  </a>
<a class="sourceLine" id="cb1542-19" title="19"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1542-20" title="20"></a>
<a class="sourceLine" id="cb1542-21" title="21">np.random.seed(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb1542-22" title="22">M <span class="op">=</span> <span class="dv">100</span></a>
<a class="sourceLine" id="cb1542-23" title="23">data <span class="op">=</span> np.random.randint(<span class="dv">1</span>, M, size<span class="op">=</span>(M,))</a>
<a class="sourceLine" id="cb1542-24" title="24">quantiles <span class="op">=</span> [<span class="fl">0.1</span>, <span class="fl">0.5</span>, <span class="fl">0.9</span>]</a>
<a class="sourceLine" id="cb1542-25" title="25"></a>
<a class="sourceLine" id="cb1542-26" title="26">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.allclose(</a>
<a class="sourceLine" id="cb1542-27" title="27">    quantile(data, quantiles), np.quantile(data, q<span class="op">=</span>quantiles)) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-140">Run 1</h4>
<div class="sourceCode" id="cb1544"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1544-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1544-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1544-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1544-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1544-5" title="5"></a>
<a class="sourceLine" id="cb1544-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1544-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1544-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1544-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1544-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1544-11" title="11"></a>
<a class="sourceLine" id="cb1544-12" title="12"><span class="kw">def</span> quantile(a, q):</a>
<a class="sourceLine" id="cb1544-13" title="13">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1544-14" title="14"><span class="co">  This function computes the q-th quantile of the numpy array a. q can be a sequence of quantiles with values between 0 and 1 inclusive.</span></a>
<a class="sourceLine" id="cb1544-15" title="15"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1544-16" title="16">  <span class="co"># start</span></a>
<a class="sourceLine" id="cb1544-17" title="17">  <span class="cf">return</span> np.percentile(a, q<span class="op">*</span><span class="dv">100</span>)</a>
<a class="sourceLine" id="cb1544-18" title="18">  </a>
<a class="sourceLine" id="cb1544-19" title="19"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1544-20" title="20"></a>
<a class="sourceLine" id="cb1544-21" title="21">np.random.seed(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb1544-22" title="22">M <span class="op">=</span> <span class="dv">100</span></a>
<a class="sourceLine" id="cb1544-23" title="23">data <span class="op">=</span> np.random.randint(<span class="dv">1</span>, M, size<span class="op">=</span>(M,))</a>
<a class="sourceLine" id="cb1544-24" title="24">quantiles <span class="op">=</span> [<span class="fl">0.1</span>, <span class="fl">0.5</span>, <span class="fl">0.9</span>]</a>
<a class="sourceLine" id="cb1544-25" title="25"></a>
<a class="sourceLine" id="cb1544-26" title="26">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.allclose(</a>
<a class="sourceLine" id="cb1544-27" title="27">    quantile(data, quantiles), np.quantile(data, q<span class="op">=</span>quantiles)) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>operands could not be broadcast together with shapes (300,) (3,) </code></pre>
<h4 id="run-2-140">Run 2</h4>
<div class="sourceCode" id="cb1546"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1546-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1546-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1546-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1546-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1546-5" title="5"></a>
<a class="sourceLine" id="cb1546-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1546-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1546-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1546-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1546-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1546-11" title="11"></a>
<a class="sourceLine" id="cb1546-12" title="12"><span class="kw">def</span> quantile(a, q):</a>
<a class="sourceLine" id="cb1546-13" title="13">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1546-14" title="14"><span class="co">  This function computes the q-th quantile of the numpy array a. q can be a sequence of quantiles with values between 0 and 1 inclusive.</span></a>
<a class="sourceLine" id="cb1546-15" title="15"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1546-16" title="16">  <span class="cf">return</span> np.percentile(a, q<span class="op">*</span><span class="dv">100</span>)</a>
<a class="sourceLine" id="cb1546-17" title="17"></a>
<a class="sourceLine" id="cb1546-18" title="18"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1546-19" title="19"></a>
<a class="sourceLine" id="cb1546-20" title="20">np.random.seed(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb1546-21" title="21">M <span class="op">=</span> <span class="dv">100</span></a>
<a class="sourceLine" id="cb1546-22" title="22">data <span class="op">=</span> np.random.randint(<span class="dv">1</span>, M, size<span class="op">=</span>(M,))</a>
<a class="sourceLine" id="cb1546-23" title="23">quantiles <span class="op">=</span> [<span class="fl">0.1</span>, <span class="fl">0.5</span>, <span class="fl">0.9</span>]</a>
<a class="sourceLine" id="cb1546-24" title="24"></a>
<a class="sourceLine" id="cb1546-25" title="25">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.allclose(</a>
<a class="sourceLine" id="cb1546-26" title="26">    quantile(data, quantiles), np.quantile(data, q<span class="op">=</span>quantiles)) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>operands could not be broadcast together with shapes (300,) (3,) </code></pre>
<h4 id="run-3-140">Run 3</h4>
<div class="sourceCode" id="cb1548"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1548-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1548-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1548-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1548-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1548-5" title="5"></a>
<a class="sourceLine" id="cb1548-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1548-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1548-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1548-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1548-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1548-11" title="11"></a>
<a class="sourceLine" id="cb1548-12" title="12"><span class="kw">def</span> quantile(a, q):</a>
<a class="sourceLine" id="cb1548-13" title="13">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1548-14" title="14"><span class="co">  This function computes the q-th quantile of the numpy array a. q can be a sequence of quantiles with values between 0 and 1 inclusive.</span></a>
<a class="sourceLine" id="cb1548-15" title="15"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1548-16" title="16">  <span class="cf">return</span> np.percentile(a, q<span class="op">*</span><span class="dv">100</span>)</a>
<a class="sourceLine" id="cb1548-17" title="17"></a>
<a class="sourceLine" id="cb1548-18" title="18"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1548-19" title="19"></a>
<a class="sourceLine" id="cb1548-20" title="20">np.random.seed(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb1548-21" title="21">M <span class="op">=</span> <span class="dv">100</span></a>
<a class="sourceLine" id="cb1548-22" title="22">data <span class="op">=</span> np.random.randint(<span class="dv">1</span>, M, size<span class="op">=</span>(M,))</a>
<a class="sourceLine" id="cb1548-23" title="23">quantiles <span class="op">=</span> [<span class="fl">0.1</span>, <span class="fl">0.5</span>, <span class="fl">0.9</span>]</a>
<a class="sourceLine" id="cb1548-24" title="24"></a>
<a class="sourceLine" id="cb1548-25" title="25">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.allclose(</a>
<a class="sourceLine" id="cb1548-26" title="26">    quantile(data, quantiles), np.quantile(data, q<span class="op">=</span>quantiles)) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>operands could not be broadcast together with shapes (300,) (3,) </code></pre>
<h4 id="run-4-140">Run 4</h4>
<div class="sourceCode" id="cb1550"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1550-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1550-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1550-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1550-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1550-5" title="5"></a>
<a class="sourceLine" id="cb1550-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1550-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1550-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1550-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1550-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1550-11" title="11"></a>
<a class="sourceLine" id="cb1550-12" title="12"><span class="kw">def</span> quantile(a, q):</a>
<a class="sourceLine" id="cb1550-13" title="13">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1550-14" title="14"><span class="co">  This function computes the q-th quantile of the numpy array a. q can be a sequence of quantiles with values between 0 and 1 inclusive.</span></a>
<a class="sourceLine" id="cb1550-15" title="15"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1550-16" title="16">  <span class="co"># start</span></a>
<a class="sourceLine" id="cb1550-17" title="17">  <span class="cf">return</span> np.percentile(a, q<span class="op">*</span><span class="dv">100</span>)</a>
<a class="sourceLine" id="cb1550-18" title="18">  </a>
<a class="sourceLine" id="cb1550-19" title="19"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1550-20" title="20"></a>
<a class="sourceLine" id="cb1550-21" title="21">np.random.seed(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb1550-22" title="22">M <span class="op">=</span> <span class="dv">100</span></a>
<a class="sourceLine" id="cb1550-23" title="23">data <span class="op">=</span> np.random.randint(<span class="dv">1</span>, M, size<span class="op">=</span>(M,))</a>
<a class="sourceLine" id="cb1550-24" title="24">quantiles <span class="op">=</span> [<span class="fl">0.1</span>, <span class="fl">0.5</span>, <span class="fl">0.9</span>]</a>
<a class="sourceLine" id="cb1550-25" title="25"></a>
<a class="sourceLine" id="cb1550-26" title="26">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.allclose(</a>
<a class="sourceLine" id="cb1550-27" title="27">    quantile(data, quantiles), np.quantile(data, q<span class="op">=</span>quantiles)) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>operands could not be broadcast together with shapes (300,) (3,) </code></pre>
</details>
<details>
<p><summary>random_walk</summary></p>
<h4 id="query-141">Query</h4>
<div class="sourceCode" id="cb1552"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1552-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1552-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1552-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1552-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1552-5" title="5"></a>
<a class="sourceLine" id="cb1552-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1552-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1552-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1552-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1552-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1552-11" title="11"></a>
<a class="sourceLine" id="cb1552-12" title="12"><span class="kw">def</span> random_walk(N):</a>
<a class="sourceLine" id="cb1552-13" title="13">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1552-14" title="14"><span class="co">    This function returns the trajectory of an N step random walk on a one dimensional lattice</span></a>
<a class="sourceLine" id="cb1552-15" title="15"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1552-16" title="16">    a <span class="op">=</span> <span class="dv">1</span> <span class="co"># lattice spacing</span></a>
<a class="sourceLine" id="cb1552-17" title="17">    x0 <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb1552-18" title="18">    </a></code></pre></div>
<h4 id="run-0-141">Run 0</h4>
<div class="sourceCode" id="cb1553"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1553-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1553-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1553-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1553-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1553-5" title="5"></a>
<a class="sourceLine" id="cb1553-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1553-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1553-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1553-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1553-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1553-11" title="11"></a>
<a class="sourceLine" id="cb1553-12" title="12"><span class="kw">def</span> random_walk(N):</a>
<a class="sourceLine" id="cb1553-13" title="13">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1553-14" title="14"><span class="co">    This function returns the trajectory of an N step random walk on a one dimensional lattice</span></a>
<a class="sourceLine" id="cb1553-15" title="15"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1553-16" title="16">    a <span class="op">=</span> <span class="dv">1</span> <span class="co"># lattice spacing</span></a>
<a class="sourceLine" id="cb1553-17" title="17">    x0 <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb1553-18" title="18">    x <span class="op">=</span> np.zeros(N)</a>
<a class="sourceLine" id="cb1553-19" title="19">    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(N):</a>
<a class="sourceLine" id="cb1553-20" title="20">        x[i] <span class="op">=</span> x0 <span class="op">+</span> a<span class="op">*</span>(<span class="dv">2</span><span class="op">*</span>np.random.randint(<span class="dv">2</span>)<span class="op">-</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb1553-21" title="21">        x0 <span class="op">=</span> x[i]</a>
<a class="sourceLine" id="cb1553-22" title="22">    <span class="cf">return</span> x</a>
<a class="sourceLine" id="cb1553-23" title="23"></a>
<a class="sourceLine" id="cb1553-24" title="24"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1553-25" title="25"><span class="co">Create a random walk of 100 steps</span></a>
<a class="sourceLine" id="cb1553-26" title="26"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1553-27" title="27">x <span class="op">=</span> random_walk(<span class="dv">100</span>)</a>
<a class="sourceLine" id="cb1553-28" title="28"></a>
<a class="sourceLine" id="cb1553-29" title="29"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1553-30" title="30"><span class="im">import</span> pylab <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1553-31" title="31">nsteps <span class="op">=</span> <span class="dv">5000</span></a>
<a class="sourceLine" id="cb1553-32" title="32">n_repeats <span class="op">=</span> <span class="dv">250</span></a>
<a class="sourceLine" id="cb1553-33" title="33">nlcc_trj_list <span class="op">=</span> []</a>
<a class="sourceLine" id="cb1553-34" title="34"><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n_repeats):</a>
<a class="sourceLine" id="cb1553-35" title="35">    nlcc_trj <span class="op">=</span> random_walk(nsteps)</a>
<a class="sourceLine" id="cb1553-36" title="36">    nlcc_trj_list.append(nlcc_trj)</a>
<a class="sourceLine" id="cb1553-37" title="37">nlcc_trj_list <span class="op">=</span> np.array(nlcc_trj_list)</a>
<a class="sourceLine" id="cb1553-38" title="38"></a>
<a class="sourceLine" id="cb1553-39" title="39">msd <span class="op">=</span> (nlcc_trj_list<span class="op">*</span>nlcc_trj_list).mean(axis<span class="op">=</span><span class="dv">0</span>)</a>
<a class="sourceLine" id="cb1553-40" title="40"></a>
<a class="sourceLine" id="cb1553-41" title="41">a,b <span class="op">=</span> np.polyfit(np.log(np.arange(<span class="dv">1</span>,nsteps)),np.log(msd[<span class="dv">1</span>:]),<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb1553-42" title="42"><span class="co">#plt.plot(np.arange(nsteps),msd)</span></a>
<a class="sourceLine" id="cb1553-43" title="43"><span class="co">#plt.plot(np.arange(nsteps),np.exp(b+a*np.log(np.arange(nsteps))),linestyle=&#39;--&#39;,label=&#39;fit&#39;)</span></a>
<a class="sourceLine" id="cb1553-44" title="44"><span class="co">#plt.legend()</span></a>
<a class="sourceLine" id="cb1553-45" title="45"><span class="co">#plt.show()</span></a>
<a class="sourceLine" id="cb1553-46" title="46"><span class="co">#print(&quot;a =&quot;,a)</span></a>
<a class="sourceLine" id="cb1553-47" title="47"><span class="co">#print(&quot;b =&quot;,b)</span></a>
<a class="sourceLine" id="cb1553-48" title="48"></a>
<a class="sourceLine" id="cb1553-49" title="49"><span class="co">#ideal exponent for msd is 1</span></a>
<a class="sourceLine" id="cb1553-50" title="50">ideal <span class="op">=</span> <span class="fl">1.0</span></a>
<a class="sourceLine" id="cb1553-51" title="51">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">abs</span>((a<span class="op">-</span>ideal)<span class="op">/</span>ideal) <span class="op">&lt;</span> <span class="fl">0.1</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-141">Run 1</h4>
<div class="sourceCode" id="cb1555"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1555-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1555-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1555-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1555-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1555-5" title="5"></a>
<a class="sourceLine" id="cb1555-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1555-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1555-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1555-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1555-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1555-11" title="11"></a>
<a class="sourceLine" id="cb1555-12" title="12"><span class="kw">def</span> random_walk(N):</a>
<a class="sourceLine" id="cb1555-13" title="13">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1555-14" title="14"><span class="co">    This function returns the trajectory of an N step random walk on a one dimensional lattice</span></a>
<a class="sourceLine" id="cb1555-15" title="15"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1555-16" title="16">    a <span class="op">=</span> <span class="dv">1</span> <span class="co"># lattice spacing</span></a>
<a class="sourceLine" id="cb1555-17" title="17">    x0 <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb1555-18" title="18">    x <span class="op">=</span> np.zeros(N)</a>
<a class="sourceLine" id="cb1555-19" title="19">    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(N):</a>
<a class="sourceLine" id="cb1555-20" title="20">        x[i] <span class="op">=</span> x0 <span class="op">+</span> a<span class="op">*</span>(<span class="dv">2</span><span class="op">*</span>np.random.randint(<span class="dv">2</span>)<span class="op">-</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb1555-21" title="21">        x0 <span class="op">=</span> x[i]</a>
<a class="sourceLine" id="cb1555-22" title="22">    <span class="cf">return</span> x</a>
<a class="sourceLine" id="cb1555-23" title="23"></a>
<a class="sourceLine" id="cb1555-24" title="24"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1555-25" title="25"><span class="im">import</span> pylab <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1555-26" title="26">nsteps <span class="op">=</span> <span class="dv">5000</span></a>
<a class="sourceLine" id="cb1555-27" title="27">n_repeats <span class="op">=</span> <span class="dv">250</span></a>
<a class="sourceLine" id="cb1555-28" title="28">nlcc_trj_list <span class="op">=</span> []</a>
<a class="sourceLine" id="cb1555-29" title="29"><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n_repeats):</a>
<a class="sourceLine" id="cb1555-30" title="30">    nlcc_trj <span class="op">=</span> random_walk(nsteps)</a>
<a class="sourceLine" id="cb1555-31" title="31">    nlcc_trj_list.append(nlcc_trj)</a>
<a class="sourceLine" id="cb1555-32" title="32">nlcc_trj_list <span class="op">=</span> np.array(nlcc_trj_list)</a>
<a class="sourceLine" id="cb1555-33" title="33"></a>
<a class="sourceLine" id="cb1555-34" title="34">msd <span class="op">=</span> (nlcc_trj_list<span class="op">*</span>nlcc_trj_list).mean(axis<span class="op">=</span><span class="dv">0</span>)</a>
<a class="sourceLine" id="cb1555-35" title="35"></a>
<a class="sourceLine" id="cb1555-36" title="36">a,b <span class="op">=</span> np.polyfit(np.log(np.arange(<span class="dv">1</span>,nsteps)),np.log(msd[<span class="dv">1</span>:]),<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb1555-37" title="37"><span class="co">#plt.plot(np.arange(nsteps),msd)</span></a>
<a class="sourceLine" id="cb1555-38" title="38"><span class="co">#plt.plot(np.arange(nsteps),np.exp(b+a*np.log(np.arange(nsteps))),linestyle=&#39;--&#39;,label=&#39;fit&#39;)</span></a>
<a class="sourceLine" id="cb1555-39" title="39"><span class="co">#plt.legend()</span></a>
<a class="sourceLine" id="cb1555-40" title="40"><span class="co">#plt.show()</span></a>
<a class="sourceLine" id="cb1555-41" title="41"><span class="co">#print(&quot;a =&quot;,a)</span></a>
<a class="sourceLine" id="cb1555-42" title="42"><span class="co">#print(&quot;b =&quot;,b)</span></a>
<a class="sourceLine" id="cb1555-43" title="43"></a>
<a class="sourceLine" id="cb1555-44" title="44"><span class="co">#ideal exponent for msd is 1</span></a>
<a class="sourceLine" id="cb1555-45" title="45">ideal <span class="op">=</span> <span class="fl">1.0</span></a>
<a class="sourceLine" id="cb1555-46" title="46">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">abs</span>((a<span class="op">-</span>ideal)<span class="op">/</span>ideal) <span class="op">&lt;</span> <span class="fl">0.1</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-141">Run 2</h4>
<div class="sourceCode" id="cb1557"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1557-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1557-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1557-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1557-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1557-5" title="5"></a>
<a class="sourceLine" id="cb1557-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1557-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1557-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1557-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1557-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1557-11" title="11"></a>
<a class="sourceLine" id="cb1557-12" title="12"><span class="kw">def</span> random_walk(N):</a>
<a class="sourceLine" id="cb1557-13" title="13">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1557-14" title="14"><span class="co">    This function returns the trajectory of an N step random walk on a one dimensional lattice</span></a>
<a class="sourceLine" id="cb1557-15" title="15"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1557-16" title="16">    a <span class="op">=</span> <span class="dv">1</span> <span class="co"># lattice spacing</span></a>
<a class="sourceLine" id="cb1557-17" title="17">    x0 <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb1557-18" title="18">    x <span class="op">=</span> np.zeros(N)</a>
<a class="sourceLine" id="cb1557-19" title="19">    x[<span class="dv">0</span>] <span class="op">=</span> x0</a>
<a class="sourceLine" id="cb1557-20" title="20">    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>,N):</a>
<a class="sourceLine" id="cb1557-21" title="21">        x[i] <span class="op">=</span> x[i<span class="dv">-1</span>] <span class="op">+</span> a<span class="op">*</span>(<span class="dv">2</span><span class="op">*</span>np.random.randint(<span class="dv">2</span>)<span class="op">-</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb1557-22" title="22">    <span class="cf">return</span> x</a>
<a class="sourceLine" id="cb1557-23" title="23"></a>
<a class="sourceLine" id="cb1557-24" title="24"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1557-25" title="25"><span class="im">import</span> pylab <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1557-26" title="26">nsteps <span class="op">=</span> <span class="dv">5000</span></a>
<a class="sourceLine" id="cb1557-27" title="27">n_repeats <span class="op">=</span> <span class="dv">250</span></a>
<a class="sourceLine" id="cb1557-28" title="28">nlcc_trj_list <span class="op">=</span> []</a>
<a class="sourceLine" id="cb1557-29" title="29"><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n_repeats):</a>
<a class="sourceLine" id="cb1557-30" title="30">    nlcc_trj <span class="op">=</span> random_walk(nsteps)</a>
<a class="sourceLine" id="cb1557-31" title="31">    nlcc_trj_list.append(nlcc_trj)</a>
<a class="sourceLine" id="cb1557-32" title="32">nlcc_trj_list <span class="op">=</span> np.array(nlcc_trj_list)</a>
<a class="sourceLine" id="cb1557-33" title="33"></a>
<a class="sourceLine" id="cb1557-34" title="34">msd <span class="op">=</span> (nlcc_trj_list<span class="op">*</span>nlcc_trj_list).mean(axis<span class="op">=</span><span class="dv">0</span>)</a>
<a class="sourceLine" id="cb1557-35" title="35"></a>
<a class="sourceLine" id="cb1557-36" title="36">a,b <span class="op">=</span> np.polyfit(np.log(np.arange(<span class="dv">1</span>,nsteps)),np.log(msd[<span class="dv">1</span>:]),<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb1557-37" title="37"><span class="co">#plt.plot(np.arange(nsteps),msd)</span></a>
<a class="sourceLine" id="cb1557-38" title="38"><span class="co">#plt.plot(np.arange(nsteps),np.exp(b+a*np.log(np.arange(nsteps))),linestyle=&#39;--&#39;,label=&#39;fit&#39;)</span></a>
<a class="sourceLine" id="cb1557-39" title="39"><span class="co">#plt.legend()</span></a>
<a class="sourceLine" id="cb1557-40" title="40"><span class="co">#plt.show()</span></a>
<a class="sourceLine" id="cb1557-41" title="41"><span class="co">#print(&quot;a =&quot;,a)</span></a>
<a class="sourceLine" id="cb1557-42" title="42"><span class="co">#print(&quot;b =&quot;,b)</span></a>
<a class="sourceLine" id="cb1557-43" title="43"></a>
<a class="sourceLine" id="cb1557-44" title="44"><span class="co">#ideal exponent for msd is 1</span></a>
<a class="sourceLine" id="cb1557-45" title="45">ideal <span class="op">=</span> <span class="fl">1.0</span></a>
<a class="sourceLine" id="cb1557-46" title="46">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">abs</span>((a<span class="op">-</span>ideal)<span class="op">/</span>ideal) <span class="op">&lt;</span> <span class="fl">0.1</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-141">Run 3</h4>
<div class="sourceCode" id="cb1559"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1559-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1559-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1559-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1559-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1559-5" title="5"></a>
<a class="sourceLine" id="cb1559-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1559-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1559-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1559-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1559-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1559-11" title="11"></a>
<a class="sourceLine" id="cb1559-12" title="12"><span class="kw">def</span> random_walk(N):</a>
<a class="sourceLine" id="cb1559-13" title="13">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1559-14" title="14"><span class="co">    This function returns the trajectory of an N step random walk on a one dimensional lattice</span></a>
<a class="sourceLine" id="cb1559-15" title="15"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1559-16" title="16">    a <span class="op">=</span> <span class="dv">1</span> <span class="co"># lattice spacing</span></a>
<a class="sourceLine" id="cb1559-17" title="17">    x0 <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb1559-18" title="18">    x <span class="op">=</span> np.zeros(N)</a>
<a class="sourceLine" id="cb1559-19" title="19">    x[<span class="dv">0</span>] <span class="op">=</span> x0</a>
<a class="sourceLine" id="cb1559-20" title="20">    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>,N):</a>
<a class="sourceLine" id="cb1559-21" title="21">        x[i] <span class="op">=</span> x[i<span class="dv">-1</span>] <span class="op">+</span> a<span class="op">*</span>np.random.choice([<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb1559-22" title="22">    <span class="cf">return</span> x</a>
<a class="sourceLine" id="cb1559-23" title="23"></a>
<a class="sourceLine" id="cb1559-24" title="24"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1559-25" title="25"><span class="im">import</span> pylab <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1559-26" title="26">nsteps <span class="op">=</span> <span class="dv">5000</span></a>
<a class="sourceLine" id="cb1559-27" title="27">n_repeats <span class="op">=</span> <span class="dv">250</span></a>
<a class="sourceLine" id="cb1559-28" title="28">nlcc_trj_list <span class="op">=</span> []</a>
<a class="sourceLine" id="cb1559-29" title="29"><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n_repeats):</a>
<a class="sourceLine" id="cb1559-30" title="30">    nlcc_trj <span class="op">=</span> random_walk(nsteps)</a>
<a class="sourceLine" id="cb1559-31" title="31">    nlcc_trj_list.append(nlcc_trj)</a>
<a class="sourceLine" id="cb1559-32" title="32">nlcc_trj_list <span class="op">=</span> np.array(nlcc_trj_list)</a>
<a class="sourceLine" id="cb1559-33" title="33"></a>
<a class="sourceLine" id="cb1559-34" title="34">msd <span class="op">=</span> (nlcc_trj_list<span class="op">*</span>nlcc_trj_list).mean(axis<span class="op">=</span><span class="dv">0</span>)</a>
<a class="sourceLine" id="cb1559-35" title="35"></a>
<a class="sourceLine" id="cb1559-36" title="36">a,b <span class="op">=</span> np.polyfit(np.log(np.arange(<span class="dv">1</span>,nsteps)),np.log(msd[<span class="dv">1</span>:]),<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb1559-37" title="37"><span class="co">#plt.plot(np.arange(nsteps),msd)</span></a>
<a class="sourceLine" id="cb1559-38" title="38"><span class="co">#plt.plot(np.arange(nsteps),np.exp(b+a*np.log(np.arange(nsteps))),linestyle=&#39;--&#39;,label=&#39;fit&#39;)</span></a>
<a class="sourceLine" id="cb1559-39" title="39"><span class="co">#plt.legend()</span></a>
<a class="sourceLine" id="cb1559-40" title="40"><span class="co">#plt.show()</span></a>
<a class="sourceLine" id="cb1559-41" title="41"><span class="co">#print(&quot;a =&quot;,a)</span></a>
<a class="sourceLine" id="cb1559-42" title="42"><span class="co">#print(&quot;b =&quot;,b)</span></a>
<a class="sourceLine" id="cb1559-43" title="43"></a>
<a class="sourceLine" id="cb1559-44" title="44"><span class="co">#ideal exponent for msd is 1</span></a>
<a class="sourceLine" id="cb1559-45" title="45">ideal <span class="op">=</span> <span class="fl">1.0</span></a>
<a class="sourceLine" id="cb1559-46" title="46">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">abs</span>((a<span class="op">-</span>ideal)<span class="op">/</span>ideal) <span class="op">&lt;</span> <span class="fl">0.1</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Timeout</code></pre>
<h4 id="run-4-141">Run 4</h4>
<div class="sourceCode" id="cb1561"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1561-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1561-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1561-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1561-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1561-5" title="5"></a>
<a class="sourceLine" id="cb1561-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1561-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1561-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1561-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1561-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1561-11" title="11"></a>
<a class="sourceLine" id="cb1561-12" title="12"><span class="kw">def</span> random_walk(N):</a>
<a class="sourceLine" id="cb1561-13" title="13">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1561-14" title="14"><span class="co">    This function returns the trajectory of an N step random walk on a one dimensional lattice</span></a>
<a class="sourceLine" id="cb1561-15" title="15"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1561-16" title="16">    a <span class="op">=</span> <span class="dv">1</span> <span class="co"># lattice spacing</span></a>
<a class="sourceLine" id="cb1561-17" title="17">    x0 <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb1561-18" title="18">    x <span class="op">=</span> np.zeros(N)</a>
<a class="sourceLine" id="cb1561-19" title="19">    x[<span class="dv">0</span>] <span class="op">=</span> x0</a>
<a class="sourceLine" id="cb1561-20" title="20">    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>,N):</a>
<a class="sourceLine" id="cb1561-21" title="21">        x[i] <span class="op">=</span> x[i<span class="dv">-1</span>] <span class="op">+</span> a<span class="op">*</span>(<span class="dv">2</span><span class="op">*</span>np.random.randint(<span class="dv">2</span>)<span class="op">-</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb1561-22" title="22">    <span class="cf">return</span> x</a>
<a class="sourceLine" id="cb1561-23" title="23"></a>
<a class="sourceLine" id="cb1561-24" title="24"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1561-25" title="25"><span class="im">import</span> pylab <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1561-26" title="26">nsteps <span class="op">=</span> <span class="dv">5000</span></a>
<a class="sourceLine" id="cb1561-27" title="27">n_repeats <span class="op">=</span> <span class="dv">250</span></a>
<a class="sourceLine" id="cb1561-28" title="28">nlcc_trj_list <span class="op">=</span> []</a>
<a class="sourceLine" id="cb1561-29" title="29"><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n_repeats):</a>
<a class="sourceLine" id="cb1561-30" title="30">    nlcc_trj <span class="op">=</span> random_walk(nsteps)</a>
<a class="sourceLine" id="cb1561-31" title="31">    nlcc_trj_list.append(nlcc_trj)</a>
<a class="sourceLine" id="cb1561-32" title="32">nlcc_trj_list <span class="op">=</span> np.array(nlcc_trj_list)</a>
<a class="sourceLine" id="cb1561-33" title="33"></a>
<a class="sourceLine" id="cb1561-34" title="34">msd <span class="op">=</span> (nlcc_trj_list<span class="op">*</span>nlcc_trj_list).mean(axis<span class="op">=</span><span class="dv">0</span>)</a>
<a class="sourceLine" id="cb1561-35" title="35"></a>
<a class="sourceLine" id="cb1561-36" title="36">a,b <span class="op">=</span> np.polyfit(np.log(np.arange(<span class="dv">1</span>,nsteps)),np.log(msd[<span class="dv">1</span>:]),<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb1561-37" title="37"><span class="co">#plt.plot(np.arange(nsteps),msd)</span></a>
<a class="sourceLine" id="cb1561-38" title="38"><span class="co">#plt.plot(np.arange(nsteps),np.exp(b+a*np.log(np.arange(nsteps))),linestyle=&#39;--&#39;,label=&#39;fit&#39;)</span></a>
<a class="sourceLine" id="cb1561-39" title="39"><span class="co">#plt.legend()</span></a>
<a class="sourceLine" id="cb1561-40" title="40"><span class="co">#plt.show()</span></a>
<a class="sourceLine" id="cb1561-41" title="41"><span class="co">#print(&quot;a =&quot;,a)</span></a>
<a class="sourceLine" id="cb1561-42" title="42"><span class="co">#print(&quot;b =&quot;,b)</span></a>
<a class="sourceLine" id="cb1561-43" title="43"></a>
<a class="sourceLine" id="cb1561-44" title="44"><span class="co">#ideal exponent for msd is 1</span></a>
<a class="sourceLine" id="cb1561-45" title="45">ideal <span class="op">=</span> <span class="fl">1.0</span></a>
<a class="sourceLine" id="cb1561-46" title="46">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">abs</span>((a<span class="op">-</span>ideal)<span class="op">/</span>ideal) <span class="op">&lt;</span> <span class="fl">0.1</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>rank</summary></p>
<h4 id="query-142">Query</h4>
<div class="sourceCode" id="cb1563"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1563-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1563-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1563-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1563-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1563-5" title="5"></a>
<a class="sourceLine" id="cb1563-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1563-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1563-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1563-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1563-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1563-11" title="11"></a>
<a class="sourceLine" id="cb1563-12" title="12"><span class="kw">def</span> rank(M):</a>
<a class="sourceLine" id="cb1563-13" title="13">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1563-14" title="14"><span class="co">    这个函数使用奇异值分解来计算矩阵M的秩。</span></a>
<a class="sourceLine" id="cb1563-15" title="15"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1563-16" title="16">    </a></code></pre></div>
<h4 id="run-0-142">Run 0</h4>
<div class="sourceCode" id="cb1564"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1564-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1564-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1564-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1564-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1564-5" title="5"></a>
<a class="sourceLine" id="cb1564-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1564-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1564-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1564-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1564-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1564-11" title="11"></a>
<a class="sourceLine" id="cb1564-12" title="12"><span class="kw">def</span> rank(M):</a>
<a class="sourceLine" id="cb1564-13" title="13">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1564-14" title="14"><span class="co">    这个函数使用奇异值分解来计算矩阵M的秩。</span></a>
<a class="sourceLine" id="cb1564-15" title="15"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1564-16" title="16">    <span class="co"># 在这里写出你的代码</span></a>
<a class="sourceLine" id="cb1564-17" title="17">    U, s, V <span class="op">=</span> np.linalg.svd(M)</a>
<a class="sourceLine" id="cb1564-18" title="18">    <span class="cf">return</span> np.<span class="bu">sum</span>(s <span class="op">&gt;</span> <span class="fl">1e-10</span>)</a>
<a class="sourceLine" id="cb1564-19" title="19">    </a>
<a class="sourceLine" id="cb1564-20" title="20"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1564-21" title="21"></a>
<a class="sourceLine" id="cb1564-22" title="22">np.random.seed(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb1564-23" title="23">M <span class="op">=</span> np.random.random((<span class="dv">5</span>,<span class="dv">5</span>))</a>
<a class="sourceLine" id="cb1564-24" title="24">r <span class="op">=</span> np.linalg.matrix_rank(M)</a>
<a class="sourceLine" id="cb1564-25" title="25"></a>
<a class="sourceLine" id="cb1564-26" title="26">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(r, rank(M)) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-142">Run 1</h4>
<div class="sourceCode" id="cb1566"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1566-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1566-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1566-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1566-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1566-5" title="5"></a>
<a class="sourceLine" id="cb1566-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1566-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1566-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1566-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1566-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1566-11" title="11"></a>
<a class="sourceLine" id="cb1566-12" title="12"><span class="kw">def</span> rank(M):</a>
<a class="sourceLine" id="cb1566-13" title="13">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1566-14" title="14"><span class="co">    这个函数使用奇异值分解来计算矩阵M的秩。</span></a>
<a class="sourceLine" id="cb1566-15" title="15"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1566-16" title="16">    <span class="co"># begin</span></a>
<a class="sourceLine" id="cb1566-17" title="17">    U, s, V <span class="op">=</span> np.linalg.svd(M)</a>
<a class="sourceLine" id="cb1566-18" title="18">    rank <span class="op">=</span> np.<span class="bu">sum</span>(s <span class="op">&gt;</span> <span class="fl">1e-10</span>)</a>
<a class="sourceLine" id="cb1566-19" title="19">    </a>
<a class="sourceLine" id="cb1566-20" title="20"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1566-21" title="21"></a>
<a class="sourceLine" id="cb1566-22" title="22">np.random.seed(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb1566-23" title="23">M <span class="op">=</span> np.random.random((<span class="dv">5</span>,<span class="dv">5</span>))</a>
<a class="sourceLine" id="cb1566-24" title="24">r <span class="op">=</span> np.linalg.matrix_rank(M)</a>
<a class="sourceLine" id="cb1566-25" title="25"></a>
<a class="sourceLine" id="cb1566-26" title="26">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(r, rank(M)) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>ufunc &#39;isfinite&#39; not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule &#39;&#39;safe&#39;&#39;</code></pre>
<h4 id="run-2-142">Run 2</h4>
<div class="sourceCode" id="cb1568"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1568-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1568-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1568-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1568-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1568-5" title="5"></a>
<a class="sourceLine" id="cb1568-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1568-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1568-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1568-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1568-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1568-11" title="11"></a>
<a class="sourceLine" id="cb1568-12" title="12"><span class="kw">def</span> rank(M):</a>
<a class="sourceLine" id="cb1568-13" title="13">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1568-14" title="14"><span class="co">    这个函数使用奇异值分解来计算矩阵M的秩。</span></a>
<a class="sourceLine" id="cb1568-15" title="15"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1568-16" title="16">    <span class="co"># start</span></a>
<a class="sourceLine" id="cb1568-17" title="17">    U, s, V <span class="op">=</span> np.linalg.svd(M)</a>
<a class="sourceLine" id="cb1568-18" title="18">    <span class="cf">return</span> np.<span class="bu">sum</span>(s <span class="op">&gt;</span> <span class="fl">1e-10</span>)</a>
<a class="sourceLine" id="cb1568-19" title="19">    </a>
<a class="sourceLine" id="cb1568-20" title="20"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1568-21" title="21"></a>
<a class="sourceLine" id="cb1568-22" title="22">np.random.seed(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb1568-23" title="23">M <span class="op">=</span> np.random.random((<span class="dv">5</span>,<span class="dv">5</span>))</a>
<a class="sourceLine" id="cb1568-24" title="24">r <span class="op">=</span> np.linalg.matrix_rank(M)</a>
<a class="sourceLine" id="cb1568-25" title="25"></a>
<a class="sourceLine" id="cb1568-26" title="26">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(r, rank(M)) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-142">Run 3</h4>
<div class="sourceCode" id="cb1570"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1570-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1570-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1570-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1570-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1570-5" title="5"></a>
<a class="sourceLine" id="cb1570-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1570-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1570-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1570-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1570-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1570-11" title="11"></a>
<a class="sourceLine" id="cb1570-12" title="12"><span class="kw">def</span> rank(M):</a>
<a class="sourceLine" id="cb1570-13" title="13">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1570-14" title="14"><span class="co">    这个函数使用奇异值分解来计算矩阵M的秩。</span></a>
<a class="sourceLine" id="cb1570-15" title="15"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1570-16" title="16">    <span class="co"># 在这里实现你的代码</span></a>
<a class="sourceLine" id="cb1570-17" title="17">    U, S, V <span class="op">=</span> np.linalg.svd(M)</a>
<a class="sourceLine" id="cb1570-18" title="18">    rank <span class="op">=</span> np.<span class="bu">sum</span>(S <span class="op">&gt;</span> <span class="fl">1e-10</span>)</a>
<a class="sourceLine" id="cb1570-19" title="19">    <span class="cf">return</span> rank</a>
<a class="sourceLine" id="cb1570-20" title="20">    </a>
<a class="sourceLine" id="cb1570-21" title="21"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1570-22" title="22"></a>
<a class="sourceLine" id="cb1570-23" title="23">np.random.seed(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb1570-24" title="24">M <span class="op">=</span> np.random.random((<span class="dv">5</span>,<span class="dv">5</span>))</a>
<a class="sourceLine" id="cb1570-25" title="25">r <span class="op">=</span> np.linalg.matrix_rank(M)</a>
<a class="sourceLine" id="cb1570-26" title="26"></a>
<a class="sourceLine" id="cb1570-27" title="27">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(r, rank(M)) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-142">Run 4</h4>
<div class="sourceCode" id="cb1572"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1572-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1572-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1572-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1572-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1572-5" title="5"></a>
<a class="sourceLine" id="cb1572-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1572-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1572-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1572-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1572-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1572-11" title="11"></a>
<a class="sourceLine" id="cb1572-12" title="12"><span class="kw">def</span> rank(M):</a>
<a class="sourceLine" id="cb1572-13" title="13">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1572-14" title="14"><span class="co">    这个函数使用奇异值分解来计算矩阵M的秩。</span></a>
<a class="sourceLine" id="cb1572-15" title="15"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1572-16" title="16">    <span class="co"># begin</span></a>
<a class="sourceLine" id="cb1572-17" title="17">    U, s, V <span class="op">=</span> np.linalg.svd(M)</a>
<a class="sourceLine" id="cb1572-18" title="18">    <span class="cf">return</span> np.<span class="bu">sum</span>(s <span class="op">&gt;</span> <span class="fl">1e-10</span>)</a>
<a class="sourceLine" id="cb1572-19" title="19">    </a>
<a class="sourceLine" id="cb1572-20" title="20"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1572-21" title="21"></a>
<a class="sourceLine" id="cb1572-22" title="22">np.random.seed(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb1572-23" title="23">M <span class="op">=</span> np.random.random((<span class="dv">5</span>,<span class="dv">5</span>))</a>
<a class="sourceLine" id="cb1572-24" title="24">r <span class="op">=</span> np.linalg.matrix_rank(M)</a>
<a class="sourceLine" id="cb1572-25" title="25"></a>
<a class="sourceLine" id="cb1572-26" title="26">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(r, rank(M)) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>rank</summary></p>
<h4 id="query-143">Query</h4>
<div class="sourceCode" id="cb1574"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1574-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1574-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1574-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1574-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1574-5" title="5"></a>
<a class="sourceLine" id="cb1574-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1574-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1574-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1574-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1574-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1574-11" title="11"></a>
<a class="sourceLine" id="cb1574-12" title="12"><span class="kw">def</span> rank(M):</a>
<a class="sourceLine" id="cb1574-13" title="13">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1574-14" title="14"><span class="co">    This function calculates the rank of matrix M using singular value decomposition.</span></a>
<a class="sourceLine" id="cb1574-15" title="15"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1574-16" title="16">    </a></code></pre></div>
<h4 id="run-0-143">Run 0</h4>
<div class="sourceCode" id="cb1575"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1575-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1575-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1575-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1575-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1575-5" title="5"></a>
<a class="sourceLine" id="cb1575-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1575-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1575-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1575-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1575-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1575-11" title="11"></a>
<a class="sourceLine" id="cb1575-12" title="12"><span class="kw">def</span> rank(M):</a>
<a class="sourceLine" id="cb1575-13" title="13">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1575-14" title="14"><span class="co">    This function calculates the rank of matrix M using singular value decomposition.</span></a>
<a class="sourceLine" id="cb1575-15" title="15"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1575-16" title="16">    U, s, V <span class="op">=</span> np.linalg.svd(M)</a>
<a class="sourceLine" id="cb1575-17" title="17">    <span class="cf">return</span> np.<span class="bu">sum</span>(s <span class="op">&gt;</span> <span class="fl">1e-10</span>)</a>
<a class="sourceLine" id="cb1575-18" title="18"></a>
<a class="sourceLine" id="cb1575-19" title="19"></a>
<a class="sourceLine" id="cb1575-20" title="20"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1575-21" title="21"></a>
<a class="sourceLine" id="cb1575-22" title="22">np.random.seed(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb1575-23" title="23">M <span class="op">=</span> np.random.random((<span class="dv">5</span>,<span class="dv">5</span>))</a>
<a class="sourceLine" id="cb1575-24" title="24">r <span class="op">=</span> np.linalg.matrix_rank(M)</a>
<a class="sourceLine" id="cb1575-25" title="25"></a>
<a class="sourceLine" id="cb1575-26" title="26">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(r, rank(M)) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-143">Run 1</h4>
<div class="sourceCode" id="cb1577"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1577-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1577-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1577-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1577-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1577-5" title="5"></a>
<a class="sourceLine" id="cb1577-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1577-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1577-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1577-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1577-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1577-11" title="11"></a>
<a class="sourceLine" id="cb1577-12" title="12"><span class="kw">def</span> rank(M):</a>
<a class="sourceLine" id="cb1577-13" title="13">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1577-14" title="14"><span class="co">    This function calculates the rank of matrix M using singular value decomposition.</span></a>
<a class="sourceLine" id="cb1577-15" title="15"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1577-16" title="16">    <span class="co"># start</span></a>
<a class="sourceLine" id="cb1577-17" title="17">    U, S, V <span class="op">=</span> np.linalg.svd(M)</a>
<a class="sourceLine" id="cb1577-18" title="18">    <span class="cf">return</span> np.<span class="bu">sum</span>(S <span class="op">&gt;</span> <span class="fl">1e-10</span>)</a>
<a class="sourceLine" id="cb1577-19" title="19">    </a>
<a class="sourceLine" id="cb1577-20" title="20"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1577-21" title="21"></a>
<a class="sourceLine" id="cb1577-22" title="22">np.random.seed(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb1577-23" title="23">M <span class="op">=</span> np.random.random((<span class="dv">5</span>,<span class="dv">5</span>))</a>
<a class="sourceLine" id="cb1577-24" title="24">r <span class="op">=</span> np.linalg.matrix_rank(M)</a>
<a class="sourceLine" id="cb1577-25" title="25"></a>
<a class="sourceLine" id="cb1577-26" title="26">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(r, rank(M)) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-143">Run 2</h4>
<div class="sourceCode" id="cb1579"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1579-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1579-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1579-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1579-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1579-5" title="5"></a>
<a class="sourceLine" id="cb1579-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1579-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1579-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1579-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1579-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1579-11" title="11"></a>
<a class="sourceLine" id="cb1579-12" title="12"><span class="kw">def</span> rank(M):</a>
<a class="sourceLine" id="cb1579-13" title="13">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1579-14" title="14"><span class="co">    This function calculates the rank of matrix M using singular value decomposition.</span></a>
<a class="sourceLine" id="cb1579-15" title="15"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1579-16" title="16">    U, S, V <span class="op">=</span> np.linalg.svd(M)</a>
<a class="sourceLine" id="cb1579-17" title="17">    <span class="cf">return</span> np.<span class="bu">sum</span>(S <span class="op">&gt;</span> <span class="fl">1e-10</span>)</a>
<a class="sourceLine" id="cb1579-18" title="18"></a>
<a class="sourceLine" id="cb1579-19" title="19"></a>
<a class="sourceLine" id="cb1579-20" title="20"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1579-21" title="21"></a>
<a class="sourceLine" id="cb1579-22" title="22">np.random.seed(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb1579-23" title="23">M <span class="op">=</span> np.random.random((<span class="dv">5</span>,<span class="dv">5</span>))</a>
<a class="sourceLine" id="cb1579-24" title="24">r <span class="op">=</span> np.linalg.matrix_rank(M)</a>
<a class="sourceLine" id="cb1579-25" title="25"></a>
<a class="sourceLine" id="cb1579-26" title="26">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(r, rank(M)) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-143">Run 3</h4>
<div class="sourceCode" id="cb1581"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1581-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1581-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1581-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1581-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1581-5" title="5"></a>
<a class="sourceLine" id="cb1581-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1581-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1581-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1581-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1581-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1581-11" title="11"></a>
<a class="sourceLine" id="cb1581-12" title="12"><span class="kw">def</span> rank(M):</a>
<a class="sourceLine" id="cb1581-13" title="13">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1581-14" title="14"><span class="co">    This function calculates the rank of matrix M using singular value decomposition.</span></a>
<a class="sourceLine" id="cb1581-15" title="15"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1581-16" title="16">    <span class="cf">return</span> np.linalg.svd(M)[<span class="dv">1</span>].size</a>
<a class="sourceLine" id="cb1581-17" title="17"></a>
<a class="sourceLine" id="cb1581-18" title="18"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1581-19" title="19"></a>
<a class="sourceLine" id="cb1581-20" title="20">np.random.seed(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb1581-21" title="21">M <span class="op">=</span> np.random.random((<span class="dv">5</span>,<span class="dv">5</span>))</a>
<a class="sourceLine" id="cb1581-22" title="22">r <span class="op">=</span> np.linalg.matrix_rank(M)</a>
<a class="sourceLine" id="cb1581-23" title="23"></a>
<a class="sourceLine" id="cb1581-24" title="24">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(r, rank(M)) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-143">Run 4</h4>
<div class="sourceCode" id="cb1583"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1583-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1583-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1583-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1583-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1583-5" title="5"></a>
<a class="sourceLine" id="cb1583-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1583-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1583-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1583-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1583-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1583-11" title="11"></a>
<a class="sourceLine" id="cb1583-12" title="12"><span class="kw">def</span> rank(M):</a>
<a class="sourceLine" id="cb1583-13" title="13">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1583-14" title="14"><span class="co">    This function calculates the rank of matrix M using singular value decomposition.</span></a>
<a class="sourceLine" id="cb1583-15" title="15"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1583-16" title="16">    U, S, V <span class="op">=</span> np.linalg.svd(M)</a>
<a class="sourceLine" id="cb1583-17" title="17">    <span class="cf">return</span> np.<span class="bu">sum</span>(S <span class="op">&gt;</span> <span class="fl">1e-6</span>)</a>
<a class="sourceLine" id="cb1583-18" title="18"></a>
<a class="sourceLine" id="cb1583-19" title="19"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1583-20" title="20"></a>
<a class="sourceLine" id="cb1583-21" title="21">np.random.seed(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb1583-22" title="22">M <span class="op">=</span> np.random.random((<span class="dv">5</span>,<span class="dv">5</span>))</a>
<a class="sourceLine" id="cb1583-23" title="23">r <span class="op">=</span> np.linalg.matrix_rank(M)</a>
<a class="sourceLine" id="cb1583-24" title="24"></a>
<a class="sourceLine" id="cb1583-25" title="25">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(r, rank(M)) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>remove-water</summary></p>
<h4 id="query-144">Query</h4>
<div class="sourceCode" id="cb1585"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1585-1" title="1"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb1585-2" title="2"></a>
<a class="sourceLine" id="cb1585-3" title="3"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1585-4" title="4"><span class="co">Print version string</span></a>
<a class="sourceLine" id="cb1585-5" title="5"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1585-6" title="6"><span class="bu">print</span>(md.version.full_version)</a>
<a class="sourceLine" id="cb1585-7" title="7"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1585-8" title="8"></a>
<a class="sourceLine" id="cb1585-9" title="9"><span class="kw">def</span> remove_water(traj_file,top_file):</a>
<a class="sourceLine" id="cb1585-10" title="10">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1585-11" title="11"><span class="co">  This function removes solvent from loaded trajectory traj_file and topology in top_file to return the new trajctory</span></a>
<a class="sourceLine" id="cb1585-12" title="12"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1585-13" title="13">  </a></code></pre></div>
<h4 id="run-0-144">Run 0</h4>
<div class="sourceCode" id="cb1586"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1586-1" title="1"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb1586-2" title="2"></a>
<a class="sourceLine" id="cb1586-3" title="3"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1586-4" title="4"><span class="co">Print version string</span></a>
<a class="sourceLine" id="cb1586-5" title="5"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1586-6" title="6"><span class="bu">print</span>(md.version.full_version)</a>
<a class="sourceLine" id="cb1586-7" title="7"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1586-8" title="8"></a>
<a class="sourceLine" id="cb1586-9" title="9"><span class="kw">def</span> remove_water(traj_file,top_file):</a>
<a class="sourceLine" id="cb1586-10" title="10">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1586-11" title="11"><span class="co">  This function removes solvent from loaded trajectory traj_file and topology in top_file to return the new trajctory</span></a>
<a class="sourceLine" id="cb1586-12" title="12"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1586-13" title="13">  traj <span class="op">=</span> md.load(traj_file,top<span class="op">=</span>top_file)</a>
<a class="sourceLine" id="cb1586-14" title="14">  traj.remove_solvent(inplace<span class="op">=</span><span class="va">True</span>)</a>
<a class="sourceLine" id="cb1586-15" title="15">  <span class="cf">return</span> traj</a>
<a class="sourceLine" id="cb1586-16" title="16"></a>
<a class="sourceLine" id="cb1586-17" title="17"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb1586-18" title="18"><span class="im">import</span> mdtraj <span class="im">as</span> md </a>
<a class="sourceLine" id="cb1586-19" title="19"></a>
<a class="sourceLine" id="cb1586-20" title="20">traj <span class="op">=</span> md.load(os.path.join(_FILE_DIR_,<span class="st">&#39;trp-cage-small.trr&#39;</span>), top<span class="op">=</span>os.path.join(_FILE_DIR_,<span class="st">&#39;trp-cage.pdb&#39;</span>))</a>
<a class="sourceLine" id="cb1586-21" title="21">nowater <span class="op">=</span> traj.remove_solvent()</a>
<a class="sourceLine" id="cb1586-22" title="22">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> remove_water(os.path.join(_FILE_DIR_,<span class="st">&#39;trp-cage-small.trr&#39;</span>),os.path.join(_FILE_DIR_,<span class="st">&#39;trp-cage.pdb&#39;</span>)).n_atoms <span class="op">==</span> nowater.n_atoms <span class="cf">else</span> <span class="va">False</span> </a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-144">Run 1</h4>
<div class="sourceCode" id="cb1588"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1588-1" title="1"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb1588-2" title="2"></a>
<a class="sourceLine" id="cb1588-3" title="3"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1588-4" title="4"><span class="co">Print version string</span></a>
<a class="sourceLine" id="cb1588-5" title="5"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1588-6" title="6"><span class="bu">print</span>(md.version.full_version)</a>
<a class="sourceLine" id="cb1588-7" title="7"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1588-8" title="8"></a>
<a class="sourceLine" id="cb1588-9" title="9"><span class="kw">def</span> remove_water(traj_file,top_file):</a>
<a class="sourceLine" id="cb1588-10" title="10">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1588-11" title="11"><span class="co">  This function removes solvent from loaded trajectory traj_file and topology in top_file to return the new trajctory</span></a>
<a class="sourceLine" id="cb1588-12" title="12"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1588-13" title="13">  traj <span class="op">=</span> md.load(traj_file,top<span class="op">=</span>top_file)</a>
<a class="sourceLine" id="cb1588-14" title="14">  traj.remove_solvent(inplace<span class="op">=</span><span class="va">True</span>)</a>
<a class="sourceLine" id="cb1588-15" title="15">  <span class="cf">return</span> traj</a>
<a class="sourceLine" id="cb1588-16" title="16"></a>
<a class="sourceLine" id="cb1588-17" title="17"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb1588-18" title="18"><span class="im">import</span> mdtraj <span class="im">as</span> md </a>
<a class="sourceLine" id="cb1588-19" title="19"></a>
<a class="sourceLine" id="cb1588-20" title="20">traj <span class="op">=</span> md.load(os.path.join(_FILE_DIR_,<span class="st">&#39;trp-cage-small.trr&#39;</span>), top<span class="op">=</span>os.path.join(_FILE_DIR_,<span class="st">&#39;trp-cage.pdb&#39;</span>))</a>
<a class="sourceLine" id="cb1588-21" title="21">nowater <span class="op">=</span> traj.remove_solvent()</a>
<a class="sourceLine" id="cb1588-22" title="22">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> remove_water(os.path.join(_FILE_DIR_,<span class="st">&#39;trp-cage-small.trr&#39;</span>),os.path.join(_FILE_DIR_,<span class="st">&#39;trp-cage.pdb&#39;</span>)).n_atoms <span class="op">==</span> nowater.n_atoms <span class="cf">else</span> <span class="va">False</span> </a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-144">Run 2</h4>
<div class="sourceCode" id="cb1590"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1590-1" title="1"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb1590-2" title="2"></a>
<a class="sourceLine" id="cb1590-3" title="3"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1590-4" title="4"><span class="co">Print version string</span></a>
<a class="sourceLine" id="cb1590-5" title="5"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1590-6" title="6"><span class="bu">print</span>(md.version.full_version)</a>
<a class="sourceLine" id="cb1590-7" title="7"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1590-8" title="8"></a>
<a class="sourceLine" id="cb1590-9" title="9"><span class="kw">def</span> remove_water(traj_file,top_file):</a>
<a class="sourceLine" id="cb1590-10" title="10">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1590-11" title="11"><span class="co">  This function removes solvent from loaded trajectory traj_file and topology in top_file to return the new trajctory</span></a>
<a class="sourceLine" id="cb1590-12" title="12"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1590-13" title="13">  traj <span class="op">=</span> md.load(traj_file,top<span class="op">=</span>top_file)</a>
<a class="sourceLine" id="cb1590-14" title="14">  traj.remove_solvent()</a>
<a class="sourceLine" id="cb1590-15" title="15">  <span class="cf">return</span> traj</a>
<a class="sourceLine" id="cb1590-16" title="16"></a>
<a class="sourceLine" id="cb1590-17" title="17"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb1590-18" title="18"><span class="im">import</span> mdtraj <span class="im">as</span> md </a>
<a class="sourceLine" id="cb1590-19" title="19"></a>
<a class="sourceLine" id="cb1590-20" title="20">traj <span class="op">=</span> md.load(os.path.join(_FILE_DIR_,<span class="st">&#39;trp-cage-small.trr&#39;</span>), top<span class="op">=</span>os.path.join(_FILE_DIR_,<span class="st">&#39;trp-cage.pdb&#39;</span>))</a>
<a class="sourceLine" id="cb1590-21" title="21">nowater <span class="op">=</span> traj.remove_solvent()</a>
<a class="sourceLine" id="cb1590-22" title="22">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> remove_water(os.path.join(_FILE_DIR_,<span class="st">&#39;trp-cage-small.trr&#39;</span>),os.path.join(_FILE_DIR_,<span class="st">&#39;trp-cage.pdb&#39;</span>)).n_atoms <span class="op">==</span> nowater.n_atoms <span class="cf">else</span> <span class="va">False</span> </a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-144">Run 3</h4>
<div class="sourceCode" id="cb1592"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1592-1" title="1"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb1592-2" title="2"></a>
<a class="sourceLine" id="cb1592-3" title="3"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1592-4" title="4"><span class="co">Print version string</span></a>
<a class="sourceLine" id="cb1592-5" title="5"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1592-6" title="6"><span class="bu">print</span>(md.version.full_version)</a>
<a class="sourceLine" id="cb1592-7" title="7"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1592-8" title="8"></a>
<a class="sourceLine" id="cb1592-9" title="9"><span class="kw">def</span> remove_water(traj_file,top_file):</a>
<a class="sourceLine" id="cb1592-10" title="10">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1592-11" title="11"><span class="co">  This function removes solvent from loaded trajectory traj_file and topology in top_file to return the new trajctory</span></a>
<a class="sourceLine" id="cb1592-12" title="12"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1592-13" title="13">  traj <span class="op">=</span> md.load(traj_file,top<span class="op">=</span>top_file)</a>
<a class="sourceLine" id="cb1592-14" title="14">  traj.remove_solvent(inplace<span class="op">=</span><span class="va">True</span>)</a>
<a class="sourceLine" id="cb1592-15" title="15">  <span class="cf">return</span> traj</a>
<a class="sourceLine" id="cb1592-16" title="16"></a>
<a class="sourceLine" id="cb1592-17" title="17"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb1592-18" title="18"><span class="im">import</span> mdtraj <span class="im">as</span> md </a>
<a class="sourceLine" id="cb1592-19" title="19"></a>
<a class="sourceLine" id="cb1592-20" title="20">traj <span class="op">=</span> md.load(os.path.join(_FILE_DIR_,<span class="st">&#39;trp-cage-small.trr&#39;</span>), top<span class="op">=</span>os.path.join(_FILE_DIR_,<span class="st">&#39;trp-cage.pdb&#39;</span>))</a>
<a class="sourceLine" id="cb1592-21" title="21">nowater <span class="op">=</span> traj.remove_solvent()</a>
<a class="sourceLine" id="cb1592-22" title="22">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> remove_water(os.path.join(_FILE_DIR_,<span class="st">&#39;trp-cage-small.trr&#39;</span>),os.path.join(_FILE_DIR_,<span class="st">&#39;trp-cage.pdb&#39;</span>)).n_atoms <span class="op">==</span> nowater.n_atoms <span class="cf">else</span> <span class="va">False</span> </a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-144">Run 4</h4>
<div class="sourceCode" id="cb1594"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1594-1" title="1"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb1594-2" title="2"></a>
<a class="sourceLine" id="cb1594-3" title="3"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1594-4" title="4"><span class="co">Print version string</span></a>
<a class="sourceLine" id="cb1594-5" title="5"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1594-6" title="6"><span class="bu">print</span>(md.version.full_version)</a>
<a class="sourceLine" id="cb1594-7" title="7"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1594-8" title="8"></a>
<a class="sourceLine" id="cb1594-9" title="9"><span class="kw">def</span> remove_water(traj_file,top_file):</a>
<a class="sourceLine" id="cb1594-10" title="10">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1594-11" title="11"><span class="co">  This function removes solvent from loaded trajectory traj_file and topology in top_file to return the new trajctory</span></a>
<a class="sourceLine" id="cb1594-12" title="12"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1594-13" title="13">  traj <span class="op">=</span> md.load(traj_file,top<span class="op">=</span>top_file)</a>
<a class="sourceLine" id="cb1594-14" title="14">  traj.remove_solvent(inplace<span class="op">=</span><span class="va">True</span>)</a>
<a class="sourceLine" id="cb1594-15" title="15">  <span class="cf">return</span> traj</a>
<a class="sourceLine" id="cb1594-16" title="16"></a>
<a class="sourceLine" id="cb1594-17" title="17"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb1594-18" title="18"><span class="im">import</span> mdtraj <span class="im">as</span> md </a>
<a class="sourceLine" id="cb1594-19" title="19"></a>
<a class="sourceLine" id="cb1594-20" title="20">traj <span class="op">=</span> md.load(os.path.join(_FILE_DIR_,<span class="st">&#39;trp-cage-small.trr&#39;</span>), top<span class="op">=</span>os.path.join(_FILE_DIR_,<span class="st">&#39;trp-cage.pdb&#39;</span>))</a>
<a class="sourceLine" id="cb1594-21" title="21">nowater <span class="op">=</span> traj.remove_solvent()</a>
<a class="sourceLine" id="cb1594-22" title="22">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> remove_water(os.path.join(_FILE_DIR_,<span class="st">&#39;trp-cage-small.trr&#39;</span>),os.path.join(_FILE_DIR_,<span class="st">&#39;trp-cage.pdb&#39;</span>)).n_atoms <span class="op">==</span> nowater.n_atoms <span class="cf">else</span> <span class="va">False</span> </a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>rms_velocity</summary></p>
<h4 id="query-145">Query</h4>
<div class="sourceCode" id="cb1596"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1596-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb1596-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb1596-3" title="3"></a>
<a class="sourceLine" id="cb1596-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1596-5" title="5"><span class="co">compute sin(pi/2)</span></a>
<a class="sourceLine" id="cb1596-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1596-7" title="7">x <span class="op">=</span> math.sin(math.pi <span class="op">/</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1596-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1596-9" title="9"></a>
<a class="sourceLine" id="cb1596-10" title="10"><span class="kw">def</span> rms_velocity(T,m):</a>
<a class="sourceLine" id="cb1596-11" title="11">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1596-12" title="12"><span class="co">   This function returns the root-mean-squared velocity of an ideal gas molecule at temperature T</span></a>
<a class="sourceLine" id="cb1596-13" title="13"><span class="co">   m is mass in g/mol</span></a>
<a class="sourceLine" id="cb1596-14" title="14"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1596-15" title="15">   </a></code></pre></div>
<h4 id="run-0-145">Run 0</h4>
<div class="sourceCode" id="cb1597"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1597-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb1597-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb1597-3" title="3"></a>
<a class="sourceLine" id="cb1597-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1597-5" title="5"><span class="co">compute sin(pi/2)</span></a>
<a class="sourceLine" id="cb1597-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1597-7" title="7">x <span class="op">=</span> math.sin(math.pi <span class="op">/</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1597-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1597-9" title="9"></a>
<a class="sourceLine" id="cb1597-10" title="10"><span class="kw">def</span> rms_velocity(T,m):</a>
<a class="sourceLine" id="cb1597-11" title="11">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1597-12" title="12"><span class="co">   This function returns the root-mean-squared velocity of an ideal gas molecule at temperature T</span></a>
<a class="sourceLine" id="cb1597-13" title="13"><span class="co">   m is mass in g/mol</span></a>
<a class="sourceLine" id="cb1597-14" title="14"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1597-15" title="15">   k <span class="op">=</span> <span class="fl">1.38e-23</span> <span class="co"># m^2 kg s^-2 K^-1</span></a>
<a class="sourceLine" id="cb1597-16" title="16">   <span class="cf">return</span> math.sqrt(<span class="dv">3</span><span class="op">*</span>k<span class="op">*</span>T<span class="op">/</span>m)</a>
<a class="sourceLine" id="cb1597-17" title="17"></a>
<a class="sourceLine" id="cb1597-18" title="18"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1597-19" title="19"></a>
<a class="sourceLine" id="cb1597-20" title="20">m<span class="op">=</span><span class="dv">32</span></a>
<a class="sourceLine" id="cb1597-21" title="21">T<span class="op">=</span><span class="dv">300</span></a>
<a class="sourceLine" id="cb1597-22" title="22">R<span class="op">=</span><span class="fl">8.314</span></a>
<a class="sourceLine" id="cb1597-23" title="23">v_rms <span class="op">=</span> np.sqrt(<span class="dv">3</span><span class="op">*</span>R<span class="op">*</span>T<span class="op">/</span>(m<span class="op">/</span><span class="dv">1000</span>))</a>
<a class="sourceLine" id="cb1597-24" title="24"></a>
<a class="sourceLine" id="cb1597-25" title="25">v_rms_codex <span class="op">=</span> rms_velocity(T,m)</a>
<a class="sourceLine" id="cb1597-26" title="26"></a>
<a class="sourceLine" id="cb1597-27" title="27"><span class="co"># check </span></a>
<a class="sourceLine" id="cb1597-28" title="28"><span class="cf">if</span> np.isclose(v_rms, v_rms_codex, rtol<span class="op">=</span><span class="fl">0.01</span>) <span class="op">==</span> <span class="va">True</span>:</a>
<a class="sourceLine" id="cb1597-29" title="29">    result <span class="op">=</span> <span class="va">True</span> </a>
<a class="sourceLine" id="cb1597-30" title="30"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb1597-31" title="31">    result <span class="op">=</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-145">Run 1</h4>
<div class="sourceCode" id="cb1599"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1599-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb1599-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb1599-3" title="3"></a>
<a class="sourceLine" id="cb1599-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1599-5" title="5"><span class="co">compute sin(pi/2)</span></a>
<a class="sourceLine" id="cb1599-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1599-7" title="7">x <span class="op">=</span> math.sin(math.pi <span class="op">/</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1599-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1599-9" title="9"></a>
<a class="sourceLine" id="cb1599-10" title="10"><span class="kw">def</span> rms_velocity(T,m):</a>
<a class="sourceLine" id="cb1599-11" title="11">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1599-12" title="12"><span class="co">   This function returns the root-mean-squared velocity of an ideal gas molecule at temperature T</span></a>
<a class="sourceLine" id="cb1599-13" title="13"><span class="co">   m is mass in g/mol</span></a>
<a class="sourceLine" id="cb1599-14" title="14"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1599-15" title="15">   k <span class="op">=</span> <span class="fl">1.38e-23</span></a>
<a class="sourceLine" id="cb1599-16" title="16">   <span class="cf">return</span> math.sqrt(<span class="dv">3</span><span class="op">*</span>k<span class="op">*</span>T<span class="op">/</span>m)</a>
<a class="sourceLine" id="cb1599-17" title="17"></a>
<a class="sourceLine" id="cb1599-18" title="18"></a>
<a class="sourceLine" id="cb1599-19" title="19"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1599-20" title="20"></a>
<a class="sourceLine" id="cb1599-21" title="21">m<span class="op">=</span><span class="dv">32</span></a>
<a class="sourceLine" id="cb1599-22" title="22">T<span class="op">=</span><span class="dv">300</span></a>
<a class="sourceLine" id="cb1599-23" title="23">R<span class="op">=</span><span class="fl">8.314</span></a>
<a class="sourceLine" id="cb1599-24" title="24">v_rms <span class="op">=</span> np.sqrt(<span class="dv">3</span><span class="op">*</span>R<span class="op">*</span>T<span class="op">/</span>(m<span class="op">/</span><span class="dv">1000</span>))</a>
<a class="sourceLine" id="cb1599-25" title="25"></a>
<a class="sourceLine" id="cb1599-26" title="26">v_rms_codex <span class="op">=</span> rms_velocity(T,m)</a>
<a class="sourceLine" id="cb1599-27" title="27"></a>
<a class="sourceLine" id="cb1599-28" title="28"><span class="co"># check </span></a>
<a class="sourceLine" id="cb1599-29" title="29"><span class="cf">if</span> np.isclose(v_rms, v_rms_codex, rtol<span class="op">=</span><span class="fl">0.01</span>) <span class="op">==</span> <span class="va">True</span>:</a>
<a class="sourceLine" id="cb1599-30" title="30">    result <span class="op">=</span> <span class="va">True</span> </a>
<a class="sourceLine" id="cb1599-31" title="31"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb1599-32" title="32">    result <span class="op">=</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-145">Run 2</h4>
<div class="sourceCode" id="cb1601"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1601-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb1601-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb1601-3" title="3"></a>
<a class="sourceLine" id="cb1601-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1601-5" title="5"><span class="co">compute sin(pi/2)</span></a>
<a class="sourceLine" id="cb1601-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1601-7" title="7">x <span class="op">=</span> math.sin(math.pi <span class="op">/</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1601-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1601-9" title="9"></a>
<a class="sourceLine" id="cb1601-10" title="10"><span class="kw">def</span> rms_velocity(T,m):</a>
<a class="sourceLine" id="cb1601-11" title="11">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1601-12" title="12"><span class="co">   This function returns the root-mean-squared velocity of an ideal gas molecule at temperature T</span></a>
<a class="sourceLine" id="cb1601-13" title="13"><span class="co">   m is mass in g/mol</span></a>
<a class="sourceLine" id="cb1601-14" title="14"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1601-15" title="15">   k <span class="op">=</span> <span class="fl">1.38064852e-23</span></a>
<a class="sourceLine" id="cb1601-16" title="16">   <span class="cf">return</span> math.sqrt(<span class="dv">3</span><span class="op">*</span>k<span class="op">*</span>T<span class="op">/</span>m)</a>
<a class="sourceLine" id="cb1601-17" title="17"></a>
<a class="sourceLine" id="cb1601-18" title="18"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1601-19" title="19"></a>
<a class="sourceLine" id="cb1601-20" title="20">m<span class="op">=</span><span class="dv">32</span></a>
<a class="sourceLine" id="cb1601-21" title="21">T<span class="op">=</span><span class="dv">300</span></a>
<a class="sourceLine" id="cb1601-22" title="22">R<span class="op">=</span><span class="fl">8.314</span></a>
<a class="sourceLine" id="cb1601-23" title="23">v_rms <span class="op">=</span> np.sqrt(<span class="dv">3</span><span class="op">*</span>R<span class="op">*</span>T<span class="op">/</span>(m<span class="op">/</span><span class="dv">1000</span>))</a>
<a class="sourceLine" id="cb1601-24" title="24"></a>
<a class="sourceLine" id="cb1601-25" title="25">v_rms_codex <span class="op">=</span> rms_velocity(T,m)</a>
<a class="sourceLine" id="cb1601-26" title="26"></a>
<a class="sourceLine" id="cb1601-27" title="27"><span class="co"># check </span></a>
<a class="sourceLine" id="cb1601-28" title="28"><span class="cf">if</span> np.isclose(v_rms, v_rms_codex, rtol<span class="op">=</span><span class="fl">0.01</span>) <span class="op">==</span> <span class="va">True</span>:</a>
<a class="sourceLine" id="cb1601-29" title="29">    result <span class="op">=</span> <span class="va">True</span> </a>
<a class="sourceLine" id="cb1601-30" title="30"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb1601-31" title="31">    result <span class="op">=</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-145">Run 3</h4>
<div class="sourceCode" id="cb1603"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1603-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb1603-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb1603-3" title="3"></a>
<a class="sourceLine" id="cb1603-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1603-5" title="5"><span class="co">compute sin(pi/2)</span></a>
<a class="sourceLine" id="cb1603-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1603-7" title="7">x <span class="op">=</span> math.sin(math.pi <span class="op">/</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1603-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1603-9" title="9"></a>
<a class="sourceLine" id="cb1603-10" title="10"><span class="kw">def</span> rms_velocity(T,m):</a>
<a class="sourceLine" id="cb1603-11" title="11">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1603-12" title="12"><span class="co">   This function returns the root-mean-squared velocity of an ideal gas molecule at temperature T</span></a>
<a class="sourceLine" id="cb1603-13" title="13"><span class="co">   m is mass in g/mol</span></a>
<a class="sourceLine" id="cb1603-14" title="14"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1603-15" title="15">   k <span class="op">=</span> <span class="fl">1.38e-23</span></a>
<a class="sourceLine" id="cb1603-16" title="16">   <span class="cf">return</span> math.sqrt(<span class="dv">3</span><span class="op">*</span>k<span class="op">*</span>T<span class="op">/</span>m)</a>
<a class="sourceLine" id="cb1603-17" title="17"></a>
<a class="sourceLine" id="cb1603-18" title="18"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1603-19" title="19"></a>
<a class="sourceLine" id="cb1603-20" title="20">m<span class="op">=</span><span class="dv">32</span></a>
<a class="sourceLine" id="cb1603-21" title="21">T<span class="op">=</span><span class="dv">300</span></a>
<a class="sourceLine" id="cb1603-22" title="22">R<span class="op">=</span><span class="fl">8.314</span></a>
<a class="sourceLine" id="cb1603-23" title="23">v_rms <span class="op">=</span> np.sqrt(<span class="dv">3</span><span class="op">*</span>R<span class="op">*</span>T<span class="op">/</span>(m<span class="op">/</span><span class="dv">1000</span>))</a>
<a class="sourceLine" id="cb1603-24" title="24"></a>
<a class="sourceLine" id="cb1603-25" title="25">v_rms_codex <span class="op">=</span> rms_velocity(T,m)</a>
<a class="sourceLine" id="cb1603-26" title="26"></a>
<a class="sourceLine" id="cb1603-27" title="27"><span class="co"># check </span></a>
<a class="sourceLine" id="cb1603-28" title="28"><span class="cf">if</span> np.isclose(v_rms, v_rms_codex, rtol<span class="op">=</span><span class="fl">0.01</span>) <span class="op">==</span> <span class="va">True</span>:</a>
<a class="sourceLine" id="cb1603-29" title="29">    result <span class="op">=</span> <span class="va">True</span> </a>
<a class="sourceLine" id="cb1603-30" title="30"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb1603-31" title="31">    result <span class="op">=</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-145">Run 4</h4>
<div class="sourceCode" id="cb1605"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1605-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb1605-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb1605-3" title="3"></a>
<a class="sourceLine" id="cb1605-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1605-5" title="5"><span class="co">compute sin(pi/2)</span></a>
<a class="sourceLine" id="cb1605-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1605-7" title="7">x <span class="op">=</span> math.sin(math.pi <span class="op">/</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1605-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1605-9" title="9"></a>
<a class="sourceLine" id="cb1605-10" title="10"><span class="kw">def</span> rms_velocity(T,m):</a>
<a class="sourceLine" id="cb1605-11" title="11">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1605-12" title="12"><span class="co">   This function returns the root-mean-squared velocity of an ideal gas molecule at temperature T</span></a>
<a class="sourceLine" id="cb1605-13" title="13"><span class="co">   m is mass in g/mol</span></a>
<a class="sourceLine" id="cb1605-14" title="14"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1605-15" title="15">   k <span class="op">=</span> <span class="fl">1.38064852e-23</span> <span class="co"># Boltzmann constant in J/K</span></a>
<a class="sourceLine" id="cb1605-16" title="16">   Na <span class="op">=</span> <span class="fl">6.022140857e23</span> <span class="co"># Avogadro&#39;s number</span></a>
<a class="sourceLine" id="cb1605-17" title="17">   <span class="cf">return</span> math.sqrt(<span class="dv">3</span> <span class="op">*</span> k <span class="op">*</span> T <span class="op">/</span> (m <span class="op">*</span> Na))</a>
<a class="sourceLine" id="cb1605-18" title="18"></a>
<a class="sourceLine" id="cb1605-19" title="19"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1605-20" title="20"></a>
<a class="sourceLine" id="cb1605-21" title="21">m<span class="op">=</span><span class="dv">32</span></a>
<a class="sourceLine" id="cb1605-22" title="22">T<span class="op">=</span><span class="dv">300</span></a>
<a class="sourceLine" id="cb1605-23" title="23">R<span class="op">=</span><span class="fl">8.314</span></a>
<a class="sourceLine" id="cb1605-24" title="24">v_rms <span class="op">=</span> np.sqrt(<span class="dv">3</span><span class="op">*</span>R<span class="op">*</span>T<span class="op">/</span>(m<span class="op">/</span><span class="dv">1000</span>))</a>
<a class="sourceLine" id="cb1605-25" title="25"></a>
<a class="sourceLine" id="cb1605-26" title="26">v_rms_codex <span class="op">=</span> rms_velocity(T,m)</a>
<a class="sourceLine" id="cb1605-27" title="27"></a>
<a class="sourceLine" id="cb1605-28" title="28"><span class="co"># check </span></a>
<a class="sourceLine" id="cb1605-29" title="29"><span class="cf">if</span> np.isclose(v_rms, v_rms_codex, rtol<span class="op">=</span><span class="fl">0.01</span>) <span class="op">==</span> <span class="va">True</span>:</a>
<a class="sourceLine" id="cb1605-30" title="30">    result <span class="op">=</span> <span class="va">True</span> </a>
<a class="sourceLine" id="cb1605-31" title="31"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb1605-32" title="32">    result <span class="op">=</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>rmse</summary></p>
<h4 id="query-146">Query</h4>
<div class="sourceCode" id="cb1607"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1607-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1607-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1607-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1607-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1607-5" title="5"></a>
<a class="sourceLine" id="cb1607-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1607-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1607-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1607-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1607-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1607-11" title="11"></a>
<a class="sourceLine" id="cb1607-12" title="12"><span class="kw">def</span> rmse(a,b):</a>
<a class="sourceLine" id="cb1607-13" title="13">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1607-14" title="14"><span class="co">  This function evaluates the root mean square error (rmse) between a and b.</span></a>
<a class="sourceLine" id="cb1607-15" title="15"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1607-16" title="16">  </a></code></pre></div>
<h4 id="run-0-146">Run 0</h4>
<div class="sourceCode" id="cb1608"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1608-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1608-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1608-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1608-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1608-5" title="5"></a>
<a class="sourceLine" id="cb1608-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1608-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1608-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1608-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1608-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1608-11" title="11"></a>
<a class="sourceLine" id="cb1608-12" title="12"><span class="kw">def</span> rmse(a,b):</a>
<a class="sourceLine" id="cb1608-13" title="13">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1608-14" title="14"><span class="co">  This function evaluates the root mean square error (rmse) between a and b.</span></a>
<a class="sourceLine" id="cb1608-15" title="15"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1608-16" title="16">  <span class="cf">return</span> np.sqrt(np.mean((a<span class="op">-</span>b)<span class="op">**</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb1608-17" title="17"></a>
<a class="sourceLine" id="cb1608-18" title="18"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1608-19" title="19"></a>
<a class="sourceLine" id="cb1608-20" title="20">np.random.seed(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb1608-21" title="21">M <span class="op">=</span> <span class="dv">100</span></a>
<a class="sourceLine" id="cb1608-22" title="22">predictions <span class="op">=</span> np.random.normal(loc<span class="op">=</span><span class="dv">10</span>, scale<span class="op">=</span><span class="dv">3</span>, size<span class="op">=</span>(M,))</a>
<a class="sourceLine" id="cb1608-23" title="23">targets <span class="op">=</span> np.random.normal(loc<span class="op">=</span><span class="dv">9</span>, scale<span class="op">=</span><span class="dv">2</span>, size<span class="op">=</span>(M,))</a>
<a class="sourceLine" id="cb1608-24" title="24"></a>
<a class="sourceLine" id="cb1608-25" title="25">test_rmse <span class="op">=</span> np.sqrt(((predictions <span class="op">-</span> targets) <span class="op">**</span> <span class="dv">2</span>).mean())</a>
<a class="sourceLine" id="cb1608-26" title="26">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(rmse(predictions, targets), test_rmse) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-146">Run 1</h4>
<div class="sourceCode" id="cb1610"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1610-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1610-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1610-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1610-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1610-5" title="5"></a>
<a class="sourceLine" id="cb1610-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1610-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1610-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1610-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1610-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1610-11" title="11"></a>
<a class="sourceLine" id="cb1610-12" title="12"><span class="kw">def</span> rmse(a,b):</a>
<a class="sourceLine" id="cb1610-13" title="13">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1610-14" title="14"><span class="co">  This function evaluates the root mean square error (rmse) between a and b.</span></a>
<a class="sourceLine" id="cb1610-15" title="15"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1610-16" title="16">  <span class="cf">return</span> np.sqrt(np.mean(np.square(a<span class="op">-</span>b)))</a>
<a class="sourceLine" id="cb1610-17" title="17"></a>
<a class="sourceLine" id="cb1610-18" title="18"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1610-19" title="19"></a>
<a class="sourceLine" id="cb1610-20" title="20">np.random.seed(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb1610-21" title="21">M <span class="op">=</span> <span class="dv">100</span></a>
<a class="sourceLine" id="cb1610-22" title="22">predictions <span class="op">=</span> np.random.normal(loc<span class="op">=</span><span class="dv">10</span>, scale<span class="op">=</span><span class="dv">3</span>, size<span class="op">=</span>(M,))</a>
<a class="sourceLine" id="cb1610-23" title="23">targets <span class="op">=</span> np.random.normal(loc<span class="op">=</span><span class="dv">9</span>, scale<span class="op">=</span><span class="dv">2</span>, size<span class="op">=</span>(M,))</a>
<a class="sourceLine" id="cb1610-24" title="24"></a>
<a class="sourceLine" id="cb1610-25" title="25">test_rmse <span class="op">=</span> np.sqrt(((predictions <span class="op">-</span> targets) <span class="op">**</span> <span class="dv">2</span>).mean())</a>
<a class="sourceLine" id="cb1610-26" title="26">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(rmse(predictions, targets), test_rmse) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-146">Run 2</h4>
<div class="sourceCode" id="cb1612"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1612-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1612-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1612-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1612-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1612-5" title="5"></a>
<a class="sourceLine" id="cb1612-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1612-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1612-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1612-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1612-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1612-11" title="11"></a>
<a class="sourceLine" id="cb1612-12" title="12"><span class="kw">def</span> rmse(a,b):</a>
<a class="sourceLine" id="cb1612-13" title="13">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1612-14" title="14"><span class="co">  This function evaluates the root mean square error (rmse) between a and b.</span></a>
<a class="sourceLine" id="cb1612-15" title="15"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1612-16" title="16">  <span class="cf">return</span> np.sqrt(np.mean((a<span class="op">-</span>b)<span class="op">**</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb1612-17" title="17"></a>
<a class="sourceLine" id="cb1612-18" title="18"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1612-19" title="19"></a>
<a class="sourceLine" id="cb1612-20" title="20">np.random.seed(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb1612-21" title="21">M <span class="op">=</span> <span class="dv">100</span></a>
<a class="sourceLine" id="cb1612-22" title="22">predictions <span class="op">=</span> np.random.normal(loc<span class="op">=</span><span class="dv">10</span>, scale<span class="op">=</span><span class="dv">3</span>, size<span class="op">=</span>(M,))</a>
<a class="sourceLine" id="cb1612-23" title="23">targets <span class="op">=</span> np.random.normal(loc<span class="op">=</span><span class="dv">9</span>, scale<span class="op">=</span><span class="dv">2</span>, size<span class="op">=</span>(M,))</a>
<a class="sourceLine" id="cb1612-24" title="24"></a>
<a class="sourceLine" id="cb1612-25" title="25">test_rmse <span class="op">=</span> np.sqrt(((predictions <span class="op">-</span> targets) <span class="op">**</span> <span class="dv">2</span>).mean())</a>
<a class="sourceLine" id="cb1612-26" title="26">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(rmse(predictions, targets), test_rmse) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-146">Run 3</h4>
<div class="sourceCode" id="cb1614"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1614-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1614-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1614-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1614-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1614-5" title="5"></a>
<a class="sourceLine" id="cb1614-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1614-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1614-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1614-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1614-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1614-11" title="11"></a>
<a class="sourceLine" id="cb1614-12" title="12"><span class="kw">def</span> rmse(a,b):</a>
<a class="sourceLine" id="cb1614-13" title="13">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1614-14" title="14"><span class="co">  This function evaluates the root mean square error (rmse) between a and b.</span></a>
<a class="sourceLine" id="cb1614-15" title="15"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1614-16" title="16">  <span class="cf">return</span> np.sqrt(np.mean((a<span class="op">-</span>b)<span class="op">**</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb1614-17" title="17"></a>
<a class="sourceLine" id="cb1614-18" title="18"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1614-19" title="19"></a>
<a class="sourceLine" id="cb1614-20" title="20">np.random.seed(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb1614-21" title="21">M <span class="op">=</span> <span class="dv">100</span></a>
<a class="sourceLine" id="cb1614-22" title="22">predictions <span class="op">=</span> np.random.normal(loc<span class="op">=</span><span class="dv">10</span>, scale<span class="op">=</span><span class="dv">3</span>, size<span class="op">=</span>(M,))</a>
<a class="sourceLine" id="cb1614-23" title="23">targets <span class="op">=</span> np.random.normal(loc<span class="op">=</span><span class="dv">9</span>, scale<span class="op">=</span><span class="dv">2</span>, size<span class="op">=</span>(M,))</a>
<a class="sourceLine" id="cb1614-24" title="24"></a>
<a class="sourceLine" id="cb1614-25" title="25">test_rmse <span class="op">=</span> np.sqrt(((predictions <span class="op">-</span> targets) <span class="op">**</span> <span class="dv">2</span>).mean())</a>
<a class="sourceLine" id="cb1614-26" title="26">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(rmse(predictions, targets), test_rmse) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-146">Run 4</h4>
<div class="sourceCode" id="cb1616"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1616-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1616-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1616-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1616-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1616-5" title="5"></a>
<a class="sourceLine" id="cb1616-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1616-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1616-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1616-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1616-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1616-11" title="11"></a>
<a class="sourceLine" id="cb1616-12" title="12"><span class="kw">def</span> rmse(a,b):</a>
<a class="sourceLine" id="cb1616-13" title="13">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1616-14" title="14"><span class="co">  This function evaluates the root mean square error (rmse) between a and b.</span></a>
<a class="sourceLine" id="cb1616-15" title="15"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1616-16" title="16">  <span class="cf">return</span> np.sqrt(np.mean((a<span class="op">-</span>b)<span class="op">**</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb1616-17" title="17"></a>
<a class="sourceLine" id="cb1616-18" title="18"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1616-19" title="19"></a>
<a class="sourceLine" id="cb1616-20" title="20">np.random.seed(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb1616-21" title="21">M <span class="op">=</span> <span class="dv">100</span></a>
<a class="sourceLine" id="cb1616-22" title="22">predictions <span class="op">=</span> np.random.normal(loc<span class="op">=</span><span class="dv">10</span>, scale<span class="op">=</span><span class="dv">3</span>, size<span class="op">=</span>(M,))</a>
<a class="sourceLine" id="cb1616-23" title="23">targets <span class="op">=</span> np.random.normal(loc<span class="op">=</span><span class="dv">9</span>, scale<span class="op">=</span><span class="dv">2</span>, size<span class="op">=</span>(M,))</a>
<a class="sourceLine" id="cb1616-24" title="24"></a>
<a class="sourceLine" id="cb1616-25" title="25">test_rmse <span class="op">=</span> np.sqrt(((predictions <span class="op">-</span> targets) <span class="op">**</span> <span class="dv">2</span>).mean())</a>
<a class="sourceLine" id="cb1616-26" title="26">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(rmse(predictions, targets), test_rmse) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>rog</summary></p>
<h4 id="query-147">Query</h4>
<div class="sourceCode" id="cb1618"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1618-1" title="1"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb1618-2" title="2"></a>
<a class="sourceLine" id="cb1618-3" title="3"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1618-4" title="4"><span class="co">Print version string</span></a>
<a class="sourceLine" id="cb1618-5" title="5"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1618-6" title="6"><span class="bu">print</span>(md.version.full_version)</a>
<a class="sourceLine" id="cb1618-7" title="7"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1618-8" title="8"></a>
<a class="sourceLine" id="cb1618-9" title="9"><span class="kw">def</span> protein_radius_of_gyration(pdb_file):</a>
<a class="sourceLine" id="cb1618-10" title="10">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1618-11" title="11"><span class="co">  1. This function loads a pdb</span></a>
<a class="sourceLine" id="cb1618-12" title="12"><span class="co">  2. Calculates the radius of gyration</span></a>
<a class="sourceLine" id="cb1618-13" title="13"><span class="co">  3. Returns it</span></a>
<a class="sourceLine" id="cb1618-14" title="14"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1618-15" title="15">  </a></code></pre></div>
<h4 id="run-0-147">Run 0</h4>
<div class="sourceCode" id="cb1619"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1619-1" title="1"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb1619-2" title="2"></a>
<a class="sourceLine" id="cb1619-3" title="3"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1619-4" title="4"><span class="co">Print version string</span></a>
<a class="sourceLine" id="cb1619-5" title="5"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1619-6" title="6"><span class="bu">print</span>(md.version.full_version)</a>
<a class="sourceLine" id="cb1619-7" title="7"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1619-8" title="8"></a>
<a class="sourceLine" id="cb1619-9" title="9"><span class="kw">def</span> protein_radius_of_gyration(pdb_file):</a>
<a class="sourceLine" id="cb1619-10" title="10">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1619-11" title="11"><span class="co">  1. This function loads a pdb</span></a>
<a class="sourceLine" id="cb1619-12" title="12"><span class="co">  2. Calculates the radius of gyration</span></a>
<a class="sourceLine" id="cb1619-13" title="13"><span class="co">  3. Returns it</span></a>
<a class="sourceLine" id="cb1619-14" title="14"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1619-15" title="15">  <span class="co"># Load the pdb file</span></a>
<a class="sourceLine" id="cb1619-16" title="16">  traj <span class="op">=</span> md.load(pdb_file)</a>
<a class="sourceLine" id="cb1619-17" title="17">  <span class="co"># Calculate the radius of gyration</span></a>
<a class="sourceLine" id="cb1619-18" title="18">  radius_of_gyration <span class="op">=</span> md.compute_rg(traj)</a>
<a class="sourceLine" id="cb1619-19" title="19">  <span class="co"># Return the radius of gyration</span></a>
<a class="sourceLine" id="cb1619-20" title="20">  <span class="cf">return</span> radius_of_gyration</a>
<a class="sourceLine" id="cb1619-21" title="21"></a>
<a class="sourceLine" id="cb1619-22" title="22"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1619-23" title="23"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb1619-24" title="24"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb1619-25" title="25"></a>
<a class="sourceLine" id="cb1619-26" title="26">pdb_file <span class="op">=</span> os.path.join(_FILE_DIR_,<span class="st">&quot;1VII.pdb&quot;</span>)</a>
<a class="sourceLine" id="cb1619-27" title="27"></a>
<a class="sourceLine" id="cb1619-28" title="28"><span class="kw">def</span> compute_rg_mdtraj(pdb_file):</a>
<a class="sourceLine" id="cb1619-29" title="29">    <span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb1619-30" title="30">    pdb <span class="op">=</span> md.load(pdb_file)</a>
<a class="sourceLine" id="cb1619-31" title="31">    rg <span class="op">=</span> md.compute_rg(pdb)</a>
<a class="sourceLine" id="cb1619-32" title="32">    <span class="cf">return</span> rg</a>
<a class="sourceLine" id="cb1619-33" title="33"></a>
<a class="sourceLine" id="cb1619-34" title="34">my_rg <span class="op">=</span> compute_rg_mdtraj(pdb_file)</a>
<a class="sourceLine" id="cb1619-35" title="35">nlcc_rg <span class="op">=</span> protein_radius_of_gyration(pdb_file)</a>
<a class="sourceLine" id="cb1619-36" title="36"></a>
<a class="sourceLine" id="cb1619-37" title="37"><span class="co">#print(&quot;My result:&quot;, my_rg)</span></a>
<a class="sourceLine" id="cb1619-38" title="38"><span class="co">#print(&quot;nlcc result&quot;, nlcc_rg)</span></a>
<a class="sourceLine" id="cb1619-39" title="39"></a>
<a class="sourceLine" id="cb1619-40" title="40">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">abs</span>( my_rg <span class="op">-</span> nlcc_rg )<span class="op">&lt;</span><span class="fl">0.1</span> <span class="cf">else</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb1619-41" title="41"></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-147">Run 1</h4>
<div class="sourceCode" id="cb1621"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1621-1" title="1"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb1621-2" title="2"></a>
<a class="sourceLine" id="cb1621-3" title="3"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1621-4" title="4"><span class="co">Print version string</span></a>
<a class="sourceLine" id="cb1621-5" title="5"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1621-6" title="6"><span class="bu">print</span>(md.version.full_version)</a>
<a class="sourceLine" id="cb1621-7" title="7"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1621-8" title="8"></a>
<a class="sourceLine" id="cb1621-9" title="9"><span class="kw">def</span> protein_radius_of_gyration(pdb_file):</a>
<a class="sourceLine" id="cb1621-10" title="10">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1621-11" title="11"><span class="co">  1. This function loads a pdb</span></a>
<a class="sourceLine" id="cb1621-12" title="12"><span class="co">  2. Calculates the radius of gyration</span></a>
<a class="sourceLine" id="cb1621-13" title="13"><span class="co">  3. Returns it</span></a>
<a class="sourceLine" id="cb1621-14" title="14"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1621-15" title="15">  <span class="co"># Load the pdb file</span></a>
<a class="sourceLine" id="cb1621-16" title="16">  traj <span class="op">=</span> md.load(pdb_file)</a>
<a class="sourceLine" id="cb1621-17" title="17">  <span class="co"># Calculate the radius of gyration</span></a>
<a class="sourceLine" id="cb1621-18" title="18">  radius_of_gyration <span class="op">=</span> md.compute_rg(traj)</a>
<a class="sourceLine" id="cb1621-19" title="19">  <span class="co"># Return the radius of gyration</span></a>
<a class="sourceLine" id="cb1621-20" title="20">  <span class="cf">return</span> radius_of_gyration</a>
<a class="sourceLine" id="cb1621-21" title="21"></a>
<a class="sourceLine" id="cb1621-22" title="22"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1621-23" title="23"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb1621-24" title="24"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb1621-25" title="25"></a>
<a class="sourceLine" id="cb1621-26" title="26">pdb_file <span class="op">=</span> os.path.join(_FILE_DIR_,<span class="st">&quot;1VII.pdb&quot;</span>)</a>
<a class="sourceLine" id="cb1621-27" title="27"></a>
<a class="sourceLine" id="cb1621-28" title="28"><span class="kw">def</span> compute_rg_mdtraj(pdb_file):</a>
<a class="sourceLine" id="cb1621-29" title="29">    <span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb1621-30" title="30">    pdb <span class="op">=</span> md.load(pdb_file)</a>
<a class="sourceLine" id="cb1621-31" title="31">    rg <span class="op">=</span> md.compute_rg(pdb)</a>
<a class="sourceLine" id="cb1621-32" title="32">    <span class="cf">return</span> rg</a>
<a class="sourceLine" id="cb1621-33" title="33"></a>
<a class="sourceLine" id="cb1621-34" title="34">my_rg <span class="op">=</span> compute_rg_mdtraj(pdb_file)</a>
<a class="sourceLine" id="cb1621-35" title="35">nlcc_rg <span class="op">=</span> protein_radius_of_gyration(pdb_file)</a>
<a class="sourceLine" id="cb1621-36" title="36"></a>
<a class="sourceLine" id="cb1621-37" title="37"><span class="co">#print(&quot;My result:&quot;, my_rg)</span></a>
<a class="sourceLine" id="cb1621-38" title="38"><span class="co">#print(&quot;nlcc result&quot;, nlcc_rg)</span></a>
<a class="sourceLine" id="cb1621-39" title="39"></a>
<a class="sourceLine" id="cb1621-40" title="40">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">abs</span>( my_rg <span class="op">-</span> nlcc_rg )<span class="op">&lt;</span><span class="fl">0.1</span> <span class="cf">else</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb1621-41" title="41"></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-147">Run 2</h4>
<div class="sourceCode" id="cb1623"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1623-1" title="1"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb1623-2" title="2"></a>
<a class="sourceLine" id="cb1623-3" title="3"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1623-4" title="4"><span class="co">Print version string</span></a>
<a class="sourceLine" id="cb1623-5" title="5"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1623-6" title="6"><span class="bu">print</span>(md.version.full_version)</a>
<a class="sourceLine" id="cb1623-7" title="7"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1623-8" title="8"></a>
<a class="sourceLine" id="cb1623-9" title="9"><span class="kw">def</span> protein_radius_of_gyration(pdb_file):</a>
<a class="sourceLine" id="cb1623-10" title="10">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1623-11" title="11"><span class="co">  1. This function loads a pdb</span></a>
<a class="sourceLine" id="cb1623-12" title="12"><span class="co">  2. Calculates the radius of gyration</span></a>
<a class="sourceLine" id="cb1623-13" title="13"><span class="co">  3. Returns it</span></a>
<a class="sourceLine" id="cb1623-14" title="14"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1623-15" title="15">  <span class="co"># Load the pdb file</span></a>
<a class="sourceLine" id="cb1623-16" title="16">  traj <span class="op">=</span> md.load(pdb_file)</a>
<a class="sourceLine" id="cb1623-17" title="17">  <span class="co"># Calculate the radius of gyration</span></a>
<a class="sourceLine" id="cb1623-18" title="18">  radius_of_gyration <span class="op">=</span> md.compute_rg(traj)</a>
<a class="sourceLine" id="cb1623-19" title="19">  <span class="co"># Return the radius of gyration</span></a>
<a class="sourceLine" id="cb1623-20" title="20">  <span class="cf">return</span> radius_of_gyration</a>
<a class="sourceLine" id="cb1623-21" title="21"></a>
<a class="sourceLine" id="cb1623-22" title="22"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1623-23" title="23"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb1623-24" title="24"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb1623-25" title="25"></a>
<a class="sourceLine" id="cb1623-26" title="26">pdb_file <span class="op">=</span> os.path.join(_FILE_DIR_,<span class="st">&quot;1VII.pdb&quot;</span>)</a>
<a class="sourceLine" id="cb1623-27" title="27"></a>
<a class="sourceLine" id="cb1623-28" title="28"><span class="kw">def</span> compute_rg_mdtraj(pdb_file):</a>
<a class="sourceLine" id="cb1623-29" title="29">    <span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb1623-30" title="30">    pdb <span class="op">=</span> md.load(pdb_file)</a>
<a class="sourceLine" id="cb1623-31" title="31">    rg <span class="op">=</span> md.compute_rg(pdb)</a>
<a class="sourceLine" id="cb1623-32" title="32">    <span class="cf">return</span> rg</a>
<a class="sourceLine" id="cb1623-33" title="33"></a>
<a class="sourceLine" id="cb1623-34" title="34">my_rg <span class="op">=</span> compute_rg_mdtraj(pdb_file)</a>
<a class="sourceLine" id="cb1623-35" title="35">nlcc_rg <span class="op">=</span> protein_radius_of_gyration(pdb_file)</a>
<a class="sourceLine" id="cb1623-36" title="36"></a>
<a class="sourceLine" id="cb1623-37" title="37"><span class="co">#print(&quot;My result:&quot;, my_rg)</span></a>
<a class="sourceLine" id="cb1623-38" title="38"><span class="co">#print(&quot;nlcc result&quot;, nlcc_rg)</span></a>
<a class="sourceLine" id="cb1623-39" title="39"></a>
<a class="sourceLine" id="cb1623-40" title="40">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">abs</span>( my_rg <span class="op">-</span> nlcc_rg )<span class="op">&lt;</span><span class="fl">0.1</span> <span class="cf">else</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb1623-41" title="41"></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-147">Run 3</h4>
<div class="sourceCode" id="cb1625"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1625-1" title="1"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb1625-2" title="2"></a>
<a class="sourceLine" id="cb1625-3" title="3"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1625-4" title="4"><span class="co">Print version string</span></a>
<a class="sourceLine" id="cb1625-5" title="5"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1625-6" title="6"><span class="bu">print</span>(md.version.full_version)</a>
<a class="sourceLine" id="cb1625-7" title="7"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1625-8" title="8"></a>
<a class="sourceLine" id="cb1625-9" title="9"><span class="kw">def</span> protein_radius_of_gyration(pdb_file):</a>
<a class="sourceLine" id="cb1625-10" title="10">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1625-11" title="11"><span class="co">  1. This function loads a pdb</span></a>
<a class="sourceLine" id="cb1625-12" title="12"><span class="co">  2. Calculates the radius of gyration</span></a>
<a class="sourceLine" id="cb1625-13" title="13"><span class="co">  3. Returns it</span></a>
<a class="sourceLine" id="cb1625-14" title="14"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1625-15" title="15">  <span class="co"># Load the pdb file</span></a>
<a class="sourceLine" id="cb1625-16" title="16">  traj <span class="op">=</span> md.load(pdb_file)</a>
<a class="sourceLine" id="cb1625-17" title="17">  <span class="co"># Calculate the radius of gyration</span></a>
<a class="sourceLine" id="cb1625-18" title="18">  rgyr <span class="op">=</span> md.compute_rg(traj)</a>
<a class="sourceLine" id="cb1625-19" title="19">  <span class="co"># Return it</span></a>
<a class="sourceLine" id="cb1625-20" title="20">  <span class="cf">return</span> rgyr</a>
<a class="sourceLine" id="cb1625-21" title="21"></a>
<a class="sourceLine" id="cb1625-22" title="22"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1625-23" title="23"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb1625-24" title="24"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb1625-25" title="25"></a>
<a class="sourceLine" id="cb1625-26" title="26">pdb_file <span class="op">=</span> os.path.join(_FILE_DIR_,<span class="st">&quot;1VII.pdb&quot;</span>)</a>
<a class="sourceLine" id="cb1625-27" title="27"></a>
<a class="sourceLine" id="cb1625-28" title="28"><span class="kw">def</span> compute_rg_mdtraj(pdb_file):</a>
<a class="sourceLine" id="cb1625-29" title="29">    <span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb1625-30" title="30">    pdb <span class="op">=</span> md.load(pdb_file)</a>
<a class="sourceLine" id="cb1625-31" title="31">    rg <span class="op">=</span> md.compute_rg(pdb)</a>
<a class="sourceLine" id="cb1625-32" title="32">    <span class="cf">return</span> rg</a>
<a class="sourceLine" id="cb1625-33" title="33"></a>
<a class="sourceLine" id="cb1625-34" title="34">my_rg <span class="op">=</span> compute_rg_mdtraj(pdb_file)</a>
<a class="sourceLine" id="cb1625-35" title="35">nlcc_rg <span class="op">=</span> protein_radius_of_gyration(pdb_file)</a>
<a class="sourceLine" id="cb1625-36" title="36"></a>
<a class="sourceLine" id="cb1625-37" title="37"><span class="co">#print(&quot;My result:&quot;, my_rg)</span></a>
<a class="sourceLine" id="cb1625-38" title="38"><span class="co">#print(&quot;nlcc result&quot;, nlcc_rg)</span></a>
<a class="sourceLine" id="cb1625-39" title="39"></a>
<a class="sourceLine" id="cb1625-40" title="40">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">abs</span>( my_rg <span class="op">-</span> nlcc_rg )<span class="op">&lt;</span><span class="fl">0.1</span> <span class="cf">else</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb1625-41" title="41"></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-147">Run 4</h4>
<div class="sourceCode" id="cb1627"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1627-1" title="1"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb1627-2" title="2"></a>
<a class="sourceLine" id="cb1627-3" title="3"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1627-4" title="4"><span class="co">Print version string</span></a>
<a class="sourceLine" id="cb1627-5" title="5"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1627-6" title="6"><span class="bu">print</span>(md.version.full_version)</a>
<a class="sourceLine" id="cb1627-7" title="7"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1627-8" title="8"></a>
<a class="sourceLine" id="cb1627-9" title="9"><span class="kw">def</span> protein_radius_of_gyration(pdb_file):</a>
<a class="sourceLine" id="cb1627-10" title="10">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1627-11" title="11"><span class="co">  1. This function loads a pdb</span></a>
<a class="sourceLine" id="cb1627-12" title="12"><span class="co">  2. Calculates the radius of gyration</span></a>
<a class="sourceLine" id="cb1627-13" title="13"><span class="co">  3. Returns it</span></a>
<a class="sourceLine" id="cb1627-14" title="14"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1627-15" title="15">  <span class="co"># Load pdb</span></a>
<a class="sourceLine" id="cb1627-16" title="16">  traj <span class="op">=</span> md.load(pdb_file)</a>
<a class="sourceLine" id="cb1627-17" title="17">  <span class="co"># Calculate radius of gyration</span></a>
<a class="sourceLine" id="cb1627-18" title="18">  radius_of_gyration <span class="op">=</span> md.compute_rg(traj)</a>
<a class="sourceLine" id="cb1627-19" title="19">  <span class="co"># Return radius of gyration</span></a>
<a class="sourceLine" id="cb1627-20" title="20">  <span class="cf">return</span> radius_of_gyration</a>
<a class="sourceLine" id="cb1627-21" title="21"></a>
<a class="sourceLine" id="cb1627-22" title="22"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1627-23" title="23"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb1627-24" title="24"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb1627-25" title="25"></a>
<a class="sourceLine" id="cb1627-26" title="26">pdb_file <span class="op">=</span> os.path.join(_FILE_DIR_,<span class="st">&quot;1VII.pdb&quot;</span>)</a>
<a class="sourceLine" id="cb1627-27" title="27"></a>
<a class="sourceLine" id="cb1627-28" title="28"><span class="kw">def</span> compute_rg_mdtraj(pdb_file):</a>
<a class="sourceLine" id="cb1627-29" title="29">    <span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb1627-30" title="30">    pdb <span class="op">=</span> md.load(pdb_file)</a>
<a class="sourceLine" id="cb1627-31" title="31">    rg <span class="op">=</span> md.compute_rg(pdb)</a>
<a class="sourceLine" id="cb1627-32" title="32">    <span class="cf">return</span> rg</a>
<a class="sourceLine" id="cb1627-33" title="33"></a>
<a class="sourceLine" id="cb1627-34" title="34">my_rg <span class="op">=</span> compute_rg_mdtraj(pdb_file)</a>
<a class="sourceLine" id="cb1627-35" title="35">nlcc_rg <span class="op">=</span> protein_radius_of_gyration(pdb_file)</a>
<a class="sourceLine" id="cb1627-36" title="36"></a>
<a class="sourceLine" id="cb1627-37" title="37"><span class="co">#print(&quot;My result:&quot;, my_rg)</span></a>
<a class="sourceLine" id="cb1627-38" title="38"><span class="co">#print(&quot;nlcc result&quot;, nlcc_rg)</span></a>
<a class="sourceLine" id="cb1627-39" title="39"></a>
<a class="sourceLine" id="cb1627-40" title="40">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">abs</span>( my_rg <span class="op">-</span> nlcc_rg )<span class="op">&lt;</span><span class="fl">0.1</span> <span class="cf">else</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb1627-41" title="41"></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>sasa</summary></p>
<h4 id="query-148">Query</h4>
<div class="sourceCode" id="cb1629"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1629-1" title="1"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb1629-2" title="2"></a>
<a class="sourceLine" id="cb1629-3" title="3"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1629-4" title="4"><span class="co">Print version string</span></a>
<a class="sourceLine" id="cb1629-5" title="5"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1629-6" title="6"><span class="bu">print</span>(md.version.full_version)</a>
<a class="sourceLine" id="cb1629-7" title="7"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1629-8" title="8"></a>
<a class="sourceLine" id="cb1629-9" title="9"><span class="kw">def</span> protein_surface_area(pdb_file):</a>
<a class="sourceLine" id="cb1629-10" title="10">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1629-11" title="11"><span class="co">  1. This function loads a pdb</span></a>
<a class="sourceLine" id="cb1629-12" title="12"><span class="co">  2. Calculates the Solvent Accessible Surface Area (sasa) per residue</span></a>
<a class="sourceLine" id="cb1629-13" title="13"><span class="co">  3. Returns it</span></a>
<a class="sourceLine" id="cb1629-14" title="14"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1629-15" title="15">  </a></code></pre></div>
<h4 id="run-0-148">Run 0</h4>
<div class="sourceCode" id="cb1630"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1630-1" title="1"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb1630-2" title="2"></a>
<a class="sourceLine" id="cb1630-3" title="3"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1630-4" title="4"><span class="co">Print version string</span></a>
<a class="sourceLine" id="cb1630-5" title="5"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1630-6" title="6"><span class="bu">print</span>(md.version.full_version)</a>
<a class="sourceLine" id="cb1630-7" title="7"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1630-8" title="8"></a>
<a class="sourceLine" id="cb1630-9" title="9"><span class="kw">def</span> protein_surface_area(pdb_file):</a>
<a class="sourceLine" id="cb1630-10" title="10">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1630-11" title="11"><span class="co">  1. This function loads a pdb</span></a>
<a class="sourceLine" id="cb1630-12" title="12"><span class="co">  2. Calculates the Solvent Accessible Surface Area (sasa) per residue</span></a>
<a class="sourceLine" id="cb1630-13" title="13"><span class="co">  3. Returns it</span></a>
<a class="sourceLine" id="cb1630-14" title="14"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1630-15" title="15">  <span class="co"># Load the pdb</span></a>
<a class="sourceLine" id="cb1630-16" title="16">  traj <span class="op">=</span> md.load(pdb_file)</a>
<a class="sourceLine" id="cb1630-17" title="17">  <span class="co"># Calculate the sasa</span></a>
<a class="sourceLine" id="cb1630-18" title="18">  sasa <span class="op">=</span> md.shrake_rupley(traj)</a>
<a class="sourceLine" id="cb1630-19" title="19">  <span class="co"># Return the sasa</span></a>
<a class="sourceLine" id="cb1630-20" title="20">  <span class="cf">return</span> sasa</a>
<a class="sourceLine" id="cb1630-21" title="21"></a>
<a class="sourceLine" id="cb1630-22" title="22"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1630-23" title="23"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb1630-24" title="24"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb1630-25" title="25"></a>
<a class="sourceLine" id="cb1630-26" title="26">pdb_file <span class="op">=</span> os.path.join(_FILE_DIR_,<span class="st">&quot;1VII.pdb&quot;</span>)</a>
<a class="sourceLine" id="cb1630-27" title="27"></a>
<a class="sourceLine" id="cb1630-28" title="28"><span class="kw">def</span> compute_sasa_mdtraj(pdb_file):</a>
<a class="sourceLine" id="cb1630-29" title="29">    <span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb1630-30" title="30">    pdb <span class="op">=</span> md.load(pdb_file)</a>
<a class="sourceLine" id="cb1630-31" title="31">    </a>
<a class="sourceLine" id="cb1630-32" title="32">    sasa <span class="op">=</span> md.shrake_rupley(pdb,mode<span class="op">=</span><span class="st">&#39;residue&#39;</span>)</a>
<a class="sourceLine" id="cb1630-33" title="33">    <span class="cf">return</span> sasa</a>
<a class="sourceLine" id="cb1630-34" title="34"></a>
<a class="sourceLine" id="cb1630-35" title="35">my_sasa <span class="op">=</span> compute_sasa_mdtraj(pdb_file)</a>
<a class="sourceLine" id="cb1630-36" title="36">nlcc_sasa <span class="op">=</span> protein_surface_area(pdb_file)</a>
<a class="sourceLine" id="cb1630-37" title="37"></a>
<a class="sourceLine" id="cb1630-38" title="38"><span class="co">#print(&quot;My result:&quot;, my_sasa)</span></a>
<a class="sourceLine" id="cb1630-39" title="39"><span class="co">#print(&quot;nlcc result&quot;, nlcc_sasa)</span></a>
<a class="sourceLine" id="cb1630-40" title="40"></a>
<a class="sourceLine" id="cb1630-41" title="41">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">abs</span>( my_sasa.mean() <span class="op">-</span> nlcc_sasa.mean() )<span class="op">&lt;</span><span class="fl">0.1</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-148">Run 1</h4>
<div class="sourceCode" id="cb1632"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1632-1" title="1"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb1632-2" title="2"></a>
<a class="sourceLine" id="cb1632-3" title="3"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1632-4" title="4"><span class="co">Print version string</span></a>
<a class="sourceLine" id="cb1632-5" title="5"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1632-6" title="6"><span class="bu">print</span>(md.version.full_version)</a>
<a class="sourceLine" id="cb1632-7" title="7"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1632-8" title="8"></a>
<a class="sourceLine" id="cb1632-9" title="9"><span class="kw">def</span> protein_surface_area(pdb_file):</a>
<a class="sourceLine" id="cb1632-10" title="10">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1632-11" title="11"><span class="co">  1. This function loads a pdb</span></a>
<a class="sourceLine" id="cb1632-12" title="12"><span class="co">  2. Calculates the Solvent Accessible Surface Area (sasa) per residue</span></a>
<a class="sourceLine" id="cb1632-13" title="13"><span class="co">  3. Returns it</span></a>
<a class="sourceLine" id="cb1632-14" title="14"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1632-15" title="15">  <span class="co"># Load the pdb file</span></a>
<a class="sourceLine" id="cb1632-16" title="16">  traj <span class="op">=</span> md.load(pdb_file)</a>
<a class="sourceLine" id="cb1632-17" title="17">  <span class="co"># Calculate the sasa</span></a>
<a class="sourceLine" id="cb1632-18" title="18">  sasa <span class="op">=</span> md.shrake_rupley(traj)</a>
<a class="sourceLine" id="cb1632-19" title="19">  <span class="co"># Return the sasa</span></a>
<a class="sourceLine" id="cb1632-20" title="20">  <span class="cf">return</span> sasa</a>
<a class="sourceLine" id="cb1632-21" title="21"></a>
<a class="sourceLine" id="cb1632-22" title="22"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1632-23" title="23"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb1632-24" title="24"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb1632-25" title="25"></a>
<a class="sourceLine" id="cb1632-26" title="26">pdb_file <span class="op">=</span> os.path.join(_FILE_DIR_,<span class="st">&quot;1VII.pdb&quot;</span>)</a>
<a class="sourceLine" id="cb1632-27" title="27"></a>
<a class="sourceLine" id="cb1632-28" title="28"><span class="kw">def</span> compute_sasa_mdtraj(pdb_file):</a>
<a class="sourceLine" id="cb1632-29" title="29">    <span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb1632-30" title="30">    pdb <span class="op">=</span> md.load(pdb_file)</a>
<a class="sourceLine" id="cb1632-31" title="31">    </a>
<a class="sourceLine" id="cb1632-32" title="32">    sasa <span class="op">=</span> md.shrake_rupley(pdb,mode<span class="op">=</span><span class="st">&#39;residue&#39;</span>)</a>
<a class="sourceLine" id="cb1632-33" title="33">    <span class="cf">return</span> sasa</a>
<a class="sourceLine" id="cb1632-34" title="34"></a>
<a class="sourceLine" id="cb1632-35" title="35">my_sasa <span class="op">=</span> compute_sasa_mdtraj(pdb_file)</a>
<a class="sourceLine" id="cb1632-36" title="36">nlcc_sasa <span class="op">=</span> protein_surface_area(pdb_file)</a>
<a class="sourceLine" id="cb1632-37" title="37"></a>
<a class="sourceLine" id="cb1632-38" title="38"><span class="co">#print(&quot;My result:&quot;, my_sasa)</span></a>
<a class="sourceLine" id="cb1632-39" title="39"><span class="co">#print(&quot;nlcc result&quot;, nlcc_sasa)</span></a>
<a class="sourceLine" id="cb1632-40" title="40"></a>
<a class="sourceLine" id="cb1632-41" title="41">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">abs</span>( my_sasa.mean() <span class="op">-</span> nlcc_sasa.mean() )<span class="op">&lt;</span><span class="fl">0.1</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-148">Run 2</h4>
<div class="sourceCode" id="cb1634"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1634-1" title="1"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb1634-2" title="2"></a>
<a class="sourceLine" id="cb1634-3" title="3"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1634-4" title="4"><span class="co">Print version string</span></a>
<a class="sourceLine" id="cb1634-5" title="5"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1634-6" title="6"><span class="bu">print</span>(md.version.full_version)</a>
<a class="sourceLine" id="cb1634-7" title="7"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1634-8" title="8"></a>
<a class="sourceLine" id="cb1634-9" title="9"><span class="kw">def</span> protein_surface_area(pdb_file):</a>
<a class="sourceLine" id="cb1634-10" title="10">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1634-11" title="11"><span class="co">  1. This function loads a pdb</span></a>
<a class="sourceLine" id="cb1634-12" title="12"><span class="co">  2. Calculates the Solvent Accessible Surface Area (sasa) per residue</span></a>
<a class="sourceLine" id="cb1634-13" title="13"><span class="co">  3. Returns it</span></a>
<a class="sourceLine" id="cb1634-14" title="14"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1634-15" title="15">  <span class="co"># Load the pdb</span></a>
<a class="sourceLine" id="cb1634-16" title="16">  traj <span class="op">=</span> md.load(pdb_file)</a>
<a class="sourceLine" id="cb1634-17" title="17">  <span class="co"># Calculate the sasa</span></a>
<a class="sourceLine" id="cb1634-18" title="18">  sasa <span class="op">=</span> md.shrake_rupley(traj, mode<span class="op">=</span><span class="st">&#39;residue&#39;</span>)</a>
<a class="sourceLine" id="cb1634-19" title="19">  <span class="co"># Return the sasa</span></a>
<a class="sourceLine" id="cb1634-20" title="20">  <span class="cf">return</span> sasa</a>
<a class="sourceLine" id="cb1634-21" title="21"></a>
<a class="sourceLine" id="cb1634-22" title="22"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1634-23" title="23"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb1634-24" title="24"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb1634-25" title="25"></a>
<a class="sourceLine" id="cb1634-26" title="26">pdb_file <span class="op">=</span> os.path.join(_FILE_DIR_,<span class="st">&quot;1VII.pdb&quot;</span>)</a>
<a class="sourceLine" id="cb1634-27" title="27"></a>
<a class="sourceLine" id="cb1634-28" title="28"><span class="kw">def</span> compute_sasa_mdtraj(pdb_file):</a>
<a class="sourceLine" id="cb1634-29" title="29">    <span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb1634-30" title="30">    pdb <span class="op">=</span> md.load(pdb_file)</a>
<a class="sourceLine" id="cb1634-31" title="31">    </a>
<a class="sourceLine" id="cb1634-32" title="32">    sasa <span class="op">=</span> md.shrake_rupley(pdb,mode<span class="op">=</span><span class="st">&#39;residue&#39;</span>)</a>
<a class="sourceLine" id="cb1634-33" title="33">    <span class="cf">return</span> sasa</a>
<a class="sourceLine" id="cb1634-34" title="34"></a>
<a class="sourceLine" id="cb1634-35" title="35">my_sasa <span class="op">=</span> compute_sasa_mdtraj(pdb_file)</a>
<a class="sourceLine" id="cb1634-36" title="36">nlcc_sasa <span class="op">=</span> protein_surface_area(pdb_file)</a>
<a class="sourceLine" id="cb1634-37" title="37"></a>
<a class="sourceLine" id="cb1634-38" title="38"><span class="co">#print(&quot;My result:&quot;, my_sasa)</span></a>
<a class="sourceLine" id="cb1634-39" title="39"><span class="co">#print(&quot;nlcc result&quot;, nlcc_sasa)</span></a>
<a class="sourceLine" id="cb1634-40" title="40"></a>
<a class="sourceLine" id="cb1634-41" title="41">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">abs</span>( my_sasa.mean() <span class="op">-</span> nlcc_sasa.mean() )<span class="op">&lt;</span><span class="fl">0.1</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-148">Run 3</h4>
<div class="sourceCode" id="cb1636"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1636-1" title="1"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb1636-2" title="2"></a>
<a class="sourceLine" id="cb1636-3" title="3"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1636-4" title="4"><span class="co">Print version string</span></a>
<a class="sourceLine" id="cb1636-5" title="5"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1636-6" title="6"><span class="bu">print</span>(md.version.full_version)</a>
<a class="sourceLine" id="cb1636-7" title="7"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1636-8" title="8"></a>
<a class="sourceLine" id="cb1636-9" title="9"><span class="kw">def</span> protein_surface_area(pdb_file):</a>
<a class="sourceLine" id="cb1636-10" title="10">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1636-11" title="11"><span class="co">  1. This function loads a pdb</span></a>
<a class="sourceLine" id="cb1636-12" title="12"><span class="co">  2. Calculates the Solvent Accessible Surface Area (sasa) per residue</span></a>
<a class="sourceLine" id="cb1636-13" title="13"><span class="co">  3. Returns it</span></a>
<a class="sourceLine" id="cb1636-14" title="14"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1636-15" title="15">  <span class="co"># Load the pdb file</span></a>
<a class="sourceLine" id="cb1636-16" title="16">  traj <span class="op">=</span> md.load(pdb_file)</a>
<a class="sourceLine" id="cb1636-17" title="17">  <span class="co"># Calculate the sasa</span></a>
<a class="sourceLine" id="cb1636-18" title="18">  sasa <span class="op">=</span> md.shrake_rupley(traj)</a>
<a class="sourceLine" id="cb1636-19" title="19">  <span class="co"># Return the sasa</span></a>
<a class="sourceLine" id="cb1636-20" title="20">  <span class="cf">return</span> sasa</a>
<a class="sourceLine" id="cb1636-21" title="21"></a>
<a class="sourceLine" id="cb1636-22" title="22"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1636-23" title="23"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb1636-24" title="24"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb1636-25" title="25"></a>
<a class="sourceLine" id="cb1636-26" title="26">pdb_file <span class="op">=</span> os.path.join(_FILE_DIR_,<span class="st">&quot;1VII.pdb&quot;</span>)</a>
<a class="sourceLine" id="cb1636-27" title="27"></a>
<a class="sourceLine" id="cb1636-28" title="28"><span class="kw">def</span> compute_sasa_mdtraj(pdb_file):</a>
<a class="sourceLine" id="cb1636-29" title="29">    <span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb1636-30" title="30">    pdb <span class="op">=</span> md.load(pdb_file)</a>
<a class="sourceLine" id="cb1636-31" title="31">    </a>
<a class="sourceLine" id="cb1636-32" title="32">    sasa <span class="op">=</span> md.shrake_rupley(pdb,mode<span class="op">=</span><span class="st">&#39;residue&#39;</span>)</a>
<a class="sourceLine" id="cb1636-33" title="33">    <span class="cf">return</span> sasa</a>
<a class="sourceLine" id="cb1636-34" title="34"></a>
<a class="sourceLine" id="cb1636-35" title="35">my_sasa <span class="op">=</span> compute_sasa_mdtraj(pdb_file)</a>
<a class="sourceLine" id="cb1636-36" title="36">nlcc_sasa <span class="op">=</span> protein_surface_area(pdb_file)</a>
<a class="sourceLine" id="cb1636-37" title="37"></a>
<a class="sourceLine" id="cb1636-38" title="38"><span class="co">#print(&quot;My result:&quot;, my_sasa)</span></a>
<a class="sourceLine" id="cb1636-39" title="39"><span class="co">#print(&quot;nlcc result&quot;, nlcc_sasa)</span></a>
<a class="sourceLine" id="cb1636-40" title="40"></a>
<a class="sourceLine" id="cb1636-41" title="41">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">abs</span>( my_sasa.mean() <span class="op">-</span> nlcc_sasa.mean() )<span class="op">&lt;</span><span class="fl">0.1</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-148">Run 4</h4>
<div class="sourceCode" id="cb1638"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1638-1" title="1"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb1638-2" title="2"></a>
<a class="sourceLine" id="cb1638-3" title="3"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1638-4" title="4"><span class="co">Print version string</span></a>
<a class="sourceLine" id="cb1638-5" title="5"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1638-6" title="6"><span class="bu">print</span>(md.version.full_version)</a>
<a class="sourceLine" id="cb1638-7" title="7"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1638-8" title="8"></a>
<a class="sourceLine" id="cb1638-9" title="9"><span class="kw">def</span> protein_surface_area(pdb_file):</a>
<a class="sourceLine" id="cb1638-10" title="10">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1638-11" title="11"><span class="co">  1. This function loads a pdb</span></a>
<a class="sourceLine" id="cb1638-12" title="12"><span class="co">  2. Calculates the Solvent Accessible Surface Area (sasa) per residue</span></a>
<a class="sourceLine" id="cb1638-13" title="13"><span class="co">  3. Returns it</span></a>
<a class="sourceLine" id="cb1638-14" title="14"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1638-15" title="15">  <span class="co"># Load the pdb file</span></a>
<a class="sourceLine" id="cb1638-16" title="16">  traj <span class="op">=</span> md.load(pdb_file)</a>
<a class="sourceLine" id="cb1638-17" title="17">  <span class="co"># Calculate the sasa</span></a>
<a class="sourceLine" id="cb1638-18" title="18">  sasa <span class="op">=</span> md.shrake_rupley(traj, mode<span class="op">=</span><span class="st">&#39;residue&#39;</span>)</a>
<a class="sourceLine" id="cb1638-19" title="19">  <span class="co"># Return the sasa</span></a>
<a class="sourceLine" id="cb1638-20" title="20">  <span class="cf">return</span> sasa</a>
<a class="sourceLine" id="cb1638-21" title="21"></a>
<a class="sourceLine" id="cb1638-22" title="22"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1638-23" title="23"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb1638-24" title="24"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb1638-25" title="25"></a>
<a class="sourceLine" id="cb1638-26" title="26">pdb_file <span class="op">=</span> os.path.join(_FILE_DIR_,<span class="st">&quot;1VII.pdb&quot;</span>)</a>
<a class="sourceLine" id="cb1638-27" title="27"></a>
<a class="sourceLine" id="cb1638-28" title="28"><span class="kw">def</span> compute_sasa_mdtraj(pdb_file):</a>
<a class="sourceLine" id="cb1638-29" title="29">    <span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb1638-30" title="30">    pdb <span class="op">=</span> md.load(pdb_file)</a>
<a class="sourceLine" id="cb1638-31" title="31">    </a>
<a class="sourceLine" id="cb1638-32" title="32">    sasa <span class="op">=</span> md.shrake_rupley(pdb,mode<span class="op">=</span><span class="st">&#39;residue&#39;</span>)</a>
<a class="sourceLine" id="cb1638-33" title="33">    <span class="cf">return</span> sasa</a>
<a class="sourceLine" id="cb1638-34" title="34"></a>
<a class="sourceLine" id="cb1638-35" title="35">my_sasa <span class="op">=</span> compute_sasa_mdtraj(pdb_file)</a>
<a class="sourceLine" id="cb1638-36" title="36">nlcc_sasa <span class="op">=</span> protein_surface_area(pdb_file)</a>
<a class="sourceLine" id="cb1638-37" title="37"></a>
<a class="sourceLine" id="cb1638-38" title="38"><span class="co">#print(&quot;My result:&quot;, my_sasa)</span></a>
<a class="sourceLine" id="cb1638-39" title="39"><span class="co">#print(&quot;nlcc result&quot;, nlcc_sasa)</span></a>
<a class="sourceLine" id="cb1638-40" title="40"></a>
<a class="sourceLine" id="cb1638-41" title="41">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">abs</span>( my_sasa.mean() <span class="op">-</span> nlcc_sasa.mean() )<span class="op">&lt;</span><span class="fl">0.1</span> <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>scaffold</summary></p>
<h4 id="query-149">Query</h4>
<div class="sourceCode" id="cb1640"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1640-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1640-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb1640-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb1640-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb1640-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb1640-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb1640-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb1640-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb1640-9" title="9"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb1640-10" title="10"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb1640-11" title="11"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1640-12" title="12"></a>
<a class="sourceLine" id="cb1640-13" title="13"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1640-14" title="14"><span class="co">print rdkit version</span></a>
<a class="sourceLine" id="cb1640-15" title="15"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1640-16" title="16"><span class="bu">print</span>(rdkit.__version__)</a>
<a class="sourceLine" id="cb1640-17" title="17"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1640-18" title="18"></a>
<a class="sourceLine" id="cb1640-19" title="19"><span class="kw">def</span> scaffold(smiles):</a>
<a class="sourceLine" id="cb1640-20" title="20">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1640-21" title="21"><span class="co">    Returns Murcko scaffold of given molecule</span></a>
<a class="sourceLine" id="cb1640-22" title="22"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1640-23" title="23">    </a></code></pre></div>
<h4 id="run-0-149">Run 0</h4>
<div class="sourceCode" id="cb1641"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1641-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1641-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb1641-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb1641-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb1641-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb1641-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb1641-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb1641-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb1641-9" title="9"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb1641-10" title="10"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb1641-11" title="11"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1641-12" title="12"></a>
<a class="sourceLine" id="cb1641-13" title="13"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1641-14" title="14"><span class="co">print rdkit version</span></a>
<a class="sourceLine" id="cb1641-15" title="15"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1641-16" title="16"><span class="bu">print</span>(rdkit.__version__)</a>
<a class="sourceLine" id="cb1641-17" title="17"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1641-18" title="18"></a>
<a class="sourceLine" id="cb1641-19" title="19"><span class="kw">def</span> scaffold(smiles):</a>
<a class="sourceLine" id="cb1641-20" title="20">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1641-21" title="21"><span class="co">    Returns Murcko scaffold of given molecule</span></a>
<a class="sourceLine" id="cb1641-22" title="22"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1641-23" title="23">    mol <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb1641-24" title="24">    scaffold <span class="op">=</span> Chem.MolFromSmiles(Chem.MolToSmiles(mol,<span class="va">True</span>))</a>
<a class="sourceLine" id="cb1641-25" title="25">    core <span class="op">=</span> Chem.DeleteSubstructs(scaffold,Chem.MolFromSmarts(<span class="st">&#39;[*]&#39;</span>))</a>
<a class="sourceLine" id="cb1641-26" title="26">    <span class="cf">return</span> Chem.MolToSmiles(core)</a>
<a class="sourceLine" id="cb1641-27" title="27"></a>
<a class="sourceLine" id="cb1641-28" title="28">smiles <span class="op">=</span> <span class="st">&#39;C1([O-])C=CC=C1NCC[NH+]&#39;</span></a>
<a class="sourceLine" id="cb1641-29" title="29">mol <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb1641-30" title="30">sc <span class="op">=</span> rdkit.Chem.rdMolHash.MolHash(</a>
<a class="sourceLine" id="cb1641-31" title="31">    mol, rdkit.Chem.rdMolHash.HashFunction.MurckoScaffold)</a>
<a class="sourceLine" id="cb1641-32" title="32">result <span class="op">=</span> scaffold(smiles) <span class="op">==</span> sc</a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-149">Run 1</h4>
<div class="sourceCode" id="cb1643"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1643-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1643-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb1643-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb1643-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb1643-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb1643-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb1643-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb1643-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb1643-9" title="9"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb1643-10" title="10"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb1643-11" title="11"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1643-12" title="12"></a>
<a class="sourceLine" id="cb1643-13" title="13"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1643-14" title="14"><span class="co">print rdkit version</span></a>
<a class="sourceLine" id="cb1643-15" title="15"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1643-16" title="16"><span class="bu">print</span>(rdkit.__version__)</a>
<a class="sourceLine" id="cb1643-17" title="17"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1643-18" title="18"></a>
<a class="sourceLine" id="cb1643-19" title="19"><span class="kw">def</span> scaffold(smiles):</a>
<a class="sourceLine" id="cb1643-20" title="20">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1643-21" title="21"><span class="co">    Returns Murcko scaffold of given molecule</span></a>
<a class="sourceLine" id="cb1643-22" title="22"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1643-23" title="23">    mol <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb1643-24" title="24">    scaffold <span class="op">=</span> Chem.MolFromSmiles(Chem.MolToSmiles(mol,<span class="va">True</span>))</a>
<a class="sourceLine" id="cb1643-25" title="25">    core <span class="op">=</span> Chem.DeleteSubstructs(scaffold,Chem.MolFromSmarts(<span class="st">&#39;[*]&#39;</span>))</a>
<a class="sourceLine" id="cb1643-26" title="26">    <span class="cf">return</span> core</a>
<a class="sourceLine" id="cb1643-27" title="27"></a>
<a class="sourceLine" id="cb1643-28" title="28">smiles <span class="op">=</span> <span class="st">&#39;C1([O-])C=CC=C1NCC[NH+]&#39;</span></a>
<a class="sourceLine" id="cb1643-29" title="29">mol <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb1643-30" title="30">sc <span class="op">=</span> rdkit.Chem.rdMolHash.MolHash(</a>
<a class="sourceLine" id="cb1643-31" title="31">    mol, rdkit.Chem.rdMolHash.HashFunction.MurckoScaffold)</a>
<a class="sourceLine" id="cb1643-32" title="32">result <span class="op">=</span> scaffold(smiles) <span class="op">==</span> sc</a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-149">Run 2</h4>
<div class="sourceCode" id="cb1645"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1645-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1645-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb1645-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb1645-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb1645-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb1645-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb1645-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb1645-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb1645-9" title="9"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb1645-10" title="10"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb1645-11" title="11"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1645-12" title="12"></a>
<a class="sourceLine" id="cb1645-13" title="13"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1645-14" title="14"><span class="co">print rdkit version</span></a>
<a class="sourceLine" id="cb1645-15" title="15"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1645-16" title="16"><span class="bu">print</span>(rdkit.__version__)</a>
<a class="sourceLine" id="cb1645-17" title="17"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1645-18" title="18"></a>
<a class="sourceLine" id="cb1645-19" title="19"><span class="kw">def</span> scaffold(smiles):</a>
<a class="sourceLine" id="cb1645-20" title="20">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1645-21" title="21"><span class="co">    Returns Murcko scaffold of given molecule</span></a>
<a class="sourceLine" id="cb1645-22" title="22"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1645-23" title="23">    mol <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb1645-24" title="24">    scaffold <span class="op">=</span> Chem.MolFromSmiles(Chem.MolToSmiles(mol, rootedAtAtom<span class="op">=</span><span class="dv">0</span>, isomericSmiles<span class="op">=</span><span class="va">False</span>))</a>
<a class="sourceLine" id="cb1645-25" title="25">    core <span class="op">=</span> Chem.DeleteSubstructs(scaffold, Chem.MolFromSmarts(<span class="st">&#39;[*]&#39;</span>))</a>
<a class="sourceLine" id="cb1645-26" title="26">    <span class="cf">return</span> Chem.MolToSmiles(core)</a>
<a class="sourceLine" id="cb1645-27" title="27"></a>
<a class="sourceLine" id="cb1645-28" title="28">smiles <span class="op">=</span> <span class="st">&#39;C1([O-])C=CC=C1NCC[NH+]&#39;</span></a>
<a class="sourceLine" id="cb1645-29" title="29">mol <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb1645-30" title="30">sc <span class="op">=</span> rdkit.Chem.rdMolHash.MolHash(</a>
<a class="sourceLine" id="cb1645-31" title="31">    mol, rdkit.Chem.rdMolHash.HashFunction.MurckoScaffold)</a>
<a class="sourceLine" id="cb1645-32" title="32">result <span class="op">=</span> scaffold(smiles) <span class="op">==</span> sc</a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-149">Run 3</h4>
<div class="sourceCode" id="cb1647"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1647-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1647-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb1647-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb1647-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb1647-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb1647-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb1647-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb1647-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb1647-9" title="9"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb1647-10" title="10"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb1647-11" title="11"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1647-12" title="12"></a>
<a class="sourceLine" id="cb1647-13" title="13"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1647-14" title="14"><span class="co">print rdkit version</span></a>
<a class="sourceLine" id="cb1647-15" title="15"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1647-16" title="16"><span class="bu">print</span>(rdkit.__version__)</a>
<a class="sourceLine" id="cb1647-17" title="17"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1647-18" title="18"></a>
<a class="sourceLine" id="cb1647-19" title="19"><span class="kw">def</span> scaffold(smiles):</a>
<a class="sourceLine" id="cb1647-20" title="20">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1647-21" title="21"><span class="co">    Returns Murcko scaffold of given molecule</span></a>
<a class="sourceLine" id="cb1647-22" title="22"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1647-23" title="23">    mol <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb1647-24" title="24">    engine <span class="op">=</span> Scaffold.ScaffoldGenerator()</a>
<a class="sourceLine" id="cb1647-25" title="25">    scaffold <span class="op">=</span> engine.GetScaffoldForMol(mol)</a>
<a class="sourceLine" id="cb1647-26" title="26">    <span class="cf">return</span> Chem.MolToSmiles(scaffold, isomericSmiles<span class="op">=</span><span class="va">True</span>)</a>
<a class="sourceLine" id="cb1647-27" title="27"></a>
<a class="sourceLine" id="cb1647-28" title="28">smiles <span class="op">=</span> <span class="st">&#39;C1([O-])C=CC=C1NCC[NH+]&#39;</span></a>
<a class="sourceLine" id="cb1647-29" title="29">mol <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb1647-30" title="30">sc <span class="op">=</span> rdkit.Chem.rdMolHash.MolHash(</a>
<a class="sourceLine" id="cb1647-31" title="31">    mol, rdkit.Chem.rdMolHash.HashFunction.MurckoScaffold)</a>
<a class="sourceLine" id="cb1647-32" title="32">result <span class="op">=</span> scaffold(smiles) <span class="op">==</span> sc</a></code></pre></div>
<p>Output:</p>
<pre><code>name &#39;Scaffold&#39; is not defined</code></pre>
<h4 id="run-4-149">Run 4</h4>
<div class="sourceCode" id="cb1649"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1649-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1649-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb1649-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb1649-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb1649-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb1649-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb1649-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb1649-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb1649-9" title="9"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb1649-10" title="10"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb1649-11" title="11"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1649-12" title="12"></a>
<a class="sourceLine" id="cb1649-13" title="13"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1649-14" title="14"><span class="co">print rdkit version</span></a>
<a class="sourceLine" id="cb1649-15" title="15"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1649-16" title="16"><span class="bu">print</span>(rdkit.__version__)</a>
<a class="sourceLine" id="cb1649-17" title="17"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1649-18" title="18"></a>
<a class="sourceLine" id="cb1649-19" title="19"><span class="kw">def</span> scaffold(smiles):</a>
<a class="sourceLine" id="cb1649-20" title="20">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1649-21" title="21"><span class="co">    Returns Murcko scaffold of given molecule</span></a>
<a class="sourceLine" id="cb1649-22" title="22"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1649-23" title="23">    mol <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb1649-24" title="24">    core <span class="op">=</span> Chem.MolFromSmiles(Chem.MolToSmiles(mol, <span class="va">True</span>))</a>
<a class="sourceLine" id="cb1649-25" title="25">    AllChem.Compute2DCoords(core)</a>
<a class="sourceLine" id="cb1649-26" title="26">    <span class="cf">for</span> atom <span class="kw">in</span> core.GetAtoms():</a>
<a class="sourceLine" id="cb1649-27" title="27">        atom.SetAtomMapNum(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb1649-28" title="28">    scaffold <span class="op">=</span> Chem.Mol(core)</a>
<a class="sourceLine" id="cb1649-29" title="29">    Chem.SanitizeMol(scaffold)</a>
<a class="sourceLine" id="cb1649-30" title="30">    <span class="cf">return</span> scaffold</a>
<a class="sourceLine" id="cb1649-31" title="31"></a>
<a class="sourceLine" id="cb1649-32" title="32">smiles <span class="op">=</span> <span class="st">&#39;C1([O-])C=CC=C1NCC[NH+]&#39;</span></a>
<a class="sourceLine" id="cb1649-33" title="33">mol <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb1649-34" title="34">sc <span class="op">=</span> rdkit.Chem.rdMolHash.MolHash(</a>
<a class="sourceLine" id="cb1649-35" title="35">    mol, rdkit.Chem.rdMolHash.HashFunction.MurckoScaffold)</a>
<a class="sourceLine" id="cb1649-36" title="36">result <span class="op">=</span> scaffold(smiles) <span class="op">==</span> sc</a></code></pre></div>
<p>Output:</p>
<pre><code>name &#39;AllChem&#39; is not defined</code></pre>
</details>
<details>
<p><summary>seq-align</summary></p>
<h4 id="query-150">Query</h4>
<div class="sourceCode" id="cb1651"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1651-1" title="1"><span class="im">from</span> Bio <span class="im">import</span> SeqIO</a>
<a class="sourceLine" id="cb1651-2" title="2"><span class="im">from</span> Bio <span class="im">import</span> Align</a>
<a class="sourceLine" id="cb1651-3" title="3"><span class="im">from</span> Bio <span class="im">import</span> PopGen</a>
<a class="sourceLine" id="cb1651-4" title="4"><span class="im">from</span> Bio.PDB <span class="im">import</span> <span class="op">*</span></a>
<a class="sourceLine" id="cb1651-5" title="5"><span class="im">from</span> Bio.Seq <span class="im">import</span> Seq</a>
<a class="sourceLine" id="cb1651-6" title="6"><span class="im">import</span> Bio</a>
<a class="sourceLine" id="cb1651-7" title="7"><span class="im">from</span> Bio <span class="im">import</span> pairwise2</a>
<a class="sourceLine" id="cb1651-8" title="8"><span class="im">from</span> Bio.Blast <span class="im">import</span> NCBIWWW, NCBIXML</a>
<a class="sourceLine" id="cb1651-9" title="9"><span class="im">from</span> Bio.SubsMat <span class="im">import</span> MatrixInfo <span class="im">as</span> matlist</a>
<a class="sourceLine" id="cb1651-10" title="10"></a>
<a class="sourceLine" id="cb1651-11" title="11"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1651-12" title="12"><span class="co">print biopython version</span></a>
<a class="sourceLine" id="cb1651-13" title="13"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1651-14" title="14"><span class="bu">print</span>(Bio.__version__)</a>
<a class="sourceLine" id="cb1651-15" title="15"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1651-16" title="16"></a>
<a class="sourceLine" id="cb1651-17" title="17"><span class="kw">def</span> align(seq1, seq2):</a>
<a class="sourceLine" id="cb1651-18" title="18">    <span class="co">&#39;&#39;&#39;</span></a>
<a class="sourceLine" id="cb1651-19" title="19"><span class="co">    Align the two amino acid sequences with BLOSUM62 and return aligned sequences</span></a>
<a class="sourceLine" id="cb1651-20" title="20"><span class="co">    &#39;&#39;&#39;</span></a>
<a class="sourceLine" id="cb1651-21" title="21">    </a></code></pre></div>
<h4 id="run-0-150">Run 0</h4>
<div class="sourceCode" id="cb1652"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1652-1" title="1"><span class="im">from</span> Bio <span class="im">import</span> SeqIO</a>
<a class="sourceLine" id="cb1652-2" title="2"><span class="im">from</span> Bio <span class="im">import</span> Align</a>
<a class="sourceLine" id="cb1652-3" title="3"><span class="im">from</span> Bio <span class="im">import</span> PopGen</a>
<a class="sourceLine" id="cb1652-4" title="4"><span class="im">from</span> Bio.PDB <span class="im">import</span> <span class="op">*</span></a>
<a class="sourceLine" id="cb1652-5" title="5"><span class="im">from</span> Bio.Seq <span class="im">import</span> Seq</a>
<a class="sourceLine" id="cb1652-6" title="6"><span class="im">import</span> Bio</a>
<a class="sourceLine" id="cb1652-7" title="7"><span class="im">from</span> Bio <span class="im">import</span> pairwise2</a>
<a class="sourceLine" id="cb1652-8" title="8"><span class="im">from</span> Bio.Blast <span class="im">import</span> NCBIWWW, NCBIXML</a>
<a class="sourceLine" id="cb1652-9" title="9"><span class="im">from</span> Bio.SubsMat <span class="im">import</span> MatrixInfo <span class="im">as</span> matlist</a>
<a class="sourceLine" id="cb1652-10" title="10"></a>
<a class="sourceLine" id="cb1652-11" title="11"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1652-12" title="12"><span class="co">print biopython version</span></a>
<a class="sourceLine" id="cb1652-13" title="13"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1652-14" title="14"><span class="bu">print</span>(Bio.__version__)</a>
<a class="sourceLine" id="cb1652-15" title="15"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1652-16" title="16"></a>
<a class="sourceLine" id="cb1652-17" title="17"><span class="kw">def</span> align(seq1, seq2):</a>
<a class="sourceLine" id="cb1652-18" title="18">    <span class="co">&#39;&#39;&#39;</span></a>
<a class="sourceLine" id="cb1652-19" title="19"><span class="co">    Align the two amino acid sequences with BLOSUM62 and return aligned sequences</span></a>
<a class="sourceLine" id="cb1652-20" title="20"><span class="co">    &#39;&#39;&#39;</span></a>
<a class="sourceLine" id="cb1652-21" title="21">    matrix <span class="op">=</span> matlist.blosum62</a>
<a class="sourceLine" id="cb1652-22" title="22">    gap_open <span class="op">=</span> <span class="dv">-10</span></a>
<a class="sourceLine" id="cb1652-23" title="23">    gap_extend <span class="op">=</span> <span class="fl">-0.5</span></a>
<a class="sourceLine" id="cb1652-24" title="24">    alns <span class="op">=</span> pairwise2.align.globalds(seq1, seq2, matrix, gap_open, gap_extend)</a>
<a class="sourceLine" id="cb1652-25" title="25">    top_aln <span class="op">=</span> alns[<span class="dv">0</span>]</a>
<a class="sourceLine" id="cb1652-26" title="26">    aln_seq1, aln_seq2, score, begin, end <span class="op">=</span> top_aln</a>
<a class="sourceLine" id="cb1652-27" title="27">    <span class="cf">return</span> aln_seq1, aln_seq2</a>
<a class="sourceLine" id="cb1652-28" title="28"></a>
<a class="sourceLine" id="cb1652-29" title="29"></a>
<a class="sourceLine" id="cb1652-30" title="30">seq1 <span class="op">=</span> Seq(<span class="st">&#39;EEKG&#39;</span>)</a>
<a class="sourceLine" id="cb1652-31" title="31">seq2 <span class="op">=</span> Seq(<span class="st">&#39;SSSDEKA&#39;</span>)</a>
<a class="sourceLine" id="cb1652-32" title="32">a <span class="op">=</span> align(seq1, seq2)</a>
<a class="sourceLine" id="cb1652-33" title="33">result <span class="op">=</span> a[<span class="dv">0</span>] <span class="op">==</span> <span class="st">&#39;---EEKG&#39;</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-150">Run 1</h4>
<div class="sourceCode" id="cb1654"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1654-1" title="1"><span class="im">from</span> Bio <span class="im">import</span> SeqIO</a>
<a class="sourceLine" id="cb1654-2" title="2"><span class="im">from</span> Bio <span class="im">import</span> Align</a>
<a class="sourceLine" id="cb1654-3" title="3"><span class="im">from</span> Bio <span class="im">import</span> PopGen</a>
<a class="sourceLine" id="cb1654-4" title="4"><span class="im">from</span> Bio.PDB <span class="im">import</span> <span class="op">*</span></a>
<a class="sourceLine" id="cb1654-5" title="5"><span class="im">from</span> Bio.Seq <span class="im">import</span> Seq</a>
<a class="sourceLine" id="cb1654-6" title="6"><span class="im">import</span> Bio</a>
<a class="sourceLine" id="cb1654-7" title="7"><span class="im">from</span> Bio <span class="im">import</span> pairwise2</a>
<a class="sourceLine" id="cb1654-8" title="8"><span class="im">from</span> Bio.Blast <span class="im">import</span> NCBIWWW, NCBIXML</a>
<a class="sourceLine" id="cb1654-9" title="9"><span class="im">from</span> Bio.SubsMat <span class="im">import</span> MatrixInfo <span class="im">as</span> matlist</a>
<a class="sourceLine" id="cb1654-10" title="10"></a>
<a class="sourceLine" id="cb1654-11" title="11"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1654-12" title="12"><span class="co">print biopython version</span></a>
<a class="sourceLine" id="cb1654-13" title="13"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1654-14" title="14"><span class="bu">print</span>(Bio.__version__)</a>
<a class="sourceLine" id="cb1654-15" title="15"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1654-16" title="16"></a>
<a class="sourceLine" id="cb1654-17" title="17"><span class="kw">def</span> align(seq1, seq2):</a>
<a class="sourceLine" id="cb1654-18" title="18">    <span class="co">&#39;&#39;&#39;</span></a>
<a class="sourceLine" id="cb1654-19" title="19"><span class="co">    Align the two amino acid sequences with BLOSUM62 and return aligned sequences</span></a>
<a class="sourceLine" id="cb1654-20" title="20"><span class="co">    &#39;&#39;&#39;</span></a>
<a class="sourceLine" id="cb1654-21" title="21">    matrix <span class="op">=</span> matlist.blosum62</a>
<a class="sourceLine" id="cb1654-22" title="22">    gap_open <span class="op">=</span> <span class="dv">-10</span></a>
<a class="sourceLine" id="cb1654-23" title="23">    gap_extend <span class="op">=</span> <span class="fl">-0.5</span></a>
<a class="sourceLine" id="cb1654-24" title="24">    alns <span class="op">=</span> pairwise2.align.globalds(seq1, seq2, matrix, gap_open, gap_extend)</a>
<a class="sourceLine" id="cb1654-25" title="25">    top_aln <span class="op">=</span> alns[<span class="dv">0</span>]</a>
<a class="sourceLine" id="cb1654-26" title="26">    aln_seq1, aln_seq2, score, begin, end <span class="op">=</span> top_aln</a>
<a class="sourceLine" id="cb1654-27" title="27">    <span class="cf">return</span> aln_seq1, aln_seq2</a>
<a class="sourceLine" id="cb1654-28" title="28"></a>
<a class="sourceLine" id="cb1654-29" title="29">seq1 <span class="op">=</span> Seq(<span class="st">&#39;EEKG&#39;</span>)</a>
<a class="sourceLine" id="cb1654-30" title="30">seq2 <span class="op">=</span> Seq(<span class="st">&#39;SSSDEKA&#39;</span>)</a>
<a class="sourceLine" id="cb1654-31" title="31">a <span class="op">=</span> align(seq1, seq2)</a>
<a class="sourceLine" id="cb1654-32" title="32">result <span class="op">=</span> a[<span class="dv">0</span>] <span class="op">==</span> <span class="st">&#39;---EEKG&#39;</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-150">Run 2</h4>
<div class="sourceCode" id="cb1656"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1656-1" title="1"><span class="im">from</span> Bio <span class="im">import</span> SeqIO</a>
<a class="sourceLine" id="cb1656-2" title="2"><span class="im">from</span> Bio <span class="im">import</span> Align</a>
<a class="sourceLine" id="cb1656-3" title="3"><span class="im">from</span> Bio <span class="im">import</span> PopGen</a>
<a class="sourceLine" id="cb1656-4" title="4"><span class="im">from</span> Bio.PDB <span class="im">import</span> <span class="op">*</span></a>
<a class="sourceLine" id="cb1656-5" title="5"><span class="im">from</span> Bio.Seq <span class="im">import</span> Seq</a>
<a class="sourceLine" id="cb1656-6" title="6"><span class="im">import</span> Bio</a>
<a class="sourceLine" id="cb1656-7" title="7"><span class="im">from</span> Bio <span class="im">import</span> pairwise2</a>
<a class="sourceLine" id="cb1656-8" title="8"><span class="im">from</span> Bio.Blast <span class="im">import</span> NCBIWWW, NCBIXML</a>
<a class="sourceLine" id="cb1656-9" title="9"><span class="im">from</span> Bio.SubsMat <span class="im">import</span> MatrixInfo <span class="im">as</span> matlist</a>
<a class="sourceLine" id="cb1656-10" title="10"></a>
<a class="sourceLine" id="cb1656-11" title="11"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1656-12" title="12"><span class="co">print biopython version</span></a>
<a class="sourceLine" id="cb1656-13" title="13"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1656-14" title="14"><span class="bu">print</span>(Bio.__version__)</a>
<a class="sourceLine" id="cb1656-15" title="15"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1656-16" title="16"></a>
<a class="sourceLine" id="cb1656-17" title="17"><span class="kw">def</span> align(seq1, seq2):</a>
<a class="sourceLine" id="cb1656-18" title="18">    <span class="co">&#39;&#39;&#39;</span></a>
<a class="sourceLine" id="cb1656-19" title="19"><span class="co">    Align the two amino acid sequences with BLOSUM62 and return aligned sequences</span></a>
<a class="sourceLine" id="cb1656-20" title="20"><span class="co">    &#39;&#39;&#39;</span></a>
<a class="sourceLine" id="cb1656-21" title="21">    matrix <span class="op">=</span> matlist.blosum62</a>
<a class="sourceLine" id="cb1656-22" title="22">    gap_open <span class="op">=</span> <span class="dv">-10</span></a>
<a class="sourceLine" id="cb1656-23" title="23">    gap_extend <span class="op">=</span> <span class="fl">-0.5</span></a>
<a class="sourceLine" id="cb1656-24" title="24">    alns <span class="op">=</span> pairwise2.align.globalds(seq1, seq2, matrix, gap_open, gap_extend)</a>
<a class="sourceLine" id="cb1656-25" title="25">    top_aln <span class="op">=</span> alns[<span class="dv">0</span>]</a>
<a class="sourceLine" id="cb1656-26" title="26">    aln_seq1, aln_seq2, score, begin, end <span class="op">=</span> top_aln</a>
<a class="sourceLine" id="cb1656-27" title="27">    <span class="cf">return</span> aln_seq1, aln_seq2</a>
<a class="sourceLine" id="cb1656-28" title="28"></a>
<a class="sourceLine" id="cb1656-29" title="29">seq1 <span class="op">=</span> Seq(<span class="st">&#39;EEKG&#39;</span>)</a>
<a class="sourceLine" id="cb1656-30" title="30">seq2 <span class="op">=</span> Seq(<span class="st">&#39;SSSDEKA&#39;</span>)</a>
<a class="sourceLine" id="cb1656-31" title="31">a <span class="op">=</span> align(seq1, seq2)</a>
<a class="sourceLine" id="cb1656-32" title="32">result <span class="op">=</span> a[<span class="dv">0</span>] <span class="op">==</span> <span class="st">&#39;---EEKG&#39;</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-150">Run 3</h4>
<div class="sourceCode" id="cb1658"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1658-1" title="1"><span class="im">from</span> Bio <span class="im">import</span> SeqIO</a>
<a class="sourceLine" id="cb1658-2" title="2"><span class="im">from</span> Bio <span class="im">import</span> Align</a>
<a class="sourceLine" id="cb1658-3" title="3"><span class="im">from</span> Bio <span class="im">import</span> PopGen</a>
<a class="sourceLine" id="cb1658-4" title="4"><span class="im">from</span> Bio.PDB <span class="im">import</span> <span class="op">*</span></a>
<a class="sourceLine" id="cb1658-5" title="5"><span class="im">from</span> Bio.Seq <span class="im">import</span> Seq</a>
<a class="sourceLine" id="cb1658-6" title="6"><span class="im">import</span> Bio</a>
<a class="sourceLine" id="cb1658-7" title="7"><span class="im">from</span> Bio <span class="im">import</span> pairwise2</a>
<a class="sourceLine" id="cb1658-8" title="8"><span class="im">from</span> Bio.Blast <span class="im">import</span> NCBIWWW, NCBIXML</a>
<a class="sourceLine" id="cb1658-9" title="9"><span class="im">from</span> Bio.SubsMat <span class="im">import</span> MatrixInfo <span class="im">as</span> matlist</a>
<a class="sourceLine" id="cb1658-10" title="10"></a>
<a class="sourceLine" id="cb1658-11" title="11"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1658-12" title="12"><span class="co">print biopython version</span></a>
<a class="sourceLine" id="cb1658-13" title="13"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1658-14" title="14"><span class="bu">print</span>(Bio.__version__)</a>
<a class="sourceLine" id="cb1658-15" title="15"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1658-16" title="16"></a>
<a class="sourceLine" id="cb1658-17" title="17"><span class="kw">def</span> align(seq1, seq2):</a>
<a class="sourceLine" id="cb1658-18" title="18">    <span class="co">&#39;&#39;&#39;</span></a>
<a class="sourceLine" id="cb1658-19" title="19"><span class="co">    Align the two amino acid sequences with BLOSUM62 and return aligned sequences</span></a>
<a class="sourceLine" id="cb1658-20" title="20"><span class="co">    &#39;&#39;&#39;</span></a>
<a class="sourceLine" id="cb1658-21" title="21">    matrix <span class="op">=</span> matlist.blosum62</a>
<a class="sourceLine" id="cb1658-22" title="22">    gap_open <span class="op">=</span> <span class="dv">-10</span></a>
<a class="sourceLine" id="cb1658-23" title="23">    gap_extend <span class="op">=</span> <span class="fl">-0.5</span></a>
<a class="sourceLine" id="cb1658-24" title="24">    alns <span class="op">=</span> pairwise2.align.globalds(seq1, seq2, matrix, gap_open, gap_extend)</a>
<a class="sourceLine" id="cb1658-25" title="25">    top_aln <span class="op">=</span> alns[<span class="dv">0</span>]</a>
<a class="sourceLine" id="cb1658-26" title="26">    aln_seq1, aln_seq2, score, begin, end <span class="op">=</span> top_aln</a>
<a class="sourceLine" id="cb1658-27" title="27">    <span class="cf">return</span> aln_seq1, aln_seq2</a>
<a class="sourceLine" id="cb1658-28" title="28"></a>
<a class="sourceLine" id="cb1658-29" title="29">seq1 <span class="op">=</span> Seq(<span class="st">&#39;EEKG&#39;</span>)</a>
<a class="sourceLine" id="cb1658-30" title="30">seq2 <span class="op">=</span> Seq(<span class="st">&#39;SSSDEKA&#39;</span>)</a>
<a class="sourceLine" id="cb1658-31" title="31">a <span class="op">=</span> align(seq1, seq2)</a>
<a class="sourceLine" id="cb1658-32" title="32">result <span class="op">=</span> a[<span class="dv">0</span>] <span class="op">==</span> <span class="st">&#39;---EEKG&#39;</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-150">Run 4</h4>
<div class="sourceCode" id="cb1660"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1660-1" title="1"><span class="im">from</span> Bio <span class="im">import</span> SeqIO</a>
<a class="sourceLine" id="cb1660-2" title="2"><span class="im">from</span> Bio <span class="im">import</span> Align</a>
<a class="sourceLine" id="cb1660-3" title="3"><span class="im">from</span> Bio <span class="im">import</span> PopGen</a>
<a class="sourceLine" id="cb1660-4" title="4"><span class="im">from</span> Bio.PDB <span class="im">import</span> <span class="op">*</span></a>
<a class="sourceLine" id="cb1660-5" title="5"><span class="im">from</span> Bio.Seq <span class="im">import</span> Seq</a>
<a class="sourceLine" id="cb1660-6" title="6"><span class="im">import</span> Bio</a>
<a class="sourceLine" id="cb1660-7" title="7"><span class="im">from</span> Bio <span class="im">import</span> pairwise2</a>
<a class="sourceLine" id="cb1660-8" title="8"><span class="im">from</span> Bio.Blast <span class="im">import</span> NCBIWWW, NCBIXML</a>
<a class="sourceLine" id="cb1660-9" title="9"><span class="im">from</span> Bio.SubsMat <span class="im">import</span> MatrixInfo <span class="im">as</span> matlist</a>
<a class="sourceLine" id="cb1660-10" title="10"></a>
<a class="sourceLine" id="cb1660-11" title="11"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1660-12" title="12"><span class="co">print biopython version</span></a>
<a class="sourceLine" id="cb1660-13" title="13"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1660-14" title="14"><span class="bu">print</span>(Bio.__version__)</a>
<a class="sourceLine" id="cb1660-15" title="15"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1660-16" title="16"></a>
<a class="sourceLine" id="cb1660-17" title="17"><span class="kw">def</span> align(seq1, seq2):</a>
<a class="sourceLine" id="cb1660-18" title="18">    <span class="co">&#39;&#39;&#39;</span></a>
<a class="sourceLine" id="cb1660-19" title="19"><span class="co">    Align the two amino acid sequences with BLOSUM62 and return aligned sequences</span></a>
<a class="sourceLine" id="cb1660-20" title="20"><span class="co">    &#39;&#39;&#39;</span></a>
<a class="sourceLine" id="cb1660-21" title="21">    matrix <span class="op">=</span> matlist.blosum62</a>
<a class="sourceLine" id="cb1660-22" title="22">    gap_open <span class="op">=</span> <span class="dv">-10</span></a>
<a class="sourceLine" id="cb1660-23" title="23">    gap_extend <span class="op">=</span> <span class="fl">-0.5</span></a>
<a class="sourceLine" id="cb1660-24" title="24">    alns <span class="op">=</span> pairwise2.align.globalds(seq1, seq2, matrix, gap_open, gap_extend)</a>
<a class="sourceLine" id="cb1660-25" title="25">    <span class="cf">return</span> alns</a>
<a class="sourceLine" id="cb1660-26" title="26"></a>
<a class="sourceLine" id="cb1660-27" title="27"></a>
<a class="sourceLine" id="cb1660-28" title="28">seq1 <span class="op">=</span> Seq(<span class="st">&#39;EEKG&#39;</span>)</a>
<a class="sourceLine" id="cb1660-29" title="29">seq2 <span class="op">=</span> Seq(<span class="st">&#39;SSSDEKA&#39;</span>)</a>
<a class="sourceLine" id="cb1660-30" title="30">a <span class="op">=</span> align(seq1, seq2)</a>
<a class="sourceLine" id="cb1660-31" title="31">result <span class="op">=</span> a[<span class="dv">0</span>] <span class="op">==</span> <span class="st">&#39;---EEKG&#39;</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>seq-trans</summary></p>
<h4 id="query-151">Query</h4>
<div class="sourceCode" id="cb1662"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1662-1" title="1"><span class="im">from</span> Bio <span class="im">import</span> SeqIO</a>
<a class="sourceLine" id="cb1662-2" title="2"><span class="im">from</span> Bio <span class="im">import</span> Align</a>
<a class="sourceLine" id="cb1662-3" title="3"><span class="im">from</span> Bio <span class="im">import</span> PopGen</a>
<a class="sourceLine" id="cb1662-4" title="4"><span class="im">from</span> Bio.PDB <span class="im">import</span> <span class="op">*</span></a>
<a class="sourceLine" id="cb1662-5" title="5"><span class="im">from</span> Bio.Seq <span class="im">import</span> Seq</a>
<a class="sourceLine" id="cb1662-6" title="6"><span class="im">import</span> Bio</a>
<a class="sourceLine" id="cb1662-7" title="7"><span class="im">from</span> Bio <span class="im">import</span> pairwise2</a>
<a class="sourceLine" id="cb1662-8" title="8"><span class="im">from</span> Bio.Blast <span class="im">import</span> NCBIWWW, NCBIXML</a>
<a class="sourceLine" id="cb1662-9" title="9"><span class="im">from</span> Bio.SubsMat <span class="im">import</span> MatrixInfo <span class="im">as</span> matlist</a>
<a class="sourceLine" id="cb1662-10" title="10"></a>
<a class="sourceLine" id="cb1662-11" title="11"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1662-12" title="12"><span class="co">print biopython version</span></a>
<a class="sourceLine" id="cb1662-13" title="13"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1662-14" title="14"><span class="bu">print</span>(Bio.__version__)</a>
<a class="sourceLine" id="cb1662-15" title="15"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1662-16" title="16"></a>
<a class="sourceLine" id="cb1662-17" title="17"><span class="kw">def</span> nucleotide_translate(gene_seq):</a>
<a class="sourceLine" id="cb1662-18" title="18">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1662-19" title="19"><span class="co">  Converts nucleotide sequence to amino acids. Returns a string</span></a>
<a class="sourceLine" id="cb1662-20" title="20"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1662-21" title="21">  </a></code></pre></div>
<h4 id="run-0-151">Run 0</h4>
<div class="sourceCode" id="cb1663"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1663-1" title="1"><span class="im">from</span> Bio <span class="im">import</span> SeqIO</a>
<a class="sourceLine" id="cb1663-2" title="2"><span class="im">from</span> Bio <span class="im">import</span> Align</a>
<a class="sourceLine" id="cb1663-3" title="3"><span class="im">from</span> Bio <span class="im">import</span> PopGen</a>
<a class="sourceLine" id="cb1663-4" title="4"><span class="im">from</span> Bio.PDB <span class="im">import</span> <span class="op">*</span></a>
<a class="sourceLine" id="cb1663-5" title="5"><span class="im">from</span> Bio.Seq <span class="im">import</span> Seq</a>
<a class="sourceLine" id="cb1663-6" title="6"><span class="im">import</span> Bio</a>
<a class="sourceLine" id="cb1663-7" title="7"><span class="im">from</span> Bio <span class="im">import</span> pairwise2</a>
<a class="sourceLine" id="cb1663-8" title="8"><span class="im">from</span> Bio.Blast <span class="im">import</span> NCBIWWW, NCBIXML</a>
<a class="sourceLine" id="cb1663-9" title="9"><span class="im">from</span> Bio.SubsMat <span class="im">import</span> MatrixInfo <span class="im">as</span> matlist</a>
<a class="sourceLine" id="cb1663-10" title="10"></a>
<a class="sourceLine" id="cb1663-11" title="11"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1663-12" title="12"><span class="co">print biopython version</span></a>
<a class="sourceLine" id="cb1663-13" title="13"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1663-14" title="14"><span class="bu">print</span>(Bio.__version__)</a>
<a class="sourceLine" id="cb1663-15" title="15"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1663-16" title="16"></a>
<a class="sourceLine" id="cb1663-17" title="17"><span class="kw">def</span> nucleotide_translate(gene_seq):</a>
<a class="sourceLine" id="cb1663-18" title="18">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1663-19" title="19"><span class="co">  Converts nucleotide sequence to amino acids. Returns a string</span></a>
<a class="sourceLine" id="cb1663-20" title="20"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1663-21" title="21">  gene_seq <span class="op">=</span> Seq(gene_seq)</a>
<a class="sourceLine" id="cb1663-22" title="22">  <span class="cf">return</span> <span class="bu">str</span>(gene_seq.translate())</a>
<a class="sourceLine" id="cb1663-23" title="23"></a>
<a class="sourceLine" id="cb1663-24" title="24">ns <span class="op">=</span> <span class="st">&#39;atgaggtctttgctaatcttggtgctttgcttcctgcccctggctgctctggggaaagtctttggacgatgtgagctggcagcggctatgaagcgtcacggacttgataactatcggggatacagcctgggaaactgggtgtgtgctgcaaaattcgagagtaacttcaacacccaggctacaaaccgtaacaccgatgggagtaccgactacggaatcctacagatcaacagccgctggtggtgcaacgatggcaggaccccaggctccaggaacctgtgcaacatcccgtgctcagccctgctgagctcagacataacagcgagcgtgaactgcgcgaagaagatcgtcagcgatggaaacggcatgaacgcgtgggtcgcctggcgcaaccgctgcaagggcaccgacgtccaggcgtggatcagaggctgccggctgtga&#39;</span></a>
<a class="sourceLine" id="cb1663-25" title="25">ps <span class="op">=</span> <span class="st">&#39;MRSLLILVLCFLPLAALGKVFGRCELAAAMKRHGLDNYRGYSLGNWVCAAKFESNFNTQATNRNTDGSTDYGILQINSRWWCNDGRTPGSRNLCNIPCSALLSSDITASVNCAKKIVSDGNGMNAWVAWRNRCKGTDVQAWIRGCRL&#39;</span></a>
<a class="sourceLine" id="cb1663-26" title="26">tps <span class="op">=</span> nucleotide_translate(ns)</a>
<a class="sourceLine" id="cb1663-27" title="27">result <span class="op">=</span> ps <span class="kw">in</span> tps</a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-151">Run 1</h4>
<div class="sourceCode" id="cb1665"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1665-1" title="1"><span class="im">from</span> Bio <span class="im">import</span> SeqIO</a>
<a class="sourceLine" id="cb1665-2" title="2"><span class="im">from</span> Bio <span class="im">import</span> Align</a>
<a class="sourceLine" id="cb1665-3" title="3"><span class="im">from</span> Bio <span class="im">import</span> PopGen</a>
<a class="sourceLine" id="cb1665-4" title="4"><span class="im">from</span> Bio.PDB <span class="im">import</span> <span class="op">*</span></a>
<a class="sourceLine" id="cb1665-5" title="5"><span class="im">from</span> Bio.Seq <span class="im">import</span> Seq</a>
<a class="sourceLine" id="cb1665-6" title="6"><span class="im">import</span> Bio</a>
<a class="sourceLine" id="cb1665-7" title="7"><span class="im">from</span> Bio <span class="im">import</span> pairwise2</a>
<a class="sourceLine" id="cb1665-8" title="8"><span class="im">from</span> Bio.Blast <span class="im">import</span> NCBIWWW, NCBIXML</a>
<a class="sourceLine" id="cb1665-9" title="9"><span class="im">from</span> Bio.SubsMat <span class="im">import</span> MatrixInfo <span class="im">as</span> matlist</a>
<a class="sourceLine" id="cb1665-10" title="10"></a>
<a class="sourceLine" id="cb1665-11" title="11"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1665-12" title="12"><span class="co">print biopython version</span></a>
<a class="sourceLine" id="cb1665-13" title="13"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1665-14" title="14"><span class="bu">print</span>(Bio.__version__)</a>
<a class="sourceLine" id="cb1665-15" title="15"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1665-16" title="16"></a>
<a class="sourceLine" id="cb1665-17" title="17"><span class="kw">def</span> nucleotide_translate(gene_seq):</a>
<a class="sourceLine" id="cb1665-18" title="18">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1665-19" title="19"><span class="co">  Converts nucleotide sequence to amino acids. Returns a string</span></a>
<a class="sourceLine" id="cb1665-20" title="20"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1665-21" title="21">  <span class="cf">return</span> Seq(gene_seq).translate()</a>
<a class="sourceLine" id="cb1665-22" title="22"></a>
<a class="sourceLine" id="cb1665-23" title="23">ns <span class="op">=</span> <span class="st">&#39;atgaggtctttgctaatcttggtgctttgcttcctgcccctggctgctctggggaaagtctttggacgatgtgagctggcagcggctatgaagcgtcacggacttgataactatcggggatacagcctgggaaactgggtgtgtgctgcaaaattcgagagtaacttcaacacccaggctacaaaccgtaacaccgatgggagtaccgactacggaatcctacagatcaacagccgctggtggtgcaacgatggcaggaccccaggctccaggaacctgtgcaacatcccgtgctcagccctgctgagctcagacataacagcgagcgtgaactgcgcgaagaagatcgtcagcgatggaaacggcatgaacgcgtgggtcgcctggcgcaaccgctgcaagggcaccgacgtccaggcgtggatcagaggctgccggctgtga&#39;</span></a>
<a class="sourceLine" id="cb1665-24" title="24">ps <span class="op">=</span> <span class="st">&#39;MRSLLILVLCFLPLAALGKVFGRCELAAAMKRHGLDNYRGYSLGNWVCAAKFESNFNTQATNRNTDGSTDYGILQINSRWWCNDGRTPGSRNLCNIPCSALLSSDITASVNCAKKIVSDGNGMNAWVAWRNRCKGTDVQAWIRGCRL&#39;</span></a>
<a class="sourceLine" id="cb1665-25" title="25">tps <span class="op">=</span> nucleotide_translate(ns)</a>
<a class="sourceLine" id="cb1665-26" title="26">result <span class="op">=</span> ps <span class="kw">in</span> tps</a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-151">Run 2</h4>
<div class="sourceCode" id="cb1667"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1667-1" title="1"><span class="im">from</span> Bio <span class="im">import</span> SeqIO</a>
<a class="sourceLine" id="cb1667-2" title="2"><span class="im">from</span> Bio <span class="im">import</span> Align</a>
<a class="sourceLine" id="cb1667-3" title="3"><span class="im">from</span> Bio <span class="im">import</span> PopGen</a>
<a class="sourceLine" id="cb1667-4" title="4"><span class="im">from</span> Bio.PDB <span class="im">import</span> <span class="op">*</span></a>
<a class="sourceLine" id="cb1667-5" title="5"><span class="im">from</span> Bio.Seq <span class="im">import</span> Seq</a>
<a class="sourceLine" id="cb1667-6" title="6"><span class="im">import</span> Bio</a>
<a class="sourceLine" id="cb1667-7" title="7"><span class="im">from</span> Bio <span class="im">import</span> pairwise2</a>
<a class="sourceLine" id="cb1667-8" title="8"><span class="im">from</span> Bio.Blast <span class="im">import</span> NCBIWWW, NCBIXML</a>
<a class="sourceLine" id="cb1667-9" title="9"><span class="im">from</span> Bio.SubsMat <span class="im">import</span> MatrixInfo <span class="im">as</span> matlist</a>
<a class="sourceLine" id="cb1667-10" title="10"></a>
<a class="sourceLine" id="cb1667-11" title="11"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1667-12" title="12"><span class="co">print biopython version</span></a>
<a class="sourceLine" id="cb1667-13" title="13"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1667-14" title="14"><span class="bu">print</span>(Bio.__version__)</a>
<a class="sourceLine" id="cb1667-15" title="15"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1667-16" title="16"></a>
<a class="sourceLine" id="cb1667-17" title="17"><span class="kw">def</span> nucleotide_translate(gene_seq):</a>
<a class="sourceLine" id="cb1667-18" title="18">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1667-19" title="19"><span class="co">  Converts nucleotide sequence to amino acids. Returns a string</span></a>
<a class="sourceLine" id="cb1667-20" title="20"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1667-21" title="21">  <span class="cf">return</span> Seq(gene_seq).translate()</a>
<a class="sourceLine" id="cb1667-22" title="22"></a>
<a class="sourceLine" id="cb1667-23" title="23">ns <span class="op">=</span> <span class="st">&#39;atgaggtctttgctaatcttggtgctttgcttcctgcccctggctgctctggggaaagtctttggacgatgtgagctggcagcggctatgaagcgtcacggacttgataactatcggggatacagcctgggaaactgggtgtgtgctgcaaaattcgagagtaacttcaacacccaggctacaaaccgtaacaccgatgggagtaccgactacggaatcctacagatcaacagccgctggtggtgcaacgatggcaggaccccaggctccaggaacctgtgcaacatcccgtgctcagccctgctgagctcagacataacagcgagcgtgaactgcgcgaagaagatcgtcagcgatggaaacggcatgaacgcgtgggtcgcctggcgcaaccgctgcaagggcaccgacgtccaggcgtggatcagaggctgccggctgtga&#39;</span></a>
<a class="sourceLine" id="cb1667-24" title="24">ps <span class="op">=</span> <span class="st">&#39;MRSLLILVLCFLPLAALGKVFGRCELAAAMKRHGLDNYRGYSLGNWVCAAKFESNFNTQATNRNTDGSTDYGILQINSRWWCNDGRTPGSRNLCNIPCSALLSSDITASVNCAKKIVSDGNGMNAWVAWRNRCKGTDVQAWIRGCRL&#39;</span></a>
<a class="sourceLine" id="cb1667-25" title="25">tps <span class="op">=</span> nucleotide_translate(ns)</a>
<a class="sourceLine" id="cb1667-26" title="26">result <span class="op">=</span> ps <span class="kw">in</span> tps</a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-151">Run 3</h4>
<div class="sourceCode" id="cb1669"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1669-1" title="1"><span class="im">from</span> Bio <span class="im">import</span> SeqIO</a>
<a class="sourceLine" id="cb1669-2" title="2"><span class="im">from</span> Bio <span class="im">import</span> Align</a>
<a class="sourceLine" id="cb1669-3" title="3"><span class="im">from</span> Bio <span class="im">import</span> PopGen</a>
<a class="sourceLine" id="cb1669-4" title="4"><span class="im">from</span> Bio.PDB <span class="im">import</span> <span class="op">*</span></a>
<a class="sourceLine" id="cb1669-5" title="5"><span class="im">from</span> Bio.Seq <span class="im">import</span> Seq</a>
<a class="sourceLine" id="cb1669-6" title="6"><span class="im">import</span> Bio</a>
<a class="sourceLine" id="cb1669-7" title="7"><span class="im">from</span> Bio <span class="im">import</span> pairwise2</a>
<a class="sourceLine" id="cb1669-8" title="8"><span class="im">from</span> Bio.Blast <span class="im">import</span> NCBIWWW, NCBIXML</a>
<a class="sourceLine" id="cb1669-9" title="9"><span class="im">from</span> Bio.SubsMat <span class="im">import</span> MatrixInfo <span class="im">as</span> matlist</a>
<a class="sourceLine" id="cb1669-10" title="10"></a>
<a class="sourceLine" id="cb1669-11" title="11"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1669-12" title="12"><span class="co">print biopython version</span></a>
<a class="sourceLine" id="cb1669-13" title="13"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1669-14" title="14"><span class="bu">print</span>(Bio.__version__)</a>
<a class="sourceLine" id="cb1669-15" title="15"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1669-16" title="16"></a>
<a class="sourceLine" id="cb1669-17" title="17"><span class="kw">def</span> nucleotide_translate(gene_seq):</a>
<a class="sourceLine" id="cb1669-18" title="18">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1669-19" title="19"><span class="co">  Converts nucleotide sequence to amino acids. Returns a string</span></a>
<a class="sourceLine" id="cb1669-20" title="20"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1669-21" title="21">  <span class="cf">return</span> Seq(gene_seq).translate()</a>
<a class="sourceLine" id="cb1669-22" title="22"></a>
<a class="sourceLine" id="cb1669-23" title="23">ns <span class="op">=</span> <span class="st">&#39;atgaggtctttgctaatcttggtgctttgcttcctgcccctggctgctctggggaaagtctttggacgatgtgagctggcagcggctatgaagcgtcacggacttgataactatcggggatacagcctgggaaactgggtgtgtgctgcaaaattcgagagtaacttcaacacccaggctacaaaccgtaacaccgatgggagtaccgactacggaatcctacagatcaacagccgctggtggtgcaacgatggcaggaccccaggctccaggaacctgtgcaacatcccgtgctcagccctgctgagctcagacataacagcgagcgtgaactgcgcgaagaagatcgtcagcgatggaaacggcatgaacgcgtgggtcgcctggcgcaaccgctgcaagggcaccgacgtccaggcgtggatcagaggctgccggctgtga&#39;</span></a>
<a class="sourceLine" id="cb1669-24" title="24">ps <span class="op">=</span> <span class="st">&#39;MRSLLILVLCFLPLAALGKVFGRCELAAAMKRHGLDNYRGYSLGNWVCAAKFESNFNTQATNRNTDGSTDYGILQINSRWWCNDGRTPGSRNLCNIPCSALLSSDITASVNCAKKIVSDGNGMNAWVAWRNRCKGTDVQAWIRGCRL&#39;</span></a>
<a class="sourceLine" id="cb1669-25" title="25">tps <span class="op">=</span> nucleotide_translate(ns)</a>
<a class="sourceLine" id="cb1669-26" title="26">result <span class="op">=</span> ps <span class="kw">in</span> tps</a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-151">Run 4</h4>
<div class="sourceCode" id="cb1671"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1671-1" title="1"><span class="im">from</span> Bio <span class="im">import</span> SeqIO</a>
<a class="sourceLine" id="cb1671-2" title="2"><span class="im">from</span> Bio <span class="im">import</span> Align</a>
<a class="sourceLine" id="cb1671-3" title="3"><span class="im">from</span> Bio <span class="im">import</span> PopGen</a>
<a class="sourceLine" id="cb1671-4" title="4"><span class="im">from</span> Bio.PDB <span class="im">import</span> <span class="op">*</span></a>
<a class="sourceLine" id="cb1671-5" title="5"><span class="im">from</span> Bio.Seq <span class="im">import</span> Seq</a>
<a class="sourceLine" id="cb1671-6" title="6"><span class="im">import</span> Bio</a>
<a class="sourceLine" id="cb1671-7" title="7"><span class="im">from</span> Bio <span class="im">import</span> pairwise2</a>
<a class="sourceLine" id="cb1671-8" title="8"><span class="im">from</span> Bio.Blast <span class="im">import</span> NCBIWWW, NCBIXML</a>
<a class="sourceLine" id="cb1671-9" title="9"><span class="im">from</span> Bio.SubsMat <span class="im">import</span> MatrixInfo <span class="im">as</span> matlist</a>
<a class="sourceLine" id="cb1671-10" title="10"></a>
<a class="sourceLine" id="cb1671-11" title="11"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1671-12" title="12"><span class="co">print biopython version</span></a>
<a class="sourceLine" id="cb1671-13" title="13"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1671-14" title="14"><span class="bu">print</span>(Bio.__version__)</a>
<a class="sourceLine" id="cb1671-15" title="15"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1671-16" title="16"></a>
<a class="sourceLine" id="cb1671-17" title="17"><span class="kw">def</span> nucleotide_translate(gene_seq):</a>
<a class="sourceLine" id="cb1671-18" title="18">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1671-19" title="19"><span class="co">  Converts nucleotide sequence to amino acids. Returns a string</span></a>
<a class="sourceLine" id="cb1671-20" title="20"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1671-21" title="21">  <span class="cf">return</span> Seq(gene_seq).translate()</a>
<a class="sourceLine" id="cb1671-22" title="22"></a>
<a class="sourceLine" id="cb1671-23" title="23">ns <span class="op">=</span> <span class="st">&#39;atgaggtctttgctaatcttggtgctttgcttcctgcccctggctgctctggggaaagtctttggacgatgtgagctggcagcggctatgaagcgtcacggacttgataactatcggggatacagcctgggaaactgggtgtgtgctgcaaaattcgagagtaacttcaacacccaggctacaaaccgtaacaccgatgggagtaccgactacggaatcctacagatcaacagccgctggtggtgcaacgatggcaggaccccaggctccaggaacctgtgcaacatcccgtgctcagccctgctgagctcagacataacagcgagcgtgaactgcgcgaagaagatcgtcagcgatggaaacggcatgaacgcgtgggtcgcctggcgcaaccgctgcaagggcaccgacgtccaggcgtggatcagaggctgccggctgtga&#39;</span></a>
<a class="sourceLine" id="cb1671-24" title="24">ps <span class="op">=</span> <span class="st">&#39;MRSLLILVLCFLPLAALGKVFGRCELAAAMKRHGLDNYRGYSLGNWVCAAKFESNFNTQATNRNTDGSTDYGILQINSRWWCNDGRTPGSRNLCNIPCSALLSSDITASVNCAKKIVSDGNGMNAWVAWRNRCKGTDVQAWIRGCRL&#39;</span></a>
<a class="sourceLine" id="cb1671-25" title="25">tps <span class="op">=</span> nucleotide_translate(ns)</a>
<a class="sourceLine" id="cb1671-26" title="26">result <span class="op">=</span> ps <span class="kw">in</span> tps</a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>sequence</summary></p>
<h4 id="query-152">Query</h4>
<div class="sourceCode" id="cb1673"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1673-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1673-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1673-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1673-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1673-5" title="5"></a>
<a class="sourceLine" id="cb1673-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1673-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1673-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1673-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1673-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1673-11" title="11"></a>
<a class="sourceLine" id="cb1673-12" title="12"><span class="kw">def</span> gen_geometric_sequence(s,e,l):</a>
<a class="sourceLine" id="cb1673-13" title="13">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1673-14" title="14"><span class="co">    This function return a geometric sequence that starts at s, ends at e with length l</span></a>
<a class="sourceLine" id="cb1673-15" title="15"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1673-16" title="16">    </a></code></pre></div>
<h4 id="run-0-152">Run 0</h4>
<div class="sourceCode" id="cb1674"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1674-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1674-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1674-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1674-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1674-5" title="5"></a>
<a class="sourceLine" id="cb1674-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1674-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1674-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1674-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1674-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1674-11" title="11"></a>
<a class="sourceLine" id="cb1674-12" title="12"><span class="kw">def</span> gen_geometric_sequence(s,e,l):</a>
<a class="sourceLine" id="cb1674-13" title="13">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1674-14" title="14"><span class="co">    This function return a geometric sequence that starts at s, ends at e with length l</span></a>
<a class="sourceLine" id="cb1674-15" title="15"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1674-16" title="16">    <span class="cf">return</span> np.linspace(s,e,l)</a>
<a class="sourceLine" id="cb1674-17" title="17"></a>
<a class="sourceLine" id="cb1674-18" title="18">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">all</span>(gen_geometric_sequence(<span class="dv">1</span>,<span class="dv">100</span>,<span class="dv">3</span>)<span class="op">==</span> [<span class="dv">1</span>,<span class="dv">10</span>,<span class="dv">100</span>]) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-152">Run 1</h4>
<div class="sourceCode" id="cb1676"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1676-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1676-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1676-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1676-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1676-5" title="5"></a>
<a class="sourceLine" id="cb1676-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1676-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1676-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1676-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1676-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1676-11" title="11"></a>
<a class="sourceLine" id="cb1676-12" title="12"><span class="kw">def</span> gen_geometric_sequence(s,e,l):</a>
<a class="sourceLine" id="cb1676-13" title="13">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1676-14" title="14"><span class="co">    This function return a geometric sequence that starts at s, ends at e with length l</span></a>
<a class="sourceLine" id="cb1676-15" title="15"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1676-16" title="16">    <span class="cf">return</span> np.geomspace(s,e,l)</a>
<a class="sourceLine" id="cb1676-17" title="17"></a>
<a class="sourceLine" id="cb1676-18" title="18">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">all</span>(gen_geometric_sequence(<span class="dv">1</span>,<span class="dv">100</span>,<span class="dv">3</span>)<span class="op">==</span> [<span class="dv">1</span>,<span class="dv">10</span>,<span class="dv">100</span>]) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-152">Run 2</h4>
<div class="sourceCode" id="cb1678"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1678-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1678-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1678-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1678-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1678-5" title="5"></a>
<a class="sourceLine" id="cb1678-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1678-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1678-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1678-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1678-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1678-11" title="11"></a>
<a class="sourceLine" id="cb1678-12" title="12"><span class="kw">def</span> gen_geometric_sequence(s,e,l):</a>
<a class="sourceLine" id="cb1678-13" title="13">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1678-14" title="14"><span class="co">    This function return a geometric sequence that starts at s, ends at e with length l</span></a>
<a class="sourceLine" id="cb1678-15" title="15"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1678-16" title="16">    <span class="cf">return</span> np.logspace(np.log10(s), np.log10(e), l)</a>
<a class="sourceLine" id="cb1678-17" title="17"></a>
<a class="sourceLine" id="cb1678-18" title="18">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">all</span>(gen_geometric_sequence(<span class="dv">1</span>,<span class="dv">100</span>,<span class="dv">3</span>)<span class="op">==</span> [<span class="dv">1</span>,<span class="dv">10</span>,<span class="dv">100</span>]) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-152">Run 3</h4>
<div class="sourceCode" id="cb1680"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1680-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1680-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1680-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1680-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1680-5" title="5"></a>
<a class="sourceLine" id="cb1680-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1680-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1680-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1680-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1680-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1680-11" title="11"></a>
<a class="sourceLine" id="cb1680-12" title="12"><span class="kw">def</span> gen_geometric_sequence(s,e,l):</a>
<a class="sourceLine" id="cb1680-13" title="13">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1680-14" title="14"><span class="co">    This function return a geometric sequence that starts at s, ends at e with length l</span></a>
<a class="sourceLine" id="cb1680-15" title="15"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1680-16" title="16">    <span class="cf">return</span> np.logspace(np.log10(s), np.log10(e), l)</a>
<a class="sourceLine" id="cb1680-17" title="17"></a>
<a class="sourceLine" id="cb1680-18" title="18">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">all</span>(gen_geometric_sequence(<span class="dv">1</span>,<span class="dv">100</span>,<span class="dv">3</span>)<span class="op">==</span> [<span class="dv">1</span>,<span class="dv">10</span>,<span class="dv">100</span>]) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-152">Run 4</h4>
<div class="sourceCode" id="cb1682"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1682-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1682-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1682-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1682-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1682-5" title="5"></a>
<a class="sourceLine" id="cb1682-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1682-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1682-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1682-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1682-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1682-11" title="11"></a>
<a class="sourceLine" id="cb1682-12" title="12"><span class="kw">def</span> gen_geometric_sequence(s,e,l):</a>
<a class="sourceLine" id="cb1682-13" title="13">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1682-14" title="14"><span class="co">    This function return a geometric sequence that starts at s, ends at e with length l</span></a>
<a class="sourceLine" id="cb1682-15" title="15"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1682-16" title="16">    <span class="cf">return</span> np.logspace(np.log10(s), np.log10(e), l)</a>
<a class="sourceLine" id="cb1682-17" title="17"></a>
<a class="sourceLine" id="cb1682-18" title="18">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.<span class="bu">all</span>(gen_geometric_sequence(<span class="dv">1</span>,<span class="dv">100</span>,<span class="dv">3</span>)<span class="op">==</span> [<span class="dv">1</span>,<span class="dv">10</span>,<span class="dv">100</span>]) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>sle</summary></p>
<h4 id="query-153">Query</h4>
<div class="sourceCode" id="cb1684"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1684-1" title="1"><span class="im">import</span> sympy</a>
<a class="sourceLine" id="cb1684-2" title="2"></a>
<a class="sourceLine" id="cb1684-3" title="3"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1684-4" title="4"><span class="co">print sympy version</span></a>
<a class="sourceLine" id="cb1684-5" title="5"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1684-6" title="6"><span class="bu">print</span>(sympy.__version__)</a>
<a class="sourceLine" id="cb1684-7" title="7"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1684-8" title="8"></a>
<a class="sourceLine" id="cb1684-9" title="9"><span class="kw">def</span> sle(eqns):</a>
<a class="sourceLine" id="cb1684-10" title="10">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1684-11" title="11"><span class="co">  This function solves a system of linear equations {[&#39;a_0x_0 + b_0x_1 = c0&#39;,&#39;a_1x_0 + b_1x_1 = c1&#39;]}.</span></a>
<a class="sourceLine" id="cb1684-12" title="12"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1684-13" title="13">  </a></code></pre></div>
<h4 id="run-0-153">Run 0</h4>
<div class="sourceCode" id="cb1685"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1685-1" title="1"><span class="im">import</span> sympy</a>
<a class="sourceLine" id="cb1685-2" title="2"></a>
<a class="sourceLine" id="cb1685-3" title="3"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1685-4" title="4"><span class="co">print sympy version</span></a>
<a class="sourceLine" id="cb1685-5" title="5"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1685-6" title="6"><span class="bu">print</span>(sympy.__version__)</a>
<a class="sourceLine" id="cb1685-7" title="7"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1685-8" title="8"></a>
<a class="sourceLine" id="cb1685-9" title="9"><span class="kw">def</span> sle(eqns):</a>
<a class="sourceLine" id="cb1685-10" title="10">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1685-11" title="11"><span class="co">  This function solves a system of linear equations {[&#39;a_0x_0 + b_0x_1 = c0&#39;,&#39;a_1x_0 + b_1x_1 = c1&#39;]}.</span></a>
<a class="sourceLine" id="cb1685-12" title="12"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1685-13" title="13">  <span class="co"># create a list of symbols</span></a>
<a class="sourceLine" id="cb1685-14" title="14">  x <span class="op">=</span> sympy.symbols(<span class="st">&#39;x:</span><span class="sc">%d</span><span class="st">&#39;</span> <span class="op">%</span> <span class="bu">len</span>(eqns))</a>
<a class="sourceLine" id="cb1685-15" title="15">  <span class="co"># create a list of equations</span></a>
<a class="sourceLine" id="cb1685-16" title="16">  eqs <span class="op">=</span> [sympy.sympify(eq) <span class="cf">for</span> eq <span class="kw">in</span> eqns]</a>
<a class="sourceLine" id="cb1685-17" title="17">  <span class="co"># solve the system of equations</span></a>
<a class="sourceLine" id="cb1685-18" title="18">  sol <span class="op">=</span> sympy.solve(eqs, x)</a>
<a class="sourceLine" id="cb1685-19" title="19">  <span class="co"># return the solution</span></a>
<a class="sourceLine" id="cb1685-20" title="20">  <span class="cf">return</span> sol</a>
<a class="sourceLine" id="cb1685-21" title="21"></a>
<a class="sourceLine" id="cb1685-22" title="22"><span class="im">from</span> sympy <span class="im">import</span> solve, Eq</a>
<a class="sourceLine" id="cb1685-23" title="23"><span class="im">from</span> sympy.parsing.sympy_parser <span class="im">import</span> parse_expr</a>
<a class="sourceLine" id="cb1685-24" title="24"><span class="im">from</span> sympy.parsing.sympy_parser <span class="im">import</span> standard_transformations, implicit_multiplication_application</a>
<a class="sourceLine" id="cb1685-25" title="25"></a>
<a class="sourceLine" id="cb1685-26" title="26">eqns <span class="op">=</span> [<span class="st">&#39;4x + 3y = 20&#39;</span>, <span class="st">&#39;-5x + 9y = 26&#39;</span>]</a>
<a class="sourceLine" id="cb1685-27" title="27">transformations <span class="op">=</span> (standard_transformations <span class="op">+</span></a>
<a class="sourceLine" id="cb1685-28" title="28">                   (implicit_multiplication_application,))</a>
<a class="sourceLine" id="cb1685-29" title="29">parsed_eqs <span class="op">=</span> []</a>
<a class="sourceLine" id="cb1685-30" title="30"><span class="cf">for</span> eq <span class="kw">in</span> eqns:</a>
<a class="sourceLine" id="cb1685-31" title="31">        sides <span class="op">=</span> [parse_expr(s, transformations<span class="op">=</span>transformations)</a>
<a class="sourceLine" id="cb1685-32" title="32">                <span class="cf">for</span> s <span class="kw">in</span> eq.split(<span class="st">&#39;=&#39;</span>)]</a>
<a class="sourceLine" id="cb1685-33" title="33">        parsed_eqs.append(Eq(sides[<span class="dv">0</span>], sides[<span class="dv">1</span>]))</a>
<a class="sourceLine" id="cb1685-34" title="34">soln <span class="op">=</span> solve(parsed_eqs)</a>
<a class="sourceLine" id="cb1685-35" title="35">test_sol_values <span class="op">=</span> [soln.get(<span class="bu">list</span>(soln.keys())[<span class="dv">0</span>]), soln.get(<span class="bu">list</span>(soln.keys())[<span class="dv">1</span>])]</a>
<a class="sourceLine" id="cb1685-36" title="36"></a>
<a class="sourceLine" id="cb1685-37" title="37">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> <span class="bu">list</span>(sle(eqns).values()) <span class="op">==</span> test_sol_values <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Sympify of expression &#39;could not parse &#39;4x + 3y = 20&#39;&#39; failed, because of exception being raised:
SyntaxError: invalid syntax (&lt;string&gt;, line 1)</code></pre>
<h4 id="run-1-153">Run 1</h4>
<div class="sourceCode" id="cb1687"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1687-1" title="1"><span class="im">import</span> sympy</a>
<a class="sourceLine" id="cb1687-2" title="2"></a>
<a class="sourceLine" id="cb1687-3" title="3"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1687-4" title="4"><span class="co">print sympy version</span></a>
<a class="sourceLine" id="cb1687-5" title="5"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1687-6" title="6"><span class="bu">print</span>(sympy.__version__)</a>
<a class="sourceLine" id="cb1687-7" title="7"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1687-8" title="8"></a>
<a class="sourceLine" id="cb1687-9" title="9"><span class="kw">def</span> sle(eqns):</a>
<a class="sourceLine" id="cb1687-10" title="10">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1687-11" title="11"><span class="co">  This function solves a system of linear equations {[&#39;a_0x_0 + b_0x_1 = c0&#39;,&#39;a_1x_0 + b_1x_1 = c1&#39;]}.</span></a>
<a class="sourceLine" id="cb1687-12" title="12"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1687-13" title="13">  <span class="co"># create a list of variables</span></a>
<a class="sourceLine" id="cb1687-14" title="14">  <span class="bu">vars</span> <span class="op">=</span> []</a>
<a class="sourceLine" id="cb1687-15" title="15">  <span class="cf">for</span> eqn <span class="kw">in</span> eqns:</a>
<a class="sourceLine" id="cb1687-16" title="16">    <span class="cf">for</span> var <span class="kw">in</span> eqn.split(<span class="st">&#39;+&#39;</span>):</a>
<a class="sourceLine" id="cb1687-17" title="17">      var <span class="op">=</span> var.split(<span class="st">&#39;-&#39;</span>)[<span class="op">-</span><span class="dv">1</span>]</a>
<a class="sourceLine" id="cb1687-18" title="18">      var <span class="op">=</span> var.split(<span class="st">&#39;=&#39;</span>)[<span class="dv">0</span>]</a>
<a class="sourceLine" id="cb1687-19" title="19">      var <span class="op">=</span> var.strip()</a>
<a class="sourceLine" id="cb1687-20" title="20">      var <span class="op">=</span> var.split(<span class="st">&#39;*&#39;</span>)[<span class="op">-</span><span class="dv">1</span>]</a>
<a class="sourceLine" id="cb1687-21" title="21">      var <span class="op">=</span> var.strip()</a>
<a class="sourceLine" id="cb1687-22" title="22">      <span class="cf">if</span> var <span class="kw">not</span> <span class="kw">in</span> <span class="bu">vars</span>:</a>
<a class="sourceLine" id="cb1687-23" title="23">        <span class="bu">vars</span>.append(var)</a>
<a class="sourceLine" id="cb1687-24" title="24">  </a>
<a class="sourceLine" id="cb1687-25" title="25"><span class="im">from</span> sympy <span class="im">import</span> solve, Eq</a>
<a class="sourceLine" id="cb1687-26" title="26"><span class="im">from</span> sympy.parsing.sympy_parser <span class="im">import</span> parse_expr</a>
<a class="sourceLine" id="cb1687-27" title="27"><span class="im">from</span> sympy.parsing.sympy_parser <span class="im">import</span> standard_transformations, implicit_multiplication_application</a>
<a class="sourceLine" id="cb1687-28" title="28"></a>
<a class="sourceLine" id="cb1687-29" title="29">eqns <span class="op">=</span> [<span class="st">&#39;4x + 3y = 20&#39;</span>, <span class="st">&#39;-5x + 9y = 26&#39;</span>]</a>
<a class="sourceLine" id="cb1687-30" title="30">transformations <span class="op">=</span> (standard_transformations <span class="op">+</span></a>
<a class="sourceLine" id="cb1687-31" title="31">                   (implicit_multiplication_application,))</a>
<a class="sourceLine" id="cb1687-32" title="32">parsed_eqs <span class="op">=</span> []</a>
<a class="sourceLine" id="cb1687-33" title="33"><span class="cf">for</span> eq <span class="kw">in</span> eqns:</a>
<a class="sourceLine" id="cb1687-34" title="34">        sides <span class="op">=</span> [parse_expr(s, transformations<span class="op">=</span>transformations)</a>
<a class="sourceLine" id="cb1687-35" title="35">                <span class="cf">for</span> s <span class="kw">in</span> eq.split(<span class="st">&#39;=&#39;</span>)]</a>
<a class="sourceLine" id="cb1687-36" title="36">        parsed_eqs.append(Eq(sides[<span class="dv">0</span>], sides[<span class="dv">1</span>]))</a>
<a class="sourceLine" id="cb1687-37" title="37">soln <span class="op">=</span> solve(parsed_eqs)</a>
<a class="sourceLine" id="cb1687-38" title="38">test_sol_values <span class="op">=</span> [soln.get(<span class="bu">list</span>(soln.keys())[<span class="dv">0</span>]), soln.get(<span class="bu">list</span>(soln.keys())[<span class="dv">1</span>])]</a>
<a class="sourceLine" id="cb1687-39" title="39"></a>
<a class="sourceLine" id="cb1687-40" title="40">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> <span class="bu">list</span>(sle(eqns).values()) <span class="op">==</span> test_sol_values <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>&#39;NoneType&#39; object has no attribute &#39;values&#39;</code></pre>
<h4 id="run-2-153">Run 2</h4>
<div class="sourceCode" id="cb1689"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1689-1" title="1"><span class="im">import</span> sympy</a>
<a class="sourceLine" id="cb1689-2" title="2"></a>
<a class="sourceLine" id="cb1689-3" title="3"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1689-4" title="4"><span class="co">print sympy version</span></a>
<a class="sourceLine" id="cb1689-5" title="5"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1689-6" title="6"><span class="bu">print</span>(sympy.__version__)</a>
<a class="sourceLine" id="cb1689-7" title="7"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1689-8" title="8"></a>
<a class="sourceLine" id="cb1689-9" title="9"><span class="kw">def</span> sle(eqns):</a>
<a class="sourceLine" id="cb1689-10" title="10">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1689-11" title="11"><span class="co">  This function solves a system of linear equations {[&#39;a_0x_0 + b_0x_1 = c0&#39;,&#39;a_1x_0 + b_1x_1 = c1&#39;]}.</span></a>
<a class="sourceLine" id="cb1689-12" title="12"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1689-13" title="13">  <span class="co"># create a list of variables</span></a>
<a class="sourceLine" id="cb1689-14" title="14">  var <span class="op">=</span> []</a>
<a class="sourceLine" id="cb1689-15" title="15">  <span class="cf">for</span> eqn <span class="kw">in</span> eqns:</a>
<a class="sourceLine" id="cb1689-16" title="16">    var.append(sympy.symbols(eqn.split(<span class="st">&#39;=&#39;</span>)[<span class="dv">0</span>].replace(<span class="st">&#39; &#39;</span>,<span class="st">&#39;&#39;</span>).replace(<span class="st">&#39;+&#39;</span>,<span class="st">&#39;&#39;</span>).replace(<span class="st">&#39;-&#39;</span>,<span class="st">&#39;&#39;</span>)))</a>
<a class="sourceLine" id="cb1689-17" title="17">  <span class="co"># create a list of equations</span></a>
<a class="sourceLine" id="cb1689-18" title="18">  eqns <span class="op">=</span> []</a>
<a class="sourceLine" id="cb1689-19" title="19">  <span class="cf">for</span> eqn <span class="kw">in</span> eqns:</a>
<a class="sourceLine" id="cb1689-20" title="20">    eqns.append(sympy.sympify(eqn))</a>
<a class="sourceLine" id="cb1689-21" title="21">  <span class="co"># solve the system of linear equations</span></a>
<a class="sourceLine" id="cb1689-22" title="22">  sol <span class="op">=</span> sympy.solve(eqns,var)</a>
<a class="sourceLine" id="cb1689-23" title="23">  <span class="co"># return the solution</span></a>
<a class="sourceLine" id="cb1689-24" title="24">  <span class="cf">return</span> sol</a>
<a class="sourceLine" id="cb1689-25" title="25"></a>
<a class="sourceLine" id="cb1689-26" title="26"><span class="im">from</span> sympy <span class="im">import</span> solve, Eq</a>
<a class="sourceLine" id="cb1689-27" title="27"><span class="im">from</span> sympy.parsing.sympy_parser <span class="im">import</span> parse_expr</a>
<a class="sourceLine" id="cb1689-28" title="28"><span class="im">from</span> sympy.parsing.sympy_parser <span class="im">import</span> standard_transformations, implicit_multiplication_application</a>
<a class="sourceLine" id="cb1689-29" title="29"></a>
<a class="sourceLine" id="cb1689-30" title="30">eqns <span class="op">=</span> [<span class="st">&#39;4x + 3y = 20&#39;</span>, <span class="st">&#39;-5x + 9y = 26&#39;</span>]</a>
<a class="sourceLine" id="cb1689-31" title="31">transformations <span class="op">=</span> (standard_transformations <span class="op">+</span></a>
<a class="sourceLine" id="cb1689-32" title="32">                   (implicit_multiplication_application,))</a>
<a class="sourceLine" id="cb1689-33" title="33">parsed_eqs <span class="op">=</span> []</a>
<a class="sourceLine" id="cb1689-34" title="34"><span class="cf">for</span> eq <span class="kw">in</span> eqns:</a>
<a class="sourceLine" id="cb1689-35" title="35">        sides <span class="op">=</span> [parse_expr(s, transformations<span class="op">=</span>transformations)</a>
<a class="sourceLine" id="cb1689-36" title="36">                <span class="cf">for</span> s <span class="kw">in</span> eq.split(<span class="st">&#39;=&#39;</span>)]</a>
<a class="sourceLine" id="cb1689-37" title="37">        parsed_eqs.append(Eq(sides[<span class="dv">0</span>], sides[<span class="dv">1</span>]))</a>
<a class="sourceLine" id="cb1689-38" title="38">soln <span class="op">=</span> solve(parsed_eqs)</a>
<a class="sourceLine" id="cb1689-39" title="39">test_sol_values <span class="op">=</span> [soln.get(<span class="bu">list</span>(soln.keys())[<span class="dv">0</span>]), soln.get(<span class="bu">list</span>(soln.keys())[<span class="dv">1</span>])]</a>
<a class="sourceLine" id="cb1689-40" title="40"></a>
<a class="sourceLine" id="cb1689-41" title="41">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> <span class="bu">list</span>(sle(eqns).values()) <span class="op">==</span> test_sol_values <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>&#39;list&#39; object has no attribute &#39;values&#39;</code></pre>
<h4 id="run-3-153">Run 3</h4>
<div class="sourceCode" id="cb1691"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1691-1" title="1"><span class="im">import</span> sympy</a>
<a class="sourceLine" id="cb1691-2" title="2"></a>
<a class="sourceLine" id="cb1691-3" title="3"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1691-4" title="4"><span class="co">print sympy version</span></a>
<a class="sourceLine" id="cb1691-5" title="5"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1691-6" title="6"><span class="bu">print</span>(sympy.__version__)</a>
<a class="sourceLine" id="cb1691-7" title="7"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1691-8" title="8"></a>
<a class="sourceLine" id="cb1691-9" title="9"><span class="kw">def</span> sle(eqns):</a>
<a class="sourceLine" id="cb1691-10" title="10">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1691-11" title="11"><span class="co">  This function solves a system of linear equations {[&#39;a_0x_0 + b_0x_1 = c0&#39;,&#39;a_1x_0 + b_1x_1 = c1&#39;]}.</span></a>
<a class="sourceLine" id="cb1691-12" title="12"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1691-13" title="13">  eqns <span class="op">=</span> [sympy.sympify(eq) <span class="cf">for</span> eq <span class="kw">in</span> eqns]</a>
<a class="sourceLine" id="cb1691-14" title="14">  x <span class="op">=</span> sympy.symbols(<span class="st">&#39;x:</span><span class="sc">%d</span><span class="st">&#39;</span> <span class="op">%</span> <span class="bu">len</span>(eqns))</a>
<a class="sourceLine" id="cb1691-15" title="15">  sol <span class="op">=</span> sympy.solve(eqns, x)</a>
<a class="sourceLine" id="cb1691-16" title="16">  <span class="cf">return</span> sol</a>
<a class="sourceLine" id="cb1691-17" title="17"></a>
<a class="sourceLine" id="cb1691-18" title="18"><span class="im">from</span> sympy <span class="im">import</span> solve, Eq</a>
<a class="sourceLine" id="cb1691-19" title="19"><span class="im">from</span> sympy.parsing.sympy_parser <span class="im">import</span> parse_expr</a>
<a class="sourceLine" id="cb1691-20" title="20"><span class="im">from</span> sympy.parsing.sympy_parser <span class="im">import</span> standard_transformations, implicit_multiplication_application</a>
<a class="sourceLine" id="cb1691-21" title="21"></a>
<a class="sourceLine" id="cb1691-22" title="22">eqns <span class="op">=</span> [<span class="st">&#39;4x + 3y = 20&#39;</span>, <span class="st">&#39;-5x + 9y = 26&#39;</span>]</a>
<a class="sourceLine" id="cb1691-23" title="23">transformations <span class="op">=</span> (standard_transformations <span class="op">+</span></a>
<a class="sourceLine" id="cb1691-24" title="24">                   (implicit_multiplication_application,))</a>
<a class="sourceLine" id="cb1691-25" title="25">parsed_eqs <span class="op">=</span> []</a>
<a class="sourceLine" id="cb1691-26" title="26"><span class="cf">for</span> eq <span class="kw">in</span> eqns:</a>
<a class="sourceLine" id="cb1691-27" title="27">        sides <span class="op">=</span> [parse_expr(s, transformations<span class="op">=</span>transformations)</a>
<a class="sourceLine" id="cb1691-28" title="28">                <span class="cf">for</span> s <span class="kw">in</span> eq.split(<span class="st">&#39;=&#39;</span>)]</a>
<a class="sourceLine" id="cb1691-29" title="29">        parsed_eqs.append(Eq(sides[<span class="dv">0</span>], sides[<span class="dv">1</span>]))</a>
<a class="sourceLine" id="cb1691-30" title="30">soln <span class="op">=</span> solve(parsed_eqs)</a>
<a class="sourceLine" id="cb1691-31" title="31">test_sol_values <span class="op">=</span> [soln.get(<span class="bu">list</span>(soln.keys())[<span class="dv">0</span>]), soln.get(<span class="bu">list</span>(soln.keys())[<span class="dv">1</span>])]</a>
<a class="sourceLine" id="cb1691-32" title="32"></a>
<a class="sourceLine" id="cb1691-33" title="33">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> <span class="bu">list</span>(sle(eqns).values()) <span class="op">==</span> test_sol_values <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Sympify of expression &#39;could not parse &#39;4x + 3y = 20&#39;&#39; failed, because of exception being raised:
SyntaxError: invalid syntax (&lt;string&gt;, line 1)</code></pre>
<h4 id="run-4-153">Run 4</h4>
<div class="sourceCode" id="cb1693"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1693-1" title="1"><span class="im">import</span> sympy</a>
<a class="sourceLine" id="cb1693-2" title="2"></a>
<a class="sourceLine" id="cb1693-3" title="3"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1693-4" title="4"><span class="co">print sympy version</span></a>
<a class="sourceLine" id="cb1693-5" title="5"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1693-6" title="6"><span class="bu">print</span>(sympy.__version__)</a>
<a class="sourceLine" id="cb1693-7" title="7"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1693-8" title="8"></a>
<a class="sourceLine" id="cb1693-9" title="9"><span class="kw">def</span> sle(eqns):</a>
<a class="sourceLine" id="cb1693-10" title="10">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1693-11" title="11"><span class="co">  This function solves a system of linear equations {[&#39;a_0x_0 + b_0x_1 = c0&#39;,&#39;a_1x_0 + b_1x_1 = c1&#39;]}.</span></a>
<a class="sourceLine" id="cb1693-12" title="12"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1693-13" title="13">  <span class="co"># create a list of variables</span></a>
<a class="sourceLine" id="cb1693-14" title="14">  <span class="bu">vars</span> <span class="op">=</span> []</a>
<a class="sourceLine" id="cb1693-15" title="15">  <span class="cf">for</span> eqn <span class="kw">in</span> eqns:</a>
<a class="sourceLine" id="cb1693-16" title="16">    <span class="cf">for</span> var <span class="kw">in</span> eqn.split(<span class="st">&#39;+&#39;</span>):</a>
<a class="sourceLine" id="cb1693-17" title="17">      <span class="cf">if</span> var.split(<span class="st">&#39;-&#39;</span>)[<span class="dv">0</span>].strip() <span class="kw">not</span> <span class="kw">in</span> <span class="bu">vars</span>:</a>
<a class="sourceLine" id="cb1693-18" title="18">        <span class="bu">vars</span>.append(var.split(<span class="st">&#39;-&#39;</span>)[<span class="dv">0</span>].strip())</a>
<a class="sourceLine" id="cb1693-19" title="19">  </a>
<a class="sourceLine" id="cb1693-20" title="20"><span class="im">from</span> sympy <span class="im">import</span> solve, Eq</a>
<a class="sourceLine" id="cb1693-21" title="21"><span class="im">from</span> sympy.parsing.sympy_parser <span class="im">import</span> parse_expr</a>
<a class="sourceLine" id="cb1693-22" title="22"><span class="im">from</span> sympy.parsing.sympy_parser <span class="im">import</span> standard_transformations, implicit_multiplication_application</a>
<a class="sourceLine" id="cb1693-23" title="23"></a>
<a class="sourceLine" id="cb1693-24" title="24">eqns <span class="op">=</span> [<span class="st">&#39;4x + 3y = 20&#39;</span>, <span class="st">&#39;-5x + 9y = 26&#39;</span>]</a>
<a class="sourceLine" id="cb1693-25" title="25">transformations <span class="op">=</span> (standard_transformations <span class="op">+</span></a>
<a class="sourceLine" id="cb1693-26" title="26">                   (implicit_multiplication_application,))</a>
<a class="sourceLine" id="cb1693-27" title="27">parsed_eqs <span class="op">=</span> []</a>
<a class="sourceLine" id="cb1693-28" title="28"><span class="cf">for</span> eq <span class="kw">in</span> eqns:</a>
<a class="sourceLine" id="cb1693-29" title="29">        sides <span class="op">=</span> [parse_expr(s, transformations<span class="op">=</span>transformations)</a>
<a class="sourceLine" id="cb1693-30" title="30">                <span class="cf">for</span> s <span class="kw">in</span> eq.split(<span class="st">&#39;=&#39;</span>)]</a>
<a class="sourceLine" id="cb1693-31" title="31">        parsed_eqs.append(Eq(sides[<span class="dv">0</span>], sides[<span class="dv">1</span>]))</a>
<a class="sourceLine" id="cb1693-32" title="32">soln <span class="op">=</span> solve(parsed_eqs)</a>
<a class="sourceLine" id="cb1693-33" title="33">test_sol_values <span class="op">=</span> [soln.get(<span class="bu">list</span>(soln.keys())[<span class="dv">0</span>]), soln.get(<span class="bu">list</span>(soln.keys())[<span class="dv">1</span>])]</a>
<a class="sourceLine" id="cb1693-34" title="34"></a>
<a class="sourceLine" id="cb1693-35" title="35">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> <span class="bu">list</span>(sle(eqns).values()) <span class="op">==</span> test_sol_values <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>&#39;NoneType&#39; object has no attribute &#39;values&#39;</code></pre>
</details>
<details>
<p><summary>spectral_r</summary></p>
<h4 id="query-154">Query</h4>
<div class="sourceCode" id="cb1695"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1695-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1695-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1695-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1695-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1695-5" title="5"></a>
<a class="sourceLine" id="cb1695-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1695-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1695-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1695-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1695-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1695-11" title="11"></a>
<a class="sourceLine" id="cb1695-12" title="12"><span class="kw">def</span> spectral_r(a):</a>
<a class="sourceLine" id="cb1695-13" title="13">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1695-14" title="14"><span class="co">  This function calculates the spectral radius of the input square matrix a.</span></a>
<a class="sourceLine" id="cb1695-15" title="15"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1695-16" title="16">  </a></code></pre></div>
<h4 id="run-0-154">Run 0</h4>
<div class="sourceCode" id="cb1696"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1696-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1696-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1696-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1696-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1696-5" title="5"></a>
<a class="sourceLine" id="cb1696-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1696-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1696-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1696-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1696-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1696-11" title="11"></a>
<a class="sourceLine" id="cb1696-12" title="12"><span class="kw">def</span> spectral_r(a):</a>
<a class="sourceLine" id="cb1696-13" title="13">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1696-14" title="14"><span class="co">  This function calculates the spectral radius of the input square matrix a.</span></a>
<a class="sourceLine" id="cb1696-15" title="15"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1696-16" title="16">  <span class="co"># start</span></a>
<a class="sourceLine" id="cb1696-17" title="17">  eig_val, eig_vec <span class="op">=</span> np.linalg.eig(a)</a>
<a class="sourceLine" id="cb1696-18" title="18">  spectral_r <span class="op">=</span> np.<span class="bu">max</span>(np.<span class="bu">abs</span>(eig_val))</a>
<a class="sourceLine" id="cb1696-19" title="19">  </a>
<a class="sourceLine" id="cb1696-20" title="20"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1696-21" title="21"></a>
<a class="sourceLine" id="cb1696-22" title="22">np.random.seed(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb1696-23" title="23">M <span class="op">=</span> <span class="dv">100</span></a>
<a class="sourceLine" id="cb1696-24" title="24">a <span class="op">=</span> np.random.normal(loc<span class="op">=</span><span class="dv">10</span>, scale<span class="op">=</span><span class="dv">3</span>, size<span class="op">=</span>(M,M))</a>
<a class="sourceLine" id="cb1696-25" title="25">eig <span class="op">=</span> np.linalg.eigvals(a)</a>
<a class="sourceLine" id="cb1696-26" title="26">s_r <span class="op">=</span> np.amax(np.absolute(eig))</a>
<a class="sourceLine" id="cb1696-27" title="27"></a>
<a class="sourceLine" id="cb1696-28" title="28">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(spectral_r(a), s_r) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>ufunc &#39;isfinite&#39; not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule &#39;&#39;safe&#39;&#39;</code></pre>
<h4 id="run-1-154">Run 1</h4>
<div class="sourceCode" id="cb1698"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1698-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1698-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1698-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1698-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1698-5" title="5"></a>
<a class="sourceLine" id="cb1698-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1698-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1698-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1698-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1698-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1698-11" title="11"></a>
<a class="sourceLine" id="cb1698-12" title="12"><span class="kw">def</span> spectral_r(a):</a>
<a class="sourceLine" id="cb1698-13" title="13">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1698-14" title="14"><span class="co">  This function calculates the spectral radius of the input square matrix a.</span></a>
<a class="sourceLine" id="cb1698-15" title="15"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1698-16" title="16">  <span class="co"># start</span></a>
<a class="sourceLine" id="cb1698-17" title="17">  w, v <span class="op">=</span> np.linalg.eig(a)</a>
<a class="sourceLine" id="cb1698-18" title="18">  <span class="cf">return</span> np.<span class="bu">max</span>(np.<span class="bu">abs</span>(w))</a>
<a class="sourceLine" id="cb1698-19" title="19">  </a>
<a class="sourceLine" id="cb1698-20" title="20"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1698-21" title="21"></a>
<a class="sourceLine" id="cb1698-22" title="22">np.random.seed(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb1698-23" title="23">M <span class="op">=</span> <span class="dv">100</span></a>
<a class="sourceLine" id="cb1698-24" title="24">a <span class="op">=</span> np.random.normal(loc<span class="op">=</span><span class="dv">10</span>, scale<span class="op">=</span><span class="dv">3</span>, size<span class="op">=</span>(M,M))</a>
<a class="sourceLine" id="cb1698-25" title="25">eig <span class="op">=</span> np.linalg.eigvals(a)</a>
<a class="sourceLine" id="cb1698-26" title="26">s_r <span class="op">=</span> np.amax(np.absolute(eig))</a>
<a class="sourceLine" id="cb1698-27" title="27"></a>
<a class="sourceLine" id="cb1698-28" title="28">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(spectral_r(a), s_r) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-154">Run 2</h4>
<div class="sourceCode" id="cb1700"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1700-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1700-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1700-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1700-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1700-5" title="5"></a>
<a class="sourceLine" id="cb1700-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1700-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1700-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1700-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1700-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1700-11" title="11"></a>
<a class="sourceLine" id="cb1700-12" title="12"><span class="kw">def</span> spectral_r(a):</a>
<a class="sourceLine" id="cb1700-13" title="13">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1700-14" title="14"><span class="co">  This function calculates the spectral radius of the input square matrix a.</span></a>
<a class="sourceLine" id="cb1700-15" title="15"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1700-16" title="16">  eigenvalues <span class="op">=</span> np.linalg.eigvals(a)</a>
<a class="sourceLine" id="cb1700-17" title="17">  spectral_r <span class="op">=</span> np.<span class="bu">max</span>(np.<span class="bu">abs</span>(eigenvalues))</a>
<a class="sourceLine" id="cb1700-18" title="18">  <span class="cf">return</span> spectral_r</a>
<a class="sourceLine" id="cb1700-19" title="19"></a>
<a class="sourceLine" id="cb1700-20" title="20"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1700-21" title="21"></a>
<a class="sourceLine" id="cb1700-22" title="22">np.random.seed(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb1700-23" title="23">M <span class="op">=</span> <span class="dv">100</span></a>
<a class="sourceLine" id="cb1700-24" title="24">a <span class="op">=</span> np.random.normal(loc<span class="op">=</span><span class="dv">10</span>, scale<span class="op">=</span><span class="dv">3</span>, size<span class="op">=</span>(M,M))</a>
<a class="sourceLine" id="cb1700-25" title="25">eig <span class="op">=</span> np.linalg.eigvals(a)</a>
<a class="sourceLine" id="cb1700-26" title="26">s_r <span class="op">=</span> np.amax(np.absolute(eig))</a>
<a class="sourceLine" id="cb1700-27" title="27"></a>
<a class="sourceLine" id="cb1700-28" title="28">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(spectral_r(a), s_r) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-154">Run 3</h4>
<div class="sourceCode" id="cb1702"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1702-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1702-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1702-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1702-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1702-5" title="5"></a>
<a class="sourceLine" id="cb1702-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1702-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1702-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1702-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1702-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1702-11" title="11"></a>
<a class="sourceLine" id="cb1702-12" title="12"><span class="kw">def</span> spectral_r(a):</a>
<a class="sourceLine" id="cb1702-13" title="13">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1702-14" title="14"><span class="co">  This function calculates the spectral radius of the input square matrix a.</span></a>
<a class="sourceLine" id="cb1702-15" title="15"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1702-16" title="16">  <span class="co"># start</span></a>
<a class="sourceLine" id="cb1702-17" title="17">  eigenvalues <span class="op">=</span> np.linalg.eigvals(a)</a>
<a class="sourceLine" id="cb1702-18" title="18">  <span class="cf">return</span> np.<span class="bu">max</span>(np.<span class="bu">abs</span>(eigenvalues))</a>
<a class="sourceLine" id="cb1702-19" title="19">  </a>
<a class="sourceLine" id="cb1702-20" title="20"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1702-21" title="21"></a>
<a class="sourceLine" id="cb1702-22" title="22">np.random.seed(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb1702-23" title="23">M <span class="op">=</span> <span class="dv">100</span></a>
<a class="sourceLine" id="cb1702-24" title="24">a <span class="op">=</span> np.random.normal(loc<span class="op">=</span><span class="dv">10</span>, scale<span class="op">=</span><span class="dv">3</span>, size<span class="op">=</span>(M,M))</a>
<a class="sourceLine" id="cb1702-25" title="25">eig <span class="op">=</span> np.linalg.eigvals(a)</a>
<a class="sourceLine" id="cb1702-26" title="26">s_r <span class="op">=</span> np.amax(np.absolute(eig))</a>
<a class="sourceLine" id="cb1702-27" title="27"></a>
<a class="sourceLine" id="cb1702-28" title="28">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(spectral_r(a), s_r) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-154">Run 4</h4>
<div class="sourceCode" id="cb1704"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1704-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1704-2" title="2"><span class="im">import</span> matplotlib</a>
<a class="sourceLine" id="cb1704-3" title="3">matplotlib.use(<span class="st">&#39;Agg&#39;</span>)</a>
<a class="sourceLine" id="cb1704-4" title="4"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1704-5" title="5"></a>
<a class="sourceLine" id="cb1704-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1704-7" title="7"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1704-8" title="8"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1704-9" title="9">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1704-10" title="10"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1704-11" title="11"></a>
<a class="sourceLine" id="cb1704-12" title="12"><span class="kw">def</span> spectral_r(a):</a>
<a class="sourceLine" id="cb1704-13" title="13">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1704-14" title="14"><span class="co">  This function calculates the spectral radius of the input square matrix a.</span></a>
<a class="sourceLine" id="cb1704-15" title="15"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1704-16" title="16">  <span class="co"># start</span></a>
<a class="sourceLine" id="cb1704-17" title="17">  eigvals <span class="op">=</span> np.linalg.eigvals(a)</a>
<a class="sourceLine" id="cb1704-18" title="18">  <span class="cf">return</span> np.<span class="bu">max</span>(np.<span class="bu">abs</span>(eigvals))</a>
<a class="sourceLine" id="cb1704-19" title="19">  </a>
<a class="sourceLine" id="cb1704-20" title="20"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1704-21" title="21"></a>
<a class="sourceLine" id="cb1704-22" title="22">np.random.seed(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb1704-23" title="23">M <span class="op">=</span> <span class="dv">100</span></a>
<a class="sourceLine" id="cb1704-24" title="24">a <span class="op">=</span> np.random.normal(loc<span class="op">=</span><span class="dv">10</span>, scale<span class="op">=</span><span class="dv">3</span>, size<span class="op">=</span>(M,M))</a>
<a class="sourceLine" id="cb1704-25" title="25">eig <span class="op">=</span> np.linalg.eigvals(a)</a>
<a class="sourceLine" id="cb1704-26" title="26">s_r <span class="op">=</span> np.amax(np.absolute(eig))</a>
<a class="sourceLine" id="cb1704-27" title="27"></a>
<a class="sourceLine" id="cb1704-28" title="28">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(spectral_r(a), s_r) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>find_peaks</summary></p>
<h4 id="query-155">Query</h4>
<div class="sourceCode" id="cb1706"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1706-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1706-2" title="2"><span class="im">import</span> scipy</a>
<a class="sourceLine" id="cb1706-3" title="3"></a>
<a class="sourceLine" id="cb1706-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1706-5" title="5"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1706-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1706-7" title="7">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1706-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1706-9" title="9"></a>
<a class="sourceLine" id="cb1706-10" title="10"><span class="im">import</span> scipy.optimize</a>
<a class="sourceLine" id="cb1706-11" title="11"><span class="im">import</span> scipy.signal</a>
<a class="sourceLine" id="cb1706-12" title="12"></a>
<a class="sourceLine" id="cb1706-13" title="13"><span class="kw">def</span> find_peaks(abs_spectrum, npeaks<span class="op">=</span><span class="dv">3</span>):</a>
<a class="sourceLine" id="cb1706-14" title="14">    <span class="co">&#39;&#39;&#39; This will find the highest `npeaks` peaks and return a list of peak wavenumbers.</span></a>
<a class="sourceLine" id="cb1706-15" title="15"><span class="co">    `abs_spectrum` should be shape (N, 2)</span></a>
<a class="sourceLine" id="cb1706-16" title="16"><span class="co">    &#39;&#39;&#39;</span></a>
<a class="sourceLine" id="cb1706-17" title="17">    </a></code></pre></div>
<h4 id="run-0-155">Run 0</h4>
<div class="sourceCode" id="cb1707"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1707-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1707-2" title="2"><span class="im">import</span> scipy</a>
<a class="sourceLine" id="cb1707-3" title="3"></a>
<a class="sourceLine" id="cb1707-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1707-5" title="5"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1707-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1707-7" title="7">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1707-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1707-9" title="9"></a>
<a class="sourceLine" id="cb1707-10" title="10"><span class="im">import</span> scipy.optimize</a>
<a class="sourceLine" id="cb1707-11" title="11"><span class="im">import</span> scipy.signal</a>
<a class="sourceLine" id="cb1707-12" title="12"></a>
<a class="sourceLine" id="cb1707-13" title="13"><span class="kw">def</span> find_peaks(abs_spectrum, npeaks<span class="op">=</span><span class="dv">3</span>):</a>
<a class="sourceLine" id="cb1707-14" title="14">    <span class="co">&#39;&#39;&#39; This will find the highest `npeaks` peaks and return a list of peak wavenumbers.</span></a>
<a class="sourceLine" id="cb1707-15" title="15"><span class="co">    `abs_spectrum` should be shape (N, 2)</span></a>
<a class="sourceLine" id="cb1707-16" title="16"><span class="co">    &#39;&#39;&#39;</span></a>
<a class="sourceLine" id="cb1707-17" title="17">    <span class="co"># Find the peaks</span></a>
<a class="sourceLine" id="cb1707-18" title="18">    peaks, _ <span class="op">=</span> scipy.signal.find_peaks(abs_spectrum[:, <span class="dv">1</span>], height<span class="op">=</span><span class="dv">0</span>)</a>
<a class="sourceLine" id="cb1707-19" title="19">    <span class="co"># Sort the peaks by height</span></a>
<a class="sourceLine" id="cb1707-20" title="20">    peaks <span class="op">=</span> peaks[np.argsort(abs_spectrum[peaks, <span class="dv">1</span>])[::<span class="op">-</span><span class="dv">1</span>]]</a>
<a class="sourceLine" id="cb1707-21" title="21">    <span class="co"># Return the highest `npeaks` peaks</span></a>
<a class="sourceLine" id="cb1707-22" title="22">    <span class="cf">return</span> peaks[:npeaks]</a>
<a class="sourceLine" id="cb1707-23" title="23"></a>
<a class="sourceLine" id="cb1707-24" title="24"></a>
<a class="sourceLine" id="cb1707-25" title="25">s <span class="op">=</span> np.loadtxt(</a>
<a class="sourceLine" id="cb1707-26" title="26">    <span class="st">&#39;https://raw.githubusercontent.com/whitead/numerical_stats/master/unit_12/lectures/spectrum.txt&#39;</span>)</a>
<a class="sourceLine" id="cb1707-27" title="27"><span class="co"># clean up to be like an absorption spectrum</span></a>
<a class="sourceLine" id="cb1707-28" title="28">s[:, <span class="dv">1</span>] <span class="op">/=</span> np.<span class="bu">max</span>(s[:, <span class="dv">1</span>])</a>
<a class="sourceLine" id="cb1707-29" title="29">ints <span class="op">=</span> np.array(find_peaks(s, <span class="dv">4</span>))</a>
<a class="sourceLine" id="cb1707-30" title="30"></a>
<a class="sourceLine" id="cb1707-31" title="31">true <span class="op">=</span> [<span class="dv">609</span>, <span class="dv">645</span>, <span class="dv">670</span>]</a>
<a class="sourceLine" id="cb1707-32" title="32"></a>
<a class="sourceLine" id="cb1707-33" title="33">result <span class="op">=</span> <span class="bu">len</span>(ints) <span class="op">==</span> <span class="dv">4</span></a>
<a class="sourceLine" id="cb1707-34" title="34"><span class="cf">for</span> t <span class="kw">in</span> true:</a>
<a class="sourceLine" id="cb1707-35" title="35">    result <span class="op">=</span> result <span class="kw">and</span> np.<span class="bu">any</span>(np.<span class="bu">abs</span>(ints <span class="op">-</span> t) <span class="op">&lt;</span> <span class="dv">5</span>)</a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-155">Run 1</h4>
<div class="sourceCode" id="cb1709"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1709-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1709-2" title="2"><span class="im">import</span> scipy</a>
<a class="sourceLine" id="cb1709-3" title="3"></a>
<a class="sourceLine" id="cb1709-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1709-5" title="5"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1709-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1709-7" title="7">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1709-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1709-9" title="9"></a>
<a class="sourceLine" id="cb1709-10" title="10"><span class="im">import</span> scipy.optimize</a>
<a class="sourceLine" id="cb1709-11" title="11"><span class="im">import</span> scipy.signal</a>
<a class="sourceLine" id="cb1709-12" title="12"></a>
<a class="sourceLine" id="cb1709-13" title="13"><span class="kw">def</span> find_peaks(abs_spectrum, npeaks<span class="op">=</span><span class="dv">3</span>):</a>
<a class="sourceLine" id="cb1709-14" title="14">    <span class="co">&#39;&#39;&#39; This will find the highest `npeaks` peaks and return a list of peak wavenumbers.</span></a>
<a class="sourceLine" id="cb1709-15" title="15"><span class="co">    `abs_spectrum` should be shape (N, 2)</span></a>
<a class="sourceLine" id="cb1709-16" title="16"><span class="co">    &#39;&#39;&#39;</span></a>
<a class="sourceLine" id="cb1709-17" title="17">    peaks <span class="op">=</span> scipy.signal.find_peaks_cwt(abs_spectrum[:,<span class="dv">1</span>], np.arange(<span class="dv">1</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1709-18" title="18">    peaks <span class="op">=</span> <span class="bu">sorted</span>(peaks, key<span class="op">=</span><span class="kw">lambda</span> x: abs_spectrum[x,<span class="dv">1</span>], reverse<span class="op">=</span><span class="va">True</span>)</a>
<a class="sourceLine" id="cb1709-19" title="19">    <span class="cf">return</span> peaks[:npeaks]</a>
<a class="sourceLine" id="cb1709-20" title="20"></a>
<a class="sourceLine" id="cb1709-21" title="21"></a>
<a class="sourceLine" id="cb1709-22" title="22">s <span class="op">=</span> np.loadtxt(</a>
<a class="sourceLine" id="cb1709-23" title="23">    <span class="st">&#39;https://raw.githubusercontent.com/whitead/numerical_stats/master/unit_12/lectures/spectrum.txt&#39;</span>)</a>
<a class="sourceLine" id="cb1709-24" title="24"><span class="co"># clean up to be like an absorption spectrum</span></a>
<a class="sourceLine" id="cb1709-25" title="25">s[:, <span class="dv">1</span>] <span class="op">/=</span> np.<span class="bu">max</span>(s[:, <span class="dv">1</span>])</a>
<a class="sourceLine" id="cb1709-26" title="26">ints <span class="op">=</span> np.array(find_peaks(s, <span class="dv">4</span>))</a>
<a class="sourceLine" id="cb1709-27" title="27"></a>
<a class="sourceLine" id="cb1709-28" title="28">true <span class="op">=</span> [<span class="dv">609</span>, <span class="dv">645</span>, <span class="dv">670</span>]</a>
<a class="sourceLine" id="cb1709-29" title="29"></a>
<a class="sourceLine" id="cb1709-30" title="30">result <span class="op">=</span> <span class="bu">len</span>(ints) <span class="op">==</span> <span class="dv">4</span></a>
<a class="sourceLine" id="cb1709-31" title="31"><span class="cf">for</span> t <span class="kw">in</span> true:</a>
<a class="sourceLine" id="cb1709-32" title="32">    result <span class="op">=</span> result <span class="kw">and</span> np.<span class="bu">any</span>(np.<span class="bu">abs</span>(ints <span class="op">-</span> t) <span class="op">&lt;</span> <span class="dv">5</span>)</a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-155">Run 2</h4>
<div class="sourceCode" id="cb1711"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1711-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1711-2" title="2"><span class="im">import</span> scipy</a>
<a class="sourceLine" id="cb1711-3" title="3"></a>
<a class="sourceLine" id="cb1711-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1711-5" title="5"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1711-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1711-7" title="7">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1711-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1711-9" title="9"></a>
<a class="sourceLine" id="cb1711-10" title="10"><span class="im">import</span> scipy.optimize</a>
<a class="sourceLine" id="cb1711-11" title="11"><span class="im">import</span> scipy.signal</a>
<a class="sourceLine" id="cb1711-12" title="12"></a>
<a class="sourceLine" id="cb1711-13" title="13"><span class="kw">def</span> find_peaks(abs_spectrum, npeaks<span class="op">=</span><span class="dv">3</span>):</a>
<a class="sourceLine" id="cb1711-14" title="14">    <span class="co">&#39;&#39;&#39; This will find the highest `npeaks` peaks and return a list of peak wavenumbers.</span></a>
<a class="sourceLine" id="cb1711-15" title="15"><span class="co">    `abs_spectrum` should be shape (N, 2)</span></a>
<a class="sourceLine" id="cb1711-16" title="16"><span class="co">    &#39;&#39;&#39;</span></a>
<a class="sourceLine" id="cb1711-17" title="17">    <span class="co"># Find the peaks</span></a>
<a class="sourceLine" id="cb1711-18" title="18">    peaks, _ <span class="op">=</span> scipy.signal.find_peaks(abs_spectrum[:,<span class="dv">1</span>], height<span class="op">=</span><span class="fl">0.1</span>)</a>
<a class="sourceLine" id="cb1711-19" title="19">    <span class="co"># Sort the peaks by height</span></a>
<a class="sourceLine" id="cb1711-20" title="20">    sorted_peaks <span class="op">=</span> <span class="bu">sorted</span>(<span class="bu">zip</span>(abs_spectrum[peaks,<span class="dv">1</span>], peaks), reverse<span class="op">=</span><span class="va">True</span>)</a>
<a class="sourceLine" id="cb1711-21" title="21">    <span class="co"># Return the wavenumbers of the highest peaks</span></a>
<a class="sourceLine" id="cb1711-22" title="22">    <span class="cf">return</span> [abs_spectrum[peak,<span class="dv">0</span>] <span class="cf">for</span> _, peak <span class="kw">in</span> sorted_peaks[:npeaks]]</a>
<a class="sourceLine" id="cb1711-23" title="23"></a>
<a class="sourceLine" id="cb1711-24" title="24"></a>
<a class="sourceLine" id="cb1711-25" title="25">s <span class="op">=</span> np.loadtxt(</a>
<a class="sourceLine" id="cb1711-26" title="26">    <span class="st">&#39;https://raw.githubusercontent.com/whitead/numerical_stats/master/unit_12/lectures/spectrum.txt&#39;</span>)</a>
<a class="sourceLine" id="cb1711-27" title="27"><span class="co"># clean up to be like an absorption spectrum</span></a>
<a class="sourceLine" id="cb1711-28" title="28">s[:, <span class="dv">1</span>] <span class="op">/=</span> np.<span class="bu">max</span>(s[:, <span class="dv">1</span>])</a>
<a class="sourceLine" id="cb1711-29" title="29">ints <span class="op">=</span> np.array(find_peaks(s, <span class="dv">4</span>))</a>
<a class="sourceLine" id="cb1711-30" title="30"></a>
<a class="sourceLine" id="cb1711-31" title="31">true <span class="op">=</span> [<span class="dv">609</span>, <span class="dv">645</span>, <span class="dv">670</span>]</a>
<a class="sourceLine" id="cb1711-32" title="32"></a>
<a class="sourceLine" id="cb1711-33" title="33">result <span class="op">=</span> <span class="bu">len</span>(ints) <span class="op">==</span> <span class="dv">4</span></a>
<a class="sourceLine" id="cb1711-34" title="34"><span class="cf">for</span> t <span class="kw">in</span> true:</a>
<a class="sourceLine" id="cb1711-35" title="35">    result <span class="op">=</span> result <span class="kw">and</span> np.<span class="bu">any</span>(np.<span class="bu">abs</span>(ints <span class="op">-</span> t) <span class="op">&lt;</span> <span class="dv">5</span>)</a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-155">Run 3</h4>
<div class="sourceCode" id="cb1713"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1713-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1713-2" title="2"><span class="im">import</span> scipy</a>
<a class="sourceLine" id="cb1713-3" title="3"></a>
<a class="sourceLine" id="cb1713-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1713-5" title="5"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1713-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1713-7" title="7">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1713-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1713-9" title="9"></a>
<a class="sourceLine" id="cb1713-10" title="10"><span class="im">import</span> scipy.optimize</a>
<a class="sourceLine" id="cb1713-11" title="11"><span class="im">import</span> scipy.signal</a>
<a class="sourceLine" id="cb1713-12" title="12"></a>
<a class="sourceLine" id="cb1713-13" title="13"><span class="kw">def</span> find_peaks(abs_spectrum, npeaks<span class="op">=</span><span class="dv">3</span>):</a>
<a class="sourceLine" id="cb1713-14" title="14">    <span class="co">&#39;&#39;&#39; This will find the highest `npeaks` peaks and return a list of peak wavenumbers.</span></a>
<a class="sourceLine" id="cb1713-15" title="15"><span class="co">    `abs_spectrum` should be shape (N, 2)</span></a>
<a class="sourceLine" id="cb1713-16" title="16"><span class="co">    &#39;&#39;&#39;</span></a>
<a class="sourceLine" id="cb1713-17" title="17">    <span class="co"># Find the peaks</span></a>
<a class="sourceLine" id="cb1713-18" title="18">    peaks, _ <span class="op">=</span> scipy.signal.find_peaks(abs_spectrum[:,<span class="dv">1</span>], height<span class="op">=</span><span class="dv">0</span>)</a>
<a class="sourceLine" id="cb1713-19" title="19">    <span class="co"># Sort the peaks by height</span></a>
<a class="sourceLine" id="cb1713-20" title="20">    peak_heights <span class="op">=</span> abs_spectrum[peaks,<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb1713-21" title="21">    sorted_peak_indices <span class="op">=</span> np.argsort(peak_heights)[::<span class="op">-</span><span class="dv">1</span>]</a>
<a class="sourceLine" id="cb1713-22" title="22">    <span class="co"># Return the wavenumbers of the highest peaks</span></a>
<a class="sourceLine" id="cb1713-23" title="23">    <span class="cf">return</span> abs_spectrum[peaks[sorted_peak_indices[:npeaks]],<span class="dv">0</span>]</a>
<a class="sourceLine" id="cb1713-24" title="24"></a>
<a class="sourceLine" id="cb1713-25" title="25"></a>
<a class="sourceLine" id="cb1713-26" title="26">s <span class="op">=</span> np.loadtxt(</a>
<a class="sourceLine" id="cb1713-27" title="27">    <span class="st">&#39;https://raw.githubusercontent.com/whitead/numerical_stats/master/unit_12/lectures/spectrum.txt&#39;</span>)</a>
<a class="sourceLine" id="cb1713-28" title="28"><span class="co"># clean up to be like an absorption spectrum</span></a>
<a class="sourceLine" id="cb1713-29" title="29">s[:, <span class="dv">1</span>] <span class="op">/=</span> np.<span class="bu">max</span>(s[:, <span class="dv">1</span>])</a>
<a class="sourceLine" id="cb1713-30" title="30">ints <span class="op">=</span> np.array(find_peaks(s, <span class="dv">4</span>))</a>
<a class="sourceLine" id="cb1713-31" title="31"></a>
<a class="sourceLine" id="cb1713-32" title="32">true <span class="op">=</span> [<span class="dv">609</span>, <span class="dv">645</span>, <span class="dv">670</span>]</a>
<a class="sourceLine" id="cb1713-33" title="33"></a>
<a class="sourceLine" id="cb1713-34" title="34">result <span class="op">=</span> <span class="bu">len</span>(ints) <span class="op">==</span> <span class="dv">4</span></a>
<a class="sourceLine" id="cb1713-35" title="35"><span class="cf">for</span> t <span class="kw">in</span> true:</a>
<a class="sourceLine" id="cb1713-36" title="36">    result <span class="op">=</span> result <span class="kw">and</span> np.<span class="bu">any</span>(np.<span class="bu">abs</span>(ints <span class="op">-</span> t) <span class="op">&lt;</span> <span class="dv">5</span>)</a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-155">Run 4</h4>
<div class="sourceCode" id="cb1715"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1715-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1715-2" title="2"><span class="im">import</span> scipy</a>
<a class="sourceLine" id="cb1715-3" title="3"></a>
<a class="sourceLine" id="cb1715-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1715-5" title="5"><span class="co">Create matrix of ones</span></a>
<a class="sourceLine" id="cb1715-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1715-7" title="7">a <span class="op">=</span> np.ones((<span class="dv">5</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1715-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1715-9" title="9"></a>
<a class="sourceLine" id="cb1715-10" title="10"><span class="im">import</span> scipy.optimize</a>
<a class="sourceLine" id="cb1715-11" title="11"><span class="im">import</span> scipy.signal</a>
<a class="sourceLine" id="cb1715-12" title="12"></a>
<a class="sourceLine" id="cb1715-13" title="13"><span class="kw">def</span> find_peaks(abs_spectrum, npeaks<span class="op">=</span><span class="dv">3</span>):</a>
<a class="sourceLine" id="cb1715-14" title="14">    <span class="co">&#39;&#39;&#39; This will find the highest `npeaks` peaks and return a list of peak wavenumbers.</span></a>
<a class="sourceLine" id="cb1715-15" title="15"><span class="co">    `abs_spectrum` should be shape (N, 2)</span></a>
<a class="sourceLine" id="cb1715-16" title="16"><span class="co">    &#39;&#39;&#39;</span></a>
<a class="sourceLine" id="cb1715-17" title="17">    <span class="co"># find the peaks</span></a>
<a class="sourceLine" id="cb1715-18" title="18">    peaks, _ <span class="op">=</span> scipy.signal.find_peaks(abs_spectrum[:,<span class="dv">1</span>], height<span class="op">=</span><span class="dv">0</span>)</a>
<a class="sourceLine" id="cb1715-19" title="19">    <span class="co"># sort the peaks by height</span></a>
<a class="sourceLine" id="cb1715-20" title="20">    peak_heights <span class="op">=</span> abs_spectrum[peaks,<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb1715-21" title="21">    sorted_peak_indices <span class="op">=</span> np.argsort(peak_heights)[::<span class="op">-</span><span class="dv">1</span>]</a>
<a class="sourceLine" id="cb1715-22" title="22">    <span class="co"># return the wavenumbers of the highest peaks</span></a>
<a class="sourceLine" id="cb1715-23" title="23">    <span class="cf">return</span> abs_spectrum[peaks[sorted_peak_indices[:npeaks]],<span class="dv">0</span>]</a>
<a class="sourceLine" id="cb1715-24" title="24"></a>
<a class="sourceLine" id="cb1715-25" title="25"></a>
<a class="sourceLine" id="cb1715-26" title="26">s <span class="op">=</span> np.loadtxt(</a>
<a class="sourceLine" id="cb1715-27" title="27">    <span class="st">&#39;https://raw.githubusercontent.com/whitead/numerical_stats/master/unit_12/lectures/spectrum.txt&#39;</span>)</a>
<a class="sourceLine" id="cb1715-28" title="28"><span class="co"># clean up to be like an absorption spectrum</span></a>
<a class="sourceLine" id="cb1715-29" title="29">s[:, <span class="dv">1</span>] <span class="op">/=</span> np.<span class="bu">max</span>(s[:, <span class="dv">1</span>])</a>
<a class="sourceLine" id="cb1715-30" title="30">ints <span class="op">=</span> np.array(find_peaks(s, <span class="dv">4</span>))</a>
<a class="sourceLine" id="cb1715-31" title="31"></a>
<a class="sourceLine" id="cb1715-32" title="32">true <span class="op">=</span> [<span class="dv">609</span>, <span class="dv">645</span>, <span class="dv">670</span>]</a>
<a class="sourceLine" id="cb1715-33" title="33"></a>
<a class="sourceLine" id="cb1715-34" title="34">result <span class="op">=</span> <span class="bu">len</span>(ints) <span class="op">==</span> <span class="dv">4</span></a>
<a class="sourceLine" id="cb1715-35" title="35"><span class="cf">for</span> t <span class="kw">in</span> true:</a>
<a class="sourceLine" id="cb1715-36" title="36">    result <span class="op">=</span> result <span class="kw">and</span> np.<span class="bu">any</span>(np.<span class="bu">abs</span>(ints <span class="op">-</span> t) <span class="op">&lt;</span> <span class="dv">5</span>)</a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>speed_of_sound</summary></p>
<h4 id="query-156">Query</h4>
<div class="sourceCode" id="cb1717"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1717-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb1717-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb1717-3" title="3"></a>
<a class="sourceLine" id="cb1717-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1717-5" title="5"><span class="co">compute sin(pi/2)</span></a>
<a class="sourceLine" id="cb1717-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1717-7" title="7">x <span class="op">=</span> math.sin(math.pi <span class="op">/</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1717-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1717-9" title="9"></a>
<a class="sourceLine" id="cb1717-10" title="10"><span class="kw">def</span> speed_of_sound(T,m,gamma):</a>
<a class="sourceLine" id="cb1717-11" title="11">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1717-12" title="12"><span class="co">   This function returns the speed of sound for an ideal gas at temperature T</span></a>
<a class="sourceLine" id="cb1717-13" title="13"><span class="co">   m is mass in g/mol</span></a>
<a class="sourceLine" id="cb1717-14" title="14"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1717-15" title="15">   </a></code></pre></div>
<h4 id="run-0-156">Run 0</h4>
<div class="sourceCode" id="cb1718"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1718-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb1718-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb1718-3" title="3"></a>
<a class="sourceLine" id="cb1718-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1718-5" title="5"><span class="co">compute sin(pi/2)</span></a>
<a class="sourceLine" id="cb1718-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1718-7" title="7">x <span class="op">=</span> math.sin(math.pi <span class="op">/</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1718-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1718-9" title="9"></a>
<a class="sourceLine" id="cb1718-10" title="10"><span class="kw">def</span> speed_of_sound(T,m,gamma):</a>
<a class="sourceLine" id="cb1718-11" title="11">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1718-12" title="12"><span class="co">   This function returns the speed of sound for an ideal gas at temperature T</span></a>
<a class="sourceLine" id="cb1718-13" title="13"><span class="co">   m is mass in g/mol</span></a>
<a class="sourceLine" id="cb1718-14" title="14"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1718-15" title="15">   R <span class="op">=</span> <span class="fl">8.3144621</span> <span class="co"># J/mol/K</span></a>
<a class="sourceLine" id="cb1718-16" title="16">   <span class="cf">return</span> math.sqrt(gamma<span class="op">*</span>R<span class="op">*</span>T<span class="op">/</span>m)</a>
<a class="sourceLine" id="cb1718-17" title="17"></a>
<a class="sourceLine" id="cb1718-18" title="18"></a>
<a class="sourceLine" id="cb1718-19" title="19"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1718-20" title="20"></a>
<a class="sourceLine" id="cb1718-21" title="21">M<span class="op">=</span><span class="dv">28</span></a>
<a class="sourceLine" id="cb1718-22" title="22">T<span class="op">=</span><span class="dv">300</span></a>
<a class="sourceLine" id="cb1718-23" title="23">R<span class="op">=</span><span class="fl">8.314</span></a>
<a class="sourceLine" id="cb1718-24" title="24">gamma<span class="op">=</span><span class="dv">7</span><span class="op">/</span><span class="dv">5</span></a>
<a class="sourceLine" id="cb1718-25" title="25">s <span class="op">=</span> np.sqrt(gamma<span class="op">*</span>R<span class="op">*</span>T<span class="op">/</span>(M<span class="op">/</span><span class="dv">1000</span>))</a>
<a class="sourceLine" id="cb1718-26" title="26"></a>
<a class="sourceLine" id="cb1718-27" title="27">s_codex <span class="op">=</span> speed_of_sound(T,M,gamma)</a>
<a class="sourceLine" id="cb1718-28" title="28"></a>
<a class="sourceLine" id="cb1718-29" title="29"><span class="co"># check </span></a>
<a class="sourceLine" id="cb1718-30" title="30"><span class="cf">if</span> np.isclose(s, s_codex, rtol<span class="op">=</span><span class="fl">0.01</span>) <span class="op">==</span> <span class="va">True</span>:</a>
<a class="sourceLine" id="cb1718-31" title="31">    result <span class="op">=</span> <span class="va">True</span> </a>
<a class="sourceLine" id="cb1718-32" title="32"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb1718-33" title="33">    result <span class="op">=</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-156">Run 1</h4>
<div class="sourceCode" id="cb1720"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1720-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb1720-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb1720-3" title="3"></a>
<a class="sourceLine" id="cb1720-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1720-5" title="5"><span class="co">compute sin(pi/2)</span></a>
<a class="sourceLine" id="cb1720-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1720-7" title="7">x <span class="op">=</span> math.sin(math.pi <span class="op">/</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1720-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1720-9" title="9"></a>
<a class="sourceLine" id="cb1720-10" title="10"><span class="kw">def</span> speed_of_sound(T,m,gamma):</a>
<a class="sourceLine" id="cb1720-11" title="11">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1720-12" title="12"><span class="co">   This function returns the speed of sound for an ideal gas at temperature T</span></a>
<a class="sourceLine" id="cb1720-13" title="13"><span class="co">   m is mass in g/mol</span></a>
<a class="sourceLine" id="cb1720-14" title="14"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1720-15" title="15">   R <span class="op">=</span> <span class="fl">8.314</span> <span class="co"># J/mol/K</span></a>
<a class="sourceLine" id="cb1720-16" title="16">   <span class="cf">return</span> math.sqrt(gamma<span class="op">*</span>R<span class="op">*</span>T<span class="op">/</span>m)</a>
<a class="sourceLine" id="cb1720-17" title="17"></a>
<a class="sourceLine" id="cb1720-18" title="18"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1720-19" title="19"></a>
<a class="sourceLine" id="cb1720-20" title="20">M<span class="op">=</span><span class="dv">28</span></a>
<a class="sourceLine" id="cb1720-21" title="21">T<span class="op">=</span><span class="dv">300</span></a>
<a class="sourceLine" id="cb1720-22" title="22">R<span class="op">=</span><span class="fl">8.314</span></a>
<a class="sourceLine" id="cb1720-23" title="23">gamma<span class="op">=</span><span class="dv">7</span><span class="op">/</span><span class="dv">5</span></a>
<a class="sourceLine" id="cb1720-24" title="24">s <span class="op">=</span> np.sqrt(gamma<span class="op">*</span>R<span class="op">*</span>T<span class="op">/</span>(M<span class="op">/</span><span class="dv">1000</span>))</a>
<a class="sourceLine" id="cb1720-25" title="25"></a>
<a class="sourceLine" id="cb1720-26" title="26">s_codex <span class="op">=</span> speed_of_sound(T,M,gamma)</a>
<a class="sourceLine" id="cb1720-27" title="27"></a>
<a class="sourceLine" id="cb1720-28" title="28"><span class="co"># check </span></a>
<a class="sourceLine" id="cb1720-29" title="29"><span class="cf">if</span> np.isclose(s, s_codex, rtol<span class="op">=</span><span class="fl">0.01</span>) <span class="op">==</span> <span class="va">True</span>:</a>
<a class="sourceLine" id="cb1720-30" title="30">    result <span class="op">=</span> <span class="va">True</span> </a>
<a class="sourceLine" id="cb1720-31" title="31"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb1720-32" title="32">    result <span class="op">=</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-156">Run 2</h4>
<div class="sourceCode" id="cb1722"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1722-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb1722-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb1722-3" title="3"></a>
<a class="sourceLine" id="cb1722-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1722-5" title="5"><span class="co">compute sin(pi/2)</span></a>
<a class="sourceLine" id="cb1722-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1722-7" title="7">x <span class="op">=</span> math.sin(math.pi <span class="op">/</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1722-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1722-9" title="9"></a>
<a class="sourceLine" id="cb1722-10" title="10"><span class="kw">def</span> speed_of_sound(T,m,gamma):</a>
<a class="sourceLine" id="cb1722-11" title="11">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1722-12" title="12"><span class="co">   This function returns the speed of sound for an ideal gas at temperature T</span></a>
<a class="sourceLine" id="cb1722-13" title="13"><span class="co">   m is mass in g/mol</span></a>
<a class="sourceLine" id="cb1722-14" title="14"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1722-15" title="15">   R <span class="op">=</span> <span class="fl">8.314</span> <span class="co">#J/mol/K</span></a>
<a class="sourceLine" id="cb1722-16" title="16">   <span class="cf">return</span> math.sqrt(gamma<span class="op">*</span>R<span class="op">*</span>T<span class="op">/</span>m)</a>
<a class="sourceLine" id="cb1722-17" title="17"></a>
<a class="sourceLine" id="cb1722-18" title="18"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1722-19" title="19"></a>
<a class="sourceLine" id="cb1722-20" title="20">M<span class="op">=</span><span class="dv">28</span></a>
<a class="sourceLine" id="cb1722-21" title="21">T<span class="op">=</span><span class="dv">300</span></a>
<a class="sourceLine" id="cb1722-22" title="22">R<span class="op">=</span><span class="fl">8.314</span></a>
<a class="sourceLine" id="cb1722-23" title="23">gamma<span class="op">=</span><span class="dv">7</span><span class="op">/</span><span class="dv">5</span></a>
<a class="sourceLine" id="cb1722-24" title="24">s <span class="op">=</span> np.sqrt(gamma<span class="op">*</span>R<span class="op">*</span>T<span class="op">/</span>(M<span class="op">/</span><span class="dv">1000</span>))</a>
<a class="sourceLine" id="cb1722-25" title="25"></a>
<a class="sourceLine" id="cb1722-26" title="26">s_codex <span class="op">=</span> speed_of_sound(T,M,gamma)</a>
<a class="sourceLine" id="cb1722-27" title="27"></a>
<a class="sourceLine" id="cb1722-28" title="28"><span class="co"># check </span></a>
<a class="sourceLine" id="cb1722-29" title="29"><span class="cf">if</span> np.isclose(s, s_codex, rtol<span class="op">=</span><span class="fl">0.01</span>) <span class="op">==</span> <span class="va">True</span>:</a>
<a class="sourceLine" id="cb1722-30" title="30">    result <span class="op">=</span> <span class="va">True</span> </a>
<a class="sourceLine" id="cb1722-31" title="31"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb1722-32" title="32">    result <span class="op">=</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-156">Run 3</h4>
<div class="sourceCode" id="cb1724"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1724-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb1724-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb1724-3" title="3"></a>
<a class="sourceLine" id="cb1724-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1724-5" title="5"><span class="co">compute sin(pi/2)</span></a>
<a class="sourceLine" id="cb1724-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1724-7" title="7">x <span class="op">=</span> math.sin(math.pi <span class="op">/</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1724-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1724-9" title="9"></a>
<a class="sourceLine" id="cb1724-10" title="10"><span class="kw">def</span> speed_of_sound(T,m,gamma):</a>
<a class="sourceLine" id="cb1724-11" title="11">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1724-12" title="12"><span class="co">   This function returns the speed of sound for an ideal gas at temperature T</span></a>
<a class="sourceLine" id="cb1724-13" title="13"><span class="co">   m is mass in g/mol</span></a>
<a class="sourceLine" id="cb1724-14" title="14"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1724-15" title="15">   R <span class="op">=</span> <span class="fl">8.314</span></a>
<a class="sourceLine" id="cb1724-16" title="16">   <span class="cf">return</span> math.sqrt(gamma<span class="op">*</span>R<span class="op">*</span>T<span class="op">/</span>m)</a>
<a class="sourceLine" id="cb1724-17" title="17"></a>
<a class="sourceLine" id="cb1724-18" title="18"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1724-19" title="19"></a>
<a class="sourceLine" id="cb1724-20" title="20">M<span class="op">=</span><span class="dv">28</span></a>
<a class="sourceLine" id="cb1724-21" title="21">T<span class="op">=</span><span class="dv">300</span></a>
<a class="sourceLine" id="cb1724-22" title="22">R<span class="op">=</span><span class="fl">8.314</span></a>
<a class="sourceLine" id="cb1724-23" title="23">gamma<span class="op">=</span><span class="dv">7</span><span class="op">/</span><span class="dv">5</span></a>
<a class="sourceLine" id="cb1724-24" title="24">s <span class="op">=</span> np.sqrt(gamma<span class="op">*</span>R<span class="op">*</span>T<span class="op">/</span>(M<span class="op">/</span><span class="dv">1000</span>))</a>
<a class="sourceLine" id="cb1724-25" title="25"></a>
<a class="sourceLine" id="cb1724-26" title="26">s_codex <span class="op">=</span> speed_of_sound(T,M,gamma)</a>
<a class="sourceLine" id="cb1724-27" title="27"></a>
<a class="sourceLine" id="cb1724-28" title="28"><span class="co"># check </span></a>
<a class="sourceLine" id="cb1724-29" title="29"><span class="cf">if</span> np.isclose(s, s_codex, rtol<span class="op">=</span><span class="fl">0.01</span>) <span class="op">==</span> <span class="va">True</span>:</a>
<a class="sourceLine" id="cb1724-30" title="30">    result <span class="op">=</span> <span class="va">True</span> </a>
<a class="sourceLine" id="cb1724-31" title="31"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb1724-32" title="32">    result <span class="op">=</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-156">Run 4</h4>
<div class="sourceCode" id="cb1726"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1726-1" title="1"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb1726-2" title="2"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb1726-3" title="3"></a>
<a class="sourceLine" id="cb1726-4" title="4"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1726-5" title="5"><span class="co">compute sin(pi/2)</span></a>
<a class="sourceLine" id="cb1726-6" title="6"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1726-7" title="7">x <span class="op">=</span> math.sin(math.pi <span class="op">/</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1726-8" title="8"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1726-9" title="9"></a>
<a class="sourceLine" id="cb1726-10" title="10"><span class="kw">def</span> speed_of_sound(T,m,gamma):</a>
<a class="sourceLine" id="cb1726-11" title="11">   <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1726-12" title="12"><span class="co">   This function returns the speed of sound for an ideal gas at temperature T</span></a>
<a class="sourceLine" id="cb1726-13" title="13"><span class="co">   m is mass in g/mol</span></a>
<a class="sourceLine" id="cb1726-14" title="14"><span class="co">   &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1726-15" title="15">   R <span class="op">=</span> <span class="fl">8.314</span> <span class="co"># J/mol/K</span></a>
<a class="sourceLine" id="cb1726-16" title="16">   <span class="cf">return</span> math.sqrt(gamma<span class="op">*</span>R<span class="op">*</span>T<span class="op">/</span>m)</a>
<a class="sourceLine" id="cb1726-17" title="17"></a>
<a class="sourceLine" id="cb1726-18" title="18"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1726-19" title="19"></a>
<a class="sourceLine" id="cb1726-20" title="20">M<span class="op">=</span><span class="dv">28</span></a>
<a class="sourceLine" id="cb1726-21" title="21">T<span class="op">=</span><span class="dv">300</span></a>
<a class="sourceLine" id="cb1726-22" title="22">R<span class="op">=</span><span class="fl">8.314</span></a>
<a class="sourceLine" id="cb1726-23" title="23">gamma<span class="op">=</span><span class="dv">7</span><span class="op">/</span><span class="dv">5</span></a>
<a class="sourceLine" id="cb1726-24" title="24">s <span class="op">=</span> np.sqrt(gamma<span class="op">*</span>R<span class="op">*</span>T<span class="op">/</span>(M<span class="op">/</span><span class="dv">1000</span>))</a>
<a class="sourceLine" id="cb1726-25" title="25"></a>
<a class="sourceLine" id="cb1726-26" title="26">s_codex <span class="op">=</span> speed_of_sound(T,M,gamma)</a>
<a class="sourceLine" id="cb1726-27" title="27"></a>
<a class="sourceLine" id="cb1726-28" title="28"><span class="co"># check </span></a>
<a class="sourceLine" id="cb1726-29" title="29"><span class="cf">if</span> np.isclose(s, s_codex, rtol<span class="op">=</span><span class="fl">0.01</span>) <span class="op">==</span> <span class="va">True</span>:</a>
<a class="sourceLine" id="cb1726-30" title="30">    result <span class="op">=</span> <span class="va">True</span> </a>
<a class="sourceLine" id="cb1726-31" title="31"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb1726-32" title="32">    result <span class="op">=</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
</details>
<details>
<p><summary>substructure</summary></p>
<h4 id="query-157">Query</h4>
<div class="sourceCode" id="cb1728"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1728-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1728-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb1728-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb1728-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb1728-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb1728-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb1728-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb1728-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb1728-9" title="9"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb1728-10" title="10"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb1728-11" title="11"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1728-12" title="12"></a>
<a class="sourceLine" id="cb1728-13" title="13"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1728-14" title="14"><span class="co">print rdkit version</span></a>
<a class="sourceLine" id="cb1728-15" title="15"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1728-16" title="16"><span class="bu">print</span>(rdkit.__version__)</a>
<a class="sourceLine" id="cb1728-17" title="17"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1728-18" title="18"></a>
<a class="sourceLine" id="cb1728-19" title="19"><span class="kw">def</span> substructure(smiles, mol_list):</a>
<a class="sourceLine" id="cb1728-20" title="20">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1728-21" title="21"><span class="co">    This function takes a smiles string and searches mol_list to find entries that contain the substructure. It returns the indices of these entries.</span></a>
<a class="sourceLine" id="cb1728-22" title="22"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1728-23" title="23">    </a></code></pre></div>
<h4 id="run-0-157">Run 0</h4>
<div class="sourceCode" id="cb1729"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1729-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1729-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb1729-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb1729-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb1729-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb1729-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb1729-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb1729-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb1729-9" title="9"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb1729-10" title="10"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb1729-11" title="11"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1729-12" title="12"></a>
<a class="sourceLine" id="cb1729-13" title="13"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1729-14" title="14"><span class="co">print rdkit version</span></a>
<a class="sourceLine" id="cb1729-15" title="15"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1729-16" title="16"><span class="bu">print</span>(rdkit.__version__)</a>
<a class="sourceLine" id="cb1729-17" title="17"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1729-18" title="18"></a>
<a class="sourceLine" id="cb1729-19" title="19"><span class="kw">def</span> substructure(smiles, mol_list):</a>
<a class="sourceLine" id="cb1729-20" title="20">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1729-21" title="21"><span class="co">    This function takes a smiles string and searches mol_list to find entries that contain the substructure. It returns the indices of these entries.</span></a>
<a class="sourceLine" id="cb1729-22" title="22"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1729-23" title="23">    <span class="co"># create a molecule from the smiles string</span></a>
<a class="sourceLine" id="cb1729-24" title="24">    mol <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb1729-25" title="25">    <span class="co"># create a list to store the indices of the entries that contain the substructure</span></a>
<a class="sourceLine" id="cb1729-26" title="26">    indices <span class="op">=</span> []</a>
<a class="sourceLine" id="cb1729-27" title="27">    <span class="co"># loop through mol_list</span></a>
<a class="sourceLine" id="cb1729-28" title="28">    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(mol_list)):</a>
<a class="sourceLine" id="cb1729-29" title="29">        <span class="co"># if the substructure is found in the entry, add the index to the list</span></a>
<a class="sourceLine" id="cb1729-30" title="30">        <span class="cf">if</span> mol_list[i].HasSubstructMatch(mol):</a>
<a class="sourceLine" id="cb1729-31" title="31">            indices.append(i)</a>
<a class="sourceLine" id="cb1729-32" title="32">    <span class="co"># return the list of indices</span></a>
<a class="sourceLine" id="cb1729-33" title="33">    <span class="cf">return</span> indices</a>
<a class="sourceLine" id="cb1729-34" title="34"></a>
<a class="sourceLine" id="cb1729-35" title="35"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1729-36" title="36"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb1729-37" title="37"><span class="co"># Taken from rdkit Docs</span></a>
<a class="sourceLine" id="cb1729-38" title="38"><span class="im">from</span> rdkit <span class="im">import</span> RDConfig, Chem</a>
<a class="sourceLine" id="cb1729-39" title="39"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdSubstructLibrary</a>
<a class="sourceLine" id="cb1729-40" title="40">library <span class="op">=</span> rdSubstructLibrary.SubstructLibrary()</a>
<a class="sourceLine" id="cb1729-41" title="41">llibrary <span class="op">=</span> []</a>
<a class="sourceLine" id="cb1729-42" title="42"><span class="cf">for</span> mol <span class="kw">in</span> Chem.SDMolSupplier(os.path.join(RDConfig.RDDataDir,</a>
<a class="sourceLine" id="cb1729-43" title="43">                                           <span class="st">&#39;NCI&#39;</span>, <span class="st">&#39;first_200.props.sdf&#39;</span>)):</a>
<a class="sourceLine" id="cb1729-44" title="44">    idx <span class="op">=</span> library.AddMol(mol)</a>
<a class="sourceLine" id="cb1729-45" title="45">    llibrary.append(mol)</a>
<a class="sourceLine" id="cb1729-46" title="46">smiles <span class="op">=</span> <span class="st">&#39;CCCCOC&#39;</span></a>
<a class="sourceLine" id="cb1729-47" title="47">core <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb1729-48" title="48">indices <span class="op">=</span> library.GetMatches(core)</a>
<a class="sourceLine" id="cb1729-49" title="49"></a>
<a class="sourceLine" id="cb1729-50" title="50">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(<span class="bu">len</span>(substructure(</a>
<a class="sourceLine" id="cb1729-51" title="51">    smiles, llibrary)), <span class="bu">len</span>(indices)) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>File error: Bad input file /tmp/pip-req-build-p3aa6g65/build/temp.linux-x86_64-3.8/rdkit_install/share/RDKit/Data/NCI/first_200.props.sdf</code></pre>
<h4 id="run-1-157">Run 1</h4>
<div class="sourceCode" id="cb1731"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1731-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1731-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb1731-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb1731-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb1731-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb1731-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb1731-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb1731-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb1731-9" title="9"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb1731-10" title="10"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb1731-11" title="11"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1731-12" title="12"></a>
<a class="sourceLine" id="cb1731-13" title="13"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1731-14" title="14"><span class="co">print rdkit version</span></a>
<a class="sourceLine" id="cb1731-15" title="15"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1731-16" title="16"><span class="bu">print</span>(rdkit.__version__)</a>
<a class="sourceLine" id="cb1731-17" title="17"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1731-18" title="18"></a>
<a class="sourceLine" id="cb1731-19" title="19"><span class="kw">def</span> substructure(smiles, mol_list):</a>
<a class="sourceLine" id="cb1731-20" title="20">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1731-21" title="21"><span class="co">    This function takes a smiles string and searches mol_list to find entries that contain the substructure. It returns the indices of these entries.</span></a>
<a class="sourceLine" id="cb1731-22" title="22"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1731-23" title="23">    <span class="co"># create a mol object from the smiles string</span></a>
<a class="sourceLine" id="cb1731-24" title="24">    query_mol <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb1731-25" title="25">    <span class="co"># create a list to store the indices of the mol_list entries that contain the substructure</span></a>
<a class="sourceLine" id="cb1731-26" title="26">    indices <span class="op">=</span> []</a>
<a class="sourceLine" id="cb1731-27" title="27">    <span class="co"># loop through mol_list</span></a>
<a class="sourceLine" id="cb1731-28" title="28">    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(mol_list)):</a>
<a class="sourceLine" id="cb1731-29" title="29">        <span class="co"># if the mol object from mol_list contains the substructure, add the index to the indices list</span></a>
<a class="sourceLine" id="cb1731-30" title="30">        <span class="cf">if</span> mol_list[i].HasSubstructMatch(query_mol):</a>
<a class="sourceLine" id="cb1731-31" title="31">            indices.append(i)</a>
<a class="sourceLine" id="cb1731-32" title="32">    <span class="co"># return the indices list</span></a>
<a class="sourceLine" id="cb1731-33" title="33">    <span class="cf">return</span> indices</a>
<a class="sourceLine" id="cb1731-34" title="34"></a>
<a class="sourceLine" id="cb1731-35" title="35"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1731-36" title="36"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb1731-37" title="37"><span class="co"># Taken from rdkit Docs</span></a>
<a class="sourceLine" id="cb1731-38" title="38"><span class="im">from</span> rdkit <span class="im">import</span> RDConfig, Chem</a>
<a class="sourceLine" id="cb1731-39" title="39"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdSubstructLibrary</a>
<a class="sourceLine" id="cb1731-40" title="40">library <span class="op">=</span> rdSubstructLibrary.SubstructLibrary()</a>
<a class="sourceLine" id="cb1731-41" title="41">llibrary <span class="op">=</span> []</a>
<a class="sourceLine" id="cb1731-42" title="42"><span class="cf">for</span> mol <span class="kw">in</span> Chem.SDMolSupplier(os.path.join(RDConfig.RDDataDir,</a>
<a class="sourceLine" id="cb1731-43" title="43">                                           <span class="st">&#39;NCI&#39;</span>, <span class="st">&#39;first_200.props.sdf&#39;</span>)):</a>
<a class="sourceLine" id="cb1731-44" title="44">    idx <span class="op">=</span> library.AddMol(mol)</a>
<a class="sourceLine" id="cb1731-45" title="45">    llibrary.append(mol)</a>
<a class="sourceLine" id="cb1731-46" title="46">smiles <span class="op">=</span> <span class="st">&#39;CCCCOC&#39;</span></a>
<a class="sourceLine" id="cb1731-47" title="47">core <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb1731-48" title="48">indices <span class="op">=</span> library.GetMatches(core)</a>
<a class="sourceLine" id="cb1731-49" title="49"></a>
<a class="sourceLine" id="cb1731-50" title="50">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(<span class="bu">len</span>(substructure(</a>
<a class="sourceLine" id="cb1731-51" title="51">    smiles, llibrary)), <span class="bu">len</span>(indices)) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>File error: Bad input file /tmp/pip-req-build-p3aa6g65/build/temp.linux-x86_64-3.8/rdkit_install/share/RDKit/Data/NCI/first_200.props.sdf</code></pre>
<h4 id="run-2-157">Run 2</h4>
<div class="sourceCode" id="cb1733"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1733-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1733-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb1733-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb1733-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb1733-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb1733-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb1733-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb1733-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb1733-9" title="9"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb1733-10" title="10"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb1733-11" title="11"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1733-12" title="12"></a>
<a class="sourceLine" id="cb1733-13" title="13"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1733-14" title="14"><span class="co">print rdkit version</span></a>
<a class="sourceLine" id="cb1733-15" title="15"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1733-16" title="16"><span class="bu">print</span>(rdkit.__version__)</a>
<a class="sourceLine" id="cb1733-17" title="17"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1733-18" title="18"></a>
<a class="sourceLine" id="cb1733-19" title="19"><span class="kw">def</span> substructure(smiles, mol_list):</a>
<a class="sourceLine" id="cb1733-20" title="20">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1733-21" title="21"><span class="co">    This function takes a smiles string and searches mol_list to find entries that contain the substructure. It returns the indices of these entries.</span></a>
<a class="sourceLine" id="cb1733-22" title="22"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1733-23" title="23">    <span class="co"># convert smiles to mol</span></a>
<a class="sourceLine" id="cb1733-24" title="24">    mol <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb1733-25" title="25">    <span class="co"># create a list to store the indices of the mol_list entries that contain the substructure</span></a>
<a class="sourceLine" id="cb1733-26" title="26">    indices <span class="op">=</span> []</a>
<a class="sourceLine" id="cb1733-27" title="27">    <span class="co"># loop through mol_list</span></a>
<a class="sourceLine" id="cb1733-28" title="28">    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(mol_list)):</a>
<a class="sourceLine" id="cb1733-29" title="29">        <span class="co"># if the substructure is found, add the index to the list</span></a>
<a class="sourceLine" id="cb1733-30" title="30">        <span class="cf">if</span> mol_list[i].HasSubstructMatch(mol):</a>
<a class="sourceLine" id="cb1733-31" title="31">            indices.append(i)</a>
<a class="sourceLine" id="cb1733-32" title="32">    <span class="co"># return the list of indices</span></a>
<a class="sourceLine" id="cb1733-33" title="33">    <span class="cf">return</span> indices</a>
<a class="sourceLine" id="cb1733-34" title="34"></a>
<a class="sourceLine" id="cb1733-35" title="35"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1733-36" title="36"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb1733-37" title="37"><span class="co"># Taken from rdkit Docs</span></a>
<a class="sourceLine" id="cb1733-38" title="38"><span class="im">from</span> rdkit <span class="im">import</span> RDConfig, Chem</a>
<a class="sourceLine" id="cb1733-39" title="39"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdSubstructLibrary</a>
<a class="sourceLine" id="cb1733-40" title="40">library <span class="op">=</span> rdSubstructLibrary.SubstructLibrary()</a>
<a class="sourceLine" id="cb1733-41" title="41">llibrary <span class="op">=</span> []</a>
<a class="sourceLine" id="cb1733-42" title="42"><span class="cf">for</span> mol <span class="kw">in</span> Chem.SDMolSupplier(os.path.join(RDConfig.RDDataDir,</a>
<a class="sourceLine" id="cb1733-43" title="43">                                           <span class="st">&#39;NCI&#39;</span>, <span class="st">&#39;first_200.props.sdf&#39;</span>)):</a>
<a class="sourceLine" id="cb1733-44" title="44">    idx <span class="op">=</span> library.AddMol(mol)</a>
<a class="sourceLine" id="cb1733-45" title="45">    llibrary.append(mol)</a>
<a class="sourceLine" id="cb1733-46" title="46">smiles <span class="op">=</span> <span class="st">&#39;CCCCOC&#39;</span></a>
<a class="sourceLine" id="cb1733-47" title="47">core <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb1733-48" title="48">indices <span class="op">=</span> library.GetMatches(core)</a>
<a class="sourceLine" id="cb1733-49" title="49"></a>
<a class="sourceLine" id="cb1733-50" title="50">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(<span class="bu">len</span>(substructure(</a>
<a class="sourceLine" id="cb1733-51" title="51">    smiles, llibrary)), <span class="bu">len</span>(indices)) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>File error: Bad input file /tmp/pip-req-build-p3aa6g65/build/temp.linux-x86_64-3.8/rdkit_install/share/RDKit/Data/NCI/first_200.props.sdf</code></pre>
<h4 id="run-3-157">Run 3</h4>
<div class="sourceCode" id="cb1735"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1735-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1735-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb1735-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb1735-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb1735-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb1735-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb1735-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb1735-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb1735-9" title="9"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb1735-10" title="10"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb1735-11" title="11"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1735-12" title="12"></a>
<a class="sourceLine" id="cb1735-13" title="13"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1735-14" title="14"><span class="co">print rdkit version</span></a>
<a class="sourceLine" id="cb1735-15" title="15"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1735-16" title="16"><span class="bu">print</span>(rdkit.__version__)</a>
<a class="sourceLine" id="cb1735-17" title="17"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1735-18" title="18"></a>
<a class="sourceLine" id="cb1735-19" title="19"><span class="kw">def</span> substructure(smiles, mol_list):</a>
<a class="sourceLine" id="cb1735-20" title="20">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1735-21" title="21"><span class="co">    This function takes a smiles string and searches mol_list to find entries that contain the substructure. It returns the indices of these entries.</span></a>
<a class="sourceLine" id="cb1735-22" title="22"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1735-23" title="23">    <span class="co"># create a molecule from the smiles string</span></a>
<a class="sourceLine" id="cb1735-24" title="24">    mol <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb1735-25" title="25">    <span class="co"># create a list to store the indices of the entries that contain the substructure</span></a>
<a class="sourceLine" id="cb1735-26" title="26">    indices <span class="op">=</span> []</a>
<a class="sourceLine" id="cb1735-27" title="27">    <span class="co"># loop over the molecules in mol_list</span></a>
<a class="sourceLine" id="cb1735-28" title="28">    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(mol_list)):</a>
<a class="sourceLine" id="cb1735-29" title="29">        <span class="co"># check if the molecule contains the substructure</span></a>
<a class="sourceLine" id="cb1735-30" title="30">        <span class="cf">if</span> mol_list[i].HasSubstructMatch(mol):</a>
<a class="sourceLine" id="cb1735-31" title="31">            <span class="co"># if it does, add the index to the list</span></a>
<a class="sourceLine" id="cb1735-32" title="32">            indices.append(i)</a>
<a class="sourceLine" id="cb1735-33" title="33">    <span class="co"># return the list of indices</span></a>
<a class="sourceLine" id="cb1735-34" title="34">    <span class="cf">return</span> indices</a>
<a class="sourceLine" id="cb1735-35" title="35"></a>
<a class="sourceLine" id="cb1735-36" title="36"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1735-37" title="37"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb1735-38" title="38"><span class="co"># Taken from rdkit Docs</span></a>
<a class="sourceLine" id="cb1735-39" title="39"><span class="im">from</span> rdkit <span class="im">import</span> RDConfig, Chem</a>
<a class="sourceLine" id="cb1735-40" title="40"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdSubstructLibrary</a>
<a class="sourceLine" id="cb1735-41" title="41">library <span class="op">=</span> rdSubstructLibrary.SubstructLibrary()</a>
<a class="sourceLine" id="cb1735-42" title="42">llibrary <span class="op">=</span> []</a>
<a class="sourceLine" id="cb1735-43" title="43"><span class="cf">for</span> mol <span class="kw">in</span> Chem.SDMolSupplier(os.path.join(RDConfig.RDDataDir,</a>
<a class="sourceLine" id="cb1735-44" title="44">                                           <span class="st">&#39;NCI&#39;</span>, <span class="st">&#39;first_200.props.sdf&#39;</span>)):</a>
<a class="sourceLine" id="cb1735-45" title="45">    idx <span class="op">=</span> library.AddMol(mol)</a>
<a class="sourceLine" id="cb1735-46" title="46">    llibrary.append(mol)</a>
<a class="sourceLine" id="cb1735-47" title="47">smiles <span class="op">=</span> <span class="st">&#39;CCCCOC&#39;</span></a>
<a class="sourceLine" id="cb1735-48" title="48">core <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb1735-49" title="49">indices <span class="op">=</span> library.GetMatches(core)</a>
<a class="sourceLine" id="cb1735-50" title="50"></a>
<a class="sourceLine" id="cb1735-51" title="51">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(<span class="bu">len</span>(substructure(</a>
<a class="sourceLine" id="cb1735-52" title="52">    smiles, llibrary)), <span class="bu">len</span>(indices)) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>File error: Bad input file /tmp/pip-req-build-p3aa6g65/build/temp.linux-x86_64-3.8/rdkit_install/share/RDKit/Data/NCI/first_200.props.sdf</code></pre>
<h4 id="run-4-157">Run 4</h4>
<div class="sourceCode" id="cb1737"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1737-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1737-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb1737-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb1737-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb1737-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb1737-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb1737-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb1737-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb1737-9" title="9"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb1737-10" title="10"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb1737-11" title="11"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1737-12" title="12"></a>
<a class="sourceLine" id="cb1737-13" title="13"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1737-14" title="14"><span class="co">print rdkit version</span></a>
<a class="sourceLine" id="cb1737-15" title="15"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1737-16" title="16"><span class="bu">print</span>(rdkit.__version__)</a>
<a class="sourceLine" id="cb1737-17" title="17"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1737-18" title="18"></a>
<a class="sourceLine" id="cb1737-19" title="19"><span class="kw">def</span> substructure(smiles, mol_list):</a>
<a class="sourceLine" id="cb1737-20" title="20">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1737-21" title="21"><span class="co">    This function takes a smiles string and searches mol_list to find entries that contain the substructure. It returns the indices of these entries.</span></a>
<a class="sourceLine" id="cb1737-22" title="22"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1737-23" title="23">    <span class="co"># create a list to store the indices of the molecules that contain the substructure</span></a>
<a class="sourceLine" id="cb1737-24" title="24">    indices <span class="op">=</span> []</a>
<a class="sourceLine" id="cb1737-25" title="25">    <span class="co"># create a query molecule from the smiles string</span></a>
<a class="sourceLine" id="cb1737-26" title="26">    query <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb1737-27" title="27">    <span class="co"># loop through the molecules in mol_list</span></a>
<a class="sourceLine" id="cb1737-28" title="28">    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(mol_list)):</a>
<a class="sourceLine" id="cb1737-29" title="29">        <span class="co"># if the query molecule is in the molecule</span></a>
<a class="sourceLine" id="cb1737-30" title="30">        <span class="cf">if</span> mol_list[i].HasSubstructMatch(query):</a>
<a class="sourceLine" id="cb1737-31" title="31">            <span class="co"># add the index to the list</span></a>
<a class="sourceLine" id="cb1737-32" title="32">            indices.append(i)</a>
<a class="sourceLine" id="cb1737-33" title="33">    <span class="co"># return the list of indices</span></a>
<a class="sourceLine" id="cb1737-34" title="34">    <span class="cf">return</span> indices</a>
<a class="sourceLine" id="cb1737-35" title="35"></a>
<a class="sourceLine" id="cb1737-36" title="36"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1737-37" title="37"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb1737-38" title="38"><span class="co"># Taken from rdkit Docs</span></a>
<a class="sourceLine" id="cb1737-39" title="39"><span class="im">from</span> rdkit <span class="im">import</span> RDConfig, Chem</a>
<a class="sourceLine" id="cb1737-40" title="40"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdSubstructLibrary</a>
<a class="sourceLine" id="cb1737-41" title="41">library <span class="op">=</span> rdSubstructLibrary.SubstructLibrary()</a>
<a class="sourceLine" id="cb1737-42" title="42">llibrary <span class="op">=</span> []</a>
<a class="sourceLine" id="cb1737-43" title="43"><span class="cf">for</span> mol <span class="kw">in</span> Chem.SDMolSupplier(os.path.join(RDConfig.RDDataDir,</a>
<a class="sourceLine" id="cb1737-44" title="44">                                           <span class="st">&#39;NCI&#39;</span>, <span class="st">&#39;first_200.props.sdf&#39;</span>)):</a>
<a class="sourceLine" id="cb1737-45" title="45">    idx <span class="op">=</span> library.AddMol(mol)</a>
<a class="sourceLine" id="cb1737-46" title="46">    llibrary.append(mol)</a>
<a class="sourceLine" id="cb1737-47" title="47">smiles <span class="op">=</span> <span class="st">&#39;CCCCOC&#39;</span></a>
<a class="sourceLine" id="cb1737-48" title="48">core <span class="op">=</span> Chem.MolFromSmiles(smiles)</a>
<a class="sourceLine" id="cb1737-49" title="49">indices <span class="op">=</span> library.GetMatches(core)</a>
<a class="sourceLine" id="cb1737-50" title="50"></a>
<a class="sourceLine" id="cb1737-51" title="51">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.isclose(<span class="bu">len</span>(substructure(</a>
<a class="sourceLine" id="cb1737-52" title="52">    smiles, llibrary)), <span class="bu">len</span>(indices)) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>File error: Bad input file /tmp/pip-req-build-p3aa6g65/build/temp.linux-x86_64-3.8/rdkit_install/share/RDKit/Data/NCI/first_200.props.sdf</code></pre>
</details>
<details>
<p><summary>tanimoto</summary></p>
<h4 id="query-158">Query</h4>
<div class="sourceCode" id="cb1739"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1739-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1739-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb1739-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb1739-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb1739-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb1739-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb1739-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb1739-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb1739-9" title="9"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb1739-10" title="10"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb1739-11" title="11"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1739-12" title="12"></a>
<a class="sourceLine" id="cb1739-13" title="13"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1739-14" title="14"><span class="co">print rdkit version</span></a>
<a class="sourceLine" id="cb1739-15" title="15"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1739-16" title="16"><span class="bu">print</span>(rdkit.__version__)</a>
<a class="sourceLine" id="cb1739-17" title="17"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1739-18" title="18"></a>
<a class="sourceLine" id="cb1739-19" title="19"><span class="kw">def</span> tanimoto_matrix(smiles_list, bits<span class="op">=</span><span class="dv">256</span>):</a>
<a class="sourceLine" id="cb1739-20" title="20">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1739-21" title="21"><span class="co">  Returns pairwise Tanimoto similarity matrix with ECFP4 fingerprints</span></a>
<a class="sourceLine" id="cb1739-22" title="22"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1739-23" title="23">  </a></code></pre></div>
<h4 id="run-0-158">Run 0</h4>
<div class="sourceCode" id="cb1740"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1740-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1740-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb1740-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb1740-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb1740-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb1740-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb1740-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb1740-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb1740-9" title="9"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb1740-10" title="10"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb1740-11" title="11"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1740-12" title="12"></a>
<a class="sourceLine" id="cb1740-13" title="13"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1740-14" title="14"><span class="co">print rdkit version</span></a>
<a class="sourceLine" id="cb1740-15" title="15"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1740-16" title="16"><span class="bu">print</span>(rdkit.__version__)</a>
<a class="sourceLine" id="cb1740-17" title="17"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1740-18" title="18"></a>
<a class="sourceLine" id="cb1740-19" title="19"><span class="kw">def</span> tanimoto_matrix(smiles_list, bits<span class="op">=</span><span class="dv">256</span>):</a>
<a class="sourceLine" id="cb1740-20" title="20">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1740-21" title="21"><span class="co">  Returns pairwise Tanimoto similarity matrix with ECFP4 fingerprints</span></a>
<a class="sourceLine" id="cb1740-22" title="22"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1740-23" title="23">  <span class="co"># initialize empty matrix</span></a>
<a class="sourceLine" id="cb1740-24" title="24">  tanimoto_matrix <span class="op">=</span> np.zeros((<span class="bu">len</span>(smiles_list), <span class="bu">len</span>(smiles_list)))</a>
<a class="sourceLine" id="cb1740-25" title="25">  <span class="co"># generate ECFP4 fingerprints</span></a>
<a class="sourceLine" id="cb1740-26" title="26">  fps <span class="op">=</span> [rdMolDescriptors.GetMorganFingerprintAsBitVect(Chem.MolFromSmiles(smile), <span class="dv">2</span>, nBits<span class="op">=</span>bits) <span class="cf">for</span> smile <span class="kw">in</span> smiles_list]</a>
<a class="sourceLine" id="cb1740-27" title="27">  <span class="co"># calculate Tanimoto similarity</span></a>
<a class="sourceLine" id="cb1740-28" title="28">  <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(smiles_list)):</a>
<a class="sourceLine" id="cb1740-29" title="29">    <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(smiles_list)):</a>
<a class="sourceLine" id="cb1740-30" title="30">      tanimoto_matrix[i, j] <span class="op">=</span> DataStructs.TanimotoSimilarity(fps[i], fps[j])</a>
<a class="sourceLine" id="cb1740-31" title="31">  <span class="cf">return</span> tanimoto_matrix</a>
<a class="sourceLine" id="cb1740-32" title="32"></a>
<a class="sourceLine" id="cb1740-33" title="33"></a>
<a class="sourceLine" id="cb1740-34" title="34"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1740-35" title="35"><span class="im">from</span> rdkit.DataStructs.cDataStructs <span class="im">import</span> TanimotoSimilarity</a>
<a class="sourceLine" id="cb1740-36" title="36"><span class="im">from</span> rdkit.Chem <span class="im">import</span> AllChem</a>
<a class="sourceLine" id="cb1740-37" title="37"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb1740-38" title="38"><span class="im">import</span> itertools</a>
<a class="sourceLine" id="cb1740-39" title="39"></a>
<a class="sourceLine" id="cb1740-40" title="40"></a>
<a class="sourceLine" id="cb1740-41" title="41"><span class="kw">def</span> ref_tan_matrix(slist):</a>
<a class="sourceLine" id="cb1740-42" title="42">    fp <span class="op">=</span> [AllChem.GetMorganFingerprintAsBitVect(</a>
<a class="sourceLine" id="cb1740-43" title="43">        Chem.MolFromSmiles(s), <span class="dv">2</span>, nBits<span class="op">=</span><span class="dv">256</span>) <span class="cf">for</span> s <span class="kw">in</span> slist]</a>
<a class="sourceLine" id="cb1740-44" title="44">    ts <span class="op">=</span> <span class="bu">list</span>(</a>
<a class="sourceLine" id="cb1740-45" title="45">        TanimotoSimilarity(x, y) <span class="cf">for</span> x, y <span class="kw">in</span> itertools.product(fp, repeat<span class="op">=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1740-46" title="46">    )</a>
<a class="sourceLine" id="cb1740-47" title="47">    <span class="cf">return</span> np.array(ts).reshape(<span class="bu">len</span>(fp), <span class="bu">len</span>(fp))</a>
<a class="sourceLine" id="cb1740-48" title="48"></a>
<a class="sourceLine" id="cb1740-49" title="49"></a>
<a class="sourceLine" id="cb1740-50" title="50">mols <span class="op">=</span> [<span class="st">&#39;C1C=C(C=NC=C(C(F)(F)F)CCCCCC)C=C1C=CC=CC&#39;</span>,</a>
<a class="sourceLine" id="cb1740-51" title="51">        <span class="st">&#39;CC=C=C(C(=O)N)&#39;</span>, <span class="st">&#39;C1([O-])C=CC=C1NC=CC=C&#39;</span>]</a>
<a class="sourceLine" id="cb1740-52" title="52"><span class="co"># turned down tolerance because CODEX wants to compute</span></a>
<a class="sourceLine" id="cb1740-53" title="53"><span class="co"># fingerprint with slightly different implementation (can&#39;t tell diff?)</span></a>
<a class="sourceLine" id="cb1740-54" title="54">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.allclose(ref_tan_matrix(</a>
<a class="sourceLine" id="cb1740-55" title="55">    mols), tanimoto_matrix(mols), rtol<span class="op">=</span><span class="fl">0.1</span>, atol<span class="op">=</span><span class="fl">1e-2</span>) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-1-158">Run 1</h4>
<div class="sourceCode" id="cb1742"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1742-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1742-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb1742-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb1742-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb1742-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb1742-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb1742-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb1742-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb1742-9" title="9"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb1742-10" title="10"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb1742-11" title="11"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1742-12" title="12"></a>
<a class="sourceLine" id="cb1742-13" title="13"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1742-14" title="14"><span class="co">print rdkit version</span></a>
<a class="sourceLine" id="cb1742-15" title="15"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1742-16" title="16"><span class="bu">print</span>(rdkit.__version__)</a>
<a class="sourceLine" id="cb1742-17" title="17"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1742-18" title="18"></a>
<a class="sourceLine" id="cb1742-19" title="19"><span class="kw">def</span> tanimoto_matrix(smiles_list, bits<span class="op">=</span><span class="dv">256</span>):</a>
<a class="sourceLine" id="cb1742-20" title="20">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1742-21" title="21"><span class="co">  Returns pairwise Tanimoto similarity matrix with ECFP4 fingerprints</span></a>
<a class="sourceLine" id="cb1742-22" title="22"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1742-23" title="23">  <span class="co"># generate Morgan fingerprints</span></a>
<a class="sourceLine" id="cb1742-24" title="24">  fps <span class="op">=</span> [rdMolDescriptors.GetMorganFingerprintAsBitVect(Chem.MolFromSmiles(smile), <span class="dv">2</span>, nBits<span class="op">=</span>bits) <span class="cf">for</span> smile <span class="kw">in</span> smiles_list]</a>
<a class="sourceLine" id="cb1742-25" title="25">  <span class="co"># convert to numpy array</span></a>
<a class="sourceLine" id="cb1742-26" title="26">  arr <span class="op">=</span> np.zeros((<span class="bu">len</span>(fps), bits), np.int8)</a>
<a class="sourceLine" id="cb1742-27" title="27">  <span class="cf">for</span> i, fp <span class="kw">in</span> <span class="bu">enumerate</span>(fps):</a>
<a class="sourceLine" id="cb1742-28" title="28">    DataStructs.ConvertToNumpyArray(fp, arr[i])</a>
<a class="sourceLine" id="cb1742-29" title="29">  <span class="co"># calculate similarity matrix</span></a>
<a class="sourceLine" id="cb1742-30" title="30">  sim_mat <span class="op">=</span> np.zeros((<span class="bu">len</span>(fps), <span class="bu">len</span>(fps)), np.float32)</a>
<a class="sourceLine" id="cb1742-31" title="31">  <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(fps)):</a>
<a class="sourceLine" id="cb1742-32" title="32">    <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(i, <span class="bu">len</span>(fps)):</a>
<a class="sourceLine" id="cb1742-33" title="33">      sim_mat[i, j] <span class="op">=</span> DataStructs.FingerprintSimilarity(fps[i], fps[j])</a>
<a class="sourceLine" id="cb1742-34" title="34">      sim_mat[j, i] <span class="op">=</span> sim_mat[i, j]</a>
<a class="sourceLine" id="cb1742-35" title="35">  <span class="cf">return</span> sim_mat</a>
<a class="sourceLine" id="cb1742-36" title="36"></a>
<a class="sourceLine" id="cb1742-37" title="37"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1742-38" title="38"><span class="im">from</span> rdkit.DataStructs.cDataStructs <span class="im">import</span> TanimotoSimilarity</a>
<a class="sourceLine" id="cb1742-39" title="39"><span class="im">from</span> rdkit.Chem <span class="im">import</span> AllChem</a>
<a class="sourceLine" id="cb1742-40" title="40"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb1742-41" title="41"><span class="im">import</span> itertools</a>
<a class="sourceLine" id="cb1742-42" title="42"></a>
<a class="sourceLine" id="cb1742-43" title="43"></a>
<a class="sourceLine" id="cb1742-44" title="44"><span class="kw">def</span> ref_tan_matrix(slist):</a>
<a class="sourceLine" id="cb1742-45" title="45">    fp <span class="op">=</span> [AllChem.GetMorganFingerprintAsBitVect(</a>
<a class="sourceLine" id="cb1742-46" title="46">        Chem.MolFromSmiles(s), <span class="dv">2</span>, nBits<span class="op">=</span><span class="dv">256</span>) <span class="cf">for</span> s <span class="kw">in</span> slist]</a>
<a class="sourceLine" id="cb1742-47" title="47">    ts <span class="op">=</span> <span class="bu">list</span>(</a>
<a class="sourceLine" id="cb1742-48" title="48">        TanimotoSimilarity(x, y) <span class="cf">for</span> x, y <span class="kw">in</span> itertools.product(fp, repeat<span class="op">=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1742-49" title="49">    )</a>
<a class="sourceLine" id="cb1742-50" title="50">    <span class="cf">return</span> np.array(ts).reshape(<span class="bu">len</span>(fp), <span class="bu">len</span>(fp))</a>
<a class="sourceLine" id="cb1742-51" title="51"></a>
<a class="sourceLine" id="cb1742-52" title="52"></a>
<a class="sourceLine" id="cb1742-53" title="53">mols <span class="op">=</span> [<span class="st">&#39;C1C=C(C=NC=C(C(F)(F)F)CCCCCC)C=C1C=CC=CC&#39;</span>,</a>
<a class="sourceLine" id="cb1742-54" title="54">        <span class="st">&#39;CC=C=C(C(=O)N)&#39;</span>, <span class="st">&#39;C1([O-])C=CC=C1NC=CC=C&#39;</span>]</a>
<a class="sourceLine" id="cb1742-55" title="55"><span class="co"># turned down tolerance because CODEX wants to compute</span></a>
<a class="sourceLine" id="cb1742-56" title="56"><span class="co"># fingerprint with slightly different implementation (can&#39;t tell diff?)</span></a>
<a class="sourceLine" id="cb1742-57" title="57">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.allclose(ref_tan_matrix(</a>
<a class="sourceLine" id="cb1742-58" title="58">    mols), tanimoto_matrix(mols), rtol<span class="op">=</span><span class="fl">0.1</span>, atol<span class="op">=</span><span class="fl">1e-2</span>) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-2-158">Run 2</h4>
<div class="sourceCode" id="cb1744"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1744-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1744-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb1744-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb1744-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb1744-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb1744-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb1744-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb1744-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb1744-9" title="9"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb1744-10" title="10"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb1744-11" title="11"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1744-12" title="12"></a>
<a class="sourceLine" id="cb1744-13" title="13"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1744-14" title="14"><span class="co">print rdkit version</span></a>
<a class="sourceLine" id="cb1744-15" title="15"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1744-16" title="16"><span class="bu">print</span>(rdkit.__version__)</a>
<a class="sourceLine" id="cb1744-17" title="17"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1744-18" title="18"></a>
<a class="sourceLine" id="cb1744-19" title="19"><span class="kw">def</span> tanimoto_matrix(smiles_list, bits<span class="op">=</span><span class="dv">256</span>):</a>
<a class="sourceLine" id="cb1744-20" title="20">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1744-21" title="21"><span class="co">  Returns pairwise Tanimoto similarity matrix with ECFP4 fingerprints</span></a>
<a class="sourceLine" id="cb1744-22" title="22"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1744-23" title="23">  <span class="co"># initialize empty matrix</span></a>
<a class="sourceLine" id="cb1744-24" title="24">  tanimoto_matrix <span class="op">=</span> np.zeros((<span class="bu">len</span>(smiles_list), <span class="bu">len</span>(smiles_list)))</a>
<a class="sourceLine" id="cb1744-25" title="25">  <span class="co"># get Morgan fingerprints with radius 2 and use hashed fingerprints</span></a>
<a class="sourceLine" id="cb1744-26" title="26">  fp_list <span class="op">=</span> [rdMolDescriptors.GetMorganFingerprintAsBitVect(Chem.MolFromSmiles(smiles), <span class="dv">2</span>, nBits<span class="op">=</span>bits) <span class="cf">for</span> smiles <span class="kw">in</span> smiles_list]</a>
<a class="sourceLine" id="cb1744-27" title="27">  <span class="co"># calculate Tanimoto similarities</span></a>
<a class="sourceLine" id="cb1744-28" title="28">  <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(smiles_list)):</a>
<a class="sourceLine" id="cb1744-29" title="29">    <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(smiles_list)):</a>
<a class="sourceLine" id="cb1744-30" title="30">      tanimoto_matrix[i,j] <span class="op">=</span> DataStructs.TanimotoSimilarity(fp_list[i], fp_list[j])</a>
<a class="sourceLine" id="cb1744-31" title="31">  <span class="cf">return</span> tanimoto_matrix</a>
<a class="sourceLine" id="cb1744-32" title="32"></a>
<a class="sourceLine" id="cb1744-33" title="33"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1744-34" title="34"><span class="im">from</span> rdkit.DataStructs.cDataStructs <span class="im">import</span> TanimotoSimilarity</a>
<a class="sourceLine" id="cb1744-35" title="35"><span class="im">from</span> rdkit.Chem <span class="im">import</span> AllChem</a>
<a class="sourceLine" id="cb1744-36" title="36"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb1744-37" title="37"><span class="im">import</span> itertools</a>
<a class="sourceLine" id="cb1744-38" title="38"></a>
<a class="sourceLine" id="cb1744-39" title="39"></a>
<a class="sourceLine" id="cb1744-40" title="40"><span class="kw">def</span> ref_tan_matrix(slist):</a>
<a class="sourceLine" id="cb1744-41" title="41">    fp <span class="op">=</span> [AllChem.GetMorganFingerprintAsBitVect(</a>
<a class="sourceLine" id="cb1744-42" title="42">        Chem.MolFromSmiles(s), <span class="dv">2</span>, nBits<span class="op">=</span><span class="dv">256</span>) <span class="cf">for</span> s <span class="kw">in</span> slist]</a>
<a class="sourceLine" id="cb1744-43" title="43">    ts <span class="op">=</span> <span class="bu">list</span>(</a>
<a class="sourceLine" id="cb1744-44" title="44">        TanimotoSimilarity(x, y) <span class="cf">for</span> x, y <span class="kw">in</span> itertools.product(fp, repeat<span class="op">=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1744-45" title="45">    )</a>
<a class="sourceLine" id="cb1744-46" title="46">    <span class="cf">return</span> np.array(ts).reshape(<span class="bu">len</span>(fp), <span class="bu">len</span>(fp))</a>
<a class="sourceLine" id="cb1744-47" title="47"></a>
<a class="sourceLine" id="cb1744-48" title="48"></a>
<a class="sourceLine" id="cb1744-49" title="49">mols <span class="op">=</span> [<span class="st">&#39;C1C=C(C=NC=C(C(F)(F)F)CCCCCC)C=C1C=CC=CC&#39;</span>,</a>
<a class="sourceLine" id="cb1744-50" title="50">        <span class="st">&#39;CC=C=C(C(=O)N)&#39;</span>, <span class="st">&#39;C1([O-])C=CC=C1NC=CC=C&#39;</span>]</a>
<a class="sourceLine" id="cb1744-51" title="51"><span class="co"># turned down tolerance because CODEX wants to compute</span></a>
<a class="sourceLine" id="cb1744-52" title="52"><span class="co"># fingerprint with slightly different implementation (can&#39;t tell diff?)</span></a>
<a class="sourceLine" id="cb1744-53" title="53">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.allclose(ref_tan_matrix(</a>
<a class="sourceLine" id="cb1744-54" title="54">    mols), tanimoto_matrix(mols), rtol<span class="op">=</span><span class="fl">0.1</span>, atol<span class="op">=</span><span class="fl">1e-2</span>) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-3-158">Run 3</h4>
<div class="sourceCode" id="cb1746"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1746-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1746-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb1746-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb1746-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb1746-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb1746-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb1746-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb1746-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb1746-9" title="9"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb1746-10" title="10"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb1746-11" title="11"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1746-12" title="12"></a>
<a class="sourceLine" id="cb1746-13" title="13"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1746-14" title="14"><span class="co">print rdkit version</span></a>
<a class="sourceLine" id="cb1746-15" title="15"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1746-16" title="16"><span class="bu">print</span>(rdkit.__version__)</a>
<a class="sourceLine" id="cb1746-17" title="17"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1746-18" title="18"></a>
<a class="sourceLine" id="cb1746-19" title="19"><span class="kw">def</span> tanimoto_matrix(smiles_list, bits<span class="op">=</span><span class="dv">256</span>):</a>
<a class="sourceLine" id="cb1746-20" title="20">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1746-21" title="21"><span class="co">  Returns pairwise Tanimoto similarity matrix with ECFP4 fingerprints</span></a>
<a class="sourceLine" id="cb1746-22" title="22"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1746-23" title="23">  <span class="co"># initialize empty matrix</span></a>
<a class="sourceLine" id="cb1746-24" title="24">  tanimoto_matrix <span class="op">=</span> np.zeros((<span class="bu">len</span>(smiles_list), <span class="bu">len</span>(smiles_list)))</a>
<a class="sourceLine" id="cb1746-25" title="25">  <span class="co"># generate Morgan fingerprints</span></a>
<a class="sourceLine" id="cb1746-26" title="26">  fps <span class="op">=</span> [rdMolDescriptors.GetMorganFingerprintAsBitVect(Chem.MolFromSmiles(smile), <span class="dv">2</span>, nBits<span class="op">=</span>bits) <span class="cf">for</span> smile <span class="kw">in</span> smiles_list]</a>
<a class="sourceLine" id="cb1746-27" title="27">  <span class="co"># calculate Tanimoto similarity</span></a>
<a class="sourceLine" id="cb1746-28" title="28">  <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(fps)):</a>
<a class="sourceLine" id="cb1746-29" title="29">    <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(i<span class="op">+</span><span class="dv">1</span>, <span class="bu">len</span>(fps)):</a>
<a class="sourceLine" id="cb1746-30" title="30">      tanimoto_matrix[i, j] <span class="op">=</span> DataStructs.TanimotoSimilarity(fps[i], fps[j])</a>
<a class="sourceLine" id="cb1746-31" title="31">      tanimoto_matrix[j, i] <span class="op">=</span> tanimoto_matrix[i, j]</a>
<a class="sourceLine" id="cb1746-32" title="32">  <span class="cf">return</span> tanimoto_matrix</a>
<a class="sourceLine" id="cb1746-33" title="33"></a>
<a class="sourceLine" id="cb1746-34" title="34"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1746-35" title="35"><span class="im">from</span> rdkit.DataStructs.cDataStructs <span class="im">import</span> TanimotoSimilarity</a>
<a class="sourceLine" id="cb1746-36" title="36"><span class="im">from</span> rdkit.Chem <span class="im">import</span> AllChem</a>
<a class="sourceLine" id="cb1746-37" title="37"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb1746-38" title="38"><span class="im">import</span> itertools</a>
<a class="sourceLine" id="cb1746-39" title="39"></a>
<a class="sourceLine" id="cb1746-40" title="40"></a>
<a class="sourceLine" id="cb1746-41" title="41"><span class="kw">def</span> ref_tan_matrix(slist):</a>
<a class="sourceLine" id="cb1746-42" title="42">    fp <span class="op">=</span> [AllChem.GetMorganFingerprintAsBitVect(</a>
<a class="sourceLine" id="cb1746-43" title="43">        Chem.MolFromSmiles(s), <span class="dv">2</span>, nBits<span class="op">=</span><span class="dv">256</span>) <span class="cf">for</span> s <span class="kw">in</span> slist]</a>
<a class="sourceLine" id="cb1746-44" title="44">    ts <span class="op">=</span> <span class="bu">list</span>(</a>
<a class="sourceLine" id="cb1746-45" title="45">        TanimotoSimilarity(x, y) <span class="cf">for</span> x, y <span class="kw">in</span> itertools.product(fp, repeat<span class="op">=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1746-46" title="46">    )</a>
<a class="sourceLine" id="cb1746-47" title="47">    <span class="cf">return</span> np.array(ts).reshape(<span class="bu">len</span>(fp), <span class="bu">len</span>(fp))</a>
<a class="sourceLine" id="cb1746-48" title="48"></a>
<a class="sourceLine" id="cb1746-49" title="49"></a>
<a class="sourceLine" id="cb1746-50" title="50">mols <span class="op">=</span> [<span class="st">&#39;C1C=C(C=NC=C(C(F)(F)F)CCCCCC)C=C1C=CC=CC&#39;</span>,</a>
<a class="sourceLine" id="cb1746-51" title="51">        <span class="st">&#39;CC=C=C(C(=O)N)&#39;</span>, <span class="st">&#39;C1([O-])C=CC=C1NC=CC=C&#39;</span>]</a>
<a class="sourceLine" id="cb1746-52" title="52"><span class="co"># turned down tolerance because CODEX wants to compute</span></a>
<a class="sourceLine" id="cb1746-53" title="53"><span class="co"># fingerprint with slightly different implementation (can&#39;t tell diff?)</span></a>
<a class="sourceLine" id="cb1746-54" title="54">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.allclose(ref_tan_matrix(</a>
<a class="sourceLine" id="cb1746-55" title="55">    mols), tanimoto_matrix(mols), rtol<span class="op">=</span><span class="fl">0.1</span>, atol<span class="op">=</span><span class="fl">1e-2</span>) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Success</code></pre>
<h4 id="run-4-158">Run 4</h4>
<div class="sourceCode" id="cb1748"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1748-1" title="1"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1748-2" title="2"><span class="im">import</span> rdkit</a>
<a class="sourceLine" id="cb1748-3" title="3"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb1748-4" title="4"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</a>
<a class="sourceLine" id="cb1748-5" title="5"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolHash</a>
<a class="sourceLine" id="cb1748-6" title="6"><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolDescriptors</a>
<a class="sourceLine" id="cb1748-7" title="7"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Crippen</a>
<a class="sourceLine" id="cb1748-8" title="8"><span class="im">from</span> rdkit.Chem <span class="im">import</span> Descriptors</a>
<a class="sourceLine" id="cb1748-9" title="9"><span class="im">from</span> rdkit.ML.Descriptors <span class="im">import</span> MoleculeDescriptors</a>
<a class="sourceLine" id="cb1748-10" title="10"><span class="im">from</span> rdkit <span class="im">import</span> DataStructs</a>
<a class="sourceLine" id="cb1748-11" title="11"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1748-12" title="12"></a>
<a class="sourceLine" id="cb1748-13" title="13"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1748-14" title="14"><span class="co">print rdkit version</span></a>
<a class="sourceLine" id="cb1748-15" title="15"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1748-16" title="16"><span class="bu">print</span>(rdkit.__version__)</a>
<a class="sourceLine" id="cb1748-17" title="17"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1748-18" title="18"></a>
<a class="sourceLine" id="cb1748-19" title="19"><span class="kw">def</span> tanimoto_matrix(smiles_list, bits<span class="op">=</span><span class="dv">256</span>):</a>
<a class="sourceLine" id="cb1748-20" title="20">  <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1748-21" title="21"><span class="co">  Returns pairwise Tanimoto similarity matrix with ECFP4 fingerprints</span></a>
<a class="sourceLine" id="cb1748-22" title="22"><span class="co">  &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1748-23" title="23">  <span class="co"># initialize empty matrix</span></a>
<a class="sourceLine" id="cb1748-24" title="24">  tanimoto_matrix <span class="op">=</span> np.zeros((<span class="bu">len</span>(smiles_list), <span class="bu">len</span>(smiles_list)))</a>
<a class="sourceLine" id="cb1748-25" title="25">  <span class="co"># generate ECFP4 fingerprints</span></a>
<a class="sourceLine" id="cb1748-26" title="26">  fps <span class="op">=</span> [rdMolDescriptors.GetMorganFingerprintAsBitVect(m, <span class="dv">2</span>, nBits<span class="op">=</span>bits) <span class="cf">for</span> m <span class="kw">in</span> smiles_list]</a>
<a class="sourceLine" id="cb1748-27" title="27">  <span class="co"># calculate Tanimoto similarity</span></a>
<a class="sourceLine" id="cb1748-28" title="28">  <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(smiles_list)):</a>
<a class="sourceLine" id="cb1748-29" title="29">    <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(smiles_list)):</a>
<a class="sourceLine" id="cb1748-30" title="30">      tanimoto_matrix[i, j] <span class="op">=</span> DataStructs.TanimotoSimilarity(fps[i], fps[j])</a>
<a class="sourceLine" id="cb1748-31" title="31">  <span class="cf">return</span> tanimoto_matrix</a>
<a class="sourceLine" id="cb1748-32" title="32"></a>
<a class="sourceLine" id="cb1748-33" title="33"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1748-34" title="34"><span class="im">from</span> rdkit.DataStructs.cDataStructs <span class="im">import</span> TanimotoSimilarity</a>
<a class="sourceLine" id="cb1748-35" title="35"><span class="im">from</span> rdkit.Chem <span class="im">import</span> AllChem</a>
<a class="sourceLine" id="cb1748-36" title="36"><span class="im">from</span> rdkit <span class="im">import</span> Chem</a>
<a class="sourceLine" id="cb1748-37" title="37"><span class="im">import</span> itertools</a>
<a class="sourceLine" id="cb1748-38" title="38"></a>
<a class="sourceLine" id="cb1748-39" title="39"></a>
<a class="sourceLine" id="cb1748-40" title="40"><span class="kw">def</span> ref_tan_matrix(slist):</a>
<a class="sourceLine" id="cb1748-41" title="41">    fp <span class="op">=</span> [AllChem.GetMorganFingerprintAsBitVect(</a>
<a class="sourceLine" id="cb1748-42" title="42">        Chem.MolFromSmiles(s), <span class="dv">2</span>, nBits<span class="op">=</span><span class="dv">256</span>) <span class="cf">for</span> s <span class="kw">in</span> slist]</a>
<a class="sourceLine" id="cb1748-43" title="43">    ts <span class="op">=</span> <span class="bu">list</span>(</a>
<a class="sourceLine" id="cb1748-44" title="44">        TanimotoSimilarity(x, y) <span class="cf">for</span> x, y <span class="kw">in</span> itertools.product(fp, repeat<span class="op">=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1748-45" title="45">    )</a>
<a class="sourceLine" id="cb1748-46" title="46">    <span class="cf">return</span> np.array(ts).reshape(<span class="bu">len</span>(fp), <span class="bu">len</span>(fp))</a>
<a class="sourceLine" id="cb1748-47" title="47"></a>
<a class="sourceLine" id="cb1748-48" title="48"></a>
<a class="sourceLine" id="cb1748-49" title="49">mols <span class="op">=</span> [<span class="st">&#39;C1C=C(C=NC=C(C(F)(F)F)CCCCCC)C=C1C=CC=CC&#39;</span>,</a>
<a class="sourceLine" id="cb1748-50" title="50">        <span class="st">&#39;CC=C=C(C(=O)N)&#39;</span>, <span class="st">&#39;C1([O-])C=CC=C1NC=CC=C&#39;</span>]</a>
<a class="sourceLine" id="cb1748-51" title="51"><span class="co"># turned down tolerance because CODEX wants to compute</span></a>
<a class="sourceLine" id="cb1748-52" title="52"><span class="co"># fingerprint with slightly different implementation (can&#39;t tell diff?)</span></a>
<a class="sourceLine" id="cb1748-53" title="53">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> np.allclose(ref_tan_matrix(</a>
<a class="sourceLine" id="cb1748-54" title="54">    mols), tanimoto_matrix(mols), rtol<span class="op">=</span><span class="fl">0.1</span>, atol<span class="op">=</span><span class="fl">1e-2</span>) <span class="cf">else</span> <span class="va">False</span></a></code></pre></div>
<p>Output:</p>
<pre><code>Python argument types in
    rdkit.Chem.rdMolDescriptors.GetMorganFingerprintAsBitVect(str, int)
did not match C++ signature:
    GetMorganFingerprintAsBitVect(RDKit::ROMol mol, unsigned int radius, unsigned int nBits=2048, boost::python::api::object invariants=[], boost::python::api::object fromAtoms=[], bool useChirality=False, bool useBondTypes=True, bool useFeatures=False, boost::python::api::object bitInfo=None, bool includeRedundantEnvironments=False)</code></pre>
</details>
<details>
<p><summary>unbdistance</summary></p>
<h4 id="query-159">Query</h4>
<div class="sourceCode" id="cb1750"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1750-1" title="1"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb1750-2" title="2"></a>
<a class="sourceLine" id="cb1750-3" title="3"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1750-4" title="4"><span class="co">Print version string</span></a>
<a class="sourceLine" id="cb1750-5" title="5"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1750-6" title="6"><span class="bu">print</span>(md.version.full_version)</a>
<a class="sourceLine" id="cb1750-7" title="7"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1750-8" title="8"></a>
<a class="sourceLine" id="cb1750-9" title="9"><span class="kw">def</span> unbdistance(traj,lig_str):</a>
<a class="sourceLine" id="cb1750-10" title="10">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1750-11" title="11"><span class="co">    This function returns a list of distances between center of mass of</span></a>
<a class="sourceLine" id="cb1750-12" title="12"><span class="co">    protein and center of mass of lig_str in every frame of trajectory</span></a>
<a class="sourceLine" id="cb1750-13" title="13"><span class="co">    traj</span></a>
<a class="sourceLine" id="cb1750-14" title="14"></a>
<a class="sourceLine" id="cb1750-15" title="15"><span class="co">    traj is an mdtraj trajectory object</span></a>
<a class="sourceLine" id="cb1750-16" title="16"><span class="co">    lig_str is a string with the residue name of the ligand</span></a>
<a class="sourceLine" id="cb1750-17" title="17"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1750-18" title="18">    </a></code></pre></div>
<h4 id="run-0-159">Run 0</h4>
<div class="sourceCode" id="cb1751"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1751-1" title="1"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb1751-2" title="2"></a>
<a class="sourceLine" id="cb1751-3" title="3"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1751-4" title="4"><span class="co">Print version string</span></a>
<a class="sourceLine" id="cb1751-5" title="5"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1751-6" title="6"><span class="bu">print</span>(md.version.full_version)</a>
<a class="sourceLine" id="cb1751-7" title="7"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1751-8" title="8"></a>
<a class="sourceLine" id="cb1751-9" title="9"><span class="kw">def</span> unbdistance(traj,lig_str):</a>
<a class="sourceLine" id="cb1751-10" title="10">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1751-11" title="11"><span class="co">    This function returns a list of distances between center of mass of</span></a>
<a class="sourceLine" id="cb1751-12" title="12"><span class="co">    protein and center of mass of lig_str in every frame of trajectory</span></a>
<a class="sourceLine" id="cb1751-13" title="13"><span class="co">    traj</span></a>
<a class="sourceLine" id="cb1751-14" title="14"></a>
<a class="sourceLine" id="cb1751-15" title="15"><span class="co">    traj is an mdtraj trajectory object</span></a>
<a class="sourceLine" id="cb1751-16" title="16"><span class="co">    lig_str is a string with the residue name of the ligand</span></a>
<a class="sourceLine" id="cb1751-17" title="17"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1751-18" title="18">    <span class="co"># get the indices of the ligand</span></a>
<a class="sourceLine" id="cb1751-19" title="19">    lig_ind <span class="op">=</span> traj.topology.select(<span class="st">&#39;resname &#39;</span><span class="op">+</span>lig_str)</a>
<a class="sourceLine" id="cb1751-20" title="20">    <span class="co"># get the indices of the protein</span></a>
<a class="sourceLine" id="cb1751-21" title="21">    prot_ind <span class="op">=</span> traj.topology.select(<span class="st">&#39;protein&#39;</span>)</a>
<a class="sourceLine" id="cb1751-22" title="22">    <span class="co"># get the center of mass of the ligand</span></a>
<a class="sourceLine" id="cb1751-23" title="23">    lig_com <span class="op">=</span> md.compute_center_of_mass(traj.atom_slice(lig_ind))</a>
<a class="sourceLine" id="cb1751-24" title="24">    <span class="co"># get the center of mass of the protein</span></a>
<a class="sourceLine" id="cb1751-25" title="25">    prot_com <span class="op">=</span> md.compute_center_of_mass(traj.atom_slice(prot_ind))</a>
<a class="sourceLine" id="cb1751-26" title="26">    <span class="co"># get the distance between the two centers of mass</span></a>
<a class="sourceLine" id="cb1751-27" title="27">    dist <span class="op">=</span> md.compute_distances(traj,lig_com,prot_com)</a>
<a class="sourceLine" id="cb1751-28" title="28">    <span class="cf">return</span> dist</a>
<a class="sourceLine" id="cb1751-29" title="29"></a>
<a class="sourceLine" id="cb1751-30" title="30"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb1751-31" title="31"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb1751-32" title="32"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb1751-33" title="33"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1751-34" title="34"></a>
<a class="sourceLine" id="cb1751-35" title="35"></a>
<a class="sourceLine" id="cb1751-36" title="36"><span class="co">#_FILE_DIR_ = &#39;.&#39;</span></a>
<a class="sourceLine" id="cb1751-37" title="37">lig_str <span class="op">=</span> <span class="st">&#39;TMP&#39;</span></a>
<a class="sourceLine" id="cb1751-38" title="38">traj_path <span class="op">=</span> os.path.join(_FILE_DIR_, <span class="st">&#39;traj.dcd&#39;</span>) </a>
<a class="sourceLine" id="cb1751-39" title="39">top_path <span class="op">=</span> os.path.join(_FILE_DIR_, <span class="st">&#39;top.pdb&#39;</span>)</a>
<a class="sourceLine" id="cb1751-40" title="40">traj <span class="op">=</span> md.load(traj_path, top<span class="op">=</span>top_path)</a>
<a class="sourceLine" id="cb1751-41" title="41">top <span class="op">=</span> traj.topology</a>
<a class="sourceLine" id="cb1751-42" title="42">prot_idxs <span class="op">=</span> top.select(<span class="st">&#39;protein&#39;</span>)</a>
<a class="sourceLine" id="cb1751-43" title="43">lig_idxs <span class="op">=</span> top.select(<span class="ss">F&#39;resname == </span><span class="sc">{</span>lig_str<span class="sc">}</span><span class="ss">&#39;</span>)</a>
<a class="sourceLine" id="cb1751-44" title="44">traj2 <span class="op">=</span> md.load(traj_path, atom_indices<span class="op">=</span>prot_idxs, top<span class="op">=</span>top_path)</a>
<a class="sourceLine" id="cb1751-45" title="45">traj3 <span class="op">=</span> md.load(traj_path, atom_indices<span class="op">=</span>lig_idxs, top<span class="op">=</span>top_path)</a>
<a class="sourceLine" id="cb1751-46" title="46"></a>
<a class="sourceLine" id="cb1751-47" title="47">dist <span class="op">=</span> []</a>
<a class="sourceLine" id="cb1751-48" title="48"><span class="cf">for</span> i,j <span class="kw">in</span> <span class="bu">zip</span>(traj2,traj3):</a>
<a class="sourceLine" id="cb1751-49" title="49">    com_a <span class="op">=</span> md.compute_center_of_mass(i)[<span class="dv">0</span>]</a>
<a class="sourceLine" id="cb1751-50" title="50">    com_b <span class="op">=</span> md.compute_center_of_mass(j)[<span class="dv">0</span>]</a>
<a class="sourceLine" id="cb1751-51" title="51">    dist.append(((com_a[<span class="dv">0</span>]<span class="op">-</span>com_b[<span class="dv">0</span>])<span class="op">**</span><span class="dv">2</span><span class="op">+</span>(com_a[<span class="dv">1</span>]<span class="op">-</span>com_b[<span class="dv">1</span>])<span class="op">**</span><span class="dv">2</span><span class="op">+</span>(com_a[<span class="dv">2</span>]<span class="op">-</span>com_b[<span class="dv">2</span>])<span class="op">**</span><span class="dv">2</span>)<span class="op">**</span><span class="fl">0.5</span>)</a>
<a class="sourceLine" id="cb1751-52" title="52"></a>
<a class="sourceLine" id="cb1751-53" title="53"><span class="co"># assert</span></a>
<a class="sourceLine" id="cb1751-54" title="54"></a>
<a class="sourceLine" id="cb1751-55" title="55">distances <span class="op">=</span> unbdistance(traj,lig_str)</a>
<a class="sourceLine" id="cb1751-56" title="56"></a>
<a class="sourceLine" id="cb1751-57" title="57">check <span class="op">=</span> math.isclose(dist[<span class="dv">0</span>],distances[<span class="dv">0</span>])</a>
<a class="sourceLine" id="cb1751-58" title="58">check2 <span class="op">=</span> math.isclose(dist[<span class="op">-</span><span class="dv">1</span>],distances[<span class="op">-</span><span class="dv">1</span>])</a>
<a class="sourceLine" id="cb1751-59" title="59">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> check <span class="kw">and</span> check2 <span class="cf">else</span> <span class="va">False</span> </a></code></pre></div>
<p>Output:</p>
<pre><code>&#39;Constant&#39; object has no attribute &#39;kind&#39;</code></pre>
<h4 id="run-1-159">Run 1</h4>
<div class="sourceCode" id="cb1753"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1753-1" title="1"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb1753-2" title="2"></a>
<a class="sourceLine" id="cb1753-3" title="3"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1753-4" title="4"><span class="co">Print version string</span></a>
<a class="sourceLine" id="cb1753-5" title="5"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1753-6" title="6"><span class="bu">print</span>(md.version.full_version)</a>
<a class="sourceLine" id="cb1753-7" title="7"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1753-8" title="8"></a>
<a class="sourceLine" id="cb1753-9" title="9"><span class="kw">def</span> unbdistance(traj,lig_str):</a>
<a class="sourceLine" id="cb1753-10" title="10">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1753-11" title="11"><span class="co">    This function returns a list of distances between center of mass of</span></a>
<a class="sourceLine" id="cb1753-12" title="12"><span class="co">    protein and center of mass of lig_str in every frame of trajectory</span></a>
<a class="sourceLine" id="cb1753-13" title="13"><span class="co">    traj</span></a>
<a class="sourceLine" id="cb1753-14" title="14"></a>
<a class="sourceLine" id="cb1753-15" title="15"><span class="co">    traj is an mdtraj trajectory object</span></a>
<a class="sourceLine" id="cb1753-16" title="16"><span class="co">    lig_str is a string with the residue name of the ligand</span></a>
<a class="sourceLine" id="cb1753-17" title="17"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1753-18" title="18">    lig_ind <span class="op">=</span> traj.topology.select(<span class="st">&#39;resname &#39;</span><span class="op">+</span>lig_str)</a>
<a class="sourceLine" id="cb1753-19" title="19">    prot_ind <span class="op">=</span> traj.topology.select(<span class="st">&#39;protein&#39;</span>)</a>
<a class="sourceLine" id="cb1753-20" title="20">    lig_com <span class="op">=</span> md.compute_center_of_mass(traj.atom_slice(lig_ind))</a>
<a class="sourceLine" id="cb1753-21" title="21">    prot_com <span class="op">=</span> md.compute_center_of_mass(traj.atom_slice(prot_ind))</a>
<a class="sourceLine" id="cb1753-22" title="22">    <span class="cf">return</span> md.compute_distances(traj,[lig_com,prot_com])</a>
<a class="sourceLine" id="cb1753-23" title="23"></a>
<a class="sourceLine" id="cb1753-24" title="24"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb1753-25" title="25"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb1753-26" title="26"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb1753-27" title="27"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1753-28" title="28"></a>
<a class="sourceLine" id="cb1753-29" title="29"></a>
<a class="sourceLine" id="cb1753-30" title="30"><span class="co">#_FILE_DIR_ = &#39;.&#39;</span></a>
<a class="sourceLine" id="cb1753-31" title="31">lig_str <span class="op">=</span> <span class="st">&#39;TMP&#39;</span></a>
<a class="sourceLine" id="cb1753-32" title="32">traj_path <span class="op">=</span> os.path.join(_FILE_DIR_, <span class="st">&#39;traj.dcd&#39;</span>) </a>
<a class="sourceLine" id="cb1753-33" title="33">top_path <span class="op">=</span> os.path.join(_FILE_DIR_, <span class="st">&#39;top.pdb&#39;</span>)</a>
<a class="sourceLine" id="cb1753-34" title="34">traj <span class="op">=</span> md.load(traj_path, top<span class="op">=</span>top_path)</a>
<a class="sourceLine" id="cb1753-35" title="35">top <span class="op">=</span> traj.topology</a>
<a class="sourceLine" id="cb1753-36" title="36">prot_idxs <span class="op">=</span> top.select(<span class="st">&#39;protein&#39;</span>)</a>
<a class="sourceLine" id="cb1753-37" title="37">lig_idxs <span class="op">=</span> top.select(<span class="ss">F&#39;resname == </span><span class="sc">{</span>lig_str<span class="sc">}</span><span class="ss">&#39;</span>)</a>
<a class="sourceLine" id="cb1753-38" title="38">traj2 <span class="op">=</span> md.load(traj_path, atom_indices<span class="op">=</span>prot_idxs, top<span class="op">=</span>top_path)</a>
<a class="sourceLine" id="cb1753-39" title="39">traj3 <span class="op">=</span> md.load(traj_path, atom_indices<span class="op">=</span>lig_idxs, top<span class="op">=</span>top_path)</a>
<a class="sourceLine" id="cb1753-40" title="40"></a>
<a class="sourceLine" id="cb1753-41" title="41">dist <span class="op">=</span> []</a>
<a class="sourceLine" id="cb1753-42" title="42"><span class="cf">for</span> i,j <span class="kw">in</span> <span class="bu">zip</span>(traj2,traj3):</a>
<a class="sourceLine" id="cb1753-43" title="43">    com_a <span class="op">=</span> md.compute_center_of_mass(i)[<span class="dv">0</span>]</a>
<a class="sourceLine" id="cb1753-44" title="44">    com_b <span class="op">=</span> md.compute_center_of_mass(j)[<span class="dv">0</span>]</a>
<a class="sourceLine" id="cb1753-45" title="45">    dist.append(((com_a[<span class="dv">0</span>]<span class="op">-</span>com_b[<span class="dv">0</span>])<span class="op">**</span><span class="dv">2</span><span class="op">+</span>(com_a[<span class="dv">1</span>]<span class="op">-</span>com_b[<span class="dv">1</span>])<span class="op">**</span><span class="dv">2</span><span class="op">+</span>(com_a[<span class="dv">2</span>]<span class="op">-</span>com_b[<span class="dv">2</span>])<span class="op">**</span><span class="dv">2</span>)<span class="op">**</span><span class="fl">0.5</span>)</a>
<a class="sourceLine" id="cb1753-46" title="46"></a>
<a class="sourceLine" id="cb1753-47" title="47"><span class="co"># assert</span></a>
<a class="sourceLine" id="cb1753-48" title="48"></a>
<a class="sourceLine" id="cb1753-49" title="49">distances <span class="op">=</span> unbdistance(traj,lig_str)</a>
<a class="sourceLine" id="cb1753-50" title="50"></a>
<a class="sourceLine" id="cb1753-51" title="51">check <span class="op">=</span> math.isclose(dist[<span class="dv">0</span>],distances[<span class="dv">0</span>])</a>
<a class="sourceLine" id="cb1753-52" title="52">check2 <span class="op">=</span> math.isclose(dist[<span class="op">-</span><span class="dv">1</span>],distances[<span class="op">-</span><span class="dv">1</span>])</a>
<a class="sourceLine" id="cb1753-53" title="53">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> check <span class="kw">and</span> check2 <span class="cf">else</span> <span class="va">False</span> </a></code></pre></div>
<p>Output:</p>
<pre><code>&#39;Constant&#39; object has no attribute &#39;kind&#39;</code></pre>
<h4 id="run-2-159">Run 2</h4>
<div class="sourceCode" id="cb1755"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1755-1" title="1"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb1755-2" title="2"></a>
<a class="sourceLine" id="cb1755-3" title="3"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1755-4" title="4"><span class="co">Print version string</span></a>
<a class="sourceLine" id="cb1755-5" title="5"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1755-6" title="6"><span class="bu">print</span>(md.version.full_version)</a>
<a class="sourceLine" id="cb1755-7" title="7"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1755-8" title="8"></a>
<a class="sourceLine" id="cb1755-9" title="9"><span class="kw">def</span> unbdistance(traj,lig_str):</a>
<a class="sourceLine" id="cb1755-10" title="10">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1755-11" title="11"><span class="co">    This function returns a list of distances between center of mass of</span></a>
<a class="sourceLine" id="cb1755-12" title="12"><span class="co">    protein and center of mass of lig_str in every frame of trajectory</span></a>
<a class="sourceLine" id="cb1755-13" title="13"><span class="co">    traj</span></a>
<a class="sourceLine" id="cb1755-14" title="14"></a>
<a class="sourceLine" id="cb1755-15" title="15"><span class="co">    traj is an mdtraj trajectory object</span></a>
<a class="sourceLine" id="cb1755-16" title="16"><span class="co">    lig_str is a string with the residue name of the ligand</span></a>
<a class="sourceLine" id="cb1755-17" title="17"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1755-18" title="18">    lig_sel <span class="op">=</span> traj.topology.select(<span class="st">&#39;resname &#39;</span><span class="op">+</span>lig_str)</a>
<a class="sourceLine" id="cb1755-19" title="19">    lig_com <span class="op">=</span> md.compute_center_of_mass(traj.atom_slice(lig_sel))</a>
<a class="sourceLine" id="cb1755-20" title="20">    prot_com <span class="op">=</span> md.compute_center_of_mass(traj.atom_slice(traj.topology.select(<span class="st">&#39;protein&#39;</span>)))</a>
<a class="sourceLine" id="cb1755-21" title="21">    <span class="cf">return</span> md.compute_distances(traj,lig_com,prot_com)</a>
<a class="sourceLine" id="cb1755-22" title="22"></a>
<a class="sourceLine" id="cb1755-23" title="23"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb1755-24" title="24"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb1755-25" title="25"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb1755-26" title="26"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1755-27" title="27"></a>
<a class="sourceLine" id="cb1755-28" title="28"></a>
<a class="sourceLine" id="cb1755-29" title="29"><span class="co">#_FILE_DIR_ = &#39;.&#39;</span></a>
<a class="sourceLine" id="cb1755-30" title="30">lig_str <span class="op">=</span> <span class="st">&#39;TMP&#39;</span></a>
<a class="sourceLine" id="cb1755-31" title="31">traj_path <span class="op">=</span> os.path.join(_FILE_DIR_, <span class="st">&#39;traj.dcd&#39;</span>) </a>
<a class="sourceLine" id="cb1755-32" title="32">top_path <span class="op">=</span> os.path.join(_FILE_DIR_, <span class="st">&#39;top.pdb&#39;</span>)</a>
<a class="sourceLine" id="cb1755-33" title="33">traj <span class="op">=</span> md.load(traj_path, top<span class="op">=</span>top_path)</a>
<a class="sourceLine" id="cb1755-34" title="34">top <span class="op">=</span> traj.topology</a>
<a class="sourceLine" id="cb1755-35" title="35">prot_idxs <span class="op">=</span> top.select(<span class="st">&#39;protein&#39;</span>)</a>
<a class="sourceLine" id="cb1755-36" title="36">lig_idxs <span class="op">=</span> top.select(<span class="ss">F&#39;resname == </span><span class="sc">{</span>lig_str<span class="sc">}</span><span class="ss">&#39;</span>)</a>
<a class="sourceLine" id="cb1755-37" title="37">traj2 <span class="op">=</span> md.load(traj_path, atom_indices<span class="op">=</span>prot_idxs, top<span class="op">=</span>top_path)</a>
<a class="sourceLine" id="cb1755-38" title="38">traj3 <span class="op">=</span> md.load(traj_path, atom_indices<span class="op">=</span>lig_idxs, top<span class="op">=</span>top_path)</a>
<a class="sourceLine" id="cb1755-39" title="39"></a>
<a class="sourceLine" id="cb1755-40" title="40">dist <span class="op">=</span> []</a>
<a class="sourceLine" id="cb1755-41" title="41"><span class="cf">for</span> i,j <span class="kw">in</span> <span class="bu">zip</span>(traj2,traj3):</a>
<a class="sourceLine" id="cb1755-42" title="42">    com_a <span class="op">=</span> md.compute_center_of_mass(i)[<span class="dv">0</span>]</a>
<a class="sourceLine" id="cb1755-43" title="43">    com_b <span class="op">=</span> md.compute_center_of_mass(j)[<span class="dv">0</span>]</a>
<a class="sourceLine" id="cb1755-44" title="44">    dist.append(((com_a[<span class="dv">0</span>]<span class="op">-</span>com_b[<span class="dv">0</span>])<span class="op">**</span><span class="dv">2</span><span class="op">+</span>(com_a[<span class="dv">1</span>]<span class="op">-</span>com_b[<span class="dv">1</span>])<span class="op">**</span><span class="dv">2</span><span class="op">+</span>(com_a[<span class="dv">2</span>]<span class="op">-</span>com_b[<span class="dv">2</span>])<span class="op">**</span><span class="dv">2</span>)<span class="op">**</span><span class="fl">0.5</span>)</a>
<a class="sourceLine" id="cb1755-45" title="45"></a>
<a class="sourceLine" id="cb1755-46" title="46"><span class="co"># assert</span></a>
<a class="sourceLine" id="cb1755-47" title="47"></a>
<a class="sourceLine" id="cb1755-48" title="48">distances <span class="op">=</span> unbdistance(traj,lig_str)</a>
<a class="sourceLine" id="cb1755-49" title="49"></a>
<a class="sourceLine" id="cb1755-50" title="50">check <span class="op">=</span> math.isclose(dist[<span class="dv">0</span>],distances[<span class="dv">0</span>])</a>
<a class="sourceLine" id="cb1755-51" title="51">check2 <span class="op">=</span> math.isclose(dist[<span class="op">-</span><span class="dv">1</span>],distances[<span class="op">-</span><span class="dv">1</span>])</a>
<a class="sourceLine" id="cb1755-52" title="52">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> check <span class="kw">and</span> check2 <span class="cf">else</span> <span class="va">False</span> </a></code></pre></div>
<p>Output:</p>
<pre><code>&#39;Constant&#39; object has no attribute &#39;kind&#39;</code></pre>
<h4 id="run-3-159">Run 3</h4>
<div class="sourceCode" id="cb1757"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1757-1" title="1"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb1757-2" title="2"></a>
<a class="sourceLine" id="cb1757-3" title="3"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1757-4" title="4"><span class="co">Print version string</span></a>
<a class="sourceLine" id="cb1757-5" title="5"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1757-6" title="6"><span class="bu">print</span>(md.version.full_version)</a>
<a class="sourceLine" id="cb1757-7" title="7"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1757-8" title="8"></a>
<a class="sourceLine" id="cb1757-9" title="9"><span class="kw">def</span> unbdistance(traj,lig_str):</a>
<a class="sourceLine" id="cb1757-10" title="10">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1757-11" title="11"><span class="co">    This function returns a list of distances between center of mass of</span></a>
<a class="sourceLine" id="cb1757-12" title="12"><span class="co">    protein and center of mass of lig_str in every frame of trajectory</span></a>
<a class="sourceLine" id="cb1757-13" title="13"><span class="co">    traj</span></a>
<a class="sourceLine" id="cb1757-14" title="14"></a>
<a class="sourceLine" id="cb1757-15" title="15"><span class="co">    traj is an mdtraj trajectory object</span></a>
<a class="sourceLine" id="cb1757-16" title="16"><span class="co">    lig_str is a string with the residue name of the ligand</span></a>
<a class="sourceLine" id="cb1757-17" title="17"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1757-18" title="18">    <span class="co"># get the indices of the ligand</span></a>
<a class="sourceLine" id="cb1757-19" title="19">    lig_ind <span class="op">=</span> traj.topology.select(<span class="st">&#39;resname &#39;</span><span class="op">+</span>lig_str)</a>
<a class="sourceLine" id="cb1757-20" title="20">    <span class="co"># get the indices of the protein</span></a>
<a class="sourceLine" id="cb1757-21" title="21">    prot_ind <span class="op">=</span> traj.topology.select(<span class="st">&#39;protein&#39;</span>)</a>
<a class="sourceLine" id="cb1757-22" title="22">    <span class="co"># get the center of mass of the ligand</span></a>
<a class="sourceLine" id="cb1757-23" title="23">    lig_com <span class="op">=</span> md.compute_center_of_mass(traj.atom_slice(lig_ind))</a>
<a class="sourceLine" id="cb1757-24" title="24">    <span class="co"># get the center of mass of the protein</span></a>
<a class="sourceLine" id="cb1757-25" title="25">    prot_com <span class="op">=</span> md.compute_center_of_mass(traj.atom_slice(prot_ind))</a>
<a class="sourceLine" id="cb1757-26" title="26">    <span class="co"># get the distance between the two centers of mass</span></a>
<a class="sourceLine" id="cb1757-27" title="27">    dist <span class="op">=</span> md.compute_distances(traj,lig_com,prot_com)</a>
<a class="sourceLine" id="cb1757-28" title="28">    <span class="cf">return</span> dist</a>
<a class="sourceLine" id="cb1757-29" title="29"></a>
<a class="sourceLine" id="cb1757-30" title="30"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb1757-31" title="31"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb1757-32" title="32"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb1757-33" title="33"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1757-34" title="34"></a>
<a class="sourceLine" id="cb1757-35" title="35"></a>
<a class="sourceLine" id="cb1757-36" title="36"><span class="co">#_FILE_DIR_ = &#39;.&#39;</span></a>
<a class="sourceLine" id="cb1757-37" title="37">lig_str <span class="op">=</span> <span class="st">&#39;TMP&#39;</span></a>
<a class="sourceLine" id="cb1757-38" title="38">traj_path <span class="op">=</span> os.path.join(_FILE_DIR_, <span class="st">&#39;traj.dcd&#39;</span>) </a>
<a class="sourceLine" id="cb1757-39" title="39">top_path <span class="op">=</span> os.path.join(_FILE_DIR_, <span class="st">&#39;top.pdb&#39;</span>)</a>
<a class="sourceLine" id="cb1757-40" title="40">traj <span class="op">=</span> md.load(traj_path, top<span class="op">=</span>top_path)</a>
<a class="sourceLine" id="cb1757-41" title="41">top <span class="op">=</span> traj.topology</a>
<a class="sourceLine" id="cb1757-42" title="42">prot_idxs <span class="op">=</span> top.select(<span class="st">&#39;protein&#39;</span>)</a>
<a class="sourceLine" id="cb1757-43" title="43">lig_idxs <span class="op">=</span> top.select(<span class="ss">F&#39;resname == </span><span class="sc">{</span>lig_str<span class="sc">}</span><span class="ss">&#39;</span>)</a>
<a class="sourceLine" id="cb1757-44" title="44">traj2 <span class="op">=</span> md.load(traj_path, atom_indices<span class="op">=</span>prot_idxs, top<span class="op">=</span>top_path)</a>
<a class="sourceLine" id="cb1757-45" title="45">traj3 <span class="op">=</span> md.load(traj_path, atom_indices<span class="op">=</span>lig_idxs, top<span class="op">=</span>top_path)</a>
<a class="sourceLine" id="cb1757-46" title="46"></a>
<a class="sourceLine" id="cb1757-47" title="47">dist <span class="op">=</span> []</a>
<a class="sourceLine" id="cb1757-48" title="48"><span class="cf">for</span> i,j <span class="kw">in</span> <span class="bu">zip</span>(traj2,traj3):</a>
<a class="sourceLine" id="cb1757-49" title="49">    com_a <span class="op">=</span> md.compute_center_of_mass(i)[<span class="dv">0</span>]</a>
<a class="sourceLine" id="cb1757-50" title="50">    com_b <span class="op">=</span> md.compute_center_of_mass(j)[<span class="dv">0</span>]</a>
<a class="sourceLine" id="cb1757-51" title="51">    dist.append(((com_a[<span class="dv">0</span>]<span class="op">-</span>com_b[<span class="dv">0</span>])<span class="op">**</span><span class="dv">2</span><span class="op">+</span>(com_a[<span class="dv">1</span>]<span class="op">-</span>com_b[<span class="dv">1</span>])<span class="op">**</span><span class="dv">2</span><span class="op">+</span>(com_a[<span class="dv">2</span>]<span class="op">-</span>com_b[<span class="dv">2</span>])<span class="op">**</span><span class="dv">2</span>)<span class="op">**</span><span class="fl">0.5</span>)</a>
<a class="sourceLine" id="cb1757-52" title="52"></a>
<a class="sourceLine" id="cb1757-53" title="53"><span class="co"># assert</span></a>
<a class="sourceLine" id="cb1757-54" title="54"></a>
<a class="sourceLine" id="cb1757-55" title="55">distances <span class="op">=</span> unbdistance(traj,lig_str)</a>
<a class="sourceLine" id="cb1757-56" title="56"></a>
<a class="sourceLine" id="cb1757-57" title="57">check <span class="op">=</span> math.isclose(dist[<span class="dv">0</span>],distances[<span class="dv">0</span>])</a>
<a class="sourceLine" id="cb1757-58" title="58">check2 <span class="op">=</span> math.isclose(dist[<span class="op">-</span><span class="dv">1</span>],distances[<span class="op">-</span><span class="dv">1</span>])</a>
<a class="sourceLine" id="cb1757-59" title="59">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> check <span class="kw">and</span> check2 <span class="cf">else</span> <span class="va">False</span> </a></code></pre></div>
<p>Output:</p>
<pre><code>&#39;Constant&#39; object has no attribute &#39;kind&#39;</code></pre>
<h4 id="run-4-159">Run 4</h4>
<div class="sourceCode" id="cb1759"><pre class="sourceCode py"><code class="sourceCode python"><a class="sourceLine" id="cb1759-1" title="1"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb1759-2" title="2"></a>
<a class="sourceLine" id="cb1759-3" title="3"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1759-4" title="4"><span class="co">Print version string</span></a>
<a class="sourceLine" id="cb1759-5" title="5"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1759-6" title="6"><span class="bu">print</span>(md.version.full_version)</a>
<a class="sourceLine" id="cb1759-7" title="7"><span class="co"># end</span></a>
<a class="sourceLine" id="cb1759-8" title="8"></a>
<a class="sourceLine" id="cb1759-9" title="9"><span class="kw">def</span> unbdistance(traj,lig_str):</a>
<a class="sourceLine" id="cb1759-10" title="10">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1759-11" title="11"><span class="co">    This function returns a list of distances between center of mass of</span></a>
<a class="sourceLine" id="cb1759-12" title="12"><span class="co">    protein and center of mass of lig_str in every frame of trajectory</span></a>
<a class="sourceLine" id="cb1759-13" title="13"><span class="co">    traj</span></a>
<a class="sourceLine" id="cb1759-14" title="14"></a>
<a class="sourceLine" id="cb1759-15" title="15"><span class="co">    traj is an mdtraj trajectory object</span></a>
<a class="sourceLine" id="cb1759-16" title="16"><span class="co">    lig_str is a string with the residue name of the ligand</span></a>
<a class="sourceLine" id="cb1759-17" title="17"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1759-18" title="18">    <span class="co"># get the residue number of the ligand</span></a>
<a class="sourceLine" id="cb1759-19" title="19">    lig_res <span class="op">=</span> traj.topology.select(<span class="st">&#39;resname &#39;</span><span class="op">+</span>lig_str)</a>
<a class="sourceLine" id="cb1759-20" title="20">    <span class="co"># get the center of mass of the ligand</span></a>
<a class="sourceLine" id="cb1759-21" title="21">    lig_com <span class="op">=</span> md.compute_center_of_mass(traj.atom_slice(lig_res))</a>
<a class="sourceLine" id="cb1759-22" title="22">    <span class="co"># get the center of mass of the protein</span></a>
<a class="sourceLine" id="cb1759-23" title="23">    prot_com <span class="op">=</span> md.compute_center_of_mass(traj.atom_slice(traj.topology.select(<span class="st">&#39;protein&#39;</span>)))</a>
<a class="sourceLine" id="cb1759-24" title="24">    <span class="co"># compute the distance between the two</span></a>
<a class="sourceLine" id="cb1759-25" title="25">    dist <span class="op">=</span> md.compute_distances(traj,[lig_com,prot_com],periodic<span class="op">=</span><span class="va">False</span>)</a>
<a class="sourceLine" id="cb1759-26" title="26">    <span class="co"># return the distance</span></a>
<a class="sourceLine" id="cb1759-27" title="27">    <span class="cf">return</span> dist[:,<span class="dv">0</span>]</a>
<a class="sourceLine" id="cb1759-28" title="28"></a>
<a class="sourceLine" id="cb1759-29" title="29"><span class="im">import</span> mdtraj <span class="im">as</span> md</a>
<a class="sourceLine" id="cb1759-30" title="30"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb1759-31" title="31"><span class="im">import</span> math</a>
<a class="sourceLine" id="cb1759-32" title="32"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1759-33" title="33"></a>
<a class="sourceLine" id="cb1759-34" title="34"></a>
<a class="sourceLine" id="cb1759-35" title="35"><span class="co">#_FILE_DIR_ = &#39;.&#39;</span></a>
<a class="sourceLine" id="cb1759-36" title="36">lig_str <span class="op">=</span> <span class="st">&#39;TMP&#39;</span></a>
<a class="sourceLine" id="cb1759-37" title="37">traj_path <span class="op">=</span> os.path.join(_FILE_DIR_, <span class="st">&#39;traj.dcd&#39;</span>) </a>
<a class="sourceLine" id="cb1759-38" title="38">top_path <span class="op">=</span> os.path.join(_FILE_DIR_, <span class="st">&#39;top.pdb&#39;</span>)</a>
<a class="sourceLine" id="cb1759-39" title="39">traj <span class="op">=</span> md.load(traj_path, top<span class="op">=</span>top_path)</a>
<a class="sourceLine" id="cb1759-40" title="40">top <span class="op">=</span> traj.topology</a>
<a class="sourceLine" id="cb1759-41" title="41">prot_idxs <span class="op">=</span> top.select(<span class="st">&#39;protein&#39;</span>)</a>
<a class="sourceLine" id="cb1759-42" title="42">lig_idxs <span class="op">=</span> top.select(<span class="ss">F&#39;resname == </span><span class="sc">{</span>lig_str<span class="sc">}</span><span class="ss">&#39;</span>)</a>
<a class="sourceLine" id="cb1759-43" title="43">traj2 <span class="op">=</span> md.load(traj_path, atom_indices<span class="op">=</span>prot_idxs, top<span class="op">=</span>top_path)</a>
<a class="sourceLine" id="cb1759-44" title="44">traj3 <span class="op">=</span> md.load(traj_path, atom_indices<span class="op">=</span>lig_idxs, top<span class="op">=</span>top_path)</a>
<a class="sourceLine" id="cb1759-45" title="45"></a>
<a class="sourceLine" id="cb1759-46" title="46">dist <span class="op">=</span> []</a>
<a class="sourceLine" id="cb1759-47" title="47"><span class="cf">for</span> i,j <span class="kw">in</span> <span class="bu">zip</span>(traj2,traj3):</a>
<a class="sourceLine" id="cb1759-48" title="48">    com_a <span class="op">=</span> md.compute_center_of_mass(i)[<span class="dv">0</span>]</a>
<a class="sourceLine" id="cb1759-49" title="49">    com_b <span class="op">=</span> md.compute_center_of_mass(j)[<span class="dv">0</span>]</a>
<a class="sourceLine" id="cb1759-50" title="50">    dist.append(((com_a[<span class="dv">0</span>]<span class="op">-</span>com_b[<span class="dv">0</span>])<span class="op">**</span><span class="dv">2</span><span class="op">+</span>(com_a[<span class="dv">1</span>]<span class="op">-</span>com_b[<span class="dv">1</span>])<span class="op">**</span><span class="dv">2</span><span class="op">+</span>(com_a[<span class="dv">2</span>]<span class="op">-</span>com_b[<span class="dv">2</span>])<span class="op">**</span><span class="dv">2</span>)<span class="op">**</span><span class="fl">0.5</span>)</a>
<a class="sourceLine" id="cb1759-51" title="51"></a>
<a class="sourceLine" id="cb1759-52" title="52"><span class="co"># assert</span></a>
<a class="sourceLine" id="cb1759-53" title="53"></a>
<a class="sourceLine" id="cb1759-54" title="54">distances <span class="op">=</span> unbdistance(traj,lig_str)</a>
<a class="sourceLine" id="cb1759-55" title="55"></a>
<a class="sourceLine" id="cb1759-56" title="56">check <span class="op">=</span> math.isclose(dist[<span class="dv">0</span>],distances[<span class="dv">0</span>])</a>
<a class="sourceLine" id="cb1759-57" title="57">check2 <span class="op">=</span> math.isclose(dist[<span class="op">-</span><span class="dv">1</span>],distances[<span class="op">-</span><span class="dv">1</span>])</a>
<a class="sourceLine" id="cb1759-58" title="58">result <span class="op">=</span> <span class="va">True</span> <span class="cf">if</span> check <span class="kw">and</span> check2 <span class="cf">else</span> <span class="va">False</span> </a></code></pre></div>
<p>Output:</p>
<pre><code>&#39;Constant&#39; object has no attribute &#39;kind&#39;</code></pre>
</details>
<h2 id="test-report-2">Test Report</h2>
<h3 id="global-parameters-2">Global Parameters</h3>
<ul class="incremental">
<li>Engine = incoder/facebook/incoder-1B</li>
<li><p>T = 0.2</p></li>
<li><p>Prompt Override = insert</p></li>
</ul>
<h3 id="code-results-2">Code Results</h3>
<table>
<thead>
<tr class="header">
<th>Test</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>aa_polarity</td>
</tr>
<tr class="even">
<td>adiabatic_expansion</td>
</tr>
<tr class="odd">
<td>alignment</td>
</tr>
<tr class="even">
<td>angle</td>
</tr>
<tr class="odd">
<td>aromatic_aa</td>
</tr>
<tr class="even">
<td>arrhenius</td>
</tr>
<tr class="odd">
<td>bimolecular</td>
</tr>
<tr class="even">
<td>bb_rad</td>
</tr>
<tr class="odd">
<td>blast</td>
</tr>
<tr class="even">
<td>bravais</td>
</tr>
<tr class="odd">
<td>canonicalize</td>
</tr>
<tr class="even">
<td>carnot_efficiency</td>
</tr>
<tr class="odd">
<td>claussius</td>
</tr>
<tr class="even">
<td>compare_electronegativity</td>
</tr>
<tr class="odd">
<td>condiff_1d</td>
</tr>
<tr class="even">
<td>cubes</td>
</tr>
<tr class="odd">
<td>de_broglie</td>
</tr>
<tr class="even">
<td>derivative1d-ch</td>
</tr>
<tr class="odd">
<td>derivative_2deg</td>
</tr>
<tr class="even">
<td>descriptors</td>
</tr>
<tr class="odd">
<td>dipole</td>
</tr>
<tr class="even">
<td>dou</td>
</tr>
<tr class="odd">
<td>eigen-ch</td>
</tr>
<tr class="even">
<td>eigen</td>
</tr>
<tr class="odd">
<td>element_mass</td>
</tr>
<tr class="even">
<td>element_name</td>
</tr>
<tr class="odd">
<td>energy_of_e</td>
</tr>
<tr class="even">
<td>find_indices</td>
</tr>
<tr class="odd">
<td>force_constant</td>
</tr>
<tr class="even">
<td>fourier_1d</td>
</tr>
<tr class="odd">
<td>freezing_depression</td>
</tr>
<tr class="even">
<td>genpos</td>
</tr>
<tr class="odd">
<td>heating_water</td>
</tr>
<tr class="even">
<td>hydrophobic_res</td>
</tr>
<tr class="odd">
<td>ideal_gas</td>
</tr>
<tr class="even">
<td>integral</td>
</tr>
<tr class="odd">
<td>trap</td>
</tr>
<tr class="even">
<td>invert_matrix</td>
</tr>
<tr class="odd">
<td>iupac2smiles</td>
</tr>
<tr class="even">
<td>kld</td>
</tr>
<tr class="odd">
<td>langevin_dynamics</td>
</tr>
<tr class="even">
<td>lipinski_rule_of_five</td>
</tr>
<tr class="odd">
<td>mape</td>
</tr>
<tr class="even">
<td>mapping_operator</td>
</tr>
<tr class="odd">
<td>matpow</td>
</tr>
<tr class="even">
<td>matrix_factorial</td>
</tr>
<tr class="odd">
<td>max-boltz</td>
</tr>
<tr class="even">
<td>michaelis</td>
</tr>
<tr class="odd">
<td>mol_charge</td>
</tr>
<tr class="even">
<td>net_charge</td>
</tr>
<tr class="odd">
<td>solve_ode</td>
</tr>
<tr class="even">
<td>ohe</td>
</tr>
<tr class="odd">
<td>osmotic_pressure</td>
</tr>
<tr class="even">
<td>pair_wise</td>
</tr>
<tr class="odd">
<td>pi</td>
</tr>
<tr class="even">
<td>pib_1d</td>
</tr>
<tr class="odd">
<td>pred_interval</td>
</tr>
<tr class="even">
<td>pubchem</td>
</tr>
<tr class="odd">
<td>pyscf_energy</td>
</tr>
<tr class="even">
<td>qed</td>
</tr>
<tr class="odd">
<td>quantile</td>
</tr>
<tr class="even">
<td>random_walk</td>
</tr>
<tr class="odd">
<td>rank</td>
</tr>
<tr class="even">
<td>rank</td>
</tr>
<tr class="odd">
<td>remove-water</td>
</tr>
<tr class="even">
<td>rms_velocity</td>
</tr>
<tr class="odd">
<td>rmse</td>
</tr>
<tr class="even">
<td>rog</td>
</tr>
<tr class="odd">
<td>sasa</td>
</tr>
<tr class="even">
<td>scaffold</td>
</tr>
<tr class="odd">
<td>seq-align</td>
</tr>
<tr class="even">
<td>seq-trans</td>
</tr>
<tr class="odd">
<td>sequence</td>
</tr>
<tr class="even">
<td>sle</td>
</tr>
<tr class="odd">
<td>spectral_r</td>
</tr>
<tr class="even">
<td>find_peaks</td>
</tr>
<tr class="odd">
<td>speed_of_sound</td>
</tr>
<tr class="even">
<td>substructure</td>
</tr>
<tr class="odd">
<td>tanimoto</td>
</tr>
<tr class="even">
<td>unbdistance</td>
</tr>
</tbody>
</table>
<h3 id="details-2">Details</h3>
<details>
<p><summary>aa_polarity</summary></p>
<h4 id="query-160">Query</h4>
<p>```py import math import sys</p>
<p>def polar_count(sequence): """ This function counts the number of polar uncharged amino acids in the given sequence """ [insert] return count</p>
```
</details>
<details>
<p><summary>adiabatic_expansion</summary></p>
<h4 id="query-161">Query</h4>
<p>```py import math import sys</p>
<p>def cooling(T1,P1,P2,gamma): """ This function returns the temperature of an ideal gas expanding adiabatically from P1 to P2 """ [insert] return T2</p>
```
</details>
<details>
<p><summary>alignment</summary></p>
<h4 id="query-162">Query</h4>
<p>```py import mdtraj as md import numpy as np</p>
<p>def align_traj(traj, frame_index): """ This function aligns the given mdtraj trajectory to a specific frame """ [insert] return traj</p>
```
</details>
<details>
<p><summary>angle</summary></p>
<h4 id="query-163">Query</h4>
<p>```py import numpy as np import matplotlib matplotlib.use(‘Agg’) import matplotlib.pyplot as plt</p>
<p>def vector_angle(v1,v2): """ This function returns the angle between vector v1 and vector v2. """ [insert] return angle</p>
```
</details>
<details>
<p><summary>aromatic_aa</summary></p>
<h4 id="query-164">Query</h4>
<p>```py import math import sys</p>
<p>def aromatic_aa(sequence): """ This function takes in an amino acid sequence and returns the number of aromatic residues there are """ [insert] return count</p>
```
</details>
<details>
<p><summary>arrhenius</summary></p>
<h4 id="query-165">Query</h4>
<p>```py import math import sys</p>
<p>def arrhenius(k2,T2,T1,Ea): """ This function returns the value of the rate constant at temperature T1 using the Arrhenius equation k2 is the rate constant at temperature T2. Ea is the activation energy in J/mol. Temperatures are given in Kelvin """ [insert] return k1</p>
```
</details>
<details>
<p><summary>bimolecular</summary></p>
<h4 id="query-166">Query</h4>
<p>```py import math import sys</p>
<p>def bimolecular_rate(k,A,B): """ This function returns the rate of reaction given the rate constant k and concentrations of species A and B """ [insert] return rate</p>
```
</details>
<details>
<p><summary>bb_rad</summary></p>
<h4 id="query-167">Query</h4>
<p>```py import numpy as np import matplotlib matplotlib.use(‘Agg’) import matplotlib.pyplot as plt</p>
<p>def bb_radiation(lam, T): """ This function calculates and returns the spectral radiance value in SI unit for wavelength lam at temperature T, using planck’s law of black body radiation. """ [insert] return B</p>
```
</details>
<details>
<p><summary>blast</summary></p>
<h4 id="query-168">Query</h4>
<p>```py import requests from bs4 import BeautifulSoup import numpy as np</p>
<p>def blast(seq): ’’’ Returns MSA with a BLAST search. Uses beautiful soup to parse result.</p>
<pre><code>1. import packages
2. Submit BLAST search with sequences
3. Get result
4. Parse MSA
5. Return a tuple of e score, id of top match
&#39;&#39;&#39;
[insert]
return e, id</code></pre>
```
</details>
<details>
<p><summary>bravais</summary></p>
<h4 id="query-169">Query</h4>
<p>```py import math import sys</p>
<p>def bravais_lattice(group_number): """ Return bravais lattice name given space group number """ [insert] return name</p>
```
</details>
<details>
<p><summary>canonicalize</summary></p>
<h4 id="query-170">Query</h4>
<p>```py import matplotlib.pyplot as plt import rdkit from rdkit import Chem from rdkit.Chem import Draw from rdkit.Chem import rdMolHash from rdkit.Chem import rdMolDescriptors from rdkit.Chem import Scaffolds from rdkit.Chem import Crippen from rdkit.Chem import Descriptors from rdkit.ML.Descriptors import MoleculeDescriptors from rdkit import DataStructs from rdkit.Chem import Scaffolds import numpy as np</p>
<p>def canonical(smiles_list): """ Returns list of canonical forms of given molecules """ [insert] return canon_list</p>
```
</details>
<details>
<p><summary>carnot_efficiency</summary></p>
<h4 id="query-171">Query</h4>
<p>```py import math import sys</p>
<p>def carnot_efficiency(T_hot, T_cold): """ This function returns the efficiency of a carnot efficiency operating between two temperatures """ [insert] return eps</p>
```
</details>
<details>
<p><summary>claussius</summary></p>
<h4 id="query-172">Query</h4>
<p>```py import math import sys</p>
<p>def claussius(HVap, T1, P1, T2): """ This function returns the phase transition pressure at temperature T2 given a heat of vaporization HVap, and and reference temperature and pressure T1 and P1 """ [insert] return P2</p>
```
</details>
<details>
<p><summary>compare_electronegativity</summary></p>
<h4 id="query-173">Query</h4>
<p>```py import math import sys</p>
<p>def compare_electronegativity(element1,element2): """ This function returns True if element1 has a larger Pauling electronegativity than element2 """ import mendeleev [insert] return result</p>
```
</details>
<details>
<p><summary>condiff_1d</summary></p>
<h4 id="query-174">Query</h4>
<p>```py import numpy as np import matplotlib matplotlib.use(‘Agg’) import matplotlib.pyplot as plt</p>
<p>def condiff_1d(x): """ This function computes the difference between consecutive elements in array x. """ [insert] return diff</p>
```
</details>
<details>
<p><summary>cubes</summary></p>
<h4 id="query-175">Query</h4>
<p>```py import math import sys</p>
<p>def sum_of_cubes(n): """ This function returns the sum of the first n cubes """ [insert] return s</p>
```
</details>
<details>
<p><summary>de_broglie</summary></p>
<h4 id="query-176">Query</h4>
<p>```py import math import sys</p>
<p>def de_broglie(m,v): """ This function returns the de Broglie wavelength for a particle of mass m with speed v. """ [insert] return l</p>
```
</details>
<details>
<p><summary>derivative1d-ch</summary></p>
<h4 id="query-177">Query</h4>
<p>```py import numpy as np import matplotlib matplotlib.use(‘Agg’) import matplotlib.pyplot as plt</p>
<p>def find_derivative(a,b,c,x): """ 这个函数通过生成含有参数a，b，c的二阶多項式来计算x处的一阶导数。</p>
<p>""" [insert] return d</p>
```
</details>
<details>
<p><summary>derivative_2deg</summary></p>
<h4 id="query-178">Query</h4>
<p>```py import numpy as np import matplotlib matplotlib.use(‘Agg’) import matplotlib.pyplot as plt</p>
<p>def find_derivative(a,b,c,x): """ This function generates a 2nd degree polynomial with coefficients a,b,c and return derivative at x """ [insert] return deriv</p>
```
</details>
<details>
<p><summary>descriptors</summary></p>
<h4 id="query-179">Query</h4>
<p>```py import matplotlib.pyplot as plt import rdkit from rdkit import Chem from rdkit.Chem import Draw from rdkit.Chem import rdMolHash from rdkit.Chem import rdMolDescriptors from rdkit.Chem import Scaffolds from rdkit.Chem import Crippen from rdkit.Chem import Descriptors from rdkit.ML.Descriptors import MoleculeDescriptors from rdkit import DataStructs from rdkit.Chem import Scaffolds import numpy as np</p>
<p>import numpy as np</p>
<p>def get_descriptors(smiles_list): """ Returns an N x 8 matrix of descriptors for given SMILEs """ [insert] return descriptors</p>
```
</details>
<details>
<p><summary>dipole</summary></p>
<h4 id="query-180">Query</h4>
<p>```py import numpy as np import matplotlib matplotlib.use(‘Agg’) import matplotlib.pyplot as plt</p>
<p>def dipole_moment(coordinates, charges): """ This function returns the dipole moment of a molecule</p>
<p>Coordinates is a numpy array of size Nx3 Charges is a numpy array of size N """ [insert] return dipole_moment</p>
```
</details>
<details>
<p><summary>dou</summary></p>
<h4 id="query-181">Query</h4>
<p>```py import matplotlib.pyplot as plt import rdkit from rdkit import Chem from rdkit.Chem import Draw from rdkit.Chem import rdMolHash from rdkit.Chem import rdMolDescriptors from rdkit.Chem import Scaffolds from rdkit.Chem import Crippen from rdkit.Chem import Descriptors from rdkit.ML.Descriptors import MoleculeDescriptors from rdkit import DataStructs from rdkit.Chem import Scaffolds import numpy as np</p>
<p>def calc_rdbs(smiles): """ Return degrees of unsaturation (Double Bond Equivalent) from C, N, H, Halogen count. """ [insert] return d</p>
```
</details>
<details>
<p><summary>eigen-ch</summary></p>
<h4 id="query-182">Query</h4>
<p>```py import numpy as np import matplotlib matplotlib.use(‘Agg’) import matplotlib.pyplot as plt</p>
<p>def eigen(M): """ 该函数返回矩阵M的特征值和特征向量。 """ [insert] return w,v</p>
```
</details>
<details>
<p><summary>eigen</summary></p>
<h4 id="query-183">Query</h4>
<p>```py import numpy as np import matplotlib matplotlib.use(‘Agg’) import matplotlib.pyplot as plt</p>
<p>def eigen(M): """ Return eigenvalues and eigenvectors for a square matrix M """ [insert] return w,v</p>
```
</details>
<details>
<p><summary>element_mass</summary></p>
<h4 id="query-184">Query</h4>
<p>```py import math import sys</p>
<p>def element_mass(element_symbol): """ This function returns the mass of the chemical element given by its symbol """ import mendeleev [insert] return mass</p>
```
</details>
<details>
<p><summary>element_name</summary></p>
<h4 id="query-185">Query</h4>
<p>```py import math import sys</p>
<p>def symbol(element_number): """ This function returns the two letter symbol for the chemical element given by element_number """ import mendeleev [insert] return s</p>
```
</details>
<details>
<p><summary>energy_of_e</summary></p>
<h4 id="query-186">Query</h4>
<p>```py import math import sys</p>
<p>def energy_of_e(n): """ This function calculates the energy in electron Volts of an electron in state n in a hydrogen atom """ [insert] return energy</p>
```
</details>
<details>
<p><summary>find_indices</summary></p>
<h4 id="query-187">Query</h4>
<p>```py import mdtraj as md import numpy as np</p>
<p>def get_ca_indices(pdb_file): """ This function uploads a pdb file and find out the indices of first two alpha carbon atoms. """ [insert] return idx</p>
```
</details>
<details>
<p><summary>force_constant</summary></p>
<h4 id="query-188">Query</h4>
<p>```py import numpy as np import matplotlib matplotlib.use(‘Agg’) import matplotlib.pyplot as plt</p>
<p>def compute_k(m1,m2,wave_len): """ Two atom harmonic oscillator. Returns force constant in kg/s**2 units given masses m1,m2 and wave length wave_len. Masses are in kg units and wave length in cm^-1 units. Use reduced mass. """ [insert] return k</p>
```
</details>
<details>
<p><summary>fourier_1d</summary></p>
<h4 id="query-189">Query</h4>
<p>```py import numpy as np import matplotlib matplotlib.use(‘Agg’) import matplotlib.pyplot as plt</p>
<p>def fourier_1d(x): """ This function returns the one dimensional fourier transform of array x. """ [insert] return w</p>
```
</details>
<details>
<p><summary>freezing_depression</summary></p>
<h4 id="query-190">Query</h4>
<p>```py import math import sys</p>
<p>def freezing_depression(Kf,m): """ This function returns the decrease in freezing point in Kelvin The depression constant is Kf in K kg/mol and is greater than zero Molality m is given in mol/kg """ [insert] return deltaT</p>
```
</details>
<details>
<p><summary>genpos</summary></p>
<h4 id="query-191">Query</h4>
<p>```py import requests from bs4 import BeautifulSoup import numpy as np</p>
<p>def matrix_generators(gnum): """ Returns list of matrix generators for general positions of given space group gnum - International Tables for Crystallography space group number """ [insert] return generators</p>
```
</details>
<details>
<p><summary>heating_water</summary></p>
<h4 id="query-192">Query</h4>
<p>```py import math import sys</p>
<p>def heating_energy(n, T1, T2): """ This function returns the energy in kcal required to heat n moles of water from T1 to T2 """ [insert] return q</p>
```
</details>
<details>
<p><summary>hydrophobic_res</summary></p>
<h4 id="query-193">Query</h4>
<p>```py import mdtraj as md import numpy as np</p>
<p>def get_hydrophobic_residues(pdb_filename): """ Returns list of hydrophobic residues indices """ [insert] return resids</p>
```
</details>
<details>
<p><summary>ideal_gas</summary></p>
<h4 id="query-194">Query</h4>
<p>```py import math import sys</p>
<p>def ideal_gas_pressure(n,V,T): """ This function returns the pressure for n moles of an ideal gas at temperature T and volume V, using the ideal gas equation of state. The pressure returned is in atm units. """ [insert] return P</p>
```
</details>
<details>
<p><summary>integral</summary></p>
<h4 id="query-195">Query</h4>
<p>```py import numpy as np import matplotlib matplotlib.use(‘Agg’) import matplotlib.pyplot as plt</p>
<p>def find_integral(a,b,c,d): """ This function generates a one dimensional polynomial with coefficients a,b,c,d and returns its integral.</p>
<p>""" [insert] return integral</p>
```
</details>
<details>
<p><summary>trap</summary></p>
<h4 id="query-196">Query</h4>
<p>```py import numpy as np import matplotlib matplotlib.use(‘Agg’) import matplotlib.pyplot as plt</p>
<p>def trap(f, n, a, b): """ This function evaluates the integral of a univariate function f from a to b with n itervals using the composite trapezoidal rule. """ [insert] return integral</p>
```
</details>
<details>
<p><summary>invert_matrix</summary></p>
<h4 id="query-197">Query</h4>
<p>```py import numpy as np import matplotlib matplotlib.use(‘Agg’) import matplotlib.pyplot as plt</p>
<p>def invert_matrix(A): """ This function computes the inverse of matrix A """ [insert] return Ainv</p>
```
</details>
<details>
<p><summary>iupac2smiles</summary></p>
<h4 id="query-198">Query</h4>
<p>```py import matplotlib.pyplot as plt import rdkit from rdkit import Chem from rdkit.Chem import Draw from rdkit.Chem import rdMolHash from rdkit.Chem import rdMolDescriptors from rdkit.Chem import Scaffolds from rdkit.Chem import Crippen from rdkit.Chem import Descriptors from rdkit.ML.Descriptors import MoleculeDescriptors from rdkit import DataStructs from rdkit.Chem import Scaffolds import numpy as np</p>
<p>def iupac2smiles(IUPAC): """ This function takes in the IUPAC name string and converts it to a SMILES string """ [insert] return SMILES</p>
```
</details>
<details>
<p><summary>kld</summary></p>
<h4 id="query-199">Query</h4>
<p>```py import numpy as np import matplotlib matplotlib.use(‘Agg’) import matplotlib.pyplot as plt</p>
<p>def kld(true_data, predicted_data): """ This function calculates the Kullback–Leibler (KL) divergence loss between true_data and predicted_data. """ [insert] return loss</p>
```
</details>
<details>
<p><summary>langevin_dynamics</summary></p>
<h4 id="query-200">Query</h4>
<p>```py import numpy as np import matplotlib matplotlib.use(‘Agg’) import matplotlib.pyplot as plt</p>
<p>def run_langevin_dynamics(x0,v0,gamma,F,n_steps,dt=0.003,T=1.0,m=1): """ This function runs a Langevin dynamics simulation in 1d in an external potential It returns the trajectory of x and v.</p>
<pre><code>The initial position is x0
The initial velocity is v0
The temperature is T
m is the mass
F(x) is a function that returns the external force
gamma is the drag coefficient
&quot;&quot;&quot;
x_traj = np.zeros(n_steps)
v_traj = np.zeros(n_steps)
[insert]
return x_traj, v_traj</code></pre>
```
</details>
<details>
<p><summary>lipinski_rule_of_five</summary></p>
<h4 id="query-201">Query</h4>
<p>```py import matplotlib.pyplot as plt import rdkit from rdkit import Chem from rdkit.Chem import Draw from rdkit.Chem import rdMolHash from rdkit.Chem import rdMolDescriptors from rdkit.Chem import Scaffolds from rdkit.Chem import Crippen from rdkit.Chem import Descriptors from rdkit.ML.Descriptors import MoleculeDescriptors from rdkit import DataStructs from rdkit.Chem import Scaffolds import numpy as np</p>
<p>def lipinski_rule_of_five(smiles): """ This function calculates the Lipinski descriptors of the given SMILES string and returns a boolean to indicate if Lipinski’s rule of five was satisfied.</p>
<pre><code>Lipinski&#39;s rules are:
Hydrogen bond donors &lt;= 5
Hydrogen bond acceptors &lt;= 10
Molecular weight &lt; 500 daltons
logP &lt; 5
&quot;&quot;&quot;
[insert]
return result</code></pre>
```
</details>
<details>
<p><summary>mape</summary></p>
<h4 id="query-202">Query</h4>
<p>```py import math import sys</p>
<p>def mape(y_hat,y): """ This function computes the mean absolute percentage error (mape) between y_hat and y. """ [insert] return e</p>
```
</details>
<details>
<p><summary>mapping_operator</summary></p>
<h4 id="query-203">Query</h4>
<p>```py import MDAnalysis import numpy as np</p>
<p>def mapping_operator(molecule, beads_mappings): """ This function generates a mass-mass weighted mapping matrix given an MD analysis molecule and atom selections for the beads. """ [insert] return M</p>
```
</details>
<details>
<p><summary>matpow</summary></p>
<h4 id="query-204">Query</h4>
<p>```py import numpy as np import matplotlib matplotlib.use(‘Agg’) import matplotlib.pyplot as plt</p>
<p>def matpow(x,n): """ This function computes matrix x raised to the power n. """ [insert] return r</p>
```
</details>
<details>
<p><summary>matrix_factorial</summary></p>
<h4 id="query-205">Query</h4>
<p>```py import numpy as np import matplotlib matplotlib.use(‘Agg’) import matplotlib.pyplot as plt</p>
<p>def matrix_factorial(n): """ This function calculates and returns the factorial of a matrix (array) element wise """ [insert] return f</p>
```
</details>
<details>
<p><summary>max-boltz</summary></p>
<h4 id="query-206">Query</h4>
<p>```py import math import sys</p>
<p>def max_boltz_rms_speed(T,M): """ This function returns the rms speed of a molecule in m/s</p>
<p>The temperature is T in Kelvin The molecule has mass M in kiolograms """ [insert] return s</p>
```
</details>
<details>
<p><summary>michaelis</summary></p>
<h4 id="query-207">Query</h4>
<p>```py import math import sys</p>
<p>def reaction_velocity(Vmax, S, Km): """ This function returns the initial reaction rate according to Michaelis-Menten kinetics """ [insert] return v</p>
```
</details>
<details>
<p><summary>mol_charge</summary></p>
<h4 id="query-208">Query</h4>
<p>```py import matplotlib.pyplot as plt import rdkit from rdkit import Chem from rdkit.Chem import Draw from rdkit.Chem import rdMolHash from rdkit.Chem import rdMolDescriptors from rdkit.Chem import Scaffolds from rdkit.Chem import Crippen from rdkit.Chem import Descriptors from rdkit.ML.Descriptors import MoleculeDescriptors from rdkit import DataStructs from rdkit.Chem import Scaffolds import numpy as np</p>
<p>def net_charge(smiles): """ This function returns net charge of given molecule """ [insert] return charge</p>
```
</details>
<details>
<p><summary>net_charge</summary></p>
<h4 id="query-209">Query</h4>
<p>```py import math import sys</p>
<p>def net_charge(sequence): """ This function returns net charge of amino acid sequence """ [insert] return charge</p>
```
</details>
<details>
<p><summary>solve_ode</summary></p>
<h4 id="query-210">Query</h4>
<p>```py import numpy as np import matplotlib matplotlib.use(‘Agg’) import matplotlib.pyplot as plt</p>
<p>def solve_ode(fn, t, y0): """ Solve an initial value problem for system of Ordinary Differential Equations using the Explicit Runge-Kutta method of order 5. t is a 1D vector and dy/dt=fn(t,y). Returns the values of the solution y at t. """ [insert] return sol</p>
```
</details>
<details>
<p><summary>ohe</summary></p>
<h4 id="query-211">Query</h4>
<p>```py import numpy as np import matplotlib matplotlib.use(‘Agg’) import matplotlib.pyplot as plt</p>
<p>def ohe(a): """ This function generates one-hot encodings for the class names in the given list of strings. """ [insert] return v</p>
```
</details>
<details>
<p><summary>osmotic_pressure</summary></p>
<h4 id="query-212">Query</h4>
<p>```py import math import sys</p>
<p>def osmotic_pressure_concentration(Pi,T): """ This function returns the concentration in mol/l given an osmotic pressure Pi and temperature T T is in K Pi is in atm """ R = 0.08206 # l atm /K /mol [insert] return p</p>
```
</details>
<details>
<p><summary>pair_wise</summary></p>
<h4 id="query-213">Query</h4>
<p>```py import mdtraj as md import numpy as np</p>
<p>def pairwise_dist(pdb_file): """ 1 This function loads a pdb 2 Selects only the alpha carbons 3 Calculates the number of unique alpha carbon pairs 4 Returns the distances between each alpha carbon pair """ [insert] return distances</p>
```
</details>
<details>
<p><summary>pi</summary></p>
<h4 id="query-214">Query</h4>
<p>```py import numpy as np import matplotlib matplotlib.use(‘Agg’) import matplotlib.pyplot as plt</p>
<p>def pi(nsamples): """ This function returns the value of pi by monte carlo sampling """ [insert] return pi_est</p>
```
</details>
<details>
<p><summary>pib_1d</summary></p>
<h4 id="query-215">Query</h4>
<p>```py import math import sys</p>
<p>def particle_in_box(n,m,L,hbar=1): """ This function returns the energy for a quantum particle in a 1d box """ [insert] return e</p>
```
</details>
<details>
<p><summary>pred_interval</summary></p>
<h4 id="query-216">Query</h4>
<p>```py import numpy as np import matplotlib matplotlib.use(‘Agg’) import matplotlib.pyplot as plt</p>
<p>def num_trials(pred_level, p): ""“Returns the minimum number of trials needed to achieve a probability given by pred_level in a geometric distribution”"" [insert] return n</p>
```
</details>
<details>
<p><summary>pubchem</summary></p>
<h4 id="query-217">Query</h4>
<p>```py import matplotlib.pyplot as plt import rdkit from rdkit import Chem from rdkit.Chem import Draw from rdkit.Chem import rdMolHash from rdkit.Chem import rdMolDescriptors from rdkit.Chem import Scaffolds from rdkit.Chem import Crippen from rdkit.Chem import Descriptors from rdkit.ML.Descriptors import MoleculeDescriptors from rdkit import DataStructs from rdkit.Chem import Scaffolds import numpy as np</p>
<p>import requests</p>
<p>def find_similar(smiles): """ Returns a set of molecules with greater than 80% similarity using the PubChem REST API. The returned molecules are SMILES strings, not CIDs. """ [insert] return mols</p>
```
</details>
<details>
<p><summary>pyscf_energy</summary></p>
<h4 id="query-218">Query</h4>
<p>```py import pyscf import numpy as np</p>
<p>def calc_molecule_energy(atom,basis): """ This function returns the ground state energy for atom using restricted Hartree-Fock in the given basis """ [insert] return ground_energy</p>
```
</details>
<details>
<p><summary>qed</summary></p>
<h4 id="query-219">Query</h4>
<p>```py import matplotlib.pyplot as plt import rdkit from rdkit import Chem from rdkit.Chem import Draw from rdkit.Chem import rdMolHash from rdkit.Chem import rdMolDescriptors from rdkit.Chem import Scaffolds from rdkit.Chem import Crippen from rdkit.Chem import Descriptors from rdkit.ML.Descriptors import MoleculeDescriptors from rdkit import DataStructs from rdkit.Chem import Scaffolds import numpy as np</p>
<p>def qed(smiles): """ This function takes a SMILES string and returns the quantitative estimation of drug-likeness for the molecule. """ [insert] return result</p>
```
</details>
<details>
<p><summary>quantile</summary></p>
<h4 id="query-220">Query</h4>
<p>```py import numpy as np import matplotlib matplotlib.use(‘Agg’) import matplotlib.pyplot as plt</p>
<p>def quantile(a, q): """ This function computes the q-th quantile of the numpy array a. q can be a sequence of quantiles with values between 0 and 1 inclusive. """ [insert] return result</p>
```
</details>
<details>
<p><summary>random_walk</summary></p>
<h4 id="query-221">Query</h4>
<p>```py import numpy as np import matplotlib matplotlib.use(‘Agg’) import matplotlib.pyplot as plt</p>
<p>def random_walk(N): """ This function returns the trajectory of an N step random walk on a one dimensional lattice """ a = 1 # lattice spacing x0 = 0 [insert] return traj</p>
```
</details>
<details>
<p><summary>rank</summary></p>
<h4 id="query-222">Query</h4>
<p>```py import numpy as np import matplotlib matplotlib.use(‘Agg’) import matplotlib.pyplot as plt</p>
<p>def rank(M): """ 这个函数使用奇异值分解来计算矩阵M的秩。 """ [insert] return r</p>
```
</details>
<details>
<p><summary>rank</summary></p>
<h4 id="query-223">Query</h4>
<p>```py import numpy as np import matplotlib matplotlib.use(‘Agg’) import matplotlib.pyplot as plt</p>
<p>def rank(M): """ This function calculates the rank of matrix M using singular value decomposition. """ [insert] return r</p>
```
</details>
<details>
<p><summary>remove-water</summary></p>
<h4 id="query-224">Query</h4>
<p>```py import mdtraj as md import numpy as np</p>
<p>def remove_water(traj_file,top_file): """ This function removes solvent from loaded trajectory traj_file and topology in top_file to return the new trajctory """ [insert] return new_traj</p>
```
</details>
<details>
<p><summary>rms_velocity</summary></p>
<h4 id="query-225">Query</h4>
<p>```py import math import sys</p>
<p>def rms_velocity(T,m): """ This function returns the root-mean-squared velocity of an ideal gas molecule at temperature T m is mass in g/mol """ [insert] return v_rms</p>
```
</details>
<details>
<p><summary>rmse</summary></p>
<h4 id="query-226">Query</h4>
<p>```py import numpy as np import matplotlib matplotlib.use(‘Agg’) import matplotlib.pyplot as plt</p>
<p>def rmse(a,b): """ This function evaluates the root mean square error (rmse) between a and b. """ [insert] return e</p>
```
</details>
<details>
<p><summary>rog</summary></p>
<h4 id="query-227">Query</h4>
<p>```py import mdtraj as md import numpy as np</p>
<p>def protein_radius_of_gyration(pdb_file): """ 1. This function loads a pdb 2. Calculates the radius of gyration 3. Returns it """ [insert] return rg</p>
```
</details>
<details>
<p><summary>sasa</summary></p>
<h4 id="query-228">Query</h4>
<p>```py import mdtraj as md import numpy as np</p>
<p>def protein_surface_area(pdb_file): """ 1. This function loads a pdb 2. Calculates the Solvent Accessible Surface Area (sasa) per residue 3. Returns it """ [insert] return sasa</p>
```
</details>
<details>
<p><summary>scaffold</summary></p>
<h4 id="query-229">Query</h4>
<p>```py import matplotlib.pyplot as plt import rdkit from rdkit import Chem from rdkit.Chem import Draw from rdkit.Chem import rdMolHash from rdkit.Chem import rdMolDescriptors from rdkit.Chem import Scaffolds from rdkit.Chem import Crippen from rdkit.Chem import Descriptors from rdkit.ML.Descriptors import MoleculeDescriptors from rdkit import DataStructs from rdkit.Chem import Scaffolds import numpy as np</p>
<p>def scaffold(smiles): """ Returns Murcko scaffold of given molecule """ [insert] return scaffold_smiles</p>
```
</details>
<details>
<p><summary>seq-align</summary></p>
<h4 id="query-230">Query</h4>
<p>```py from Bio import SeqIO from Bio import Align from Bio import PopGen from Bio.PDB import * from Bio.Seq import Seq import Bio from Bio import pairwise2 from Bio.Blast import NCBIWWW, NCBIXML from Bio.SubsMat import MatrixInfo as matlist</p>
<p>def align(seq1, seq2): ’’’ Align the two amino acid sequences with BLOSUM62 and return aligned sequences ’’’ [insert] return aligned</p>
```
</details>
<details>
<p><summary>seq-trans</summary></p>
<h4 id="query-231">Query</h4>
<p>```py from Bio import SeqIO from Bio import Align from Bio import PopGen from Bio.PDB import * from Bio.Seq import Seq import Bio from Bio import pairwise2 from Bio.Blast import NCBIWWW, NCBIXML from Bio.SubsMat import MatrixInfo as matlist</p>
<p>def nucleotide_translate(gene_seq): """ Converts nucleotide sequence to amino acids. Returns a string """ [insert] return prot_seq</p>
```
</details>
<details>
<p><summary>sequence</summary></p>
<h4 id="query-232">Query</h4>
<p>```py import numpy as np import matplotlib matplotlib.use(‘Agg’) import matplotlib.pyplot as plt</p>
<p>def gen_geometric_sequence(s,e,l): """ This function return a geometric sequence that starts at s, ends at e with length l """ [insert] return x</p>
```
</details>
<details>
<p><summary>sle</summary></p>
<h4 id="query-233">Query</h4>
<p>```py import sympy</p>
<p>def sle(eqns): """ This function solves a system of linear equations {[‘a_0x_0 + b_0x_1 = c0’,‘a_1x_0 + b_1x_1 = c1’]}. """ [insert] return x</p>
```
</details>
<details>
<p><summary>spectral_r</summary></p>
<h4 id="query-234">Query</h4>
<p>```py import numpy as np import matplotlib matplotlib.use(‘Agg’) import matplotlib.pyplot as plt</p>
<p>def spectral_r(a): """ This function calculates the spectral radius of the input square matrix a. """ [insert] return sradius</p>
```
</details>
<details>
<p><summary>find_peaks</summary></p>
<h4 id="query-235">Query</h4>
<p>```py import numpy as np import scipy</p>
<p>import scipy.optimize import scipy.signal</p>
<p>def find_peaks(abs_spectrum, npeaks=3): ’’’ This will find the highest <code>npeaks</code> peaks and return a list of peak wavenumbers. <code>abs_spectrum</code> should be shape (N, 2) ’’’ [insert] return wavenumbers</p>
```
</details>
<details>
<p><summary>speed_of_sound</summary></p>
<h4 id="query-236">Query</h4>
<p>```py import math import sys</p>
<p>def speed_of_sound(T,m,gamma): """ This function returns the speed of sound for an ideal gas at temperature T m is mass in g/mol """ [insert] return s</p>
```
</details>
<details>
<p><summary>substructure</summary></p>
<h4 id="query-237">Query</h4>
<p>```py import matplotlib.pyplot as plt import rdkit from rdkit import Chem from rdkit.Chem import Draw from rdkit.Chem import rdMolHash from rdkit.Chem import rdMolDescriptors from rdkit.Chem import Scaffolds from rdkit.Chem import Crippen from rdkit.Chem import Descriptors from rdkit.ML.Descriptors import MoleculeDescriptors from rdkit import DataStructs from rdkit.Chem import Scaffolds import numpy as np</p>
<p>def substructure(smiles, mol_list): """ This function takes a smiles string and searches mol_list to find entries that contain the substructure. It returns the indices of these entries. """ [insert] return idx</p>
```
</details>
<details>
<p><summary>tanimoto</summary></p>
<h4 id="query-238">Query</h4>
<p>```py import matplotlib.pyplot as plt import rdkit from rdkit import Chem from rdkit.Chem import Draw from rdkit.Chem import rdMolHash from rdkit.Chem import rdMolDescriptors from rdkit.Chem import Scaffolds from rdkit.Chem import Crippen from rdkit.Chem import Descriptors from rdkit.ML.Descriptors import MoleculeDescriptors from rdkit import DataStructs from rdkit.Chem import Scaffolds import numpy as np</p>
<p>def tanimoto_matrix(smiles_list, bits=256): """ Returns pairwise Tanimoto similarity matrix with ECFP4 fingerprints """ [insert] return s</p>
```
</details>
<details>
<p><summary>unbdistance</summary></p>
<h4 id="query-239">Query</h4>
<p>```py import mdtraj as md import numpy as np</p>
<p>def unbdistance(traj,lig_str): """ This function returns a list of distances between center of mass of protein and center of mass of lig_str in every frame of trajectory traj</p>
<pre><code>traj is an mdtraj trajectory object
lig_str is a string with the residue name of the ligand
&quot;&quot;&quot;
[insert]
return result</code></pre>
```
</details>
</body>
</html>
